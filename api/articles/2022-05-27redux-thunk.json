{"title":"redux-thunkæºç ","uid":"ef136ce7ac94dd6f9c2f35712eef1e47","slug":"2022-05-27redux-thunk","date":"2022-05-27T01:21:50.000Z","updated":"2022-09-15T14:26:10.749Z","comments":true,"path":"api/articles/2022-05-27redux-thunk.json","keywords":null,"cover":null,"content":"<h2 id=\"æºç ç‰ˆæœ¬\"><a href=\"#æºç ç‰ˆæœ¬\" class=\"headerlink\" title=\"æºç ç‰ˆæœ¬\"></a>æºç ç‰ˆæœ¬</h2><p><a href=\"https://github.com/reduxjs/redux-thunk/releases/tag/v2.4.1\">v2.4.1</a></p>\n<h2 id=\"ç”¨é€”\"><a href=\"#ç”¨é€”\" class=\"headerlink\" title=\"ç”¨é€”\"></a>ç”¨é€”</h2><ul>\n<li>é€šè¿‡reduxæºç applyMiddlewareäº†è§£åˆ°ï¼Œæ˜¯å¯¹store.dispatchè¿›è¡Œå¢å¼º</li>\n<li>å¯ä»¥æ¥å—ä¸€ä¸ªè¿”å›å‡½æ•°çš„action creatorã€‚å¦‚æœè¿™ä¸ªaction creator è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±æŒ‰ç…§åŸæ¥çš„next(action)æ‰§è¡Œã€‚</li>\n<li>å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­æ‰§è¡Œä¸€äº›å¼‚æ­¥çš„æ“ä½œ</li>\n</ul>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">export function addCount() &#123;\n  return &#123;type: ADD_COUNT&#125;\n&#125; \nexport function addCountAsync() &#123;\n  return dispatch &#x3D;&gt; &#123; &#x2F;&#x2F; dispatchå¯¹åº”æºç çš„ ï¼š action(dispatch, getState, extraArgument);çš„ç¬¬ä¸€ä¸ªå‚æ•°\n    setTimeout( () &#x3D;&gt; &#123;\n      dispatch(addCount())\n    &#125;,2000)\n  &#125;\n&#125;\n</code></pre>\n<ul>\n<li>addCountAsyncå‡½æ•°å°±è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œå°†dispatchä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’è¿›å»ï¼Œåœ¨å‡½æ•°å†…è¿›è¡Œå¼‚æ­¥æ“ä½œå°±å¯ä»¥äº†ã€‚</li>\n</ul>\n<h2 id=\"package-json\"><a href=\"#package-json\" class=\"headerlink\" title=\"package.json\"></a>package.json</h2><ul>\n<li>è¿™ä¸ªæ–‡ä»¶ç»“æ„ä¸reduxã€react-reduxç›¸æ¯”ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œè¿™é‡ŒåŠä»¥åå¦‚æ— å¿…è¦ä¸åœ¨è¿›è¡Œé˜…è¯»</li>\n<li>ç®€å•æ‰«ä¸€çœ¼å°±å¥½</li>\n</ul>\n<h2 id=\"æºç \"><a href=\"#æºç \" class=\"headerlink\" title=\"æºç \"></a>æºç </h2><pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">&#x2F;** A function that accepts a potential &quot;extra argument&quot; value to be injected later,\n * and returns an instance of the thunk middleware that uses that value\n *&#x2F;\n&#x2F;** ä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯èƒ½çš„&quot;extra argument&quot;å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªthunkä¸­é—´ä»¶ï¼Œå®ƒä½¿ç”¨è¿™ä¸ªå€¼ *&#x2F;\nfunction createThunkMiddleware&lt;\n  State &#x3D; any,\n  BasicAction extends Action &#x3D; AnyAction,\n  ExtraThunkArg &#x3D; undefined\n&gt;(extraArgument?: ExtraThunkArg) &#123;\n  &#x2F;&#x2F; Standard Redux middleware definition pattern:\n  &#x2F;&#x2F; æ ‡å‡†Reduxä¸­é—´ä»¶å®šä¹‰æ¨¡å¼:\n  &#x2F;&#x2F; See: https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#writing-custom-middleware\n  const middleware: ThunkMiddleware&lt;State, BasicAction, ExtraThunkArg&gt; &#x3D;\n    (&#123; dispatch, getState &#125;) &#x3D;&gt; (next) &#x3D;&gt;  (action) &#x3D;&gt; &#123;\n      &#x2F;&#x2F; The thunk middleware looks for any functions that were passed to &#96;store.dispatch&#96;.\n      &#x2F;&#x2F; If this &quot;action&quot; is really a function, call it and return the result.\n      &#x2F;&#x2F; è¿™ä¸ªthunkä¸­é—´ä»¶ä¼šæŸ¥æ‰¾store.dispatchä¼ å…¥çš„ä»»ä½•å‡½æ•°ã€‚å¦‚æœè¿™ä¸ª&quot;action&quot;æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨å®ƒå¹¶è¿”å›ç»“æœã€‚\n      if (typeof action &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;\n        &#x2F;&#x2F; Inject the store&#39;s &#96;dispatch&#96; and &#96;getState&#96; methods, as well as any &quot;extra arg&quot;\n        &#x2F;&#x2F; æ³¨å…¥storeçš„dispatchå’ŒgetStateæ–¹æ³•ï¼Œä»¥åŠä»»æ„çš„&quot;extra arg&quot;\n        return action(dispatch, getState, extraArgument);\n      &#125;\n      &#x2F;&#x2F; å¦åˆ™ï¼Œåƒå¾€å¸¸ä¸€æ ·å°†æ“ä½œä¼ é€’ç»™ä¸­é—´ä»¶é“¾\n      &#x2F;&#x2F; Otherwise, pass the action down the middleware chain as usual\n      return next(action);\n    &#125;;\n  return middleware;\n&#125;</code></pre>\n<p><strong>ä¸­é—´ä»¶æ¨¡å¼</strong></p>\n<p>æŸ¯é‡ŒåŒ–ï¼šå°†ä¸€ä¸ªå‡½æ•°çš„å‚æ•°åˆ†è§£æˆå¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªæ–°çš„å‡½æ•°å¯ä»¥è¢«è°ƒç”¨ï¼Œå¹¶ä¸”è¿”å›åŸå‡½æ•°çš„ç»“æœã€‚</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">const anotherExampleMiddleware &#x3D; storeAPI &#x3D;&gt; next &#x3D;&gt; action &#x3D;&gt; &#123;\n  &#x2F;&#x2F; Do something in here, when each action is dispatched\n\n  return next(action)\n&#125;</code></pre>\n<p><strong>storeAPI</strong></p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">&#x2F;&#x2F; storeAPI\n\nconst store &#x3D; &#123;\n  dispatch: dispatch as Dispatch&lt;A&gt;,\n  subscribe,\n  getState,\n  replaceReducer,\n  [$$observable]: observable\n&#125; as unknown as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext</code></pre>\n<p><em>å·¥å‚æ¨¡å¼</em></p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">\nconst thunk &#x3D; createThunkMiddleware() as ThunkMiddleware &amp; &#123;\n  withExtraArgument&lt;\n    ExtraThunkArg,\n    State &#x3D; any,\n    BasicAction extends Action &#x3D; AnyAction\n  &gt;(\n    extraArgument: ExtraThunkArg\n  ): ThunkMiddleware&lt;State, BasicAction, ExtraThunkArg&gt;\n&#125;\n\n&#x2F;&#x2F; Attach the factory function so users can create a customized version\n&#x2F;&#x2F; with whatever &quot;extra arg&quot; they want to inject into their thunks\n&#x2F;&#x2F; å°è¯•å°†å·¥å‚å‡½æ•°é™„åŠ åˆ°ç”¨æˆ·å¯ä»¥åˆ›å»ºä»»ä½•é¢å¤–çš„&quot;extra arg&quot;çš„thunkä¸­é—´ä»¶\nthunk.withExtraArgument &#x3D; createThunkMiddleware\n\nexport default thunk</code></pre>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><p><a href=\"https://github.com/reduxjs/redux-thunk/blob/master/src/index.ts\">redux-thunkæºç </a><br><a href=\"https://blog.csdn.net/hsany330/article/details/105951197\">Reduxä¸­é—´ä»¶ä¹‹redux-thunkä½¿ç”¨è¯¦è§£</a></p>\n","text":"æºç ç‰ˆæœ¬v2.4.1 ç”¨é€” é€šè¿‡reduxæºç applyMiddlewareäº†è§£åˆ°ï¼Œæ˜¯å¯¹store.dispatchè¿›è¡Œå¢å¼º å¯ä»¥æ¥å—ä¸€ä¸ªè¿”å›å‡½æ•°çš„action creatorã€‚å¦‚æœè¿™ä¸ªaction creator è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±æŒ‰ç…§åŸæ¥çš„next(ac...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"react","slug":"react","count":18,"path":"api/categories/react.json"}],"tags":[{"name":"redux","slug":"redux","count":6,"path":"api/tags/redux.json"},{"name":"æºç ","slug":"æºç ","count":14,"path":"api/tags/æºç .json"},{"name":"redux-thunk","slug":"redux-thunk","count":1,"path":"api/tags/redux-thunk.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%BA%90%E7%A0%81%E7%89%88%E6%9C%AC\"><span class=\"toc-text\">æºç ç‰ˆæœ¬</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%94%A8%E9%80%94\"><span class=\"toc-text\">ç”¨é€”</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#package-json\"><span class=\"toc-text\">package.json</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%BA%90%E7%A0%81\"><span class=\"toc-text\">æºç </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">å‚è€ƒ</span></a></li></ol>","author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"vscode i18n-ally","uid":"98e904a0d3e9702a10dc20a22eaad4dd","slug":"2022-05-27i18n","date":"2022-05-27T02:47:24.000Z","updated":"2022-09-15T14:26:10.748Z","comments":true,"path":"api/articles/2022-05-27i18n.json","keywords":null,"cover":[],"text":"å›½é™…åŒ– å¤§å‹å…¬å¸çš„å›½é™…åŒ–éœ€æ±‚å¾ˆé«˜ï¼Œéœ€è¦æ”¯æŒå¤šè¯­è¨€ï¼Œæ¯”å¦‚ä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰ç­‰ã€‚ i18n-allyæ˜¯ä¸€ä¸ªåŸºäºvscodeçš„å›½é™…åŒ–å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿçš„å®ç°å›½é™…åŒ–ã€‚ èƒŒæ™¯ å¦‚æœç»å¸¸åšå›½é™…åŒ–çš„ç ”å‘ï¼Œåº”è¯¥å¾ˆæ¸…æ¥šï¼Œä»£ç ä¸­å†™å¤šè¯­è¨€ï¼Œç„¶è€Œï¼Œå¤šè¯­è¨€åœ¨é¡¹ç›®ä¸­ç»´æŠ¤æ˜¯éå¸¸å›°éš¾çš„ã€‚ å½“é‡åˆ°å¤§å‹é¡¹ç›®ï¼Œä¸šåŠ¡...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"å·¥å…·","slug":"å·¥å…·","count":15,"path":"api/categories/å·¥å…·.json"}],"tags":[{"name":"å¢æ•ˆ","slug":"å¢æ•ˆ","count":8,"path":"api/tags/å¢æ•ˆ.json"},{"name":"å·¥å…·","slug":"å·¥å…·","count":7,"path":"api/tags/å·¥å…·.json"},{"name":"vscode","slug":"vscode","count":6,"path":"api/tags/vscode.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"js ä»£ç æ³¨é‡Š","uid":"5df43a7a7d0a76be0dcfbc13fca3f3d6","slug":"2022-05-26code","date":"2022-05-26T07:31:20.000Z","updated":"2022-09-15T14:26:10.748Z","comments":true,"path":"api/articles/2022-05-26code.json","keywords":null,"cover":[],"text":"ä»£ç æ³¨é‡Š//è¿™ç§jsæ³¨é‡Šä»£ç åœ¨vscodeå…¶ä»–åœ°æ–¹å¼•ç”¨æ—¶å€™ï¼Œæ²¡æœ‰æç¤ºï¼Œ å¦‚æœéœ€è¦æœ‰æç¤ºï¼Œéœ€è¦å†™æˆ/** æç¤º **/ å†™æ³•1 export enum ELeaveType &#123; MATERNITY_ &#x3D; 17, &#x2F;&#x2F; &quot;äº§å‡&amp...","link":"","photos":[],"count_time":{"symbolsCount":469,"symbolsTime":"1 mins."},"categories":[{"name":"code","slug":"code","count":1,"path":"api/categories/code.json"}],"tags":[{"name":"code","slug":"code","count":1,"path":"api/tags/code.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}