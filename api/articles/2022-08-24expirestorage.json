{"title":"æœ‰è¿‡æœŸæœºåˆ¶çš„localStorage","uid":"b204c24ab6e396e5de06d4bc0adf7d2a","slug":"2022-08-24expirestorage","date":"2022-08-24T08:49:06.000Z","updated":"2022-08-24T13:57:29.581Z","comments":true,"path":"api/articles/2022-08-24expirestorage.json","keywords":null,"cover":[],"content":"<h2 id=\"åœºæ™¯\"><a href=\"#åœºæ™¯\" class=\"headerlink\" title=\"åœºæ™¯\"></a>åœºæ™¯</h2><p>å¯¹äºä¸€äº›æ•°æ®ä¸ç»å¸¸æ›´æ–°çš„æ•°æ®ï¼Œä¿æŒä¸€å®šæ—¶é—´çš„æ–°é²œçš„æ—¶å€™å¯ä»¥ç”¨äºç¼“å­˜</p>\n<h2 id=\"localStorage\"><a href=\"#localStorage\" class=\"headerlink\" title=\"localStorage\"></a>localStorage</h2><p><a href=\"https://juejin.cn/post/7068533397911502879\" target=\"_blank\" >è§åŸæ–‡</a></p>\n<p>æŠŠåŸæ–‡ä»£ç æ”¹äº†ä¸‹ï¼Œä¸»è¦å¯¹<code>JSON.parse</code>è¿›è¡Œ fixed</p>\n<pre class=\"line-numbers language-js\" data-language=\"js\"><code class=\"language-js\">Storage.prototype.setStorageWithAge &#x3D; (key, value, expires &#x3D; 60 * 1000) &#x3D;&gt; &#123;\n  if (isNaN(expires) || expires &lt; 1)\n    throw new Error(&quot;expires must be a number&quot;);\n  const obj &#x3D; &#123;\n    data: value,\n    &#x2F;&#x2F;å­˜å‚¨å€¼\n    time: Date.now(),\n    &#x2F;&#x2F;å­˜å€¼æ—¶é—´æˆ³\n    maxExpires: expires,\n    &#x2F;&#x2F;è¿‡æœŸæ—¶é—´\n  &#125;;\n  localStorage.setItem(key, JSON.stringify(obj));\n&#125;;\n\nStorage.prototype.getStorageWithAge &#x3D; (key) &#x3D;&gt; &#123;\n  try &#123;\n    const &#123; data, time, maxExpires &#125; &#x3D; JSON.parse(localStorage.getItem(key));\n    if (time + maxExpires &lt; Date.now()) &#123;\n      localStorage.removeItem(key);\n      return undefined;\n    &#125;\n    return data;\n  &#125; catch (error) &#123;\n    return undefined; &#x2F;&#x2F; JSON.parseè§£æundefinedæ—¶å€™ç›´æ¥è¿”å›\n  &#125;\n&#125;;\n\n&#x2F;&#x2F; æµ‹è¯•æ•°æ®\nlocalStorage.setStorageWithAge(&quot;amingxiansen&quot;, &quot;æµ‹è¯•è¿‡æœŸæ—¶é—´&quot;, 5000);\nlocalStorage.getStorageWithAge(&quot;amingxiansen&quot;);</code></pre>\n\n<img src=\"http://t-blog-images.aijs.top/img/202208241654212.webp\" />\n\n<p>æ³¨æ„ï¼šå¯¹äºä¸€äº›æ•æ„Ÿæ•°æ®ï¼Œéœ€è¦åŠ å¯†</p>\n","text":"åœºæ™¯å¯¹äºä¸€äº›æ•°æ®ä¸ç»å¸¸æ›´æ–°çš„æ•°æ®ï¼Œä¿æŒä¸€å®šæ—¶é—´çš„æ–°é²œçš„æ—¶å€™å¯ä»¥ç”¨äºç¼“å­˜ localStorageè§åŸæ–‡ æŠŠåŸæ–‡ä»£ç æ”¹äº†ä¸‹ï¼Œä¸»è¦å¯¹JSON.parseè¿›è¡Œ fixed Storage.prototype.setStorageWithAge &#x3D; (key, value, e...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"å­˜å‚¨","slug":"å­˜å‚¨","count":1,"path":"api/categories/å­˜å‚¨.json"}],"tags":[{"name":"å­˜å‚¨","slug":"å­˜å‚¨","count":1,"path":"api/tags/å­˜å‚¨.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9C%BA%E6%99%AF\"><span class=\"toc-text\">åœºæ™¯</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#localStorage\"><span class=\"toc-text\">localStorage</span></a></li></ol>","author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ahooksæºç ","uid":"847fdfbf845470be05a2ff27391aae0c","slug":"2022-08-24ahooks","date":"2022-08-24T09:16:49.000Z","updated":"2022-09-05T12:39:49.777Z","comments":true,"path":"api/articles/2022-08-24ahooks.json","keywords":null,"cover":"https://ahooks.js.org/logo.svg","text":"èƒŒæ™¯éšæ„çœ‹çœ‹ï¼Œäº†è§£ä¸‹ï¼Œæ— å›ºå®šé¡ºåºï¼Œå…¨å‡­å…´è¶£ useUpdate useUpdate ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°ä¼šå¼ºåˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚ import &#123; useCallback, useState &#125; from &quot;react&quot;; const u...","link":"","photos":[],"count_time":{"symbolsCount":"97k","symbolsTime":"1:28"},"categories":[{"name":"æºç ","slug":"æºç ","count":2,"path":"api/categories/æºç .json"}],"tags":[{"name":"æºç ","slug":"æºç ","count":14,"path":"api/tags/æºç .json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"react hook å¦‚ä½•å¢åŠ ä¾èµ–æ›´æ–°","uid":"66abc3dc4231aab7cbe8387d3c356301","slug":"2022-08-23react-hook","date":"2022-08-23T08:25:15.000Z","updated":"2022-08-31T13:00:11.736Z","comments":true,"path":"api/articles/2022-08-23react-hook.json","keywords":null,"cover":[],"text":"èƒŒæ™¯æƒ³å°†ï¼Œä¸šåŠ¡é€»è¾‘æŒ‰é’®ç»„å°è£…ä¸º hook,åœ¨ç§»åŠ¨ç«¯å’Œ pc ç«¯ä¹‹é—´è¿›è¡Œé€»è¾‘å¤ç”¨ã€‚åœ¨è¯¦æƒ…é¡µé¢ä½¿ç”¨æ—¶å€™ï¼Œå‘ç°å¹¶æ²¡æœ‰ç”Ÿæ•ˆ åŸå› ï¼š æ— æ³•ç»™ useActionsï¼Œå¢åŠ ä¾èµ–é¡¹ï¼Œç±»ä¼¼ useEffect çš„ç¬¬äºŒå‚æ•°ä¸€æ ·ã€‚ æŸ¥è¯¢äº† ahooks çš„ hookï¼Œäº†è§£ç±»ä¼¼è§£å†³æ–¹æ¡ˆ useActio...","link":"","photos":[],"count_time":{"symbolsCount":"19k","symbolsTime":"17 mins."},"categories":[{"name":"react","slug":"react","count":10,"path":"api/categories/react.json"}],"tags":[{"name":"react","slug":"react","count":4,"path":"api/tags/react.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}