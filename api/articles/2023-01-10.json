{"title":"客户端渲染与服务端渲染不一致","uid":"c3f5e3bc603af25e48391385cd8562c8","slug":"2023-01-10","date":"2023-01-10T03:29:02.000Z","updated":"2023-07-08T01:06:25.351Z","comments":true,"path":"api/articles/2023-01-10.json","keywords":null,"cover":[],"content":"<h2 id=\"有的有警告，有的没有警告\"><a href=\"#有的有警告，有的没有警告\" class=\"headerlink\" title=\"有的有警告，有的没有警告\"></a>有的有警告，有的没有警告</h2><img src=\"http://t-blog-images.aijs.top/img/202301101130782.webp\" />\n\n<h2 id=\"修改前\"><a href=\"#修改前\" class=\"headerlink\" title=\"修改前\"></a>修改前</h2><pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">import &#123; ICardItem &#125; from &#39;@&#x2F;components&#x2F;drag-grid&#x2F;context&#39;;\n&#x2F;&#x2F; useNextLocalStorageState 是对 ahooks useLocalStorageState 直接使用\nimport &#123; useNextLocalStorageState &#125; from &#39;@&#x2F;hooks&#x2F;nextLocalStorageState&#39;;\nimport &#123; fetchBearerOptions, getBusinessLineList, getClientLevelList, getTechLineList &#125; from &#39;@&#x2F;service&#x2F;common&#39;;\nimport &#123; DownloadOutlined, DownOutlined, PushpinOutlined, UpOutlined &#125; from &#39;@ant-design&#x2F;icons&#39;;\nimport isServer from &#39;@ty-fe&#x2F;next&#x2F;isServer&#39;;\nimport &#123; useRouter &#125; from &#39;@ty-fe&#x2F;next&#x2F;router&#39;;\nimport &#123; useMemoizedFn &#125; from &#39;ahooks&#39;;\nimport &#123; Button, Checkbox, Col, DatePicker, Form, Radio, Row, Select, Space &#125; from &#39;antd&#39;;\nimport &#123; SizeType &#125; from &#39;antd&#x2F;lib&#x2F;config-provider&#x2F;SizeContext&#39;;\nimport &#123; RangePickerProps &#125; from &#39;antd&#x2F;lib&#x2F;date-picker&#39;;\nimport moment from &#39;moment&#39;;\nimport React, &#123; forwardRef, useEffect, useImperativeHandle, useState &#125; from &#39;react&#39;;\nimport &#123; allList, workloads, dayTypes, dayRangeTypes &#125; from &#39;..&#39;;\nimport styles from &#39;.&#x2F;index.module.scss&#39;;\n\nfunction formatDateRanges(ranges: any[]) &#123;\n  const results &#x3D; [];\n  if (!ranges) &#123;\n    return [undefined, undefined];\n  &#125;\n  if (ranges[0]) &#123;\n    results.push(moment(ranges[0]).format(&#39;YYYY-MM-DD&#39;));\n  &#125; else &#123;\n    results.push(undefined);\n  &#125;\n  if (ranges[1]) &#123;\n    results.push(moment(ranges[1]).format(&#39;YYYY-MM-DD&#39;));\n  &#125; else &#123;\n    results.push(undefined);\n  &#125;\n\n  return results;\n&#125;\n\nfunction transRangesToMoments(ranges: any[]) &#123;\n  let results &#x3D; [];\n  if (!ranges) &#123;\n    results &#x3D; [undefined, undefined];\n  &#125; else &#123;\n    if (ranges[0]) &#123;\n      results.push(moment(ranges[0]));\n    &#125; else &#123;\n      results.push(undefined);\n    &#125;\n    if (ranges[1]) &#123;\n      results.push(moment(ranges[1]));\n    &#125; else &#123;\n      results.push(undefined);\n    &#125;\n  &#125;\n\n  return results;\n&#125;\n\nexport function transRangesToObject(ranges: any[], format: (v: any) &#x3D;&gt; any) &#123;\n  const obj &#x3D; &#123;\n    start: undefined,\n    end: undefined,\n  &#125;;\n  if (ranges[0]) &#123;\n    obj.start &#x3D; format ? format(ranges[0]) : ranges[0];\n  &#125;\n  if (ranges[1]) &#123;\n    obj.end &#x3D; format ? format(ranges[1]) : ranges[1];\n  &#125;\n\n  return obj;\n&#125;\n\ninterface IProps &#123;\n  manual?: boolean;\n  size?: SizeType;\n  onFormChange?: (v: any) &#x3D;&gt; void;\n  onFormSubmit?: (v: any) &#x3D;&gt; void;\n&#125;\nconst &#123; RangePicker &#125; &#x3D; DatePicker;\ninterface IRef &#123;\n  reset: () &#x3D;&gt; void;\n  submit: () &#x3D;&gt; void;\n  setForm: (v: any) &#x3D;&gt; void;\n  getFieldsValue: () &#x3D;&gt; any;\n&#125;\nconst &#123; Option &#125; &#x3D; Select;\n\nconst FormSearch &#x3D; forwardRef&lt;IRef, IProps&gt;((props, ref) &#x3D;&gt; &#123;\n  const &#123; manual &#x3D; false, size &#125; &#x3D; props;\n  const [clientStore, setClientStore] &#x3D; useState&lt;Record&lt;string, any&gt;&gt;(&#123;&#125;);\n  const router &#x3D; useRouter();\n  &#x2F;&#x2F; @ts-ignore\n  const &#123; realPathname &#125; &#x3D; router;\n  const &#123; type &#125; &#x3D; router.query;\n\n  const [activeCard, setActiveCard] &#x3D; useState&lt;ICardItem&gt;(&#123;&#125; as ICardItem);\n\n  const [pageStore, setPageStore] &#x3D; useNextLocalStorageState&lt;Record&lt;string, any&gt; | undefined&gt;(&#96;$&#123;realPathname&#125;_page_store&#96;, &#123;\n    defaultValue: &#123; pin: true, expand: true &#125;,\n  &#125;);\n\n  &#x2F;&#x2F; 待选项\n  const [workloadBearTypes, setWorkloadBearTypes] &#x3D; useState([]);\n  const [clientLevels, setClientLevels] &#x3D; useState([]);\n  const [buslines, setBuslines] &#x3D; useState([]);\n  const [techLineList, setTechLineList] &#x3D; useState([]);\n\n  const handleGetWorkloadBearTypes &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await fetchBearerOptions();\n    if (res.success) &#123;\n      setWorkloadBearTypes(res.result);\n    &#125;\n  &#125;);\n\n  const handleGetClientLevelList &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await getClientLevelList();\n    if (res.success) &#123;\n      setClientLevels(res.result);\n    &#125;\n  &#125;);\n\n  const handleGetBuzlines &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await getBusinessLineList();\n    if (res.success) &#123;\n      setBuslines(res.result);\n    &#125;\n  &#125;);\n\n  const handleGetTechLineList &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await getTechLineList();\n    if (res.success) &#123;\n      setTechLineList(res.result.content);\n    &#125;\n  &#125;);\n\n  useEffect(() &#x3D;&gt; &#123;\n    handleGetWorkloadBearTypes();\n    handleGetClientLevelList();\n    handleGetBuzlines();\n    handleGetTechLineList();\n  &#125;, []);\n\n  useEffect(() &#x3D;&gt; &#123;\n    const _active &#x3D; allList.find((item) &#x3D;&gt; item.code &#x3D;&#x3D;&#x3D; type);\n    setActiveCard(_active || (&#123;&#125; as ICardItem));\n  &#125;, [type]);\n\n  useEffect(() &#x3D;&gt; &#123;\n    if (!isServer) &#123;\n      let formValues;\n      try &#123;\n        formValues &#x3D; JSON.parse(localStorage.getItem(realPathname));\n\n        formValues &#x3D; &#123;\n          ...formValues,\n          baseTimes: transRangesToMoments(formValues.baseTimes),\n          compareTimes: transRangesToMoments(formValues.compareTimes),\n        &#125;;\n      &#125; catch (error) &#123;\n        formValues &#x3D; &#123;\n          baseTimes: [undefined, undefined],\n          compareTimes: [undefined, undefined],\n        &#125;;\n      &#125;\n\n      form?.setFieldsValue(formValues);\n\n      if (!manual) &#123;\n        props.onFormSubmit?.(&#123;\n          ...formValues,\n          baseTimes: formatDateRanges(formValues.baseTimes),\n          compareTimes: formatDateRanges(formValues.compareTimes),\n        &#125;);\n      &#125;\n    &#125;\n  &#125;, [realPathname]);\n\n  const [form] &#x3D; Form.useForm();\n\n  useImperativeHandle(\n    ref,\n    () &#x3D;&gt; (&#123;\n      reset() &#123;\n        form.resetFields();\n      &#125;,\n      getFieldsValue() &#123;\n        return form.getFieldsValue();\n      &#125;,\n      submit() &#123;&#125;,\n      setForm(v) &#123;\n        form.setFieldsValue(v);\n      &#125;,\n    &#125;),\n    []\n  );\n\n  const handleFinish &#x3D; useMemoizedFn((values: any) &#x3D;&gt; &#123;\n    &#x2F;&#x2F; delete values.baseTimes\n    &#x2F;&#x2F; TODO: 处理时间\n\n    const formValues &#x3D; &#123;\n      ...values,\n      baseTimes: formatDateRanges(values.baseTimes),\n      compareTimes: formatDateRanges(values.compareTimes),\n    &#125;;\n    console.log(&#39;数据&#39;, formValues);\n\n    props.onFormSubmit?.(formValues);\n  &#125;);\n\n  const handleChange &#x3D; useMemoizedFn((v?: any) &#x3D;&gt; &#123;\n    const formValues &#x3D; form.getFieldsValue();\n    localStorage.setItem(realPathname, JSON.stringify(&#123; ...formValues, pin: pageStore.pin &#125;));\n    props.onFormChange?.(formValues);\n  &#125;);\n\n  const handleChangeCompare &#x3D; useMemoizedFn((e: any) &#x3D;&gt; &#123;\n    handleChange();\n    setPageStore(&#123; ...pageStore, compare: e.target.checked &#125;);\n  &#125;);\n\n  &#x2F;&#x2F; eslint-disable-next-line arrow-body-style\n  const disabledDate: RangePickerProps[&#39;disabledDate&#39;] &#x3D; (current) &#x3D;&gt; &#123;\n    &#x2F;&#x2F; Can not select days before today and today\n    return current &gt; moment().add(1, &#39;day&#39;).endOf(&#39;day&#39;);\n  &#125;;\n\n  useEffect(() &#x3D;&gt; &#123;\n    setClientStore(pageStore);\n  &#125;, [pageStore]);\n\n  return (\n    &lt;div\n      style&#x3D;&#123;&#123;\n        padding: &#39;10px 12px 10px 12px&#39;,\n        marginBottom: 8,\n        backgroundColor: &#39;#fffffff5&#39;,\n        top: 0,\n        zIndex: 99,\n        boxShadow: &#39;rgb(0 0 0 &#x2F; 4%) 0px 2px 2px&#39;,\n        position: pageStore.pin ? &#39;sticky&#39; : &#39;static&#39;,\n      &#125;&#125;\n    &gt;\n      &lt;Form form&#x3D;&#123;form&#125; onFinish&#x3D;&#123;handleFinish&#125; onReset&#x3D;&#123;handleChange&#125; size&#x3D;&#123;size&#125;&gt;\n        &lt;div style&#x3D;&#123;&#123; flex: 1, display: &#39;flex&#39; &#125;&#125;&gt;\n          &#123;activeCard?.showWorkloads &amp;&amp; (\n            &lt;Form.Item name&#x3D;&quot;dayRange&quot; label&#x3D;&quot;&quot; style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125;&gt;\n              &lt;Radio.Group optionType&#x3D;&quot;button&quot; buttonStyle&#x3D;&quot;solid&quot; size&#x3D;&#123;size&#125; onChange&#x3D;&#123;handleChange&#125;&gt;\n                &#123;workloads.map((item: any) &#x3D;&gt; (\n                  &lt;Radio.Button key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                    &#123;item.text&#125;\n                  &lt;&#x2F;Radio.Button&gt;\n                ))&#125;\n              &lt;&#x2F;Radio.Group&gt;\n            &lt;&#x2F;Form.Item&gt;\n          )&#125;\n          &lt;Form.Item\n            &#x2F;&#x2F; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125;\n            style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125;\n            name&#x3D;&quot;workloadBearType&quot;\n            label&#x3D;&quot;技术承担类型&quot;\n          &gt;\n            &lt;Select placeholder&#x3D;&quot;请选择&quot; allowClear onChange&#x3D;&#123;handleChange&#125; size&#x3D;&#123;size&#125;&gt;\n              &#123;workloadBearTypes?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                  &#123;item.label&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n          &lt;Form.Item style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125; name&#x3D;&quot;grades&quot; label&#x3D;&quot;客户等级&quot;&gt;\n            &lt;Select\n              placeholder&#x3D;&quot;请选择&quot;\n              allowClear\n              showArrow\n              mode&#x3D;&quot;multiple&quot;\n              size&#x3D;&#123;size&#125;\n              maxTagCount&#x3D;&#123;&#39;responsive&#39;&#125;\n              onChange&#x3D;&#123;handleChange&#125;\n            &gt;\n              &#123;clientLevels?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                  &#123;item.label&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n          &lt;Form.Item style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125; name&#x3D;&quot;businessLineIds&quot; label&#x3D;&quot;承接业务线&quot;&gt;\n            &lt;Select\n              placeholder&#x3D;&quot;请选择&quot;\n              allowClear\n              showArrow\n              mode&#x3D;&quot;multiple&quot;\n              size&#x3D;&#123;size&#125;\n              maxTagCount&#x3D;&#123;&#39;responsive&#39;&#125;\n              onChange&#x3D;&#123;handleChange&#125;\n            &gt;\n              &#123;buslines?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                  &#123;item.label&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n          &lt;Form.Item style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125; name&#x3D;&quot;technicalBusinessIds&quot; label&#x3D;&quot;技术实施线&quot;&gt;\n            &lt;Select\n              placeholder&#x3D;&quot;请选择&quot;\n              allowClear\n              showArrow\n              mode&#x3D;&quot;multiple&quot;\n              size&#x3D;&#123;size&#125;\n              onChange&#x3D;&#123;handleChange&#125;\n              maxTagTextLength&#x3D;&#123;120&#125;\n              maxTagCount&#x3D;&#123;&#39;responsive&#39;&#125;\n            &gt;\n              &#123;techLineList?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.id&#125; value&#x3D;&#123;item.id&#125;&gt;\n                  &#123;item.parentName&#125;&#x2F;&#123;item.businessName&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n        &lt;&#x2F;div&gt;\n\n        &#123;clientStore.expand &amp;&amp; (\n          &lt;&gt;\n            &lt;Form.Item name&#x3D;&quot;dayType&quot; label&#x3D;&quot;时间&quot;&gt;\n              &lt;Radio.Group optionType&#x3D;&quot;button&quot; buttonStyle&#x3D;&quot;solid&quot; size&#x3D;&#123;size&#125; onChange&#x3D;&#123;handleChange&#125;&gt;\n                &#123;(activeCard?.daytypes?.map((i) &#x3D;&gt; dayTypes[i]) || dayTypes).map((item: any) &#x3D;&gt; (\n                  &lt;Radio.Button key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                    &#123;item.text&#125;\n                  &lt;&#x2F;Radio.Button&gt;\n                ))&#125;\n              &lt;&#x2F;Radio.Group&gt;\n            &lt;&#x2F;Form.Item&gt;\n\n            &lt;div style&#x3D;&#123;&#123; display: &#39;flex&#39; &#125;&#125;&gt;\n              &lt;Form.Item name&#x3D;&quot;baseTimes&quot; label&#x3D;&quot;&quot; style&#x3D;&#123;&#123; marginLeft: 40 &#125;&#125;&gt;\n                &lt;RangePicker\n                  format&#x3D;&quot;YYYY-MM-DD&quot;\n                  placeholder&#x3D;&#123;[&#39;请选择&#39;, &#39;请选择&#39;]&#125;\n                  onChange&#x3D;&#123;handleChange&#125;\n                  disabledDate&#x3D;&#123;disabledDate&#125;\n                  allowEmpty&#x3D;&#123;[true, true]&#125;\n                &#x2F;&gt;\n              &lt;&#x2F;Form.Item&gt;\n\n              &#123;activeCard?.showCompare &amp;&amp; (\n                &lt;&gt;\n                  &lt;Form.Item style&#x3D;&#123;&#123; marginLeft: 10, marginRight: 10 &#125;&#125; name&#x3D;&quot;compare&quot; valuePropName&#x3D;&quot;checked&quot;&gt;\n                    &lt;Checkbox onChange&#x3D;&#123;handleChangeCompare&#125;&gt;对比时间段&lt;&#x2F;Checkbox&gt;\n                  &lt;&#x2F;Form.Item&gt;\n                  &#123;pageStore.compare &amp;&amp; (\n                    &lt;Form.Item name&#x3D;&quot;compareTimes&quot; label&#x3D;&quot;&quot;&gt;\n                      &lt;RangePicker\n                        format&#x3D;&quot;YYYY-MM-DD&quot;\n                        placeholder&#x3D;&#123;[&#39;请选择&#39;, &#39;请选择&#39;]&#125;\n                        onChange&#x3D;&#123;handleChange&#125;\n                        disabledDate&#x3D;&#123;disabledDate&#125;\n                        allowEmpty&#x3D;&#123;[true, true]&#125;\n                      &#x2F;&gt;\n                    &lt;&#x2F;Form.Item&gt;\n                  )&#125;\n                &lt;&#x2F;&gt;\n              )&#125;\n\n              &#123;activeCard?.showDayRangeTypes &amp;&amp; (\n                &lt;Form.Item name&#x3D;&quot;dayRange&quot; label&#x3D;&quot;&quot; style&#x3D;&#123;&#123; marginLeft: 10 &#125;&#125;&gt;\n                  &lt;Radio.Group optionType&#x3D;&quot;button&quot; buttonStyle&#x3D;&quot;solid&quot; size&#x3D;&#123;size&#125; onChange&#x3D;&#123;handleChange&#125;&gt;\n                    &#123;dayRangeTypes.map((item: any) &#x3D;&gt; (\n                      &lt;Radio.Button key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                        &#123;item.text&#125;\n                      &lt;&#x2F;Radio.Button&gt;\n                    ))&#125;\n                  &lt;&#x2F;Radio.Group&gt;\n                &lt;&#x2F;Form.Item&gt;\n              )&#125;\n            &lt;&#x2F;div&gt;\n          &lt;&#x2F;&gt;\n        )&#125;\n\n        &lt;Row&gt;\n          &lt;Col span&#x3D;&#123;24&#125; style&#x3D;&#123;&#123; textAlign: &#39;right&#39; &#125;&#125;&gt;\n            &lt;Button type&#x3D;&quot;primary&quot; htmlType&#x3D;&quot;submit&quot;&gt;\n              查询\n            &lt;&#x2F;Button&gt;\n            &lt;Button\n              style&#x3D;&#123;&#123; margin: &#39;0 9px&#39; &#125;&#125;\n              onClick&#x3D;&#123;() &#x3D;&gt; &#123;\n                form.resetFields();\n              &#125;&#125;\n            &gt;\n              重置\n            &lt;&#x2F;Button&gt;\n            &lt;a\n              style&#x3D;&#123;&#123; fontSize: 12 &#125;&#125;\n              onClick&#x3D;&#123;() &#x3D;&gt; &#123;\n                setPageStore(&#123; ...clientStore, expand: !clientStore.expand &#125;);\n              &#125;&#125;\n            &gt;\n              &#123;clientStore.expand ? &lt;UpOutlined &#x2F;&gt; : &lt;DownOutlined &#x2F;&gt;&#125; &#123;clientStore.expand ? &#39;收起&#39; : &#39;展开&#39;&#125;\n            &lt;&#x2F;a&gt;\n            &lt;span style&#x3D;&#123;&#123; padding: &#39;6px 6px 6px 12px&#39; &#125;&#125;&gt;\n              &lt;Space&gt;\n                &lt;a className&#x3D;&#123;styles.downloadBtn&#125;&gt;\n                  &lt;DownloadOutlined &#x2F;&gt;\n                  下载\n                &lt;&#x2F;a&gt;\n                &lt;a onClick&#x3D;&#123;() &#x3D;&gt; setPageStore(&#123; ...clientStore, pin: !clientStore.pin &#125;)&#125;&gt;\n                  &lt;PushpinOutlined\n                    style&#x3D;&#123;&#123;\n                      color: pageStore.pin &#x3D;&#x3D;&#x3D; true ? &#39;#1890ff&#39; : &#39;#616161&#39;,\n                    &#125;&#125;\n                  &#x2F;&gt;\n                &lt;&#x2F;a&gt;\n                &#123;&#96;$&#123;pageStore.pin&#125;&#96;&#125;\n              &lt;&#x2F;Space&gt;\n            &lt;&#x2F;span&gt;\n          &lt;&#x2F;Col&gt;\n        &lt;&#x2F;Row&gt;\n      &lt;&#x2F;Form&gt;\n    &lt;&#x2F;div&gt;\n  );\n&#125;);\n\nexport default FormSearch;</code></pre>\n\n<h2 id=\"修改方案\"><a href=\"#修改方案\" class=\"headerlink\" title=\"修改方案\"></a>修改方案</h2><p>用一个 clientStore 做 react 地状态缓存，次 clientStore 不受服务端渲染&#x2F;客户端渲染所影响</p>\n<h2 id=\"修改后\"><a href=\"#修改后\" class=\"headerlink\" title=\"修改后\"></a>修改后</h2><h3 id=\"页面代码\"><a href=\"#页面代码\" class=\"headerlink\" title=\"页面代码\"></a>页面代码</h3><pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">import &#123; ICardItem &#125; from &#39;@&#x2F;components&#x2F;drag-grid&#x2F;context&#39;;\nimport &#123; useNextLocalStorageState &#125; from &#39;@&#x2F;hooks&#x2F;nextLocalStorageState&#39;;\nimport &#123; fetchBearerOptions, getBusinessLineList, getClientLevelList, getTechLineList &#125; from &#39;@&#x2F;service&#x2F;common&#39;;\nimport &#123; DownloadOutlined, DownOutlined, PushpinOutlined, UpOutlined &#125; from &#39;@ant-design&#x2F;icons&#39;;\nimport isServer from &#39;@ty-fe&#x2F;next&#x2F;isServer&#39;;\nimport &#123; useRouter &#125; from &#39;@ty-fe&#x2F;next&#x2F;router&#39;;\nimport &#123; useMemoizedFn &#125; from &#39;ahooks&#39;;\nimport &#123; Button, Checkbox, Col, DatePicker, Form, Radio, Row, Select, Space &#125; from &#39;antd&#39;;\nimport &#123; SizeType &#125; from &#39;antd&#x2F;lib&#x2F;config-provider&#x2F;SizeContext&#39;;\nimport &#123; RangePickerProps &#125; from &#39;antd&#x2F;lib&#x2F;date-picker&#39;;\nimport moment from &#39;moment&#39;;\nimport React, &#123; forwardRef, useEffect, useImperativeHandle, useState &#125; from &#39;react&#39;;\nimport &#123; allList, workloads, dayTypes, dayRangeTypes &#125; from &#39;..&#39;;\nimport styles from &#39;.&#x2F;index.module.scss&#39;;\n\nfunction formatDateRanges(ranges: any[]) &#123;\n  const results &#x3D; [];\n  if (!ranges) &#123;\n    return [undefined, undefined];\n  &#125;\n  if (ranges[0]) &#123;\n    results.push(moment(ranges[0]).format(&#39;YYYY-MM-DD&#39;));\n  &#125; else &#123;\n    results.push(undefined);\n  &#125;\n  if (ranges[1]) &#123;\n    results.push(moment(ranges[1]).format(&#39;YYYY-MM-DD&#39;));\n  &#125; else &#123;\n    results.push(undefined);\n  &#125;\n\n  return results;\n&#125;\n\nfunction transRangesToMoments(ranges: any[]) &#123;\n  let results &#x3D; [];\n  if (!ranges) &#123;\n    results &#x3D; [undefined, undefined];\n  &#125; else &#123;\n    if (ranges[0]) &#123;\n      results.push(moment(ranges[0]));\n    &#125; else &#123;\n      results.push(undefined);\n    &#125;\n    if (ranges[1]) &#123;\n      results.push(moment(ranges[1]));\n    &#125; else &#123;\n      results.push(undefined);\n    &#125;\n  &#125;\n\n  return results;\n&#125;\n\nexport function transRangesToObject(ranges: any[], format: (v: any) &#x3D;&gt; any) &#123;\n  const obj &#x3D; &#123;\n    start: undefined,\n    end: undefined,\n  &#125;;\n  if (ranges[0]) &#123;\n    obj.start &#x3D; format ? format(ranges[0]) : ranges[0];\n  &#125;\n  if (ranges[1]) &#123;\n    obj.end &#x3D; format ? format(ranges[1]) : ranges[1];\n  &#125;\n\n  return obj;\n&#125;\n\ninterface IProps &#123;\n  &#x2F;&#x2F; trigger?: &#39;onChange&#39;\n  manual?: boolean;\n  size?: SizeType;\n  onFormChange?: (v: any) &#x3D;&gt; void;\n  onFormSubmit?: (v: any) &#x3D;&gt; void;\n&#125;\nconst &#123; RangePicker &#125; &#x3D; DatePicker;\ninterface IRef &#123;\n  reset: () &#x3D;&gt; void;\n  submit: () &#x3D;&gt; void;\n  setForm: (v: any) &#x3D;&gt; void;\n  getFieldsValue: () &#x3D;&gt; any;\n&#125;\nconst &#123; Option &#125; &#x3D; Select;\n\nconst FormSearch &#x3D; forwardRef&lt;IRef, IProps&gt;((props, ref) &#x3D;&gt; &#123;\n  const &#123; manual &#x3D; false, size &#125; &#x3D; props;\n  const router &#x3D; useRouter();\n  &#x2F;&#x2F; @ts-ignore\n  const &#123; realPathname &#125; &#x3D; router;\n  const &#123; type &#125; &#x3D; router.query;\n\n  const [activeCard, setActiveCard] &#x3D; useState&lt;ICardItem&gt;(&#123;&#125; as ICardItem);\n\n  const [pageStore, setPageStore] &#x3D; useNextLocalStorageState&lt;Record&lt;string, any&gt; | undefined&gt;(&#96;$&#123;realPathname&#125;_page_store&#96;, &#123;\n    defaultValue: &#123; pin: true, expand: true &#125;,\n  &#125;);\n\n  &#x2F;&#x2F; 待选项\n  const [workloadBearTypes, setWorkloadBearTypes] &#x3D; useState([]);\n  const [clientLevels, setClientLevels] &#x3D; useState([]);\n  const [buslines, setBuslines] &#x3D; useState([]);\n  const [techLineList, setTechLineList] &#x3D; useState([]);\n\n  const handleGetWorkloadBearTypes &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await fetchBearerOptions();\n    if (res.success) &#123;\n      setWorkloadBearTypes(res.result);\n    &#125;\n  &#125;);\n\n  const handleGetClientLevelList &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await getClientLevelList();\n    if (res.success) &#123;\n      setClientLevels(res.result);\n    &#125;\n  &#125;);\n\n  const handleGetBuzlines &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await getBusinessLineList();\n    if (res.success) &#123;\n      setBuslines(res.result);\n    &#125;\n  &#125;);\n\n  const handleGetTechLineList &#x3D; useMemoizedFn(async () &#x3D;&gt; &#123;\n    const res &#x3D; await getTechLineList();\n    if (res.success) &#123;\n      setTechLineList(res.result.content);\n    &#125;\n  &#125;);\n\n  useEffect(() &#x3D;&gt; &#123;\n    handleGetWorkloadBearTypes();\n    handleGetClientLevelList();\n    handleGetBuzlines();\n    handleGetTechLineList();\n  &#125;, []);\n\n  useEffect(() &#x3D;&gt; &#123;\n    const _active &#x3D; allList.find((item) &#x3D;&gt; item.code &#x3D;&#x3D;&#x3D; type);\n    setActiveCard(_active || (&#123;&#125; as ICardItem));\n  &#125;, [type]);\n\n  useEffect(() &#x3D;&gt; &#123;\n    if (!isServer) &#123;\n      let formValues;\n      try &#123;\n        formValues &#x3D; JSON.parse(localStorage.getItem(realPathname));\n\n        formValues &#x3D; &#123;\n          ...formValues,\n          baseTimes: transRangesToMoments(formValues.baseTimes),\n          compareTimes: transRangesToMoments(formValues.compareTimes),\n        &#125;;\n      &#125; catch (error) &#123;\n        formValues &#x3D; &#123;\n          baseTimes: [undefined, undefined],\n          compareTimes: [undefined, undefined],\n        &#125;;\n      &#125;\n\n      form?.setFieldsValue(formValues);\n\n      if (!manual) &#123;\n        props.onFormSubmit?.(&#123;\n          ...formValues,\n          baseTimes: formatDateRanges(formValues.baseTimes),\n          compareTimes: formatDateRanges(formValues.compareTimes),\n        &#125;);\n      &#125;\n    &#125;\n  &#125;, [realPathname]);\n\n  const [form] &#x3D; Form.useForm();\n\n  useImperativeHandle(\n    ref,\n    () &#x3D;&gt; (&#123;\n      reset() &#123;\n        form.resetFields();\n      &#125;,\n      getFieldsValue() &#123;\n        return form.getFieldsValue();\n      &#125;,\n      submit() &#123;&#125;,\n      setForm(v) &#123;\n        form.setFieldsValue(v);\n      &#125;,\n    &#125;),\n    []\n  );\n\n  const handleFinish &#x3D; useMemoizedFn((values: any) &#x3D;&gt; &#123;\n    &#x2F;&#x2F; delete values.baseTimes\n    &#x2F;&#x2F; TODO: 处理时间\n\n    const formValues &#x3D; &#123;\n      ...values,\n      baseTimes: formatDateRanges(values.baseTimes),\n      compareTimes: formatDateRanges(values.compareTimes),\n    &#125;;\n    console.log(&#39;数据&#39;, formValues);\n\n    props.onFormSubmit?.(formValues);\n  &#125;);\n\n  const handleChange &#x3D; useMemoizedFn((v?: any) &#x3D;&gt; &#123;\n    const formValues &#x3D; form.getFieldsValue();\n    localStorage.setItem(realPathname, JSON.stringify(&#123; ...formValues, pin: pageStore.pin &#125;));\n    props.onFormChange?.(formValues);\n  &#125;);\n\n  const handleChangeCompare &#x3D; useMemoizedFn((e: any) &#x3D;&gt; &#123;\n    handleChange();\n    setPageStore(&#123; ...pageStore, compare: e.target.checked &#125;);\n  &#125;);\n\n  &#x2F;&#x2F; eslint-disable-next-line arrow-body-style\n  const disabledDate: RangePickerProps[&#39;disabledDate&#39;] &#x3D; (current) &#x3D;&gt; &#123;\n    &#x2F;&#x2F; Can not select days before today and today\n    return current &gt; moment().add(1, &#39;day&#39;).endOf(&#39;day&#39;);\n  &#125;;\n\n  return (\n    &lt;div\n      style&#x3D;&#123;&#123;\n        padding: &#39;10px 12px 10px 12px&#39;,\n        marginBottom: 8,\n        backgroundColor: &#39;#fffffff5&#39;,\n        top: 0,\n        zIndex: 99,\n        boxShadow: &#39;rgb(0 0 0 &#x2F; 4%) 0px 2px 2px&#39;,\n        position: pageStore.pin ? &#39;sticky&#39; : &#39;static&#39;,\n      &#125;&#125;\n    &gt;\n      &lt;Form form&#x3D;&#123;form&#125; onFinish&#x3D;&#123;handleFinish&#125; onReset&#x3D;&#123;handleChange&#125; size&#x3D;&#123;size&#125;&gt;\n        &lt;div style&#x3D;&#123;&#123; flex: 1, display: &#39;flex&#39; &#125;&#125;&gt;\n          &#123;activeCard?.showWorkloads &amp;&amp; (\n            &lt;Form.Item name&#x3D;&quot;dayRange&quot; label&#x3D;&quot;&quot; style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125;&gt;\n              &lt;Radio.Group optionType&#x3D;&quot;button&quot; buttonStyle&#x3D;&quot;solid&quot; size&#x3D;&#123;size&#125; onChange&#x3D;&#123;handleChange&#125;&gt;\n                &#123;workloads.map((item: any) &#x3D;&gt; (\n                  &lt;Radio.Button key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                    &#123;item.text&#125;\n                  &lt;&#x2F;Radio.Button&gt;\n                ))&#125;\n              &lt;&#x2F;Radio.Group&gt;\n            &lt;&#x2F;Form.Item&gt;\n          )&#125;\n          &lt;Form.Item\n            &#x2F;&#x2F; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125;\n            style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125;\n            name&#x3D;&quot;workloadBearType&quot;\n            label&#x3D;&quot;技术承担类型&quot;\n          &gt;\n            &lt;Select placeholder&#x3D;&quot;请选择&quot; allowClear onChange&#x3D;&#123;handleChange&#125; size&#x3D;&#123;size&#125;&gt;\n              &#123;workloadBearTypes?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                  &#123;item.label&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n          &lt;Form.Item style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125; name&#x3D;&quot;grades&quot; label&#x3D;&quot;客户等级&quot;&gt;\n            &lt;Select\n              placeholder&#x3D;&quot;请选择&quot;\n              allowClear\n              showArrow\n              mode&#x3D;&quot;multiple&quot;\n              size&#x3D;&#123;size&#125;\n              maxTagCount&#x3D;&#123;&#39;responsive&#39;&#125;\n              onChange&#x3D;&#123;handleChange&#125;\n            &gt;\n              &#123;clientLevels?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                  &#123;item.label&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n          &lt;Form.Item style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125; name&#x3D;&quot;businessLineIds&quot; label&#x3D;&quot;承接业务线&quot;&gt;\n            &lt;Select\n              placeholder&#x3D;&quot;请选择&quot;\n              allowClear\n              showArrow\n              mode&#x3D;&quot;multiple&quot;\n              size&#x3D;&#123;size&#125;\n              maxTagCount&#x3D;&#123;&#39;responsive&#39;&#125;\n              onChange&#x3D;&#123;handleChange&#125;\n            &gt;\n              &#123;buslines?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                  &#123;item.label&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n          &lt;Form.Item style&#x3D;&#123;&#123; width: &#39;33.3%&#39; &#125;&#125; labelCol&#x3D;&#123;&#123; span: 9 &#125;&#125; name&#x3D;&quot;technicalBusinessIds&quot; label&#x3D;&quot;技术实施线&quot;&gt;\n            &lt;Select\n              placeholder&#x3D;&quot;请选择&quot;\n              allowClear\n              showArrow\n              mode&#x3D;&quot;multiple&quot;\n              size&#x3D;&#123;size&#125;\n              onChange&#x3D;&#123;handleChange&#125;\n              maxTagTextLength&#x3D;&#123;120&#125;\n              maxTagCount&#x3D;&#123;&#39;responsive&#39;&#125;\n            &gt;\n              &#123;techLineList?.map((item) &#x3D;&gt; (\n                &lt;Option key&#x3D;&#123;item.id&#125; value&#x3D;&#123;item.id&#125;&gt;\n                  &#123;item.parentName&#125;&#x2F;&#123;item.businessName&#125;\n                &lt;&#x2F;Option&gt;\n              ))&#125;\n            &lt;&#x2F;Select&gt;\n          &lt;&#x2F;Form.Item&gt;\n        &lt;&#x2F;div&gt;\n\n        &#123;pageStore.expand &amp;&amp; (\n          &lt;&gt;\n            &lt;Form.Item name&#x3D;&quot;dayType&quot; label&#x3D;&quot;时间&quot;&gt;\n              &lt;Radio.Group optionType&#x3D;&quot;button&quot; buttonStyle&#x3D;&quot;solid&quot; size&#x3D;&#123;size&#125; onChange&#x3D;&#123;handleChange&#125;&gt;\n                &#123;(activeCard?.daytypes?.map((i) &#x3D;&gt; dayTypes[i]) || dayTypes).map((item: any) &#x3D;&gt; (\n                  &lt;Radio.Button key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                    &#123;item.text&#125;\n                  &lt;&#x2F;Radio.Button&gt;\n                ))&#125;\n              &lt;&#x2F;Radio.Group&gt;\n            &lt;&#x2F;Form.Item&gt;\n\n            &lt;div style&#x3D;&#123;&#123; display: &#39;flex&#39; &#125;&#125;&gt;\n              &lt;Form.Item name&#x3D;&quot;baseTimes&quot; label&#x3D;&quot;&quot; style&#x3D;&#123;&#123; marginLeft: 40 &#125;&#125;&gt;\n                &lt;RangePicker\n                  format&#x3D;&quot;YYYY-MM-DD&quot;\n                  placeholder&#x3D;&#123;[&#39;请选择&#39;, &#39;请选择&#39;]&#125;\n                  onChange&#x3D;&#123;handleChange&#125;\n                  disabledDate&#x3D;&#123;disabledDate&#125;\n                  allowEmpty&#x3D;&#123;[true, true]&#125;\n                &#x2F;&gt;\n              &lt;&#x2F;Form.Item&gt;\n\n              &#123;activeCard?.showCompare &amp;&amp; (\n                &lt;&gt;\n                  &lt;Form.Item style&#x3D;&#123;&#123; marginLeft: 10, marginRight: 10 &#125;&#125; name&#x3D;&quot;compare&quot; valuePropName&#x3D;&quot;checked&quot;&gt;\n                    &lt;Checkbox onChange&#x3D;&#123;handleChangeCompare&#125;&gt;对比时间段&lt;&#x2F;Checkbox&gt;\n                  &lt;&#x2F;Form.Item&gt;\n                  &#123;pageStore.compare &amp;&amp; (\n                    &lt;Form.Item name&#x3D;&quot;compareTimes&quot; label&#x3D;&quot;&quot;&gt;\n                      &lt;RangePicker\n                        format&#x3D;&quot;YYYY-MM-DD&quot;\n                        placeholder&#x3D;&#123;[&#39;请选择&#39;, &#39;请选择&#39;]&#125;\n                        onChange&#x3D;&#123;handleChange&#125;\n                        disabledDate&#x3D;&#123;disabledDate&#125;\n                        allowEmpty&#x3D;&#123;[true, true]&#125;\n                      &#x2F;&gt;\n                    &lt;&#x2F;Form.Item&gt;\n                  )&#125;\n                &lt;&#x2F;&gt;\n              )&#125;\n\n              &#123;activeCard?.showDayRangeTypes &amp;&amp; (\n                &lt;Form.Item name&#x3D;&quot;dayRange&quot; label&#x3D;&quot;&quot; style&#x3D;&#123;&#123; marginLeft: 10 &#125;&#125;&gt;\n                  &lt;Radio.Group optionType&#x3D;&quot;button&quot; buttonStyle&#x3D;&quot;solid&quot; size&#x3D;&#123;size&#125; onChange&#x3D;&#123;handleChange&#125;&gt;\n                    &#123;dayRangeTypes.map((item: any) &#x3D;&gt; (\n                      &lt;Radio.Button key&#x3D;&#123;item.value&#125; value&#x3D;&#123;item.value&#125;&gt;\n                        &#123;item.text&#125;\n                      &lt;&#x2F;Radio.Button&gt;\n                    ))&#125;\n                  &lt;&#x2F;Radio.Group&gt;\n                &lt;&#x2F;Form.Item&gt;\n              )&#125;\n            &lt;&#x2F;div&gt;\n          &lt;&#x2F;&gt;\n        )&#125;\n\n        &lt;Row&gt;\n          &lt;Col span&#x3D;&#123;24&#125; style&#x3D;&#123;&#123; textAlign: &#39;right&#39; &#125;&#125;&gt;\n            &lt;Button type&#x3D;&quot;primary&quot; htmlType&#x3D;&quot;submit&quot;&gt;\n              查询\n            &lt;&#x2F;Button&gt;\n            &lt;Button\n              style&#x3D;&#123;&#123; margin: &#39;0 9px&#39; &#125;&#125;\n              onClick&#x3D;&#123;() &#x3D;&gt; &#123;\n                form.resetFields();\n              &#125;&#125;\n            &gt;\n              重置\n            &lt;&#x2F;Button&gt;\n            &lt;a\n              style&#x3D;&#123;&#123; fontSize: 12 &#125;&#125;\n              onClick&#x3D;&#123;() &#x3D;&gt; &#123;\n                setPageStore(&#123; ...pageStore, expand: !pageStore.expand &#125;);\n              &#125;&#125;\n            &gt;\n              &#123;pageStore.expand ? &lt;UpOutlined &#x2F;&gt; : &lt;DownOutlined &#x2F;&gt;&#125; &#123;pageStore.expand ? &#39;收起&#39; : &#39;展开&#39;&#125;\n            &lt;&#x2F;a&gt;\n            &lt;span style&#x3D;&#123;&#123; padding: &#39;6px 6px 6px 12px&#39; &#125;&#125;&gt;\n              &lt;Space&gt;\n                &lt;a className&#x3D;&#123;styles.downloadBtn&#125;&gt;\n                  &lt;DownloadOutlined &#x2F;&gt;\n                  下载\n                &lt;&#x2F;a&gt;\n                &lt;a onClick&#x3D;&#123;() &#x3D;&gt; setPageStore(&#123; ...pageStore, pin: !pageStore.pin &#125;)&#125;&gt;\n                  &lt;PushpinOutlined\n                    style&#x3D;&#123;&#123;\n                      color: pageStore.pin &#x3D;&#x3D;&#x3D; true ? &#39;#1890ff&#39; : &#39;#616161&#39;,\n                    &#125;&#125;\n                  &#x2F;&gt;\n                &lt;&#x2F;a&gt;\n                &#123;&#96;$&#123;pageStore.pin&#125;&#96;&#125;\n              &lt;&#x2F;Space&gt;\n            &lt;&#x2F;span&gt;\n          &lt;&#x2F;Col&gt;\n        &lt;&#x2F;Row&gt;\n      &lt;&#x2F;Form&gt;\n    &lt;&#x2F;div&gt;\n  );\n&#125;);\n\nexport default FormSearch;</code></pre>\n\n<h3 id=\"useNextLocalStorageState\"><a href=\"#useNextLocalStorageState\" class=\"headerlink\" title=\"useNextLocalStorageState\"></a>useNextLocalStorageState</h3><pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">import &#123; useLocalStorageState &#125; from &#39;ahooks&#39;;\nimport &#123; useEffect, useState &#125; from &#39;react&#39;;\n\nexport type IFuncUpdater&lt;T&gt; &#x3D; (previousState?: T) &#x3D;&gt; T;\nexport type IFuncStorage &#x3D; () &#x3D;&gt; Storage;\n\nexport const isFunction &#x3D; (value: unknown): value is (...args: any[]) &#x3D;&gt; any &#x3D;&gt; typeof value &#x3D;&#x3D;&#x3D; &#39;function&#39;;\nexport const isUndef &#x3D; (value: unknown): value is undefined &#x3D;&gt; typeof value &#x3D;&#x3D;&#x3D; &#39;undefined&#39;;\n\nexport interface Options&lt;T&gt; &#123;\n  serializer?: (value: T) &#x3D;&gt; string;\n  deserializer?: (value: string) &#x3D;&gt; T;\n  defaultValue?: T | IFuncUpdater&lt;T&gt;;\n&#125;\n\nexport const useNextLocalStorageState &#x3D; &lt;T&gt;(key: string, options?: Options&lt;T&gt;) &#x3D;&gt; &#123;\n  const [clientState, setClientState] &#x3D; useState&lt;T&gt;(&#123;&#125; as T);\n\n  const [state, updateState] &#x3D; useLocalStorageState&lt;T&gt;(key, options);\n\n  useEffect(() &#x3D;&gt; &#123;\n    if (!state) &#123;\n      if (isFunction(options?.defaultValue)) &#123;\n        setClientState(options?.defaultValue());\n      &#125; else &#123;\n        setClientState(options?.defaultValue);\n      &#125;\n    &#125; else &#123;\n      setClientState(state);\n    &#125;\n  &#125;, [options, options.defaultValue, state]);\n\n  return [clientState, updateState] as const;\n&#125;;</code></pre>\n","text":"有的有警告，有的没有警告 修改前import &#123; ICardItem &#125; from &#39;@&#x2F;components&#x2F;drag-grid&#x2F;context&#39;; &#x2F;&#x2F; useNextLocalStorag...","link":"","photos":[],"count_time":{"symbolsCount":"37k","symbolsTime":"34 mins."},"categories":[{"name":"React","slug":"React","count":38,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":32,"path":"api/tags/React.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%89%E7%9A%84%E6%9C%89%E8%AD%A6%E5%91%8A%EF%BC%8C%E6%9C%89%E7%9A%84%E6%B2%A1%E6%9C%89%E8%AD%A6%E5%91%8A\"><span class=\"toc-text\">有的有警告，有的没有警告</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BF%AE%E6%94%B9%E5%89%8D\"><span class=\"toc-text\">修改前</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BF%AE%E6%94%B9%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">修改方案</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BF%AE%E6%94%B9%E5%90%8E\"><span class=\"toc-text\">修改后</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">页面代码</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#useNextLocalStorageState\"><span class=\"toc-text\">useNextLocalStorageState</span></a></li></ol></li></ol>","author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"普通数组/稀疏数组排序","uid":"0b323b28c2702d089485911093b73997","slug":"2023-01-11hook","date":"2023-01-11T09:09:12.000Z","updated":"2023-02-20T21:20:56.481Z","comments":true,"path":"api/articles/2023-01-11hook.json","keywords":null,"cover":[],"text":"稀疏数组 普通数组 useSyncTwoListState用于：同步两个数组的值，从使用的角度来看就是一个 useState 操作，逻辑完全内置 import &#123; isFunction, listWithKeyToObject &#125; from &quot;@&#...","link":"","photos":[],"count_time":{"symbolsCount":"4.9k","symbolsTime":"4 mins."},"categories":[{"name":"React","slug":"React","count":38,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":32,"path":"api/tags/React.json"}],"author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"hr谈薪套路","uid":"9822ee16ec74ae728e01b626d59044ab","slug":"2023-01-08hr","date":"2023-01-08T01:06:53.000Z","updated":"2023-02-20T21:20:56.480Z","comments":true,"path":"api/articles/2023-01-08hr.json","keywords":null,"cover":"http://n.sinaimg.cn/sinacn/w541h300/20180209/98ea-fyrkuxs5790693.jpg","text":"套路 1: 报价超过上限您目前要的薪资太高了，我们可能拿不下来，或者我们没有把握上面会获批， 分析真是情况下呢，你要的这个数，可能是在他们一个薪酬范围的一个高点，他们也不是给不起，只是有点不甘心，或者说目前可能有不止你一个人到了目前谈新的这一步，他们正在考虑挑选一个最合适的人录用...","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"面试","slug":"面试","count":5,"path":"api/categories/面试.json"}],"tags":[{"name":"面试","slug":"面试","count":20,"path":"api/tags/面试.json"}],"author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}