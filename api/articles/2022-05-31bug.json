{"title":"react useState é”™è¯¯ä½¿ç”¨","uid":"e7a12532b015cb78e0adb01f9bc03b9e","slug":"2022-05-31bug","date":"2022-05-31T02:30:47.000Z","updated":"2022-09-16T13:59:17.624Z","comments":true,"path":"api/articles/2022-05-31bug.json","keywords":null,"cover":null,"content":"<h2 id=\"Share\"><a href=\"#Share\" class=\"headerlink\" title=\"Share\"></a>Share</h2><pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">const Share: FC&lt;ShareProps&gt; &#x3D; (props) &#x3D;&gt; &#123;\n  const &#123; entityType, entityCode &#125; &#x3D; props\n\n  const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;\n    value: props.value,\n    title: props.title,\n    shareId: props.shareId,\n    mappingPassword: props.mappingPassword,\n    passwordEnable: props.passwordEnable,\n    mappingState: props.mappingState,\n    expireTime: props.expireTime,\n    shortCode: props.shortCode,\n  &#125;)\n\n\n  const &#123; value &#125; &#x3D; state\n\n  ...\n\n  return (\n    &lt;div&gt;\n      &#123;renderBtn&#125;\n      &lt;ShareModal\n        entityType&#x3D;&#123;entityType&#125;\n        entityCode&#x3D;&#123;entityCode&#125;\n        &#123;...modalProps&#125;\n        state&#x3D;&#123;state&#125;\n        setState&#x3D;&#123;setState&#125;\n      &#x2F;&gt;\n    &lt;&#x2F;div&gt;\n  )\n&#125;\n\nexport default Share\n\n</code></pre>\n\n<h2 id=\"ShareModal\"><a href=\"#ShareModal\" class=\"headerlink\" title=\"ShareModal\"></a>ShareModal</h2><pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">\ninterface ShareModalProps extends ModalFuncProps &#123;\n  entityType: EntityType\n  entityCode: string\n  className?: string\n  state: StateProps\n  setState: (state: StateProps) &#x3D;&gt; void\n&#125;\n\nconst Copy &#x3D; (&#123; text, children &#125;: &#123; text: string; children: string &#125;) &#x3D;&gt; &#123;\n  return (\n    &lt;CopyToClipboard\n      text&#x3D;&#123;text&#125;\n      onCopy&#x3D;&#123;() &#x3D;&gt; &#123;\n        message.success(&#39;é“¾æ¥å·²å¤åˆ¶&#39;)\n      &#125;&#125;\n    &gt;\n      &lt;span&gt;&#123;children&#125;&lt;&#x2F;span&gt;\n    &lt;&#x2F;CopyToClipboard&gt;\n  )\n&#125;\n\nconst ShareModal: FC&lt;ShareModalProps&gt; &#x3D; (props) &#x3D;&gt; &#123;\n  const [form] &#x3D; HookForm.useForm()\n\n  const &#123; state, setState, entityType, entityCode, ...restProps &#125; &#x3D; props\n\n  const &#123; value, title, mappingPassword, shortCode, expireTime &#125; &#x3D; state\n\n  const &#123;\n    onChange: toggle,\n    resetPassword: reset,\n    update,\n  &#125; &#x3D; useShare(&#123;\n    entityCode,\n    entityType,\n    state,\n    setState,\n  &#125;)\n\n\n  ....\n\n  return (\n    &lt;Modal\n      &#123;...restProps&#125;\n      className&#x3D;&#123;styles[&#39;share-modal-wrap&#39;]&#125;\n      title&#x3D;&quot;é“¾æ¥åˆ†äº«&quot;\n      destroyOnClose\n      width&#x3D;&#123;420&#125;\n      footer&#x3D;&#123;null&#125;\n    &gt;\n      &lt;ConditionComponent isShow&#x3D;&#123;value&#125;&gt;\n        ....\n        &lt;HookForm form&#x3D;&#123;form&#125; style&#x3D;&#123;&#123; marginBottom: 10, width: &#39;100%&#39; &#125;&#125; layout&#x3D;&quot;vertical&quot;&gt;\n          &lt;HookForm.Item noStyle shouldUpdate&gt;\n            &#123;() &#x3D;&gt; &#123;\n              const &#123; url, mappingPassword, expireTime &#125; &#x3D; form.getFieldsValue()\n              const text &#x3D; &#96;$&#123;url&#125;ï¼ˆå¯†ç ï¼š$&#123;mappingPassword&#125;ï¼‰ã€Š$&#123;title&#125;ã€‹$&#123;moment(\n                expireTime,\n              ).format(&#39;YYYY-MM-DD HH:mm:ss&#39;)&#125;è¿‡æœŸ&#96;\n              return (\n                &lt;HookForm.Item name&#x3D;&quot;url&quot; label&#x3D;&quot;&quot;&gt;\n                  &lt;Input\n                    className&#x3D;&#123;styles[&#39;share-copy&#39;]&#125;\n                    addonAfter&#x3D;&#123;&lt;Copy text&#x3D;&#123;text&#125;&gt;å¤åˆ¶é“¾æ¥å’Œå¯†ç &lt;&#x2F;Copy&gt;&#125;\n                    disabled\n                  &#x2F;&gt;\n                &lt;&#x2F;HookForm.Item&gt;\n              )\n            &#125;&#125;\n          &lt;&#x2F;HookForm.Item&gt;\n        &lt;&#x2F;HookForm&gt;\n      &lt;&#x2F;ConditionComponent&gt;\n    &lt;&#x2F;Modal&gt;\n  )\n&#125;\n\nexport default ShareModal\n</code></pre>\n\n<h2 id=\"ç”¨æˆ·åé¦ˆ\"><a href=\"#ç”¨æˆ·åé¦ˆ\" class=\"headerlink\" title=\"ç”¨æˆ·åé¦ˆ\"></a>ç”¨æˆ·åé¦ˆ</h2><p>ä¸ºä»€ä¹ˆåˆ†äº«çš„é“¾æ¥ä¸è¦åˆ†äº«çš„é“¾æ¥å¯¹ä¸ä¸Šï¼Ÿ</p>\n<h2 id=\"useCallback\"><a href=\"#useCallback\" class=\"headerlink\" title=\"useCallback\"></a>useCallback</h2><p>useCallback å—ä¾èµ–é¡¹çš„å½±å“ï¼Œä¸æ›´æ–°ï¼Œä¹‹å‰æ”¹è¿‡åŒäº‹çš„ä»£ç ï¼Œè¿™æ¬¡æ‰«äº†ä¸€æ ·ï¼Œæ²¡æœ‰ callbackï¼Œå°±è¿™é—®é¢˜ä¿®æ”¹å‡ ä¸ªäº†</p>\n<h2 id=\"useState\"><a href=\"#useState\" class=\"headerlink\" title=\"useState\"></a>useState</h2><ul>\n<li>æ‰¾äº†ä¸‹æ•°æ®<code>ShareModal</code>ç»„ä»¶,çœ‹åˆ°ä¸¤ä¸ªå…¥å‚<code>state, setState</code> ï¼Œæˆ‘è‰¹</li>\n<li>ç»§ç»­å¾€ä¸Šå±‚æ‰¾</li>\n</ul>\n<pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">&lt;ShareModal\n  entityType&#x3D;&#123;entityType&#125;\n  entityCode&#x3D;&#123;entityCode&#125;\n  &#123;...modalProps&#125;\n  state&#x3D;&#123;state&#125; &#x2F;&#x2F; ğŸ˜“\n  setState&#x3D;&#123;setState&#125; &#x2F;&#x2F;ğŸ˜“\n&#x2F;&gt;</code></pre>\n\n<ul>\n<li>å†å¾€ä¸Šæ‰¾ï¼ŒuseState å†…éƒ¨åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ•°æ®åˆå§‹åŒ–å®Œæˆä¸å†æ”¹å˜</li>\n</ul>\n<pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;\n  value: props.value,\n  title: props.title,\n  shareId: props.shareId,\n  mappingPassword: props.mappingPassword,\n  passwordEnable: props.passwordEnable,\n  mappingState: props.mappingState,\n  expireTime: props.expireTime,\n  shortCode: props.shortCode,\n&#125;);\n\nconst &#123; value &#125; &#x3D; state;</code></pre>\n\n<ul>\n<li>è¿™é‡Œä»£ç è¿™ä¹ˆå†™ï¼Œå…¶ä»–åœ°æ–¹è‚¯å®šä¹Ÿæœ‰è¿™æ ·çš„å†™æ³•ï¼ŒğŸ˜“</li>\n</ul>\n<h2 id=\"æ”¹ä¸€ä¸‹\"><a href=\"#æ”¹ä¸€ä¸‹\" class=\"headerlink\" title=\"æ”¹ä¸€ä¸‹\"></a>æ”¹ä¸€ä¸‹</h2><pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;&#125;);\n\nuseEffect(() &#x3D;&gt; &#123;\n  setState(&#123; ...props &#125;);\n&#125;, [props.shareId]);</code></pre>\n","text":"Shareconst Share: FC&lt;ShareProps&gt; &#x3D; (props) &#x3D;&gt; &#123; const &#123; entityType, entityCode &#125; &#x3D; props const [state...","link":"","photos":[],"count_time":{"symbolsCount":"4.5k","symbolsTime":"4 mins."},"categories":[{"name":"bug","slug":"bug","count":4,"path":"api/categories/bug.json"}],"tags":[{"name":"React","slug":"React","count":14,"path":"api/tags/React.json"},{"name":"bug","slug":"bug","count":6,"path":"api/tags/bug.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Share\"><span class=\"toc-text\">Share</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ShareModal\"><span class=\"toc-text\">ShareModal</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88\"><span class=\"toc-text\">ç”¨æˆ·åé¦ˆ</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useCallback\"><span class=\"toc-text\">useCallback</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useState\"><span class=\"toc-text\">useState</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%94%B9%E4%B8%80%E4%B8%8B\"><span class=\"toc-text\">æ”¹ä¸€ä¸‹</span></a></li></ol>","author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"å†å­¦Vue3-0 æ¦‚è§ˆ","uid":"98cc42407c73e25079ab5c02aa5f251b","slug":"2022-06-02vue-0","date":"2022-06-02T10:49:20.000Z","updated":"2022-09-16T13:54:56.122Z","comments":true,"path":"api/articles/2022-06-02vue-0.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/20220602185003.webp","text":"vue3 ä½¿ç”¨ proxy é‡å†™äº† vue2ï¼Œå¹¶å¢åŠ äº†ç»„åˆå¼ api ä»¥ä¸‹æ€ç»´å¯¼å›¾ä»¥vue3 æ–‡æ¡£å†…å®¹ä¸ºä¾æ®ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç»˜åˆ¶ å­¦ä¹ è¿‡ç¨‹ä¸­å¯¹æ¯”äº† vue3 å’Œ react å¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡çœ‹vueäº†ï¼Œvue3ä¸€ç›´æ²¡æ¥è§¦ï¼Œåª³å¦‡ä¸å­¦ã€‚ä¸‡ä¸€å“ªå¤©åª³å¦‡éœ€è¦ç”¨vue3äº†ï¼Œæ²¡äººå¸¦å²‚ä¸æ˜¯è¦å¤±ä¸šï¼Œèµ¶...","link":"","photos":[],"count_time":{"symbolsCount":180,"symbolsTime":"1 mins."},"categories":[{"name":"vue","slug":"vue","count":14,"path":"api/categories/vue.json"}],"tags":[{"name":"vue","slug":"vue","count":13,"path":"api/tags/vue.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"å‰ç«¯åŸºç¡€-ç¼–ç¨‹èŒƒå¼-å‡½æ•°å¼ç¼–ç¨‹ç®€å•äº†è§£","uid":"f35528e9b34223f99b96c0561880d949","slug":"2022-05-28func","date":"2022-05-28T07:25:33.000Z","updated":"2022-09-16T13:54:56.121Z","comments":true,"path":"api/articles/2022-05-28func.json","keywords":null,"cover":null,"text":"èƒŒæ™¯js ä¸ºäº†å®ç°é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œåšäº†å¾ˆå¤šäº‹æƒ…ï¼Œå¯¼è‡´å¤§å®¶åœ¨å­¦ä¹  js çš„æ—¶å€™ï¼Œä¼šé‡åˆ°å¤æ‚çš„åŸå‹ã€åŸå‹é“¾ã€ç»§æ‰¿ï¼Œè¿˜æœ‰å¯¹äººä¸å‹å¥½çš„ this ï¼›è€Œå½“æˆ‘ä»¬ç”¨è¿™äº›ä¸œè¥¿ç»„åˆèµ·æ¥æ¨¡æ‹Ÿé¢å‘å¯¹è±¡çš„ç‰¹æ€§çš„æ—¶å€™ï¼Œå°±æ›´åŠ ç—›è‹¦äº†ã€‚ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç§æ›´å‹å¥½çš„æ–¹å¼ï¼Œå‡½æ•°å¼ç¼–ç¨‹ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šé¢å‘å¯¹è±¡çš„æ€æƒ³åœ¨...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"å‰ç«¯åŸºç¡€","slug":"å‰ç«¯åŸºç¡€","count":27,"path":"api/categories/å‰ç«¯åŸºç¡€.json"}],"tags":[{"name":"å‰ç«¯åŸºç¡€","slug":"å‰ç«¯åŸºç¡€","count":29,"path":"api/tags/å‰ç«¯åŸºç¡€.json"},{"name":"é¢è¯•","slug":"é¢è¯•","count":17,"path":"api/tags/é¢è¯•.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}