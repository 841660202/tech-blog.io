{"title":"react-native-webviewä¸­å¤„ç†å¤–ç½‘é“¾æ¥","uid":"da1169afdf41f1a24b458b57385fca2d","slug":"2022-06-29rn-wewb","date":"2022-06-29T09:11:44.000Z","updated":"2022-07-06T11:54:37.690Z","comments":true,"path":"api/articles/2022-06-29rn-wewb.json","keywords":null,"cover":[],"content":"<h2 id=\"èƒŒæ™¯\"><a href=\"#èƒŒæ™¯\" class=\"headerlink\" title=\"èƒŒæ™¯\"></a>èƒŒæ™¯</h2><p>ä¹‹å‰å…¬å¸ç§»åŠ¨ç«¯æ˜¯ä½¿ç”¨ vpn è¿æ¥åˆ°å†…ç½‘ï¼Œç”±äºæŸäº›åŸå› ï¼ŒIOS ä¼ä¸šè¯ä¹¦å³å°†åˆ°æœŸï¼Œåº”ç”¨éœ€è¦ä¸Šæ¶ï¼Œvpn ä¸æ»¡è¶³ä¸Šæ¶è¦æ±‚ï¼Œæ‰€ä»¥ï¼š</p>\n<ul>\n<li>vpn è¦ä» iOS åŒ…ä¸­ç§»é™¤</li>\n<li>vpn ç§»é™¤å¯¼è‡´ä¸èƒ½ç›´æ¥è®¿é—®å†…ç½‘</li>\n<li>éœ€è¦é€šè¿‡å¤–ç½‘åŸŸåè®¿é—®å†…ç½‘èµ„æº</li>\n</ul>\n<p>ä¸åŒç¯å¢ƒçš„è¯·æ±‚</p>\n<ul>\n<li>åŸç”ŸåŠ RN ä»£ç ï¼Œæ¥å£è®¿é—®èµ° ATOP æ¥å£è®¿é—®</li>\n<li>å†…ç½‘åº”ç”¨åµŒå…¥åˆ° react-native-webview ä¸­ï¼Œä½¿ç”¨ cookie æ³¨å…¥çš„æ–¹å¼è¿›è¡Œæˆæƒï¼Œ</li>\n</ul>\n<p>å·²æœ‰çš„åŸŸåï¼š</p>\n<ul>\n<li>ä¹‹å‰å·²ç»åšäº†ä¼ä¸šå¾®ä¿¡å·¥ä½œå°åŠŸèƒ½ï¼Œè€ƒè™‘åˆ°ç”³è¯·å¤–ç½‘åŸŸåéœ€è¦èµ°å®‰å…¨ã€åˆè§„å®¡æ ¸æ¯”è¾ƒéº»çƒ¦</li>\n<li>æˆ‘ä»¬çš„ä¼ä¸šå¾®ä¿¡æˆæƒæ˜¯æ ¹æ®è¯·æ±‚å¤´åŒºåˆ†çš„ï¼ŒåŒæ—¶åº”ç”¨ä¸­ä¹Ÿæœ‰æ˜¯å¦æ˜¯å¾®ä¿¡ç¯å¢ƒçš„åˆ¤æ–­, æ‰€ä»¥ï¼šåªè¦åœ¨é¡¹ç›®ä¸­é¿å¼€å¾®ä¿¡æˆæƒï¼Œèµ° SSO æˆæƒï¼ˆcookie æ³¨å…¥ï¼‰</li>\n</ul>\n<img src=\"http://t-blog-images.aijs.top/img/20220629172711.webp\" />\n\n<p><em>é¡ºä¾¿è¯´å¥ï¼šè¿™é‡Œçš„åˆ¤æ–­æ˜¯é‡‡ç”¨(nextjs)æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ‰€ä»¥èƒ½ç›´æ¥åœ¨è¯·æ±‚å¤´ä¸­åˆ¤æ–­ï¼Œå¦‚æœä¸æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Œå¯èƒ½è¦è€ƒè™‘å…¶ä»– rn æ³¨å…¥çš„æ–¹å¼</em></p>\n<h2 id=\"æ”¹é€ \"><a href=\"#æ”¹é€ \" class=\"headerlink\" title=\"æ”¹é€ \"></a>æ”¹é€ </h2><p><strong>RN æ”¹é€ </strong></p>\n<img src=\"http://t-blog-images.aijs.top/img/20220629173240.webp\" />\n\n<p><strong>h5 é¡¹ç›®æ”¹é€ </strong></p>\n<!-- <img src=\"http://t-blog-images.aijs.top/img/20220629173017.webp\" /> -->\n<img src=\"http://t-blog-images.aijs.top/img/20220629180554.webp\" />\n\n<pre class=\"line-numbers language-ts\" data-language=\"ts\"><code class=\"language-ts\">const lang &#x3D; cookie.parse(req.headers.cookie || &#39;&#39;).gTyPlatLang || &#39;en&#39;\nconst ua &#x3D; parser(req.headers[&#39;user-agent&#39;])\nCommonModel.actions.setDevice(ua.device.type, req)\n\nif (!getWechatUserAgent(req.headers[&#39;user-agent&#39;]) &amp;&amp; req.headers[&#39;x-public&#39;]) &#123;\n  const isMobile &#x3D; ua.device.type &#x3D;&#x3D;&#x3D; &#39;mobile&#39;\n  if(!(isMobile &amp;&amp; !!req.headers.tyxz))&#123;  &#x2F;&#x2F; ç§»åŠ¨ç«¯ä¸æ˜¯ä¼ä¸šå¾®ä¿¡çš„\n    redirect(Config.tyHost + join(&#39;&#x2F;&#39;, req.url), ctx) &#x2F;&#x2F; ç§»åŠ¨ç«¯æ˜¯rnxzçš„é‡å®šå‘åˆ°å†…ç½‘\n  &#125;\n&#125;\n</code></pre>\n\n<img src=\"http://t-blog-images.aijs.top/img/20220630093816.webp\" />\n\n\n<p>æœ¬ç¯‡æ–‡ç« é’ˆå¯¹çš„æ˜¯éä¼ä¸šå¾®ä¿¡æˆæƒçš„æƒ…å†µï¼Œå³ï¼šå›¾ç¬¬ä¸€è¡Œä»å·¦åˆ°å³ï¼ˆæœ‰cookieä¿¡æ¯çš„æƒ…å†µï¼‰</p>\n<h2 id=\"æ€»ç»“ä¸‹\"><a href=\"#æ€»ç»“ä¸‹\" class=\"headerlink\" title=\"æ€»ç»“ä¸‹\"></a>æ€»ç»“ä¸‹</h2><p><strong>æŒ‰ç…§åŸæœ‰çš„è®¾è®¡ç¼ºé™·ï¼š</strong></p>\n<ul>\n<li>åŸŸåæ˜¯ç»™ä¼ä¸šå¾®ä¿¡ç”¨çš„ï¼Œæ˜¯åœ¨nginxé‚£è¾¹é…ç½®çš„è¯·æ±‚å¤´ï¼Œè¿™æœ¬èº«ä¸å¤Ÿçµæ´»</li>\n<li>ä»£ç ä¸­é€»è¾‘ï¼š<br>1.å…ˆè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œè·å–ä¸åˆ°ï¼Œ<br>2.æ£€æµ‹çŠ¶æ€ç ï¼ˆ<code>fetch</code>å·¥å…·å¯¹äºåå°è¿”å›çš„<code>401çŠ¶æ€ç </code>ï¼Œå¦‚æœæ˜¯<code>401</code>ï¼Œé»˜è®¤æ˜¯èµ°å¾®ä¿¡æˆæƒï¼Œåå°ä¸šåŠ¡æ ¡éªŒæˆæƒä¿¡æ¯ä¸é€šè¿‡çš„ï¼‰ï¼Œ<br>3.å¯¹äºä¸æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„ï¼Œæ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æ˜¯ä¼ä¸šå¾®ä¿¡ï¼Œ<br>4.å¦‚æœä¸æ˜¯é‡å®šå‘åˆ°å†…ç½‘<br>ï¼ˆè¿˜æ˜¯è¿‡äºä¾èµ–åŸŸåé…ç½®ï¼‰</li>\n</ul>\n<p><strong>é‡æ–°è®¾è®¡ï¼š</strong></p>\n<ul>\n<li>æ­£å¸¸ä¸šåŠ¡é€»è¾‘ï¼Œåº”è¯¥å…ˆåˆ¤æ–­æ˜¯ç¯å¢ƒï¼Œå†³å®šèµ°å“ªå¥—æˆæƒéªŒè¯ï¼ˆè¿™æ ·ä¸ä¼šå› ä¸ºä¸€å¥—æˆæƒï¼Œä¸€ä¸ªåŸŸåäº†ï¼‰</li>\n</ul>\n<h2 id=\"vconsole\"><a href=\"#vconsole\" class=\"headerlink\" title=\"vconsole\"></a>vconsole</h2><p>å¯¹äº react-native-webview è°ƒè¯•ï¼Œä½¿ç”¨äº† <code>vconsole</code>è°ƒè¯•ï¼Œå¯ä»¥ç®€å•æŸ¥çœ‹ä¸€äº›æ§åˆ¶å°ä¿¡æ¯ï¼ŒåŒ…æ‹¬ cookie ç›¸å…³çš„æŸ¥çœ‹ã€å¤åˆ¶ã€ç¼–è¾‘æ“ä½œ</p>\n<div style=\"display:flex;flex-direction:row; flex-wrap:wrap\">\n<img src=\"http://t-blog-images.aijs.top/img/20220629173944.webp\" style=\"margin-right: 6px\" width=300/>\n<img src=\"http://t-blog-images.aijs.top/img/20220629173856.webp\" width=300/>\n</div>\n","text":"èƒŒæ™¯ä¹‹å‰å…¬å¸ç§»åŠ¨ç«¯æ˜¯ä½¿ç”¨ vpn è¿æ¥åˆ°å†…ç½‘ï¼Œç”±äºæŸäº›åŸå› ï¼ŒIOS ä¼ä¸šè¯ä¹¦å³å°†åˆ°æœŸï¼Œåº”ç”¨éœ€è¦ä¸Šæ¶ï¼Œvpn ä¸æ»¡è¶³ä¸Šæ¶è¦æ±‚ï¼Œæ‰€ä»¥ï¼š vpn è¦ä» iOS åŒ…ä¸­ç§»é™¤ vpn ç§»é™¤å¯¼è‡´ä¸èƒ½ç›´æ¥è®¿é—®å†…ç½‘ éœ€è¦é€šè¿‡å¤–ç½‘åŸŸåè®¿é—®å†…ç½‘èµ„æº ä¸åŒç¯å¢ƒçš„è¯·æ±‚ åŸç”ŸåŠ RN ä»£ç ï¼Œæ¥å£è®¿é—®èµ° AT...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"react-native","slug":"react-native","count":1,"path":"api/categories/react-native.json"}],"tags":[{"name":"react-native","slug":"react-native","count":1,"path":"api/tags/react-native.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%83%8C%E6%99%AF\"><span class=\"toc-text\">èƒŒæ™¯</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%94%B9%E9%80%A0\"><span class=\"toc-text\">æ”¹é€ </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%80%BB%E7%BB%93%E4%B8%8B\"><span class=\"toc-text\">æ€»ç»“ä¸‹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#vconsole\"><span class=\"toc-text\">vconsole</span></a></li></ol>","author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"react hook ä½¿ç”¨ bug","uid":"e5dbf22be09b32f376c35e2a002b6557","slug":"2022-07-01bug","date":"2022-07-01T03:16:39.000Z","updated":"2022-07-06T11:54:37.691Z","comments":true,"path":"api/articles/2022-07-01bug.json","keywords":null,"cover":[],"text":"é—®é¢˜Rendered more hooks than during the previous render. è§£å†³ ä¸¤ç§æ–¹å¼è§£å†³ï¼š å‹¾å­å‰ç½® ä¸ç”¨è¿™ä¸ªå‹¾å­ æ€»ç»“å‹¾å­ä¸èƒ½åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ è¿™ä¸ªè¦æ³¨æ„å¹¶ä¸æ˜¯ä¸€å®šè¿™ç§å½¢å¼ if (æ¡ä»¶) &#123; &#x2F;&#x2F; å¦‚æœæ¡ä»¶...","link":"","photos":[],"count_time":{"symbolsCount":394,"symbolsTime":"1 mins."},"categories":[{"name":"bug","slug":"bug","count":4,"path":"api/categories/bug.json"}],"tags":[{"name":"React","slug":"React","count":4,"path":"api/tags/React.json"},{"name":"bug","slug":"bug","count":6,"path":"api/tags/bug.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"ä¼ä¸šå¾®ä¿¡æˆæƒæµç¨‹","uid":"240950b163de231df264068b4d1b9085","slug":"2022-06-29wx-auth","date":"2022-06-29T08:27:52.000Z","updated":"2022-07-06T11:54:37.691Z","comments":true,"path":"api/articles/2022-06-29wx-auth.json","keywords":null,"cover":[],"text":"å‡†å¤‡å·¥ä½œ ç¡®ä¿æœ¬åœ°å·²ç»æ­£ç¡®é…ç½®äº† HOSTï¼Œèƒ½å¤Ÿä»å·¥ä½œå°å…¥å£æ‰“å¼€æœ¬åœ°çš„å¼€å‘æœåŠ¡ ç¡®ä¿å·²è·å–åˆ°å½“å‰ä¼ä¸šçš„å”¯ä¸€ IDï¼šcorp_idï¼Œåœ¨ã€ç®¡ç†åå°ã€‘- ã€æˆ‘çš„ä¼ä¸šã€‘-ã€ä¼ä¸šä¿¡æ¯ã€‘é¡µé¢ï¼Œæœ€ä¸‹é¢æ‰¾åˆ°ã€ä¼ä¸š IDã€‘ å·²ç»é€šè¿‡æ¥å£è°ƒç”¨è·å–åˆ°å½“å‰åº”ç”¨çš„ access_tokenï¼Œè¯·å‚è€ƒ äºŒï¼šå¦‚...","link":"","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"ä¼ä¸šå¾®ä¿¡","slug":"ä¼ä¸šå¾®ä¿¡","count":2,"path":"api/categories/ä¼ä¸šå¾®ä¿¡.json"}],"tags":[{"name":"ä¼ä¸šå¾®ä¿¡","slug":"ä¼ä¸šå¾®ä¿¡","count":2,"path":"api/tags/ä¼ä¸šå¾®ä¿¡.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}