{"title":"è·¨åŸŸé—®é¢˜","uid":"1827bdebccdb6131916a11069d50f729","slug":"2022-05-09cors","date":"2022-05-09T13:30:47.000Z","updated":"2022-05-26T14:12:56.675Z","comments":true,"path":"api/articles/2022-05-09cors.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/20220509181853.webp","content":"<h2 id=\"èƒŒæ™¯\"><a href=\"#èƒŒæ™¯\" class=\"headerlink\" title=\"èƒŒæ™¯\"></a>èƒŒæ™¯</h2><p>æµè§ˆå™¨å®‰å…¨ç­–ç•¥é™åˆ¶è·¨åŸŸè®¿é—®</p>\n<p>å†…å®¹å®‰å…¨ç­–ç•¥æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚</p>\n<ol>\n<li>ä½¿ç”¨æ–¹å¼<br>ä¸ºä½¿ CSP å¯ç”¨, ä½ éœ€è¦é…ç½®ä½ çš„ç½‘ç»œæœåŠ¡å™¨è¿”å› Content-Security-Policyï¼Œæˆ–è€…åœ¨ HTML <meta> å…ƒç´ ç§ä¹Ÿå¯é…ç½®è¯¥ç­–ç•¥, ä¾‹å¦‚ï¼š</li>\n</ol>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\">&lt;meta\n  http-equiv&#x3D;&quot;Content-Security-Policy&quot;\n  content&#x3D;&quot;default-src &#39;self&#39;; img-src https:&#x2F;&#x2F;*; child-src &#39;none&#39;;&quot;\n&#x2F;&gt;</code></pre>\n\n<ol start=\"2\">\n<li>é…ç½®ç¤ºä¾‹<br>ï¼ˆ1ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…æƒ³è¦æ‰€æœ‰å†…å®¹å‡æ¥è‡ªç«™ç‚¹çš„åŒä¸€ä¸ªæº (ä¸åŒ…æ‹¬å…¶å­åŸŸå)</li>\n</ol>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\">Content-Security-Policy: default-src &#39;self&#39;</code></pre>\n\n<p>ï¼ˆ2ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸å†…å®¹æ¥è‡ªä¿¡ä»»çš„åŸŸååŠå…¶å­åŸŸå (åŸŸåä¸å¿…é¡»ä¸ CSP è®¾ç½®æ‰€åœ¨çš„åŸŸåç›¸åŒ)</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Content-Security-Policy: default-src &#39;self&#39; *.trusted.com</code></pre>\n\n<p>ï¼ˆ3ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸ç½‘é¡µåº”ç”¨çš„ç”¨æˆ·åœ¨ä»–ä»¬è‡ªå·±çš„å†…å®¹ä¸­åŒ…å«æ¥è‡ªä»»ä½•æºçš„å›¾ç‰‡, ä½†æ˜¯é™åˆ¶éŸ³é¢‘æˆ–è§†é¢‘éœ€ä»ä¿¡ä»»çš„èµ„æºæä¾›è€…(è·å¾—)ï¼Œæ‰€æœ‰è„šæœ¬å¿…é¡»ä»ç‰¹å®šä¸»æœºæœåŠ¡å™¨è·å–å¯ä¿¡çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Content-Security-Policy: default-src &#39;self&#39;;\nimg-src *;\nmedia-src media1.com media2.com; script-src userscripts.example.com</code></pre>\n\n<p>åœ¨è¿™é‡Œï¼Œå„ç§å†…å®¹é»˜è®¤ä»…å…è®¸ä»æ–‡æ¡£æ‰€åœ¨çš„æºè·å–, ä½†å­˜åœ¨å¦‚ä¸‹ä¾‹å¤–:</p>\n<p>å›¾ç‰‡å¯ä»¥ä»ä»»ä½•åœ°æ–¹åŠ è½½(æ³¨æ„ â€œ*â€œ é€šé…ç¬¦)ã€‚<br>å¤šåª’ä½“æ–‡ä»¶ä»…å…è®¸ä» media1.com å’Œ media2.com åŠ è½½(ä¸å…è®¸ä»è¿™äº›ç«™ç‚¹çš„å­åŸŸå)ã€‚<br>å¯è¿è¡Œè„šæœ¬ä»…å…è®¸æ¥è‡ªäº userscripts.example.comã€‚</p>\n<p>ä½œè€…ï¼šèœé¸¡å‰ç«¯<br>é“¾æ¥ï¼š<a href=\"https://www.jianshu.com/p/a45924e99a6d\">https://www.jianshu.com/p/a45924e99a6d</a><br>æ¥æºï¼šç®€ä¹¦<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n<h2 id=\"å¤„ç†æ–¹å¼\"><a href=\"#å¤„ç†æ–¹å¼\" class=\"headerlink\" title=\"å¤„ç†æ–¹å¼\"></a>å¤„ç†æ–¹å¼</h2><h3 id=\"nginx\"><a href=\"#nginx\" class=\"headerlink\" title=\"nginx\"></a>nginx</h3><ul>\n<li>è„šæœ¬</li>\n</ul>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">\nlisten 80; # ç›‘å¬çš„ç«¯â¼\n   add_header &#39;Access-Control-Allow-Origin&#39; &#39;$http_origin&#39; ;\n   add_header &#39;Access-Control-Allow-Credentials&#39; &#39;true&#39; ;\n   add_header &#39;Access-Control-Allow-Methods&#39; &#39;PUT,POST,GET,DELETE,OPTIONS&#39; ;\n   add_header &#39;Access-Control-Allow-Headers&#39; &#39;Content-Type,Content-Length,Authorization,Accept,X-Requested-With&#39; ;</code></pre>\n\n<ul>\n<li>å®é™…æ“ä½œ</li>\n</ul>\n<p><img src=\"http://t-blog-images.aijs.top/img/20220509181853.webp\"></p>\n<h3 id=\"jsonp-æ–¹å¼-lt-åŠ¨æ€-script-gt\"><a href=\"#jsonp-æ–¹å¼-lt-åŠ¨æ€-script-gt\" class=\"headerlink\" title=\"jsonp æ–¹å¼ &lt;åŠ¨æ€ script&gt;\"></a>jsonp æ–¹å¼ &lt;åŠ¨æ€ script&gt;</h3><h3 id=\"æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼-nginx\"><a href=\"#æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼-nginx\" class=\"headerlink\" title=\"æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼ nginx\"></a>æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼ nginx</h3><h3 id=\"å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰\"><a href=\"#å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰\" class=\"headerlink\" title=\"å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰\"></a>å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰</h3>","text":"èƒŒæ™¯æµè§ˆå™¨å®‰å…¨ç­–ç•¥é™åˆ¶è·¨åŸŸè®¿é—® å†…å®¹å®‰å…¨ç­–ç•¥æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚ ä½¿ç”¨æ–¹å¼ä¸ºä½¿ CSP å¯ç”¨, ä½ éœ€è¦é…ç½®ä½ çš„ç½‘ç»œæœåŠ¡å™¨è¿”å› Con...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"é¢è¯•","slug":"é¢è¯•","count":3,"path":"api/categories/é¢è¯•.json"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","count":4,"path":"api/tags/é¢è¯•.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%83%8C%E6%99%AF\"><span class=\"toc-text\">èƒŒæ™¯</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">å¤„ç†æ–¹å¼</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#nginx\"><span class=\"toc-text\">nginx</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#jsonp-%E6%96%B9%E5%BC%8F-lt-%E5%8A%A8%E6%80%81-script-gt\"><span class=\"toc-text\">jsonp æ–¹å¼ &lt;åŠ¨æ€ script&gt;</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AE%BE%E7%BD%AE%EF%BC%8C%E7%B1%BB%E4%BC%BC-nginx\"><span class=\"toc-text\">æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼ nginx</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96%EF%BC%88%E4%B8%8D%E5%B8%B8%E7%94%A8%EF%BC%89\"><span class=\"toc-text\">å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰</span></a></li></ol></li></ol>","author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Slate wiki-uiè¯„è®ºåŠŸèƒ½å…‰æ ‡ä¹±è·³","uid":"f5ccfd5f1ce5f78727a64a19669811c7","slug":"2022-04-29slate","date":"2022-05-10T05:00:00.000Z","updated":"2022-05-28T03:47:02.803Z","comments":true,"path":"api/articles/2022-04-29slate.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/bug.webp","text":"bugå¤ç°bugå¤ç° (node:29) UnhandledPromiseRejectionWarning: Error: Forbidden at &amp;#x2F;code&amp;#x2F;client&amp;#x2F;.next&amp;#x2F;server&amp...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"wiki","slug":"wiki","count":3,"path":"api/categories/wiki.json"}],"tags":[{"name":"wiki","slug":"wiki","count":4,"path":"api/tags/wiki.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"é¢è¯•é¢˜æ±‡æ€»","uid":"99460a2013287be2d51642da6dd169f8","slug":"2022-05-08interview","date":"2022-05-08T08:27:00.000Z","updated":"2022-05-26T14:12:56.674Z","comments":true,"path":"api/articles/2022-05-08interview.json","keywords":null,"cover":null,"text":"å€¼å¾—æ”¶è—çš„é“¾æ¥ ç ä¸Šé€šå¤© é¢è¯•å®Œ50ä¸ªäººåæˆ‘å†™ä¸‹è¿™ç¯‡æ€»ç»“ if æˆ‘æ˜¯å‰ç«¯å›¢é˜Ÿ Leaderï¼Œæ€ä¹ˆåˆ¶å®šå‰ç«¯åä½œè§„èŒƒ? åšäº†ä¸€ä»½å‰ç«¯é¢è¯•å¤ä¹ è®¡åˆ’ï¼Œä¿ç†Ÿï½ ","link":"","photos":[],"count_time":{"symbolsCount":76,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","count":4,"path":"api/tags/é¢è¯•.json"}],"author":{"name":"é™ˆæµ·é¾™","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"éœ€è¦å°±å­¦å‘—ï¼Œå¤šå¤§ç‚¹äº‹ğŸ˜‚","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}