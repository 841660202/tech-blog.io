{"title":"nextjs13 turbopack","uid":"196672c6a68ef10b6c449876bc5af600","slug":"2022-10-28nextjs13","date":"2022-10-28T06:50:11.000Z","updated":"2022-11-21T13:08:33.126Z","comments":true,"path":"api/articles/2022-10-28nextjs13.json","keywords":null,"cover":[],"content":"<h2 id=\"官方链接\"><a href=\"#官方链接\" class=\"headerlink\" title=\"官方链接\"></a>官方链接</h2><p><a href=\"https://turbo.build/\" target=\"_blank\" >https://turbo.build/</a></p>\n<p><a href=\"https://nextjs.org/\" target=\"_blank\" >https://nextjs.org/</a></p>\n<h2 id=\"比较一组数据\"><a href=\"#比较一组数据\" class=\"headerlink\" title=\"比较一组数据\"></a>比较一组数据</h2><div style=\"display:flex;flex-direction:row; flex-wrap:wrap;align-items: flex-start;\">\n <div style=\"flex:1 1 0;\">\n <p style=\"height: 50px\"> 1000个组件量级，启动</p>\n <img src=\"http://t-blog-images.aijs.top/img/202210281455133.webp\" style=\"width:300px\" />\n\n </div>\n <div style=\"width: 10px\"></div>\n <div style=\"flex:1 1 0\">\n <p style=\"height: 50px\">10000个组件量级，文件变动</p>\n\n<img src=\"http://t-blog-images.aijs.top/img/202210281456033.webp\" style=\"width:300px\" />\n </div>\n</div>\n\n<p>实际开发中，组件个数可能远超过 10000</p>\n<p>从结果来看 vite 还强，速度快不是 next.js13 多牛叉，技术基本上早就成型，而是因为背靠 turbopack，想想 vite 诞生对 vue 的支持力度较大，react 资源较少，不过也够用的了，在<a href=\"/#/post/2022-09-07vite-react\" target=\"_blank\" >2022-09-07vite-react</a> 公司线上项目试了，确实快乐很多。</p>\n<p>现在 next.js13 内置，turbopack，想想也带劲，公司一直在用 next.js 进行项目开发，在内部还整了个前端基建。那速度，使用过的同事，都能体会龟速，被喷的不要不要的，比自己搭建的还慢,有些部门直接弃用</p>\n<p>尤其是公司内部 wiki 编辑器的集成。直接导致，整个项目间歇式工作， Mac 8G 内存， CPU 给你顶飞</p>\n<p>现在，重拾信心，毕竟服务端渲染 SEO 的优势摆在那的</p>\n<h2 id=\"体验一把\"><a href=\"#体验一把\" class=\"headerlink\" title=\"体验一把\"></a>体验一把</h2><h3 id=\"启动-1\"><a href=\"#启动-1\" class=\"headerlink\" title=\"启动 1\"></a>启动 1</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">👑 ~&#x2F;Desktop&#x2F;nextjs13&#x2F;my-app git:(main) $ pn dev\n\n&gt; my-app@0.1.0 dev &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;nextjs13&#x2F;my-app\n&gt; next dev\n\nwarn  - Port 3000 is in use, trying 3001 instead.\nwarn  - Port 3001 is in use, trying 3002 instead.\nready - started server on 0.0.0.0:3002, url: http:&#x2F;&#x2F;localhost:3002\nevent - compiled client and server successfully in 2.1s (150 modules)\nwait  - compiling...\nevent - compiled client and server successfully in 161 ms (150 modules)</code></pre>\n\n<p>哎呦我去～，这么久，配个端口重来</p>\n<h3 id=\"启动-2\"><a href=\"#启动-2\" class=\"headerlink\" title=\"启动 2\"></a>启动 2</h3><p>电脑启动多个项目，端口占用了，重来～</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">👑 ~&#x2F;Desktop&#x2F;nextjs13&#x2F;my-app git:(main) ✗ $ pn dev\n\n&gt; my-app@0.1.0 dev &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;nextjs13&#x2F;my-app\n&gt; next dev --port 3005\n\nready - started server on 0.0.0.0:3005, url: http:&#x2F;&#x2F;localhost:3005\nevent - compiled client and server successfully in 812 ms (150 modules)</code></pre>\n\n<h3 id=\"总感觉怪怪的\"><a href=\"#总感觉怪怪的\" class=\"headerlink\" title=\"总感觉怪怪的\"></a>总感觉怪怪的</h3><p>查看了下根目录下生成的.next，在<code>.next/cache/</code>下依然是 <code>webpack</code></p>\n<img src=\"http://t-blog-images.aijs.top/img/202210281836675.webp\" style=\"width: 200px;\" />\n\n<p>被骗了吗？，不应该啊</p>\n<h3 id=\"这才是正确姿势\"><a href=\"#这才是正确姿势\" class=\"headerlink\" title=\"这才是正确姿势\"></a>这才是正确姿势</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ pn turbo\n\n&gt; my-app@0.1.0 turbo &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;nextjs13&#x2F;my-app\n&gt; next dev --turbo --port 3005\n\n&gt;&gt;&gt; TURBOPACK (alpha)\n\nThank you for trying Next.js v13 with Turbopack! As a reminder,\nTurbopack is currently in alpha and not yet ready for production.\nWe appreciate your ongoing support as we work to make it ready\nfor everyone.\n\nWarning: You are using configuration that may require additional\nsetup with Turbopack. If you already made these changes please\nignore this warning.\n\n- PostCSS detected (postcss.config.js)\n  PostCSS is not yet supported by Next.js v13 with Turbopack.\n  To use with Turbopack, see: https:&#x2F;&#x2F;nextjs.link&#x2F;turbopack-postcss\n\n- Tailwind detected (tailwind.config.js)\n  Tailwind is not yet supported by Next.js v13 with Turbopack.\n  To use with Turbopack, see: https:&#x2F;&#x2F;nextjs.link&#x2F;turbopack-tailwind\n\nLearn more about Next.js v13 and Turbopack: https:&#x2F;&#x2F;nextjs.link&#x2F;with-turbopack\nPlease direct feedback to: https:&#x2F;&#x2F;nextjs.link&#x2F;turbopack-feedback\n\nready - started server on 0.0.0.0:3005, url: http:&#x2F;&#x2F;localhost:3005\nevent - initial compilation 5.974ms\nerror - [rendering] [root of the dev server]&#x2F;\n  Error during SSR Rendering\n  timed out waiting for the Node.js process to connect\n\nevent - updated in 2125ms\nevent - updated in 1521ms</code></pre>\n\n<h3 id=\"报错了跑不起来-升级-nodejs-16\"><a href=\"#报错了跑不起来-升级-nodejs-16\" class=\"headerlink\" title=\"报错了跑不起来 升级 nodejs 16+\"></a>报错了跑不起来 升级 nodejs 16+</h3><p><a href=\"https://nextjs.org/blog/next-13#introducing-turbopack-alpha:~:text=The%20minimum%20Node.js%20version%20has%20been%20bumped%20from%2012.22.0%20to%2014.6.0%2C%20since%2012.x%20has%20reached%20end%2Dof%2Dlife%20(PR).\" target=\"_blank\" >nextjs 官方 blog 只说了：The minimum Node.js version has been bumped from 12.22.0 to 14.6.0, since 12.x has reached end-of-life (PR).</a><br><a href=\"https://github.com/vercel/next.js/issues/41859\" target=\"_blank\" >issue 41859</a></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">\n$ sudo n\nPassword:\n   installed : v16.13.1 (with npm 8.1.2)\n</code></pre>\n\n<h3 id=\"next-js-图片报错\"><a href=\"#next-js-图片报错\" class=\"headerlink\" title=\"next.js 图片报错\"></a>next.js 图片报错</h3><p>应该是 turbo 的原因导致的，没用之前正常</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">&#x2F;&#x2F; next.config.js\n&#x2F;** @type &#123;import(&#39;next&#39;).NextConfig&#125; *&#x2F;\nconst nextConfig &#x3D; &#123;\n  reactStrictMode: true,\n  swcMinify: true,\n  images: &#123;\n    remotePatterns: [\n      &#123;\n        protocol: &quot;https&quot;,\n        hostname: &quot;images.unsplash.com&quot;,\n        port: &quot;&quot;,\n        pathname: &quot;&#x2F;**&#x2F;*&quot;,\n      &#125;,\n    ],\n  &#125;,\n&#125;;\n\nmodule.exports &#x3D; nextConfig;</code></pre>\n\n<h4 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h4><p><a href=\"https://nextjs.org/blog/next-13#breaking-changes\" target=\"_blank\" >next-13#breaking-changes</a></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>The next&#x2F;image import was renamed to next&#x2F;legacy&#x2F;image. The next&#x2F;future&#x2F;image import was renamed to next&#x2F;image. A codemod is available to safely and automatically rename your imports.</p></blockquote>\n<h3 id=\"tailwind-css-全部失效\"><a href=\"#tailwind-css-全部失效\" class=\"headerlink\" title=\"tailwind css 全部失效\"></a>tailwind css 全部失效</h3><p>目前还不支持</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\n- PostCSS detected (postcss.config.js)\n  PostCSS is not yet supported by Next.js v13 with Turbopack.\n  To use with Turbopack, see: https:&#x2F;&#x2F;nextjs.link&#x2F;turbopack-postcss\n</code></pre>\n\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><ul>\n<li>next.js13 turbo 问题还不少，暂时不适合用到正式项目</li>\n<li>正如开头说的，没有 turbo 的 next.js13 速度还是慢</li>\n</ul>\n","text":"官方链接https://turbo.build/ https://nextjs.org/ 比较一组数据 1000个组件量级，启动 10000个组件量级，文件变动 实际开发中，组件个数可能远超过 10000 从结果来看 vite 还强，速度快不是 next.js13 多牛叉，技术基...","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[{"name":"React","slug":"React","count":34,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":28,"path":"api/tags/React.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%98%E6%96%B9%E9%93%BE%E6%8E%A5\"><span class=\"toc-text\">官方链接</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%AF%94%E8%BE%83%E4%B8%80%E7%BB%84%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">比较一组数据</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%93%E9%AA%8C%E4%B8%80%E6%8A%8A\"><span class=\"toc-text\">体验一把</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8-1\"><span class=\"toc-text\">启动 1</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8-2\"><span class=\"toc-text\">启动 2</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%BB%E6%84%9F%E8%A7%89%E6%80%AA%E6%80%AA%E7%9A%84\"><span class=\"toc-text\">总感觉怪怪的</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BF%99%E6%89%8D%E6%98%AF%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF\"><span class=\"toc-text\">这才是正确姿势</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%8A%A5%E9%94%99%E4%BA%86%E8%B7%91%E4%B8%8D%E8%B5%B7%E6%9D%A5-%E5%8D%87%E7%BA%A7-nodejs-16\"><span class=\"toc-text\">报错了跑不起来 升级 nodejs 16+</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#next-js-%E5%9B%BE%E7%89%87%E6%8A%A5%E9%94%99\"><span class=\"toc-text\">next.js 图片报错</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">解决方案</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#tailwind-css-%E5%85%A8%E9%83%A8%E5%A4%B1%E6%95%88\"><span class=\"toc-text\">tailwind css 全部失效</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">总结</span></a></li></ol></li></ol>","author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"眼中有光，心中有梦，脚下有路","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"go 知识积累","uid":"492ad8fe5c882da5782b1a12ae580fb4","slug":"2022-10-29go-proj","date":"2022-10-29T04:47:02.000Z","updated":"2022-12-22T13:36:21.793Z","comments":true,"path":"api/articles/2022-10-29go-proj.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/202212211225570.webp","text":"strconv见 sync.WaitGrouphttp://c.biancheng.net/view/108.html 包&#x2F;&#x2F; redis go get github.com&#x2F;go-redis&#x2F;redis &#x2F;&#x2F; .ini...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"Go","slug":"Go","count":15,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":15,"path":"api/tags/Go.json"}],"author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"眼中有光，心中有梦，脚下有路","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"前端基础-移动端适配","uid":"ae7214e6b6b6dc80cfe5f43a5613e628","slug":"2022-10-28移动适配","date":"2022-10-28T02:03:07.000Z","updated":"2023-02-20T21:20:56.479Z","comments":true,"path":"api/articles/2022-10-28移动适配.json","keywords":null,"cover":null,"text":"网易精品课移动端适配方案 小红书网页代码&lt;script&gt; function setPixel() &#123; var e &#x3D; parseFloat( window .getComputedStyle(document.documentElement, nu...","link":"","photos":[],"count_time":{"symbolsCount":877,"symbolsTime":"1 mins."},"categories":[{"name":"前端基础","slug":"前端基础","count":47,"path":"api/categories/前端基础.json"}],"tags":[{"name":"前端基础","slug":"前端基础","count":49,"path":"api/tags/前端基础.json"}],"author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"眼中有光，心中有梦，脚下有路","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}