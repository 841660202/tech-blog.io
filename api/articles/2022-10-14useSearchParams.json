{"title":"nextjs useSearchParams","uid":"9a1d323e88658104fe9c4ac04b72ebe7","slug":"2022-10-14useSearchParams","date":"2022-10-14T08:57:11.000Z","updated":"2022-10-17T11:18:29.861Z","comments":true,"path":"api/articles/2022-10-14useSearchParams.json","keywords":null,"cover":[],"content":"<h2 id=\"èƒŒæ™¯\"><a href=\"#èƒŒæ™¯\" class=\"headerlink\" title=\"èƒŒæ™¯\"></a>èƒŒæ™¯</h2><p><strong>éœ€æ±‚</strong></p>\n<p>åˆ—è¡¨åˆ‡æ¢è¯¦æƒ…ï¼Œè¿”å›åˆ—è¡¨ï¼Œè¦æ±‚æŸ¥è¯¢è¡¨å•å‚æ•°ä¸ä¸¢å¤±ï¼Œ</p>\n<p><strong>æ€è·¯</strong></p>\n<ul>\n<li>è®°å½•å‚æ•°åˆ° url ä¸Šï¼Œåœ¨è®°å½•çš„è¿‡ç¨‹ä¸­ï¼Œåˆ—è¡¨é¡µé¢ä¸åˆ·æ–°</li>\n<li>è¿”å›æ—¶å€™åˆ—è¡¨é¡µåªä½œä¸ºä¸€ä¸ª history æ ˆä¸­çš„ä¸€ä¸ªè®°å½•</li>\n</ul>\n<p><strong>MDN</strong></p>\n<p>ç›´æ¥ç‚¹ï¼š<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/History_API#replacestate_%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B\" target=\"_blank\" >history.replaceState</a></p>\n<p><strong>history.replaceState</strong></p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">history.replaceState(stateObj, &quot;page 3&quot;, &quot;bar2.html&quot;);\n&#x2F;&#x2F; æ³¨æ„ç‚¹ history.replaceState, ä¼šå‘urlè¿½åŠ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„id,ä¹Ÿä¼šè¢«è¿½åŠ ã€‚\n&#x2F;&#x2F; ä¾‹å¦‚ï¼š\n&#x2F;&#x2F; åˆå§‹ location.query ä¸º &#39;?time&#x3D;123456789&#39;\n&#x2F;&#x2F; history.replaceState(null, &quot;page 3&quot;, &quot;&amp;id&#x3D;1&quot;); &#x2F;&#x2F; ç¬¬ä¸€æ¬¡è°ƒç”¨\n\n&#x2F;&#x2F; location.query ä¸º &#39;?time&#x3D;123456789&amp;id&#x3D;1&#39;\n\n&#x2F;&#x2F; history.replaceState(null, &quot;page 3&quot;, &quot;&amp;id&#x3D;1&quot;); &#x2F;&#x2F; ç¬¬äºŒæ¬¡è°ƒç”¨\n\n&#x2F;&#x2F; location.query ä¸º &#39;?time&#x3D;123456789&amp;id&#x3D;1&amp;id&#x3D;1&#39;\n\n&#x2F;&#x2F; history.replaceState(null, &quot;page 3&quot;, &quot;&amp;id&#x3D;1&quot;); &#x2F;&#x2F; ç¬¬ä¸‰æ¬¡è°ƒç”¨\n\n&#x2F;&#x2F; location.query ä¸º &#39;?time&#x3D;123456789&amp;id&#x3D;1&amp;id&#x3D;1&amp;id&#x3D;1&#39;</code></pre>\n\n<h2 id=\"nextjs\"><a href=\"#nextjs\" class=\"headerlink\" title=\"nextjs\"></a>nextjs</h2><p>åœ¨ nextjs ä¸­æ²¡æœ‰æä¾›ç±»ä¼¼ react-router-dom ä¸­ <code>useSearchParams</code>è¿™æ ·çš„å‹¾å­</p>\n<p><a href=\"https://reactrouter.com/en/main/hooks/use-search-params#usesearchparams\" target=\"_blank\" >useSearchParams</a></p>\n<h2 id=\"å‡è£…æˆ‘ä»¬ä¸çŸ¥é“-replaceState\"><a href=\"#å‡è£…æˆ‘ä»¬ä¸çŸ¥é“-replaceState\" class=\"headerlink\" title=\"å‡è£…æˆ‘ä»¬ä¸çŸ¥é“ replaceState\"></a>å‡è£…æˆ‘ä»¬ä¸çŸ¥é“ replaceState</h2><p>å¦‚æœè¦åœ¨ nextjs ä¸­å®ç° <code>useSearchParams</code> å¦‚ä½•åšå‘¢ï¼Ÿ</p>\n<p>ä¼šæƒ³åˆ°å‚è€ƒ <code>useSearchParams</code> çš„æºç å®ç°</p>\n<h2 id=\"ä¸‹è½½æºç æœä¸‹å®ç°\"><a href=\"#ä¸‹è½½æºç æœä¸‹å®ç°\" class=\"headerlink\" title=\"ä¸‹è½½æºç æœä¸‹å®ç°\"></a>ä¸‹è½½æºç æœä¸‹å®ç°</h2><h2 id=\"useSearchParams\"><a href=\"#useSearchParams\" class=\"headerlink\" title=\"useSearchParams\"></a>useSearchParams</h2><img src=\"http://t-blog-images.aijs.top/img/202210141716968.webp\" />\n\n<!-- <img src=\"http://t-blog-images.aijs.top/img/202210141713394.webp\" /> -->\n<!-- <img src=\"http://t-blog-images.aijs.top/img/202210141714671.webp\" /> -->\n\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">&#x2F;&#x2F; packages&#x2F;react-router-dom&#x2F;index.tsx\n&#x2F;&#x2F; è°ƒç”¨ &#96;setSearchParams&#96; -&gt;  &#96;navigate&#96;-&gt;  &#96;let navigate &#x3D; useNavigate()&#96; -&gt; &#96;import &#123;  useNavigate&#125; from &quot;react-router&quot;;&#96;;</code></pre>\n\n<p>åˆ°è¿™é‡Œï¼Œè¦å»æ‰¾ <code>react-router åŒ…ä¸­çš„ useNavigate</code>ï¼Œ åŒä¸€ä¸ªä»£ç ä»“åº“ï¼Œä¸ç”¨åˆ‡æ¢é¡¹ç›®</p>\n<h2 id=\"useNavigate\"><a href=\"#useNavigate\" class=\"headerlink\" title=\"useNavigate\"></a>useNavigate</h2><p>åŒæ ·æ–¹å¼ï¼Œæ‰¾åˆ°å¦‚ä¸‹å†…å®¹</p>\n<img src=\"http://t-blog-images.aijs.top/img/202210141723899.webp\" />\n\n<p>è¦å»æ‰¾ä¸‹<code>NavigationContext</code>, React çš„ contextï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼Œæ˜¯<code>NavigationContext.Provider</code>æä¾›çš„æ•°æ®</p>\n<h2 id=\"NavigationContext-Provider\"><a href=\"#NavigationContext-Provider\" class=\"headerlink\" title=\"NavigationContext.Provider\"></a>NavigationContext.Provider</h2><p>åŒæ ·æ–¹å¼ï¼Œæ‰¾åˆ°å¦‚ä¸‹å†…å®¹</p>\n<img src=\"http://t-blog-images.aijs.top/img/202210141727222.webp\" />\n\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">&#x2F;&#x2F; packages&#x2F;react-router&#x2F;lib&#x2F;components.tsx\n\n&#x2F;&#x2F; è¿™é‡Œè¦æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå†æ‰¾ä¸‹å»è¦æ‰¾ &lt;Routeräº†ï¼Œç”±React-router-domåŒ…æš´éœ²çš„ç»„ä»¶ï¼Œå¯çŸ¥é“æš´éœ²äº†å‡ ä¸ªç»„ä»¶ï¼š</code></pre>\n\n<h2 id=\"react-router-dom-æš´éœ²çš„ç»„ä»¶\"><a href=\"#react-router-dom-æš´éœ²çš„ç»„ä»¶\" class=\"headerlink\" title=\"react-router-dom æš´éœ²çš„ç»„ä»¶\"></a>react-router-dom æš´éœ²çš„ç»„ä»¶</h2><img src=\"http://t-blog-images.aijs.top/img/202210141735213.webp\" />\n\n<pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">import &#123; createBrowserHistory, createHashHistory &#125; from &quot;history&quot;; &#x2F;&#x2F; è¿™é‡Œ 4\n&#x2F;&#x2F; ...\nexport function BrowserRouter(&#123;\n  basename,\n  children,\n  window,\n&#125;: BrowserRouterProps) &#123;\n  let historyRef &#x3D; React.useRef&lt;BrowserHistory&gt;();\n  if (historyRef.current &#x3D;&#x3D; null) &#123;\n    historyRef.current &#x3D; createBrowserHistory(&#123; window &#125;); &#x2F;&#x2F; è¿™é‡Œ 3\n  &#125;\n\n  let history &#x3D; historyRef.current; &#x2F;&#x2F; è¿™é‡Œ 2\n  let [state, setState] &#x3D; React.useState(&#123;\n    action: history.action,\n    location: history.location,\n  &#125;);\n\n  React.useLayoutEffect(() &#x3D;&gt; history.listen(setState), [history]);\n\n  return (\n    &lt;Router\n      basename&#x3D;&#123;basename&#125;\n      children&#x3D;&#123;children&#125;\n      location&#x3D;&#123;state.location&#125;\n      navigationType&#x3D;&#123;state.action&#125;\n      navigator&#x3D;&#123;history&#125; &#x2F;&#x2F; è¿™é‡Œ 1\n    &#x2F;&gt;\n  );\n&#125;</code></pre>\n\n<p>æœ€ç»ˆå‘ç°åˆ°äº† <code>history</code>åº“ä¸­</p>\n<h2 id=\"createBrowserHistory\"><a href=\"#createBrowserHistory\" class=\"headerlink\" title=\"createBrowserHistory\"></a>createBrowserHistory</h2><p>åŒæ ·æ–¹å¼ï¼Œæ‰¾åˆ°å¦‚ä¸‹å†…å®¹</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">export function createBrowserHistory(&#123; window &#x3D; document.defaultView &#125; &#x3D; &#123;&#125;) &#123;\n  let globalHistory &#x3D; window.history; &#x2F;&#x2F; &#x2F;&#x2F; è¿™é‡Œ 4\n  &#x2F;&#x2F; è·å–ç¬¬å‡ ä¸ªï¼Œå’Œ location ä¿¡æ¯\n  &#x2F;&#x2F; ...\n  function replace(to, state) &#123;\n    &#x2F;&#x2F; è¿™é‡Œ 2\n    let nextAction &#x3D; ReplaceAction;\n    let nextLocation &#x3D; getNextLocation(to, state);\n    function retry() &#123;\n      replace(to, state);\n    &#125;\n\n    if (allowTx(nextAction, nextLocation, retry)) &#123;\n      let [historyState, url] &#x3D; getHistoryStateAndUrl(nextLocation, index);\n\n      &#x2F;&#x2F; TODO: Support forced reloading\n      globalHistory.replaceState(historyState, null, url); &#x2F;&#x2F; è¿™é‡Œ 3\n\n      applyTx(nextAction);\n    &#125;\n  &#125;\n\n  function go(n) &#123;\n    globalHistory.go(n);\n  &#125;\n\n  let history &#x3D; &#123;\n    get action() &#123;\n      return action;\n    &#125;,\n    get location() &#123;\n      return location;\n    &#125;,\n    createHref,\n    push,\n    replace, &#x2F;&#x2F; è¿™é‡Œ 1\n    go,\n    back() &#123;\n      go(-1);\n    &#125;,\n    forward() &#123;\n      go(1);\n    &#125;,\n    listen(fn) &#123;\n      return listeners.push(fn);\n    &#125;,\n    block(fn) &#123;\n      let unblock &#x3D; blockers.push(fn);\n\n      if (blockers.length &#x3D;&#x3D;&#x3D; 1) &#123;\n        window.addEventListener(BeforeUnloadEventType, promptBeforeUnload);\n      &#125;\n\n      return function () &#123;\n        unblock();\n\n        &#x2F;&#x2F; Remove the beforeunload listener so the document may\n        &#x2F;&#x2F; still be salvageable in the pagehide event.\n        &#x2F;&#x2F; See https:&#x2F;&#x2F;html.spec.whatwg.org&#x2F;#unloading-documents\n        if (!blockers.length) &#123;\n          window.removeEventListener(BeforeUnloadEventType, promptBeforeUnload);\n        &#125;\n      &#125;;\n    &#125;,\n  &#125;;\n\n  return history;\n&#125;</code></pre>\n\n<p>æœ€ç»ˆå‘ç°è°ƒç”¨çš„æ˜¯ <code> window.history.replaceState(historyState, null, url)</code></p>\n<h2 id=\"å‡è£…æˆ‘ä»¬åˆšçŸ¥é“\"><a href=\"#å‡è£…æˆ‘ä»¬åˆšçŸ¥é“\" class=\"headerlink\" title=\"å‡è£…æˆ‘ä»¬åˆšçŸ¥é“\"></a>å‡è£…æˆ‘ä»¬åˆšçŸ¥é“</h2><p>Oh~,åŸæ¥å¦‚æ­¤å‘€</p>\n<h2 id=\"å…¶ä»–\"><a href=\"#å…¶ä»–\" class=\"headerlink\" title=\"å…¶ä»–\"></a>å…¶ä»–</h2><p><code>useNavigate</code></p>\n<p>è¿™ä¸ª hook å†…éƒ¨è·å–äº† <code> let &#123; basename, navigator &#125; = React.useContext(NavigationContext);</code>,</p>\n<p><code>NavigationContext.Provider</code>æ˜¯æœ€å¤–å±‚æä¾›çš„ï¼Œæ‰€ä»¥ï¼Œåœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ <code>useNavigate</code> ç›´æ¥èƒ½æ‹¿åˆ° <code>navigator</code>,ä¸éœ€è¦é€šè¿‡<code>React.useContext(NavigationContext)</code>çš„æ–¹å¼è·å–</p>\n<h2 id=\"æœ€åï¼Œå®ç°-nextjs-ä¸­è¯¥å‹¾å­\"><a href=\"#æœ€åï¼Œå®ç°-nextjs-ä¸­è¯¥å‹¾å­\" class=\"headerlink\" title=\"æœ€åï¼Œå®ç° nextjs ä¸­è¯¥å‹¾å­\"></a>æœ€åï¼Œå®ç° nextjs ä¸­è¯¥å‹¾å­</h2><h2 id=\"useSearchParams-1\"><a href=\"#useSearchParams-1\" class=\"headerlink\" title=\"useSearchParams\"></a>useSearchParams</h2><pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">&#x2F;&#x2F; hooks&#x2F;useSearchParams.tsx\nimport &#123; useRouter &#125; from &quot;next&#x2F;router&quot;;\nimport React from &quot;react&quot;;\n\n&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;react-router&#x2F;blob&#x2F;main&#x2F;packages&#x2F;react-router-dom&#x2F;index.tsx\n\nexport type ParamKeyValuePair &#x3D; [string, string];\nexport type URLSearchParamsInit &#x3D;\n  | string\n  | ParamKeyValuePair[]\n  | Record&lt;string, string | string[]&gt;\n  | URLSearchParams;\n\ntype SetURLSearchParams &#x3D; (\n  nextInit?:\n    | URLSearchParamsInit\n    | ((prev: URLSearchParams) &#x3D;&gt; URLSearchParamsInit),\n  navigateOpts?: NavigateOptions\n) &#x3D;&gt; void;\n\n&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;react-router&#x2F;blob&#x2F;d9d233c7fbb6f712915e8b0a7c916a69064bfdb9&#x2F;packages&#x2F;react-router&#x2F;lib&#x2F;context.ts#L92\nexport interface NavigateOptions &#123;\n  replace?: boolean;\n  state?: any;\n  preventScrollReset?: boolean;\n  relative?: RelativeRoutingType;\n&#125;\n\nexport type RelativeRoutingType &#x3D; &quot;route&quot; | &quot;path&quot;;\n\n&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;react-router&#x2F;blob&#x2F;main&#x2F;packages&#x2F;react-router-dom&#x2F;dom.ts\n&#x2F;**\n * Creates a URLSearchParams object using the given initializer.\n *\n * This is identical to &#96;new URLSearchParams(init)&#96; except it also\n * supports arrays as values in the object form of the initializer\n * instead of just strings. This is convenient when you need multiple\n * values for a given key, but don&#39;t want to use an array initializer.\n *\n * For example, instead of:\n *\n *   let searchParams &#x3D; new URLSearchParams([\n *     [&#39;sort&#39;, &#39;name&#39;],\n *     [&#39;sort&#39;, &#39;price&#39;]\n *   ]);\n *\n * you can do:\n *\n *   let searchParams &#x3D; createSearchParams(&#123;\n *     sort: [&#39;name&#39;, &#39;price&#39;]\n *   &#125;);\n *&#x2F;\n\nexport function createSearchParams(\n  init: URLSearchParamsInit &#x3D; &quot;&quot;\n): URLSearchParams &#123;\n  return new URLSearchParams(\n    typeof init &#x3D;&#x3D;&#x3D; &quot;string&quot; ||\n    Array.isArray(init) ||\n    init instanceof URLSearchParams\n      ? init\n      : Object.keys(init).reduce((memo, key) &#x3D;&gt; &#123;\n          const value &#x3D; init[key];\n          return memo.concat(\n            Array.isArray(value) ? value.map((v) &#x3D;&gt; [key, v]) : [[key, value]]\n          );\n        &#125;, [] as ParamKeyValuePair[])\n  );\n&#125;\n\nexport function getSearchParamsForLocation(\n  locationSearch: string,\n  defaultSearchParams: URLSearchParams\n) &#123;\n  const searchParams &#x3D; createSearchParams(locationSearch);\n  &#x2F;&#x2F; @ts-ignore\n  for (const key of defaultSearchParams.keys()) &#123;\n    if (!searchParams.has(key)) &#123;\n      defaultSearchParams.getAll(key).forEach((value) &#x3D;&gt; &#123;\n        searchParams.append(key, value);\n      &#125;);\n    &#125;\n  &#125;\n\n  return searchParams;\n&#125;\n\nexport function useSearchParams(\n  defaultInit?: URLSearchParamsInit\n): [URLSearchParams, SetURLSearchParams] &#123;\n  const defaultSearchParamsRef &#x3D; React.useRef(createSearchParams(defaultInit));\n  const router &#x3D; useRouter();\n  let searchParams &#x3D;\n    typeof window &#x3D;&#x3D;&#x3D; &quot;undefined&quot;\n      ? defaultSearchParamsRef.current\n      : getSearchParamsForLocation(\n          &#x2F;&#x2F; å‚æ•°\n          window?.location?.search || &quot;&quot;,\n          defaultSearchParamsRef.current\n        );\n\n  const setSearchParams &#x3D; React.useCallback&lt;SetURLSearchParams&gt;(\n    (nextInit, navigateOptions) &#x3D;&gt; &#123;\n      const newSearchParams &#x3D; createSearchParams(\n        typeof nextInit &#x3D;&#x3D;&#x3D; &quot;function&quot; ? nextInit(searchParams) : nextInit\n      );\n      window.history.replaceState(null, &quot;&quot;, &#96;?$&#123;newSearchParams&#125;&#96;);\n    &#125;,\n    [searchParams]\n  );\n\n  return [searchParams, setSearchParams];\n&#125;</code></pre>\n\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><pre class=\"line-numbers language-tsx\" data-language=\"tsx\"><code class=\"language-tsx\">&#x2F;&#x2F; pages&#x2F;test&#x2F;replacestate.tsx\nimport React, &#123; useCallback, useEffect, useState &#125; from &quot;react&quot;;\nimport &#123; useSearchParams &#125; from &quot;..&#x2F;..&#x2F;hooks&#x2F;useSearchParams&quot;;\ninterface IProps &#123;&#125;\nconst TestReplaceState: React.FC&lt;IProps&gt; &#x3D; (props) &#x3D;&gt; &#123;\n  const [count, setCount] &#x3D; useState(0);\n  const [searchParams, setSearchParams] &#x3D; useSearchParams();\n\n  &#x2F;&#x2F; urlæ•°æ®æ”¾åˆ°stateï¼ˆæ•°æ®æ¢å¤ï¼‰\n  useEffect(() &#x3D;&gt; &#123;\n    setCount(Number(searchParams.get(&quot;id&quot;)));\n  &#125;, []);\n\n  &#x2F;&#x2F; https:&#x2F;&#x2F;developer.mozilla.org&#x2F;zh-CN&#x2F;docs&#x2F;Web&#x2F;API&#x2F;URLSearchParams\n  if (typeof window !&#x3D;&#x3D; &quot;undefined&quot;) &#123;\n    const searchParams &#x3D; new URLSearchParams(location.href);\n    &#x2F;&#x2F; @ts-ignore\n    for (let p of searchParams) &#123;\n      console.log(p);\n    &#125;\n  &#125;\n  &#x2F;&#x2F; æ¨¡æ‹ŸæŸ¥è¯¢è¡¨å•æäº¤\n  const handleSubmitQuery &#x3D; useCallback(() &#x3D;&gt; &#123;\n    const newValue &#x3D; count + 1;\n    &#x2F;&#x2F; æ›´æ–°urlæ•°æ®ï¼Œä¸åˆ·æ–°é¡µé¢\n    setSearchParams(&#123; id: &#96;$&#123;newValue&#125;&#96; &#125;);\n    setCount(newValue);\n  &#125;, [count, setSearchParams]);\n\n  return (\n    &lt;div style&#x3D;&#123;&#123; padding: 50 &#125;&#125;&gt;\n      &lt;span\n        style&#x3D;&#123;&#123;\n          cursor: &quot;pointer&quot;,\n          background: &quot;#1980ff&quot;,\n          color: &quot;#fff&quot;,\n          padding: &quot;4px 6px&quot;,\n          borderRadius: 4,\n        &#125;&#125;\n        onClick&#x3D;&#123;handleSubmitQuery&#125;\n      &gt;\n        æ¨¡æ‹ŸæŸ¥è¯¢è¡¨å•æäº¤æ•°æ® &#123;count&#125;\n      &lt;&#x2F;span&gt;\n    &lt;&#x2F;div&gt;\n  );\n&#125;;\n\nexport default TestReplaceState;</code></pre>\n\n<h2 id=\"æ•ˆæœæ¼”ç¤º\"><a href=\"#æ•ˆæœæ¼”ç¤º\" class=\"headerlink\" title=\"æ•ˆæœæ¼”ç¤º\"></a>æ•ˆæœæ¼”ç¤º</h2><img src=\"http://t-blog-images.aijs.top/img/202210141848635.gif\" />\n\n<h2 id=\"è¯¦æƒ…-gt-åˆ—è¡¨-åœ¨-nextjs-ä¸Šæœ‰æ—¶å€™ä¸èƒ½è¢«æ£€æµ‹åˆ°\"><a href=\"#è¯¦æƒ…-gt-åˆ—è¡¨-åœ¨-nextjs-ä¸Šæœ‰æ—¶å€™ä¸èƒ½è¢«æ£€æµ‹åˆ°\" class=\"headerlink\" title=\"è¯¦æƒ…-&gt;åˆ—è¡¨, åœ¨ nextjs ä¸Šæœ‰æ—¶å€™ä¸èƒ½è¢«æ£€æµ‹åˆ°\"></a>è¯¦æƒ…-&gt;åˆ—è¡¨, åœ¨ nextjs ä¸Šæœ‰æ—¶å€™ä¸èƒ½è¢«æ£€æµ‹åˆ°</h2><p>url åˆ‡æ¢æˆåŠŸï¼Œä½†æ˜¯ nextjs æœ‰æ—¶å€™æ£€æµ‹ä¸åˆ° å¶ç°</p>\n<p>ä¹‹åçœ‹ä¸‹æºç ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆåŸå› </p>\n<h2 id=\"nextjs-æä¾›äº†æµ…è·¯ç”±\"><a href=\"#nextjs-æä¾›äº†æµ…è·¯ç”±\" class=\"headerlink\" title=\"nextjs æä¾›äº†æµ…è·¯ç”±\"></a>nextjs æä¾›äº†æµ…è·¯ç”±</h2><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">&#x2F;&#x2F; ....\n&#x2F;&#x2F; éœ€è¦æœ‰é¡ºåºçš„åŠ è½½ï¼Œå¦åˆ™ antd table pagination currentå½“å‰é¡µæ•°å­˜åœ¨é—®é¢˜ï¼Œ\n&#x2F;&#x2F; åŸå› æ˜¯ï¼š paginationè¢«å°è£…åˆ°ä¸€ä¸ªhookä¸­ï¼Œä¸tableä¸åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œtableçš„ï¼Œæ›´æ–°ä¸åŠæ—¶\nuseEffect(() &#x3D;&gt; &#123;\n  if (router.pathname &#x3D;&#x3D;&#x3D; &quot;&#x2F;my&#x2F;list&quot;) &#123;\n    setShowCreator(false);\n    refShowCreator.current &#x3D; false;\n  &#125; else &#123;\n    setShowCreator(true);\n    refShowCreator.current &#x3D; true;\n  &#125;\n  const urlparam &#x3D; router.query;\n  form.setFieldsValue(&#123;\n    ...urlparam,\n    states: (urlparam.states || [])?.map((item) &#x3D;&gt; Number(item)),\n  &#125;);\n\n  fetchCurrentData(+urlparam.pageIndex, +urlparam.limit);\n  &#x2F;&#x2F; eslint-disable-next-line react-hooks&#x2F;exhaustive-deps\n&#125;, [router.query.activeTab, pageOption, router.pathname, form]);\n&#x2F;&#x2F; ....\n&#x2F;&#x2F; æ›´æ–° queryparams\nconst handleReplaceState &#x3D; (_params) &#x3D;&gt; &#123;\n  const urlparams &#x3D; qs.stringify(\n    filterEmptyVal(_params, &#123; cleanKeys: [], emptyString: true &#125;)\n  );\n  if (countref.current) &#123;\n    const _path &#x3D;\n      router.query.activeTab !&#x3D;&#x3D; undefined\n        ? &#96;$&#123;router.pathname&#125;?activeTab&#x3D;$&#123;router.query.activeTab&#125;&amp;$&#123;urlparams&#125;&#96;\n        : &#96;$&#123;router.pathname&#125;?$&#123;urlparams&#125;&#96;;\n    router?.push(_path, undefined, &#123; shallow: true &#125;);\n  &#125;\n  countref.current &#x3D; countref.current + 1;\n  return getProblems(_params);\n&#125;;</code></pre>\n","text":"èƒŒæ™¯éœ€æ±‚ åˆ—è¡¨åˆ‡æ¢è¯¦æƒ…ï¼Œè¿”å›åˆ—è¡¨ï¼Œè¦æ±‚æŸ¥è¯¢è¡¨å•å‚æ•°ä¸ä¸¢å¤±ï¼Œ æ€è·¯ è®°å½•å‚æ•°åˆ° url ä¸Šï¼Œåœ¨è®°å½•çš„è¿‡ç¨‹ä¸­ï¼Œåˆ—è¡¨é¡µé¢ä¸åˆ·æ–° è¿”å›æ—¶å€™åˆ—è¡¨é¡µåªä½œä¸ºä¸€ä¸ª history æ ˆä¸­çš„ä¸€ä¸ªè®°å½• MDN ç›´æ¥ç‚¹ï¼šhistory.replaceState history.replaceState ...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"React","slug":"React","count":28,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":22,"path":"api/tags/React.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%83%8C%E6%99%AF\"><span class=\"toc-text\">èƒŒæ™¯</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#nextjs\"><span class=\"toc-text\">nextjs</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%81%87%E8%A3%85%E6%88%91%E4%BB%AC%E4%B8%8D%E7%9F%A5%E9%81%93-replaceState\"><span class=\"toc-text\">å‡è£…æˆ‘ä»¬ä¸çŸ¥é“ replaceState</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%E6%90%9C%E4%B8%8B%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">ä¸‹è½½æºç æœä¸‹å®ç°</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useSearchParams\"><span class=\"toc-text\">useSearchParams</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useNavigate\"><span class=\"toc-text\">useNavigate</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#NavigationContext-Provider\"><span class=\"toc-text\">NavigationContext.Provider</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#react-router-dom-%E6%9A%B4%E9%9C%B2%E7%9A%84%E7%BB%84%E4%BB%B6\"><span class=\"toc-text\">react-router-dom æš´éœ²çš„ç»„ä»¶</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#createBrowserHistory\"><span class=\"toc-text\">createBrowserHistory</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%81%87%E8%A3%85%E6%88%91%E4%BB%AC%E5%88%9A%E7%9F%A5%E9%81%93\"><span class=\"toc-text\">å‡è£…æˆ‘ä»¬åˆšçŸ¥é“</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96\"><span class=\"toc-text\">å…¶ä»–</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%80%E5%90%8E%EF%BC%8C%E5%AE%9E%E7%8E%B0-nextjs-%E4%B8%AD%E8%AF%A5%E5%8B%BE%E5%AD%90\"><span class=\"toc-text\">æœ€åï¼Œå®ç° nextjs ä¸­è¯¥å‹¾å­</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useSearchParams-1\"><span class=\"toc-text\">useSearchParams</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Demo\"><span class=\"toc-text\">Demo</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA\"><span class=\"toc-text\">æ•ˆæœæ¼”ç¤º</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AF%A6%E6%83%85-gt-%E5%88%97%E8%A1%A8-%E5%9C%A8-nextjs-%E4%B8%8A%E6%9C%89%E6%97%B6%E5%80%99%E4%B8%8D%E8%83%BD%E8%A2%AB%E6%A3%80%E6%B5%8B%E5%88%B0\"><span class=\"toc-text\">è¯¦æƒ…-&gt;åˆ—è¡¨, åœ¨ nextjs ä¸Šæœ‰æ—¶å€™ä¸èƒ½è¢«æ£€æµ‹åˆ°</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#nextjs-%E6%8F%90%E4%BE%9B%E4%BA%86%E6%B5%85%E8%B7%AF%E7%94%B1\"><span class=\"toc-text\">nextjs æä¾›äº†æµ…è·¯ç”±</span></a></li></ol>","author":{"name":"ä¸¾æ‰‹æ‘˜æœˆäº®","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"ç”Ÿæ´»ä¸æ­¢çœ¼å‰çš„è‹Ÿä¸”ï¼Œè¿˜æœ‰è¯—å’Œè¿œæ–¹","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Go è¯­è¨€ ç‰¹æ®Šè¯­æ³•","uid":"cc6337a39cba986d99843e70d56686e5","slug":"2022-10-15go","date":"2022-10-15T01:54:03.000Z","updated":"2022-10-31T15:10:22.861Z","comments":true,"path":"api/articles/2022-10-15go.json","keywords":null,"cover":[],"text":"ç›®å‰æ‰€é‡åˆ°æœ€å¥½çš„æ•™ç¨‹go æ•™ç¨‹ https://studygolang.com/pkgdoc ğŸ¤” ä¸‹è½½å®‰è£… goå®˜æ–¹å®‰è£…åŒ…åœ°å€ â™  &#x2F;Users&#x2F;chenhailong&#x2F;Desktop&#x2F;841660202.github.io $ go ve...","link":"","photos":[],"count_time":{"symbolsCount":"33k","symbolsTime":"30 mins."},"categories":[{"name":"Go","slug":"Go","count":9,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":9,"path":"api/tags/Go.json"}],"author":{"name":"ä¸¾æ‰‹æ‘˜æœˆäº®","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"ç”Ÿæ´»ä¸æ­¢çœ¼å‰çš„è‹Ÿä¸”ï¼Œè¿˜æœ‰è¯—å’Œè¿œæ–¹","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"React Cache","uid":"e9f36f04acce2f8eb8772b8cbe654522","slug":"2022-10-14react-cache","date":"2022-10-14T08:42:18.000Z","updated":"2022-10-15T02:11:29.159Z","comments":true,"path":"api/articles/2022-10-14react-cache.json","keywords":null,"cover":null,"text":"æš‚æ—¶æ²¡ç©ºçœ‹ï¼Œå…ˆè®°å½•react-router saveScrollPositionsaveScrollPosition react-router-cache-routehttps://github.com/CJY0208/react-router-cache-route react...","link":"","photos":[],"count_time":{"symbolsCount":220,"symbolsTime":"1 mins."},"categories":[{"name":"React","slug":"React","count":28,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":22,"path":"api/tags/React.json"}],"author":{"name":"ä¸¾æ‰‹æ‘˜æœˆäº®","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"ç”Ÿæ´»ä¸æ­¢çœ¼å‰çš„è‹Ÿä¸”ï¼Œè¿˜æœ‰è¯—å’Œè¿œæ–¹","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}