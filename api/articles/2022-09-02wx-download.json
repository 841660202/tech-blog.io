{"title":"企业微信 下载/导出","uid":"624f5234ec8cf95d8c13811af9eb0639","slug":"2022-09-02wx-download","date":"2022-09-02T08:59:24.000Z","updated":"2022-09-16T13:54:56.316Z","comments":true,"path":"api/articles/2022-09-02wx-download.json","keywords":null,"cover":[],"content":"<h2 id=\"浏览器环境\"><a href=\"#浏览器环境\" class=\"headerlink\" title=\"浏览器环境\"></a>浏览器环境</h2><h3 id=\"a-标签方式\"><a href=\"#a-标签方式\" class=\"headerlink\" title=\"a 标签方式\"></a>a 标签方式</h3><p>一般情况</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">&#x2F;**\n * @param &#123; String &#125; target 下载对象\n * @param &#123; String &#125; type 类型 url &#x2F; blob\n *&#x2F;\nexport const downloadFile &#x3D; (target, filename &#x3D; &quot;&quot;, type &#x3D; &quot;url&quot;) &#x3D;&gt; &#123;\n  const link &#x3D; document.createElement(&quot;a&quot;);\n  const body &#x3D; document.querySelector(&quot;body&quot;);\n  if (!body) return;\n\n  &#x2F;&#x2F; 需下载的文件类型\n  if (type &#x3D;&#x3D;&#x3D; &quot;url&quot;) &#123;\n    link.href &#x3D; target;\n  &#125; else if (type &#x3D;&#x3D;&#x3D; &quot;blob&quot;) &#123;\n    link.href &#x3D; window.URL.createObjectURL(target);\n  &#125;\n\n  &#x2F;&#x2F; 文件名\n  if (filename) link.download &#x3D; filename;\n\n  link.style.display &#x3D; &quot;none&quot;;\n  body.appendChild(link);\n\n  link.click();\n\n  window.URL.revokeObjectURL(link.href); &#x2F;&#x2F; 释放 URL 对象\n  body.removeChild(link);\n&#125;;</code></pre>\n\n<h3 id=\"window-api-方式\"><a href=\"#window-api-方式\" class=\"headerlink\" title=\"window api 方式\"></a>window api 方式</h3><p><code>window.open</code> 、<code>window.location.href</code></p>\n<p>通过 name 形式</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">window.open(&quot;url?name&#x3D;资源文件&quot;);\nwindow.location.href &#x3D; &quot;url?name&#x3D;资源文件&quot;;</code></pre>\n\n<h2 id=\"企业微信环境\"><a href=\"#企业微信环境\" class=\"headerlink\" title=\"企业微信环境\"></a>企业微信环境</h2><p>不支持上述两种方式更改，完全由后台接口返回控制</p>\n<img src=\"http://t-blog-images.aijs.top/img/202209021704425.webp\" />\n\n<ul>\n<li><p>并且企业微信下载，需要二次确认，下载之后，并不像浏览器那样提示在底部提示已下载的文件</p>\n</li>\n<li><p>如果这个地方 <code>Content-Disposition</code> 后台没有塞 filename 字段，企业微信提示二次确认时候的重命名 <span style=\"color: red\">输入框默认是空的</span></p>\n</li>\n<li><p>企业微信文件API理论上可以用，但是有些IOS手机还是坑多多</p>\n</li>\n</ul>\n","text":"浏览器环境a 标签方式一般情况 &#x2F;** * @param &#123; String &#125; target 下载对象 * @param &#123; String &#125; type 类型 url &#x2F; blob *&#x2F; export cons...","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"企业微信","slug":"企业微信","count":5,"path":"api/categories/企业微信.json"}],"tags":[{"name":"企业微信","slug":"企业微信","count":5,"path":"api/tags/企业微信.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">浏览器环境</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#a-%E6%A0%87%E7%AD%BE%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">a 标签方式</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#window-api-%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">window api 方式</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">企业微信环境</span></a></li></ol>","author":{"name":"陈哈喽","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"丷为中华之崛起而学习丷","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"vscode react-javascript-snippets源码","uid":"1ad99506e723aeb106287f0014b15cda","slug":"2022-09-05vscode","date":"2022-09-05T02:35:51.000Z","updated":"2022-09-16T13:54:56.317Z","comments":true,"path":"api/articles/2022-09-05vscode.json","keywords":null,"cover":[],"text":"背景要分享自己开发的代码片段工具 vs-snippets，正所谓：没有对比，就没有伤害,了解下别人是如何开发代码片段插件的思路，做个对比 不得不说，react-javascript-snippets 无论从源代码组织还是支持的代码片段来讲都非常优秀，对于大众化来讲非常 nice。...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"vscode","slug":"vscode","count":3,"path":"api/categories/vscode.json"}],"tags":[{"name":"vscode","slug":"vscode","count":7,"path":"api/tags/vscode.json"}],"author":{"name":"陈哈喽","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"丷为中华之崛起而学习丷","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"ahooks源码","uid":"847fdfbf845470be05a2ff27391aae0c","slug":"2022-08-24ahooks","date":"2022-08-24T09:16:49.000Z","updated":"2022-09-16T13:54:56.315Z","comments":true,"path":"api/articles/2022-08-24ahooks.json","keywords":null,"cover":"https://ahooks.js.org/logo.svg","text":"背景随意看看，了解下，无固定顺序，全凭兴趣 useUpdate useUpdate 会返回一个函数，调用该函数会强制组件重新渲染。 import &#123; useCallback, useState &#125; from &quot;react&quot;; const u...","link":"","photos":[],"count_time":{"symbolsCount":"97k","symbolsTime":"1:28"},"categories":[{"name":"源码","slug":"源码","count":2,"path":"api/categories/源码.json"}],"tags":[{"name":"源码","slug":"源码","count":14,"path":"api/tags/源码.json"}],"author":{"name":"陈哈喽","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/avatar.jpeg","link":"/","description":"丷为中华之崛起而学习丷","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}