{"title":"gorm 敲一敲","uid":"913ea831ec1db0086e941500c02969c4","slug":"2022-12-10gorm","date":"2022-12-10T01:21:05.000Z","updated":"2022-12-22T13:36:21.801Z","comments":true,"path":"api/articles/2022-12-10gorm.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/202212211225570.webp","content":"<h2 id=\"name-“date”-unsupported-Scan\"><a href=\"#name-“date”-unsupported-Scan\" class=\"headerlink\" title=\"name “date”: unsupported Scan\"></a>name “date”: unsupported Scan</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; sql: Scan error on column index 0, name &quot;date&quot;: unsupported Scan, storing driver.Value type &lt;nil&gt; into type \\*sql.Rows\n&#x2F;&#x2F; exit status 1\n</code></pre>\n\n<pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">package main\n\nimport (\n\t&quot;bytes&quot;\n\t&quot;database&#x2F;sql&quot;\n\t&quot;encoding&#x2F;json&quot;\n\t&quot;fmt&quot;\n\t&quot;log&quot;\n\t&quot;os&quot;\n\t&quot;time&quot;\n\n\t&quot;gorm.io&#x2F;driver&#x2F;mysql&quot;\n\t&quot;gorm.io&#x2F;gorm&quot;\n)\n\n&#x2F;&#x2F; User 有一张 CreditCard，UserID 是外键\ntype User struct &#123; &#x2F;&#x2F; 拥有者\n\tgorm.Model\n\tName         string &#96;gorm:&quot;default:haotian&quot;&#96;\n\tEmail        *string\n\tAge          uint8 &#96;gorm:&quot;default:30&quot;&#96;\n\tBirthday     *time.Time\n\tMemberNumber sql.NullString\n\tActivatedAt  sql.NullTime\n\tActive       sql.NullBool &#96;gorm:&quot;default:true&quot;&#96;\n\tCreatedAt    time.Time\n\tUpdatedAt    time.Time\n\tCreditCard   CreditCard &#x2F;&#x2F; 一对一的关系\n\n\tFirstName string\n\tLastName  string\n\n\tFullName string &#96;gorm:&quot;-&gt;;type:GENERATED ALWAYS AS (concat(firstname,&#39; &#39;,lastname));default:(-);&quot;&#96;\n\n\t&#x2F;&#x2F; ALTER TABLE &#96;users&#96; add  COLUMN &#96;full_name&#96; longtext  generated always as (concat(users.first_name,&#39; &#39;,users.last_name));\n&#125;\n\nfunc main()  &#123;\n\n\n\tdsn :&#x3D; &quot;root:123456@tcp(localhost:3306)&#x2F;gorm_demo?charset&#x3D;utf8mb4&amp;parseTime&#x3D;True&amp;loc&#x3D;Local&quot;\n\tdb, err :&#x3D; gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)\n\n\tif err !&#x3D; nil &#123;\n\t\tpanic(&quot;failed to connect database&quot;)\n\t&#125;\n\ttype Result struct &#123;\n\t\tDate  time.Time\n\t\tTotal int\n\t&#125;\n\n\trows, _ :&#x3D; db.Debug().Table(&quot;users&quot;).Select(&quot;date(created_at) as date, sum(age) as total&quot;).Group(&quot;date(created_at)&quot;).Rows()\n  &#x2F;&#x2F; 结果承载\n\tvar results []Result\n\n\tfor rows.Next() &#123;\n\t\tvar user Result\n\t\tdb.ScanRows(rows, &amp;user)\n\t\tif err !&#x3D; nil &#123;\n\t\t\tlog.Fatal(err)\n\t\t&#125;\n    &#x2F;&#x2F; 转化成数组\n\t\tresults &#x3D; append(results, user)\n\t&#125;\n\trows.Close()\n\n  &#x2F;&#x2F; json化输出\n\n\tb, _ :&#x3D; json.Marshal(results)\n\n\tvar out bytes.Buffer\n\n\terr &#x3D; json.Indent(&amp;out, b, &quot;&quot;, &quot;\\t&quot;)\n\tif err !&#x3D; nil &#123;\n\t\tlog.Fatalln(err)\n\t&#125;\n\n\tout.WriteTo(os.Stdout)\n  &#125;</code></pre>\n\n<h2 id=\"参考链接【大头在此】\"><a href=\"#参考链接【大头在此】\" class=\"headerlink\" title=\"参考链接【大头在此】\"></a>参考链接【大头在此】</h2><p><a href=\"https://blog.csdn.net/weixin_46618592/article/details/125740498\" target=\"_blank\" >gin 框架学习-GORM 框架进阶之 CRUD 接口(数据库增删改查操作)</a></p>\n","text":"name “date”: unsupported Scan&#x2F;&#x2F; sql: Scan error on column index 0, name &quot;date&quot;: unsupported Scan, storing driver.Value t...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"Go","slug":"Go","count":19,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":19,"path":"api/tags/Go.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#name-%E2%80%9Cdate%E2%80%9D-unsupported-Scan\"><span class=\"toc-text\">name “date”: unsupported Scan</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5%E3%80%90%E5%A4%A7%E5%A4%B4%E5%9C%A8%E6%AD%A4%E3%80%91\"><span class=\"toc-text\">参考链接【大头在此】</span></a></li></ol>","author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"gorm 神坑~","uid":"1f1a9623ce6b522ab39575958416eb6f","slug":"2022-12-10gorm-ls","date":"2022-12-10T09:10:12.000Z","updated":"2022-12-22T13:36:21.801Z","comments":true,"path":"api/articles/2022-12-10gorm-ls.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/202212211225570.webp","text":"官方文档坑 1、 generated always as run SQL syntax Error&#x2F;issues&#x2F;5914 转化的 sql 丢 data_type 坑 2、 .Model(&amp;User{})官网神坑 db.Debug().Model(&a...","link":"","photos":[],"count_time":{"symbolsCount":"6.6k","symbolsTime":"6 mins."},"categories":[{"name":"Go","slug":"Go","count":19,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":19,"path":"api/tags/Go.json"}],"author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"CssInJs emotion","uid":"907b3348d3876a023645790a9362572f","slug":"2022-12-06emotion","date":"2022-12-06T10:06:21.000Z","updated":"2023-02-20T21:20:56.479Z","comments":true,"path":"api/articles/2022-12-06emotion.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/202212211224777.webp","text":"背景开发业务看板组件，原项目使用 @emotion 实现 简单图 简单图录制 头部组合录制 问题You have tried to stringify object returned from &#96;css&#96; function. It isn&#39;t suppos...","link":"","photos":[],"count_time":{"symbolsCount":494,"symbolsTime":"1 mins."},"categories":[{"name":"CSS","slug":"CSS","count":4,"path":"api/categories/CSS.json"}],"tags":[{"name":"CSS","slug":"CSS","count":4,"path":"api/tags/CSS.json"}],"author":{"name":"举手摘月亮","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}