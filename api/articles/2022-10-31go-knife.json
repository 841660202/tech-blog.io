{"title":"go knife","uid":"a03d410eec3e63ae5b6746e1792d1f46","slug":"2022-10-31go-knife","date":"2022-10-31T04:20:11.000Z","updated":"2022-12-22T13:36:21.794Z","comments":true,"path":"api/articles/2022-10-31go-knife.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/202212211225570.webp","content":"<h2 id=\"效果图\"><a href=\"#效果图\" class=\"headerlink\" title=\"效果图\"></a>效果图</h2><img src=\"http://t-blog-images.aijs.top/img/202210311134749.webp\" />\n\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://zhuanlan.zhihu.com/p/501477368\" target=\"_blank\" >参考</a></p>\n<h2 id=\"初始化项目\"><a href=\"#初始化项目\" class=\"headerlink\" title=\"初始化项目\"></a>初始化项目</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir src\ntouch main.go\ngo mod init go-localize\ngo mod tidy\nmkdir config controller dao middleware model router service tmp util constant internet\n...\n</code></pre>\n\n<h2 id=\"air\"><a href=\"#air\" class=\"headerlink\" title=\"air\"></a>air</h2><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p><a href=\"https://github.com/cosmtrek/air/issues/135\" target=\"_blank\" >参考 issues 135</a></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ curl -sSfL https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;cosmtrek&#x2F;air&#x2F;master&#x2F;install.sh | sh -s -- -b $(go env GOPATH)&#x2F;bin\n$ air -v\n\n---\n\n&#x2F; &#x2F;\\ | | | |_)\n&#x2F;_&#x2F;--\\ |_| |_| \\_ 1.40.4, built with Go 1.18.3\n</code></pre>\n\n<h3 id=\"配置-alias\"><a href=\"#配置-alias\" class=\"headerlink\" title=\"配置 alias\"></a>配置 alias</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">alias air&#x3D;&#39;$(go env GOPATH)&#x2F;bin&#x2F;air&#39;</code></pre>\n\n<p>注意：比较奇怪的是 air -v 可输出， air 命令颜色为红色， 非绿色</p>\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p>注意：终端需要重启</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">最简单的方法是执行\n\n# 优先在当前路径查找 &#96;.air.toml&#96; 后缀的文件，如果没有找到，则使用默认的\n\nair -c .air.toml\n\n您可以运行以下命令初始化，把默认配置添加到当前路径下的.air.toml 文件。\n\nair init\n\n在这之后，你只需执行 air 命令，无需添加额外的变量，它就能使用 .air.toml 文件中的配置了。\n\nair\n\n</code></pre>\n\n<h2 id=\"出错了\"><a href=\"#出错了\" class=\"headerlink\" title=\"出错了\"></a>出错了</h2><p>写了 you.go 文件，空文件，没有写 package</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">♠ &#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize $ air\n\n  __    _   ___\n &#x2F; &#x2F;\\  | | | |_)\n&#x2F;_&#x2F;--\\ |_| |_| \\_ 1.40.4, built with Go 1.18.3\n\nwatching .\nwatching config\nwatching controller\nwatching controller&#x2F;v1\nwatching dao\nwatching middleware\nwatching model\nwatching router\nwatching service\n!exclude tmp\nwatching util\nbuilding...\ncontroller&#x2F;v1&#x2F;you.go:1:1: expected &#39;package&#39;, found &#39;EOF&#39;\nfailed to build, error: exit status 1</code></pre>\n\n<h3 id=\"起来了\"><a href=\"#起来了\" class=\"headerlink\" title=\"起来了\"></a>起来了</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">♠ &#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize $ air\n\n  __    _   ___\n &#x2F; &#x2F;\\  | | | |_)\n&#x2F;_&#x2F;--\\ |_| |_| \\_ 1.40.4, built with Go 1.18.3\n\nwatching .\nwatching config\nwatching controller\nwatching controller&#x2F;v1\nwatching dao\nwatching middleware\nwatching model\nwatching router\nwatching service\n!exclude tmp\nwatching util\nbuilding...\nrunning...\n[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.\n\n[GIN-debug] [WARNING] Running in &quot;debug&quot; mode. Switch to &quot;release&quot; mode in production.\n - using env:   export GIN_MODE&#x3D;release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] GET    &#x2F;api&#x2F;me                   --&gt; go-localize&#x2F;controller&#x2F;v1.GetMe (3 handlers)\n[GIN-debug] POST   &#x2F;api&#x2F;me                   --&gt; go-localize&#x2F;controller&#x2F;v1.PostMe (3 handlers)\n[GIN-debug] PUT    &#x2F;api&#x2F;me                   --&gt; go-localize&#x2F;controller&#x2F;v1.PutMe (3 handlers)\n[GIN-debug] DELETE &#x2F;api&#x2F;me                   --&gt; go-localize&#x2F;controller&#x2F;v1.DeleteMe (3 handlers)\n[GIN-debug] [WARNING] You trusted all proxies, this is NOT safe. We recommend you to set a value.\nPlease check https:&#x2F;&#x2F;pkg.go.dev&#x2F;github.com&#x2F;gin-gonic&#x2F;gin#readme-don-t-trust-all-proxies for details.\n[GIN-debug] Listening and serving HTTP on :8001</code></pre>\n\n<h2 id=\"重启耗时如何查看？\"><a href=\"#重启耗时如何查看？\" class=\"headerlink\" title=\"重启耗时如何查看？\"></a>重启耗时如何查看？</h2><p>监听文件有点多，应该需要限制下范围</p>\n<pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">[GIN-debug] Listening and serving HTTP on :8001\nevent: &quot;&#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize&#x2F;README.md&quot;: CHMOD\nevent: &quot;&#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize&#x2F;README.md&quot;: WRITE\nevent: &quot;&#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize&#x2F;README.md&quot;: CHMOD\nevent: &quot;&#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize&#x2F;README.md&quot;: WRITE\nevent: &quot;&#x2F;Users&#x2F;chenhailong&#x2F;code&#x2F;go&#x2F;go-localize&#x2F;README.md&quot;: CHMOD</code></pre>\n\n<h3 id=\"文件范围缩小\"><a href=\"#文件范围缩小\" class=\"headerlink\" title=\"文件范围缩小\"></a>文件范围缩小</h3><p>创建文件夹，将所有代码移动到 src 目录下，监听 src 目录</p>\n<pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">&#x2F;&#x2F; .air.toml\nroot &#x3D; &quot;.&#x2F;src&quot;</code></pre>\n\n<h2 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; 空文件夹上传\nfind .&#x2F; -type d -empty -execdir touch &#123;&#125;&#x2F;.gitkeep &#123;&#125; \\;\ngit init\ngit add .\ngit commit -m &quot;first commit&quot;\ngit branch -M main\ngit remote add origin git@github.com:841660202&#x2F;go-localize.git\ngit push -u origin main</code></pre>\n\n<h2 id=\"gin\"><a href=\"#gin\" class=\"headerlink\" title=\"gin\"></a>gin</h2><h2 id=\"swag\"><a href=\"#swag\" class=\"headerlink\" title=\"swag\"></a>swag</h2><h3 id=\"安装-swag\"><a href=\"#安装-swag\" class=\"headerlink\" title=\"安装 swag\"></a>安装 swag</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">&#x2F;&#x2F; 1. 安装 swagger\n&#x2F;&#x2F; go install github.com&#x2F;swaggo&#x2F;swag&#x2F;cmd&#x2F;swag@latest\n\n&#x2F;&#x2F; 2. 配置~&#x2F;.zshrc  注意：引号 github 上引号没写\n&#x2F;&#x2F; &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;swaggo&#x2F;swag&#x2F;issues&#x2F;197&quot; target&#x3D;&quot;_blank&quot; &gt;issues197&lt;&#x2F;a&gt;\n&#x2F;&#x2F; export PATH&#x3D;&quot;$(go env GOPATH)&#x2F;bin:$PATH&quot;\n\n&#x2F;&#x2F; $ swag -v\n&#x2F;&#x2F; swag version v1.8.7\n\n&#x2F;&#x2F; swag init  &#x2F;&#x2F; 注意，一定要和main.go处于同一级目录\n\n&#x2F;&#x2F; 访问地址\n&#x2F;&#x2F; http:&#x2F;&#x2F;localhost:8080&#x2F;swagger&#x2F;index.html\n</code></pre>\n\n<h2 id=\"knife\"><a href=\"#knife\" class=\"headerlink\" title=\"knife\"></a>knife</h2><h3 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h3><div class=\"custom-quote warning\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 15.99V16.01\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">WARNING</p>\n<p>注意：必须要有@ID 注解，生成 operationId，点击菜单才能正常打开<br>id 用于标识操作的唯一字符串。在所有 API 操作中必须唯一。</p>\n</div>\n<p><a href=\"https://github.com/swaggo/swag/pull/732\" target=\"_blank\" >&#x2F;swaggo&#x2F;swag&#x2F;pull&#x2F;732</a></p>\n<pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">&#x2F;&#x2F; 访问链接\n&#x2F;&#x2F; http:&#x2F;&#x2F;localhost:8080&#x2F;knife&#x2F;doc.html#&#x2F;home</code></pre>\n\n<p><a href=\"https://gitee.com/youbeiwuhuan/knife4go#https://gitee.com/xiaoym/knife4j\" target=\"_blank\" >参考</a></p>\n<h3 id=\"knife-优化点\"><a href=\"#knife-优化点\" class=\"headerlink\" title=\"knife 优化点\"></a>knife 优化点</h3><ul>\n<li>刷新页面，菜单没默认打开对应的链接</li>\n<li>复制接口&#x2F;文档&#x2F;地址，点击一次提示两次</li>\n<li>后续：自动生成前端代码</li>\n</ul>\n<h3 id=\"gin-knife-例子\"><a href=\"#gin-knife-例子\" class=\"headerlink\" title=\"gin knife 例子\"></a>gin knife 例子</h3><div class=\"custom-quote warning\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 15.99V16.01\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">WARNING</p>\n<p>注意：必须要有@ID 注解，生成 operationId，点击菜单才能正常打开<br>id 用于标识操作的唯一字符串。在所有 API 操作中必须唯一。</p>\n</div>\n<p><a href=\"https://github.com/swaggo/swag/blob/master/example/celler/main.go\" target=\"_blank\" >&#x2F;swaggo&#x2F;swag</a></p>\n","text":"效果图 参考参考 初始化项目mkdir src touch main.go go mod init go-localize go mod tidy mkdir config controller dao middleware model router service tmp ut...","link":"","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"Go","slug":"Go","count":19,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":19,"path":"api/tags/Go.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%88%E6%9E%9C%E5%9B%BE\"><span class=\"toc-text\">效果图</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">参考</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">初始化项目</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#air\"><span class=\"toc-text\">air</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">安装</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE-alias\"><span class=\"toc-text\">配置 alias</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">使用</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%87%BA%E9%94%99%E4%BA%86\"><span class=\"toc-text\">出错了</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%B5%B7%E6%9D%A5%E4%BA%86\"><span class=\"toc-text\">起来了</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%87%8D%E5%90%AF%E8%80%97%E6%97%B6%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%EF%BC%9F\"><span class=\"toc-text\">重启耗时如何查看？</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%87%E4%BB%B6%E8%8C%83%E5%9B%B4%E7%BC%A9%E5%B0%8F\"><span class=\"toc-text\">文件范围缩小</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#git\"><span class=\"toc-text\">git</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#gin\"><span class=\"toc-text\">gin</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#swag\"><span class=\"toc-text\">swag</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85-swag\"><span class=\"toc-text\">安装 swag</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#knife\"><span class=\"toc-text\">knife</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B3%A8%E6%84%8F\"><span class=\"toc-text\">注意</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#knife-%E4%BC%98%E5%8C%96%E7%82%B9\"><span class=\"toc-text\">knife 优化点</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#gin-knife-%E4%BE%8B%E5%AD%90\"><span class=\"toc-text\">gin knife 例子</span></a></li></ol></li></ol>","author":{"name":"十三","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>多学一点，多想一点，多做一点</p><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"前端基础 技巧","uid":"97b3539570c7a7e3061d80de5bc34fae","slug":"2022-10-31js技巧","date":"2022-10-31T09:26:36.000Z","updated":"2022-10-31T13:18:24.946Z","comments":true,"path":"api/articles/2022-10-31js技巧.json","keywords":null,"cover":null,"text":"链接2022 年你需要了解的 13 种 JavaScript 代码技巧 如何用一行 CSS 实现 10 种现代布局 https://1linelayouts.glitch.me/ ","link":"","photos":[],"count_time":{"symbolsCount":90,"symbolsTime":"1 mins."},"categories":[{"name":"前端基础","slug":"前端基础","count":54,"path":"api/categories/前端基础.json"}],"tags":[{"name":"前端基础","slug":"前端基础","count":56,"path":"api/tags/前端基础.json"}],"author":{"name":"十三","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>多学一点，多想一点，多做一点</p><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"go 知识积累","uid":"492ad8fe5c882da5782b1a12ae580fb4","slug":"2022-10-29go-proj","date":"2022-10-29T04:47:02.000Z","updated":"2022-12-22T13:36:21.793Z","comments":true,"path":"api/articles/2022-10-29go-proj.json","keywords":null,"cover":"http://t-blog-images.aijs.top/img/202212211225570.webp","text":"strconv见 sync.WaitGrouphttp://c.biancheng.net/view/108.html 包&#x2F;&#x2F; redis go get github.com&#x2F;go-redis&#x2F;redis &#x2F;&#x2F; .ini...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"Go","slug":"Go","count":19,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":19,"path":"api/tags/Go.json"}],"author":{"name":"十三","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>多学一点，多想一点，多做一点</p><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}