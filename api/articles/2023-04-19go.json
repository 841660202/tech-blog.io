{"title":"Go Rate Limiting","uid":"b9e3c4baf5e8fc792ec5ea4b47abd686","slug":"2023-04-19go","date":"2023-04-19T16:33:01.000Z","updated":"2023-05-15T13:17:32.995Z","comments":true,"path":"api/articles/2023-04-19go.json","keywords":null,"cover":null,"content":"<h2 id=\"并发数量限制\"><a href=\"#并发数量限制\" class=\"headerlink\" title=\"并发数量限制\"></a>并发数量限制</h2><p><a href=\"https://gobyexample.com/rate-limiting\" target=\"_blank\" >见</a></p>\n<pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;time&quot;\n)\n\nfunc main() &#123;\n\n    requests :&#x3D; make(chan int, 5)\n    for i :&#x3D; 1; i &lt;&#x3D; 5; i++ &#123;\n        requests &lt;- i\n    &#125;\n    close(requests)\n\n    limiter :&#x3D; time.Tick(200 * time.Millisecond)\n\n    for req :&#x3D; range requests &#123;\n        &lt;-limiter &#x2F;&#x2F; 卡住，每200毫秒输出下面一行\n        fmt.Println(&quot;request&quot;, req, time.Now())\n    &#125;\n\n&#x2F;&#x2F; -----------------------------------------------------------------------------------------\n&#x2F;&#x2F;  上面是没做并发限制，200毫秒一卡，\n&#x2F;&#x2F;\n&#x2F;&#x2F;  下面的是做并发限制的\n&#x2F;&#x2F; -----------------------------------------------------------------------------------------\n    burstyLimiter :&#x3D; make(chan time.Time, 3) &#x2F;&#x2F; 并发限制\n    &#x2F;&#x2F; run1\n    for i :&#x3D; 0; i &lt; 3; i++ &#123;\n        burstyLimiter &lt;- time.Now()\n    &#125;\n\n    &#x2F;&#x2F; run2\n    &#x2F;&#x2F; 继续往chan中写入数据，是不生效的\n    go func() &#123;\n        for t :&#x3D; range time.Tick(200 * time.Millisecond) &#123;\n            burstyLimiter &lt;- t\n        &#125;\n    &#125;()\n\n   &#x2F;&#x2F; 容量5的请求\n    burstyRequests :&#x3D; make(chan int, 5) &#x2F;&#x2F; 并发请求\n    for i :&#x3D; 1; i &lt;&#x3D; 5; i++ &#123;\n        burstyRequests &lt;- i\n    &#125;\n    &#x2F;&#x2F; 关闭chan\n    close(burstyRequests)\n\n    &#x2F;&#x2F; 1-5遍历一遍\n    for req :&#x3D; range burstyRequests &#123;\n        &lt;-burstyLimiter &#x2F;&#x2F; 前面三个一样是 3连续写入的，后面两个是之后run2写入的，总共五个执行完结束\n        fmt.Println(&quot;request&quot;, req, time.Now())\n    &#125;\n&#125;</code></pre>\n","text":"并发数量限制见 package main import ( &quot;fmt&quot; &quot;time&quot; ) func main() &#123; requests :&#x3D; make(chan int, 5) for i :&#x3D; 1; i &l...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"Go","slug":"Go","count":19,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":19,"path":"api/tags/Go.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B9%B6%E5%8F%91%E6%95%B0%E9%87%8F%E9%99%90%E5%88%B6\"><span class=\"toc-text\">并发数量限制</span></a></li></ol>","author":{"name":"十三","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>自律，为了更好的自己</p><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Go Example","uid":"be94f55e80fa4ce47d468eae65467080","slug":"2023-04-20panic","date":"2023-04-20T10:54:32.000Z","updated":"2023-05-15T13:17:32.997Z","comments":true,"path":"api/articles/2023-04-20panic.json","keywords":null,"cover":[],"text":"Panic用于抛出异常 recover用于捕获异常 package main import &quot;fmt&quot; func mayPanic() &#123; panic(&quot;a problem&quot;) &#125; func main() &#123; ...","link":"","photos":[],"count_time":{"symbolsCount":747,"symbolsTime":"1 mins."},"categories":[{"name":"Go","slug":"Go","count":19,"path":"api/categories/Go.json"}],"tags":[{"name":"Go","slug":"Go","count":19,"path":"api/tags/Go.json"}],"author":{"name":"十三","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>自律，为了更好的自己</p><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}},"next_post":{"title":"RN position","uid":"86982b92d8849af6d72f26999e9eb0f2","slug":"2023-04-19rn","date":"2023-04-19T09:00:51.000Z","updated":"2023-05-15T13:17:32.996Z","comments":true,"path":"api/articles/2023-04-19rn.json","keywords":null,"cover":[],"text":"背景最近在给另一个部门兜底项目，火急火燎的，在开发随贴开关面板时候遇到了 ,页面中使用多个 position 电量告警信息在顶部，中间是开关面板主控制区域，主控制区域外部：使用了 position（主控制区域内部：还是 position） 页面结构： 电池 icon 电池提示信息...","link":"","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"react-native","slug":"react-native","count":8,"path":"api/categories/react-native.json"}],"tags":[{"name":"react-native","slug":"react-native","count":8,"path":"api/tags/react-native.json"}],"author":{"name":"十三","slug":"blog-author","avatar":"http://t-blog-images.aijs.top/img/202303171118970.webp","link":"/","description":"<div><p>自律，为了更好的自己</p><p>眼中有光，心中有梦，脚下有路</p><div>","socials":{"github":"https://github.com/841660202","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/web_longboss","juejin":"","customs":{}}}}}