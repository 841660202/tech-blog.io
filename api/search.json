[{"id":"c370dd6ecfc84fe9fdfa77b1a6f29341","title":"å¾…åŠäº‹é¡¹","content":"&#x2F;&#x2F; 1. headless-recorder\n&#x2F;&#x2F; 2. lightHouse https:&#x2F;&#x2F;blog.csdn.net&#x2F;tangdou369098655&#x2F;article&#x2F;details&#x2F;122531766\n&#x2F;&#x2F; 3. åšå®¢å°é¢ç”Ÿæˆ\n&#x2F;&#x2F; 4. è£…é¥°å™¨æ¨¡å¼ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;decorator\n&#x2F;&#x2F; 5. iconfontè‡ªå®šä¹‰å›¾æ ‡ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;decorator\n&#x2F;&#x2F; 6. å‡½æ•°å¼ç¼–ç¨‹ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;function-production\n&#x2F;&#x2F; 7. æ¢è‚¤ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;theme-scss\n&#x2F;&#x2F; 8.[x] vscode setting sync å¦ä¸€å°ç”µè„‘é…ç½®æ— æ³•åŒæ­¥åˆ°æœ¬ç”µè„‘\n&#x2F;&#x2F; 9.[x]item2æœ¬æœºé‡æ–°é…ç½®\n&#x2F;&#x2F; 10.[x]vscode ä»£ç ç‰‡æ®µåœ¨mdä¸Šå¤±æ•ˆäº†\n&#x2F;&#x2F; 11. typescript å·¥å…·ç±»å‹æºç \n&#x2F;&#x2F; 12. reactæºç \n&#x2F;&#x2F; 13. ocræ¡Œé¢ç«¯å·¥å…· å¯ä»¥å€Ÿé‰´ï¼šæƒ³ä½¿ç”¨ tauri æï¼Œæ²¡é‡åˆ°å¥½çš„æˆªå±\n&#x2F;&#x2F;                     1. https:&#x2F;&#x2F;github.com&#x2F;wulkano&#x2F;Kap  react + Electronå¼€å‘\n&#x2F;&#x2F;                     2. vscodeæ’ä»¶ ImageToText\n\nå¥½çš„åšå®¢&#x2F;&#x2F; 1.JerryWang_æ±ªå­ç†™  https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;99b8712e8850\n","slug":"todo","date":"2022-12-14T03:59:59.000Z","categories_index":"Todo","tags_index":"Todo","author_index":"é™ˆæµ·é¾™"},{"id":"c3d5408da05b02828c848a49ca35cf59","title":"ä¿®è¡¥node_modulesä¸‹æºç ","content":"èƒŒæ™¯ä¹‹å‰åœ¨ç®€ä¹¦ä¸Šè®°å½•è¿‡ï¼Œæ²¡è¿ç§»ç®€ä¹¦æ–‡ç« ï¼Œæ‰€ä»¥é‡æ–°è®°å½•\nç”±äºhexo-theme-auroraä»£ç é…è‰²ä¸æ˜¯å¾ˆå‹å¥½ï¼Œéœ€è¦è‡ªå®šä¹‰é…è‰²ï¼Œåˆä¸æƒ³æ”¹å…¶ github ä¸Šä»£ç ï¼Œç›´æ¥å¤„ç†node_modulesä¸‹çš„é…è‰²æ–‡ä»¶\nå®‰è£… patch-packagepatch-package åŒ…å¯ä»¥é€šè¿‡ npm è¿›è¡Œå®‰è£…ã€‚\nnpm i patch-package --save-dev\n\næˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡ yarn è¿›è¡Œå®‰è£…ã€‚\nyarn add patch-package -D\n\nä¿®æ”¹åŒ…ä»£ç &#x2F;node_modules&#x2F;æŸåŒ…åä¸‹ï¼ŒæŒ‰éœ€ä¿®æ”¹\n\nåˆ›å»ºè¡¥ä¸åœ¨ä¿®æ”¹ä¾èµ–åŒ…å†…å®¹åï¼Œå°±å¯ä»¥è¿è¡Œ patch-package åˆ›å»º patch æ–‡ä»¶äº†ã€‚\nyarn patch-package åŒ…å # ä½¿ç”¨ yarn\n\nè¿è¡Œåé€šå¸¸ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ patches ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º åŒ…å+version.patch çš„æ–‡ä»¶ã€‚å°†è¯¥ patch æ–‡ä»¶æäº¤è‡³ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œå³å¯åœ¨ä¹‹ååº”ç”¨è¯¥è¡¥ä¸äº†ã€‚ä¾‹å¦‚ï¼š\nğŸ‘‘ ~&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog git:(main) âœ— $ yarn patch-package hexo-theme-aurora\nyarn run v1.4.0\n$ &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog&#x2F;node_modules&#x2F;.bin&#x2F;patch-package hexo-theme-aurora\npatch-package 6.4.7\nâ€¢ Creating temporary folder\nâ€¢ Installing hexo-theme-aurora@1.5.5 with yarn\nâ€¢ Diffing your files with clean files\nâœ” Created file patches&#x2F;hexo-theme-aurora+1.5.5.patch\n\nğŸ’¡ hexo-theme-aurora is on GitHub! To draft an issue based on your patch run\n\n    yarn patch-package hexo-theme-aurora --create-issue\n\nâœ¨  Done in 5.48s.\n\né…ç½® npm è„šæœ¬é’©å­å®Œæˆä¸Šè¿°æ“ä½œåï¼Œæœ€åè¿˜éœ€è¦ä¿®æ”¹ package.json çš„å†…å®¹ï¼Œåœ¨ scripts ä¸­åŠ å…¥â€postinstallâ€: â€œpatch-packageâ€ã€‚\n&quot;scripts&quot;: &#123;\n  &quot;postinstall&quot;: &quot;patch-package&quot;\n&#125;\n\néªŒè¯æ¸…ç† node_modulesé¡¹ç›®æ ¹ç›®å½•åˆ«æé”™äº†,ç®€å•ç²—æš´ç‚¹ï¼Œç›´æ¥å…¨æ¸…æ‰\nrm -rf node_modules &amp;&amp; yarn\n\nè¿è¡Œç»“æœğŸ‘‘ ~&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog git:(main) âœ— $ yarn\nyarn install v1.4.0\n[1&#x2F;4] ğŸ”  Resolving packages...\n[2&#x2F;4] ğŸšš  Fetching packages...\n[3&#x2F;4] ğŸ”—  Linking dependencies...\nwarning &quot;hexo &gt; nunjucks@3.2.3&quot; has unmet peer dependency &quot;chokidar@^3.3.0&quot;.\nwarning &quot;hexo-browsersync &gt; browser-sync &gt; socket.io &gt; engine.io &gt; ws@8.2.3&quot; has unmet peer dependency &quot;bufferutil@^4.0.1&quot;.\nwarning &quot;hexo-browsersync &gt; browser-sync &gt; socket.io &gt; engine.io &gt; ws@8.2.3&quot; has unmet peer dependency &quot;utf-8-validate@^5.0.2&quot;.\nwarning &quot;hexo-renderer-marked &gt; jsdom@19.0.0&quot; has unmet peer dependency &quot;canvas@^2.5.0&quot;.\nwarning &quot;hexo-renderer-marked &gt; jsdom &gt; ws@8.5.0&quot; has unmet peer dependency &quot;bufferutil@^4.0.1&quot;.\nwarning &quot;hexo-renderer-marked &gt; jsdom &gt; ws@8.5.0&quot; has unmet peer dependency &quot;utf-8-validate@^5.0.2&quot;.\nwarning &quot;hexo-theme-aurora &gt; pinia@2.0.13&quot; has unmet peer dependency &quot;@vue&#x2F;composition-api@^1.4.0&quot;.\nwarning &quot;hexo-theme-aurora &gt; pinia@2.0.13&quot; has unmet peer dependency &quot;typescript@&gt;&#x3D;4.4.4&quot;.\nwarning &quot;hexo-theme-aurora &gt; pinia &gt; vue-demi@0.12.5&quot; has unmet peer dependency &quot;@vue&#x2F;composition-api@^1.0.0-rc.1&quot;.\n[4&#x2F;4] ğŸ“ƒ  Building fresh packages...\n$ yarn patch-package # çœ‹è¿™é‡Œï¼Œåœ¨è¿è¡Œä¿®è¡¥\nyarn run v1.4.0\n$ &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog&#x2F;node_modules&#x2F;.bin&#x2F;patch-package\npatch-package 6.4.7\nApplying patches...\nhexo-theme-aurora@1.5.5 âœ”\nâœ¨  Done in 1.00s.\nâœ¨  Done in 13.93s.\n\n\næäº¤ä»£ç å°† patches æäº¤åˆ°ä»£ç ä»“åº“ï¼Œä»¥ååœ¨å…¶ä»–æœºå™¨ä¸Šï¼Œç›´æ¥å®‰è£…ä¾èµ–åŒ…å³å¯ã€‚\næ³¨æ„äº‹é¡¹npx patch-package hexo-theme-aurora\n\nè¿™ä¸ªå‘½ä»¤ä½¿ç”¨ npm è¿è¡Œçš„ï¼Œå¯èƒ½ä¸ä¼šæˆåŠŸï¼Œä½¿ç”¨yarn patch-package hexo-theme-aurora\nğŸ‘‘ ~&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog git:(main) âœ— $ npx patch-package  hexo-theme-aurora\npatch-package 6.4.7\nâ€¢ Creating temporary folder\nâ€¢ Installing hexo-theme-aurora@1.5.5 with yarn\nwarning package.json: No license field\nwarning No license field\nerror An unexpected error occurred: &quot;https:&#x2F;&#x2F;registry.npmjs.org&#x2F;axios: ETIMEDOUT&quot;.\nError: https:&#x2F;&#x2F;registry.npmjs.org&#x2F;core-js: ETIMEDOUT\n    at Timeout._onTimeout (&#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;yarn&#x2F;lib&#x2F;cli.js:132130:19)\n    at listOnTimeout (node:internal&#x2F;timers:557:17)\n\nå‚è€ƒé“¾æ¥hexo-theme-aurora&#x2F;issues&#x2F;168patch-package\n","slug":"2022-06-09patch-package","date":"2022-06-09T01:51:48.000Z","categories_index":"npm","tags_index":"npm","author_index":"é™ˆæµ·é¾™"},{"id":"effcb24e596d83e2df5140f38213b656","title":"10.Typescript å·¥å…·ç±»å‹","content":"TypeScript provides several utility types to facilitate common type transformations. These utilities are available globally.Typescriptæä¾›äº†ä¸€äº›å¸®åŠ©ç±»å‹è½¬æ¢çš„å·¥å…·ç±»å‹ï¼Œè¿™äº›å·¥å…·ç±»å‹å¯ä»¥åœ¨å…¨å±€èŒƒå›´å†…ä½¿ç”¨ã€‚\nPartialReleased: 2.1\nConstructs a type with all properties of Type set to optional. This utility will return a type that represents all subsets of a given type.æ„é€ ä¸€ä¸ªå…·æœ‰æ‰€æœ‰å±æ€§ç±»å‹çš„å¯é€‰å±æ€§çš„ç±»å‹ã€‚è¿™ä¸ªå·¥å…·å°†è¿”å›ä¸€ä¸ªè¡¨ç¤ºç»™å®šç±»å‹çš„æ‰€æœ‰å­é›†çš„ç±»å‹ã€‚\n&#x2F;&#x2F; Example\ninterface Todo &#123;\n  title: string;\n  description: string;\n&#125;\n\nfunction updateTodo(todo: Todo, fieldsToUpdate: Partial&lt;Todo&gt;) &#123;\n  return &#123; ...todo, ...fieldsToUpdate &#125;;\n&#125;\n\nconst todo1 &#x3D; &#123;\n  title: &quot;organize desk&quot;,\n  description: &quot;clear clutter&quot;,\n&#125;;\n\nconst todo2 &#x3D; updateTodo(todo1, &#123;\n  description: &quot;throw out trash&quot;,\n&#125;);\n\nåŸç†ä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰\n\né¦–å…ˆé€šè¿‡ keyof Tï¼Œéå†å‡ºç±»å‹ T çš„æ‰€æœ‰å±æ€§ï¼Œç„¶åé€šè¿‡ in æ“ä½œç¬¦è¿›è¡Œéå†ï¼Œæœ€ååœ¨å±æ€§ååŠ ä¸Š?ï¼Œå°†å±æ€§å˜ä¸ºå¯é€‰å±æ€§ã€‚\næ³¨æ„ è¿™ä¸ª in ä¸æ˜¯æ”¶ç¼©ç±»å‹æ“ä½œç¬¦in ,è€Œæ˜¯æ˜ å°„ç±»å‹ä¸­çš„in\n\n&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;TypeScript&#x2F;blob&#x2F;HEAD&#x2F;src&#x2F;lib&#x2F;es5.d.ts#L1517\ntype Partial&lt;T&gt; &#x3D; &#123;\n  [P in keyof T]?: T[P];\n&#125;;\n\nRequiredReleased:2.8\nConstructs a type consisting of all properties of Type set to required. The opposite of Partial.æ„é€ ä¸€ä¸ªå…·æœ‰æ‰€æœ‰å±æ€§ç±»å‹çš„å¿…éœ€å±æ€§çš„ç±»å‹ã€‚ä¸Partialç›¸åã€‚\n&#x2F;&#x2F; Example\ninterface Props &#123;\na?: number;\nb?: string;\n&#125;\n\nconst obj: Props &#x3D; &#123; a: 5 &#125;;\n\nconst obj2: Required&lt;Props&gt; &#x3D; &#123; a: 5 &#125;;\nProperty &#39;b&#39; is missing in type &#39;&#123; a: number; &#125;&#39; but required in type &#39;Required&lt;Props&gt;&#39;.\n\nåŸç†åŸç†ï¼šä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰ ç”¨äºå°† T ç±»å‹çš„æ‰€æœ‰å±æ€§è®¾ç½®ä¸ºå¿…é€‰çŠ¶æ€ï¼Œé¦–å…ˆé€šè¿‡ keyof Tï¼Œå–å‡ºç±»å‹ T çš„æ‰€æœ‰å±æ€§ï¼Œ ç„¶åé€šè¿‡ in æ“ä½œç¬¦è¿›è¡Œéå†ï¼Œæœ€ååœ¨å±æ€§åçš„ ? å‰åŠ ä¸Š -ï¼Œå°†å±æ€§å˜ä¸ºå¿…é€‰å±æ€§ã€‚\nè¿™é‡Œé¡ºä¾¿è®²ä¸‹-è¿™ä¸ªç¬¦å·çš„ä½œç”¨ï¼Œè¿™æ˜¯ TypeScript 2.8 ä¸ºæ˜ å°„ç±»å‹å¢åŠ äº†æ·»åŠ æˆ–åˆ é™¤ç‰¹å®šä¿®é¥°ç¬¦çš„èƒ½åŠ›ã€‚å…·ä½“æ¥è¯´ï¼Œreadonly å’Œ?æ˜ å°„ç±»å‹ä¸­çš„å±æ€§ä¿®é¥°ç¬¦ç°åœ¨å¯ä»¥åŠ ä¸Š+æˆ–-å‰ç¼€ï¼Œä»¥æŒ‡ç¤ºåº”è¯¥æ·»åŠ æˆ–åˆ é™¤è¯¥ä¿®é¥°ç¬¦ï¼Œå½“ç„¶ä¸€èˆ¬+å·æ˜¯å¯ä»¥çœç•¥çš„ã€‚ts å®˜ç½‘ ç±»å‹æ“ä½œç¬¦&#x2F;æ˜ å°„ç±»å‹\ntype Required&lt;T&gt; &#x3D; &#123;\n  [P in keyof T]-?: T[P];\n&#125;;\n\nReadonlyReleased:2.1\nConstructs a type with all properties of Type set to readonly, meaning the properties of the constructed type cannot be reassigned.æ„é€ ä¸€ä¸ªå…·æœ‰æ‰€æœ‰å±æ€§ç±»å‹çš„åªè¯»å±æ€§çš„ç±»å‹ã€‚\n&#x2F;&#x2F; Example\ninterface Todo &#123;\n  title: string;\n&#125;\n\nconst todo: Readonly&lt;Todo&gt; &#x3D; &#123;\n  title: &quot;Delete inactive users&quot;,\n&#125;;\n\ntodo.title &#x3D; &quot;Hello&quot;;\n&#x2F;&#x2F; Cannot assign to &#39;title&#39; because it is a read-only property.\n\nThis utility is useful for representing assignment expressions that will fail at runtime (i.e. when attempting to reassign properties of a frozen object).è¿™ä¸ªå·¥å…·æ˜¯ç”¨æ¥è¡¨ç¤ºåœ¨è¿è¡Œæ—¶å°†å¤±è´¥çš„èµ‹å€¼è¡¨è¾¾å¼çš„ç”¨é€”ï¼ˆå³å°è¯•é‡æ–°åˆ†é…ä¸€ä¸ªå†»ç»“å¯¹è±¡çš„å±æ€§ï¼‰ã€‚Object.freeze\nfunction freeze&lt;Type&gt;(obj: Type): Readonly&lt;Type&gt;;\n\nåŸç†åŸç†ï¼šä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰ æ¥æ”¶ä¸¤ä¸ªæ³›å‹ï¼ŒK ä¸º string | number | symbol å¯ä»¥ç»§æ‰¿çš„ç±»å‹ï¼Œè¿™ä¸‰ä¸ªä¹Ÿæ˜¯å¯¹è±¡ key æ‰€æ”¯æŒçš„åŸºç¡€ç±»å‹ï¼Œç„¶åé€šè¿‡ in æ“ä½œç¬¦å¯¹ K è¿›è¡Œéå†ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„ç±»å‹ä¸º T ç±»å‹ã€‚\ntype Record&lt;K extends string | number | symbol, T&gt; &#x3D; &#123;\n  [P in K]: T;\n&#125;;\n\nRecord&lt;Keys, Type&gt;Released:2.1\nConstructs an object type whose property keys are Keys and whose property values are Type. This utility can be used to map the properties of a type to another type.ç”¨äºæ„é€ ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„key(é”®)éƒ½æ˜¯Keysç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„value(å€¼)éƒ½æ˜¯Typeç±»å‹ã€‚è¿™ä¸ªå·¥å…·ç±»å‹å¯ä»¥è¢«ç”¨äºæ˜ å°„ä¸€ä¸ªç±»å‹çš„å±æ€§åˆ°å¦ä¸€ä¸ªç±»å‹ã€‚\n&#x2F;&#x2F; Example\ninterface CatInfo &#123;\n  age: number;\n  breed: string;\n&#125;\n\ntype CatName &#x3D; &quot;miffy&quot; | &quot;boris&quot; | &quot;mordred&quot;;\n\nconst cats: Record&lt;CatName, CatInfo&gt; &#x3D; &#123;\n  miffy: &#123; age: 10, breed: &quot;Persian&quot; &#125;,\n  boris: &#123; age: 5, breed: &quot;Maine Coon&quot; &#125;,\n  mordred: &#123; age: 16, breed: &quot;British Shorthair&quot; &#125;,\n&#125;;\n\ncats.boris;\n\nconst cats: Record&lt;CatName, CatInfo&gt;;\n\nåŸç†ä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰\næ¥æ”¶ä¸¤ä¸ªæ³›å‹ï¼ŒK ä¸º string | number | symbol å¯ä»¥ç»§æ‰¿çš„ç±»å‹ï¼Œè¿™ä¸‰ä¸ªä¹Ÿæ˜¯å¯¹è±¡ key æ‰€æ”¯æŒçš„åŸºç¡€ç±»å‹ï¼Œç„¶åé€šè¿‡ in æ“ä½œç¬¦å¯¹ K è¿›è¡Œéå†ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„ç±»å‹ä¸º T ç±»å‹ã€‚\ntype Record&lt;K extends string | number | symbol, T&gt; &#x3D; &#123;\n  [P in K]: T;\n&#125;;\n\nPick&lt;Type, Keys&gt;Released:2.1\nConstructs a type by picking the set of properties Keys (string literal or union of string literals) from Type.ç”¨äºæ„é€ ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„key(é”®)éƒ½æ˜¯Keysç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„value(å€¼)éƒ½æ˜¯Typeç±»å‹ã€‚è¿™ä¸ªå·¥å…·ç±»å‹å¯ä»¥è¢«ç”¨äºæ˜ å°„ä¸€ä¸ªç±»å‹çš„å±æ€§åˆ°å¦ä¸€ä¸ªç±»å‹ã€‚\n&#x2F;&#x2F; Example\ninterface Todo &#123;\n  title: string;\n  description: string;\n  completed: boolean;\n&#125;\n\ntype TodoPreview &#x3D; Pick&lt;Todo, &quot;title&quot; | &quot;completed&quot;&gt;;\n\nconst todo: TodoPreview &#x3D; &#123;\n  title: &quot;Clean room&quot;,\n  completed: false,\n&#125;;\n\ntodo;\n\n&#x2F;&#x2F; const todo: TodoPreview;\n\nåŸç†ä» T ç±»å‹ä¸­æå–éƒ¨åˆ†å±æ€§ï¼Œä½œä¸ºæ–°çš„è¿”å›ç±»å‹ã€‚\ntype Pick&lt;T, K extends keyof T&gt; &#x3D; &#123;\n  [P in K]: T[P];\n&#125;;\n\nOmit&lt;Type, Keys&gt;Released:3.5\nConstructs a type by picking all properties from Type and then removing Keys (string literal or union of string literals).ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œå®ƒæ˜¯ä»Typeç±»å‹é‡Œé¢è¿‡æ»¤äº†ä¸€äº›å±æ€§Keys(Keysæ˜¯å­—ç¬¦ä¸²å­—é¢é‡ æˆ–è€… å­—ç¬¦ä¸²å­—é¢é‡çš„è”åˆç±»å‹)\n&#x2F;&#x2F; Example\ninterface Todo &#123;\n  title: string;\n  description: string;\n  completed: boolean;\n  createdAt: number;\n&#125;\n\ntype TodoPreview &#x3D; Omit&lt;Todo, &quot;description&quot;&gt;;\n\nconst todo: TodoPreview &#x3D; &#123;\n  title: &quot;Clean room&quot;,\n  completed: false,\n  createdAt: 1615544252770,\n&#125;;\n\ntodo;\n\n&#x2F;&#x2F; const todo: TodoPreview;\n\ntype TodoInfo &#x3D; Omit&lt;Todo, &quot;completed&quot; | &quot;createdAt&quot;&gt;;\n\nconst todoInfo: TodoInfo &#x3D; &#123;\n  title: &quot;Pick up kids&quot;,\n  description: &quot;Kindergarten closes at 5pm&quot;,\n&#125;;\n\ntodoInfo;\n\n&#x2F;&#x2F; const todoInfo: TodoInfo\n\nåŸç†ä½¿ç”¨ keyof ç±»å‹æ“ä½œç¬¦å·ã€extendsã€ç±»å‹æ“ä½œç¬¦ Excludeã€ ç±»å‹æ“ä½œç¬¦ Pick\n\nç»“åˆ Pick å’Œ Exclude æ–¹æ³•ï¼Œæå–å‡ºä¸å« K å±æ€§çš„ç±»å‹ã€‚\n1.keyof T è¿”å›çš„æ˜¯è”åˆç±»å‹\n2.extends\n3.Exclude&lt;T, K&gt; è¿”å›çš„æ˜¯è”åˆç±»å‹ï¼Œ å¯ä»¥æ¥æ”¶ä¸€ä¸ªè”åˆç±»å‹å’Œä¸€ä¸ªè”åˆç±»å‹ï¼Œè¿”å›ä¸€ä¸ªè”åˆç±»å‹\n4.æŠŠ K ä¸­çš„ key, ä» T ä¸­æ’é™¤æ‰ï¼Œå‰©ä¸‹çš„å°±æ˜¯ Omit çš„ç±»å‹ã€‚\n\ntype Omit&lt;T, K extends keyof T&gt; &#x3D; Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt;;\n\nExclude&lt;UnionType, ExcludedMembers&gt;Released:2.8\nConstructs a type by excluding from UnionType all union members that are assignable to ExcludedMembers.ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œå®ƒæ˜¯ä»UnionTypeè”åˆç±»å‹é‡Œé¢æ’é™¤äº†æ‰€æœ‰å¯ä»¥èµ‹ç»™ExcludedMembersçš„ç±»å‹ã€‚\n&#x2F;&#x2F; Example;\ntype T0 &#x3D; Exclude&lt;&quot;a&quot; | &quot;b&quot; | &quot;c&quot;, &quot;a&quot;&gt;;\n&#x2F;&#x2F; type T0 &#x3D; &quot;b&quot; | &quot;c&quot;;\n\ntype T1 &#x3D; Exclude&lt;&quot;a&quot; | &quot;b&quot; | &quot;c&quot;, &quot;a&quot; | &quot;b&quot;&gt;;\n&#x2F;&#x2F; type T1 &#x3D; &quot;c&quot;;\n\ntype T2 &#x3D; Exclude&lt;string | number | (() &#x3D;&gt; void), Function&gt;;\n&#x2F;&#x2F; type T2 &#x3D; string | number;\n\nextends å…³é”®å­—ä¸å­¦ extendsï¼ŒExclude å’Œ Extractï¼Œå¾ˆéš¾ç†è§£\nextends å…³é”®å­—åœ¨ TS ç¼–ç¨‹ä¸­å‡ºç°çš„é¢‘ç‡æŒºé«˜çš„ï¼Œè€Œä¸”ä¸åŒåœºæ™¯ä¸‹ä»£è¡¨çš„å«ä¹‰ä¸ä¸€æ ·ï¼Œç‰¹æ­¤æ€»ç»“ä¸€ä¸‹ï¼š\n\nè¡¨ç¤ºç»§æ‰¿&#x2F;æ‹“å±•çš„å«ä¹‰\n\nè¡¨ç¤ºçº¦æŸçš„å«ä¹‰\n\nè¡¨ç¤ºåˆ†é…çš„å«ä¹‰\n\n\n\n\nè¡¨ç¤ºç»§æ‰¿&#x2F;æ‹“å±•extends æ˜¯ ts é‡Œä¸€ä¸ªå¾ˆå¸¸è§çš„å…³é”®å­—ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ es6 é‡Œå¼•å…¥çš„ä¸€ä¸ªæ–°çš„å…³é”®å­—ã€‚åœ¨ js é‡Œï¼Œextends ä¸€èˆ¬å’Œ class ä¸€èµ·ä½¿ç”¨\n\nes6 ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§\n\nclass Animal &#123;\n  kind &#x3D; &quot;animal&quot;;\n  constructor(kind) &#123;\n    this.kind &#x3D; kind;\n  &#125;\n  sayHello() &#123;\n    console.log(&#96;Hello, I am a $&#123;this.kind&#125;!&#96;);\n  &#125;\n&#125;\n\nclass Dog extends Animal &#123;\n  constructor(kind) &#123;\n    super(kind);\n  &#125;\n  bark() &#123;\n    console.log(&quot;wang wang&quot;);\n  &#125;\n&#125;\n\nconst dog &#x3D; new Dog(&quot;dog&quot;);\ndog.name; &#x2F;&#x2F;  &#x3D;&gt; &#39;dog&#39;\ndog.sayHello(); &#x2F;&#x2F; &#x3D;&gt; Hello, I am a dog!\n\nè¿™é‡Œ Dog ç»§æ‰¿äº†çˆ¶ç±»çš„ sayHello æ–¹æ³•ï¼Œå› ä¸ºå¯ä»¥åœ¨ Dog å®ä¾‹ dog ä¸Šè°ƒç”¨ã€‚\n\nts ç»§æ‰¿æŸä¸ªç±»å‹åœ¨ ts é‡Œï¼Œextends é™¤äº†å¯ä»¥åƒ js ç»§æ‰¿å€¼ï¼Œè¿˜å¯ä»¥ç»§æ‰¿&#x2F;æ‰©å±•ç±»å‹ï¼š\n\ninterface Animal &#123;\n  kind: string;\n&#125;\n\ninterface Dog extends Animal &#123;\n  bark(): void;\n&#125;\n&#x2F;&#x2F; Dog &#x3D;&gt; &#123; name: string; bark(): void &#125;\n\n\n\næ³›å‹çº¦æŸåœ¨ä¹¦å†™æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å¯¹ç±»å‹å‚æ•°ä½œä¸€å®šçš„é™åˆ¶ï¼Œæ¯”å¦‚å¸Œæœ›ä¼ å…¥çš„å‚æ•°éƒ½æœ‰ name å±æ€§çš„æ•°ç»„æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š\nfunction getCnames&lt;T extends &#123; name: string &#125;&gt;(entities: T[]): string[] &#123;\n  return entities.map((entity) &#x3D;&gt; entity.cname);\n&#125;\n\nè¿™é‡Œ extends å¯¹ä¼ å…¥çš„å‚æ•°ä½œäº†ä¸€ä¸ªé™åˆ¶ï¼Œå°±æ˜¯ entities çš„æ¯ä¸€é¡¹å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¿…é¡»å«æœ‰ç±»å‹ä¸º string çš„ cname å±æ€§ã€‚\nå†æ¯”å¦‚ï¼Œredux é‡Œ dispatch ä¸€ä¸ª actionï¼Œå¿…é¡»åŒ…å« type å±æ€§ï¼š\n&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;redux&#x2F;blob&#x2F;2edd0363271af46e327e118f3d92e78e258bf0cd&#x2F;src&#x2F;types&#x2F;store.ts#L83\n\n&#x2F;&#x2F; Dispatch\nexport interface Dispatch&lt;A extends Action &#x3D; AnyAction&gt; &#123;\n  &lt;T extends A&gt;(action: T, ...extraArgs: any[]): T;\n&#125;\n\n&#x2F;&#x2F; AnyAction\nexport interface AnyAction extends Action &#123;\n  &#x2F;&#x2F; Allows any extra properties to be defined in an action.\n  [extraProps: string]: any;\n&#125;\n&#x2F;&#x2F; Action\nexport interface Action&lt;T &#x3D; any&gt; &#123;\n  type: T;\n&#125;\n\n&#x2F;&#x2F; ä¸Šè¿°ä»£ç  ç®€åŒ–\ninterface Dispatch&lt;T extends &#123; type: string &#125;&gt; &#123;\n  (action: T): T;\n&#125;\n\næ¡ä»¶ç±»å‹ä¸é«˜é˜¶ç±»å‹SomeType extends OtherType ? TrueType : FalseType;\n\n\nWhen the type on the left of the extendsis assignable to the one on the right, then youâ€™ll get the type in the first branch (the â€œtrueâ€ branch); otherwise youâ€™ll get the type in the latter branch (the â€œfalseâ€ branch).å½“å·¦è¾¹çš„ç±»å‹å¯ä»¥èµ‹å€¼ç»™å³è¾¹çš„ç±»å‹ï¼Œé‚£ä¹ˆä½ å°±ä¼šå¾—åˆ°ç¬¬ä¸€ä¸ªåˆ†æ”¯çš„ç±»å‹ï¼Œå¦åˆ™ä½ å°±ä¼šå¾—åˆ°ç¬¬äºŒä¸ªåˆ†æ”¯çš„ç±»å‹ã€‚\nextends è¿˜æœ‰ä¸€å¤§ç”¨é€”å°±æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªç±»å‹æ˜¯ä¸æ˜¯å¯ä»¥åˆ†é…ç»™å¦ä¸€ä¸ªç±»å‹ï¼Œè¿™åœ¨å†™é«˜çº§ç±»å‹çš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œä¸¾ä¸ª ????ï¼š\ntype Human &#x3D; &#123;\n  name: string;\n&#125;;\ntype Duck &#x3D; &#123;\n  name: string;\n&#125;;\ntype Bool &#x3D; Duck extends Human ? &quot;yes&quot; : &quot;no&quot;; &#x2F;&#x2F; Bool &#x3D;&gt; &#39;yes&#39;\n\nåœ¨ vscode é‡Œæˆ–è€… ts playground é‡Œè¾“å…¥è¿™æ®µä»£ç ï¼Œä½ ä¼šå‘ç° Bool çš„ç±»å‹æ˜¯â€™yesâ€™ã€‚è¿™æ˜¯å› ä¸º Human å’Œ Duck çš„ç±»å‹å®Œå…¨ç›¸åŒï¼Œæˆ–è€…è¯´ Human ç±»å‹çš„ä¸€åˆ‡çº¦æŸæ¡ä»¶ï¼ŒDuck éƒ½å…·å¤‡ï¼›æ¢è¨€ä¹‹ï¼Œç±»å‹ä¸º Human çš„å€¼å¯ä»¥åˆ†é…ç»™ç±»å‹ä¸º Duck çš„å€¼ï¼ˆåˆ†é…æˆåŠŸçš„å‰ææ˜¯ï¼ŒDuck é‡Œé¢å¾—çš„ç±»å‹å¾—æœ‰ä¸€æ ·çš„ï¼‰ï¼Œåä¹‹äº¦ç„¶ã€‚éœ€è¦ç†è§£çš„æ˜¯ï¼Œè¿™é‡Œ A extends Bï¼Œæ˜¯æŒ‡ç±»å‹ A å¯ä»¥åˆ†é…ç»™ç±»å‹ Bï¼Œè€Œä¸æ˜¯è¯´ç±»å‹ A æ˜¯ç±»å‹ B çš„å­é›†ã€‚ç¨å¾®æ‰©å±•ä¸‹æ¥è¯¦ç»†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼š\ntype Human &#x3D; &#123;\n  name: string;\n  occupation: string;\n&#125;;\ntype Duck &#x3D; &#123;\n  name: string;\n&#125;;\ntype Bool &#x3D; Duck extends Human ? &quot;yes&quot; : &quot;no&quot;; &#x2F;&#x2F; Bool &#x3D;&gt; &#39;no&#39;\n\nå½“æˆ‘ä»¬ç»™ Human åŠ ä¸Šä¸€ä¸ª occupation å±æ€§ï¼Œå‘ç°æ­¤æ—¶ Bool æ˜¯â€™noâ€™ï¼Œè¿™æ˜¯å› ä¸º Duck æ²¡æœ‰ç±»å‹ä¸º string çš„ occupation å±æ€§ï¼Œç±»å‹ Duck ä¸æ»¡è¶³ç±»å‹ Human çš„ç±»å‹çº¦æŸã€‚å› æ­¤ï¼ŒA extends Bï¼Œæ˜¯æŒ‡ç±»å‹ A å¯ä»¥åˆ†é…ç»™ç±»å‹ Bï¼Œè€Œä¸æ˜¯è¯´ç±»å‹ A æ˜¯ç±»å‹ B çš„å­é›†ï¼Œç†è§£ extends åœ¨ç±»å‹ä¸‰å…ƒè¡¨è¾¾å¼é‡Œçš„ç”¨æ³•éå¸¸é‡è¦ã€‚\nç»§ç»­çœ‹ç¤ºä¾‹\ntype A1 &#x3D; &quot;x&quot; extends &quot;x&quot; ? string : number; &#x2F;&#x2F; string\ntype A2 &#x3D; &quot;x&quot; | &quot;y&quot; extends &quot;x&quot; ? string : number; &#x2F;&#x2F; number\n\ntype P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;\ntype A3 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; ?\n\nA1 å’Œ A2 æ˜¯ extends æ¡ä»¶åˆ¤æ–­çš„æ™®é€šç”¨æ³•ï¼Œå’Œä¸Šé¢çš„åˆ¤æ–­æ–¹æ³•ä¸€æ ·ã€‚\nP æ˜¯å¸¦å‚æ•° T çš„æ³›å‹ç±»å‹ï¼Œå…¶è¡¨è¾¾å¼å’Œ A1ï¼ŒA2 çš„å½¢å¼å®Œå…¨ç›¸åŒï¼ŒA3 æ˜¯æ³›å‹ç±»å‹ P ä¼ å…¥å‚æ•°â€™xâ€™ | â€˜yâ€™å¾—åˆ°çš„ç±»å‹ï¼Œå¦‚æœå°†â€™xâ€™ | â€˜yâ€™å¸¦å…¥æ³›å‹ç±»çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥çœ‹åˆ°å’Œ A2 ç±»å‹çš„å½¢å¼æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œé‚£æ˜¯ä¸æ˜¯è¯´æ˜ï¼ŒA3 å’Œ A2 çš„ç±»å‹å°±æ˜¯å®Œå…¨ä¸€æ ·çš„å‘¢ï¼Ÿ\næœ‰å…´è¶£å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼Œè¿™é‡Œå°±ç›´æ¥ç»™ç»“è®ºäº†\ntype P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;\ntype A3 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; A3 çš„ç±»å‹æ˜¯ string | number\n\næ˜¯ä¸æ˜¯å¾ˆåç›´è§‰ï¼Ÿè¿™ä¸ªåç›´è§‰ç»“æœçš„åŸå› å°±æ˜¯æ‰€è°“çš„åˆ†é…æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰\nWhen conditional types act on a generic type, they become distributive when given a union typeå½“æ¡ä»¶ç±»å‹ä½œç”¨äºæ³›å‹ç±»å‹æ—¶ï¼Œå®ƒä»¬å˜æˆåˆ†é…æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰\nè¿™å¥è¯ç¿»è¯‘è¿‡æ¥ä¹Ÿè¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Œå¤§ç™½è¯\n\n\n\n\n\n\n\n\n\nå¯¹äºä½¿ç”¨ extends å…³é”®å­—çš„æ¡ä»¶ç±»å‹ï¼ˆå³ä¸Šé¢çš„ä¸‰å…ƒè¡¨è¾¾å¼ç±»å‹ï¼‰ï¼Œå¦‚æœ extends å‰é¢çš„å‚æ•°æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå½“ä¼ å…¥è¯¥å‚æ•°çš„æ˜¯è”åˆç±»å‹ï¼Œåˆ™ä½¿ç”¨åˆ†é…å¾‹è®¡ç®—æœ€ç»ˆçš„ç»“æœã€‚åˆ†é…å¾‹æ˜¯æŒ‡ï¼Œå°†è”åˆç±»å‹çš„è”åˆé¡¹æ‹†æˆå•é¡¹ï¼Œåˆ†åˆ«ä»£å…¥æ¡ä»¶ç±»å‹ï¼Œç„¶åå°†æ¯ä¸ªå•é¡¹ä»£å…¥å¾—åˆ°çš„ç»“æœå†è”åˆèµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ¤æ–­ç»“æœã€‚\nIf we plug a union type into ToArray, then the conditional type will be applied to each member of that union.å¦‚æœå°†è”åˆç±»å‹ä¼ å…¥ ToArrayï¼Œåˆ™æ¡ä»¶ç±»å‹å°†ä¼šåº”ç”¨åˆ°è”åˆç±»å‹çš„æ¯ä¸€ä¸ªæˆå‘˜ã€‚\nè¿˜æ˜¯ç”¨ä¸Šé¢çš„ä¾‹å­è¯´æ˜\ntype P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;\ntype A3 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; A3 çš„ç±»å‹æ˜¯ string | number\n\nè¯¥ä¾‹ä¸­ï¼Œextends çš„å‰å‚ä¸º Tï¼ŒT æ˜¯ä¸€ä¸ªæ³›å‹å‚æ•°ã€‚åœ¨ A3 çš„å®šä¹‰ä¸­ï¼Œç»™ T ä¼ å…¥çš„æ˜¯â€™xâ€™å’Œâ€™yâ€™çš„è”åˆç±»å‹â€™xâ€™ | â€˜yâ€™ï¼Œæ»¡è¶³åˆ†é…å¾‹ï¼Œäºæ˜¯â€™xâ€™å’Œâ€™yâ€™è¢«æ‹†å¼€ï¼Œåˆ†åˆ«ä»£å…¥ P\nP&lt;&#39;x&#39; | &#39;y&#39;&gt; &#x3D;&gt; P&lt;&#39;x&#39;&gt; | P&lt;&#39;y&#39;&gt;\n\n&#39;x&#39;ä»£å…¥å¾—åˆ°\n\n&#39;x&#39; extends &#39;x&#39; ? string : number &#x3D;&gt; string\n\n&#39;y&#39;ä»£å…¥å¾—åˆ°\n\n&#39;y&#39; extends &#39;x&#39; ? string : number &#x3D;&gt; number\n\nç„¶åå°†æ¯ä¸€é¡¹ä»£å…¥å¾—åˆ°çš„ç»“æœè”åˆèµ·æ¥ï¼Œå¾—åˆ° string | number\n\n\næ€»ä¹‹ï¼Œæ»¡è¶³ä¸¤ä¸ªè¦ç‚¹å³å¯é€‚ç”¨åˆ†é…å¾‹ï¼šç¬¬ä¸€ï¼Œå‚æ•°æ˜¯æ³›å‹ç±»å‹ï¼Œç¬¬äºŒï¼Œä»£å…¥å‚æ•°çš„æ˜¯è”åˆç±»å‹\nç‰¹æ®Šçš„ never\n&#x2F;&#x2F; never æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹\ntype A1 &#x3D; never extends &quot;x&quot; ? string : number; &#x2F;&#x2F; string\n\ntype P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;\ntype A2 &#x3D; P&lt;never&gt;; &#x2F;&#x2F; never\n\nä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒA2 å’Œ A1 çš„ç»“æœç«Ÿç„¶ä¸ä¸€æ ·ï¼Œçœ‹èµ·æ¥ never å¹¶ä¸æ˜¯ä¸€ä¸ªè”åˆç±»å‹ï¼Œæ‰€ä»¥ç›´æ¥ä»£å…¥æ¡ä»¶ç±»å‹çš„å®šä¹‰å³å¯ï¼Œè·å–çš„ç»“æœåº”è¯¥å’Œ A1 ä¸€ç›´æ‰å¯¹å•Šï¼Ÿ\nå®é™…ä¸Šï¼Œè¿™é‡Œè¿˜æ˜¯æ¡ä»¶åˆ†é…ç±»å‹åœ¨èµ·ä½œç”¨ã€‚never è¢«è®¤ä¸ºæ˜¯ç©ºçš„è”åˆç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰è”åˆé¡¹çš„è”åˆç±»å‹ï¼Œæ‰€ä»¥è¿˜æ˜¯æ»¡è¶³ä¸Šé¢çš„åˆ†é…å¾‹ï¼Œç„¶è€Œå› ä¸ºæ²¡æœ‰è”åˆé¡¹å¯ä»¥åˆ†é…ï¼Œæ‰€ä»¥ Pçš„è¡¨è¾¾å¼å…¶å®æ ¹æœ¬å°±æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€ä»¥ A2 çš„å®šä¹‰ä¹Ÿå°±ç±»ä¼¼äºæ°¸è¿œæ²¡æœ‰è¿”å›çš„å‡½æ•°ä¸€æ ·ï¼Œæ˜¯ never ç±»å‹çš„ã€‚\né˜²æ­¢æ¡ä»¶åˆ¤æ–­ä¸­çš„åˆ†é…\ntype P&lt;T&gt; &#x3D; [T] extends [&quot;x&quot;] ? string : number;\ntype A1 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; number\ntype A2 &#x3D; P&lt;never&gt;; &#x2F;&#x2F; string\n\nåœ¨æ¡ä»¶åˆ¤æ–­ç±»å‹çš„å®šä¹‰ä¸­ï¼Œå°†æ³›å‹å‚æ•°ä½¿ç”¨[]æ‹¬èµ·æ¥ï¼Œå³å¯é˜»æ–­æ¡ä»¶åˆ¤æ–­ç±»å‹çš„åˆ†é…ï¼Œæ­¤æ—¶ï¼Œä¼ å…¥å‚æ•° T çš„ç±»å‹å°†è¢«å½“åšä¸€ä¸ªæ•´ä½“ï¼Œä¸å†åˆ†é…ã€‚\n\n\nåŸç†(æ³¨æ„)\n\n\n\n\n\nTIP\néœ€å‰ç½®å­¦ä¹  extends å…³é”®å­—\n\n\n\næºç å¾ˆç®€å•ï¼Œåˆ¤æ–­è”åˆç±»å‹ T æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™è”åˆç±»å‹ Uï¼Œæ˜¯åˆ™è¿”å› neverï¼Œå¦åˆ™è¿”å› T\nnever æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ï¼Œåœ¨è¿™é‡Œå¯ä»¥è¡¨ç¤ºä¸ºç©ºçš„è”åˆç±»å‹ï¼Œåœ¨äºä¸å…¶ä»–ç±»å‹çš„è”åˆåï¼Œç»“æœä¸ºå…¶ä»–ç±»å‹ã€‚\næ²¡æœ‰éå†ï¼Œæ€ä¹ˆä¹Ÿèƒ½å®ç°å‘¢? è¿™é‡Œè¿˜æ¶‰åŠåˆ°extendsæ¡ä»¶ç±»å‹çš„ç‰¹æ®Šæƒ…å†µï¼Œextendsçš„å‰å‚Tå¦‚æœæ˜¯ä¸€ä¸ªæ³›å‹å‚æ•°ã€‚å¯¹äºä½¿ç”¨extendså…³é”®å­—çš„æ¡ä»¶ç±»å‹ï¼ˆå³ä¸Šé¢çš„ä¸‰å…ƒè¡¨è¾¾å¼ç±»å‹ï¼‰ï¼Œå¦‚æœextendså‰é¢çš„å‚æ•°æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå½“ä¼ å…¥è¯¥å‚æ•°çš„æ˜¯è”åˆç±»å‹ï¼Œä¸¤ä¸ªç±»å‹ä¼šæˆä¸ºåˆ†é…æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰ã€‚åˆ†é…æ¡ä»¶ç±»å‹æ˜¯æŒ‡ï¼Œå°†è”åˆç±»å‹çš„è”åˆé¡¹æ‹†æˆå•é¡¹ï¼Œåˆ†åˆ«ä»£å…¥æ¡ä»¶ç±»å‹ï¼Œç„¶åå°†æ¯ä¸ªå•é¡¹ä»£å…¥å¾—åˆ°çš„ç»“æœå†è”åˆèµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ¤æ–­ç»“æœã€‚\n\ntype Exclude&lt;T, U&gt; &#x3D; T extends U ? never : T;\n\nExtract&lt;Type, Union&gt;Released:2.8\nConstructs a type by extracting from Type all union members that are assignable to Union.ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œå®ƒæ˜¯ä»Typeç±»å‹é‡Œé¢æå–äº†æ‰€æœ‰å¯ä»¥èµ‹ç»™Unionçš„ç±»å‹ã€‚\n&#x2F;&#x2F; Example\ntype T0 &#x3D; Extract&lt;&quot;a&quot; | &quot;b&quot; | &quot;c&quot;, &quot;a&quot; | &quot;f&quot;&gt;;\n&#x2F;&#x2F; type T0 &#x3D; &quot;a&quot;;\n\ntype T1 &#x3D; Extract&lt;string | number | (() &#x3D;&gt; void), Function&gt;;\n&#x2F;&#x2F; type T1 &#x3D; () &#x3D;&gt; void;\n\nåŸç†(æ³¨æ„)\n\n\n\n\n\nTIP\néœ€å‰ç½®å­¦ä¹  extends å…³é”®å­—\n\n\nåŸç†ï¼šä¸ Exclude ç›¸åï¼Œåˆ¤æ–­è”åˆç±»å‹ T æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™è”åˆç±»å‹ Uï¼Œæ˜¯åˆ™è¿”å› Tï¼Œå¦åˆ™è¿”å› neverã€‚\ntype Extract&lt;T, U&gt; &#x3D; T extends U ? T : never;\n\nNonNullableReleased:2.8\nConstructs a type by excluding null and undefined from Type.ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œè¿™ä¸ªç±»å‹ä»Typeä¸­æ’é™¤äº†æ‰€æœ‰çš„nullã€undefinedçš„ç±»å‹ã€‚\n&#x2F;&#x2F; Example\ntype T0 &#x3D; NonNullable&lt;string | number | undefined&gt;;\n\n&#x2F;&#x2F; type T0 &#x3D; string | number;\n\ntype T1 &#x3D; NonNullable&lt;string[] | null | undefined&gt;;\n\n&#x2F;&#x2F; type T1 &#x3D; string[];\n\nåŸç†åˆ¤æ–­ T æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™ null æˆ–è€… undefined ç±»å‹ï¼Œæ˜¯åˆ™è¿”å› neverï¼Œå¦åˆ™è¿”å› Tï¼Œå¦‚æœè¿™æ®µçœ‹ä¸æ˜ç™½çš„å¯ä»¥å†çœ‹ä¸‹ Exclude é‚£æ®µå…³äº extends çš„è¡¥å……è¯´æ˜ã€‚\ntype NonNullable&lt;T&gt; &#x3D; T extends null | undefined ? never : T;\n\nParametersReleased:3.1\nConstructs a tuple type from the types used in the parameters of a function type Type.ç”¨äºæ ¹æ®æ‰€æœ‰Typeä¸­å‡½æ•°ç±»å‹çš„å‚æ•°æ„é€ ä¸€ä¸ªå…ƒç¥–ç±»å‹ã€‚\n&#x2F;&#x2F; Example\ndeclare function f1(arg: &#123; a: number; b: string &#125;): void;\n\ntype T0 &#x3D; Parameters&lt;() &#x3D;&gt; string&gt;;\n&#x2F;&#x2F; type T0 &#x3D; []\n\ntype T1 &#x3D; Parameters&lt;(s: string) &#x3D;&gt; void&gt;;\n&#x2F;&#x2F; type T1 &#x3D; [s: string]\n\ntype T2 &#x3D; Parameters&lt;&lt;T&gt;(arg: T) &#x3D;&gt; T&gt;;\n&#x2F;&#x2F; type T2 &#x3D; [arg: unknown]\n\ntype T3 &#x3D; Parameters&lt;typeof f1&gt;;\n&#x2F;&#x2F; type T3 &#x3D; [arg: &#123;\n&#x2F;&#x2F;   a: number;\n&#x2F;&#x2F;   b: string;\n&#x2F;&#x2F; &#125;]\n\ntype T4 &#x3D; Parameters&lt;any&gt;;\n&#x2F;&#x2F; type T4 &#x3D; unknown[]\n\ntype T5 &#x3D; Parameters&lt;never&gt;;\n&#x2F;&#x2F; type T5 &#x3D; never\n\ntype T6 &#x3D; Parameters&lt;string&gt;;\n&#x2F;&#x2F; Type &#39;string&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; type T6 &#x3D; never\n\ntype T7 &#x3D; Parameters&lt;Function&gt;;\n&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;(...args: any): any&#39;.\n\ntype T7 &#x3D; never;\n\nåŸç†ï¼š\nParameters é¦–å…ˆçº¦æŸå‚æ•° T å¿…é¡»æ˜¯ä¸ªå‡½æ•°ç±»å‹\nåˆ¤æ–­ T æ˜¯å¦æ˜¯å‡½æ•°ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™ä½¿ç”¨ infer P æš‚æ—¶å­˜ä¸€ä¸‹å‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œç›´æ¥ç”¨ P å³å¯å¾—åˆ°è¿™ä¸ªç±»å‹å¹¶è¿”å›ï¼Œå¦åˆ™å°±è¿”å› never\n\ntype Parameters&lt;T extends (...args: any) &#x3D;&gt; any&gt; &#x3D; T extends (\n  ...args: infer P\n) &#x3D;&gt; any\n  ? P\n  : never;\n\nè¿™é‡Œç”¨åˆ°äº†inferï¼Œinfer Pæ ‡è®°ä¸€ä¸ªæ³›å‹ï¼Œè¡¨ç¤ºè¿™ä¸ªæ³›å‹æ˜¯ä¸€ä¸ªå¾…æ¨æ–­çš„ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚\nConstructorParametersæ„é€ å‚æ•°ç±»å‹Released:3.1\nConstructs a tuple or array type from the types of a constructor function type. It produces a tuple type with all the parameter types (or the type never if Type is not a function).æ„é€ ä¸€ä¸ªä»æ„é€ å‡½æ•°ç±»å‹Typeä¸­æå–çš„å…ƒç»„æˆ–æ•°ç»„ç±»å‹ã€‚å¦‚æœTypeä¸æ˜¯å‡½æ•°ï¼Œåˆ™ç”Ÿæˆneverç±»å‹ã€‚\n&#x2F;&#x2F; Example\ntype T0 &#x3D; ConstructorParameters&lt;ErrorConstructor&gt;;\n&#x2F;&#x2F; type T0 &#x3D; [message?: string]\n\ntype T1 &#x3D; ConstructorParameters&lt;FunctionConstructor&gt;;\n&#x2F;&#x2F; type T1 &#x3D; string[]\n\ntype T2 &#x3D; ConstructorParameters&lt;RegExpConstructor&gt;;\n&#x2F;&#x2F; type T2 &#x3D; [pattern: string | RegExp, flags?: string]\n\ntype T3 &#x3D; ConstructorParameters&lt;any&gt;;\n&#x2F;&#x2F; type T3 &#x3D; unknown[]\n\ntype T4 &#x3D; ConstructorParameters&lt;Function&gt;;\n&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;abstract new (...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;new (...args: any): any&#39;.\n\n&#x2F;&#x2F; type T4 &#x3D; never\n\nReturnTypeReleased:2.8\nConstructs a type consisting of the return type of function Type.ç”¨äºæ„é€ ä¸€ä¸ªå«æœ‰Typeå‡½æ•°çš„è¿”å›å€¼çš„ç±»å‹ã€‚\n&#x2F;&#x2F; Example\ndeclare function f1(): &#123; a: number; b: string &#125;;\n\ntype T0 &#x3D; ReturnType&lt;() &#x3D;&gt; string&gt;;\n&#x2F;&#x2F; type T0 &#x3D; string\n\ntype T1 &#x3D; ReturnType&lt;(s: string) &#x3D;&gt; void&gt;;\n&#x2F;&#x2F; type T1 &#x3D; void\n\ntype T2 &#x3D; ReturnType&lt;&lt;T&gt;() &#x3D;&gt; T&gt;;\n&#x2F;&#x2F; type T2 &#x3D; unknown\n\ntype T3 &#x3D; ReturnType&lt;&lt;T extends U, U extends number[]&gt;() &#x3D;&gt; T&gt;;\n&#x2F;&#x2F; type T3 &#x3D; number[]\n\ntype T4 &#x3D; ReturnType&lt;typeof f1&gt;;\n&#x2F;&#x2F; type T4 &#x3D; &#123;\n&#x2F;&#x2F; a: number;\n&#x2F;&#x2F; b: string;\n&#x2F;&#x2F; &#125;\n\ntype T5 &#x3D; ReturnType&lt;any&gt;;\n&#x2F;&#x2F; type T5 &#x3D; any\n\ntype T6 &#x3D; ReturnType&lt;never&gt;;\n&#x2F;&#x2F; type T6 &#x3D; never\n\ntype T7 &#x3D; ReturnType&lt;string&gt;;\n&#x2F;&#x2F; Type &#39;string&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; type T7 &#x3D; any\n\ntype T8 &#x3D; ReturnType&lt;Function&gt;;\n&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;(...args: any): any&#39;.\n\n&#x2F;&#x2F; type T8 &#x3D; any\n\nåŸç†ä¸ Parameters ç±»ä¼¼\nReturnType é¦–å…ˆçº¦æŸå‚æ•° T å¿…é¡»æ˜¯ä¸ªå‡½æ•°ç±»å‹åˆ¤æ–­ T æ˜¯å¦æ˜¯å‡½æ•°ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™ä½¿ç”¨ infer R æš‚æ—¶å­˜ä¸€ä¸‹å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼Œåé¢çš„è¯­å¥ç›´æ¥ç”¨ R å³å¯å¾—åˆ°è¿™ä¸ªç±»å‹å¹¶è¿”å›ï¼Œå¦åˆ™å°±è¿”å› any\ntype ReturnType&lt;T extends (...args: any) &#x3D;&gt; any&gt; &#x3D; T extends (\n  ...args: any\n) &#x3D;&gt; infer R\n  ? R\n  : any;\n\nInstanceTypeReleased:2.8\nConstructs a type consisting of the instance type of a constructor function in Type.è¿”å›æ„é€ å‡½æ•°ç±»å‹Tçš„å®ä¾‹ç±»å‹\n&#x2F;&#x2F; Example\nclass C &#123;\n  x &#x3D; 0;\n  y &#x3D; 0;\n&#125;\n\ntype T0 &#x3D; InstanceType&lt;typeof C&gt;;\n&#x2F;&#x2F; type T0 &#x3D; C\n\ntype T1 &#x3D; InstanceType&lt;any&gt;;\n&#x2F;&#x2F; type T1 &#x3D; any\n\ntype T2 &#x3D; InstanceType&lt;never&gt;;\n&#x2F;&#x2F; type T2 &#x3D; never\n\ntype T3 &#x3D; InstanceType&lt;string&gt;;\n&#x2F;&#x2F; Type &#39;string&#39; does not satisfy the constraint &#39;abstract new (...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; type T3 &#x3D; any\n\ntype T4 &#x3D; InstanceType&lt;Function&gt;;\n&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;abstract new (...args: any) &#x3D;&gt; any&#39;.\n&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;new (...args: any): any&#39;.\n\n&#x2F;&#x2F; type T4 &#x3D; any\nåŸç†type InstanceType&lt;T extends abstract new (...args: any) =&gt; any&gt; = T extends abstract new (...args: any) =&gt; infer R ? R : anyä¸ResultType ç±»ä¼¼type ReturnType&lt;T extends (...args: any) =&gt; any&gt; = T extends (...args: any) =&gt; infer R ? R : any;\nThisParameterTypeReleased:3.3\nExtracts the type of the this parameter for a function type, or unknown if the function type has no this parameter.ç”¨äºæå–ä¸€ä¸ªå‡½æ•°ç±»å‹Typeçš„this (opens new window)å‚æ•°ç±»å‹ï¼Œè¿”å›unknown (opens new window)å¦‚æœè¿™ä¸ªå‡½æ•°ç±»å‹æ²¡æœ‰thiså‚æ•°ã€‚\n&#x2F;&#x2F; Example\nfunction toHex(this: Number) &#123;\n  return this.toString(16);\n&#125;\n\nfunction numberToString(n: ThisParameterType&lt;typeof toHex&gt;) &#123;\n  return toHex.apply(n);\n&#125;\n\nOmitThisParameterReleased:3.3\nRemoves the this parameter from Type. If Type has no explicitly declared this parameter, the result is simply Type. Otherwise, a new function type with no this parameter is created from Type. Generics are erased and only the last overload signature is propagated into the new function type.ç”¨äºç§»é™¤ä¸€ä¸ªå‡½æ•°ç±»å‹Typeçš„this (opens new window)å‚æ•°ç±»å‹ã€‚å¦‚æœTypeæ²¡æœ‰æ˜ç¡®çš„å£°æ˜this ç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿”å›çš„ç»“æœå°±æ˜¯Typeï¼Œä¸ç„¶çš„è¯ï¼Œå°±è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ç±»å‹ï¼ŒåŸºäºTypeï¼Œä½†ä¸å†æœ‰thiså‚æ•°ã€‚èŒƒå‹ä¼šè¢«æŠ¹å»ï¼Œåªæœ‰æœ€åé‡è½½çš„ç­¾åè¢«ä¼ æ’­è¿›äº†è¿”å›çš„æ–°çš„å‡½æ•°ç±»å‹ã€‚\n&#x2F;&#x2F; Example\nfunction toHex(this: Number) &#123;\n  return this.toString(16);\n&#125;\n\nconst fiveToHex: OmitThisParameter&lt;typeof toHex&gt; &#x3D; toHex.bind(5);\n\nconsole.log(fiveToHex());\n\nThisTypeReleased:2.3\nThis utility does not return a transformed type. Instead, it serves as a marker for a contextual this type. Note that the noImplicitThis flag must be enabled to use this utility.è¿™ä¸ªç±»å‹ä¸è¿”å›ä¸€ä¸ªè½¬æ¢è¿‡çš„ç±»å‹ï¼Œå®ƒè¢«ç”¨ä½œæ ‡è®°ä¸€ä¸ªä¸Šä¸‹æ–‡çš„thisç±»å‹ã€‚æ³¨æ„ä¸‹å¦‚æœæƒ³ä½¿ç”¨è¿™ä¸ªå·¥å…·ç±»å‹ï¼ŒnoImplicitThis (opens new window)çš„flagå¿…é¡»å¯ç”¨ã€‚\n&#x2F;&#x2F; Example\ntype ObjectDescriptor&lt;D, M&gt; &#x3D; &#123;\n  data?: D;\n  methods?: M &amp; ThisType&lt;D &amp; M&gt;; &#x2F;&#x2F; Type of &#39;this&#39; in methods is D &amp; M\n&#125;;\n\nfunction makeObject&lt;D, M&gt;(desc: ObjectDescriptor&lt;D, M&gt;): D &amp; M &#123;\n  let data: object &#x3D; desc.data || &#123;&#125;;\n  let methods: object &#x3D; desc.methods || &#123;&#125;;\n  return &#123; ...data, ...methods &#125; as D &amp; M;\n&#125;\n\nlet obj &#x3D; makeObject(&#123;\n  data: &#123; x: 0, y: 0 &#125;,\n  methods: &#123;\n    moveBy(dx: number, dy: number) &#123;\n      this.x +&#x3D; dx; &#x2F;&#x2F; Strongly typed this\n      this.y +&#x3D; dy; &#x2F;&#x2F; Strongly typed this\n    &#125;,\n  &#125;,\n&#125;);\n\nobj.x &#x3D; 10;\nobj.y &#x3D; 20;\nobj.moveBy(5, 5);\n\nIn the example above, the methods object in the argument to makeObject has a contextual type that includes ThisType&lt;D &amp; M&gt; and therefore the type of this in methods within the methods object is { x: number, y: number } &amp; { moveBy(dx: number, dy: number): number }. Notice how the type of the methods property simultaneously is an inference target and a source for the this type in methods.åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒmakeObjectçš„å‚æ•°ä¸­çš„methodså¯¹è±¡åŒ…å«äº†ä¸€ä¸ªä¸Šä¸‹æ–‡ç±»å‹ï¼Œè¯¥ç±»å‹åŒ…å«äº†ThisType&lt;D &amp; M&gt;ï¼Œå› æ­¤methodså¯¹è±¡ä¸­çš„thisç±»å‹æ˜¯&#123; x: number, y: number &#125; &amp; &#123; moveBy(dx: number, dy: number): number &#125;ã€‚è¯·æ³¨æ„ï¼Œmethodså±æ€§çš„ç±»å‹åŒæ—¶æ˜¯ä¸€ä¸ªæ¨æ–­ç›®æ ‡å’Œä¸€ä¸ªmethodså¯¹è±¡ä¸­çš„thisç±»å‹çš„æºã€‚The ThisType marker interface is simply an empty interface declared in lib.d.ts. Beyond being recognized in the contextual type of an object literal, the interface acts like any empty interface.ThisType&lt;T&gt;æ ‡è®°æ¥å£æ˜¯åœ¨lib.d.tsä¸­å£°æ˜çš„ç©ºæ¥å£ã€‚å®ƒåªæ˜¯åœ¨å¯¹è±¡å­—é¢é‡çš„ä¸Šä¸‹æ–‡ç±»å‹ä¸­è¢«è¯†åˆ«è€Œå·²ï¼Œè¯¥æ¥å£çš„è¡Œä¸ºä¸ç©ºæ¥å£ä¸€æ ·ã€‚\nIntrinsic String Manipulation Typeså†…éƒ¨å­—ç¬¦ä¸²æ“ä½œç±»å‹UppercaseLowercaseCapitalizeUncapitalize\nTo help with string manipulation around template string literals, TypeScript includes a set of types which can be used in string manipulation within the type system. You can find those in the Template Literal Types documentation.ä¸ºäº†å¸®åŠ©æ¨¡æ¿å­—ç¬¦ä¸²æ“ä½œï¼ŒTypeScriptåŒ…å«ä¸€ç»„å¯ä»¥åœ¨å­—ç¬¦ä¸²æ“ä½œä¸­ä½¿ç”¨çš„ç±»å‹ã€‚ä½ å¯ä»¥åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹æ–‡æ¡£ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚\nå‚è€ƒé“¾æ¥typescript handbook utility-typeså·¥å…·ç±»å‹Typescript ä¸­çš„ extends å…³é”®å­—Exclude ä¸ Extract å‰ç½®å­¦ä¹ é¡¹Typescript Classes extends-clauseså½»åº•ææ‡‚ typescript å·¥å…·ç±»å‹åŠå…¶åŸç† è¯¥æ–‡æœ‰é”™è¯¯å†…å®¹ï¼Œè¦æ³¨æ„å“¦\n","slug":"2022-06-09ts-util-type","date":"2022-06-08T14:49:28.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"29a670518a826389296f8915224ed71e","title":"9.Typescriptæ‰‹å†Œ æ¨¡å—","content":"JavaScript has a long history of different ways to handle modularizing code. TypeScript having been around since 2012, has implemented support for a lot of these formats, but over time the community and the JavaScript specification has converged on a format called ES Modules (or ES6 modules). You might know it as the import&#x2F;export syntax.JavaScript æœ‰å¾ˆé•¿çš„å†å²ï¼Œä¸åŒçš„æ–¹å¼æ¥å¤„ç†ä»£ç çš„æ¨¡å—åŒ–ã€‚TypeScript ä» 2012 å¹´å¼€å§‹ï¼Œå°±æ”¯æŒäº†å¤§é‡çš„æ¨¡å—åŒ–æ ¼å¼ï¼Œä½†æ˜¯ï¼Œåœ¨è¿‡å»çš„æ—¶é—´ï¼Œç¤¾åŒºå’Œ JavaScript è§„èŒƒä¸€è‡´åœ°èšåˆäº†ä¸€ä¸ªæ¨¡å—åŒ–æ ¼å¼ï¼Œå«åš ES Modulesï¼ˆæˆ– ES6 æ¨¡å—ï¼‰ã€‚ä½ å¯èƒ½ä¼šçŸ¥é“å®ƒå«åš import/export è¯­æ³•ã€‚\nES Modules was added to the JavaScript spec in 2015, and by 2020 had broad support in most web browsers and JavaScript runtimes.ES Modules åœ¨ 2015 å¹´æ·»åŠ åˆ° JavaScript è§„èŒƒï¼Œ2020 å¹´å·²ç»æœ‰å¹¿æ³›çš„æ”¯æŒåœ¨å¤§éƒ¨åˆ†çš„ web æµè§ˆå™¨å’Œ JavaScript è¿è¡Œæ—¶ã€‚For focus, the handbook will cover both ES Modules and its popular pre-cursor CommonJS module.exports &#x3D; syntax, and you can find information about the other module patterns in the reference section under Modules.ä¸ºäº†è·å¾—ç„¦ç‚¹ï¼Œæœ¬æ‰‹å†Œå°†ä»‹ç» ES Modules å’Œå…¶å¸¸ç”¨çš„å…ˆè¡Œæ¨¡å— CommonJS module.exports = åŒä¹‰è¯ï¼Œå¹¶ä¸”ä½ å¯ä»¥åœ¨ Modules ä¸‹çš„å‚è€ƒèŠ‚ä¸­æ‰¾åˆ°å…¶ä»–æ¨¡å—æ¨¡å¼çš„ä¿¡æ¯ã€‚\nHow JavaScript Modules are DefinedIn TypeScript, just as in ECMAScript 2015, any file containing a top-level import or export is considered a module.åœ¨ TypeScript ä¸­ï¼Œåªè¦æ–‡ä»¶åŒ…å«ä¸€ä¸ªé¡¶å±‚çš„ import æˆ– export å°±è¢«è§†ä¸ºä¸€ä¸ªæ¨¡å—ã€‚Conversely, a file without any top-level import or export declarations is treated as a script whose contents are available in the global scope (and therefore to modules as well).åä¹‹ï¼Œä¸€ä¸ªæ²¡æœ‰é¡¶å±‚çš„ import æˆ– export å£°æ˜çš„æ–‡ä»¶å°±è¢«è§†ä¸ºä¸€ä¸ªè„šæœ¬ï¼Œå…¶å†…å®¹å¯ä»¥åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ä½¿ç”¨ï¼ˆå¹¶ä¸”ä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡å—ä½¿ç”¨ï¼‰ã€‚Modules are executed within their own scope, not in the global scope. This means that variables, functions, classes, etc. declared in a module are not visible outside the module unless they are explicitly exported using one of the export forms. Conversely, to consume a variable, function, class, interface, etc. exported from a different module, it has to be imported using one of the import forms.æ¨¡å—æ˜¯åœ¨è‡ªå·±çš„ä½œç”¨åŸŸä¸­æ‰§è¡Œçš„ï¼Œä¸æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­æ‰§è¡Œçš„ã€‚è¿™æ„å‘³ç€åœ¨æ¨¡å—ä¸­å£°æ˜çš„å˜é‡ï¼Œå‡½æ•°ï¼Œç±»ï¼Œæ¥å£ç­‰ç­‰ï¼Œåªæœ‰åœ¨æ˜¾å¼çš„ä½¿ç”¨ export å£°æ˜çš„æ—¶å€™æ‰èƒ½åœ¨æ¨¡å—å¤–è¢«è®¿é—®ã€‚åä¹‹ï¼Œè¦ä»å…¶ä»–æ¨¡å—ä¸­æ¶ˆè´¹ä¸€ä¸ªå˜é‡ï¼Œå‡½æ•°ï¼Œç±»ï¼Œæ¥å£ç­‰ç­‰ï¼Œå¿…é¡»ä½¿ç”¨ import å£°æ˜æ¥å¯¼å…¥ã€‚\nNon-moduleséæ¨¡å—Before we start, itâ€™s important to understand what TypeScript considers a module. The JavaScript specification declares that any JavaScript files without an export or top-level await should be considered a script and not a module.åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½ TypeScript è®¤ä¸ºä»€ä¹ˆæ˜¯æ¨¡å—ã€‚JavaScript è§„èŒƒå®šä¹‰äº†ä»»ä½•æ²¡æœ‰ export æˆ– top-level await çš„ JavaScript æ–‡ä»¶éƒ½è¢«è§†ä¸ºè„šæœ¬è€Œä¸æ˜¯æ¨¡å—ã€‚Inside a script file variables and types are declared to be in the shared global scope, and itâ€™s assumed that youâ€™ll either use the outFile compiler option to join multiple input files into one output file, or use multiple  tags in your HTML to load these files (in the correct order!).åœ¨è„šæœ¬æ–‡ä»¶ä¸­ï¼Œå˜é‡å’Œç±»å‹è¢«å£°æ˜ä¸ºå…±äº«çš„å…¨å±€ä½œç”¨åŸŸï¼Œå¹¶ä¸”æˆ‘ä»¬å‡è®¾ä½ ä¼šä½¿ç”¨ outFile ç¼–è¯‘é€‰é¡¹å°†å¤šä¸ªè¾“å…¥æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨å¤šä¸ª &lt;script&gt; æ ‡ç­¾åœ¨ä½ çš„ HTML ä¸­åŠ è½½è¿™äº›æ–‡ä»¶ï¼ˆæŒ‰ç…§æ­£ç¡®çš„é¡ºåºï¼‰ã€‚If you have a file that doesnâ€™t currently have any imports or exports, but you want to be treated as a module, add the line:å¦‚æœä½ æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒç›®å‰æ²¡æœ‰ä»»ä½• import æˆ– export å£°æ˜ï¼Œä½†æ˜¯ä½ æƒ³è¢«è§†ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œé‚£ä¹ˆæ·»åŠ è¿™ä¸€è¡Œï¼š\nexport &#123;&#125;;\n\nwhich will change the file to be a module exporting nothing. This syntax works regardless of your module target.è¿™ç§è¯­æ³•å¯¹äºä½ çš„æ¨¡å—ç›®æ ‡æ— è®ºå¦‚ä½•éƒ½æ˜¯å¯è¡Œçš„ã€‚\nModules in TypeScriptTypeScript ä¸­çš„æ¨¡å—Additional Reading:é™„åŠ é˜…è¯»ï¼šImpatient JS (Modules)ä¸çŸ¥é“æ¨¡å—çš„ TypeScriptMDN: JavaScript ModulesMDNï¼šJavaScript æ¨¡å—There are three main things to consider when writing module-based code in TypeScript:åœ¨ TypeScript ä¸­å†™æ¨¡å—åŸºç¡€çš„ä»£ç æ—¶ï¼Œè¦è€ƒè™‘ä¸‰ä¸ªä¸»è¦é—®é¢˜ï¼šSyntax: What syntax do I want to use to import and export things?è¯­æ³•ï¼šæˆ‘æƒ³è¦ä½¿ç”¨ä»€ä¹ˆè¯­æ³•æ¥å¯¼å…¥å’Œå¯¼å‡ºä¸œè¥¿ï¼ŸModule Resolution: What is the relationship between module names (or paths) and files on disk?æ¨¡å—è§£æï¼šæ¨¡å—åï¼ˆæˆ–è·¯å¾„ï¼‰å’Œç£ç›˜ä¸Šçš„æ–‡ä»¶ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼ŸModule Output Target: What should my emitted JavaScript module look like?æ¨¡å—è¾“å‡ºç›®æ ‡ï¼šæˆ‘çš„è¾“å‡ºçš„ JavaScript æ¨¡å—åº”è¯¥æ€æ ·çœ‹ï¼Ÿ\nES Module SyntaxES æ¨¡å—è¯­æ³•A file can declare a main export via export default:ä¸€ä¸ªæ–‡ä»¶å¯ä»¥é€šè¿‡ export default å£°æ˜ä¸€ä¸ªä¸»è¦çš„å¯¼å‡ºï¼š\n&#x2F;&#x2F; @filename: hello.ts\nexport default function helloWorld() &#123;\n  console.log(&quot;Hello, world!&quot;);\n&#125;\n\nThis is then imported via:è¿™æ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯¼å…¥çš„ï¼š\nimport helloWorld from &quot;.&#x2F;hello.js&quot;;\nhelloWorld();\n\nIn addition to the default export, you can have more than one export of variables and functions via the export by omitting default:é™¤äº†é»˜è®¤å¯¼å‡ºï¼Œä½ è¿˜å¯ä»¥æœ‰å¤šä¸ªå¯¼å‡ºçš„å˜é‡å’Œå‡½æ•°ï¼Œé€šè¿‡å°† default å»æ‰ï¼š\n&#x2F;&#x2F; @filename: maths.ts\nexport var pi &#x3D; 3.14;\nexport let squareTwo &#x3D; 1.41;\nexport const phi &#x3D; 1.61;\n\nexport class RandomNumberGenerator &#123;&#125;\n\nexport function absolute(num: number) &#123;\nif (num &lt; 0) return num \\* -1;\n  return num;\n&#125;\n\nThese can be used in another file via the import syntax:è¿™äº›å¯ä»¥åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­é€šè¿‡å¯¼å…¥è¯­æ³•ä½¿ç”¨ï¼š\nimport &#123; pi, phi, absolute &#125; from &quot;.&#x2F;maths.js&quot;;\n\nconsole.log(pi);\nconst absPhi &#x3D; absolute(phi);\n\n&#x2F;&#x2F; const absPhi: number;\n\nAdditional Import Syntaxé™„åŠ å¯¼å…¥è¯­æ³•An import can be renamed using a format like import {old as new}:ä¸€ä¸ªå¯¼å…¥å¯ä»¥é€šè¿‡è¿™æ ·çš„æ ¼å¼ï¼šimport &#123;old as new&#125;ï¼š\nimport &#123; pi as Ï€ &#125; from &quot;.&#x2F;maths.js&quot;;\n\nconsole.log(Ï€);\n\n&#x2F;&#x2F; (alias) var Ï€: number\n&#x2F;&#x2F; import Ï€\n\nYou can mix and match the above syntax into a single import:ä½ å¯ä»¥æ··åˆè¿™äº›è¯­æ³•åˆ°ä¸€ä¸ªå•ç‹¬çš„å¯¼å…¥ï¼š\n&#x2F;&#x2F; @filename: maths.ts\nexport const pi &#x3D; 3.14;\nexport default class RandomNumberGenerator &#123;&#125;\n\n&#x2F;&#x2F; @filename: app.ts\nimport RandomNumberGenerator, &#123; pi as Ï€ &#125; from &quot;.&#x2F;maths.js&quot;;\n\nRandomNumberGenerator;\n\n&#x2F;&#x2F; (alias) class RandomNumberGenerator\n&#x2F;&#x2F; import RandomNumberGenerator\n\nconsole.log(Ï€);\n\n&#x2F;&#x2F; (alias) const Ï€: 3.14\n&#x2F;&#x2F; import Ï€\n\nYou can take all of the exported objects and put them into a single namespace using * as name:ä½ å¯ä»¥å°†æ‰€æœ‰å¯¼å‡ºçš„å¯¹è±¡æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„å‘½åç©ºé—´ï¼Œä½¿ç”¨ \\* as nameï¼š\n&#x2F;&#x2F; @filename: app.ts\nimport \\* as math from &quot;.&#x2F;maths.js&quot;;\n\nconsole.log(math.pi);\nconst positivePhi &#x3D; math.absolute(math.phi);\n\n&#x2F;&#x2F; const positivePhi: number\n\nYou can import a file and not include any variables into your current module via import \"./file\":ä½ å¯ä»¥é€šè¿‡ import &quot;./file&quot; å¯¼å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸åŒ…å«ä»»ä½•å˜é‡åˆ°å½“å‰æ¨¡å—ï¼š\n&#x2F;&#x2F; @filename: app.ts\nimport &quot;.&#x2F;maths.js&quot;;\n\nconsole.log(&quot;3.14&quot;);\n\nIn this case, the import does nothing. However, all of the code in maths.ts was evaluated, which could trigger side-effects which affect other objects.åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¼å…¥å¹¶æ²¡æœ‰ä»€ä¹ˆäº‹æƒ…ã€‚ä½†æ˜¯ï¼Œmaths.ts ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ä¼šè¢«è¯„ä¼°ï¼Œè¿™å¯èƒ½ä¼šè§¦å‘å…¶ä»–å¯¹è±¡çš„å‰¯ä½œç”¨ã€‚\nTypeScript Specific ES Module SyntaxTypeScript ç‰¹å®šçš„ ES æ¨¡å—è¯­æ³•Types can be exported and imported using the same syntax as JavaScript values:ç±»å‹å¯ä»¥ä½¿ç”¨ç›¸åŒçš„è¯­æ³•æ¥å¯¼å‡ºå’Œå¯¼å…¥ JavaScript å€¼ï¼š\n&#x2F;&#x2F; @filename: animal.ts\nexport type Cat &#x3D; &#123; breed: string; yearOfBirth: number &#125;;\n\nexport interface Dog &#123;\n  breeds: string[];\n  yearOfBirth: number;\n&#125;\n\n&#x2F;&#x2F; @filename: app.ts\nimport &#123; Cat, Dog &#125; from &quot;.&#x2F;animal.js&quot;;\ntype Animals &#x3D; Cat | Dog;\n\nTypeScript has extended the import syntax with two concepts for declaring an import of a type:TypeScript å·²ç»æ‰©å±•äº†å¯¼å…¥ç±»å‹çš„è¯­æ³•ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ¦‚å¿µæ¥å£°æ˜å¯¼å…¥ç±»å‹ï¼š\nimport type\n&#x2F;&#x2F; Which is an import statement which can only import types:\n&#x2F;&#x2F; åªèƒ½å¯¼å…¥ç±»å‹çš„å¯¼å…¥è¯­å¥ï¼š\n&#x2F;&#x2F; @filename: animal.ts\nexport type Cat &#x3D; &#123; breed: string; yearOfBirth: number &#125;;\n&#x2F;&#x2F; &#39;createCatName&#39; cannot be used as a value because it was imported using &#39;import type&#39;.\n&#x2F;&#x2F; &#39;createCatName&#39; ä¸èƒ½è¢«ç”¨ä½œå€¼ï¼Œå› ä¸ºå®ƒè¢«å¯¼å…¥ä½¿ç”¨äº† &#39;import type&#39;ã€‚\nexport type Dog &#x3D; &#123; breeds: string[]; yearOfBirth: number &#125;;\nexport const createCatName &#x3D; () &#x3D;&gt; &quot;fluffy&quot;;\n\n&#x2F;&#x2F; @filename: valid.ts\nimport type &#123; Cat, Dog &#125; from &quot;.&#x2F;animal.js&quot;;\nexport type Animals &#x3D; Cat | Dog;\n\n&#x2F;&#x2F; @filename: app.ts\nimport type &#123; createCatName &#125; from &quot;.&#x2F;animal.js&quot;;\nconst name &#x3D; createCatName();\n\nInline type importså†…è”ç±»å‹å¯¼å…¥\nTypeScript 4.5 also allows for individual imports to be prefixed with type to indicate that the imported reference is a type:TypeScript 4.5 å¯ä»¥ä½¿ç”¨ type å‰ç¼€æ¥å£°æ˜å¯¼å…¥çš„å¼•ç”¨æ˜¯ä¸€ä¸ªç±»å‹ï¼š\n&#x2F;&#x2F; @filename: app.ts\nimport &#123; createCatName, type Cat, type Dog &#125; from &quot;.&#x2F;animal.js&quot;;\n\nexport type Animals &#x3D; Cat | Dog;\nconst name &#x3D; createCatName();\n\nTogether these allow a non-TypeScript transpiler like Babel, swc or esbuild to know what imports can be safely removed.è¿™äº›åŒæ—¶å…è®¸ä¸€ä¸ªé TypeScript ç¼–è¯‘å™¨ï¼Œå¦‚ Babelã€swc æˆ– esbuild çŸ¥é“å“ªäº›å¯¼å…¥å¯ä»¥å®‰å…¨åœ°ç§»é™¤ã€‚\nES Module Syntax with CommonJS BehaviorES æ¨¡å—è¯­æ³•ä¸ CommonJS è¡Œä¸ºTypeScript has ES Module syntax which directly correlates to a CommonJS and AMD require. Imports using ES Module are for most cases the same as the require from those environments, but this syntax ensures you have a 1 to 1 match in your TypeScript file with the CommonJS output:TypeScript æœ‰ ES æ¨¡å—è¯­æ³•ï¼Œå®ƒç›¸å¯¹äº CommonJS å’Œ AMD requireã€‚ä½¿ç”¨ ES Module çš„å¯¼å…¥æ˜¯ä¸ºäº†å¤§å¤šæ•°æƒ…å†µä¸‹ä¸è¿™äº›ç¯å¢ƒçš„ require ä¸€è‡´ï¼Œä½†è¿™ç§è¯­æ³•ç¡®ä¿äº†ä½ çš„ TypeScript æ–‡ä»¶ä¸ CommonJS è¾“å‡ºæœ‰ä¸€ä¸ª 1 åˆ° 1 çš„åŒ¹é…ã€‚\nimport fs &#x3D; require(&quot;fs&quot;);\nconst code &#x3D; fs.readFileSync(&quot;hello.ts&quot;, &quot;utf8&quot;);\n\nYou can learn more about this syntax in the modules reference page.ä½ å¯ä»¥åœ¨æ¨¡å—å‚è€ƒé¡µé¢äº†è§£æ›´å¤šå…³äºè¿™ç§è¯­æ³•ã€‚\nCommonJS SyntaxCommonJS è¯­æ³•\nCommonJS is the format which most modules on npm are delivered in. Even if you are writing using the ES Modules syntax above, having a brief understanding of how CommonJS syntax works will help you debug easier.CommonJS æ˜¯ npm ä¸Šå¤§å¤šæ•°æ¨¡å—çš„æ ¼å¼ã€‚å³ä½¿ä½ æ­£åœ¨ä½¿ç”¨ä¸Šé¢çš„ ES æ¨¡å—è¯­æ³•ï¼Œä¹Ÿä¼šæœ‰ä¸€ä¸ªç®€å•çš„äº†è§£ CommonJS è¯­æ³•çš„æ–¹å¼å¸®åŠ©ä½ è°ƒè¯•æ›´å®¹æ˜“ã€‚\nExportingå¯¼å‡º\nIdentifiers are exported via setting the exports property on a global called module.æ ‡è¯†ç¬¦é€šè¿‡è®¾ç½® module.exports å±æ€§æ¥å¯¼å‡ºã€‚\nfunction absolute(num: number) &#123;\n    if (num &lt; 0) return num \\* -1;\n    return num;\n&#125;\n\nmodule.exports &#x3D; &#123;\n  pi: 3.14,\n  squareTwo: 1.41,\n  phi: 1.61,\n  absolute,\n&#125;;\n\nThen these files can be imported via a require statement:ç„¶åï¼Œè¿™äº›æ–‡ä»¶å¯ä»¥é€šè¿‡ require è¯­å¥æ¥å¯¼å…¥ï¼š\nconst maths &#x3D; require(&quot;maths&quot;);\nmaths.pi;\n\n&#x2F;&#x2F; any;\n\nOr you can simplify a bit using the destructuring feature in JavaScript:æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ JavaScript çš„è§£æ„ç‰¹æ€§æ¥ç®€åŒ–ä¸€äº›ï¼š\nconst &#123; squareTwo &#125; &#x3D; require(&quot;maths&quot;);\nsquareTwo;\n\n&#x2F;&#x2F; const squareTwo: any;\n\nCommonJS and ES Modules interopCommonJS å’Œ ES æ¨¡å—çš„äº’æ“ä½œ\nThere is a mis-match in features between CommonJS and ES Modules regarding the distinction between a default import and a module namespace object import. TypeScript has a compiler flag to reduce the friction between the two different sets of constraints with esModuleInterop.åœ¨ CommonJS å’Œ ES æ¨¡å—ä¹‹é—´å­˜åœ¨ä¸åŒ¹é…çš„ç‰¹æ€§ï¼Œå…³äºé»˜è®¤å¯¼å…¥å’Œæ¨¡å—å‘½åç©ºé—´å¯¹è±¡å¯¼å…¥çš„åŒºåˆ«ã€‚TypeScript æœ‰ä¸€ä¸ªç¼–è¯‘å™¨æ ‡å¿—æ¥å‡å°‘ CommonJS å’Œ ES æ¨¡å—ä¹‹é—´çš„æ‘©æ“¦ã€‚\nTypeScriptâ€™s Module Resolution OptionsTypeScript çš„æ¨¡å—è§£æé€‰é¡¹\nModule resolution is the process of taking a string from the import or require statement, and determining what file that string refers to.æ¨¡å—è§£ææ˜¯ä» import æˆ– require è¯­å¥ä¸­è·å–å­—ç¬¦ä¸²ï¼Œå¹¶ç¡®å®šè¯¥å­—ç¬¦ä¸²æ‰€å¼•ç”¨çš„æ–‡ä»¶ã€‚\nTypeScript includes two resolution strategies: Classic and Node. Classic, the default when the compiler option module is not commonjs, is included for backwards compatibility. The Node strategy replicates how Node.js works in CommonJS mode, with additional checks for .ts and .d.ts.TypeScript åŒ…å«ä¸¤ç§è§£æç­–ç•¥ï¼šç»å…¸å’Œ Nodeã€‚ç»å…¸ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç¼–è¯‘å™¨é€‰é¡¹ module ä¸æ˜¯ commonjs æ—¶ï¼ŒåŒ…å«äº†å‘åå…¼å®¹æ€§ã€‚Node ç­–ç•¥é‡å¤äº† Node.js åœ¨ CommonJS æ¨¡å¼ä¸‹å·¥ä½œçš„æ–¹å¼ï¼Œå¹¶ä¸”æ·»åŠ äº† .ts å’Œ .d.ts çš„æ£€æŸ¥ã€‚There are many TSConfig flags which influence the module strategy within TypeScript: moduleResolution, baseUrl, paths, rootDirs.åœ¨ TypeScript ä¸­ï¼Œæœ‰å¾ˆå¤š TSConfig æ ‡å¿—å½±å“æ¨¡å—ç­–ç•¥ï¼šmoduleResolutionã€baseUrlã€pathsã€rootDirsã€‚For the full details on how these strategies work, you can consult the Module Resolution.å…³äºå¦‚ä½•å·¥ä½œçš„è¯¦ç»†ä¿¡æ¯ï¼Œä½ å¯ä»¥å‚è€ƒæ¨¡å—è§£æã€‚\nTypeScriptâ€™s Module Output OptionsTypeScript çš„æ¨¡å—è¾“å‡ºé€‰é¡¹There are two options which affect the emitted JavaScript output:æœ‰ä¸¤ä¸ªå½±å“è¾“å‡ºçš„ JavaScript çš„é€‰é¡¹ï¼š\n\ntarget which determines which JS features are downleveled (converted to run in older JavaScript runtimes) and which are left intacttarget æ˜¯æŒ‡å®šå“ªäº› JS ç‰¹æ€§è¢«ä¸‹æ¸¸ï¼ˆè½¬æ¢ä¸ºåœ¨æ—§çš„ JavaScript è¿è¡Œæ—¶è¿è¡Œï¼‰ï¼Œå“ªäº›è¢«ä¿ç•™ã€‚\nmodule which determines what code is used for modules to interact with each othermodule æ˜¯æŒ‡å®šå“ªäº›ä»£ç ç”¨äºæ¨¡å—äº¤äº’ã€‚\n\nWhich target you use is determined by the features available in the JavaScript runtime you expect to run the TypeScript code in. That could be: the oldest web browser you support, the lowest version of Node.js you expect to run on or could come from unique constraints from your runtime - like Electron for example.å“ªä¸ªç›®æ ‡ä½ ä½¿ç”¨æ˜¯ç”±ä½ æœŸæœ›åœ¨ JavaScript è¿è¡Œæ—¶è¿è¡Œ TypeScript ä»£ç çš„åŠŸèƒ½å†³å®šçš„ã€‚è¿™å¯èƒ½æ˜¯ï¼šæœ€æ—§çš„ web æµè§ˆå™¨ï¼Œæœ€ä½ç‰ˆæœ¬çš„ Node.jsï¼Œæˆ–è€…æ¥è‡ªä½ è¿è¡Œæ—¶çš„å”¯ä¸€çº¦æŸ - ä¾‹å¦‚ï¼ŒElectronã€‚All communication between modules happens via a module loader, the compiler option module determines which one is used. At runtime the module loader is responsible for locating and executing all dependencies of a module before executing it.æ¨¡å—ä¹‹é—´çš„é€šä¿¡éƒ½æ˜¯é€šè¿‡æ¨¡å—åŠ è½½å™¨æ¥å®Œæˆçš„ï¼Œç¼–è¯‘å™¨é€‰é¡¹ module æ˜¯æŒ‡å®šå“ªä¸ªè¢«ä½¿ç”¨ã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ¨¡å—åŠ è½½å™¨è´Ÿè´£å®šä½å¹¶æ‰§è¡Œæ‰€æœ‰æ¨¡å—çš„ä¾èµ–ä¹‹å‰æ‰§è¡Œå®ƒã€‚For example, here is a TypeScript file using ES Modules syntax, showcasing a few different options for module:ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨ ES Modules è¯­æ³•çš„ TypeScript æ–‡ä»¶ï¼Œå±•ç¤ºäº†ä¸€äº›æ¨¡å—çš„é€‰é¡¹ï¼š\nimport &#123; valueOfPi &#125; from &quot;.&#x2F;constants.js&quot;;\n\nexport const twoPi &#x3D; valueOfPi _ 2;\n\nES2020import &#123; valueOfPi &#125; from &quot;.&#x2F;constants.js&quot;;\nexport const twoPi &#x3D; valueOfPi _ 2;\n\nCommonJS&quot;use strict&quot;;\nObject.defineProperty(exports, &quot;\\_\\_esModule&quot;, &#123; value: true &#125;);\nexports.twoPi &#x3D; void 0;\nconst constants_js_1 &#x3D; require(&quot;.&#x2F;constants.js&quot;);\nexports.twoPi &#x3D; constants_js_1.valueOfPi \\* 2;\n\nUMD(function (factory) &#123;\n  if (typeof module &#x3D;&#x3D;&#x3D; &quot;object&quot; &amp;&amp; typeof module.exports &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;\n    var v &#x3D; factory(require, exports);\n    if (v !&#x3D;&#x3D; undefined) module.exports &#x3D; v;\n  &#125;\n  else if (typeof define &#x3D;&#x3D;&#x3D; &quot;function&quot; &amp;&amp; define.amd) &#123;\n    define([&quot;require&quot;, &quot;exports&quot;, &quot;.&#x2F;constants.js&quot;], factory);\n  &#125;\n&#125;)(function (require, exports) &#123;\n  &quot;use strict&quot;;\n  Object.defineProperty(exports, &quot;\\_\\_esModule&quot;, &#123; value: true &#125;);\n  exports.twoPi &#x3D; void 0;\n  const constants_js_1 &#x3D; require(&quot;.&#x2F;constants.js&quot;);\n  exports.twoPi &#x3D; constants_js_1.valueOfPi \\* 2;\n&#125;);\n\n\nNote that ES2020 is effectively the same as the original index.ts.ES2020 æ˜¯ä¸€æ ·çš„äºåŸå§‹ index.tsã€‚You can see all of the available options and what their emitted JavaScript code looks like in the TSConfig Reference for module.ä½ å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯ç”¨çš„é€‰é¡¹å’Œä»–ä»¬çš„è¾“å‡º JavaScript ä»£ç çš„æ ·å­åœ¨ module çš„ TSConfig å‚è€ƒä¸­ã€‚\nTypeScript namespacesTypeScript å‘½åç©ºé—´TypeScript has its own module format called namespaces which pre-dates the ES Modules standard. This syntax has a lot of useful features for creating complex definition files, and still sees active use in DefinitelyTyped. While not deprecated, the majority of the features in namespaces exist in ES Modules and we recommend you use that to align with JavaScriptâ€™s direction. You can learn more about namespaces in the namespaces reference page.TypeScript æœ‰è‡ªå·±çš„æ¨¡å—æ ¼å¼å‘½åç©ºé—´ï¼Œå®ƒæ˜¯å…ˆæœŸçš„ ES Modules æ ‡å‡†ã€‚è¿™ç§è¯­æ³•å…·æœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½åˆ›å»ºå¤æ‚çš„å®šä¹‰æ–‡ä»¶ï¼Œä»ç„¶åœ¨ DefinitelyTyped ä¸­æœ‰æ´»è·ƒä½¿ç”¨ã€‚å°½ç®¡ä¸è¢«å¼ƒç”¨ï¼Œå¤§å¤šæ•°çš„åŠŸèƒ½åœ¨å‘½åç©ºé—´ä¸­å­˜åœ¨äº ES Modulesï¼Œæˆ‘ä»¬å»ºè®®ä½ ä½¿ç”¨å®ƒä¸ JavaScript çš„æ–¹å‘å¯¹é½ã€‚ä½ å¯ä»¥åœ¨å‘½åç©ºé—´å‚è€ƒé¡µé¢ä¸Šäº†è§£æ›´å¤šå…³äºå‘½åç©ºé—´ã€‚\n","slug":"2022-06-08ts-modules","date":"2022-06-08T14:47:47.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"14464d0b7865c234ecdc15847ed605ff","title":"8.Typescriptæ‰‹å†Œ ç±»","content":"","slug":"2022-06-08ts-classes","date":"2022-06-08T06:21:19.000Z","categories_index":"","tags_index":"","author_index":"é™ˆæµ·é¾™"},{"id":"62218ddca7698d868da0d101af067d2c","title":"7.Typescriptæ‰‹å†Œ ç±»å‹æ“ä½œ","content":"ts ç±»å‹å¦‚ä½•è°ƒè¯•\nä¸æ˜¯ä»£ç é€»è¾‘å¦‚ä½•è°ƒè¯•ï¼Œæ²¡æƒ³åˆ°\n\nts è‡ªå®šä¹‰ç±»å‹å¦‚ä½•æ‰“å°\nä¸æ˜¯ js çš„ç»“æœå¦‚ä½•æ‰“å°ï¼Œæ²¡æƒ³åˆ°\n\nCreating Types from Typesä»å·²æœ‰ç±»å‹ä¸­åˆ›å»ºç±»å‹\nTypeScript çš„ç±»å‹ç³»ç»Ÿéå¸¸å¼ºå¤§ï¼Œå› ä¸ºå®ƒå…è®¸è¡¨è¾¾ç±»å‹çš„å¦ä¸€ç§è¡¨è¾¾æ–¹å¼ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯æ³›å‹ï¼Œæˆ‘ä»¬å®é™…ä¸Šæœ‰ä¸€å¤§å †çš„ç±»å‹æ“ä½œç¬¦å¯ç”¨ã€‚è¿˜å¯ä»¥è¡¨è¾¾ç±»å‹çš„å¦ä¸€ç§è¡¨è¾¾æ–¹å¼ï¼Œå°±æ˜¯æŠŠå·²æœ‰çš„å€¼ä½œä¸ºç±»å‹ã€‚é€šè¿‡åˆå¹¶å¤šç§ç±»å‹æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥è¡¨è¾¾å¤æ‚çš„æ“ä½œå’Œå€¼ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ä»‹ç»ä»¥å¦ä¸€ä¸ªç±»å‹æˆ–å€¼ä¸ºåŸºç¡€å¦‚ä½•è¡¨è¾¾ä¸€ä¸ªæ–°ç±»å‹ã€‚\nç®€å•æ¥è¯´ï¼šä½¿ç”¨ èŒƒå‹ æˆ– 6ç§è¡¨è¾¾å¼ æ¥åˆ›å»ºæ–°ç±»å‹\n\nèŒƒå‹ - ç±»å‹éœ€è¦å‚æ•°\n\nKeyof Type Operator - ç”¨ keyof æ“ä½œå»åˆ›å»ºæ–°ç±»å‹\n\nTypeof Type Operator - ç”¨ typeof æ“ä½œå»åˆ›å»ºæ–°ç±»å‹\n\nIndexed Access Types - ä½¿ç”¨ Type[â€˜aâ€™]è¯­æ³•å»è®¿é—®ä¸€ä¸ªç±»å‹çš„ä¸€éƒ¨åˆ†\n\nConditional Types - ç±»å‹è¡Œä¸ºåƒ if è¯­å¥ä¸€æ ·\n\nMapped Types - é€šè¿‡æ˜ å°„å·²æœ‰ç±»å‹çš„æ¯ä¸ªå±æ€§æ¥åˆ›å»ºæ–°ç±»å‹\n\nTemplate Literal Types - é€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²æ¥æ”¹å˜å±æ€§çš„æ˜ å°„ç±»å‹\n\n\nKeyof Type Operator\nè¿™ä¸ªæ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰ keyï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°å­—çš„è”åˆç±»å‹ï¼Œæ¥ä¸‹æ¥çš„ç±»å‹ P æ˜¯è¿™ä¸ªç±»å‹çš„ç±»å‹ï¼š\n\ntype P1 &#x3D; keyof any; &#x2F;&#x2F; æç¤ºï¼štype P1 &#x3D; string | number | symbol\n\ntype Point &#x3D; &#123; x: number; y: number &#125;;\ntype P &#x3D; keyof Point; &#x2F;&#x2F; æç¤ºï¼štype P &#x3D; keyof Pointï¼Œè¿™ä¸ªæç¤ºç­‰äºæ²¡æç¤º\n\n\nå¦‚æœè¿™ä¸ªç±»å‹æœ‰å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ç´¢å¼•ï¼Œkeyof å°±ä¼šè¿”å›è¿™ä¸ªç±»å‹ï¼š\n\ntype Arrayish &#x3D; &#123; [n: number]: unknown &#125;;\ntype A &#x3D; keyof Arrayish; &#x2F;&#x2F;æç¤ºï¼štype A &#x3D; number\n\ntype Mapish &#x3D; &#123; [k: string]: boolean &#125;;\ntype M &#x3D; keyof Mapish; &#x2F;&#x2F; æç¤ºï¼štype M &#x3D; string | number\n\n&#x2F;&#x2F; --------------------------------------------------------------\n&#x2F;&#x2F; å¯¹äºArrayish\n\n&#x2F;&#x2F; å®ä¾‹1:ok\nvar a: Arrayish &#x3D; &#123;\n  1: &quot;string&quot;,\n  2: false,\n&#125;;\n&#x2F;&#x2F; å®ä¾‹2: ok\nvar a1: Arrayish &#x3D; [1, 2, 3, 4];\n\n&#x2F;&#x2F; å¯¹äº Mapish\nvar b: Mapish &#x3D; &#123;\n  name: true,\n  age: false,\n&#125;;\n\næ³¨æ„ï¼Œè¿™ä¸ªä¾‹å­ä¸­ï¼ŒM æ˜¯ string | number â€” è¿™æ˜¯å› ä¸º JavaScript å¯¹è±¡é”®æ˜¯æ€»æ˜¯è¢«å¼ºåˆ¶ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ obj[0] æ€»æ˜¯å’Œ obj[â€œ0â€] ç›¸åŒã€‚\nkeyof ç±»å‹æ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰ keyï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°å­—çš„è”åˆç±»å‹ï¼Œæ¥ä¸‹æ¥çš„ç±»å‹ P æ˜¯è¿™ä¸ªç±»å‹çš„ç±»å‹ï¼š\nTypeof type operatorJavaScript ä¹Ÿæœ‰ä¸€ä¸ª typeof æ“ä½œç¬¦ï¼Œå¯ä»¥ç”¨åœ¨è¡¨è¾¾å¼ä¸­ï¼š\n&#x2F;&#x2F; Prints &quot;string&quot;\nconsole.log(typeof &quot;Hello world&quot;);\n\nTypeScript å¢åŠ äº†ä¸€ä¸ª typeof æ“ä½œç¬¦ï¼Œå¯ä»¥ç”¨åœ¨ç±»å‹ä¸Šï¼š\nlet s &#x3D; &quot;hello&quot;;\nlet n: typeof s; &#x2F;&#x2F; æç¤ºï¼šlet n: string\n\nReturnTypeå¯¹äºåŸºæœ¬ç±»å‹ï¼Œtypeof æ“ä½œç¬¦æ²¡æœ‰æ„ä¹‰ï¼Œä½†æ˜¯ä¸å…¶ä»–ç±»å‹æ“ä½œç¬¦ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥ç”¨ typeof æ“ä½œç¬¦æ¥å®ç°ä¸€äº›æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¼€å§‹ç”¨ ReturnType æ¥è¡¨ç¤ºå‡½æ•°çš„è¿”å›ç±»å‹ï¼š\ntype Predicate &#x3D; (x: unknown) &#x3D;&gt; boolean;\ntype K &#x3D; ReturnType&lt;Predicate&gt;; &#x2F;&#x2F; æç¤º type K &#x3D; boolean\n\nå¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨ ReturnType åœ¨å‡½æ•°åä¸Šï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªæŒ‡ç¤ºæ€§çš„é”™è¯¯ï¼š\nfunction f() &#123;\n  return &#123; x: 10, y: 3 &#125;;\n&#125;\ntype P &#x3D; ReturnType&lt;f&gt;;\n&#x2F;&#x2F; æç¤ºï¼š&#39;f&#39; refers to a value, but is being used as a type here. Did you mean &#39;typeof f&#39;?\n&#x2F;&#x2F; æç¤ºï¼š&#39;f&#39; æ¶‰åŠåˆ°ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯åœ¨è¿™é‡Œè¢«ä½¿ç”¨ä½œä¸ºç±»å‹ã€‚ä½ æ˜¯å¦æƒ³ä½¿ç”¨ &#39;typeof f&#39; æ¥ä»£æ›¿ &#39;f&#39;ï¼Ÿ\n\nè®°ä½ï¼Œå€¼å’Œç±»å‹ä¸æ˜¯ä¸€å›äº‹ã€‚è¦å¼•ç”¨å€¼ f æ‰€æ‹¥æœ‰çš„ç±»å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ typeofï¼š\nfunction f() &#123;\n  return &#123; x: 10, y: 3 &#125;;\n&#125;\ntype P &#x3D; ReturnType&lt;typeof f&gt;;\n\n&#x2F;**\n * æç¤º\n * type P &#x3D; &#123;\n    x: number;\n    y: number;\n&#125;\n**&#x2F;\n\né™åˆ¶\ntypescript é€šå¸¸é™åˆ¶äº† typeof çš„è¡¨è¾¾å¼çš„ç±»å‹ã€‚ç‰¹æ®Šçš„ï¼Œtypeof çš„è¡¨è¾¾å¼åªèƒ½ç”¨äºæ ‡è¯†ç¬¦ï¼ˆå³å˜é‡åï¼‰å…¶å±æ€§ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ä¸ºäº†é¿å…å†™ä¸€äº›ä½ è®¤ä¸ºæ˜¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†å®é™…ä¸Šå¹¶ä¸æ˜¯çš„ï¼š\n&#x2F;&#x2F; Meant to use &#x3D; ReturnType&lt;typeof msgbox&gt;\nlet shouldContinue: typeof msgbox(&quot;Are you sure you want to continue?&quot;);\n&#x2F;&#x2F; &#39;,&#39; expected.\n\nIndexed Access Typesæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®ç±»å‹æ¥æŸ¥æ‰¾ä¸€ä¸ªç±»å‹çš„ç‰¹å®šå±æ€§ï¼š\ntype Person &#x3D; &#123; age: number; name: string; alive: boolean &#125;;\ntype Age &#x3D; Person[&quot;age&quot;]; &#x2F;&#x2F; æç¤ºï¼štype Age &#x3D; number\n\nè¿™ä¸ªç´¢å¼•ç±»å‹æœ¬èº«æ˜¯ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è”åˆï¼Œkeyof æˆ–è€…å…¶ä»–ç±»å‹ï¼š\ntype I1 &#x3D; Person[&quot;age&quot; | &quot;name&quot;]; &#x2F;&#x2F; æç¤ºï¼štype I1 &#x3D; string | number\n\ntype I2 &#x3D; Person[keyof Person]; &#x2F;&#x2F; æç¤ºï¼štype I2 &#x3D; string | number | boolean\n\ntype AliveOrName &#x3D; &quot;alive&quot; | &quot;name&quot;;\ntype I3 &#x3D; Person[AliveOrName]; &#x2F;&#x2F; æç¤ºï¼štype I3 &#x3D; string | boolean\n\nä½ ä¼šçœ‹åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå¦‚æœä½ å°è¯•ç´¢å¼•ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§ï¼š\ntype I1 &#x3D; Person[&quot;alve&quot;];\nProperty &#39;alve&#39; does not exist on type &#39;Person&#39;.\n\nå¦ä¸€ä¸ªä¾‹å­æ˜¯ä½¿ç”¨ number æ¥è·å–æ•°ç»„çš„å…ƒç´ ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ typeof æ¥æ–¹ä¾¿åœ°æ•è·æ•°ç»„å­—é¢é‡çš„å…ƒç´ ç±»å‹ã€‚\nconst MyArray &#x3D; [\n  &#123; name: &quot;Alice&quot;, age: 15 &#125;,\n  &#123; name: &quot;Bob&quot;, age: 23 &#125;,\n  &#123; name: &quot;Eve&quot;, age: 38 &#125;,\n];\n\ntype Person &#x3D; typeof MyArray[number];\n\n&#x2F;&#x2F; æç¤ºï¼štype Person &#x3D; &#123; name: string; age: number; &#125;\n\ntype Age &#x3D; typeof MyArray[number][&quot;age&quot;]; &#x2F;&#x2F; æç¤º type Age &#x3D; number;\n&#x2F;&#x2F; Or\ntype Age2 &#x3D; Person[&quot;age&quot;]; &#x2F;&#x2F; æç¤º type Age2 &#x3D; number;\n\nä½ åªèƒ½ä½¿ç”¨ç±»å‹æ¥ç´¢å¼•ï¼Œæ„å‘³ç€ä½ ä¸èƒ½ä½¿ç”¨ const æ¥åˆ›å»ºä¸€ä¸ªå˜é‡å¼•ç”¨ï¼š\nconst key &#x3D; &quot;age&quot;;\ntype Age &#x3D; Person[key];\n&#x2F;&#x2F; Type &#39;key&#39; cannot be used as an index type.\n&#x2F;&#x2F; è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸º key æ˜¯ä¸€ä¸ªå­—é¢é‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå˜é‡ã€‚\n&#x2F;&#x2F; &#39;key&#39; refers to a value, but is being used as a type here. Did you mean &#39;typeof key&#39;?\n&#x2F;&#x2F; è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸º key æ¶‰åŠåˆ°ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯åœ¨è¿™é‡Œè¢«ä½¿ç”¨ä½œä¸ºç±»å‹ã€‚ä½ æ˜¯å¦æƒ³ä½¿ç”¨ &#39;typeof key&#39; æ¥ä»£æ›¿ &#39;key&#39;ï¼Ÿ\n\nç„¶è€Œï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç±»å‹åˆ«åæ¥æ›¿æ¢ç›¸åŒçš„é£æ ¼çš„é‡æ„ï¼š\ntype key &#x3D; &quot;age&quot;;\ntype Age &#x3D; Person[key];\n\nConditional TypesAt the heart of most useful programs, we have to make decisions based on input. JavaScript programs are no different, but given the fact that values can be easily introspected, those decisions are also based on the types of the inputs. Conditional types help describe the relation between the types of inputs and outputs.åœ¨æœ€å¸¸è§çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¾“å…¥æ¥åšå†³ç­–ã€‚ JavaScript ç¨‹åºæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ç»™å®šäº†è¿™ä¸ªäº‹å®ï¼Œé‚£äº›å†³ç­–æ˜¯æ ¹æ®è¾“å…¥çš„ç±»å‹æ¥åšçš„ã€‚æ¡ä»¶ç±»å‹å¸®åŠ©æè¿°è¾“å…¥å’Œè¾“å‡ºç±»å‹ä¹‹é—´çš„å…³ç³»ã€‚\ninterface Animal &#123;\n  live(): void;\n&#125;\ninterface Dog extends Animal &#123;\n  woof(): void;\n&#125;\n\ntype Example1 &#x3D; Dog extends Animal ? number : string; &#x2F;&#x2F; æç¤ºï¼štype Example1 &#x3D; number\n\ntype Example2 &#x3D; RegExp extends Animal ? number : string; &#x2F;&#x2F; æç¤ºï¼štype Example2 &#x3D; string\n\næ¡ä»¶ç±»å‹çš„è¡¨è¾¾å¼åƒ JavaScript ä¸­çš„æ¡ä»¶è¡¨è¾¾å¼ä¸€æ ·ï¼š\nSomeType extends OtherType ? TrueType : FalseType;\n\næ­¤æ®µå†…å®¹ï¼ŒåŸæ–‡ä¿ç•™When the type on the left of the extends is assignable to the one on the right, then youâ€™ll get the type in the first branch (the â€œtrueâ€ branch); otherwise youâ€™ll get the type in the latter branch (the â€œfalseâ€ branch).\nå½“ extends å·¦è¾¹çš„ç±»å‹å¯ä»¥èµ‹å€¼ç»™å³è¾¹çš„ç±»å‹æ—¶ï¼Œä½ ä¼šå¾—åˆ°ç¬¬ä¸€ä¸ªåˆ†æ”¯çš„ç±»å‹ï¼ˆâ€œtrueâ€åˆ†æ”¯ï¼‰ï¼›å¦åˆ™ä½ ä¼šå¾—åˆ°ç¬¬äºŒä¸ªåˆ†æ”¯çš„ç±»å‹ï¼ˆâ€œfalseâ€åˆ†æ”¯ï¼‰ã€‚\nFrom the examples above, conditional types might not immediately seem useful - we can tell ourselves whether or not Dog extends Animal and pick number or string! But the power of conditional types comes from using them with generics.ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°æ¡ä»¶ç±»å‹å¯èƒ½ä¸ä¼šç«‹å³çœ‹èµ·æ¥å¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘Šè¯‰è‡ªå·± Dog æ˜¯å¦ç»§æ‰¿äº† Animalï¼Œç„¶åé€‰æ‹© number æˆ– stringï¼ä½†æ˜¯æ¡ä»¶ç±»å‹çš„åŠ›é‡æ¥è‡ªäºä½¿ç”¨å®ƒä»¬ä¸æ³›å‹ã€‚\nFor example, letâ€™s take the following createLabel function:ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸‹é¢çš„ createLabel å‡½æ•°æ‹¿æ¥è¯´è¯´ï¼š\ninterface IdLabel &#123;\n  id: number &#x2F;* some fields *&#x2F;;\n&#125;\ninterface NameLabel &#123;\n  name: string &#x2F;* other fields *&#x2F;;\n&#125;\n\nfunction createLabel(id: number): IdLabel;\nfunction createLabel(name: string): NameLabel;\nfunction createLabel(nameOrId: string | number): IdLabel | NameLabel;\nfunction createLabel(nameOrId: string | number): IdLabel | NameLabel &#123;\n  throw &quot;unimplemented&quot;;\n&#125;\n\nThese overloads for createLabel describe a single JavaScript function that makes a choice based on the types of its inputs. Note a few things:è¿™äº› createLabel çš„é‡è½½æè¿°äº†ä¸€ä¸ªå•ä¸€çš„ JavaScript å‡½æ•°ï¼Œå®ƒæ ¹æ®è¾“å…¥çš„ç±»å‹æ¥åšå†³ç­–ã€‚è¯·æ³¨æ„ä¸€äº›äº‹æƒ…ï¼š\nIf a library has to make the same sort of choice over and over throughout its API, this becomes cumbersome.We have to create three overloads: one for each case when weâ€™re sure of the type (one for string and one for number), and one for the most general case (taking a string | number). For every new type createLabel can handle, the number of overloads grows exponentially.å¦‚æœä¸€ä¸ªåº“éœ€è¦åœ¨å…¶ API ä¸­é‡å¤ä½¿ç”¨ç›¸åŒçš„é€‰æ‹©ï¼Œè¿™å°±å˜å¾—éå¸¸éº»çƒ¦ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸‰ä¸ªé‡è½½ï¼šä¸€ä¸ªå½“æˆ‘ä»¬çŸ¥é“ç±»å‹æ—¶ï¼Œä¸€ä¸ªå½“æˆ‘ä»¬çŸ¥é“ç±»å‹æ—¶ï¼Œä¸€ä¸ªå½“æˆ‘ä»¬ä¸çŸ¥é“ç±»å‹æ—¶ã€‚å¯¹äºæ¯ä¸ªæ–°çš„ç±»å‹ createLabel å¯ä»¥å¤„ç†ï¼Œé‡è½½çš„æ•°é‡å°±ä¼šæŒ‡æ•°å¢é•¿ã€‚Instead, we can encode that logic in a conditional type:åä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡ä»¶ç±»å‹æ¥è¡¨ç¤ºé€»è¾‘ï¼š\ntype NameOrId&lt;T extends number | string&gt; &#x3D; T extends number\n  ? IdLabel\n  : NameLabel;\n\nWe can then use that conditional type to simplify our overloads down to a single function with no overloads.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¡ä»¶ç±»å‹æ¥ç®€åŒ–æˆ‘ä»¬çš„é‡è½½ï¼Œåªæœ‰ä¸€ä¸ªå‡½æ•°ã€‚\nfunction createLabel&lt;T extends number | string&gt;(idOrName: T): NameOrId&lt;T&gt; &#123;\n  throw &quot;unimplemented&quot;;\n&#125;\n\nlet a &#x3D; createLabel(&quot;typescript&quot;);\n\n&#x2F;&#x2F; æç¤ºï¼šlet a: NameLabel;\n\nlet b &#x3D; createLabel(2.8);\n\n&#x2F;&#x2F; æç¤ºï¼šlet b: IdLabel;\n\nlet c &#x3D; createLabel(Math.random() ? &quot;hello&quot; : 42);\n&#x2F;&#x2F; æç¤ºï¼šlet c: NameLabel | IdLabel;\n\n\nConditional Type Constraints\n\næ¡ä»¶ç±»å‹çº¦æŸ\nOften, the checks in a conditional type will provide us with some new information. Just like with narrowing with type guards can give us a more specific type, the true branch of a conditional type will further constrain generics by the type we check against.é€šå¸¸ï¼Œåœ¨æ¡ä»¶ç±»å‹ä¸­çš„æ£€æŸ¥ä¼šæä¾›æˆ‘ä»¬ä¸€äº›æ–°çš„ä¿¡æ¯ã€‚åƒç±»å‹æ£€æŸ¥ä¸€æ ·ï¼Œé€šè¿‡ç±»å‹çº¦æŸå¯ä»¥ç»™æˆ‘ä»¬æ›´å…·ä½“çš„ç±»å‹ï¼Œæ¡ä»¶ç±»å‹çš„ true åˆ†æ”¯å°†é€šè¿‡æˆ‘ä»¬æ£€æŸ¥çš„ç±»å‹æ¥çº¦æŸæ³›å‹ã€‚For example, letâ€™s take the following:ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸‹é¢çš„å‡½æ•°æ‹¿æ¥è¯´è¯´ï¼š\ntype MessageOf&lt;T&gt; &#x3D; T[&quot;message&quot;];\n&#x2F;&#x2F; Type &#39;&quot;message&quot;&#39; cannot be used to index type &#39;T&#39;.\n\nIn this example, TypeScript errors because T isnâ€™t known to have a property called message. We could constrain T, and TypeScript would no longer complain:\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒTypeScript é”™è¯¯ï¼Œå› ä¸º T æ²¡æœ‰ä¸€ä¸ªå±æ€§å« messageã€‚æˆ‘ä»¬å¯ä»¥çº¦æŸ Tï¼ŒTypeScript ä¸ä¼šå†æŠ¥é”™äº†ï¼š\ntype MessageOf&lt;T extends &#123; message: unknown &#125;&gt; &#x3D; T[&quot;message&quot;];\n\ninterface Email &#123;\n  message: string;\n&#125;\n\ntype EmailMessageContents &#x3D; MessageOf&lt;Email&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼štype EmailMessageContents &#x3D; string\n\nHowever, what if we wanted MessageOf to take any type, and default to something like never if a message property isnâ€™t available? We can do this by moving the constraint out and introducing a conditional type:ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ MessageOf å–ä»»æ„ç±»å‹ï¼Œå¹¶ä¸”é»˜è®¤ä¸ºæ²¡æœ‰ message å±æ€§çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š\ntype MessageOf&lt;T&gt; &#x3D; T extends &#123; message: unknown &#125; ? T[&quot;message&quot;] : never;\n\ninterface Email &#123;\n  message: string;\n&#125;\n\ninterface Dog &#123;\n  bark(): void;\n&#125;\n\ntype EmailMessageContents &#x3D; MessageOf&lt;Email&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼štype EmailMessageContents &#x3D; string;\n\ntype DogMessageContents &#x3D; MessageOf&lt;Dog&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼štype DogMessageContents &#x3D; never;\n\nWithin the true branch, TypeScript knows that T will have a message property.åœ¨ true åˆ†æ”¯ä¸­ï¼ŒTypeScript çŸ¥é“ T æœ‰ä¸€ä¸ª message å±æ€§ã€‚\nAs another example, we could also write a type called Flatten that flattens array types to their element types, but leaves them alone otherwise:ä½œä¸ºå¦ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç¼–å†™ä¸€ä¸ªåä¸º Flatten çš„ç±»å‹ï¼Œè¯¥ç±»å‹å°†æ•°ç»„ç±»å‹å±•å¹³ä¸ºå…¶å…ƒç´ ç±»å‹ï¼Œä½†åœ¨å…¶ä»–æƒ…å†µä¸‹ä¸ä½¿ç”¨å®ƒä»¬ï¼š\ntype Flatten&lt;T&gt; &#x3D; T extends any[] ? T[number] : T;\n\n&#x2F;&#x2F; Extracts out the element type. æå–å…ƒç´ ç±»å‹ã€‚\ntype Str &#x3D; Flatten&lt;string[]&gt;;\n\ntype Str &#x3D; string;\n\n&#x2F;&#x2F; Leaves the type alone. ä¿ç•™è¯¥ç±»å‹ã€‚\ntype Num &#x3D; Flatten&lt;number&gt;;\n\ntype Num &#x3D; number;\n\nWhen Flatten is given an array type, it uses an indexed access with number to fetch out string[]â€™s element type. Otherwise, it just returns the type it was given.å½“ Flatten ç»™å®šä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œå®ƒä½¿ç”¨ number ä¸‹æ ‡å¾—åˆ° string[]å…ƒç´ ç±»å‹ï¼Œå¦åˆ™ï¼Œä»…è¿”å›æ‰€ç»™ç±»å‹\nInferring Within Conditional Typesåœ¨æ¡ä»¶ç±»å‹å†…æ¨æ–­\nWe just found ourselves using conditional types to apply constraints and then extract out types. This ends up being such a common operation that conditional types make it easier.\næˆ‘ä»¬åªæ˜¯å‘ç°è‡ªå·±ä½¿ç”¨æ¡ä»¶ç±»å‹æ¥åº”ç”¨çº¦æŸï¼Œç„¶åæå–å‡ºç±»å‹ã€‚è¿™æœ€ç»ˆæ˜¯ä¸€ç§å¸¸è§çš„æ“ä½œï¼Œæ¡ä»¶ç±»å‹ä½¿å…¶æ›´å®¹æ˜“å®ç°ã€‚\nConditional types provide us with a way to infer from types we compare against in the true branch using the infer keyword. For example, we could have inferred the element type in Flatten instead of fetching it out â€œmanuallyâ€ with an indexed access type:\næ¡ä»¶ç±»å‹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä½¿ç”¨ infer å…³é”®å­—ä» true åˆ†æ”¯ä¸­æ¯”è¾ƒçš„ç±»å‹æ¨æ–­çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Flatten ä¸­æ¨æ–­å…ƒç´ ç±»å‹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç´¢å¼•è®¿é—®ç±»å‹â€œæ‰‹åŠ¨â€æå–å®ƒï¼š\ntype Flatten&lt;Type&gt; &#x3D; Type extends Array&lt;infer Item&gt; ? Item : Type;\n\nHere, we used the infer keyword to declaratively introduce a new generic type variable named Item instead of specifying how to retrieve the element type of T within the true branch. This frees us from having to think about how to dig through and probing apart the structure of the types weâ€™re interested in.\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ infer å…³é”®å­—å£°æ˜æ€§åœ°å¼•å…¥ä¸€ä¸ªåä¸º Item çš„æ–°æ³›å‹ç±»å‹å˜é‡ï¼Œè€Œä¸æ˜¯æŒ‡å®šå¦‚ä½•åœ¨ true åˆ†æ”¯ä¸­æ£€ç´¢ T çš„å…ƒç´ ç±»å‹ã€‚è¿™ä½¿æˆ‘ä»¬ä¸å¿…æ€è€ƒå¦‚ä½•æŒ–æ˜å’Œæ¢ç´¢æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç±»å‹çš„ç»“æ„ã€‚\nWe can write some useful helper type aliases using the infer keyword. For example, for simple cases, we can extract the return type out from function types:\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ infer å…³é”®å­—ç¼–å†™ä¸€äº›æœ‰ç”¨çš„åŠ©æ‰‹ç±»å‹åˆ«åã€‚ä¾‹å¦‚ï¼Œå¯¹äºç®€å•çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä»å‡½æ•°ç±»å‹ä¸­æå–è¿”å›ç±»å‹ï¼š\ntype GetReturnType&lt;Type&gt; &#x3D; Type extends (...args: never[]) &#x3D;&gt; infer Return\n  ? Return\n  : never;\n\ntype Num &#x3D; GetReturnType&lt;() &#x3D;&gt; number&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼š type Num &#x3D; number\n\ntype Str &#x3D; GetReturnType&lt;(x: string) &#x3D;&gt; string&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼štype Str &#x3D; string\n\ntype Bools &#x3D; GetReturnType&lt;(a: boolean, b: boolean) &#x3D;&gt; boolean[]&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼š type Bools &#x3D; boolean[]\n\nWhen inferring from a type with multiple call signatures (such as the type of an overloaded function), inferences are made from the last signature (which, presumably, is the most permissive catch-all case). It is not possible to perform overload resolution based on a list of argument types.å½“ä»å…·æœ‰å¤šä¸ªè°ƒç”¨ç­¾åçš„ç±»å‹ï¼ˆä¾‹å¦‚é‡è½½å‡½æ•°çš„ç±»å‹ï¼‰è¿›è¡Œæ¨æ–­æ—¶ï¼Œå°†ä»æœ€åä¸€ä¸ªç­¾åè¿›è¡Œæ¨æ–­ï¼ˆè¿™å¯èƒ½æ˜¯æœ€å…è®¸çš„ä¸€ç½‘æ‰“å°½çš„æƒ…å†µï¼‰ã€‚æ— æ³•åŸºäºå‚æ•°ç±»å‹åˆ—è¡¨æ‰§è¡Œé‡è½½è§£æã€‚\ndeclare function stringOrNum(x: string): number;\ndeclare function stringOrNum(x: number): string;\ndeclare function stringOrNum(x: string | number): string | number;\n\ntype T1 &#x3D; ReturnType&lt;typeof stringOrNum&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼štype T1 &#x3D; string | number;\n\nDistributive Conditional Typesåˆ†å¸ƒæ¡ä»¶ç±»å‹\nWhen conditional types act on a generic type, they become distributive when given a union type. For example, take the following:å½“æ¡ä»¶ç±»å‹ä½œç”¨äºæ³›å‹ç±»å‹æ—¶ï¼Œå½“ç»™å®šä¸€ä¸ªè”åˆç±»å‹æ—¶ï¼Œå®ƒä»¬å°†æˆä¸ºåˆ†å¸ƒå¼çš„ã€‚ä¾‹å¦‚ï¼Œä»¥ä»¥ä¸‹å†…å®¹ä¸ºä¾‹ï¼š\ntype ToArray&lt;Type&gt; &#x3D; Type extends any ? Type[] : never;\n\nIf we plug a union type into ToArray, then the conditional type will be applied to each member of that union.å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªè”åˆç±»å‹æ’å…¥ ToArrayï¼Œé‚£ä¹ˆæ¡ä»¶ç±»å‹å°†åº”ç”¨äºè¯¥è”åˆçš„æ¯ä¸ªæˆå‘˜ã€‚\ntype ToArray&lt;Type&gt; &#x3D; Type extends any ? Type[] : never;\n\ntype StrArrOrNumArr &#x3D; ToArray&lt;string | number&gt;;\n\n&#x2F;&#x2F; æç¤ºï¼štype StrArrOrNumArr &#x3D; string[] | number[];\n\nWhat happens here is that StrArrOrNumArr distributes on:è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ\nstring | number;\n\nand maps over each member type of the union, to what is effectively:å¹¶æ˜ å°„åˆ°è”åˆç±»å‹æ¯ä¸ªæˆå‘˜ç±»å‹\nToArray&lt;string&gt; | ToArray&lt;number&gt;;\n\nwhich leaves us with:è¿™ç»™æˆ‘ä»¬ç•™ä¸‹äº†ï¼š\nstring[] | number[];\n\nTypically, distributivity is the desired behavior. To avoid that behavior, you can surround each side of the extends keyword with square brackets.é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼æ˜¯æ‰€éœ€çš„è¡Œä¸ºã€‚è¦é¿å…è¿™ç§è¡Œä¸ºï¼Œä½ å¯ä»¥åœ¨æ¯è¾¹ extends å…³é”®å­—ä¹‹å‰ä½¿ç”¨æ–¹æ‹¬å·ã€‚\ntype ToArrayNonDist&lt;Type&gt; &#x3D; [Type] extends [any] ? Type[] : never;\n\n&#x2F;&#x2F; &#39;StrArrOrNumArr&#39; is no longer a union.\ntype StrArrOrNumArr &#x3D; ToArrayNonDist&lt;string | number&gt;;\n&#x2F;&#x2F; æç¤ºï¼štype StrArrOrNumArr &#x3D; (string | number)[];\n\nReturnæ¨¡æ¿å­—é¢é‡ç±»å‹ï¼ˆTemplate Literal Typesï¼‰æ¨¡æ¿å­—é¢é‡ç±»å‹ä»¥å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹ä¸ºåŸºç¡€ï¼Œå¯ä»¥é€šè¿‡è”åˆç±»å‹æ‰©å±•æˆå¤šä¸ªå­—ç¬¦ä¸²ã€‚\nå®ƒä»¬è·Ÿ JavaScript çš„æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„è¯­æ³•ï¼Œä½†æ˜¯åªèƒ½ç”¨åœ¨ç±»å‹æ“ä½œä¸­ã€‚å½“ä½¿ç”¨æ¨¡æ¿å­—é¢é‡ç±»å‹æ—¶ï¼Œå®ƒä¼šæ›¿æ¢æ¨¡æ¿ä¸­çš„å˜é‡ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼š\ntype World &#x3D; &quot;world&quot;;\n\ntype Greeting &#x3D; &#96;hello $&#123;World&#125;&#96;;\n&#x2F;&#x2F; type Greeting &#x3D; &quot;hello world&quot;\n\n\nå½“æ¨¡æ¿ä¸­çš„å˜é‡æ˜¯ä¸€ä¸ªè”åˆç±»å‹æ—¶ï¼Œæ¯ä¸€ä¸ªå¯èƒ½çš„å­—ç¬¦ä¸²å­—é¢é‡éƒ½ä¼šè¢«è¡¨ç¤ºï¼š\n\ntype EmailLocaleIDs &#x3D; &quot;welcome_email&quot; | &quot;email_heading&quot;;\ntype FooterLocaleIDs &#x3D; &quot;footer_title&quot; | &quot;footer_sendoff&quot;;\n\ntype AllLocaleIDs &#x3D; &#96;$&#123;EmailLocaleIDs | FooterLocaleIDs&#125;_id&#96;;\n&#x2F;&#x2F; type AllLocaleIDs &#x3D; &quot;welcome*email_id&quot; | &quot;email_heading_id&quot; | &quot;footer_title_id&quot; | &quot;footer_sendoff_id&quot;\n\n\nå¦‚æœæ¨¡æ¿å­—é¢é‡é‡Œçš„å¤šä¸ªå˜é‡éƒ½æ˜¯è”åˆç±»å‹ï¼Œç»“æœä¼šäº¤å‰ç›¸ä¹˜ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°±æœ‰ 2 * 2 _ 3 ä¸€å…± 12 ç§ç»“æœï¼š\n\ntype AllLocaleIDs &#x3D; &#96;$&#123;EmailLocaleIDs | FooterLocaleIDs&#125;_id&#96;;\ntype Lang &#x3D; &quot;en&quot; | &quot;ja&quot; | &quot;pt&quot;;\n\ntype LocaleMessageIDs &#x3D; &#96;$&#123;Lang&#125;_$&#123;AllLocaleIDs&#125;&#96;;\n&#x2F;&#x2F; type LocaleMessageIDs &#x3D; &quot;en_welcome_email_id&quot; | &quot;en_email_heading_id&quot; | &quot;en_footer_title_id&quot; | &quot;en_footer_sendoff_id&quot; | &quot;ja_welcome_email_id&quot; | &quot;ja_email_heading_id&quot; | &quot;ja_footer_title_id&quot; | &quot;ja_footer_sendoff_id&quot; | &quot;pt_welcome_email_id&quot; | &quot;pt_email_heading_id&quot; | &quot;pt_footer_title_id&quot; | &quot;pt_footer_sendoff_id&quot;\n\n\nå¦‚æœçœŸçš„æ˜¯éå¸¸é•¿çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼Œæ¨èæå‰ç”Ÿæˆï¼Œè¿™ç§è¿˜æ˜¯é€‚ç”¨äºçŸ­ä¸€äº›çš„æƒ…å†µã€‚\n\nç±»å‹ä¸­çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼ˆString Unions in Typesï¼‰æ¨¡æ¿å­—é¢é‡æœ€æœ‰ç”¨çš„åœ°æ–¹åœ¨äºä½ å¯ä»¥åŸºäºä¸€ä¸ªç±»å‹å†…éƒ¨çš„ä¿¡æ¯ï¼Œå®šä¹‰ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š\næœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•° makeWatchedObjectï¼Œ å®ƒä¼šç»™ä¼ å…¥çš„å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ª on æ–¹æ³•ã€‚åœ¨ JavaScript ä¸­ï¼Œå®ƒçš„è°ƒç”¨çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼šmakeWatchedObject(baseObject)ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªä¼ å…¥å¯¹è±¡ä¸ºï¼š\nconst passedObject &#x3D; &#123;\n  firstName: &quot;Saoirse&quot;,\n  lastName: &quot;Ronan&quot;,\n  age: 26,\n&#125;;\n\nè¿™ä¸ª on æ–¹æ³•ä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ªä¼ å…¥å¯¹è±¡ä¸Šï¼Œè¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼ŒeventName ï¼ˆ string ç±»å‹ï¼‰ å’Œ callBack ï¼ˆfunction ç±»å‹ï¼‰ï¼š\n&#x2F;&#x2F; ä¼ªä»£ç \nconst result &#x3D; makeWatchedObject(baseObject);\nresult.on(eventName, callBack);\n\næˆ‘ä»¬å¸Œæœ› eventName æ˜¯è¿™ç§å½¢å¼ï¼šattributeInThePassedObject + â€œChangedâ€ ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œ\n\npassedObject æœ‰ä¸€ä¸ªå±æ€§ firstNameï¼Œå¯¹åº”äº§ç”Ÿçš„ eventName ä¸º firstNameChangedï¼Œ\nåŒç†ï¼ŒlastName å¯¹åº”çš„æ˜¯ lastNameChangedï¼Œ\nage å¯¹åº”çš„æ˜¯ ageChangedã€‚\n\nå½“è¿™ä¸ª callBack å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼š\n\nåº”è¯¥è¢«ä¼ å…¥ä¸ attributeInThePassedObject ç›¸åŒç±»å‹çš„å€¼ã€‚æ¯”å¦‚ passedObject ä¸­ï¼Œ\nfirstName çš„å€¼çš„ç±»å‹ä¸º string , å¯¹åº” firstNameChanged äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œåˆ™æ¥å—ä¼ å…¥ä¸€ä¸ª string ç±»å‹çš„å€¼ã€‚\nage çš„å€¼çš„ç±»å‹ä¸º numberï¼Œå¯¹åº” ageChanged äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œåˆ™æ¥å—ä¼ å…¥ä¸€ä¸ª number ç±»å‹çš„å€¼ã€‚\n\n\nè¿”å›å€¼ç±»å‹ä¸º void ç±»å‹ã€‚on() æ–¹æ³•çš„ç­¾åæœ€ä¸€å¼€å§‹æ˜¯è¿™æ ·çš„ï¼šon(eventName: string, callBack: (newValue: any) &#x3D;&gt; void)ã€‚ ä½¿ç”¨è¿™æ ·çš„ç­¾åï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½å®ç°ä¸Šé¢æ‰€è¯´çš„è¿™äº›çº¦æŸçš„ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ¨¡æ¿å­—é¢é‡ï¼š\n\nconst person &#x3D; makeWatchedObject(&#123;\n  firstName: &quot;Saoirse&quot;,\n  lastName: &quot;Ronan&quot;,\n  age: 26,\n&#125;);\n\n&#x2F;&#x2F; makeWatchedObject has added &#96;on&#96; to the anonymous Object\nperson.on(&quot;firstNameChanged&quot;, (newValue) &#x3D;&gt; &#123;\n  console.log(&#96;firstName was changed to $&#123;newValue&#125;!&#96;);\n&#125;);\n\næ³¨æ„è¿™ä¸ªä¾‹å­é‡Œï¼Œon æ–¹æ³•æ·»åŠ çš„äº‹ä»¶åä¸º â€œfirstNameChangedâ€ï¼Œ è€Œä¸ä»…ä»…æ˜¯ â€œfirstNameâ€ï¼Œè€Œå›è°ƒå‡½æ•°ä¼ å…¥çš„å€¼ newValue ï¼Œæˆ‘ä»¬å¸Œæœ›çº¦æŸä¸º string ç±»å‹ã€‚æˆ‘ä»¬å…ˆå®ç°ç¬¬ä¸€ç‚¹ã€‚\nåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›ä¼ å…¥çš„äº‹ä»¶åçš„ç±»å‹ï¼Œæ˜¯å¯¹è±¡å±æ€§åçš„è”åˆï¼Œåªæ˜¯æ¯ä¸ªè”åˆæˆå‘˜éƒ½è¿˜åœ¨æœ€åæ‹¼æ¥ä¸€ä¸ª Changed å­—ç¬¦ï¼Œåœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åšè¿™æ ·ä¸€ä¸ªè®¡ç®—ï¼š\nObject.keys(passedObject).map(x &#x3D;&gt; $&#123;x&#125;Changed)\n\næ¨¡æ¿å­—é¢é‡æä¾›äº†ä¸€ä¸ªç›¸ä¼¼çš„å­—ç¬¦ä¸²æ“ä½œï¼š\ntype PropEventSource&lt;Type&gt; &#x3D; &#123;\n  on(\n    eventName: &#96;$&#123;string &amp; keyof Type&#125;Changed&#96;,\n    callback: (newValue: any) &#x3D;&gt; void\n  ): void;\n&#125;;\n\n&#x2F;&#x2F;&#x2F; Create a &quot;watched object&quot; with an &#39;on&#39; method\n&#x2F;&#x2F;&#x2F; so that you can watch for changes to properties.\n\ndeclare function makeWatchedObject&lt;Type&gt;(\n  obj: Type\n): Type &amp; PropEventSource&lt;Type&gt;;\n\næ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¾‹å­ä¸­ï¼Œæ¨¡æ¿å­—é¢é‡é‡Œæˆ‘ä»¬å†™çš„æ˜¯ string &amp; keyof Typeï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥åªå†™æˆ keyof Type å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬è¿™æ ·å†™ï¼Œä¼šæŠ¥é”™ï¼š\ntype PropEventSource&lt;Type&gt; &#x3D; &#123;\n  on(\n    eventName: &#96;$&#123;keyof Type&#125;Changed&#96;,\n    callback: (newValue: any) &#x3D;&gt; void\n  ): void;\n&#125;;\n\n&#x2F;&#x2F; Type &#39;keyof Type&#39; is not assignable to type &#39;string | number | bigint | boolean | null | undefined&#39;.\n&#x2F;&#x2F; Type &#39;string | number | symbol&#39; is not assignable to type &#39;string | number | bigint | boolean | null | undefined&#39;.\n&#x2F;&#x2F; ...\n\nä»æŠ¥é”™ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæŠ¥é”™åŸå› ï¼Œåœ¨ ã€ŠTypeScript ç³»åˆ—ä¹‹ Keyof æ“ä½œç¬¦ã€‹é‡Œï¼Œæˆ‘ä»¬çŸ¥é“\n\nkeyof æ“ä½œç¬¦ä¼šè¿”å› string | number | symbol ç±»å‹ï¼Œ\nä½†æ˜¯æ¨¡æ¿å­—é¢é‡çš„å˜é‡è¦æ±‚çš„ç±»å‹å´æ˜¯ string | number | bigint | boolean | null | undefinedï¼Œ\n\næ¯”è¾ƒä¸€ä¸‹ï¼Œå¤šäº†ä¸€ä¸ª symbol ç±»å‹ï¼Œæ‰€ä»¥å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š\ntype PropEventSource&lt;Type&gt; &#x3D; &#123;\n  on(\n    eventName: &#96;$&#123;Exclude&lt;keyof Type, symbol&gt;&#125;Changed&#96;,\n    callback: (newValue: any) &#x3D;&gt; void\n  ): void;\n&#125;;\n\nå†æˆ–è€…è¿™æ ·å†™ï¼š\ntype PropEventSource&lt;Type&gt; &#x3D; &#123;\n  on(\n    eventName: &#96;$&#123;Extract&lt;keyof Type, string&gt;&#125;Changed&#96;,\n    callback: (newValue: any) &#x3D;&gt; void\n  ): void;\n&#125;;\n\nä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨é”™è¯¯çš„äº‹ä»¶åæ—¶ï¼ŒTypeScript ä¼šç»™å‡ºæŠ¥é”™ï¼š\nconst person &#x3D; makeWatchedObject(&#123;\n  firstName: &quot;Saoirse&quot;,\n  lastName: &quot;Ronan&quot;,\n  age: 26,\n&#125;);\n\nperson.on(&quot;firstNameChanged&quot;, () &#x3D;&gt; &#123;&#125;);\n\n&#x2F;&#x2F; Prevent easy human error (using the key instead of the event name)\nperson.on(&quot;firstName&quot;, () &#x3D;&gt; &#123;&#125;);\n&#x2F;&#x2F; Argument of type &#39;&quot;firstName&quot;&#39; is not assignable to parameter of type &#39;&quot;firstNameChanged&quot; | &quot;lastNameChanged&quot; | &quot;ageChanged&quot;&#39;.\n\n&#x2F;&#x2F; It&#39;s typo-resistant\nperson.on(&quot;frstNameChanged&quot;, () &#x3D;&gt; &#123;&#125;);\n&#x2F;&#x2F; Argument of type &#39;&quot;frstNameChanged&quot;&#39; is not assignable to parameter of type &#39;&quot;firstNameChanged&quot; | &quot;lastNameChanged&quot; | &quot;ageChanged&quot;&#39;.\n\næ¨¡æ¿å­—é¢é‡çš„æ¨æ–­ï¼ˆInference with Template Literalsï¼‰ç°åœ¨æˆ‘ä»¬æ¥å®ç°ç¬¬äºŒç‚¹ï¼Œå›è°ƒå‡½æ•°ä¼ å…¥çš„å€¼çš„ç±»å‹ä¸å¯¹åº”çš„å±æ€§å€¼çš„ç±»å‹ç›¸åŒã€‚æˆ‘ä»¬ç°åœ¨åªæ˜¯ç®€å•çš„å¯¹ callBack çš„å‚æ•°ä½¿ç”¨ any ç±»å‹ã€‚å®ç°è¿™ä¸ªçº¦æŸçš„å…³é”®åœ¨äºå€ŸåŠ©æ³›å‹å‡½æ•°ï¼š\næ•è·æ³›å‹å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„å­—é¢é‡ï¼Œç”Ÿæˆä¸€ä¸ªå­—é¢é‡ç±»å‹\n\nè¯¥å­—é¢é‡ç±»å‹å¯ä»¥è¢«å¯¹è±¡å±æ€§æ„æˆçš„è”åˆçº¦æŸ\nå¯¹è±¡å±æ€§çš„ç±»å‹å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®è·å–\nåº”ç”¨æ­¤ç±»å‹ï¼Œç¡®ä¿å›è°ƒå‡½æ•°çš„å‚æ•°ç±»å‹ä¸å¯¹è±¡å±æ€§çš„ç±»å‹æ˜¯åŒä¸€ä¸ªç±»å‹\n\ntype PropEventSource&lt;Type&gt; &#x3D; &#123;\n  on&lt;Key extends string &amp; keyof Type&gt;(\n    eventName: &#96;$&#123;Key&#125;Changed&#96;,\n    callback: (newValue: Type[Key]) &#x3D;&gt; void\n  ): void;\n&#125;;\n\ndeclare function makeWatchedObject&lt;Type&gt;(\n  obj: Type\n): Type &amp; PropEventSource&lt;Type&gt;;\n\nconst person &#x3D; makeWatchedObject(&#123;\n  firstName: &quot;Saoirse&quot;,\n  lastName: &quot;Ronan&quot;,\n  age: 26,\n&#125;);\n\nperson.on(&quot;firstNameChanged&quot;, (newName) &#x3D;&gt; &#123;\n  &#x2F;&#x2F; (parameter) newName: string\n  console.log(&#96;new name is $&#123;newName.toUpperCase()&#125;&#96;);\n&#125;);\n\nperson.on(&quot;ageChanged&quot;, (newAge) &#x3D;&gt; &#123;\n  &#x2F;&#x2F; (parameter) newAge: number\n  if (newAge &lt; 0) &#123;\n    console.warn(&quot;warning! negative age&quot;);\n  &#125;\n&#125;);\n\nè¿™é‡Œæˆ‘ä»¬æŠŠ on æ”¹æˆäº†ä¸€ä¸ªæ³›å‹å‡½æ•°ã€‚\nå½“ä¸€ä¸ªç”¨æˆ·è°ƒç”¨çš„æ—¶å€™ä¼ å…¥ â€œfirstNameChangedâ€ï¼ŒTypeScript ä¼šå°è¯•ç€æ¨æ–­ Key æ­£ç¡®çš„ç±»å‹ã€‚å®ƒä¼šåŒ¹é… key å’Œ â€œChangedâ€ å‰çš„å­—ç¬¦ä¸² ï¼Œç„¶åæ¨æ–­å‡ºå­—ç¬¦ä¸² â€œfirstNameâ€ ï¼Œç„¶åå†è·å–åŸå§‹å¯¹è±¡çš„ firstName å±æ€§çš„ç±»å‹ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯ string ç±»å‹ã€‚\nå†…ç½®å­—ç¬¦æ“ä½œç±»å‹ï¼ˆIntrinsic String Manipulation Typesï¼‰TypeScript çš„ä¸€äº›ç±»å‹å¯ä»¥ç”¨äºå­—ç¬¦æ“ä½œï¼Œè¿™äº›ç±»å‹å¤„äºæ€§èƒ½çš„è€ƒè™‘è¢«å†…ç½®åœ¨ç¼–è¯‘å™¨ä¸­ï¼Œä½ ä¸èƒ½åœ¨ .d.ts æ–‡ä»¶é‡Œæ‰¾åˆ°å®ƒä»¬ã€‚\nUppercaseæŠŠæ¯ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™å½¢å¼ï¼š\ntype Greeting &#x3D; &quot;Hello, world&quot;;\ntype ShoutyGreeting &#x3D; Uppercase&lt;Greeting&gt;;\n&#x2F;&#x2F; type ShoutyGreeting &#x3D; &quot;HELLO, WORLD&quot;\n\ntype ASCIICacheKey&lt;Str extends string&gt; &#x3D; &#96;ID-$&#123;Uppercase&lt;Str&gt;&#125;&#96;;\ntype MainID &#x3D; ASCIICacheKey&lt;&quot;my_app&quot;&gt;;\n&#x2F;&#x2F; type MainID &#x3D; &quot;ID-MY_APP&quot;\n\nLowercaseæŠŠæ¯ä¸ªå­—ç¬¦è½¬ä¸ºå°å†™å½¢å¼ï¼š\ntype Greeting &#x3D; &quot;Hello, world&quot;;\ntype QuietGreeting &#x3D; Lowercase&lt;Greeting&gt;;\n&#x2F;&#x2F; type QuietGreeting &#x3D; &quot;hello, world&quot;\n\ntype ASCIICacheKey&lt;Str extends string&gt; &#x3D; &#96;id-$&#123;Lowercase&lt;Str&gt;&#125;&#96;;\ntype MainID &#x3D; ASCIICacheKey&lt;&quot;MY_APP&quot;&gt;;\n&#x2F;&#x2F; type MainID &#x3D; &quot;id-my_app&quot;\n\nCapitalize\næŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™å½¢å¼ï¼š\n\ntype LowercaseGreeting &#x3D; &quot;hello, world&quot;;\ntype Greeting &#x3D; Capitalize&lt;LowercaseGreeting&gt;;\n&#x2F;&#x2F; type Greeting &#x3D; &quot;Hello, world&quot;\n\nUncapitalize\næŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå°å†™å½¢å¼ï¼š\n\ntype UppercaseGreeting &#x3D; &quot;HELLO WORLD&quot;;\ntype UncomfortableGreeting &#x3D; Uncapitalize&lt;UppercaseGreeting&gt;;\n&#x2F;&#x2F; type UncomfortableGreeting &#x3D; &quot;hELLO WORLD&quot;\n\n\nå­—ç¬¦æ“ä½œç±»å‹çš„æŠ€æœ¯ç»†èŠ‚ä» TypeScript 4.1 èµ·ï¼Œè¿™äº›å†…ç½®å‡½æ•°ä¼šç›´æ¥ä½¿ç”¨ JavaScript å­—ç¬¦ä¸²è¿è¡Œæ—¶å‡½æ•°ï¼Œè€Œä¸æ˜¯æœ¬åœ°åŒ–è¯†åˆ« (locale aware)ã€‚\n\nfunction applyStringMapping(symbol: Symbol, str: string) &#123;\n  switch (intrinsicTypeKinds.get(symbol.escapedName as string)) &#123;\n    case IntrinsicTypeKind.Uppercase:\n      return str.toUpperCase();\n    case IntrinsicTypeKind.Lowercase:\n      return str.toLowerCase();\n    case IntrinsicTypeKind.Capitalize:\n      return str.charAt(0).toUpperCase() + str.slice(1);\n    case IntrinsicTypeKind.Uncapitalize:\n      return str.charAt(0).toLowerCase() + str.slice(1);\n  &#125;\n  return str;\n&#125;\n\nä½œè€…ï¼šå†´ç¾½é“¾æ¥ï¼šhttps://www.imooc.com/article/322215æ¥æºï¼šæ…•è¯¾ç½‘æœ¬æ–‡åŸåˆ›å‘å¸ƒäºæ…•è¯¾ç½‘ ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œè°¢è°¢åˆä½œ\nåœ¨æƒ³ä¸€ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆåˆ«äººå¯ä»¥æŠŠæ–‡æ¡£ç¿»è¯‘çš„é‚£ä¹ˆå‡†ç¡®ï¼Œè®©è¯»è€…ä¸€çœ‹å°±æ˜ç™½\n","slug":"2022-06-07ts-type-manipulation","date":"2022-06-08T03:20:35.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"f1faf548c4c61142a49eddcdf4aec1f6","title":"6.Typescriptæ‰‹å†Œ å¯¹è±¡ç±»å‹","content":"In JavaScript, the fundamental way that we group and pass around data is through objects. In TypeScript, we represent those through object types.åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹è±¡æ¥ç»„ç»‡å’Œä¼ é€’æ•°æ®ã€‚åœ¨ TypeScript ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹è±¡ç±»å‹æ¥è¡¨ç¤ºè¿™äº›å¯¹è±¡ã€‚As weâ€™ve seen, they can be anonymous:æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬å¯ä»¥æ˜¯åŒ¿åçš„ï¼š\nfunction greet(person: &#123; name: string; age: number &#125;) &#123;\n  return &quot;Hello &quot; + person.name;\n&#125;\n\nor they can be named by using either an interfaceæˆ–è€…ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨æ¥å£æ¥å‘½å\ninterface Person &#123;\n  name: string;\n  age: number;\n&#125;\n\nfunction greet(person: Person) &#123;\n  return &quot;Hello &quot; + person.name;\n&#125;\n\nor a type alias.æˆ–è€…ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨ç±»å‹åˆ«å\ntype Person &#x3D; &#123;\n  name: string;\n  age: number;\n&#125;;\n\nfunction greet(person: Person) &#123;\n  return &quot;Hello &quot; + person.name;\n&#125;\n\nIn all three examples above, weâ€™ve written functions that take objects that contain the property name (which must be a string) and age (which must be a number).åœ¨ä¸Šé¢ä¸‰ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»å†™äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—åŒ…å«å±æ€§ nameï¼ˆå¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼‰å’Œ ageï¼ˆå¿…é¡»æ˜¯æ•°å­—ï¼‰çš„å¯¹è±¡ã€‚\nProperty Modifierså±æ€§ä¿®é¥°ç¬¦Each property in an object type can specify a couple of things: the type, whether the property is optional, and whether the property can be written to.å¯¹è±¡ç±»å‹ä¸­çš„æ¯ä¸ªå±æ€§éƒ½å¯ä»¥æŒ‡å®šä¸€äº›ä¸œè¥¿ï¼šç±»å‹ã€æ˜¯å¦æ˜¯å¯é€‰çš„ï¼Œä»¥åŠæ˜¯å¦å¯ä»¥å†™å…¥ã€‚\nOptional Propertieså¯é€‰å±æ€§Much of the time, weâ€™ll find ourselves dealing with objects that might have a property set. In those cases, we can mark those properties as optional by adding a question mark (?) to the end of their names.å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬åœ¨å¯¹å¯¹è±¡è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæœ‰å±æ€§è¢«è®¾ç½®ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å±æ€§åçš„æœ«å°¾æ·»åŠ é—®å·æ¥æ ‡è®°è¿™äº›å±æ€§ä¸ºå¯é€‰çš„ã€‚\ninterface PaintOptions &#123;\n  shape: Shape;\n  xPos?: number;\n  yPos?: number;\n&#125;\n\nfunction paintShape(opts: PaintOptions) &#123;\n  &#x2F;&#x2F; ...\n&#125;\n\nconst shape &#x3D; getShape();\npaintShape(&#123; shape &#125;);\npaintShape(&#123; shape, xPos: 100 &#125;);\npaintShape(&#123; shape, yPos: 100 &#125;);\npaintShape(&#123; shape, xPos: 100, yPos: 100 &#125;);\n\nIn this example, both xPos and yPos are considered optional. We can choose to provide either of them, so every call above to paintShape is valid. All optionality really says is that if the property is set, it better have a specific type.åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒxPoså’ŒyPoséƒ½è¢«è®¤ä¸ºæ˜¯å¯é€‰çš„ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æä¾›å…¶ä¸­ä¸€ä¸ªï¼Œå› æ­¤æ¯æ¬¡è°ƒç”¨paintShapeéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚æ‰€æœ‰çš„å¯é€‰æ€§éƒ½è¯´æ˜¯ï¼Œå¦‚æœå±æ€§è¢«è®¾ç½®ï¼Œå®ƒåº”è¯¥æœ‰ä¸€ä¸ªç‰¹å®šçš„ç±»å‹ã€‚We can also read from those properties - but when we do under strictNullChecks, TypeScript will tell us theyâ€™re potentially undefined.æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯»å–è¿™äº›å±æ€§ï¼Œä½†æ˜¯åœ¨ä¸¥æ ¼çš„ null æ£€æŸ¥ä¸‹ï¼ŒTypeScript å°†ä¼šå‘Šè¯‰æˆ‘ä»¬è¿™äº›å±æ€§å¯èƒ½æ˜¯ undefinedã€‚\nfunction paintShape(opts: PaintOptions) &#123;\n  let xPos &#x3D; opts.xPos;\n  &#x2F;&#x2F; (property) PaintOptions.xPos?: number | undefined\n\n  let yPos &#x3D; opts.yPos;\n  &#x2F;&#x2F; (property) PaintOptions.yPos?: number | undefined\n  &#x2F;&#x2F; ...\n&#125;\n\nIn JavaScript, even if the property has never been set, we can still access it - itâ€™s just going to give us the value undefined. We can just handle undefined specially.åœ¨ JavaScript ä¸­ï¼Œå³ä½¿å±æ€§æ²¡æœ‰è¢«è®¾ç½®ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—®å®ƒï¼Œå®ƒåªæ˜¯ç»™æˆ‘ä»¬ä¸€ä¸ªå€¼ undefinedã€‚æˆ‘ä»¬å¯ä»¥ç‰¹åˆ«å¤„ç† undefinedã€‚\nfunction paintShape(opts: PaintOptions) &#123;\n  let xPos &#x3D; opts.xPos &#x3D;&#x3D;&#x3D; undefined ? 0 : opts.xPos;\n  &#x2F;&#x2F; let xPos: number;\n\n  let yPos &#x3D; opts.yPos &#x3D;&#x3D;&#x3D; undefined ? 0 : opts.yPos;\n  &#x2F;&#x2F; let yPos: number;\n  &#x2F;&#x2F; ...\n&#125;\n\nNote that this pattern of setting defaults for unspecified values is so common that JavaScript has syntax to support it.æ³¨æ„ï¼Œè¿™ç§è®¾ç½®é»˜è®¤å€¼çš„æ–¹å¼å¾ˆå¸¸è§ï¼Œå› æ­¤ JavaScript æœ‰ä¸€ç§è¯­æ³•æ¥æ”¯æŒå®ƒã€‚\nfunction paintShape(&#123; shape, xPos &#x3D; 0, yPos &#x3D; 0 &#125;: PaintOptions) &#123;\n  console.log(&quot;x coordinate at&quot;, xPos);\n  &#x2F;&#x2F; (parameter) xPos: number\n\n  console.log(&quot;y coordinate at&quot;, yPos);\n  &#x2F;&#x2F; (parameter) yPos: number\n  &#x2F;&#x2F; ...\n&#125;\n\nHere we used a destructuring pattern for paintShapeâ€™s parameter, and provided default values for xPos and yPos. Now xPos and yPos are both definitely present within the body of paintShape, but optional for any callers to paintShape.åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† paintShape çš„å‚æ•°çš„ææ„æ¨¡å¼ï¼Œå¹¶ä¸º xPos å’Œ yPos æä¾›äº†é»˜è®¤å€¼ã€‚ç°åœ¨ xPos å’Œ yPos åœ¨ paintShape çš„ä¸»ä½“ä¸­éƒ½æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯ä»»ä½•è°ƒç”¨è€…è°ƒç”¨ paintShape çš„å€¼éƒ½æ˜¯å¯é€‰çš„ã€‚Note that there is currently no way to place type annotations within destructuring patterns. This is because the following syntax already means something different in JavaScript.æ³¨æ„ï¼Œç›®å‰æ²¡æœ‰åŠæ³•åœ¨ææ„æ¨¡å¼ä¸­æ”¾ç½®ç±»å‹æ ‡æ³¨ã€‚å› ä¸ºè¿™ä¸ªè¯­æ³•å·²ç»åœ¨ JavaScript ä¸­è¡¨ç¤ºäº†ä¸åŒçš„æ„æ€ã€‚\nfunction draw(&#123; shape: Shape, xPos: number &#x3D; 100 &#x2F;_..._&#x2F; &#125;) &#123;\nrender(shape);\n&#x2F;&#x2F; Cannot find name &#39;shape&#39;. Did you mean &#39;Shape&#39;?\nrender(xPos);\n&#x2F;&#x2F; Cannot find name &#39;xPos&#39;.\n&#125;\n\nIn an object destructuring pattern, shape: Shape means â€œgrab the property shape and redefine it locally as a variable named Shape. Likewise xPos: number creates a variable named number whose value is based on the parameterâ€™s xPos.åœ¨ä¸€ä¸ªå¯¹è±¡ææ„æ¨¡å¼ä¸­ï¼Œshape: Shape è¡¨ç¤ºâ€œæŠ“å–å±æ€§ shape å¹¶é‡æ–°å®šä¹‰å®ƒä½œä¸ºåä¸º Shape çš„å˜é‡ã€‚åŒæ ·çš„ï¼ŒxPos: number åˆ›å»ºäº†ä¸€ä¸ªåä¸º number çš„å˜é‡ï¼Œå…¶å€¼æ˜¯åŸºäºå‚æ•°çš„ xPosã€‚Using mapping modifiers, you can remove optional attributes.ä½¿ç”¨æ˜ å°„ä¿®é¥°ç¬¦ï¼Œä½ å¯ä»¥ç§»é™¤å¯é€‰å±æ€§ã€‚\nReadonly Propertiesåªè¯»å±æ€§Properties can also be marked as readonly for TypeScript. While it wonâ€™t change any behavior at runtime, a property marked as readonly canâ€™t be written to during type-checking.åªè¯»å±æ€§\ninterface SomeType &#123;\n  readonly prop: string;\n&#125;\n\nfunction doSomething(obj: SomeType) &#123;\n  &#x2F;&#x2F; We can read from &#39;obj.prop&#39;.\n  console.log(&#96;prop has the value &#39;$&#123;obj.prop&#125;&#39;.&#96;);\n\n  &#x2F;&#x2F; But we can&#39;t re-assign it.\n  obj.prop &#x3D; &quot;hello&quot;;\n  &#x2F;&#x2F; Cannot assign to &#39;prop&#39; because it is a read-only property.\n&#125;\n\nUsing the readonly modifier doesnâ€™t necessarily imply that a value is totally immutable - or in other words, that its internal contents canâ€™t be changed. It just means the property itself canâ€™t be re-written to.ä½¿ç”¨ readonly ä¿®é¥°ç¬¦å¹¶ä¸æ„å‘³ç€ä¸€ä¸ªå€¼æ˜¯å®Œå…¨ä¸å¯å˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„å†…éƒ¨å†…å®¹ä¸èƒ½è¢«æ”¹å˜ã€‚å®ƒåªæ˜¯è¯´ï¼Œå±æ€§æœ¬èº«ä¸èƒ½è¢«é‡å†™ã€‚\ninterface Home &#123;\n  readonly resident: &#123; name: string; age: number &#125;;\n&#125;\n\nfunction visitForBirthday(home: Home) &#123;\n  &#x2F;&#x2F; We can read and update properties from &#39;home.resident&#39;.\n  &#x2F;&#x2F; æˆ‘ä»¬å¯ä»¥ä» &#39;home.resident&#39; ä¸­è¯»å–å’Œæ›´æ–°å±æ€§ã€‚\n  console.log(&#96;Happy birthday $&#123;home.resident.name&#125;!&#96;);\n  home.resident.age++;\n&#125;\n\nfunction evict(home: Home) &#123;\n  &#x2F;&#x2F; But we can&#39;t write to the &#39;resident&#39; property itself on a &#39;Home&#39;.\n  &#x2F;&#x2F; ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨ &#39;Home&#39; ä¸Šå†™å…¥ &#39;resident&#39; å±æ€§ã€‚\n  home.resident &#x3D; &#123;\n    &#x2F;&#x2F; Cannot assign to &#39;resident&#39; because it is a read-only property.\n    name: &quot;Victor the Evictor&quot;,\n    age: 42,\n  &#125;;\n&#125;\n\nItâ€™s important to manage expectations of what readonly implies. Itâ€™s useful to signal intent during development time for TypeScript on how an object should be used. TypeScript doesnâ€™t factor in whether properties on two types are readonly when checking whether those types are compatible, so readonly properties can also change via aliasing.\næ³¨æ„\nTypeScript åœ¨æ£€æŸ¥ä¸¤ä¸ªç±»å‹æ˜¯å¦å…¼å®¹çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šè€ƒè™‘ä¸¤ä¸ªç±»å‹é‡Œçš„å±æ€§æ˜¯å¦æ˜¯ readonlyï¼Œè¿™å°±æ„å‘³ç€ï¼Œreadonly çš„å€¼æ˜¯å¯ä»¥é€šè¿‡åˆ«åä¿®æ”¹çš„ã€‚\ninterface Person &#123;\n  name: string;\n  age: number;\n&#125;\n\ninterface ReadonlyPerson &#123;\n  readonly name: string;\n  readonly age: number;\n&#125;\n\nlet writablePerson: Person &#x3D; &#123;\n  name: &quot;Person McPersonface&quot;,\n  age: 42,\n&#125;;\n\n&#x2F;&#x2F; works\nlet readonlyPerson: ReadonlyPerson &#x3D; writablePerson;\n\nconsole.log(readonlyPerson.age); &#x2F;&#x2F; prints &#39;42&#39;\nwritablePerson.age++;\nconsole.log(readonlyPerson.age); &#x2F;&#x2F; prints &#39;43&#39;\n\nUsing mapping modifiers, you can remove readonly attributes.\nIndex Signaturesç´¢å¼•ç­¾åSometimes you donâ€™t know all the names of a typeâ€™s properties ahead of time, but you do know the shape of the values.æœ‰æ—¶å€™ï¼Œä½ ä¸çŸ¥é“ä¸€ä¸ªç±»å‹çš„æ‰€æœ‰å±æ€§çš„åå­—ï¼Œä½†æ˜¯ä½ çŸ¥é“å€¼çš„å½¢çŠ¶ã€‚\nIn those cases you can use an index signature to describe the types of possible values, for example:åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ç´¢å¼•ç­¾åæ¥æè¿°å¯èƒ½çš„å€¼çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š\ninterface StringArray &#123;\n  [index: number]: string;\n&#125;\n\nconst myArray: StringArray &#x3D; getStringArray();\nconst secondItem &#x3D; myArray[1];\n\nconst secondItem: string;\n\nAbove, we have a StringArray interface which has an index signature. This index signature states that when a StringArray is indexed with a number, it will return a string.ä¸Šé¢ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª StringArray æ¥å£ï¼Œå®ƒæœ‰ä¸€ä¸ªç´¢å¼•ç­¾åã€‚è¿™ä¸ªç´¢å¼•ç­¾åè¯´æ˜ï¼Œå½“ä¸€ä¸ª StringArray è¢«ç´¢å¼•ä¸ºä¸€ä¸ªæ•°å­—æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚An index signature property type must be either â€˜stringâ€™ or â€˜numberâ€™.ç´¢å¼•ç­¾åå±æ€§ç±»å‹å¿…é¡»æ˜¯â€˜stringâ€™æˆ–â€˜numberâ€™ã€‚It is possible to support both types of indexersâ€¦å¯ä»¥æ”¯æŒä¸¤ç§ç±»å‹çš„ç´¢å¼•å™¨...\nWhile string index signatures are a powerful way to describe the â€œdictionaryâ€ pattern, they also enforce that all properties match their return type. This is because a string index declares that obj.property is also available as obj[â€œpropertyâ€]. In the following example, nameâ€™s type does not match the string indexâ€™s type, and the type checker gives an error:å°½ç®¡å­—ç¬¦ä¸²ç´¢å¼•ç”¨æ¥æè¿°å­—å…¸æ¨¡å¼ï¼ˆdictionary patternï¼‰éå¸¸çš„æœ‰æ•ˆï¼Œä½†ä¹Ÿä¼šå¼ºåˆ¶è¦æ±‚æ‰€æœ‰çš„å±æ€§è¦åŒ¹é…ç´¢å¼•ç­¾åçš„è¿”å›ç±»å‹ã€‚è¿™æ˜¯å› ä¸ºä¸€ä¸ªå£°æ˜ç±»ä¼¼äº obj.property çš„å­—ç¬¦ä¸²ç´¢å¼•ï¼Œè·Ÿ obj[&quot;property&quot;]æ˜¯ä¸€æ ·çš„ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œname çš„ç±»å‹å¹¶ä¸åŒ¹é…å­—ç¬¦ä¸²ç´¢å¼•çš„ç±»å‹ï¼Œæ‰€ä»¥ç±»å‹æ£€æŸ¥å™¨ä¼šç»™å‡ºæŠ¥é”™ï¼š\ninterface NumberDictionary &#123;\n  [index: string]: number;\n\n  length: number; &#x2F;&#x2F; ok\n  name: string;\n  &#x2F;&#x2F; Property &#39;name&#39; of type &#39;string&#39; is not assignable to &#39;string&#39; index type &#39;number&#39;.\n&#125;\n\nHowever, properties of different types are acceptable if the index signature is a union of the property types:ä½†æ˜¯ï¼Œä¸åŒç±»å‹çš„å±æ€§æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¦‚æœç´¢å¼•ç­¾åæ˜¯å±æ€§ç±»å‹çš„è”åˆï¼š\ninterface NumberOrStringDictionary &#123;\n  [index: string]: number | string;\n  length: number; &#x2F;&#x2F; ok, length is a number\n  name: string; &#x2F;&#x2F; ok, name is a string\n&#125;\n\nFinally, you can make index signatures readonly in order to prevent assignment to their indices:æœ€åï¼Œä½ å¯ä»¥ä½¿ç´¢å¼•ç­¾åå˜æˆåªè¯»ï¼Œä»¥é˜²æ­¢ç´¢å¼•èµ‹å€¼ï¼š\ninterface ReadonlyStringArray &#123;\n  readonly [index: number]: string;\n&#125;\n\nlet myArray: ReadonlyStringArray &#x3D; getReadOnlyStringArray();\nmyArray[2] &#x3D; &quot;Mallory&quot;;\n&#x2F;&#x2F; Index signature in type &#39;ReadonlyStringArray&#39; only permits reading.\n\nYou canâ€™t set myArray[2] because the index signature is readonly.ä½ ä¸èƒ½è®¾ç½® myArray[2]ï¼Œå› ä¸ºç´¢å¼•ç­¾åæ˜¯åªè¯»çš„ã€‚\nExtending Typesæ‰©å±•ç±»å‹Itâ€™s pretty common to have types that might be more specific versions of other types. For example, we might have a BasicAddress type that describes the fields necessary for sending letters and packages in the U.S.æˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªåŸºæœ¬çš„åœ°å€ç±»å‹ï¼Œå®ƒæè¿°äº†åœ¨ç¾å›½å‘é€ä¿¡ä»¶å’ŒåŒ…è£¹çš„å¿…è¦å­—æ®µã€‚\ninterface BasicAddress &#123;\n  name?: string;\n  street: string;\n  city: string;\n  country: string;\n  postalCode: string;\n&#125;\n\nIn some situations thatâ€™s enough, but addresses often have a unit number associated with them if the building at an address has multiple units. We can then describe an AddressWithUnit.åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ ·å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯åœ°å€æœ‰æ—¶å€™ä¼šæœ‰å•å…ƒå·ç ï¼Œå¦‚æœåœ°å€çš„å»ºç­‘æœ‰å¤šä¸ªå•å…ƒã€‚æˆ‘ä»¬å¯ä»¥æè¿°ä¸€ä¸ª AddressWithUnitã€‚\ninterface AddressWithUnit &#123;\n  name?: string;\n  unit: string;\n  street: string;\n  city: string;\n  country: string;\n  postalCode: string;\n&#125;\n\nThis does the job, but the downside here is that we had to repeat all the other fields from BasicAddress when our changes were purely additive. Instead, we can extend the original BasicAddress type and just add the new fields that are unique to AddressWithUnit.è¿™æ ·åšå°±å¯ä»¥äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬å¿…é¡»é‡å¤æ‰€æœ‰çš„å­—æ®µæ¥è‡ª BasicAddressï¼Œå½“æˆ‘ä»¬çš„æ”¹åŠ¨åªæ˜¯å¢åŠ æ€§çš„æ—¶å€™ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±•åŸæ¥çš„ BasicAddress ç±»å‹ï¼Œå¹¶ä¸”åªéœ€è¦å¢åŠ  AddressWithUnit çš„å”¯ä¸€å­—æ®µã€‚\ninterface BasicAddress &#123;\n  name?: string;\n  street: string;\n  city: string;\n  country: string;\n  postalCode: string;\n&#125;\n\ninterface AddressWithUnit extends BasicAddress &#123;\n  unit: string;\n&#125;\n\nThe extends keyword on an interface allows us to effectively copy members from other named types, and add whatever new members we want. This can be useful for cutting down the amount of type declaration boilerplate we have to write, and for signaling intent that several different declarations of the same property might be related. For example, AddressWithUnit didnâ€™t need to repeat the street property, and because street originates from BasicAddress, a reader will know that those two types are related in some way.åœ¨ä¸€ä¸ªæ¥å£ä¸Šä½¿ç”¨ extends å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥ä»å…¶ä»–å‘½åç±»å‹å¤åˆ¶æˆå‘˜ï¼Œå¹¶ä¸”æ·»åŠ æˆ‘ä»¬æƒ³è¦çš„æ–°æˆå‘˜ã€‚è¿™å¯ä»¥ç”¨æ¥ç¼©çŸ­æˆ‘ä»¬å†™çš„ç±»å‹å£°æ˜çš„çƒ­èº«ï¼Œä»¥åŠä¸ºåŒä¸€å±æ€§çš„å¤šä¸ªå£°æ˜æä¾›ç›¸å…³æ€§çš„ä¿¡å·ã€‚ä¾‹å¦‚ï¼ŒAddressWithUnit ä¸éœ€è¦é‡å¤ street å±æ€§ï¼Œå› ä¸º street æ¥è‡ª BasicAddressï¼Œè¯»è€…çŸ¥é“è¿™ä¸¤ä¸ªç±»å‹æ˜¯ç›¸å…³çš„ã€‚interfaces can also extend from multiple types.æ¥å£ä¹Ÿå¯ä»¥æ‰©å±•å¤šä¸ªç±»å‹ã€‚\ninterface Colorful &#123;\n  color: string;\n&#125;\n\ninterface Circle &#123;\n  radius: number;\n&#125;\n\ninterface ColorfulCircle extends Colorful, Circle &#123;&#125;\n\nconst cc: ColorfulCircle &#x3D; &#123;\n  color: &quot;red&quot;,\n  radius: 42,\n&#125;;\n\nIntersection Typesäº¤å‰ç±»å‹interfaces allowed us to build up new types from other types by extending them. TypeScript provides another construct called intersection types that is mainly used to combine existing object types.æ¥å£å…è®¸æˆ‘ä»¬ä»å…¶ä»–ç±»å‹æ‰©å±•æ–°ç±»å‹ã€‚TypeScript æä¾›äº†ä¸€ç§åˆå¹¶ç°æœ‰å¯¹è±¡ç±»å‹çš„äº¤å‰ç±»å‹ã€‚An intersection type is defined using the &amp; operator.äº¤å‰ç±»å‹ç”¨ &amp; è¿ç®—ç¬¦å®šä¹‰ã€‚\ninterface Colorful &#123;\n  color: string;\n&#125;\ninterface Circle &#123;\n  radius: number;\n&#125;\n\ntype ColorfulCircle &#x3D; Colorful &amp; Circle;\n\nHere, weâ€™ve intersected Colorful and Circle to produce a new type that has all the members of Colorful and Circle.è¿™é‡Œï¼Œæˆ‘ä»¬å°† Colorful å’Œ Circle è¿›è¡Œäº¤å‰ï¼Œä»¥ç”Ÿæˆä¸€ä¸ªæ–°ç±»å‹ï¼Œå®ƒåŒ…å«äº† Colorful å’Œ Circle çš„æ‰€æœ‰æˆå‘˜ã€‚\nfunction draw(circle: Colorful &amp; Circle) &#123;\n  console.log(&#96;Color was $&#123;circle.color&#125;&#96;);\n  console.log(&#96;Radius was $&#123;circle.radius&#125;&#96;);\n&#125;\n\n&#x2F;&#x2F; okay\ndraw(&#123; color: &quot;blue&quot;, radius: 42 &#125;);\n\n&#x2F;&#x2F; oops\ndraw(&#123; color: &quot;red&quot;, raidus: 42 &#125;);\n&#x2F;&#x2F; Argument of type &#39;&#123; color: string; raidus: number; &#125;&#39; is not assignable to parameter of type &#39;Colorful &amp; Circle&#39;.\n&#x2F;&#x2F; Object literal may only specify known properties, but &#39;raidus&#39; does not exist in type &#39;Colorful &amp; Circle&#39;. Did you mean to write &#39;radius&#39;?\n\nInterfaces vs. Intersectionsæ¥å£ä¸äº¤å‰ç±»å‹We just looked at two ways to combine types which are similar, but are actually subtly different. With interfaces, we could use an extends clause to extend from other types, and we were able to do something similar with intersections and name the result with a type alias. The principle difference between the two is how conflicts are handled, and that difference is typically one of the main reasons why youâ€™d pick one over the other between an interface and a type alias of an intersection type.æˆ‘ä»¬åªçœ‹åˆ°äº†ä¸¤ç§æ–¹å¼æ¥åˆå¹¶ç±»å‹ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯æœ‰ç€å¾®å¦™çš„åŒºåˆ«ã€‚æ¥å£ä½¿ç”¨ extends å…³é”®å­—æ‰©å±•å…¶ä»–ç±»å‹ï¼Œè€Œäº¤å‰ç±»å‹ä½¿ç”¨ç±»å‹åˆ«åå®šä¹‰ã€‚æ¥å£ä¸äº¤å‰ç±»å‹ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯å¦‚ä½•å¤„ç†å†²çªï¼Œè¿™ä¸ªåŒºåˆ«é€šå¸¸æ˜¯åœ¨é€‰æ‹©ä¸€ä¸ªæ¥å£æˆ–è€…ç±»å‹åˆ«åçš„æ—¶å€™ï¼Œæ¥å£æˆ–è€…ç±»å‹åˆ«åæ˜¯å¦æ›´å¥½ã€‚\nè¿™ä¸¤ç§æ–¹å¼åœ¨åˆå¹¶ç±»å‹ä¸Šçœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œä½†å®é™…ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤§çš„ä¸åŒã€‚æœ€åŸåˆ™æ€§çš„ä¸åŒå°±æ˜¯åœ¨äºå†²çªæ€ä¹ˆå¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯ä½ å†³å®šé€‰æ‹©é‚£ç§æ–¹å¼çš„ä¸»è¦åŸå› ã€‚\ninterface Colorful &#123;\n  color: string;\n&#125;\n\ninterface ColorfulSub extends Colorful &#123;\n  color: number;\n&#125;\n&#x2F;&#x2F; Interface &#39;ColorfulSub&#39; incorrectly extends interface &#39;Colorful&#39;.\n&#x2F;&#x2F; Types of property &#39;color&#39; are incompatible.\n&#x2F;&#x2F; Type &#39;number&#39; is not assignable to type &#39;string&#39;.\n\nä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œå¦‚æœé‡å†™ç±»å‹ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œä½†äº¤å‰ç±»å‹ä¸ä¼šï¼š\ninterface Colorful &#123;\n  color: string;\n&#125;\n\ntype ColorfulSub &#x3D; Colorful &amp; &#123;\n  color: number;\n&#125;;\n\nè™½ç„¶ä¸ä¼šæŠ¥é”™ï¼Œé‚£ color å±æ€§çš„ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Œç­”æ¡ˆæ˜¯ neverï¼Œå–å¾—æ˜¯ string å’Œ number çš„äº¤é›†ã€‚\nGeneric Object Typesæ³›å‹å¯¹è±¡ç±»å‹Letâ€™s imagine a Box type that can contain any value - strings, numbers, Giraffes, whatever.æƒ³æƒ³ä¸€ä¸ªå¯ä»¥åŒ…å«ä»»ä½•å€¼çš„ç›’å­ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€ç‹®å­ç­‰ã€‚\ninterface Box &#123;\n  contents: any;\n&#125;\n\nRight now, the contents property is typed as any, which works, but can lead to accidents down the line.ç°åœ¨ï¼Œcontents å±æ€§æ˜¯ä»»æ„ç±»å‹ï¼Œè¿™å°±å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯æœ‰å¯èƒ½ä¼šåœ¨æœªæ¥å‡ºç°æ„å¤–ã€‚We could instead use unknown, but that would mean that in cases where we already know the type of contents, weâ€™d need to do precautionary checks, or use error-prone type assertions.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ unknownï¼Œä½†æ˜¯è¿™ä¼šå¯¼è‡´åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“ contents çš„ç±»å‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›é¢„é˜²æ€§æ£€æŸ¥ï¼Œæˆ–è€…ä½¿ç”¨é”™è¯¯æ€§çš„ç±»å‹æ–­è¨€ã€‚\ninterface Box &#123;\n  contents: unknown;\n&#125;\n\nlet x: Box &#x3D; &#123;\n  contents: &quot;hello world&quot;,\n&#125;;\n\n&#x2F;&#x2F; we could check &#39;x.contents&#39;\nif (typeof x.contents &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n  console.log(x.contents.toLowerCase());\n&#125;\n\n&#x2F;&#x2F; or we could use a type assertion\nconsole.log((x.contents as string).toLowerCase());\n\nOne type safe approach would be to instead scaffold out different Box types for every type of contents.ä¸€ç§å®‰å…¨çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠä¸åŒçš„ç›’å­ç±»å‹ç”¨äºä¸åŒçš„ç±»å‹çš„å†…å®¹ã€‚\ninterface NumberBox &#123;\n  contents: number;\n&#125;\n\ninterface StringBox &#123;\n  contents: string;\n&#125;\n\ninterface BooleanBox &#123;\n  contents: boolean;\n&#125;\n\nBut that means weâ€™ll have to create different functions, or overloads of functions, to operate on these types.ä½†æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸åŒçš„å‡½æ•°ï¼Œæˆ–è€…é‡è½½å‡½æ•°ï¼Œæ¥æ“ä½œè¿™äº›ç±»å‹ã€‚\nfunction setContents(box: StringBox, newContents: string): void;\nfunction setContents(box: NumberBox, newContents: number): void;\nfunction setContents(box: BooleanBox, newContents: boolean): void;\nfunction setContents(box: &#123; contents: any &#125;, newContents: any) &#123;\n  box.contents &#x3D; newContents;\n&#125;\n\nThatâ€™s a lot of boilerplate. Moreover, we might later need to introduce new types and overloads. This is frustrating, since our box types and overloads are all effectively the same.è¿™å°±æ˜¯ä¸€å¤§å †çš„çƒ§é¥¼ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æœªæ¥æ·»åŠ æ–°çš„ç±»å‹å’Œé‡è½½ã€‚è¿™æ˜¯å›°éš¾çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›’å­ç±»å‹å’Œé‡è½½éƒ½æ˜¯ä¸€æ ·çš„ã€‚Instead, we can make a generic Box type which declares a type parameter.è€Œä¸æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç›’å­ç±»å‹å˜æˆæ³›å‹ç±»å‹ï¼Œå®ƒå£°æ˜äº†ä¸€ä¸ªç±»å‹å‚æ•°ã€‚\ninterface Box&lt;Type&gt; &#123;\n  contents: Type;\n&#125;\n\nYou might read this as â€œA Box of Type is something whose contents have type Typeâ€. Later on, when we refer to Box, we have to give a type argument in place of Type.ä½ å¯ä»¥è¯»è¿™ä¸ªä¸ºâ€œä¸€ä¸ªç±»å‹ä¸º Type çš„ç›’å­â€ã€‚ä¹‹åï¼Œå½“æˆ‘ä»¬å¼•ç”¨ Box æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç»™å®ƒä¸€ä¸ªç±»å‹å‚æ•°ã€‚\nlet box: Box&lt;string&gt;;\n\nThink of Box as a template for a real type, where Type is a placeholder that will get replaced with some other type. When TypeScript sees Box, it will replace every instance of Type in Box with string, and end up working with something like { contents: string }. In other words, Box and our earlier StringBox work identically.æƒ³æƒ³ Box&lt;string&gt; å’Œ StringBox ç±»å‹ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€æ ·çš„ã€‚\ninterface Box&lt;Type&gt; &#123;\ncontents: Type;\n&#125;\ninterface StringBox &#123;\ncontents: string;\n&#125;\n\nlet boxA: Box&lt;string&gt; &#x3D; &#123; contents: &quot;hello&quot; &#125;;\nboxA.contents;\n\n(property) Box&lt;string&gt;.contents: string\n\nlet boxB: StringBox &#x3D; &#123; contents: &quot;world&quot; &#125;;\nboxB.contents;\n\n(property) StringBox.contents: string\n\nBox is reusable in that Type can be substituted with anything. That means that when we need a box for a new type, we donâ€™t need to declare a new Box type at all (though we certainly could if we wanted to).Box å¯ä»¥é‡ç”¨ï¼Œå› ä¸º Type å¯ä»¥è¢«æ›¿æ¢æˆä»»ä½•ç±»å‹ã€‚\ninterface Box&lt;Type&gt; &#123;\n  contents: Type;\n&#125;\n\ninterface Apple &#123;\n  &#x2F;&#x2F; ....\n&#125;\n\n&#x2F;&#x2F; Same as &#39;&#123; contents: Apple &#125;&#39;.\ntype AppleBox &#x3D; Box&lt;Apple&gt;;\n\nThis also means that we can avoid overloads entirely by instead using generic functions.\nfunction setContents&lt;Type&gt;(box: Box&lt;Type&gt;, newContents: Type) &#123;\n  box.contents &#x3D; newContents;\n&#125;\n\nIt is worth noting that type aliases can also be generic. We could have defined our new Box interface, which was:æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„ç›’å­ç±»å‹ï¼Œå®ƒæ˜¯ï¼š\ninterface Box&lt;Type&gt; &#123;\n  contents: Type;\n&#125;\n\nby using a type alias instead:ä½¿ç”¨ç±»å‹åˆ«åæ¥ä»£æ›¿ï¼š\ntype Box&lt;Type&gt; &#x3D; &#123;\n  contents: Type;\n&#125;;\n\nSince type aliases, unlike interfaces, can describe more than just object types, we can also use them to write other kinds of generic helper types.ç±»å‹åˆ«åï¼Œè·Ÿæ¥å£ä¸åŒï¼Œå®ƒå¯ä»¥æè¿°é™¤äº†å¯¹è±¡ç±»å‹ä¹‹å¤–çš„å…¶ä»–ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥å†™å…¶ä»–ç±»å‹çš„è¾…åŠ©ç±»å‹ã€‚\ntype OrNull&lt;Type&gt; &#x3D; Type | null;\n\ntype OneOrMany&lt;Type&gt; &#x3D; Type | Type[];\n\n&#x2F;&#x2F; è¿™ç»„ç»“æœä¸€æ ·\ntype OneOrManyOrNull&lt;Type&gt; &#x3D; OrNull&lt;OneOrMany&lt;Type&gt;&gt;;\ntype OneOrManyOrNull&lt;Type&gt; &#x3D; OneOrMany&lt;Type&gt; | null;\n\n&#x2F;&#x2F; è¿™ç»„ç»“æœä¸€æ ·\ntype OneOrManyOrNullStrings &#x3D; OneOrManyOrNull&lt;string&gt;;\ntype OneOrManyOrNullStrings &#x3D; OneOrMany&lt;string&gt; | null;\n\nWeâ€™ll circle back to type aliases in just a little bit.æˆ‘ä»¬ä¼šåœ¨ç¨åå›åˆ°ç±»å‹åˆ«åã€‚\nThe Array Typeæ•°ç»„ç±»å‹Generic object types are often some sort of container type that work independently of the type of elements they contain. Itâ€™s ideal for data structures to work this way so that theyâ€™re re-usable across different data types.æ³›å‹å¯¹è±¡ç±»å‹é€šå¸¸æ˜¯ä¸€ç§å¯ä»¥ç‹¬ç«‹äºå…¶åŒ…å«å…ƒç´ çš„ç±»å‹çš„å®¹å™¨ç±»å‹ã€‚è¿™æ ·ï¼Œå®ƒä»¬å¯ä»¥åœ¨ä¸åŒçš„æ•°æ®ç±»å‹ä¹‹é—´é‡ç”¨ã€‚It turns out weâ€™ve been working with a type just like that throughout this handbook: the Array type. Whenever we write out types like number[] or string[], thatâ€™s really just a shorthand for Array and Array.æˆ‘ä»¬åœ¨è¿™æœ¬æ‰‹å†Œä¸­å·²ç»ä½¿ç”¨è¿‡ä¸€æ ·çš„ç±»å‹ï¼šæ•°ç»„ç±»å‹ã€‚\nfunction doSomething(value: Array&lt;string&gt;) &#123;\n  &#x2F;&#x2F; ...\n&#125;\n\nlet myArray: string[] &#x3D; [&quot;hello&quot;, &quot;world&quot;];\n\n&#x2F;&#x2F; either of these work!\ndoSomething(myArray);\ndoSomething(new Array(&quot;hello&quot;, &quot;world&quot;));\n\nMuch like the Box type above, Array itself is a generic type.æ•°ç»„æœ¬èº«æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ã€‚\ninterface Array&lt;Type&gt; &#123;\n  &#x2F;**\n   * Gets or sets the length of the array.\n   *&#x2F;\n  length: number;\n\n  &#x2F;**\n   * Removes the last element from an array and returns it.\n   *&#x2F;\n  pop(): Type | undefined;\n\n  &#x2F;**\n   * Appends new elements to an array, and returns the new length of the array.\n   *&#x2F;\n  push(...items: Type[]): number;\n\n  &#x2F;&#x2F; ...\n&#125;\n\nModern JavaScript also provides other data structures which are generic, like Map&lt;K, V&gt;, Set, and Promise. All this really means is that because of how Map, Set, and Promise behave, they can work with any sets of types.ç°ä»£ JavaScript ä¹Ÿæä¾›äº†å…¶ä»–çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚ Map&lt;K, V&gt;, Set&lt;T&gt;, Promise&lt;T&gt;ã€‚\nThe ReadonlyArray Typeåªè¯»æ•°ç»„ç±»å‹\nThe ReadonlyArray is a special type that describes arrays that shouldnâ€™t be changed.åªè¯»æ•°ç»„æ˜¯ä¸€ä¸ªæè¿°ä¸èƒ½è¢«ä¿®æ”¹çš„æ•°ç»„çš„ç‰¹æ®Šç±»å‹ã€‚\nfunction doStuff(values: ReadonlyArray&lt;string&gt;) &#123;\n  &#x2F;&#x2F; We can read from &#39;values&#39;...\n  const copy &#x3D; values.slice();\n  console.log(&#96;The first value is $&#123;values[0]&#125;&#96;);\n\n  &#x2F;&#x2F; ...but we can&#39;t mutate &#39;values&#39;.\n  values.push(&quot;hello!&quot;);\n  &#x2F;&#x2F; Property &#39;push&#39; does not exist on type &#39;readonly string[]&#39;.\n&#125;\n\nMuch like the readonly modifier for properties, itâ€™s mainly a tool we can use for intent. When we see a function that returns ReadonlyArrays, it tells us weâ€™re not meant to change the contents at all, and when we see a function that consumes ReadonlyArrays, it tells us that we can pass any array into that function without worrying that it will change its contents.ReadonlyArray ä¸»è¦æ˜¯ç”¨æ¥åšæ„å›¾å£°æ˜ã€‚å½“æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå‡½æ•°è¿”å› ReadonlyArrayï¼Œå°±æ˜¯åœ¨å‘Šè¯‰æˆ‘ä»¬ä¸èƒ½å»æ›´æ”¹å…¶ä¸­çš„å†…å®¹ï¼Œå½“æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå‡½æ•°æ”¯æŒä¼ å…¥ ReadonlyArray ï¼Œè¿™æ˜¯åœ¨å‘Šè¯‰æˆ‘ä»¬æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒçš„ä¼ å…¥æ•°ç»„åˆ°å‡½æ•°ä¸­ï¼Œè€Œä¸ç”¨æ‹…å¿ƒä¼šæ”¹å˜æ•°ç»„çš„å†…å®¹ã€‚Unlike Array, there isnâ€™t a ReadonlyArray constructor that we can use.ä¸åƒ Arrayï¼ŒReadonlyArray å¹¶ä¸æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨çš„æ„é€ å™¨å‡½æ•°ã€‚\nnew ReadonlyArray(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;);\n&#39;ReadonlyArray&#39; only refers to a type, but is being used as a value here.\n\nInstead, we can assign regular Arrays to ReadonlyArrays.ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä¸€ä¸ªå¸¸è§„æ•°ç»„èµ‹å€¼ç»™ ReadonlyArrayã€‚\nconst roArray: ReadonlyArray&lt;string&gt; &#x3D; [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;];\n\nJust as TypeScript provides a shorthand syntax for Array with Type[], it also provides a shorthand syntax for ReadonlyArray with readonly Type[].TypeScript ä¹Ÿé’ˆå¯¹ ReadonlyArray&lt;Type&gt; æä¾›äº†æ›´ç®€çŸ­çš„å†™æ³• readonly Type[]ã€‚\nfunction doStuff(values: readonly string[]) &#123;\n  &#x2F;&#x2F; We can read from &#39;values&#39;...\n  const copy &#x3D; values.slice();\n  console.log(&#96;The first value is $&#123;values[0]&#125;&#96;);\n\n  &#x2F;&#x2F; ...but we can&#39;t mutate &#39;values&#39;.\n  values.push(&quot;hello!&quot;);\n  &#x2F;&#x2F; Property &#39;push&#39; does not exist on type &#39;readonly string[]&#39;.\n&#125;\n\nOne last thing to note is that unlike the readonly property modifier, assignability isnâ€™t bidirectional between regular Arrays and ReadonlyArrays.æœ€åæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå°±æ˜¯ Arrays å’Œ ReadonlyArray å¹¶ä¸èƒ½åŒå‘çš„èµ‹å€¼ï¼š\nlet x: readonly string[] &#x3D; [];\nlet y: string[] &#x3D; [];\n\nx &#x3D; y; &#x2F;&#x2F; ok\ny &#x3D; x;\n&#x2F;&#x2F; The type &#39;readonly string[]&#39; is &#39;readonly&#39; and cannot be assigned to the mutable type &#39;string[]&#39;.\n\nTuple TypesA tuple type is another sort of Array type that knows exactly how many elements it contains, and exactly which types it contains at specific positions.å…ƒç»„ç±»å‹æ˜¯å¦å¤–ä¸€ç§ Array ç±»å‹ï¼Œå½“ä½ æ˜ç¡®çŸ¥é“æ•°ç»„åŒ…å«å¤šå°‘ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”æ¯ä¸ªä½ç½®å…ƒç´ çš„ç±»å‹éƒ½æ˜ç¡®çŸ¥é“çš„æ—¶å€™ï¼Œå°±é€‚åˆä½¿ç”¨å…ƒç»„ç±»å‹ã€‚\ntype StringNumberPair &#x3D; [string, number];\n\nHere, StringNumberPair is a tuple type of string and number. Like ReadonlyArray, it has no representation at runtime, but is significant to TypeScript. To the type system, StringNumberPair describes arrays whose 0 index contains a string and whose 1 index contains a number.åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒStringNumberPair å°±æ˜¯ string å’Œ number çš„å…ƒç»„ç±»å‹ã€‚\nè·Ÿ ReadonlyArray ä¸€æ ·ï¼Œå®ƒå¹¶ä¸ä¼šåœ¨è¿è¡Œæ—¶äº§ç”Ÿå½±å“ï¼Œä½†æ˜¯å¯¹ TypeScript å¾ˆæœ‰æ„ä¹‰ã€‚å› ä¸ºå¯¹äºç±»å‹ç³»ç»Ÿï¼ŒStringNumberPair æè¿°äº†ä¸€ä¸ªæ•°ç»„ï¼Œç´¢å¼• 0 çš„å€¼çš„ç±»å‹æ˜¯ stringï¼Œç´¢å¼• 1 çš„å€¼çš„ç±»å‹æ˜¯ numberã€‚\nfunction doSomething(pair: [string, number]) &#123;\n  const a &#x3D; pair[0];\n\n  const a: string;\n  const b &#x3D; pair[1];\n\n  const b: number;\n  &#x2F;&#x2F; ...\n&#125;\n\ndoSomething([&quot;hello&quot;, 42]);\n\nIf we try to index past the number of elements, weâ€™ll get an error.å¦‚æœè¦è·å–å…ƒç´ æ•°é‡ä¹‹å¤–çš„å…ƒç´ ï¼ŒTypeScript ä¼šæç¤ºé”™è¯¯ï¼š\nfunction doSomething(pair: [string, number]) &#123;\n  &#x2F;&#x2F; ...\n\n  const c &#x3D; pair[2];\n  &#x2F;&#x2F; Tuple type &#39;[string, number]&#39; of length &#39;2&#39; has no element at index &#39;2&#39;.\n&#125;\n\nWe can also destructure tuples using JavaScriptâ€™s array destructuring.æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ JavaScript çš„æ•°ç»„è§£æ„è¯­æ³•è§£æ„å…ƒç»„ï¼š\nfunction doSomething(stringHash: [string, number]) &#123;\n  const [inputString, hash] &#x3D; stringHash;\n\n  console.log(inputString);\n\n  &#x2F;&#x2F; const inputString: string;\n\n  console.log(hash);\n\n  &#x2F;&#x2F; const hash: number;\n&#125;\n\n\n\n\n\n\n\n\n\n\nTuple types are useful in heavily convention-based APIs, where each elementâ€™s meaning is â€œobviousâ€. This gives us flexibility in whatever we want to name our variables when we destructure them. In the above example, we were able to name elements 0 and 1 to whatever we wanted.å…ƒç»„ç±»å‹åœ¨é‡åº¦ä¾èµ–çº¦å®šçš„ API ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šè®©æ¯ä¸ªå…ƒç´ çš„æ„ä¹‰éƒ½å¾ˆæ˜æ˜¾ã€‚å½“æˆ‘ä»¬è§£æ„çš„æ—¶å€™ï¼Œå…ƒç»„ç»™äº†æˆ‘ä»¬å‘½åå˜é‡çš„è‡ªç”±åº¦ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘½åå…ƒç´  0 å’Œ 1 ä¸ºæˆ‘ä»¬æƒ³è¦çš„åå­—ã€‚However, since not every user holds the same view of whatâ€™s obvious, it may be worth reconsidering whether using objects with descriptive property names may be better for your API.ç„¶è€Œï¼Œä¹Ÿä¸æ˜¯æ¯ä¸ªç”¨æˆ·éƒ½è¿™æ ·è®¤ä¸ºï¼Œæ‰€ä»¥æœ‰çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰æè¿°å±æ€§åå­—çš„å¯¹è±¡ä¹Ÿè®¸æ˜¯ä¸ªæ›´å¥½çš„æ–¹å¼ã€‚Other than those length checks, simple tuple types like these are equivalent to types which are versions of Arrays that declare properties for specific indexes, and that declare length with a numeric literal type.é™¤äº†é•¿åº¦æ£€æŸ¥ï¼Œç®€å•çš„å…ƒç»„ç±»å‹è·Ÿå£°æ˜äº† length å±æ€§å’Œå…·ä½“çš„ç´¢å¼•å±æ€§çš„ Array æ˜¯ä¸€æ ·çš„ã€‚\ninterface StringNumberPair &#123;\n  &#x2F;&#x2F; specialized properties\n  length: 2;\n  0: string;\n  1: number;\n\n  &#x2F;&#x2F; Other &#39;Array&lt;string | number&gt;&#39; members...\n  slice(start?: number, end?: number): Array&lt;string | number&gt;;\n&#125;\n\nAnother thing you may be interested in is that tuples can have optional properties by writing out a question mark (? after an elementâ€™s type). Optional tuple elements can only come at the end, and also affect the type of length.åœ¨å…ƒç»„ç±»å‹ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªå¯é€‰å±æ€§ï¼Œä½†å¯é€‰å…ƒç´ å¿…é¡»åœ¨æœ€åé¢ï¼Œè€Œä¸”ä¹Ÿä¼šå½±å“ç±»å‹çš„ length ã€‚\ntype Either2dOr3d &#x3D; [number, number, number?];\n\nfunction setCoordinate(coord: Either2dOr3d) &#123;\n  const [x, y, z] &#x3D; coord;\n\n  const z: number | undefined;\n\n  console.log(&#96;Provided coordinates had $&#123;coord.length&#125; dimensions&#96;);\n\n  &#x2F;&#x2F; (property) length: 2 | 3\n&#125;\n\nTuples can also have rest elements, which have to be an array&#x2F;tuple type.Tuples ä¹Ÿå¯ä»¥ä½¿ç”¨å‰©ä½™å…ƒç´ è¯­æ³•ï¼Œä½†å¿…é¡»æ˜¯ array/tuple ç±»å‹ï¼š\ntype StringNumberBooleans &#x3D; [string, number, ...boolean[]];\ntype StringBooleansNumber &#x3D; [string, ...boolean[], number];\ntype BooleansStringNumber &#x3D; [...boolean[], string, number];\n\n\nStringNumberBooleans describes a tuple whose first two elements are string and number respectively, but which may have any number of booleans following.æè¿°ä¸€ä¸ªå…ƒç»„ï¼Œå‰ä¸¤ä¸ªæ˜¯å­—ç¬¦ä¸²å’Œæ•°å€¼ï¼Œåé¢æ˜¯boolean\nStringBooleansNumber describes a tuple whose first element is string and then any number of booleans and ending with a number.æè¿°ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²ï¼Œæœ€åä¸€ä¸ªæ˜¯æ•°å€¼ï¼Œä¸­é—´æœ‰ä»»æ„å¤šä¸ªbooleanç±»å‹\nBooleansStringNumber describes a tuple whose starting elements are any number of booleans and ending with a string then a number.æè¿°ä¸€ä¸ªå…ƒç»„ï¼Œæœ€åä¸¤ä¸ªæ˜¯stringã€numberA tuple with a rest element has no set â€œlengthâ€ - it only has a set of well-known elements in different positions.æœ‰å‰©ä½™å…ƒç´ çš„å…ƒç»„å¹¶ä¸ä¼šè®¾ç½® lengthï¼Œå› ä¸ºå®ƒåªçŸ¥é“åœ¨ä¸åŒä½ç½®ä¸Šçš„å·²çŸ¥å…ƒç´ ä¿¡æ¯ï¼š\n\nconst a: StringNumberBooleans &#x3D; [&quot;hello&quot;, 1];\nconst b: StringNumberBooleans &#x3D; [&quot;beautiful&quot;, 2, true];\nconst c: StringNumberBooleans &#x3D; [&quot;world&quot;, 3, true, false, true, false, true];\n\nWhy might optional and rest elements be useful? Well, it allows TypeScript to correspond tuples with parameter lists. Tuples types can be used in rest parameters and arguments, so that the following:å¯é€‰å…ƒç´ å’Œå‰©ä½™å…ƒç´ çš„å­˜åœ¨ï¼Œä½¿å¾— TypeScript å¯ä»¥åœ¨å‚æ•°åˆ—è¡¨é‡Œä½¿ç”¨å…ƒç»„ï¼Œå°±åƒè¿™æ ·ï¼š\nfunction readButtonInput(...args: [string, number, ...boolean[]]) &#123;\n  const [name, version, ...input] &#x3D; args;\n  &#x2F;&#x2F; ...\n&#125;\n\nis basically equivalent to:åŸºæœ¬ç­‰åŒäºï¼š\nfunction readButtonInput(name: string, version: number, ...input: boolean[]) &#123;\n  &#x2F;&#x2F; ...\n&#125;\n\nThis is handy when you want to take a variable number of arguments with a rest parameter, and you need a minimum number of elements, but you donâ€™t want to introduce intermediate variables.\nreadonly Tuple Typesåªè¯»å…ƒç»„ç±»å‹One final note about tuple types - tuples types have readonly variants, and can be specified by sticking a readonly modifier in front of them - just like with array shorthand syntax.å…ƒç»„ç±»å‹ä¹Ÿæ˜¯å¯ä»¥è®¾ç½® readonly çš„ï¼š\nfunction doSomething(pair: readonly [string, number]) &#123;\n  &#x2F;&#x2F; ...\n&#125;\n\nAs you might expect, writing to any property of a readonly tuple isnâ€™t allowed in TypeScript.è¿™æ · TypeScript å°±ä¸ä¼šå…è®¸å†™å…¥readonly å…ƒç»„çš„ä»»ä½•å±æ€§ï¼š\nfunction doSomething(pair: readonly [string, number]) &#123;\n  pair[0] &#x3D; &quot;hello!&quot;;\n  &#x2F;&#x2F; Cannot assign to &#39;0&#39; because it is a read-only property.\n&#125;\n\nTuples tend to be created and left un-modified in most code, so annotating types as readonly tuples when possible is a good default. This is also important given that array literals with const assertions will be inferred with readonly tuple types.åœ¨å¤§éƒ¨åˆ†çš„ä»£ç ä¸­ï¼Œå…ƒç»„åªæ˜¯è¢«åˆ›å»ºï¼Œä½¿ç”¨å®Œåä¹Ÿä¸ä¼šè¢«ä¿®æ”¹ï¼Œæ‰€ä»¥å°½å¯èƒ½çš„å°†å…ƒç»„è®¾ç½®ä¸º readonly æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚å¦‚æœæˆ‘ä»¬ç»™ä¸€ä¸ªæ•°ç»„å­—é¢é‡ const æ–­è¨€ï¼Œä¹Ÿä¼šè¢«æ¨æ–­ä¸º readonly å…ƒç»„ç±»å‹ã€‚\nlet point &#x3D; [3, 4] as const;\n\nfunction distanceFromOrigin([x, y]: [number, number]) &#123;\n  return Math.sqrt(x ** 2 + y ** 2);\n&#125;\n\ndistanceFromOrigin(point);\n&#x2F;&#x2F; Argument of type &#39;readonly [3, 4]&#39; is not assignable to parameter of type &#39;[number, number]&#39;.\n&#x2F;&#x2F; The type &#39;readonly [3, 4]&#39; is &#39;readonly&#39; and cannot be assigned to the mutable type &#39;[number, number]&#39;.\n\nHere, distanceFromOrigin never modifies its elements, but expects a mutable tuple. Since pointâ€™s type was inferred as readonly [3, 4], it wonâ€™t be compatible with [number, number] since that type canâ€™t guarantee pointâ€™s elements wonâ€™t be mutated.å°½ç®¡ distanceFromOrigin å¹¶æ²¡æœ‰æ›´æ”¹ä¼ å…¥çš„å…ƒç´ ï¼Œä½†å‡½æ•°å¸Œæœ›ä¼ å…¥ä¸€ä¸ªå¯å˜å…ƒç»„ã€‚å› ä¸º point çš„ç±»å‹è¢«æ¨æ–­ä¸º readonly [3, 4]ï¼Œå®ƒè·Ÿ [number number] å¹¶ä¸å…¼å®¹ï¼Œæ‰€ä»¥ TypeScript ç»™äº†ä¸€ä¸ªæŠ¥é”™ã€‚\n","slug":"2022-06-08ts-object-types","date":"2022-06-08T01:21:19.000Z","categories_index":"","tags_index":"","author_index":"é™ˆæµ·é¾™"},{"id":"2af24e4e300095206fecfdff43a1494d","title":"5.Typescriptæ‰‹å†Œ å‡½æ•°","content":"","slug":"2022-06-08ts-more-on-functions","date":"2022-06-07T13:21:19.000Z","categories_index":"","tags_index":"","author_index":"é™ˆæµ·é¾™"},{"id":"aab722f3fd65a7516918bd7fed1d7d01","title":"4.Typescriptæ‰‹å†Œ æ”¶ç¼©ç±»å‹","content":"Narrowingç¼©å°èŒƒå›´\nImagine we have a function called padLeft.è¯•æƒ³æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åä¸º padLeftï¼š\nfunction padLeft(padding: number | string, input: string): string &#123;\n  throw new Error(&quot;Not implemented yet!&quot;);\n&#125;\n\nIf padding is a number, it will treat that as the number of spaces we want to prepend to input. If padding is a string, it should just prepend padding to input. Letâ€™s try to implement the logic for when padLeft is passed a number for padding.\nå¦‚æœ padding æ˜¯æ•°å­—ï¼Œå®ƒå°†ä¼šå°† padding è§†ä¸ºæˆ‘ä»¬è¦æ·»åŠ çš„ç©ºæ ¼æ•°é‡ï¼Œå¦‚æœ padding æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šæ·»åŠ  padding åˆ° input çš„å‰é¢ã€‚\nfunction padLeft(padding: number | string, input: string) &#123;\n  return &quot; &quot;.repeat(padding) + input;\n  &#x2F;&#x2F; Argument of type &#39;string | number&#39; is not assignable to parameter of type &#39;number&#39;.\n  &#x2F;&#x2F; å‚æ•°ç±»å‹ &#39;string | number&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;number&#39;ã€‚\n  &#x2F;&#x2F; Type &#39;string&#39; is not assignable to type &#39;number&#39;.\n  &#x2F;&#x2F; ç±»å‹ &#39;string&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;number&#39;ã€‚\n&#125;\n\nUh-oh, weâ€™re getting an error on padding.å“‡ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œpaddingã€‚TypeScript is warning us that adding a number | string to a number might not give us what we want, and itâ€™s right. In other words, we havenâ€™t explicitly checked if padding is a number first, nor are we handling the case where itâ€™s a string, so letâ€™s do exactly that.è¿™æ˜¯ TypeScript åœ¨è­¦å‘Šæˆ‘ä»¬ï¼Œå¦‚æœæŠŠä¸€ä¸ª number ç±»å‹ (å³ä¾‹å­é‡Œçš„æ•°å­— 1 )å’Œä¸€ä¸ª number | string ç±»å‹ç›¸åŠ ï¼Œä¹Ÿè®¸å¹¶ä¸ä¼šè¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆæ£€æŸ¥ä¸‹ padding æ˜¯å¦æ˜¯ä¸€ä¸ª numberï¼Œæˆ–è€…å¤„ç†ä¸‹å½“ padding æ˜¯ string çš„æƒ…å†µï¼Œé‚£æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š\nfunction padLeft(padding: number | string, input: string) &#123;\n  if (typeof padding &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;\n    return &quot; &quot;.repeat(padding) + input;\n  &#125;\n  return padding + input;\n&#125;\n\nIf this mostly looks like uninteresting JavaScript code, thatâ€™s sort of the point. Apart from the annotations we put in place, this TypeScript code looks like JavaScript. The idea is that TypeScriptâ€™s type system aims to make it as easy as possible to write typical JavaScript code without bending over backwards to get type safety.å¦‚æœè¿™ä¸ªä»£ç çœ‹èµ·æ¥æ²¡æœ‰ä»€ä¹ˆæ„æ€ï¼Œé‚£å°±æ˜¯ TypeScript çš„ç±»å‹ç³»ç»Ÿå¸Œæœ›æˆ‘ä»¬èƒ½å†™å‡ºä¸€äº›æ¯”è¾ƒæ™®é€šçš„ JavaScript ä»£ç ï¼Œè€Œä¸æ˜¯æŠ˜è…¾è‡³æœ€åæ‰çŸ¥é“ç±»å‹å®‰å…¨ã€‚While it might not look like much, thereâ€™s actually a lot going under the covers here. Much like how TypeScript analyzes runtime values using static types, it overlays type analysis on JavaScriptâ€™s runtime control flow constructs like if&#x2F;else, conditional ternaries, loops, truthiness checks, etc., which can all affect those types.è¿™é‡Œçš„å®ç°æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å®ƒçœŸçš„æ˜¯ä¸€ä¸ªç±»å‹æ£€æŸ¥å™¨ï¼Œå®ƒä¼šåœ¨ JavaScript ä¸­çš„ if/elseã€æ¡ä»¶è¡¨è¾¾å¼ã€å¾ªç¯ã€çœŸå‡å€¼æ£€æŸ¥ç­‰æ§åˆ¶æµä¸­è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚Within our if check, TypeScript sees typeof padding &#x3D;&#x3D;&#x3D; â€œnumberâ€ and understands that as a special form of code called a type guard. TypeScript follows possible paths of execution that our programs can take to analyze the most specific possible type of a value at a given position. It looks at these special checks (called type guards) and assignments, and the process of refining types to more specific types than declared is called narrowing. In many editors we can observe these types as they change, and weâ€™ll even do so in our examples.åœ¨æˆ‘ä»¬çš„ if æ£€æŸ¥ä¸­ï¼ŒTypeScript ä¼šçœ‹åˆ° typeof padding === &quot;number&quot;ï¼Œå¹¶ä¸”ä¼šè§£é‡Šè¿™ä¸ªè¡¨è¾¾å¼ä¸ºä¸€ä¸ªç‰¹æ®Šçš„ä»£ç ï¼Œè¿™ä¸ªä»£ç è¢«ç§°ä¸ºç±»å‹æ£€æŸ¥ã€‚TypeScript ä¼šæ ¹æ®æˆ‘ä»¬çš„ç¨‹åºçš„æ‰§è¡Œæµï¼Œæ¥æ£€æŸ¥ä¸€ä¸ªå€¼çš„æœ€å…·ä½“çš„ç±»å‹ã€‚è¿™äº›ç‰¹æ®Šçš„æ£€æŸ¥ï¼ˆç§°ä¸ºç±»å‹æ£€æŸ¥ï¼‰å’Œèµ‹å€¼ï¼Œä¼šå½±å“åˆ°ç±»å‹çš„ç²¾ç¡®æ€§ã€‚åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™äº›ç±»å‹çš„å˜åŒ–ï¼Œæˆ‘ä»¬ä¹Ÿä¼šåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­çœ‹åˆ°ã€‚\nfunction padLeft(padding: number | string, input: string) &#123;\n  if (typeof padding &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;\n    return &quot; &quot;.repeat(padding) + input;\n\n    &#x2F;&#x2F; (parameter) padding: number\n  &#125;\n  return padding + input;\n\n  &#x2F;&#x2F; (parameter) padding: string\n&#125;\n\nThere are a couple of different constructs TypeScript understands for narrowing.TypeScript ä¼šç†è§£ä¸€äº›æ›´åŠ ç²¾ç¡®çš„æ„é€ ã€‚\ntypeof type guardsç±»å‹ä¿æŠ¤\nAs weâ€™ve seen, JavaScript supports a typeof operator which can give very basic information about the type of values we have at runtime. TypeScript expects this to return a certain set of strings:JavaScript æ”¯æŒä¸€ä¸ª typeof æ“ä½œç¬¦ï¼Œå®ƒå¯ä»¥ç»™æˆ‘ä»¬çš„å€¼è¿”å›ä¸€äº›åŸºæœ¬çš„ä¿¡æ¯ã€‚TypeScript æœŸæœ›è¿™äº›ä¿¡æ¯æ˜¯ä¸€ä¸ªç‰¹å®šçš„é›†åˆï¼š\nâ€œstringâ€â€œnumberâ€â€œbigintâ€â€œbooleanâ€â€œsymbolâ€â€œundefinedâ€â€œobjectâ€â€œfunctionâ€\nLike we saw with padLeft, this operator comes up pretty often in a number of JavaScript libraries, and TypeScript can understand it to narrow types in different branches.å’Œ padLeft ä¸€æ ·ï¼Œè¿™ä¸ªæ“ä½œç¬¦åœ¨ JavaScript åº“ä¸­å¾ˆå¸¸è§ï¼ŒTypeScript å¯ä»¥ç†è§£å®ƒæ¥ç¼©å°ä¸åŒçš„åˆ†æ”¯çš„ç±»å‹ã€‚In TypeScript, checking against the value returned by typeof is a type guard. Because TypeScript encodes how typeof operates on different values, it knows about some of its quirks in JavaScript. For example, notice that in the list above, typeof doesnâ€™t return the string null. Check out the following example:åœ¨ TypeScript ä¸­ï¼Œæ£€æŸ¥ typeof è¿”å›çš„å€¼å°±æ˜¯ä¸€ç§ç±»å‹ä¿æŠ¤ã€‚TypeScript çŸ¥é“ typeof ä¸åŒå€¼çš„ç»“æœï¼Œå®ƒä¹Ÿèƒ½è¯†åˆ« JavaScript ä¸­ä¸€äº›æ€ªå¼‚çš„åœ°æ–¹ï¼Œå°±æ¯”å¦‚åœ¨ä¸Šé¢çš„åˆ—è¡¨ä¸­ï¼Œtypeof å¹¶æ²¡æœ‰è¿”å›å­—ç¬¦ä¸² nullï¼Œçœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š\nfunction printAll(strs: string | string[] | null) &#123;\n  if (typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;\n    for (const s of strs) &#123;\n      &#x2F;&#x2F; Object is possibly &#39;null&#39;.\n      console.log(s);\n    &#125;\n  &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n    console.log(strs);\n  &#125; else &#123;\n    &#x2F;&#x2F; do nothing\n  &#125;\n&#125;\n\nIn the printAll function, we try to check if strs is an object to see if itâ€™s an array type (now might be a good time to reinforce that arrays are object types in JavaScript). But it turns out that in JavaScript, typeof null is actually â€œobjectâ€! This is one of those unfortunate accidents of history.åœ¨è¿™ä¸ª printAll å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°è¯•åˆ¤æ–­ strs æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŸæœ¬çš„ç›®çš„æ˜¯åˆ¤æ–­å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œä½†æ˜¯åœ¨ JavaScript ä¸­ï¼Œtypeof null ä¹Ÿä¼šè¿”å› objectã€‚è€Œè¿™æ˜¯ JavaScript ä¸€ä¸ªä¸å¹¸çš„å†å²äº‹æ•…ã€‚Users with enough experience might not be surprised, but not everyone has run into this in JavaScript; luckily, TypeScript lets us know that strs was only narrowed down to string[] | null instead of just string[].ç†Ÿç»ƒçš„ç”¨æˆ·è‡ªç„¶ä¸ä¼šæ„Ÿåˆ°æƒŠè®¶ï¼Œä½†ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½å¦‚æ­¤ç†Ÿç»ƒã€‚ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼ŒTypeScript ä¼šè®©æˆ‘ä»¬çŸ¥é“ strs è¢«æ”¶çª„ä¸º strings[] | null ï¼Œè€Œä¸ä»…ä»…æ˜¯ string[]ã€‚This might be a good segue into what weâ€™ll call â€œtruthinessâ€ checking.è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¥½çš„è½¬æŠ˜ç‚¹ã€‚\nTruthiness narrowingçœŸå®æ€§ç¼©å‡\nTruthiness might not be a word youâ€™ll find in the dictionary, but itâ€™s very much something youâ€™ll hear about in JavaScript.çœŸå®æ€§å¯èƒ½ä¸æ˜¯åœ¨å­—å…¸é‡Œé¢æ‰¾åˆ°çš„ï¼Œä½†æ˜¯ä½ ä¼šå¬åˆ° JavaScript ä¸­çš„çœŸå®æ€§ã€‚In JavaScript, we can use any expression in conditionals, &amp;&amp;s, ||s, if statements, Boolean negations (!), and more. As an example, if statements donâ€™t expect their condition to always have the type boolean.è¿™æ˜¯å› ä¸º JavaScript ä¼šåšéšå¼ç±»å‹è½¬æ¢ï¼Œåƒ 0 ã€NaNã€&quot;&quot;ã€0nã€null undefined è¿™äº›å€¼éƒ½ä¼šè¢«è½¬ä¸º falseï¼Œå…¶ä»–çš„å€¼åˆ™ä¼šè¢«è½¬ä¸º trueã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Boolean å‡½æ•°å¼ºåˆ¶è½¬ä¸º boolean å€¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´åŠ ç®€çŸ­çš„!!ï¼š\nfunction getUsersOnlineMessage(numUsersOnline: number) &#123;\n  if (numUsersOnline) &#123;\n    return &#96;There are $&#123;numUsersOnline&#125; online now!&#96;;\n  &#125;\n  return &quot;Nobody&#39;s here. :(&quot;;\n&#125;\n\nIn JavaScript, constructs like if first â€œcoerceâ€ their conditions to booleans to make sense of them, and then choose their branches depending on whether the result is true or false. Values like0ã€NaNã€&quot;&quot;ã€0nã€null undefined è¿™äº›å€¼éƒ½ä¼šè¢«è½¬ä¸º falseï¼Œå…¶ä»–çš„å€¼åˆ™ä¼šè¢«è½¬ä¸º trueã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Boolean å‡½æ•°å¼ºåˆ¶è½¬ä¸º boolean å€¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´åŠ ç®€çŸ­çš„!!ï¼š\n\n0\nNaN\nâ€œâ€ (the empty string)\n0n (the bigint version of zero)\nnull\nundefined\n\nall coerce to false, and other values get coerced true. You can always coerce values to booleans by running them through the Boolean function, or by using the shorter double-Boolean negation. (The latter has the advantage that TypeScript infers a narrow literal boolean type true, while inferring the first as type boolean.)æ‰€æœ‰ è¿™äº›å€¼éƒ½ä¼šè¢«è½¬ä¸º falseï¼Œå…¶ä»–çš„å€¼åˆ™ä¼šè¢«è½¬ä¸º trueã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ Boolean å‡½æ•°å¼ºåˆ¶è½¬ä¸º boolean å€¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´åŠ ç®€çŸ­çš„!!ã€‚(è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScript ä¼šæ¨æ–­ä¸€ä¸ªç®€å•çš„å¸ƒå°”å€¼ç±»å‹ trueï¼Œè€Œä¸æ˜¯ç±»å‹ booleanã€‚)\n&#x2F;&#x2F; both of these result in &#39;true&#39;\nBoolean(&quot;hello&quot;); &#x2F;&#x2F; type: boolean, value: true\n!!&quot;world&quot;; &#x2F;&#x2F; type: true,    value: true\n\nItâ€™s fairly popular to leverage this behavior, especially for guarding against values like null or undefined. As an example, letâ€™s &#96;&#96;&#96;using it for our printAll function.è¿™ç§ä½¿ç”¨æ–¹å¼éå¸¸æµè¡Œï¼Œå°¤å…¶é€‚ç”¨äºé˜²èŒƒ null å’Œ undefiend è¿™ç§å€¼çš„æ—¶å€™ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ printAll å‡½æ•°ä¸­è¿™æ ·ä½¿ç”¨ï¼š\nfunction printAll(strs: string | string[] | null) &#123;\n  if (strs &amp;&amp; typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;\n    for (const s of strs) &#123;\n      console.log(s);\n    &#125;\n  &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n    console.log(strs);\n  &#125;\n&#125;\n\nYouâ€™ll notice that weâ€™ve gotten rid of the error above by checking if strs is truthy. This at least prevents us from dreaded errors when we run our code like:è¿™é‡Œæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬æ£€æŸ¥äº† strs æ˜¯å¦ä¸ºçœŸã€‚è¿™è‡³å°‘é˜²æ­¢äº†æˆ‘ä»¬åœ¨è¿è¡Œä»£ç æ—¶å‡ºç°çš„é”™è¯¯ã€‚\n&#x2F;&#x2F; TypeError: null is not iterable\n\nKeep in mind though that truthiness checking on primitives can often be error prone. As an example, consider a different attempt at writing printAllä½†è¿˜æ˜¯è¦æ³¨æ„ï¼Œåœ¨åŸºæœ¬ç±»å‹ä¸Šçš„çœŸå€¼æ£€æŸ¥å¾ˆå®¹æ˜“å¯¼è‡´é”™è¯¯ï¼Œæ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¿™æ ·å†™ printAll å‡½æ•°ï¼š\nfunction printAll(strs: string | string[] | null) &#123;\n  &#x2F;&#x2F; !!!!!!!!!!!!!!!!\n  &#x2F;&#x2F; DON&#39;T DO THIS!\n  &#x2F;&#x2F; KEEP READING\n  &#x2F;&#x2F; !!!!!!!!!!!!!!!!\n  if (strs) &#123;\n    if (typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;\n      for (const s of strs) &#123;\n        console.log(s);\n      &#125;\n    &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n      console.log(strs);\n    &#125;\n  &#125;\n&#125;\n\nWe wrapped the entire body of the function in a truthy check, but this has a subtle downside: we may no longer be handling the empty string case correctly.æˆ‘ä»¬å°†æ•´ä¸ªå‡½æ•°åŒ…è£¹åœ¨çœŸå€¼æ£€æŸ¥ä¸­ï¼Œä½†è¿™æœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼šæˆ‘ä»¬å¯èƒ½ä¸å†æ­£ç¡®å¤„ç†ç©ºå­—ç¬¦ä¸²çš„æƒ…å†µã€‚TypeScript doesnâ€™t hurt us here at all, but this is behavior worth noting if youâ€™re less familiar with JavaScript. TypeScript can often help you catch bugs early on, but if you choose to do nothing with a value, thereâ€™s only so much that it can do without being overly prescriptive. If you want, you can make sure you handle situations like these with a linter.TypeScript ä¸ä¼šç»™æˆ‘ä»¬ä»»ä½•éº»çƒ¦ï¼Œä½†å¦‚æœä½ ä¸äº†è§£ JavaScriptï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æŠ€å·§ã€‚TypeScript å¯ä»¥å¸®åŠ©ä½ æå‰å‘ç°é”™è¯¯ï¼Œä½†å¦‚æœä½ é€‰æ‹©ä¸åšä»»ä½•äº‹æƒ…ï¼Œé‚£ä¹ˆåªèƒ½æ˜¯æœ‰é™çš„ã€‚å¦‚æœä½ æƒ³ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª linter æ¥ç¡®ä¿ä½ åœ¨è¿™ç§æƒ…å†µä¸‹æ­£ç¡®å¤„ç†ã€‚One last word on narrowing by truthiness is that Boolean negations with ! filter out from negated branches.å¦å¤–ä¸€ä¸ªé€šè¿‡çœŸå€¼æ£€æŸ¥æ”¶çª„ç±»å‹çš„æ–¹å¼æ˜¯é€šè¿‡!æ“ä½œç¬¦ã€‚\nfunction multiplyAll(values: number[] | undefined, factor: number): number[] | undefined &#123;\n  if (!values) &#123;\n    return values;\n  &#125; else &#123;\n    return values.map((x) &#x3D;&gt; x \\* factor);\n  &#125;\n&#125;\n\nEquality narrowingç­‰å€¼ç¼©å‡\nTypeScript also uses switch statements and equality checks like &#x3D;&#x3D;&#x3D;, !&#x3D;&#x3D;, &#x3D;&#x3D;, and !&#x3D; to narrow types. For example:TypeScript ä¹Ÿä½¿ç”¨äº† switch è¯­å¥å’Œç­‰å€¼æ£€æŸ¥ï¼Œæ¯”å¦‚ ===ã€!==ã€==ã€!=ã€‚\nfunction example(x: string | number, y: string | boolean) &#123;\n  if (x &#x3D;&#x3D;&#x3D; y) &#123;\n    &#x2F;&#x2F; We can now call any &#39;string&#39; method on &#39;x&#39; or &#39;y&#39;.\n    x.toUpperCase();\n\n    &#x2F;&#x2F; (method) String.toUpperCase(): string\n    y.toLowerCase();\n\n    &#x2F;&#x2F; (method) String.toLowerCase(): string\n  &#125; else &#123;\n    console.log(x);\n\n    &#x2F;&#x2F; (parameter) x: string | number\n    console.log(y);\n\n    &#x2F;&#x2F; (parameter) y: string | boolean\n  &#125;\n&#125;\n\nWhen we checked that x and y are both equal in the above example, TypeScript knew their types also had to be equal. Since string is the only common type that both x and y could take on, TypeScript knows that x and y must be a string in the first branch.åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥äº† x å’Œ y æ˜¯å¦ç›¸ç­‰ã€‚TypeScript çŸ¥é“ x å’Œ y çš„ç±»å‹ä¹Ÿå¿…é¡»ç›¸ç­‰ã€‚å› ä¸º string æ˜¯æ‰€æœ‰ x å’Œ y å¯èƒ½å–å¾—çš„ç±»å‹çš„å…±åŒç±»å‹ï¼Œæ‰€ä»¥ TypeScript çŸ¥é“ x å’Œ y å¿…é¡»æ˜¯ string çš„ç¬¬ä¸€ä¸ªåˆ†æ”¯ã€‚Checking against specific literal values (as opposed to variables) works also. In our section about truthiness narrowing, we wrote a printAll function which was error-prone because it accidentally didnâ€™t handle empty strings properly. Instead we could have done a specific check to block out nulls, and TypeScript still correctly removes null from the type of strs.æ£€æŸ¥ç‰¹å®šçš„å­—é¢å€¼ï¼ˆè€Œä¸æ˜¯å˜é‡ï¼‰ä¹Ÿå¯ä»¥å·¥ä½œã€‚åœ¨æˆ‘ä»¬æåˆ°çš„çœŸå€¼æ”¶çª„ä¸­ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ª printAll å‡½æ•°ï¼Œå®ƒé”™è¯¯åœ°å¤„ç†äº†ç©ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯é€šè¿‡æ£€æŸ¥ null æ¥åšã€‚å¯ä»¥é€šè¿‡æ£€æŸ¥ null æ¥é˜»æ­¢ nullï¼ŒTypeScript ä»ç„¶èƒ½æ­£ç¡®åœ°ä» strs çš„ç±»å‹ä¸­å»é™¤ nullã€‚\nfunction printAll(strs: string | string[] | null) &#123;\n  if (strs !&#x3D;&#x3D; null) &#123;\n    if (typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;\n      for (const s of strs) &#123;\n        &#x2F;&#x2F; (parameter) strs: string[]\n        console.log(s);\n      &#125;\n    &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n      console.log(strs);\n\n      &#x2F;&#x2F; (parameter) strs: string\n    &#125;\n  &#125;\n&#125;\n\nJavaScriptâ€™s looser equality checks with &#x3D;&#x3D; and !&#x3D; also get narrowed correctly. If youâ€™re unfamiliar, checking whether something &#x3D;&#x3D; null actually not only checks whether it is specifically the value null - it also checks whether itâ€™s potentially undefined. The same applies to &#x3D;&#x3D; undefined: it checks whether a value is either null or undefined.JavaScript çš„æ›´ç²—ç³™çš„ç­‰å€¼æ£€æŸ¥ï¼Œæ¯”å¦‚ == å’Œ !=ï¼Œä¹Ÿèƒ½æ­£ç¡®æ”¶çª„ç±»å‹ã€‚å¦‚æœä½ ä¸äº†è§£ï¼Œæ£€æŸ¥ something == null æ˜¯å¦ä¸ä»…æ£€æŸ¥äº† something æ˜¯å¦æ˜¯ç‰¹å®šçš„å€¼ nullï¼Œè¿˜æ£€æŸ¥äº†å®ƒæ˜¯å¦å¯èƒ½æ˜¯æœªå®šä¹‰çš„ã€‚åŒæ ·çš„é“ç†ï¼Œæ£€æŸ¥ something == undefined æ˜¯å¦ä¸ä»…æ£€æŸ¥äº† something æ˜¯å¦æ˜¯ç‰¹å®šçš„å€¼ undefinedï¼Œè¿˜æ£€æŸ¥äº†å®ƒæ˜¯å¦å¯èƒ½æ˜¯æœªå®šä¹‰çš„ã€‚\ninterface Container &#123;\n  value: number | null | undefined;\n&#125;\n\nfunction multiplyValue(container: Container, factor: number) &#123;\n  &#x2F;&#x2F; Remove both &#39;null&#39; and &#39;undefined&#39; from the type.\n  if (container.value !&#x3D; null) &#123;\n    console.log(container.value);\n\n    &#x2F;&#x2F; (property) Container.value: number\n\n    &#x2F;&#x2F; Now we can safely multiply &#39;container.value&#39;.\n    container.value *&#x3D; factor;\n  &#125;\n&#125;\n\nThe in operator narrowinginæ“ä½œç¬¦ç¼©å‡\nJavaScript has an operator for determining if an object has a property with a name: the in operator. TypeScript takes this into account as a way to narrow down potential types.JavaScript æœ‰ä¸€ä¸ªæ“ä½œç¬¦ç”¨æ¥ç¡®å®šå¯¹è±¡æ˜¯å¦æœ‰ä¸€ä¸ªå±æ€§åï¼šin æ“ä½œç¬¦ã€‚TypeScript ä½¿ç”¨è¿™ç§æ–¹å¼æ¥æ”¶çª„å¯èƒ½çš„ç±»å‹ã€‚For example, with the code: â€œvalueâ€ in x. where â€œvalueâ€ is a string literal and x is a union type. The â€œtrueâ€ branch narrows xâ€™s types which have either an optional or required property value, and the â€œfalseâ€ branch narrows to types which have an optional or missing property value.ä¾‹å¦‚ï¼Œåœ¨ x ä¸­ï¼Œâ€œvalueâ€ æ˜¯ä¸€ä¸ªå­—é¢é‡å­—ç¬¦ä¸²ï¼Œx æ˜¯ä¸€ä¸ªè”åˆç±»å‹ã€‚â€œtrueâ€ åˆ†æ”¯æ”¶çª„ x çš„ç±»å‹ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¯é€‰æˆ–å¿…é¡»çš„å±æ€§å€¼ï¼Œè€Œâ€œfalseâ€ åˆ†æ”¯æ”¶çª„åˆ°æœ‰ä¸€ä¸ªå¯é€‰æˆ–ç¼ºå°‘çš„å±æ€§å€¼ã€‚\ntype Fish &#x3D; &#123; swim: () &#x3D;&gt; void &#125;;\ntype Bird &#x3D; &#123; fly: () &#x3D;&gt; void &#125;;\n\nfunction move(animal: Fish | Bird) &#123;\n  if (&quot;swim&quot; in animal) &#123;\n    return animal.swim();\n  &#125;\n\n  return animal.fly();\n&#125;\n\nTo reiterate optional properties will exist in both sides for narrowing, for example a human could both swim and fly (with the right equipment) and thus should show up in both sides of the in check:ä¸ºäº†æ”¶çª„å¯é€‰å±æ€§ï¼Œäººç±»å¯ä»¥åŒæ—¶é£è¡Œå’Œæ¸¸æ³³ï¼ˆæœ‰æ­£ç¡®çš„è£…å¤‡ï¼‰ï¼Œå› æ­¤åº”è¯¥åœ¨ in æ£€æŸ¥çš„ä¸¤ä¾§æ˜¾ç¤ºã€‚\ntype Fish &#x3D; &#123; swim: () &#x3D;&gt; void &#125;;\ntype Bird &#x3D; &#123; fly: () &#x3D;&gt; void &#125;;\ntype Human &#x3D; &#123; swim?: () &#x3D;&gt; void; fly?: () &#x3D;&gt; void &#125;;\n\nfunction move(animal: Fish | Bird | Human) &#123;\n  if (&quot;swim&quot; in animal) &#123;\n    animal;\n\n    &#x2F;&#x2F; (parameter) animal: Fish | Human\n  &#125; else &#123;\n    animal;\n\n    &#x2F;&#x2F; (parameter) animal: Bird | Human\n  &#125;\n&#125;\n\ninstanceof narrowinginstanceofç¼©å‡\nJavaScript has an operator for checking whether or not a value is an â€œinstanceâ€ of another value. More specifically, in JavaScript x instanceof Foo checks whether the prototype chain of x contains Foo.prototype. While we wonâ€™t dive deep here, and youâ€™ll see more of this when we get into classes, they can still be useful for most values that can be constructed with new. As you might have guessed, instanceof is also a type guard, and TypeScript narrows in branches guarded by instanceofs.JavaScript æœ‰ä¸€ä¸ªæ“ä½œç¬¦ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå€¼çš„å®ä¾‹ï¼šin æ“ä½œç¬¦ã€‚æ›´è¯¦ç»†çš„è¯´ï¼Œåœ¨ JavaScript x instanceof Foo æ£€æŸ¥ x çš„åŸå‹é“¾æ˜¯å¦åŒ…å« Foo.prototypeã€‚ä½†æˆ‘ä»¬è¿™é‡Œä¸ä¼šæ·±å…¥ï¼Œå½“æˆ‘ä»¬æ¥è§¦åˆ°ç±»æ—¶ï¼Œå®ƒä»¬ä»ç„¶å¯ä»¥ç”¨äºæ„é€ å‡½æ•°ã€‚ä½ å¯èƒ½ä¼šçŒœåˆ°ï¼Œinstanceof æ˜¯ä¸€ä¸ªç±»å‹æ£€æŸ¥ï¼Œè€Œ TypeScript æ”¶çª„åœ¨ instanceof æ£€æŸ¥çš„åˆ†æ”¯ã€‚\nfunction logValue(x: Date | string) &#123;\n  if (x instanceof Date) &#123;\n    console.log(x.toUTCString());\n\n    &#x2F;&#x2F; (parameter) x: Date\n  &#125; else &#123;\n    console.log(x.toUpperCase());\n\n    &#x2F;&#x2F; (parameter) x: string\n  &#125;\n&#125;\n\nAssignmentsèµ‹å€¼\nAs we mentioned earlier, when we assign to any variable, TypeScript looks at the right side of the assignment and narrows the left side appropriately.æˆ‘ä»¬å‰é¢æåˆ°è¿‡ï¼Œå½“æˆ‘ä»¬ç»™ä»»ä½•å˜é‡èµ‹å€¼æ—¶ï¼ŒTypeScript ä¼šæ£€æŸ¥èµ‹å€¼å³ä¾§å¹¶æ”¶çª„å·¦ä¾§é€‚å½“çš„ç±»å‹ã€‚\nlet x &#x3D; Math.random() &lt; 0.5 ? 10 : &quot;hello world!&quot;;\n\nlet x: string | number;\nx &#x3D; 1;\n\nconsole.log(x);\n\nlet x: number;\nx &#x3D; &quot;goodbye!&quot;;\n\nconsole.log(x);\n\nlet x: string;\n\nNotice that each of these assignments is valid. Even though the observed type of x changed to number after our first assignment, we were still able to assign a string to x. This is because the declared type of x - the type that x started with - is string | number, and assignability is always checked against the declared type.æ³¨æ„ï¼Œæ¯ä¸€ä¸ªèµ‹å€¼éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚å³ä½¿ x çš„å‘ç°ç±»å‹æ”¹å˜ä¸º number ä¹‹åï¼Œæˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿç»™ x èµ‹å€¼ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ˜¯å› ä¸º x çš„å£°æ˜ç±»å‹æ˜¯ string | numberï¼Œè€Œèµ‹å€¼æ—¶æ˜¯æ£€æŸ¥èµ‹å€¼ç±»å‹æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™å®ƒã€‚If weâ€™d assigned a boolean to x, weâ€™d have seen an error since that wasnâ€™t part of the declared type.\nlet x &#x3D; Math.random() &lt; 0.5 ? 10 : &quot;hello world!&quot;;\n\nlet x: string | number;\nx &#x3D; 1;\n\nconsole.log(x);\n\nlet x: number;\nx &#x3D; true;\n&#x2F;&#x2F; Type &#39;boolean&#39; is not assignable to type &#39;string | number&#39;.\n\nconsole.log(x);\n\nlet x: string | number;\n\nControl flow analysisæ§åˆ¶æµåˆ†æ\nUp until this point, weâ€™ve gone through some basic examples of how TypeScript narrows within specific branches. But thereâ€™s a bit more going on than just walking up from every variable and looking for type guards in ifs, whiles, conditionals, etc. For exampleåœ¨è¿™ä¸ªç‚¹ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»æ¢ç´¢äº†ä¸€äº›åŸºæœ¬çš„ä¾‹å­ï¼Œå¦‚ä½•æ”¶çª„åœ¨ç‰¹å®šåˆ†æ”¯ä¸­ã€‚ä½†è¿™é‡Œæœ‰ä¸€äº›æ¯”è¾ƒå¤æ‚çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä»æ¯ä¸ªå˜é‡ä¸Šæ¥çœ‹ï¼Œå¦‚æœæœ‰ä¸€ä¸ª if è¯­å¥ï¼Œwhile è¯­å¥ï¼Œæ¡ä»¶è¡¨è¾¾å¼ç­‰ï¼Œéƒ½å¯ä»¥çœ‹åˆ°æ”¶çª„ã€‚ä¾‹å¦‚\nfunction padLeft(padding: number | string, input: string) &#123;\n  if (typeof padding &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;\n    return &quot; &quot;.repeat(padding) + input;\n  &#125;\n  return padding + input;\n&#125;\n\npadLeft returns from within its first if block. TypeScript was able to analyze this code and see that the rest of the body (return padding + input;) is unreachable in the case where padding is a number. As a result, it was able to remove number from the type of padding (narrowing from string | number to string) for the rest of the function.padLeft è¿”å›åœ¨å®ƒçš„ç¬¬ä¸€ä¸ª if å—ä¸­ã€‚TypeScript å¯ä»¥åˆ†æè¿™æ®µä»£ç ï¼Œå¹¶ä¸”å‘ç° rest of the body (return padding + input;) æ˜¯ä¸å¯è¾¾çš„ï¼Œåœ¨ padding æ˜¯ä¸€ä¸ª number çš„æƒ…å†µä¸‹ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥ç§»é™¤ padding çš„å£°æ˜ç±»å‹ï¼ˆæ”¶çª„ä» string | number åˆ° stringï¼‰ï¼Œä»è€Œç§»é™¤äº† padding çš„ç±»å‹ã€‚This analysis of code based on reachability is called control flow analysis, and TypeScript uses this flow analysis to narrow types as it encounters type guards and assignments. When a variable is analyzed, control flow can split off and re-merge over and over again, and that variable can be observed to have a different type at each point.è¿™æ®µä»£ç åŸºäºå¯è¾¾æ€§çš„åˆ†ææ˜¯æ§åˆ¶æµåˆ†æï¼ŒTypeScript ä½¿ç”¨è¿™ä¸ªåˆ†ææ¥æ”¶çª„ç±»å‹ï¼Œå½“é‡åˆ°ç±»å‹æ£€æŸ¥å’Œèµ‹å€¼æ—¶ã€‚å½“ä¸€ä¸ªå˜é‡è¢«åˆ†ææ—¶ï¼Œæ§åˆ¶æµå¯ä»¥åˆ†è£‚å’Œé‡æ–°åˆå¹¶ï¼Œå¹¶ä¸”è¿™ä¸ªå˜é‡åœ¨æ¯ä¸ªç‚¹éƒ½ä¼šæœ‰ä¸åŒçš„ç±»å‹ã€‚\nfunction example() &#123;\n  let x: string | number | boolean;\n\n  x &#x3D; Math.random() &lt; 0.5;\n\n  console.log(x);\n\n  let x: boolean;\n\n  if (Math.random() &lt; 0.5) &#123;\n    x &#x3D; &quot;hello&quot;;\n    console.log(x);\n\n    let x: string;\n  &#125; else &#123;\n    x &#x3D; 100;\n    console.log(x);\n\n    let x: number;\n  &#125;\n\n  return x;\n\n  let x: string | number;\n&#125;\n\nUsing type predicatesä½¿ç”¨ç±»å‹æ–­è¨€\nWeâ€™ve worked with existing JavaScript constructs to handle narrowing so far, however sometimes you want more direct control over how types change throughout your code.æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ç°æœ‰çš„ JavaScript å·¥å…·æ¥å¤„ç†æ”¶çª„ï¼Œä½†æœ‰æ—¶å€™ä½ æƒ³æ›´åŠ ç›´æ¥æ§åˆ¶ç±»å‹åœ¨ä½ çš„ä»£ç ä¸­çš„å˜åŒ–ã€‚To define a user-defined type guard, we simply need to define a function whose return type is a type predicate:å®šä¹‰ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ç±»å‹æ–­è¨€ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºç±»å‹æ–­è¨€çš„å‡½æ•°ï¼š\nfunction isFish(pet: Fish | Bird): pet is Fish &#123;\n  return (pet as Fish).swim !&#x3D;&#x3D; undefined;\n&#125;\n\npet is Fish is our type predicate in this example. A predicate takes the form parameterName is Type, where parameterName must be the name of a parameter from the current function signature.pet is Fish æ˜¯æˆ‘ä»¬çš„ç±»å‹æ–­è¨€ã€‚ä¸€ä¸ªæ–­è¨€çš„æ ¼å¼æ˜¯ parameterName is Typeï¼Œå…¶ä¸­ parameterName å¿…é¡»æ˜¯å½“å‰å‡½æ•°ç­¾åä¸­çš„ä¸€ä¸ªå‚æ•°åã€‚Any time isFish is called with some variable, TypeScript will narrow that variable to that specific type if the original type is compatible.ä»»ä½•æ—¶å€™ï¼ŒisFish è¢«è°ƒç”¨ï¼ŒTypeScript å°†ä¼šæ”¶çª„è¿™ä¸ªå˜é‡çš„ç±»å‹ï¼Œå¦‚æœåŸå§‹ç±»å‹æ˜¯å…¼å®¹çš„ã€‚\n&#x2F;&#x2F; Both calls to &#39;swim&#39; and &#39;fly&#39; are now okay.\nlet pet &#x3D; getSmallPet();\n\nif (isFish(pet)) &#123;\n  pet.swim();\n&#125; else &#123;\n  pet.fly();\n&#125;\n\nNotice that TypeScript not only knows that pet is a Fish in the if branch; it also knows that in the else branch, you donâ€™t have a Fish, so you must have a Bird.TypeScript çŸ¥é“ pet æ˜¯ä¸€ä¸ª Fish åœ¨ if åˆ†æ”¯ï¼›å®ƒä¹ŸçŸ¥é“åœ¨ else åˆ†æ”¯ï¼Œä½ æ²¡æœ‰ä¸€ä¸ª Fishï¼Œæ‰€ä»¥ä½ å¿…é¡»æœ‰ä¸€ä¸ª Birdã€‚You may use the type guard isFish to filter an array of Fish | Bird and obtain an array of Fish:ä½ å¯ä»¥ä½¿ç”¨ isFish æ¥è¿‡æ»¤ Fish | Bird æ•°ç»„ï¼Œå¹¶è·å¾—ä¸€ä¸ª Fish æ•°ç»„ã€‚\nconst zoo: (Fish | Bird)[] &#x3D; [getSmallPet(), getSmallPet(), getSmallPet()];\nconst underWater1: Fish[] &#x3D; zoo.filter(isFish);\n&#x2F;&#x2F; or, equivalently\nconst underWater2: Fish[] &#x3D; zoo.filter(isFish) as Fish[];\n\n&#x2F;&#x2F; The predicate may need repeating for more complex examples\nconst underWater3: Fish[] &#x3D; zoo.filter((pet): pet is Fish &#x3D;&gt; &#123;\n  if (pet.name &#x3D;&#x3D;&#x3D; &quot;sharkey&quot;) return false;\n  return isFish(pet);\n&#125;);\n\nIn addition, classes can use this is Type to narrow their type.Weâ€™ve worked with existing JavaScript constructs to handle narrowing so far, however sometimes you want more direct control over how types change throughout your code.ç±»å¯ä»¥ä½¿ç”¨ is Type æ¥æ”¶çª„ç±»å‹ã€‚æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ç°æœ‰çš„ JavaScript å·¥å…·æ¥å¤„ç†æ”¶çª„ï¼Œä½†æœ‰æ—¶å€™ä½ æƒ³æ›´åŠ ç›´æ¥æ§åˆ¶ç±»å‹åœ¨ä½ çš„ä»£ç ä¸­çš„å˜åŒ–ã€‚To define a user-defined type guard, we simply need to define a function whose return type is a type predicate:å®šä¹‰ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ç±»å‹æ–­è¨€ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºç±»å‹æ–­è¨€çš„å‡½æ•°ï¼š\nfunction isFish(pet: Fish | Bird): pet is Fish &#123;\n  return (pet as Fish).swim !&#x3D;&#x3D; undefined;\n&#125;\n\npet is Fish is our type predicate in this example. A predicate takes the form parameterName is Type, where parameterName must be the name of a parameter from the current function signature.pet is Fish æ˜¯æˆ‘ä»¬çš„ç±»å‹æ–­è¨€ã€‚ä¸€ä¸ªæ–­è¨€çš„æ ¼å¼æ˜¯ parameterName is Typeï¼Œå…¶ä¸­ parameterName å¿…é¡»æ˜¯å½“å‰å‡½æ•°ç­¾åä¸­çš„ä¸€ä¸ªå‚æ•°åã€‚Any time isFish is called with some variable, TypeScript will narrow that variable to that specific type if the original type is compatible.ä»»ä½•æ—¶å€™ï¼ŒisFish è¢«è°ƒç”¨ï¼ŒTypeScript å°†ä¼šæ”¶çª„è¿™ä¸ªå˜é‡çš„ç±»å‹ï¼Œå¦‚æœåŸå§‹ç±»å‹æ˜¯å…¼å®¹çš„ã€‚\n&#x2F;&#x2F; Both calls to &#39;swim&#39; and &#39;fly&#39; are now okay.\nlet pet &#x3D; getSmallPet();\n\nif (isFish(pet)) &#123;\n  pet.swim();\n&#125; else &#123;\n  pet.fly();\n&#125;\n\nNotice that TypeScript not only knows that pet is a Fish in the if branch; it also knows that in the else branch, you donâ€™t have a Fish, so you must have a Bird.TypeScript çŸ¥é“ pet æ˜¯ä¸€ä¸ª Fish åœ¨ if åˆ†æ”¯ï¼›å®ƒä¹ŸçŸ¥é“åœ¨ else åˆ†æ”¯ï¼Œä½ æ²¡æœ‰ä¸€ä¸ª Fishï¼Œæ‰€ä»¥ä½ å¿…é¡»æœ‰ä¸€ä¸ª Birdã€‚You may use the type guard isFish to filter an array of Fish | Bird and obtain an array of Fish:ä½ å¯ä»¥ä½¿ç”¨ isFish æ¥è¿‡æ»¤ Fish | Bird æ•°ç»„ï¼Œå¹¶è·å¾—ä¸€ä¸ª Fish æ•°ç»„ã€‚\nconst zoo: (Fish | Bird)[] &#x3D; [getSmallPet(), getSmallPet(), getSmallPet()];\nconst underWater1: Fish[] &#x3D; zoo.filter(isFish);\n&#x2F;&#x2F; or, equivalently\nconst underWater2: Fish[] &#x3D; zoo.filter(isFish) as Fish[];\n\n&#x2F;&#x2F; The predicate may need repeating for more complex examples\nconst underWater3: Fish[] &#x3D; zoo.filter((pet): pet is Fish &#x3D;&gt; &#123;\n  if (pet.name &#x3D;&#x3D;&#x3D; &quot;sharkey&quot;) return false;\n  return isFish(pet);\n&#125;);\n\nIn addition, classes can use this is Type to narrow their type.é™¤æ­¤ä¹‹å¤–ï¼Œç±»ä¸­å¯ä»¥ä½¿ç”¨this is Typeæ¥ç¼©å‡ç±»å‹ã€‚\nDiscriminated unionsåˆ†åŒºè”åˆ\nMost of the examples weâ€™ve looked at so far have focused around narrowing single variables with simple types like string, boolean, and number. While this is common, most of the time in JavaScript weâ€™ll be dealing with slightly more complex structures.For some motivation, letâ€™s imagine weâ€™re trying to encode shapes like circles and squares.Circles keep track of their radiuses and squares keep track of their side lengths. Weâ€™ll use a field called kind to tell which shape weâ€™re dealing with. Hereâ€™s a first attempt at defining Shape.è®©æˆ‘ä»¬è¯•æƒ³æœ‰è¿™æ ·ä¸€ä¸ªå¤„ç† Shape ï¼ˆæ¯”å¦‚ Circlesã€Squares ï¼‰çš„å‡½æ•°ï¼ŒCircles ä¼šè®°å½•å®ƒçš„åŠå¾„å±æ€§ï¼ŒSquares ä¼šè®°å½•å®ƒçš„è¾¹é•¿å±æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª kind å­—æ®µæ¥åŒºåˆ†åˆ¤æ–­å¤„ç†çš„æ˜¯ Circles è¿˜æ˜¯ Squaresï¼Œè¿™æ˜¯åˆå§‹çš„ Shape å®šä¹‰ï¼š\ninterface Shape &#123;\n  kind: &quot;circle&quot; | &quot;square&quot;;\n  radius?: number;\n  sideLength?: number;\n&#125;\n\nNotice weâ€™re using a union of string literal types: â€œcircleâ€ and â€œsquareâ€ to tell us whether we should treat the shape as a circle or square respectively. By using â€œcircleâ€ | â€œsquareâ€ instead of string, we can avoid misspelling issues.æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ç±»å‹çš„è”åˆï¼š&quot;circle&quot; å’Œ &quot;square&quot;ï¼Œæ¥å‘Šè¯‰æˆ‘ä»¬æ˜¯å¤„ç†ä¸€ä¸ªåœ†å½¢è¿˜æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢ã€‚\nfunction handleShape(shape: Shape) &#123;\n  &#x2F;&#x2F; oops!\n  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;rect&quot;) &#123;\n    &#x2F;&#x2F; This condition will always return &#39;false&#39; since the types &#39;&quot;circle&quot; | &quot;square&quot;&#39; and &#39;&quot;rect&quot;&#39; have no overlap.\n    &#x2F;&#x2F; æ­¤æ¡ä»¶å°†æ€»æ˜¯è¿”å› &#39;false&#39;ï¼Œå› ä¸ºç±»å‹ &#39;&quot;circle&quot; | &quot;square&quot;&#39; å’Œ &#39;&quot;rect&quot;&#39; æ²¡æœ‰é‡å ã€‚\n    &#x2F;&#x2F; ...\n  &#125;\n&#125;\n\nWe can write a getArea function that applies the right logic based on if itâ€™s dealing with a circle or square. Weâ€™ll first try dealing with circles.æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª getArea å‡½æ•°ï¼Œç”¨æ¥å¤„ç†åœ†å½¢ã€‚\nfunction getArea(shape: Shape) &#123;\n  return Math.PI * shape.radius ** 2;\n  &#x2F;&#x2F; Object is possibly &#39;undefined&#39;.\n&#125;\n\nUnder strictNullChecks that gives us an error - which is appropriate since radius might not be defined. But what if we perform the appropriate checks on the kind property?åœ¨ä¸¥æ ¼çš„ null æ£€æŸ¥ä¸‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ - å› ä¸º radius å¯èƒ½ä¸å­˜åœ¨ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¯¹ kind å±æ€§è¿›è¡Œæ­£ç¡®çš„æ£€æŸ¥ï¼Œå°±ä¸ä¼šå‡ºç°é”™è¯¯ã€‚\nfunction getArea(shape: Shape) &#123;\n  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;\n    return Math.PI * shape.radius ** 2;\n    &#x2F;&#x2F; Object is possibly &#39;undefined&#39;.\n  &#125;\n&#125;\n\nHmm, TypeScript still doesnâ€™t know what to do here. Weâ€™ve hit a point where we know more about our values than the type checker does. We could try to use a non-null assertion (a ! after shape.radius) to say that radius is definitely present.å“‡ï¼ŒTypeScript è¿˜ä¸çŸ¥é“æ€ä¹ˆåŠã€‚æˆ‘ä»¬å·²ç»ç¢°åˆ°äº†ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“æ›´å¤šçš„ä¿¡æ¯äº†ï¼Œæ¯”ç±»å‹æ£€æŸ¥å™¨æ›´å¤šã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ä¸€ä¸ªéç©ºæ–­è¨€ï¼ˆshape.radius åé¢åŠ ä¸€ä¸ª !ï¼‰æ¥å‘Šè¯‰ TypeScript radius æ˜¯ä¸€å®šå­˜åœ¨çš„ã€‚\nfunction getArea(shape: Shape) &#123;\n  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;\n    return Math.PI * shape.radius! ** 2;\n  &#125;\n&#125;\n\nBut this doesnâ€™t feel ideal. We had to shout a bit at the type-checker with those non-null assertions (!) to convince it that shape.radius was defined, but those assertions are error-prone if we start to move code around. Additionally, outside of strictNullChecks weâ€™re able to accidentally access any of those fields anyway (since optional properties are just assumed to always be present when reading them). We can definitely do better.ä½†è¿™ä¸å¤ªå¥½ã€‚æˆ‘ä»¬å¿…é¡»å‘ç±»å‹æ£€æŸ¥å™¨å‘å‡ºä¸€äº›éç©ºæ–­è¨€ï¼ˆ!ï¼‰æ¥å‘Šè¯‰å®ƒ shape.radius å­˜åœ¨ï¼Œä½†è¿™äº›æ–­è¨€æ˜¯é”™è¯¯çš„ï¼Œå¦‚æœæˆ‘ä»¬å¼€å§‹ç§»åŠ¨ä»£ç ã€‚åŒæ—¶ï¼Œåœ¨éä¸¥æ ¼çš„ null æ£€æŸ¥ä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥éšæ„è®¿é—®è¿™äº›å­—æ®µï¼ˆå› ä¸ºå¯é€‰å±æ€§æ˜¯è¢«å‡å®šä¸ºæ€»æ˜¯å­˜åœ¨çš„ï¼Œå½“è¯»å–å®ƒä»¬æ—¶ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°åšã€‚The problem with this encoding of Shape is that the type-checker doesnâ€™t have any way to know whether or not radius or sideLength are present based on the kind property. We need to communicate what we know to the type checker. With that in mind, letâ€™s take another swing at defining Shape.è¿™ä¸ª Shape çš„ç¼–ç æœ‰ç‚¹é—®é¢˜ï¼Œå› ä¸ºç±»å‹æ£€æŸ¥å™¨æ²¡æœ‰ä»»ä½•æ–¹å¼å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ radius æˆ– sideLength å­˜åœ¨ã€‚æˆ‘ä»¬éœ€è¦å‘ç±»å‹æ£€æŸ¥å™¨é€šæŠ¥æˆ‘ä»¬çŸ¥é“çš„ä¿¡æ¯ã€‚\ninterface Circle &#123;\n  kind: &quot;circle&quot;;\n  radius: number;\n&#125;\n\ninterface Square &#123;\n  kind: &quot;square&quot;;\n  sideLength: number;\n&#125;\n\ntype Shape &#x3D; Circle | Square;\n\nHere, weâ€™ve properly separated Shape out into two types with different values for the kind property, but radius and sideLength are declared as required properties in their respective types.è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å°† Shape åˆ†æˆäº†ä¸¤ç§ç±»å‹ï¼Œå…¶ä¸­ kind å±æ€§çš„å€¼ä¸åŒï¼Œradius å’Œ sideLength åœ¨å®ƒä»¬çš„ç±»å‹ä¸­å£°æ˜ä¸ºå¿…é¡»çš„å±æ€§ã€‚Letâ€™s see what happens here when we try to access the radius of a Shape.æˆ‘ä»¬çœ‹çœ‹è¿™é‡Œå¦‚ä½•è®¿é—® Shape çš„ radiusã€‚\nfunction getArea(shape: Shape) &#123;\n  return Math.PI * shape.radius ** 2;\n  &#x2F;&#x2F; Property &#39;radius&#39; does not exist on type &#39;Shape&#39;.\n  &#x2F;&#x2F; Property &#39;radius&#39; does not exist on type &#39;Square&#39;.\n&#125;\n\nLike with our first definition of Shape, this is still an error. When radius was optional, we got an error (with strictNullChecks enabled) because TypeScript couldnâ€™t tell whether the property was present. Now that Shape is a union, TypeScript is telling us that shape might be a Square, and Squares donâ€™t have radius defined on them! Both interpretations are correct, but only the union encoding of Shape will cause an error regardless of how strictNullChecks is configured.ä¸æˆ‘ä»¬ç¬¬ä¸€æ¬¡å®šä¹‰ Shape çš„ä¾‹å­ç›¸åŒï¼Œè¿™è¿˜æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚å½“ radius æ˜¯å¯é€‰çš„æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼ˆä¸ strictNullChecks å¯ç”¨æ—¶ï¼‰ï¼Œå› ä¸º TypeScript ä¸èƒ½å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå±æ€§æ˜¯å¦å­˜åœ¨ã€‚But what if we tried checking the kind property again?å¦‚æœæˆ‘ä»¬å†æ¬¡æ£€æŸ¥ kind å±æ€§ï¼Ÿ\nfunction getArea(shape: Shape) &#123;\n  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;\n    return Math.PI * shape.radius ** 2;\n    &#x2F;&#x2F; (parameter) shape: Circle\n  &#125;\n&#125;\n\nThat got rid of the error! When every type in a union contains a common property with literal types, TypeScript considers that to be a discriminated union, and can narrow out the members of the union.è¿™æ¶ˆé™¤äº†é”™è¯¯ï¼å½“ä¸€ä¸ªè”åˆé‡Œçš„æ¯ä¸ªç±»å‹éƒ½åŒ…å«å¸¸é‡ç±»å‹çš„å…±åŒå±æ€§ï¼ŒTypeScript è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ†åŒºè”åˆï¼Œå¯ä»¥ç¼©å°è”åˆçš„æˆå‘˜ã€‚In this case, kind was that common property (which is whatâ€™s considered a discriminant property of Shape). Checking whether the kind property was â€œcircleâ€ got rid of every type in Shape that didnâ€™t have a kind property with the type â€œcircleâ€. That narrowed shape down to the type Circle.åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œkind å±æ€§æ˜¯é‚£ä¸ªè¢«è®¤ä¸ºæ˜¯ Shape çš„åˆ†åŒºå±æ€§ï¼ˆè¿™æ˜¯è¢«è®¤ä¸ºæ˜¯ Shape çš„åˆ†åŒºå±æ€§ï¼‰ã€‚æ£€æŸ¥ kind å±æ€§æ˜¯å¦æ˜¯ &quot;circle&quot; å¯ä»¥æ¶ˆé™¤æ‰æ²¡æœ‰ kind å±æ€§çš„ç±»å‹ã€‚è¿™ç¼©å°äº† shape åˆ° Circle ç±»å‹ã€‚The same checking works with switch statements as well. Now we can try to write our complete getArea without any pesky ! non-null assertions.åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å†™æˆ‘ä»¬çš„å®Œæ•´ getArea æ²¡æœ‰ä»»ä½•éç©ºæ–­è¨€ï¼\nfunction getArea(shape: Shape) &#123;\n  switch (shape.kind) &#123;\n    case &quot;circle&quot;:\n      return Math.PI * shape.radius ** 2;\n\n    &#x2F;&#x2F; (parameter) shape: Circle\n    case &quot;square&quot;:\n      return shape.sideLength ** 2;\n\n    &#x2F;&#x2F; (parameter) shape: Square\n  &#125;\n&#125;\n\nThe important thing here was the encoding of Shape. Communicating the right information to TypeScript - that Circle and Square were really two separate types with specific kind fields - was crucial. Doing that let us write type-safe TypeScript code that looks no different than the JavaScript we wouldâ€™ve written otherwise. From there, the type system was able to do the â€œrightâ€ thing and figure out the types in each branch of our switch statement.è¿™é‡Œæœ‰é‡è¦çš„äº‹æƒ…ï¼Œéœ€è¦é€šè¿‡ç¼–ç  Shape æ¥å‘Šè¯‰ TypeScriptï¼ŒCircle å’Œ Square æ˜¯çœŸæ­£çš„ä¸¤ä¸ªç±»å‹ï¼Œå…·æœ‰ç‰¹å®šçš„ kind å±æ€§ã€‚è¿™æ ·å°±å¯ä»¥å†™å‡ºç±»å‹å®‰å…¨çš„ TypeScript ä»£ç ï¼Œçœ‹èµ·æ¥å’Œ JavaScript ä¸€æ ·ã€‚As an aside, try playing around with the above example and remove some of the return keywords. Youâ€™ll see that type-checking can help avoid bugs when accidentally falling through different clauses in a switch statement.ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œè¯•ç€ç©ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¹¶åˆ é™¤ä¸€äº› return å…³é”®å­—ã€‚ä½ ä¼šå‘ç°ï¼Œç±»å‹æ£€æŸ¥å¯ä»¥å¸®åŠ©é¿å…åœ¨æ„å¤–çš„æƒ…å†µä¸‹è·³è¿‡ä¸åŒçš„åˆ†æ”¯ã€‚Discriminated unions are useful for more than just talking about circles and squares. Theyâ€™re good for representing any sort of messaging scheme in JavaScript, like when sending messages over the network (client&#x2F;server communication), or encoding mutations in a state management framework.åˆ†åŒºè”åˆæ˜¯ç”¨æ¥è¡¨ç¤ºä»»ä½•ç±»å‹çš„æ¶ˆæ¯åè®®ï¼Œæ¯”å¦‚åœ¨ç½‘ç»œä¸Šå‘é€æ¶ˆæ¯ï¼ˆå®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡ï¼‰ï¼Œæˆ–è€…ç¼–ç çŠ¶æ€ç®¡ç†æ¡†æ¶çš„å˜åŒ–ã€‚\nThe never typeneverç±»å‹\nWhen narrowing, you can reduce the options of a union to a point where you have removed all possibilities and have nothing left. In those cases, TypeScript will use a never type to represent a state which shouldnâ€™t exist.åœ¨ç¼©å°è”åˆçš„æ—¶å€™ï¼Œä½ å¯ä»¥å°†è”åˆçš„å¯èƒ½æ€§é™ä½åˆ°æ²¡æœ‰ä»»ä½•å¯èƒ½æ€§çš„çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScript ä¼šä½¿ç”¨ never ç±»å‹æ¥è¡¨ç¤ºä¸åº”è¯¥å­˜åœ¨çš„çŠ¶æ€ã€‚\nExhaustiveness checkingæ¨æ–­æ€§æ£€æŸ¥\nThe never type is assignable to every type; however, no type is assignable to never (except never itself). This means you can use narrowing and rely on never turning up to do exhaustive checking in a switch statement.neverç±»å‹å¯ä»¥èµ‹å€¼ç»™æ‰€æœ‰ç±»å‹ï¼Œä½†æ˜¯ä¸å¯ä»¥èµ‹å€¼ç»™ neverï¼ˆé™¤äº† never æœ¬èº«ï¼‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ç¼©å°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ switch è¯­å¥ä¸­ä½¿ç”¨æ¨æ–­æ€§æ£€æŸ¥ã€‚For example, adding a default to our getArea function which tries to assign the shape to never will raise when every possible case has not been handled.æ·»åŠ ä¸€ä¸ªé»˜è®¤åˆ° getArea å‡½æ•°ä¸­ï¼Œè¿™æ ·å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºæ²¡æœ‰å¤„ç†æ‰€æœ‰å¯èƒ½æ€§ã€‚\ntype Shape &#x3D; Circle | Square;\n\nfunction getArea(shape: Shape) &#123;\n  switch (shape.kind) &#123;\n    case &quot;circle&quot;:\n      return Math.PI * shape.radius ** 2;\n    case &quot;square&quot;:\n      return shape.sideLength ** 2;\n    default:\n      const _exhaustiveCheck: never &#x3D; shape;\n      return _exhaustiveCheck;\n  &#125;\n&#125;\n\nAdding a new member to the Shape union, will cause a TypeScript error:æ·»åŠ ä¸€ä¸ªæ–°çš„æˆå‘˜åˆ° Shape è”åˆï¼Œä¼šå¯¼è‡´ä¸€ä¸ª TypeScript é”™è¯¯ï¼š\ninterface Triangle &#123;\n  kind: &quot;triangle&quot;;\n  sideLength: number;\n&#125;\n\ntype Shape &#x3D; Circle | Square | Triangle;\n\nfunction getArea(shape: Shape) &#123;\n  switch (shape.kind) &#123;\n    case &quot;circle&quot;:\n      return Math.PI * shape.radius ** 2;\n    case &quot;square&quot;:\n      return shape.sideLength ** 2;\n    default:\n      const _exhaustiveCheck: never &#x3D; shape;\n      &#x2F;&#x2F; Type &#39;Triangle&#39; is not assignable to type &#39;never&#39;.\n      &#x2F;&#x2F; ç±»å‹ &#39;Triangle&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;never&#39;ã€‚\n      return _exhaustiveCheck;\n  &#125;\n&#125;\n\nå› ä¸º TypeScript çš„æ”¶çª„ç‰¹æ€§ï¼Œæ‰§è¡Œåˆ° default çš„æ—¶å€™ï¼Œç±»å‹è¢«æ”¶çª„ä¸º Triangleï¼Œä½†å› ä¸ºä»»ä½•ç±»å‹éƒ½ä¸èƒ½èµ‹å€¼ç»™ never ç±»å‹ï¼Œè¿™å°±ä¼šäº§ç”Ÿä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å°±å¯ä»¥ç¡®ä¿ getArea å‡½æ•°æ€»æ˜¯ç©·å°½äº†æ‰€æœ‰ shape çš„å¯èƒ½æ€§ã€‚\n","slug":"2022-06-08ts-norrowing","date":"2022-06-07T01:21:19.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"746ca231a136437ea4011b4445608ad1","title":"3.Typescript å¸¸è§ç±»å‹","content":"Everyday Typeså¸¸è§ç±»å‹In this chapter, weâ€™ll cover some of the most common types of values youâ€™ll find in JavaScript code, and explain the corresponding ways to describe those types in TypeScript. This isnâ€™t an exhaustive list, and future chapters will describe more ways to name and use other types.åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€äº› JavaScript ä»£ç ä¸­çš„å¸¸è§ç±»å‹ï¼Œå¹¶åœ¨ TypeScript ä¸­è¯´æ˜è¿™äº›ç±»å‹çš„ç›¸åº”æ–¹å¼ã€‚è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œè€Œä¸”æœªæ¥çš„ç« èŠ‚å°†è¯´æ˜æ›´å¤šçš„æ–¹æ³•æ¥å‘½åå’Œä½¿ç”¨å…¶ä»–ç±»å‹ã€‚Types can also appear in many more places than just type annotations. As we learn about the types themselves, weâ€™ll also learn about the places where we can refer to these types to form new constructs.ç±»å‹ä¹Ÿå¯ä»¥å‡ºç°åœ¨ç±»å‹æ³¨é‡Šä¹‹å¤–ã€‚æˆ‘ä»¬å­¦ä¹ ç±»å‹æœ¬èº«æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå­¦ä¹ åˆ°å“ªäº›åœ°æ–¹å¯ä»¥å¼•ç”¨è¿™äº›ç±»å‹æ¥å½¢æˆæ–°çš„æ„é€ ã€‚Weâ€™ll start by reviewing the most basic and common types you might encounter when writing JavaScript or TypeScript code. These will later form the core building blocks of more complex types.æˆ‘ä»¬å°†å¼€å§‹ä»‹ç»æœ€åŸºæœ¬çš„ JavaScript æˆ– TypeScript ä»£ç ä¸­å¯èƒ½é‡åˆ°çš„å¸¸è§ç±»å‹ã€‚è¿™äº›ç±»å‹å°†ä½œä¸ºæ›´å¤æ‚çš„ç±»å‹çš„åŸºç¡€å»ºç­‘å—ã€‚\nThe primitives: string,number, and booleanJavaScript has three very commonly used primitives: string, number, and boolean. Each has a corresponding type in TypeScript. As you might expect, these are the same names youâ€™d see if you used the JavaScript typeof operator on a value of those types:JavaScript æœ‰ä¸‰ä¸ªéå¸¸å¸¸è§çš„åŸå§‹ç±»å‹ï¼šå­—ç¬¦ä¸²ï¼Œæ•°å­—å’Œå¸ƒå°”å€¼ã€‚è¿™ä¸‰ä¸ªç±»å‹åœ¨ TypeScript ä¸­å¯¹åº”ã€‚å¦‚æœä½ å¯ä»¥æ¥å—ï¼Œè¿™ä¸‰ä¸ªç±»å‹çš„åå­—éƒ½æ˜¯ç›¸åŒçš„ï¼š\n\nstring represents string values like â€œHello, worldâ€string è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ &quot;Hello, world&quot;\nnumber is for numbers like 42. JavaScript does not have a special runtime value for integers, so thereâ€™s no equivalent to int or float - everything is simply numbernumber æ˜¯æ•°å­—ï¼Œæ¯”å¦‚ 42ã€‚JavaScript ä¸æ”¯æŒæ•´æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰ç›¸åº”çš„ int æˆ– float - æ‰€æœ‰éƒ½æ˜¯ number\nboolean is for the two values true and falseboolean æ˜¯å¸ƒå°”å€¼ï¼Œæ¯”å¦‚ true å’Œ false\n\n\n\n\n\n\n\n\nWARNING\nThe type names String, Number, and Boolean (starting with capital letters) are legal, but refer to some special built-in types that will very rarely appear in your code. Always use string, number, or boolean for types.ç±»å‹å String ï¼ŒNumber å’Œ Boolean ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ä¹Ÿæ˜¯åˆæ³•çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸€äº›éå¸¸å°‘è§çš„ç‰¹æ®Šå†…ç½®ç±»å‹ã€‚æ‰€ä»¥ç±»å‹æ€»æ˜¯ä½¿ç”¨ string ï¼Œnumber æˆ–è€… boolean ã€‚\n\nArraysæ•°ç»„To specify the type of an array like [1, 2, 3], you can use the syntax number[]; this syntax works for any type (e.g. string[] is an array of strings, and so on). You may also see this written as Array, which means the same thing. Weâ€™ll learn more about the syntax T when we cover generics.æŒ‡å®šæ•°ç»„çš„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ number[] çš„è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯ä»¥ç”¨äºä»»ä½•ç±»å‹ï¼ˆæ¯”å¦‚ string[] æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè€Œ so onï¼‰ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™ç§å†™æ³• Array&lt;number&gt;ï¼Œå®ƒè¡¨ç¤ºç›¸åŒçš„æ„æ€ã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­å­¦ä¹ æ›´å¤šå…³äºè¯­æ³• T&lt;U&gt; çš„è¯¦ç»†ä¿¡æ¯ã€‚:::warningNote that [number] is a different thing; refer to the section on Tuples.[number] ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œè¯·å‚è§å…³äºå…ƒç»„çš„ç« èŠ‚ã€‚:::\nanyTypeScript also has a special type, any, that you can use whenever you donâ€™t want a particular value to cause typechecking errors.TypeScript ä¹Ÿæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ anyï¼Œå¯ä»¥ç”¨äºæŒ‡å®šä½ ä¸æƒ³è¦æŸä¸ªå€¼å¯¼è‡´ç±»å‹æ£€æŸ¥é”™è¯¯çš„æƒ…å†µã€‚When a value is of type any, you can access any properties of it (which will in turn be of type any), call it like a function, assign it to (or from) a value of any type, or pretty much anything else thatâ€™s syntactically legal:å½“å€¼æ˜¯ any ç±»å‹æ—¶ï¼Œä½ å¯ä»¥è®¿é—®å®ƒçš„ä»»ä½•å±æ€§ï¼ˆè¿™å°†å¯¼è‡´å®ƒçš„ç±»å‹ä¸º any ï¼‰ï¼Œè°ƒç”¨å®ƒï¼Œå°†å®ƒèµ‹å€¼ç»™ï¼ˆæˆ–ä»ï¼‰ä»»ä½•ç±»å‹çš„å€¼ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•åˆæ³•çš„è¯­æ³•ï¼š\nlet obj: any &#x3D; &#123; x: 0 &#125;;\n&#x2F;&#x2F; None of the following lines of code will throw compiler errors.\n&#x2F;&#x2F; ä»¥ä¸‹ä»£ç è¡Œéƒ½ä¸ä¼šå¼•å‘ç¼–è¯‘å™¨é”™è¯¯ã€‚\n&#x2F;&#x2F; Using &#96;any&#96; disables all further type checking, and it is assumed\n&#x2F;&#x2F; ä½¿ç”¨â€œanyâ€å°†ç¦ç”¨æ‰€æœ‰è¿›ä¸€æ­¥çš„ç±»å‹æ£€æŸ¥ï¼Œå¹¶ä¸”å‡å®š\n&#x2F;&#x2F; you know the environment better than TypeScript.\n&#x2F;&#x2F; ä½ çŸ¥é“ç¯å¢ƒä¼˜äºTypeScriptã€‚\nobj.foo();\nobj();\nobj.bar &#x3D; 100;\nobj &#x3D; &quot;hello&quot;;\nconst n: number &#x3D; obj;\n\nThe any type is useful when you donâ€™t want to write out a long type just to convince TypeScript that a particular line of code is okay.any ç±»å‹æ˜¯ç”¨äºæŒ‡å®šä½ ä¸æƒ³è¦å†™å‡ºä¸€ä¸ªé•¿çš„ç±»å‹æ¥è¯´æ˜ TypeScript å¯¹æŸä¸€è¡Œä»£ç æ˜¯åˆæ³•çš„ã€‚\nnoImplicitAnyWhen you donâ€™t specify a type, and TypeScript canâ€™t infer it from context, the compiler will typically default to any.å½“ä½ ä¸æŒ‡å®šç±»å‹ï¼Œå¹¶ä¸” TypeScript ä¸èƒ½ä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡ºæ¥æ—¶ï¼Œç¼–è¯‘å™¨é»˜è®¤ä½¿ç”¨ anyã€‚You usually want to avoid this, though, because any isnâ€™t type-checked. Use the compiler flag noImplicitAny to flag any implicit any as an error.ä½ é€šå¸¸æƒ³é¿å…è¿™ç§æƒ…å†µï¼Œä½†æ˜¯ any ä¸ä¼šè¢«ç±»å‹æ£€æŸ¥ã€‚ä½¿ç”¨ç¼–è¯‘å™¨æ ‡è®° noImplicitAny æ¥æ ‡è®° any ä¸ºé”™è¯¯ã€‚\nType Annotations on Variableså˜é‡ä¸Šçš„ç±»å‹æ³¨è§£\nWhen you declare a variable using const, var, or let, you can optionally add a type annotation to explicitly specify the type of the variable:ä½¿ç”¨ const ï¼Œvar æˆ– let å£°æ˜å˜é‡æ—¶ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªç±»å‹æ³¨è§£æ¥æ˜¾å¼æŒ‡å®šå˜é‡çš„ç±»å‹ï¼š\nlet myName: string &#x3D; &quot;Alice&quot;;\n\nTypeScript doesnâ€™t use â€œtypes on the leftâ€-style declarations like int x &#x3D; 0; Type annotations will always go after the thing being typed.TypeScript ä¸ä½¿ç”¨â€œå·¦è¾¹çš„ç±»å‹â€çš„å£°æ˜æ–¹å¼ï¼Œå¦‚ int x = 0; ç±»å‹æ³¨è§£å°†æ€»æ˜¯åœ¨è¢«ç±»å‹çš„ä¸œè¥¿åé¢ã€‚In most cases, though, this isnâ€™t needed. Wherever possible, TypeScript tries to automatically infer the types in your code. For example, the type of a variable is inferred based on the type of its initializer:åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸éœ€è¦è¿™æ ·åšã€‚åœ¨æ¯ä¸ªå˜é‡çš„åˆå§‹å€¼çš„ç±»å‹å¯ä»¥è¢«è‡ªåŠ¨æ¨æ–­å‡ºæ¥ã€‚\n&#x2F;&#x2F; No type annotation needed -- &#39;myName&#39; inferred as type &#39;string&#39;\n&#x2F;&#x2F; æ²¡æœ‰ç±»å‹æ³¨è§£éœ€è¦ -- &#39;myName&#39; ç±»å‹è¢«æ¨æ–­ä¸º &#39;string&#39;\nlet myName &#x3D; &quot;Alice&quot;;\n\nFor the most part you donâ€™t need to explicitly learn the rules of inference. If youâ€™re starting out, try using fewer type annotations than you think - you might be surprised how few you need for TypeScript to fully understand whatâ€™s going on.å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šç±»å‹æ³¨è§£ã€‚å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œå°è¯•ä½¿ç”¨æ¯”ä½ è®¤ä¸ºæ›´å°‘çš„ç±»å‹æ³¨è§£ï¼Œä½ å¯èƒ½ä¼šæ„å¤–åœ°å‘ç° TypeScript å¯ä»¥å®Œå…¨ç†è§£ä½ çš„ä»£ç ã€‚\nFunctionså‡½æ•°\nFunctions are the primary means of passing data around in JavaScript. TypeScript allows you to specify the types of both the input and output values of functions.å‡½æ•°æ˜¯ JavaScript ä¸­ä¼ é€’æ•°æ®çš„ä¸»è¦æ–¹å¼ã€‚TypeScript å…è®¸ä½ æŒ‡å®šå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå€¼çš„ç±»å‹ã€‚\nParameter Type Annotationså‚æ•°ä¸Šçš„ç±»å‹æ³¨è§£\nWhen you declare a function, you can add type annotations after each parameter to declare what types of parameters the function accepts. Parameter type annotations go after the parameter name:å£°æ˜å‡½æ•°æ—¶ï¼Œå¯ä»¥åœ¨æ¯ä¸ªå‚æ•°åé¢æ·»åŠ ç±»å‹æ³¨è§£æ¥å£°æ˜å‡½æ•°æ¥å—å“ªäº›ç±»å‹çš„å‚æ•°ã€‚å‚æ•°ç±»å‹æ³¨è§£åœ¨å‚æ•°ååé¢ï¼š\n&#x2F;&#x2F; Parameter type annotation\nfunction greet(name: string) &#123;\n  console.log(&quot;Hello, &quot; + name.toUpperCase() + &quot;!!&quot;);\n&#125;\n\nWhen a parameter has a type annotation, arguments to that function will be checked:å½“å‚æ•°æœ‰ç±»å‹æ³¨è§£æ—¶ï¼Œå‡½æ•°çš„å‚æ•°ä¼šè¢«æ£€æŸ¥ï¼š\n&#x2F;&#x2F; Would be a runtime error if executed!\n&#x2F;&#x2F; å¦‚æœæ‰§è¡Œï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ï¼\ngreet(42);\n&#x2F;&#x2F; Argument of type &#39;number&#39; is not assignable to parameter of type &#39;string&#39;.\n&#x2F;&#x2F; å‚æ•°ç±»å‹ &#39;number&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;string&#39;ã€‚\n\nEven if you donâ€™t have type annotations on your parameters, TypeScript will still check that you passed the right number of arguments.å³ä½¿ä½ æ²¡æœ‰ç±»å‹æ³¨è§£ï¼ŒTypeScript ä¹Ÿä¼šæ£€æŸ¥ä½ ä¼ å…¥çš„å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚\nReturn Type Annotationsè¿”å›å€¼ä¸Šçš„ç±»å‹æ³¨è§£\nYou can also add return type annotations. Return type annotations appear after the parameter list:ä½ ä¹Ÿå¯ä»¥æ·»åŠ è¿”å›å€¼ç±»å‹æ³¨è§£ã€‚è¿”å›å€¼ç±»å‹æ³¨è§£å‡ºç°åœ¨å‚æ•°åˆ—è¡¨åé¢ï¼š\nfunction getFavoriteNumber(): number &#123;\n  return 26;\n&#125;\n\nMuch like variable type annotations, you usually donâ€™t need a return type annotation because TypeScript will infer the functionâ€™s return type based on its return statements. The type annotation in the above example doesnâ€™t change anything. Some codebases will explicitly specify a return type for documentation purposes, to prevent accidental changes, or just for personal preference.å’Œå˜é‡ç±»å‹æ³¨è§£ä¸€æ ·ï¼Œä½ é€šå¸¸ä¸éœ€è¦è¿”å›å€¼ç±»å‹æ³¨è§£ï¼Œå› ä¸º TypeScript å°†åŸºäºè¿”å›è¯­å¥çš„ç±»å‹æ¨æ–­å‡ºæ¥ã€‚ä¸Šé¢çš„ç¤ºä¾‹ç¤ºä¾‹ä¸ä¼šæ”¹å˜ä»»ä½•ä¸œè¥¿ã€‚ä¸€äº›ä»£ç åº“å°†æ˜¾å¼æŒ‡å®šä¸€ä¸ªè¿”å›å€¼ç±»å‹ï¼Œä»¥é˜²æ­¢æ„å¤–çš„æ”¹å˜ï¼Œæˆ–è€…åªæ˜¯ä¸ºäº†ä¸ªäººåå¥½ã€‚\nAnonymous FunctionsåŒ¿åå‡½æ•°\nAnonymous functions are a little bit different from function declarations. When a function appears in a place where TypeScript can determine how itâ€™s going to be called, the parameters of that function are automatically given types.åŒ¿åå‡½æ•°å’Œå‡½æ•°å£°æ˜ä¸€æ ·ã€‚å½“å‡½æ•°å‡ºç°åœ¨ TypeScript å¯ä»¥ç¡®å®šå®ƒä¼šå¦‚ä½•è¢«è°ƒç”¨æ—¶ï¼Œå‡½æ•°çš„å‚æ•°ä¼šè¢«è‡ªåŠ¨æŒ‡å®šç±»å‹ã€‚Hereâ€™s an example:è¿™é‡Œæœ‰ä¸€ä¸ªç¤ºä¾‹ï¼š\n&#x2F;&#x2F; No type annotations here, but TypeScript can spot the bug\n&#x2F;&#x2F; æ²¡æœ‰ç±»å‹æ³¨è§£ï¼Œä½† TypeScript å¯ä»¥æ£€æµ‹åˆ°é”™è¯¯\nconst names &#x3D; [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Eve&quot;];\n\n&#x2F;&#x2F; Contextual typing for function\n&#x2F;&#x2F; å‡½æ•°ä¸Šä¸‹æ–‡ç±»å‹\nnames.forEach(function (s) &#123;\n  console.log(s.toUppercase());\n  &#x2F;&#x2F; Property &#39;toUppercase&#39; does not exist on type &#39;string&#39;. Did you mean &#39;toUpperCase&#39;?\n  &#x2F;&#x2F; å±æ€§ &#39;toUppercase&#39; ä¸å­˜åœ¨äºç±»å‹ &#39;string&#39; ä¸­ã€‚ä½ å¯èƒ½æƒ³ç”¨ &#39;toUpperCase&#39; å—ï¼Ÿ\n&#125;);\n\n&#x2F;&#x2F; Contextual typing also applies to arrow functions\n&#x2F;&#x2F; ç®­å¤´å‡½æ•°ä¸Šä¸‹æ–‡ç±»å‹\nnames.forEach((s) &#x3D;&gt; &#123;\n  console.log(s.toUppercase());\n  &#x2F;&#x2F; Property &#39;toUppercase&#39; does not exist on type &#39;string&#39;. Did you mean &#39;toUpperCase&#39;?\n  &#x2F;&#x2F; å±æ€§ &#39;toUppercase&#39; ä¸å­˜åœ¨äºç±»å‹ &#39;string&#39; ä¸­ã€‚ä½ å¯èƒ½æƒ³ç”¨ &#39;toUpperCase&#39; å—ï¼Ÿ\n&#125;);\n\nEven though the parameter s didnâ€™t have a type annotation, TypeScript used the types of the forEach function, along with the inferred type of the array, to determine the type s will have.å³ä½¿å‚æ•° s æ²¡æœ‰ç±»å‹æ³¨è§£ï¼ŒTypeScript ä¼šä½¿ç”¨ forEach å‡½æ•°çš„ç±»å‹ï¼Œä»¥åŠæ¨æ–­çš„æ•°ç»„ç±»å‹ï¼Œæ¥ç¡®å®š s çš„ç±»å‹ã€‚This process is called contextual typing because the context that the function occurred within informs what type it should have.è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸Šä¸‹æ–‡ç±»å‹çš„ï¼Œå› ä¸ºå‡½æ•°å‘ç”Ÿåœ¨å“ªé‡Œçš„ä¸Šä¸‹æ–‡ï¼Œå°±ä¼šç¡®å®šå®ƒåº”è¯¥æœ‰å“ªç§ç±»å‹ã€‚Similar to the inference rules, you donâ€™t need to explicitly learn how this happens, but understanding that it does happen can help you notice when type annotations arenâ€™t needed. Later, weâ€™ll see more examples of how the context that a value occurs in can affect its type.ä¸æ¨æ–­è§„åˆ™ç›¸ä¼¼ï¼Œä½ ä¸éœ€è¦æ˜¾å¼å­¦ä¹ è¿™ç§è¿‡ç¨‹ï¼Œä½†æ˜¯äº†è§£è¿™ç§è¿‡ç¨‹å¯ä»¥å¸®åŠ©ä½ å‘ç°ï¼Œå½“å€¼ä¸éœ€è¦ç±»å‹æ³¨è§£æ—¶ï¼Œå®ƒä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¹‹åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æ›´å¤šçš„ä¾‹å­ï¼Œå¦‚ä½•å€¼çš„ä¸Šä¸‹æ–‡å¯ä»¥å½±å“å®ƒçš„ç±»å‹ã€‚\nObject Typeså¯¹è±¡ç±»å‹\nApart from primitives, the most common sort of type youâ€™ll encounter is an object type. This refers to any JavaScript value with properties, which is almost all of them! To define an object type, we simply list its properties and their types.é™¤äº†åŸå§‹ç±»å‹ï¼Œæœ€å¸¸è§çš„ç±»å‹æ˜¯å¯¹è±¡ç±»å‹ã€‚è¿™æŒ‡çš„æ˜¯ä»»ä½• JavaScript å€¼ï¼Œå®ƒçš„å±æ€§éƒ½æ˜¯å¾ˆå¤šçš„ï¼ä¸ºäº†å®šä¹‰å¯¹è±¡ç±»å‹ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ—å‡ºå®ƒçš„å±æ€§å’Œå®ƒä»¬çš„ç±»å‹ã€‚For example, hereâ€™s a function that takes a point-like object:è¿™é‡Œæœ‰ä¸€ä¸ªæ¥å—ç‚¹ç±»å‹å¯¹è±¡çš„å‡½æ•°ï¼š\n&#x2F;&#x2F; The parameter&#39;s type annotation is an object type\nfunction printCoord(pt: &#123; x: number; y: number &#125;) &#123;\n  console.log(&quot;The coordinate&#39;s x value is &quot; + pt.x);\n  console.log(&quot;The coordinate&#39;s y value is &quot; + pt.y);\n&#125;\nprintCoord(&#123; x: 3, y: 7 &#125;);\n\nHere, we annotated the parameter with a type with two properties - x and y - which are both of type number. You can use , or ; to separate the properties, and the last separator is optional either way.è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæœ‰ä¸¤ä¸ªå±æ€§çš„ç±»å‹ï¼Œx å’Œ yï¼Œå®ƒä»¬éƒ½æ˜¯ number ç±»å‹ã€‚ä½ å¯ä»¥ä½¿ç”¨ , æˆ– ; åˆ†éš”å±æ€§ï¼Œæœ€åçš„åˆ†éš”ç¬¦å¯ä»¥æ˜¯ä»»æ„çš„ã€‚The type part of each property is also optional. If you donâ€™t specify a type, it will be assumed to be any.æ¯ä¸ªå±æ€§çš„ç±»å‹éƒ¨åˆ†éƒ½æ˜¯å¯é€‰çš„ã€‚å¦‚æœä½ æ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œå®ƒä¼šè¢«è®¤ä¸ºæ˜¯ any ç±»å‹ã€‚\nOptional Propertieså¯é€‰å±æ€§\nObject types can also specify that some or all of their properties are optional. To do this, add a ? after the property name:å¯¹è±¡ç±»å‹å¯ä»¥æŒ‡å®šä¸€äº›æˆ–å…¨éƒ¨çš„å±æ€§æ˜¯å¯é€‰çš„ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œåªéœ€è¦åœ¨å±æ€§ååé¢åŠ ä¸Š ? å°±å¯ä»¥äº†ã€‚\nfunction printName(obj: &#123; first: string; last?: string &#125;) &#123;\n  &#x2F;&#x2F; ...\n&#125;\n&#x2F;&#x2F; Both OK\nprintName(&#123; first: &quot;Bob&quot; &#125;);\nprintName(&#123; first: &quot;Alice&quot;, last: &quot;Alisson&quot; &#125;);\n\nIn JavaScript, if you access a property that doesnâ€™t exist, youâ€™ll get the value undefined rather than a runtime error. Because of this, when you read from an optional property, youâ€™ll have to check for undefined before using it.\nfunction printName(obj: &#123; first: string; last?: string &#125;) &#123;\n  &#x2F;&#x2F; Error - might crash if &#39;obj.last&#39; wasn&#39;t provided!\n  console.log(obj.last.toUpperCase());\nObject is possibly &#39;undefined&#39;.\n  if (obj.last !&#x3D;&#x3D; undefined) &#123;\n    &#x2F;&#x2F; OK\n    console.log(obj.last.toUpperCase());\n  &#125;\n\n  &#x2F;&#x2F; A safe alternative using modern JavaScript syntax:\n  console.log(obj.last?.toUpperCase());\n&#125;\n\nUnion Typesè”åˆç±»å‹\nTypeScriptâ€™s type system allows you to build new types out of existing ones using a large variety of operators. Now that we know how to write a few types, itâ€™s time to start combining them in interesting ways.\nDefining a Union Typeå®šä¹‰ä¸€ä¸ªè”åˆç±»å‹\nThe first way to combine types you might see is a union type. A union type is a type formed from two or more other types, representing values that may be any one of those types. We refer to each of these types as the unionâ€™s members.\nLetâ€™s write a function that can operate on strings or numbers:\nfunction printId(id: number | string) &#123;\n  console.log(&quot;Your ID is: &quot; + id);\n&#125;\n&#x2F;&#x2F; OK\nprintId(101);\n&#x2F;&#x2F; OK\nprintId(&quot;202&quot;);\n&#x2F;&#x2F; Error\nprintId(&#123; myID: 22342 &#125;);\n&#x2F;&#x2F; Argument of type &#39;&#123; myID: number; &#125;&#39; is not assignable to parameter of type &#39;string | number&#39;.\n\nWorking with Union Typesä½¿ç”¨è”åˆç±»å‹\nItâ€™s easy to provide a value matching a union type - simply provide a type matching any of the unionâ€™s members. If you have a value of a union type, how do you work with it?\nTypeScript will only allow an operation if it is valid for every member of the union. For example, if you have the union string | number, you canâ€™t use methods that are only available on string:\nfunction printId(id: number | string) &#123;\n  console.log(id.toUpperCase());\nProperty &#39;toUpperCase&#39; does not exist on type &#39;string | number&#39;.\n  Property &#39;toUpperCase&#39; does not exist on type &#39;number&#39;.\n&#125;\n\nThe solution is to narrow the union with code, the same as you would in JavaScript without type annotations. Narrowing occurs when TypeScript can deduce a more specific type for a value based on the structure of the code.\nFor example, TypeScript knows that only a string value will have a typeof value â€œstringâ€:\nfunction printId(id: number | string) &#123;\n  if (typeof id &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n    &#x2F;&#x2F; In this branch, id is of type &#39;string&#39;\n    console.log(id.toUpperCase());\n  &#125; else &#123;\n    &#x2F;&#x2F; Here, id is of type &#39;number&#39;\n    console.log(id);\n  &#125;\n&#125;\n\nAnother example is to use a function like Array.isArray:\nfunction welcomePeople(x: string[] | string) &#123;\n  if (Array.isArray(x)) &#123;\n    &#x2F;&#x2F; Here: &#39;x&#39; is &#39;string[]&#39;\n    console.log(&quot;Hello, &quot; + x.join(&quot; and &quot;));\n  &#125; else &#123;\n    &#x2F;&#x2F; Here: &#39;x&#39; is &#39;string&#39;\n    console.log(&quot;Welcome lone traveler &quot; + x);\n  &#125;\n&#125;\n\nNotice that in the else branch, we donâ€™t need to do anything special - if x wasnâ€™t a string[], then it must have been a string.\nSometimes youâ€™ll have a union where all the members have something in common. For example, both arrays and strings have a slice method. If every member in a union has a property in common, you can use that property without narrowing:\n&#x2F;&#x2F; Return type is inferred as number[] | string\nfunction getFirstThree(x: number[] | string) &#123;\n  return x.slice(0, 3);\n&#125;\n\nIt might be confusing that a union of types appears to have the intersection of those typesâ€™ properties. This is not an accident - the name union comes from type theory. The union number | string is composed by taking the union of the values from each type. Notice that given two sets with corresponding facts about each set, only the intersection of those facts applies to the union of the sets themselves. For example, if we had a room of tall people wearing hats, and another room of Spanish speakers wearing hats, after combining those rooms, the only thing we know about every person is that they must be wearing a hat.\nType Aliasesç±»å‹åˆ«å\nWeâ€™ve been using object types and union types by writing them directly in type annotations. This is convenient, but itâ€™s common to want to use the same type more than once and refer to it by a single name.\nA type alias is exactly that - a name for any type. The syntax for a type alias is:\ntype Point &#x3D; &#123;\n  x: number;\n  y: number;\n&#125;;\n\n&#x2F;&#x2F; Exactly the same as the earlier example\nfunction printCoord(pt: Point) &#123;\n  console.log(&quot;The coordinate&#39;s x value is &quot; + pt.x);\n  console.log(&quot;The coordinate&#39;s y value is &quot; + pt.y);\n&#125;\n\nprintCoord(&#123; x: 100, y: 100 &#125;);\n\nYou can actually use a type alias to give a name to any type at all, not just an object type. For example, a type alias can name a union type:\ntype ID &#x3D; number | string;\n\nNote that aliases are only aliases - you cannot use type aliases to create different&#x2F;distinct â€œversionsâ€ of the same type. When you use the alias, itâ€™s exactly as if you had written the aliased type. In other words, this code might look illegal, but is OK according to TypeScript because both types are aliases for the same type:\ntype UserInputSanitizedString &#x3D; string;\n\nfunction sanitizeInput(str: string): UserInputSanitizedString &#123;\n  return sanitize(str);\n&#125;\n\n&#x2F;&#x2F; Create a sanitized input\nlet userInput &#x3D; sanitizeInput(getInput());\n\n&#x2F;&#x2F; Can still be re-assigned with a string though\nuserInput &#x3D; &quot;new input&quot;;\n\nInterfacesæ¥å£\nAn interface declaration is another way to name an object type:\ninterface Point &#123;\n  x: number;\n  y: number;\n&#125;\n\nfunction printCoord(pt: Point) &#123;\n  console.log(&quot;The coordinate&#39;s x value is &quot; + pt.x);\n  console.log(&quot;The coordinate&#39;s y value is &quot; + pt.y);\n&#125;\n\nprintCoord(&#123; x: 100, y: 100 &#125;);\n\nJust like when we used a type alias above, the example works just as if we had used an anonymous object type. TypeScript is only concerned with the structure of the value we passed to printCoord - it only cares that it has the expected properties. Being concerned only with the structure and capabilities of types is why we call TypeScript a structurally typed type system.\nDifferences Between Type Aliases and Interfacesç±»å‹åˆ«åå’Œæ¥å£çš„åŒºåˆ«\nType aliases and interfaces are very similar, and in many cases you can choose between them freely. Almost all features of an interface are available in type, the key distinction is that a type cannot be re-opened to add new properties vs an interface which is always extendable.\nInterface\n&#x2F;&#x2F; Extending an interface\n\ninterface Animal &#123;\n  name: string;\n&#125;\n\ninterface Bear extends Animal &#123;\n  honey: boolean;\n&#125;\n\nconst bear &#x3D; getBear();\nbear.name;\nbear.honey;\n\nType\n&#x2F;&#x2F; Extending a type via intersections\n\ntype Animal &#x3D; &#123;\n  name: string;\n&#125;;\n\ntype Bear &#x3D; Animal &amp; &#123;\n  honey: boolean;\n&#125;;\n\nconst bear &#x3D; getBear();\nbear.name;\nbear.honey;\n\nAdding new fields to an existing interface\ninterface Window &#123;\n  title: string;\n&#125;\n\ninterface Window &#123;\n  ts: TypeScriptAPI;\n&#125;\n\nconst src &#x3D; &#39;const a &#x3D; &quot;Hello World&quot;&#39;;\nwindow.ts.transpileModule(src, &#123;&#125;);\n\nA type cannot be changed after being created\ntype Window &#x3D; &#123;\n  title: string;\n&#125;;\n\ntype Window &#x3D; &#123;\n  ts: TypeScriptAPI;\n&#125;;\n\n&#x2F;&#x2F; Error: Duplicate identifier &#39;Window&#39;.\n\nYouâ€™ll learn more about these concepts in later chapters, so donâ€™t worry if you donâ€™t understand all of these right away.\n\nPrior to TypeScript version 4.2, type alias names may appear in error messages, sometimes in place of the equivalent anonymous type (which may or may not be desirable). Interfaces will always be named in error messages.\nType aliases may not participate in declaration merging, but interfaces can.\nInterfaces may only be used to declare the shapes of objects, not rename primitives.\nInterface names will always appear in their original form in error messages, but only when they are used by name.\n\nFor the most part, you can choose based on personal preference, and TypeScript will tell you if it needs something to be the other kind of declaration. If you would like a heuristic, use interface until you need to use features from type.\nType Assertionsç±»å‹æ–­è¨€\nSometimes you will have information about the type of a value that TypeScript canâ€™t know about.\nFor example, if youâ€™re using document.getElementById, TypeScript only knows that this will return some kind of HTMLElement, but you might know that your page will always have an HTMLCanvasElement with a given ID.\nIn this situation, you can use a type assertion to specify a more specific type:\nconst myCanvas &#x3D; document.getElementById(&quot;main_canvas&quot;) as HTMLCanvasElement;\n\nLike a type annotation, type assertions are removed by the compiler and wonâ€™t affect the runtime behavior of your code.\nYou can also use the angle-bracket syntax (except if the code is in a .tsx file), which is equivalent:\nconst myCanvas &#x3D; &lt;HTMLCanvasElement&gt;document.getElementById(&quot;main_canvas&quot;);\n\nReminder: Because type assertions are removed at compile-time, there is no runtime checking associated with a type assertion. There wonâ€™t be an exception or null generated if the type assertion is wrong.\nTypeScript only allows type assertions which convert to a more specific or less specific version of a type. This rule prevents â€œimpossibleâ€ coercions like:\nconst x &#x3D; &quot;hello&quot; as number;\n&#x2F;&#x2F; Conversion of type &#39;string&#39; to type &#39;number&#39; may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to &#39;unknown&#39; first.\n\nSometimes this rule can be too conservative and will disallow more complex coercions that might be valid. If this happens, you can use two assertions, first to any (or unknown, which weâ€™ll introduce later), then to the desired type:\nconst a &#x3D; expr as any as T;\n\nLiteral Typeså­—é¢é‡ç±»å‹\nIn addition to the general types string and number, we can refer to specific strings and numbers in type positions.\nOne way to think about this is to consider how JavaScript comes with different ways to declare a variable. Both var and let allow for changing what is held inside the variable, and const does not. This is reflected in how TypeScript creates types for literals.\nlet changingString &#x3D; &quot;Hello World&quot;;\nchangingString &#x3D; &quot;OlÃ¡ Mundo&quot;;\n&#x2F;&#x2F; Because &#96;changingString&#96; can represent any possible string, that\n&#x2F;&#x2F; is how TypeScript describes it in the type system\nchangingString;\n\nlet changingString: string;\n\nconst constantString &#x3D; &quot;Hello World&quot;;\n&#x2F;&#x2F; Because &#96;constantString&#96; can only represent 1 possible string, it\n&#x2F;&#x2F; has a literal type representation\nconstantString;\n\nconst constantString: &quot;Hello World&quot;;\n\nBy themselves, literal types arenâ€™t very valuable:\nlet x: &quot;hello&quot; &#x3D; &quot;hello&quot;;\n&#x2F;&#x2F; OK\nx &#x3D; &quot;hello&quot;;\n&#x2F;&#x2F; ...\nx &#x3D; &quot;howdy&quot;;\n&#x2F;&#x2F; Type &#39;&quot;howdy&quot;&#39; is not assignable to type &#39;&quot;hello&quot;&#39;.\n\nItâ€™s not much use to have a variable that can only have one value!\nBut by combining literals into unions, you can express a much more useful concept - for example, functions that only accept a certain set of known values:\nfunction printText(s: string, alignment: &quot;left&quot; | &quot;right&quot; | &quot;center&quot;) &#123;\n  &#x2F;&#x2F; ...\n&#125;\nprintText(&quot;Hello, world&quot;, &quot;left&quot;);\nprintText(&quot;G&#39;day, mate&quot;, &quot;centre&quot;);\nArgument of type &#39;&quot;centre&quot;&#39; is not assignable to parameter of type &#39;&quot;left&quot; | &quot;right&quot; | &quot;center&quot;&#39;.\n\nNumeric literal types work the same way:\nfunction compare(a: string, b: string): -1 | 0 | 1 &#123;\n  return a &#x3D;&#x3D;&#x3D; b ? 0 : a &gt; b ? 1 : -1;\n&#125;\n\nOf course, you can combine these with non-literal types:\ninterface Options &#123;\n  width: number;\n&#125;\nfunction configure(x: Options | &quot;auto&quot;) &#123;\n  &#x2F;&#x2F; ...\n&#125;\nconfigure(&#123; width: 100 &#125;);\nconfigure(&quot;auto&quot;);\nconfigure(&quot;automatic&quot;);\nArgument of type &#39;&quot;automatic&quot;&#39; is not assignable to parameter of type &#39;Options | &quot;auto&quot;&#39;.\n\nThereâ€™s one more kind of literal type: boolean literals. There are only two boolean literal types, and as you might guess, they are the types true and false. The type boolean itself is actually just an alias for the union true | false.\nLiteral Inferenceå­—é¢é‡æ¨æ–­When you initialize a variable with an object, TypeScript assumes that the properties of that object might change values later. For example, if you wrote code like this:\nconst obj &#x3D; &#123; counter: 0 &#125;;\nif (someCondition) &#123;\n  obj.counter &#x3D; 1;\n&#125;\n\nTypeScript doesnâ€™t assume the assignment of 1 to a field which previously had 0 is an error. Another way of saying this is that obj.counter must have the type number, not 0, because types are used to determine both reading and writing behavior.\nThe same applies to strings:\nconst req &#x3D; &#123; url: &quot;https:&#x2F;&#x2F;example.com&quot;, method: &quot;GET&quot; &#125;;\nhandleRequest(req.url, req.method);\nArgument of type &#39;string&#39; is not assignable to parameter of type &#39;&quot;GET&quot; | &quot;POST&quot;&#39;.\n\nIn the above example req.method is inferred to be string, not â€œGETâ€. Because code can be evaluated between the creation of req and the call of handleRequest which could assign a new string like â€œGUESSâ€ to req.method, TypeScript considers this code to have an error.\nThere are two ways to work around this.\nYou can change the inference by adding a type assertion in either location:\n&#x2F;&#x2F; Change 1:\nconst req &#x3D; &#123; url: &quot;https:&#x2F;&#x2F;example.com&quot;, method: &quot;GET&quot; as &quot;GET&quot; &#125;;\n&#x2F;&#x2F; Change 2\nhandleRequest(req.url, req.method as &quot;GET&quot;);\n\nChange 1 means â€œI intend for req.method to always have the literal type â€œGETâ€â€, preventing the possible assignment of â€œGUESSâ€ to that field after. Change 2 means â€œI know for other reasons that req.method has the value â€œGETâ€â€œ.\nYou can use as const to convert the entire object to be type literals:\nconst req &#x3D; &#123; url: &quot;https:&#x2F;&#x2F;example.com&quot;, method: &quot;GET&quot; &#125; as const;\nhandleRequest(req.url, req.method);\n\nThe as const suffix acts like const but for the type system, ensuring that all properties are assigned the literal type instead of a more general version like string or number.\nnull and undefinednullå’Œundefined\nJavaScript has two primitive values used to signal absent or uninitialized value: null and undefined.\nTypeScript has two corresponding types by the same names. How these types behave depends on whether you have the strictNullChecks option on.\nstrictNullChecks offstrictNullCheckså…³é—­\nWith strictNullChecks off, values that might be null or undefined can still be accessed normally, and the values null and undefined can be assigned to a property of any type. This is similar to how languages without null checks (e.g. C#, Java) behave. The lack of checking for these values tends to be a major source of bugs; we always recommend people turn strictNullChecks on if itâ€™s practical to do so in their codebase.\nstrictNullChecks onstrictNullCheckså¼€å¯\nWith strictNullChecks on, when a value is null or undefined, you will need to test for those values before using methods or properties on that value. Just like checking for undefined before using an optional property, we can use narrowing to check for values that might be null:\nfunction doSomething(x: string | null) &#123;\n  if (x &#x3D;&#x3D;&#x3D; null) &#123;\n    &#x2F;&#x2F; do nothing\n  &#125; else &#123;\n    console.log(&quot;Hello, &quot; + x.toUpperCase());\n  &#125;\n&#125;\n\nNon-null Assertion Operator (Postfix !)éç©ºæ–­è¨€è¿ç®—ç¬¦\nTypeScript also has a special syntax for removing null and undefined from a type without doing any explicit checking. Writing ! after any expression is effectively a type assertion that the value isnâ€™t null or undefined:\nfunction liveDangerously(x?: number | null) &#123;\n  &#x2F;&#x2F; No error\n  console.log(x!.toFixed());\n&#125;\n\nJust like other type assertions, this doesnâ€™t change the runtime behavior of your code, so itâ€™s important to only use ! when you know that the value canâ€™t be null or undefined.\nEnumsæšä¸¾\nEnums are a feature added to JavaScript by TypeScript which allows for describing a value which could be one of a set of possible named constants. Unlike most TypeScript features, this is not a type-level addition to JavaScript but something added to the language and runtime. Because of this, itâ€™s a feature which you should know exists, but maybe hold off on using unless you are sure. You can read more about enums in the Enum reference page.\nLess Common Primitivesæ›´å°‘å¸¸è§çš„åŸå§‹ç±»å‹Itâ€™s worth mentioning the rest of the primitives in JavaScript which are represented in the type system. Though we will not go into depth here.\nbigintFrom ES2020 onwards, there is a primitive in JavaScript used for very large integers, BigInt:\n&#x2F;&#x2F; Creating a bigint via the BigInt function\nconst oneHundred: bigint &#x3D; BigInt(100);\n\n&#x2F;&#x2F; Creating a BigInt via the literal syntax\nconst anotherHundred: bigint &#x3D; 100n;\n\nYou can learn more about BigInt in the TypeScript 3.2 release notes.\nsymbolThere is a primitive in JavaScript used to create a globally unique reference via the function Symbol():\nconst firstName &#x3D; Symbol(&quot;name&quot;);\nconst secondName &#x3D; Symbol(&quot;name&quot;);\n\nif (firstName &#x3D;&#x3D;&#x3D; secondName) &#123;\nThis condition will always return &#39;false&#39; since the types &#39;typeof firstName&#39; and &#39;typeof secondName&#39; have no overlap.\n  &#x2F;&#x2F; Can&#39;t ever happen\n&#125;\n\nYou can learn more about them in Symbols reference page.\nå‚è€ƒé“¾æ¥Typescript å¸¸è§ç±»å‹\n","slug":"2022-06-08ts-Everyday Types","date":"2022-06-06T08:40:41.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"3d6d9d5bd9a34b12b2d2da5941501c4f","title":"2.Typescript åŸºç¡€","content":"The BasicsWelcome to the first page of the handbook. If this is your first experience with TypeScript - you may want to start at one of the â€˜Getting Startedâ€™ guidesæ¬¢è¿æ¥åˆ° TypeScript æ‰‹å†Œçš„ç¬¬ä¸€é¡µã€‚å¦‚æœæ‚¨æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ TypeScript - æ‚¨å¯èƒ½æƒ³è¦å¼€å§‹ä¸€ä¸ª&#39;Getting Started&#39;æŒ‡å—\nEach and every value in JavaScript has a set of behaviors you can observe from running different operations. That sounds abstract, but as a quick example, consider some operations we might run on a variable named message.æ¯ä¸ªå’Œæ‰€æœ‰çš„å€¼åœ¨ JavaScript ä¸­éƒ½æœ‰ä¸€ç»„è¡Œä¸ºå¯ä»¥è§‚å¯Ÿä»è¿è¡Œä¸åŒçš„æ“ä½œã€‚è¿™ä¼šæ„Ÿè§‰å¾ˆæŠ½è±¡ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¿«é€Ÿçš„ä¾‹å­ï¼Œè€ƒè™‘ä¸€äº›æˆ‘ä»¬å¯èƒ½è¿è¡Œçš„æ“ä½œçš„å˜é‡åç§° messageã€‚\n&#x2F;&#x2F; Accessing the property &#39;toLowerCase&#39;\n&#x2F;&#x2F; on &#39;message&#39; and then calling it\nmessage.toLowerCase();\n&#x2F;&#x2F; Calling &#39;message&#39;\nmessage();\n\nIf we break this down, the first runnable line of code accesses a property called toLowerCase and then calls it. The second one tries to call message directly.å¦‚æœ æˆ‘ä»¬å°†è¿™ä¸ªåˆ†è§£ï¼Œç¬¬ä¸€ä¸ªå¯è¿è¡Œçš„è¡Œä»£ç è®¿é—®ä¸€ä¸ªå±æ€§å«åš toLowerCase å¹¶ä¸”è°ƒç”¨å®ƒã€‚ç¬¬äºŒä¸ªå°è¯•ç›´æ¥è°ƒç”¨ messageã€‚But assuming we donâ€™t know the value of message - and thatâ€™s pretty common - we canâ€™t reliably say what results weâ€™ll get from trying to run any of this code. The behavior of each operation depends entirely on what value we had in the first place.ä½†æ˜¯å‡è®¾æˆ‘ä»¬ä¸çŸ¥é“ message çš„å€¼ - å¹¶ä¸”è¿™æ˜¯å¾ˆå¸¸è§çš„ - æˆ‘ä»¬ä¸å¯ä»¥å¯é åœ°è¯´ä»€ä¹ˆç»“æœæˆ‘ä»¬ä¼šå¾—åˆ°è¿è¡Œè¿™äº›ä»£ç ã€‚æ¯ä¸ªæ“ä½œçš„è¡Œä¸ºå–å†³äºæˆ‘ä»¬æœ¬èº«çš„å€¼ã€‚\n\nIs message callable? message æ˜¯å¯è°ƒç”¨çš„å—ï¼Ÿ\nDoes it have a property called toLowerCase on it? message æœ‰ä¸€ä¸ªå±æ€§å«åš toLowerCase å—ï¼Ÿ\nIf it does, is toLowerCase even callable? å¦‚æœæ˜¯ï¼Œæ˜¯å¦ toLowerCase å¯è°ƒç”¨ï¼Ÿ\nIf both of these values are callable, what do they return? å¦‚æœè¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯å¯è°ƒç”¨çš„ï¼Œå®ƒä»¬ä¼šè¿”å›ä»€ä¹ˆï¼Ÿ\n\nThe answers to these questions are usually things we keep in our heads when we write JavaScript, and we have to hope we got all the details right.è¿™äº›é—®é¢˜çš„ç­”æ¡ˆé€šå¸¸æ˜¯æˆ‘ä»¬åœ¨å†™ JavaScript æ—¶ä¿ç•™åœ¨æˆ‘ä»¬çš„è„‘ä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬å¿…é¡»å¸Œæœ›æˆ‘ä»¬æ‹¿åˆ°æ‰€æœ‰çš„ç»†èŠ‚æ­£ç¡®ã€‚Letâ€™s say message was defined in the following way.è®©æˆ‘ä»¬å‡è®¾ message è¢«å®šä¹‰ä¸ºä»¥ä¸‹çš„æ–¹å¼ã€‚\nconst message &#x3D; &quot;Hello World!&quot;;\n\nAs you can probably guess, if we try to run message.toLowerCase(), weâ€™ll get the same string only in lower-case.å¦‚æœæˆ‘ä»¬è¯•ç€è¿è¡Œ message.toLowerCase()ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªåªæœ‰å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ã€‚What about that second line of code? If youâ€™re familiar with JavaScript, youâ€™ll know this fails with an exception:å¦‚æœæ‚¨ç†Ÿæ‚‰ JavaScriptï¼Œæ‚¨ä¼šçŸ¥é“è¿™ä¸ªå¤±è´¥äº†ä¸€ä¸ªå¼‚å¸¸ï¼š\n&#x2F;&#x2F; TypeError: message is not a function\n\nItâ€™d be great if we could avoid mistakes like this.æˆ‘ä»¬åº”è¯¥èƒ½é¿å…è¿™æ ·çš„é”™è¯¯ã€‚When we run our code, the way that our JavaScript runtime chooses what to do is by figuring out the type of the value - what sorts of behaviors and capabilities it has. Thatâ€™s part of what that TypeError is alluding to - itâ€™s saying that the string â€œHello World!â€ cannot be called as a function.å½“æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œæˆ‘ä»¬çš„ JavaScript è¿è¡Œæ—¶é€šè¿‡åˆ†æå€¼çš„ç±»å‹æ¥å†³å®šå¦‚ä½•åšã€‚è¿™æ˜¯å®ƒå¼•ç”¨çš„ TypeError çš„ä¸€éƒ¨åˆ† - å®ƒè¯´æ˜ &quot;Hello World!&quot; ä¸èƒ½è¢«è°ƒç”¨ä½œä¸ºå‡½æ•°ã€‚For some values, such as the primitives string and number, we can identify their type at runtime using the typeof operator. But for other things like functions, thereâ€™s no corresponding runtime mechanism to identify their types. For example, consider this function:å¯¹äºæŸäº›å€¼ï¼Œå¦‚å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡ typeof æ“ä½œç¬¦æ¥è¯†åˆ«å®ƒçš„ç±»å‹ã€‚ä½†æ˜¯å¯¹äºå…¶ä»–çš„ä¸œè¥¿ï¼Œæ²¡æœ‰ç›¸åº”çš„è¿è¡Œæ—¶æœºåˆ¶æ¥è¯†åˆ«å®ƒä»¬çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªå‡½æ•°ï¼š\nfunction fn(x) &#123;\n  return x.flip();\n&#125;\n\nWe can observe by reading the code that this function will only work if given an object with a callable flip property, but JavaScript doesnâ€™t surface this information in a way that we can check while the code is running. The only way in pure JavaScript to tell what fn does with a particular value is to call it and see what happens. This kind of behavior makes it hard to predict what code will do before it runs, which means itâ€™s harder to know what your code is going to do while youâ€™re writing it.æˆ‘ä»¬å¯ä»¥é€šè¿‡é˜…è¯»ä»£ç , çœ‹åˆ°è¿™ä¸ªå‡½æ•°åªæœ‰åœ¨ç»™å®šä¸€ä¸ªå¯è°ƒç”¨ flip å±æ€§çš„å¯¹è±¡æ—¶æ‰èƒ½å·¥ä½œï¼Œä½† JavaScript æ²¡æœ‰ä¸€ç§æ–¹å¼å¯ä»¥åœ¨è¿è¡Œä»£ç æ—¶æ¥è¯†åˆ« fn çš„è¡Œä¸ºã€‚åªæœ‰åœ¨è°ƒç”¨å®ƒæ—¶æ‰èƒ½çŸ¥é“ fn çš„è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºéš¾ä»¥é¢„æµ‹ï¼Œè¿™æ„å‘³ç€åœ¨å†™ä»£ç æ—¶éš¾ä»¥çŸ¥é“ä½ çš„ä»£ç ä¼šåšä»€ä¹ˆã€‚Seen in this way, a type is the concept of describing which values can be passed to fn and which will crash. JavaScript only truly provides dynamic typing - running the code to see what happens.åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œä¸€ä¸ªç±»å‹æ˜¯æè¿°å“ªäº›å€¼å¯ä»¥ä¼ ç»™ fnï¼Œå“ªäº›ä¼šå´©æºƒçš„æ¦‚å¿µã€‚JavaScript åªæ˜¯æä¾›äº†åŠ¨æ€ç±»å‹å®šä¹‰ - è¿è¡Œä»£ç æ¥çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚The alternative is to use a static type system to make predictions about what code is expected before it runs.å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨é™æ€ç±»å‹ç³»ç»Ÿæ¥é¢„æµ‹åœ¨è¿è¡Œä»£ç ä¹‹å‰ä¼šå‘ç”Ÿä»€ä¹ˆã€‚\nStatic type-checkingé™æ€ç±»å‹æ£€æŸ¥Think back to that TypeError we got earlier from trying to call a string as a function. Most people donâ€™t like to get any sorts of errors when running their code - those are considered bugs! And when we write new code, we try our best to avoid introducing new bugs.æƒ³èµ·é‚£ä¸ª TypeError æˆ‘ä»¬ä»¥å‰ä»å°è¯•è°ƒç”¨ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‡½æ•°æ—¶å¾—åˆ°çš„ã€‚å¤§å¤šæ•°äººä¸å–œæ¬¢åœ¨è¿è¡Œä»–ä»¬çš„ä»£ç æ—¶å¾—åˆ°ä»»ä½•ç±»å‹çš„é”™è¯¯ï¼Œè¿™äº›é”™è¯¯è¢«ç§°ä¸º bugï¼è€Œå½“æˆ‘ä»¬å†™æ–°ä»£ç æ—¶ï¼Œæˆ‘ä»¬å°½å¯èƒ½åœ°é¿å…å¼•å…¥æ–°çš„ bugã€‚If we add just a bit of code, save our file, re-run the code, and immediately see the error, we might be able to isolate the problem quickly; but thatâ€™s not always the case. We might not have tested the feature thoroughly enough, so we might never actually run into a potential error that would be thrown! Or if we were lucky enough to witness the error, we might have ended up doing large refactorings and adding a lot of different code that weâ€™re forced to dig through.å¦‚æœæˆ‘ä»¬æ·»åŠ äº›ç‚¹ä»£ç ï¼Œä¿å­˜æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œé‡æ–°è¿è¡Œä»£ç ï¼Œå¹¶ç«‹å³çœ‹åˆ°é”™è¯¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¿«é€Ÿåœ°å‘ç°é—®é¢˜ï¼›ä½†è¿™å¹¶ä¸æ€»æ˜¯å¦‚æ­¤ã€‚æˆ‘ä»¬å¯èƒ½æ²¡æœ‰æµ‹è¯•ç‰¹æ€§çš„å……åˆ†ç¨‹åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½æ²¡æœ‰çœŸæ­£å‘ç”Ÿå¯èƒ½ä¼šæŠ›å‡ºçš„é”™è¯¯ï¼æˆ–è€…å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°é”™è¯¯ï¼Œæˆ‘ä»¬å¯èƒ½å·²ç»åšäº†å¤§é‡çš„é‡æ„å’Œæ·»åŠ äº†å¾ˆå¤šä¸åŒçš„ä»£ç ï¼Œæˆ‘ä»¬è¢«è¿«è¦æ¢ç´¢å®ƒä»¬ã€‚Ideally, we could have a tool that helps us find these bugs before our code runs. Thatâ€™s what a static type-checker like TypeScript does. Static types systems describe the shapes and behaviors of what our values will be when we run our programs. A type-checker like TypeScript uses that information and tells us when things might be going off the rails.æœ€å¥½çš„æ–¹å¼æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„ä»£ç è¿è¡Œä¹‹å‰ï¼Œæœ‰ä¸€ä¸ªå·¥å…·å¸®æˆ‘ä»¬æ‰¾åˆ°è¿™äº› bugã€‚è¿™æ˜¯ TypeScript çš„é™æ€ç±»å‹æ£€æŸ¥å™¨åšçš„ã€‚é™æ€ç±»å‹ç³»ç»Ÿæè¿°äº†æˆ‘ä»¬çš„å€¼åœ¨è¿è¡Œæˆ‘ä»¬çš„ç¨‹åºæ—¶çš„å½¢çŠ¶å’Œè¡Œä¸ºã€‚ä¸€ä¸ªç±»å‹æ£€æŸ¥å™¨åƒ TypeScript ä½¿ç”¨è¿™äº›ä¿¡æ¯ï¼Œå‘Šè¯‰æˆ‘ä»¬å½“å¯èƒ½ä¼šå‡ºç°é—®é¢˜æ—¶ã€‚\nconst message &#x3D; &quot;hello!&quot;;\n\nmessage();\n&#x2F;&#x2F; This expression is not callable.\n&#x2F;&#x2F;   Type &#39;String&#39; has no call signatures.\n\nRunning that last sample with TypeScript will give us an error message before we run the code in the first place.è¿è¡Œè¿™ä¸ªæœ€åä¸€ä¸ªç¤ºä¾‹ï¼ŒTypeScript å°†åœ¨ç¬¬ä¸€ä¸ªä»£ç ä¹‹å‰æŠ¥é”™ã€‚\nNon-exception Failureséå¼‚å¸¸å¤±è´¥So far weâ€™ve been discussing certain things like runtime errors - cases where the JavaScript runtime tells us that it thinks something is nonsensical. Those cases come up because the ECMAScript specification has explicit instructions on how the language should behave when it runs into something unexpected.ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½è®¨è®ºäº†ä¸€äº›å…³äºè¿è¡Œæ—¶é”™è¯¯çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´ï¼Œå½“ JavaScript è¿è¡Œæ—¶è®¤ä¸ºæŸäº›ä¸œè¥¿æ˜¯æ— æ•ˆçš„ã€‚è¿™äº›æƒ…å†µå‡ºç°çš„åŸå› æ˜¯ ECMAScript è§„èŒƒæ˜ç¡®æŒ‡å‡ºäº†åœ¨è¿è¡Œæ—¶å¦‚ä½•åº”è¯¥è¡Œä¸ºã€‚For example, the specification says that trying to call something that isnâ€™t callable should throw an error. Maybe that sounds like â€œobvious behaviorâ€, but you could imagine that accessing a property that doesnâ€™t exist on an object should throw an error too. Instead, JavaScript gives us different behavior and returns the value undefined:æ¯”å¦‚è¯´ï¼Œè§„èŒƒæŒ‡å‡ºäº†å°è¯•è°ƒç”¨ä¸å¯è°ƒç”¨çš„ä¸œè¥¿åº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚å¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯â€œæ˜æ˜¾çš„è¡Œä¸ºâ€ï¼Œä½†ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œè®¿é—®ä¸€ä¸ªå¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§åº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚è€Œ JavaScript ç»™æˆ‘ä»¬ä¸åŒçš„è¡Œä¸ºï¼Œè¿”å›å€¼ undefinedï¼š\nconst user &#x3D; &#123;\n  name: &quot;Daniel&quot;,\n  age: 26,\n&#125;;\nuser.location; &#x2F;&#x2F; returns undefined\n\nUltimately, a static type system has to make the call over what code should be flagged as an error in its system, even if itâ€™s â€œvalidâ€ JavaScript that wonâ€™t immediately throw an error. In TypeScript, the following code produces an error about location not being defined:æœ€ç»ˆï¼Œä¸€ä¸ªé™æ€ç±»å‹ç³»ç»Ÿå¿…é¡»è¦åœ¨å®ƒçš„ç³»ç»Ÿä¸­ï¼Œå‘Šè¯‰æˆ‘ä»¬åº”è¯¥æŠŠå“ªäº›ä»£ç æ ‡è®°ä¸ºé”™è¯¯çš„ä»£ç ï¼Œå³ä½¿å®ƒæ˜¯â€œæœ‰æ•ˆçš„ JavaScriptâ€ï¼Œä¹Ÿä¸ä¼šç«‹å³æŠ›å‡ºé”™è¯¯ã€‚åœ¨ TypeScript ä¸­ï¼Œä¸‹é¢çš„ä»£ç ä¼šæŠ¥é”™ï¼š\nconst user &#x3D; &#123;\n  name: &quot;Daniel&quot;,\n  age: 26,\n&#125;;\n\nuser.location;\n&#x2F;&#x2F; Property &#39;location&#39; does not exist on type &#39;&#123; name: string; age: number; &#125;&#39;.\n\nWhile sometimes that implies a trade-off in what you can express, the intent is to catch legitimate bugs in our programs. And TypeScript catches a lot of legitimate bugs.åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªäº¤æ¢ï¼Œåœ¨ä½ èƒ½è¡¨è¾¾çš„èŒƒå›´å†…ï¼Œåœ¨ä½ çš„ç¨‹åºä¸­ï¼Œä½ å¯ä»¥æŠŠä¸€äº›æœ‰æ•ˆçš„ JavaScript æŠ›å‡ºé”™è¯¯ã€‚è€Œ TypeScript æ•è·å¾ˆå¤šæœ‰æ•ˆçš„é”™è¯¯ã€‚For example: typos,æ¯”å¦‚è¯´ï¼Œæ‹¼å†™é”™è¯¯ï¼Œ\nconst announcement &#x3D; &quot;Hello World!&quot;;\n\n&#x2F;&#x2F; How quickly can you spot the typos?\nannouncement.toLocaleLowercase();\nannouncement.toLocalLowerCase();\n\n&#x2F;&#x2F; We probably meant to write this...\nannouncement.toLocaleLowerCase();\n\nuncalled functions,æœªè°ƒç”¨çš„å‡½æ•°ï¼Œ\nfunction flipCoin() &#123;\n  &#x2F;&#x2F; Meant to be Math.random()\n  return Math.random &lt; 0.5;\n  &#x2F;&#x2F; Operator &#39;&lt;&#39; cannot be applied to types &#39;() &#x3D;&gt; number&#39; and &#39;number&#39;.\n&#125;\n\nor basic logic errors.æˆ–åŸºæœ¬çš„é€»è¾‘é”™è¯¯ã€‚\nconst value &#x3D; Math.random() &lt; 0.5 ? &quot;a&quot; : &quot;b&quot;;\nif (value !&#x3D;&#x3D; &quot;a&quot;) &#123;\n  &#x2F;&#x2F; ...\n&#125; else if (value &#x3D;&#x3D;&#x3D; &quot;b&quot;) &#123;\n  &#x2F;&#x2F; This condition will always return &#39;false&#39; since the types &#39;&quot;a&quot;&#39; and &#39;&quot;b&quot;&#39; have no overlap.\n  &#x2F;&#x2F; Oops, unreachable\n&#125;\n\nTypes for Toolingç±»å‹ä¸ºå·¥å…·TypeScript can catch bugs when we make mistakes in our code. Thatâ€™s great, but TypeScript can also prevent us from making those mistakes in the first place.TypeScript å¯ä»¥æ•è·æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­åšé”™è¯¯çš„é”™è¯¯ã€‚è¿™å¾ˆå¥½ï¼Œä½† TypeScript å¯ä»¥é˜²æ­¢æˆ‘ä»¬åšé”™è¯¯ã€‚The type-checker has information to check things like whether weâ€™re accessing the right properties on variables and other properties. Once it has that information, it can also start suggesting which properties you might want to use.ç±»å‹æ£€æŸ¥å™¨æœ‰ä¿¡æ¯æ¥æ£€æŸ¥å˜é‡å’Œå…¶ä»–å±æ€§æ˜¯å¦æ­£ç¡®ã€‚ä¸€æ—¦æœ‰è¿™äº›ä¿¡æ¯ï¼Œå®ƒä¹Ÿå¯ä»¥å¼€å§‹æå»ºè®®ä½ åº”è¯¥ä½¿ç”¨å“ªäº›å±æ€§ã€‚That means TypeScript can be leveraged for editing code too, and the core type-checker can provide error messages and code completion as you type in the editor. Thatâ€™s part of what people often refer to when they talk about tooling in TypeScript.è¿™æ„å‘³ç€ TypeScript å¯ä»¥ç”¨äºç¼–è¾‘ä»£ç ï¼Œå¹¶ä¸”æ ¸å¿ƒç±»å‹æ£€æŸ¥å™¨å¯ä»¥æä¾›é”™è¯¯æ¶ˆæ¯å’Œä»£ç è¡¥å…¨ã€‚è¿™æ˜¯äººä»¬é€šå¸¸åœ¨è¯´è®¨è®ºå·¥å…·æ—¶æ‰€æåˆ°çš„ã€‚\nimport express from &quot;express&quot;;\nconst app &#x3D; express();\n\napp.get(&quot;&#x2F;&quot;, function (req, res) &#123;\n  res.sen\n    &#x2F;&#x2F; send\n    &#x2F;&#x2F; sendDate\n    &#x2F;&#x2F; sendfile\n    &#x2F;&#x2F; sendFile\n    &#x2F;&#x2F; sendStatus\n&#125;);\n\napp.\n\nTypeScript takes tooling seriously, and that goes beyond completions and errors as you type. An editor that supports TypeScript can deliver â€œquick fixesâ€ to automatically fix errors, refactorings to easily re-organize code, and useful navigation features for jumping to definitions of a variable, or finding all references to a given variable. All of this is built on top of the type-checker and is fully cross-platform, so itâ€™s likely that your favorite editor has TypeScript support available.TypeScript ä¹Ÿæ·±æ·±åœ°è®¤è¯†åˆ°å·¥å…·ï¼Œå¹¶ä¸”è¿™ä¹ŸåŒ…æ‹¬äº†å®Œæˆå’Œé”™è¯¯çš„è¡¥å…¨ï¼Œä½ åœ¨è¾“å…¥æ—¶å¯ä»¥è‡ªåŠ¨ä¿®å¤é”™è¯¯ï¼Œé‡æ–°ç»„ç»‡ä»£ç ï¼Œä»¥åŠå¯»æ‰¾å˜é‡çš„å®šä¹‰ï¼Œæˆ–å¯»æ‰¾æ‰€æœ‰å¼•ç”¨çš„å˜é‡ã€‚è¿™å…¨éƒ¨æ˜¯åŸºäºç±»å‹æ£€æŸ¥å™¨çš„ï¼Œå¹¶ä¸”æ˜¯å®Œå…¨çš„è·¨å¹³å°ï¼Œæ‰€ä»¥ä½ å¯èƒ½å–œæ¬¢çš„ç¼–è¾‘å™¨æœ‰ TypeScript çš„æ”¯æŒã€‚\ntsc, the TypeScript compilertscï¼ŒTypeScript ç¼–è¯‘å™¨Weâ€™ve been talking about type-checking, but we havenâ€™t yet used our type-checker. Letâ€™s get acquainted with our new friend tsc, the TypeScript compiler. First weâ€™ll need to grab it via npm.æˆ‘ä»¬å·²ç»è®²è¿°äº†ç±»å‹æ£€æŸ¥ï¼Œä½†æˆ‘ä»¬è¿˜æ²¡æœ‰ä½¿ç”¨æˆ‘ä»¬çš„ç±»å‹æ£€æŸ¥å™¨ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡ npm æ¥è·å– tscï¼ŒTypeScript ç¼–è¯‘å™¨ã€‚\nnpm install -g typescript\n\nThis installs the TypeScript Compiler tsc globally. You can use npx or similar tools if youâ€™d prefer to run tsc from a local node_modules package instead.è¿™å°†å®‰è£… TypeScript ç¼–è¯‘å™¨ tsc åœ¨å…¨å±€ã€‚å¦‚æœä½ æƒ³ä»æœ¬åœ°çš„ node_modules åŒ…é‡Œè¿è¡Œ tscï¼Œå¯ä»¥ä½¿ç”¨ npx æˆ–ç±»ä¼¼çš„å·¥å…·ã€‚Now letâ€™s move to an empty folder and try writing our first TypeScript program: hello.ts:ç°åœ¨æˆ‘ä»¬ç§»åŠ¨åˆ°ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œå¹¶å°è¯•å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª TypeScript ç¨‹åºï¼šhello.tsï¼š\n&#x2F;&#x2F; Greets the world.\nconsole.log(&quot;Hello world!&quot;);\n\nNotice there are no frills here; this â€œhello worldâ€ program looks identical to what youâ€™d write for a â€œhello worldâ€ program in JavaScript. And now letâ€™s type-check it by running the command tsc which was installed for us by the typescript package.é€šè¿‡è¿è¡Œ tsc å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æˆ‘ä»¬çš„ç¨‹åºã€‚\ntsc hello.ts\n\n\nTada!æ‹æ‹æ‹ï¼Wait, â€œtadaâ€ what exactly? We ran tsc and nothing happened! Well, there were no type errors, so we didnâ€™t get any output in our console since there was nothing to report.ç­‰ç­‰ï¼Œâ€œæ‹æ‹æ‹â€ï¼Œä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬è¿è¡Œ tscï¼Œæ²¡æœ‰ä»»ä½•äº‹æƒ…å‘ç”Ÿï¼But check again - we got some file output instead. If we look in our current directory, weâ€™ll see a hello.js file next to hello.ts. Thatâ€™s the output from our hello.ts file after tsc compiles or transforms it into a plain JavaScript file. And if we check the contents, weâ€™ll see what TypeScript spits out after it processes a .ts file:ä½†å†æ£€æŸ¥ä¸€æ¬¡ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ª hello.js æ–‡ä»¶ï¼Œå®ƒåœ¨ hello.ts åé¢ã€‚è¿™æ˜¯ tsc ç¼–è¯‘æˆ–è½¬æ¢æˆä¸€ä¸ªçº¯ JavaScript æ–‡ä»¶çš„ hello.ts çš„è¾“å‡ºã€‚å¦‚æœæˆ‘ä»¬æ£€æŸ¥å†…å®¹ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° TypeScript åœ¨å¤„ç† .ts æ–‡ä»¶åæ‰“å°å‡ºæ¥çš„å†…å®¹ï¼š\n&#x2F;&#x2F; Greets the world.\nconsole.log(&quot;Hello world!&quot;);\n\nIn this case, there was very little for TypeScript to transform, so it looks identical to what we wrote. The compiler tries to emit clean readable code that looks like something a person would write. While thatâ€™s not always so easy, TypeScript indents consistently, is mindful of when our code spans across different lines of code, and tries to keep comments around.åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScript å°è¯•è¾“å‡ºä¸€ä¸ªæ¸…æ´çš„å¯è¯»ä»£ç ï¼Œçœ‹èµ·æ¥åƒä¸€ä¸ªäººå†™çš„ä»£ç ã€‚è¿™å¹¶ä¸æ€»æ˜¯å¦‚æ­¤ç®€å•ï¼ŒTypeScript ç¼©è¿›ä¸€è‡´ï¼Œæ³¨æ„ä»£ç çš„ä¸åŒè¡Œï¼Œå¹¶å°è¯•ä¿æŒæ³¨é‡Šåœ¨åŒä¸€è¡Œã€‚What about if we did introduce a type-checking error? Letâ€™s rewrite hello.ts:å¦‚æœæˆ‘ä»¬æŠŠ hello.ts ä¸­çš„ console.log æ”¹æˆ console.logsï¼Œæˆ‘ä»¬ä¼šå‘ç°ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å†æ¬¡é‡å†™ hello.tsï¼š\n&#x2F;&#x2F; This is an industrial-grade general-purpose greeter function:\nfunction greet(person, date) &#123;\n  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date&#125;!&#96;);\n&#125;\n\ngreet(&quot;Brendan&quot;);\n\nIf we run tsc hello.ts again, notice that we get an error on the command line!å¦‚æœæˆ‘ä»¬è¿è¡Œ tsc hello.ts å†æ¬¡ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨å‘½ä»¤è¡Œä¸Šå‡ºç°ä¸€ä¸ªé”™è¯¯ï¼\nExpected 2 arguments, but got 1.\n\nTypeScript is telling us we forgot to pass an argument to the greet function, and rightfully so. So far weâ€™ve only written standard JavaScript, and yet type-checking was still able to find problems with our code. Thanks TypeScript!TypeScript æé†’æˆ‘ä»¬æ²¡æœ‰ä¼ é€’å‚æ•°ç»™ greet å‡½æ•°ï¼Œå¹¶ä¸”æ­£ç¡®åœ°ã€‚ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬åªå†™äº†æ ‡å‡† JavaScriptï¼Œç„¶è€Œç±»å‹æ£€æŸ¥ä»ç„¶å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬çš„ä»£ç çš„é—®é¢˜ã€‚æ„Ÿè°¢ TypeScriptï¼\nEmitting with Errorså‘å°„é”™è¯¯One thing you might not have noticed from the last example was that our hello.js file changed again. If we open that file up then weâ€™ll see that the contents still basically look the same as our input file. That might be a bit surprising given the fact that tsc reported an error about our code, but this is based on one of TypeScriptâ€™s core values: much of the time, you will know better than TypeScript.ä¸€ä¸ªä½ å¯èƒ½æ²¡æœ‰æ³¨æ„åˆ°çš„äº‹æƒ…æ˜¯ï¼Œæˆ‘ä»¬çš„ hello.js æ–‡ä»¶å˜äº†ä¸€æ¬¡ã€‚å¦‚æœæˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒçš„å†…å®¹ä»ç„¶åŸºæœ¬å’Œæˆ‘ä»¬çš„è¾“å…¥æ–‡ä»¶ä¸€æ ·ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆç³Ÿçš„æƒ…å†µï¼Œå› ä¸º tsc æŠ¥å‘Šäº†æˆ‘ä»¬çš„ä»£ç çš„é”™è¯¯ï¼Œä½†è¿™æ˜¯åŸºäº TypeScript çš„æ ¸å¿ƒå€¼ï¼šå¾ˆå¤šæ—¶å€™ï¼Œä½ ä¼šæ›´äº†è§£æ›´å¤šçš„äº‹æƒ…ã€‚To reiterate from earlier, type-checking code limits the sorts of programs you can run, and so thereâ€™s a tradeoff on what sorts of things a type-checker finds acceptable. Most of the time thatâ€™s okay, but there are scenarios where those checks get in the way. For example, imagine yourself migrating JavaScript code over to TypeScript and introducing type-checking errors. Eventually youâ€™ll get around to cleaning things up for the type-checker, but that original JavaScript code was already working! Why should converting it over to TypeScript stop you from running it?é‡å¤ä¸Šä¸€æ®µå†…å®¹ï¼Œç±»å‹æ£€æŸ¥ä»£ç é™åˆ¶äº†ä½ å¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Œå› æ­¤æœ‰ä¸€ä¸ªäº¤æ¢ï¼Œå¦‚æœä½ çš„ç±»å‹æ£€æŸ¥å™¨æ‰¾åˆ°äº†å¯æ¥å—çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ï¼Œè¿™äº›æ£€æŸ¥ä¼šæ‹–æ…¢ä½ çš„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ˜¯ä¸€ä¸ª JavaScript çš„ç§»æ¤è€…ï¼Œå¹¶ä¸”ä½ æŠŠç±»å‹æ£€æŸ¥é”™è¯¯æ’å…¥åˆ°ä½ çš„ä»£ç ä¸­ã€‚æœ€ç»ˆï¼Œä½ ä¼šæŠŠå®ƒä»¬æ¸…ç†æ‰ï¼Œä½†æ˜¯åŸæ¥çš„ JavaScript ä»£ç å·²ç»å·²ç»æ­£å¸¸è¿è¡Œäº†ï¼ä¸ºä»€ä¹ˆä½ ä¼šæŠŠå®ƒç§»æ¤åˆ° TypeScript ä¸­ï¼Œç„¶ååœæ­¢è¿è¡Œå®ƒï¼ŸSo TypeScript doesnâ€™t get in your way. Of course, over time, you may want to be a bit more defensive against mistakes, and make TypeScript act a bit more strictly. In that case, you can use the noEmitOnError compiler option. Try changing your hello.ts file and running tsc with that flag:å› æ­¤ï¼ŒTypeScript ä¸ä¼šæ‹–æ…¢ä½ ã€‚ä½†æ˜¯ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦æ›´åŠ å®‰å…¨ï¼Œå¹¶ä¸”ä½¿ TypeScript å˜å¾—æ›´ä¸¥æ ¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ noEmitOnError ç¼–è¯‘å™¨é€‰é¡¹ã€‚è¯•ç€æŠŠ hello.ts æ–‡ä»¶ä¸­çš„ä»£ç æ”¹ä¸€ä¸‹ï¼Œç„¶åè¿è¡Œ tsc å¹¶ä¸”ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼š\ntsc --noEmitOnError hello.ts\n\nYouâ€™ll notice that hello.js never gets updated.hello.js ä¸ä¼šè¢«æ›´æ–°ã€‚\nExplicit Typesæ˜¾å¼ç±»å‹Up until now, we havenâ€™t told TypeScript what person or date are. Letâ€™s edit the code to tell TypeScript that person is a string, and that date should be a Date object. Weâ€™ll also use the toDateString() method on date.ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½æ²¡æœ‰å‘Šè¯‰ TypeScript ä»€ä¹ˆæ˜¯äººæˆ–æ—¥æœŸã€‚æˆ‘ä»¬ç°åœ¨ç¼–è¾‘ä»£ç ï¼Œè®© TypeScript çŸ¥é“ person æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œ date åº”è¯¥æ˜¯ä¸€ä¸ª Date å¯¹è±¡ã€‚æˆ‘ä»¬ä¹Ÿä½¿ç”¨ date çš„ toDateString() æ–¹æ³•ã€‚\nfunction greet(person: string, date: Date) &#123;\n  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);\n&#125;\n\nWhat we did was add type annotations on person and date to describe what types of values greet can be called with. You can read that signature as â€greet takes a person of type string, and a date of type Dateâ€œ.æˆ‘ä»¬åšäº†ä¸€ä¸ªç±»å‹æ ‡æ³¨ï¼Œè®© TypeScript çŸ¥é“ greet å¯ä»¥è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œperson çš„ç±»å‹æ˜¯ stringï¼Œè€Œ date çš„ç±»å‹æ˜¯ Dateã€‚With this, TypeScript can tell us about other cases where greet might have been called incorrectly. For exampleâ€¦è¿™æ ·ï¼ŒTypeScript å¯ä»¥å‘Šè¯‰æˆ‘ä»¬å…¶ä»–æƒ…å†µä¸‹ greet å¯èƒ½ä¼šè¢«è°ƒç”¨é”™è¯¯ã€‚ä¾‹å¦‚â€¦\nfunction greet(person: string, date: Date) &#123;\n  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);\n&#125;\ngreet(&quot;Maddison&quot;, Date());\n&#x2F;&#x2F; Argument of type &#39;string&#39; is not assignable to parameter of type &#39;Date&#39;.\n\nHuh? TypeScript reported an error on our second argument, but why?å“ï¼ŸTypeScript åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸ŠæŠ¥é”™äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆï¼ŸPerhaps surprisingly, calling Date() in JavaScript returns a string. On the other hand, constructing a Date with new Date() actually gives us what we were expecting.å¯èƒ½å°±æ˜¯å› ä¸º JavaScript ä¸­çš„ Date() è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œ new Date() åˆ™ä¼šè¿”å›æˆ‘ä»¬æœŸæœ›çš„ç»“æœã€‚Anyway, we can quickly fix up the error:ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿä¿®å¤é”™è¯¯ï¼š\nfunction greet(person: string, date: Date) &#123;\n  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);\n&#125;\n\ngreet(&quot;Maddison&quot;, new Date());\n\nKeep in mind, we donâ€™t always have to write explicit type annotations. In many cases, TypeScript can even just infer (or â€œfigure outâ€) the types for us even if we omit them.è®°ä½ï¼Œæˆ‘ä»¬ä¸æ˜¯æ€»æ˜¯è¦å†™æ˜ç±»å‹æ ‡æ³¨ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒTypeScript ä¹Ÿå¯ä»¥è‡ªåŠ¨æ¨æ–­ï¼ˆæˆ–è€…è¯´è®¤ä¸ºï¼‰ç±»å‹ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰å†™æ˜ç±»å‹æ ‡æ³¨ã€‚\nlet msg &#x3D; &quot;hello there!&quot;;\n\nlet msg: string;\n\nEven though we didnâ€™t tell TypeScript that msg had the type string it was able to figure that out. Thatâ€™s a feature, and itâ€™s best not to add annotations when the type system would end up inferring the same type anyway.å³ä½¿æˆ‘ä»¬æ²¡æœ‰å‘Šè¯‰ TypeScript msg çš„ç±»å‹æ˜¯ stringï¼Œå®ƒä¹Ÿèƒ½å¤Ÿè‡ªåŠ¨æ¨æ–­å‡ºæ¥ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œå¹¶ä¸”å½“ç±»å‹ç³»ç»Ÿè‡ªåŠ¨æ¨æ–­å‡ºç›¸åŒç±»å‹çš„æ—¶å€™ï¼Œä¸è¦å†™æ˜ç±»å‹æ ‡æ³¨ã€‚:::tip\nthe message bubble inside the code sample above. That is what your editor would show if you had hovered over the word.åœ¨ä¸Šé¢çš„ä»£ç æ®µä¸­ï¼Œä½ çš„ç¼–è¾‘å™¨ä¼šæ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯æ³¡ã€‚å¦‚æœä½ é¼ æ ‡æ‚¬åœåœ¨è¿™ä¸ªå•è¯ä¸Šï¼Œé‚£ä¹ˆä½ çš„ç¼–è¾‘å™¨ä¼šæ˜¾ç¤ºè¿™ä¸ªæ¶ˆæ¯æ³¡ã€‚:::\nErased Typesæ“¦é™¤ç±»å‹Letâ€™s take a look at what happens when we compile the above function greet with tsc to output JavaScript:æˆ‘ä»¬çœ‹çœ‹å¦‚æœæˆ‘ä»¬ç”¨ tsc ç¼–è¯‘ä¸Šé¢çš„å‡½æ•° greetï¼Œå®ƒä¼šè¾“å‡º JavaScript ä»£ç ï¼š\n&quot;use strict&quot;;\nfunction greet(person, date) &#123;\n  console.log(\n    &quot;Hello &quot;.concat(person, &quot;, today is &quot;).concat(date.toDateString(), &quot;!&quot;)\n  );\n&#125;\ngreet(&quot;Maddison&quot;, new Date());\n\nNotice two things here:æ³¨æ„è¿™é‡Œæœ‰ä¸¤ä»¶äº‹æƒ…ï¼šOur person and date parameters no longer have type annotations.æˆ‘ä»¬çš„ person å’Œ date å‚æ•°æ²¡æœ‰ç±»å‹æ ‡æ³¨ã€‚Our â€œtemplate stringâ€ - that string that used backticks (the character) - was converted to plain strings with concatenations (+).æˆ‘ä»¬çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆä½¿ç”¨ å­—ç¬¦ï¼‰å·²ç»è¢«è½¬æ¢æˆäº†çº¯å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä½¿ç”¨äº† + å­—ç¬¦ä¸²è¿æ¥ã€‚More on that second point later, but letâ€™s now focus on that first point. Type annotations arenâ€™t part of JavaScript (or ECMAScript to be pedantic), so there really arenâ€™t any browsers or other runtimes that can just run TypeScript unmodified. Thatâ€™s why TypeScript needs a compiler in the first place - it needs some way to strip out or transform any TypeScript-specific code so that you can run it. Most TypeScript-specific code gets erased away, and likewise, here our type annotations were completely erased.TypeScript ä¸æ˜¯ JavaScriptï¼ˆæˆ–è€…è¯´ ECMAScriptï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰æµè§ˆå™¨æˆ–å…¶ä»–è¿è¡Œæ—¶å¯ä»¥ç›´æ¥è¿è¡Œ TypeScript çš„æƒ…å†µã€‚å› æ­¤ TypeScript éœ€è¦ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å»æ‰æˆ–è½¬æ¢ TypeScript çš„ä»»ä½•ç‰¹å®šä»£ç ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒã€‚å¤§å¤šæ•° TypeScript ç‰¹å®šä»£ç éƒ½ä¼šè¢«å»æ‰ï¼Œåä¹‹ï¼Œè¿™é‡Œçš„ç±»å‹æ ‡æ³¨ä¹Ÿä¼šè¢«å»æ‰ã€‚&#96;\n\n\n\n\n\n\nTIP\nRemember: Type annotations never change the runtime behavior of your program.è®°ä½ï¼šç±»å‹æ ‡æ³¨ä¸ä¼šæ”¹å˜ä½ çš„ç¨‹åºçš„è¿è¡Œæ—¶è¡Œä¸ºã€‚\n\nDownlevelingé™çº§One other difference from the above was that our template string was rewritten fromæˆ‘ä»¬çš„æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ä»\n&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;;\n\nto\n&quot;Hello &quot; + person + &quot;, today is &quot; + date.toDateString() + &quot;!&quot;;\n\nWhy did this happen?ä¸ºä»€ä¹ˆè¿™æ ·å‘ç”Ÿäº†ï¼ŸTemplate strings are a feature from a version of ECMAScript called ECMAScript 2015 (a.k.a. ECMAScript 6, ES2015, ES6, etc. - donâ€™t ask). TypeScript has the ability to rewrite code from newer versions of ECMAScript to older ones such as ECMAScript 3 or ECMAScript 5 (a.k.a. ES3 and ES5). This process of moving from a newer or â€œhigherâ€ version of ECMAScript down to an older or â€œlowerâ€ one is sometimes called downleveling.æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ ECMAScript 2015 çš„ä¸€ä¸ªç‰¹æ€§ï¼ˆæˆ–è€…è¯´ ECMAScript 6ï¼ŒES2015ï¼ŒES6 ç­‰ï¼‰ã€‚TypeScript æœ‰èƒ½åŠ›å°†ä»æ›´æ–°çš„ ECMAScript ç§»åˆ°æ›´æ—§çš„ ECMAScriptï¼Œæ¯”å¦‚ ECMAScript 3 æˆ– ECMAScript 5ï¼ˆæˆ–è€…è¯´ ES3 å’Œ ES5ï¼‰ã€‚è¿™ç§ç§»åŠ¨çš„è¿‡ç¨‹ç§°ä¸ºé™çº§ã€‚By default TypeScript targets ES3, an extremely old version of ECMAScript. We could have chosen something a little bit more recent by using the target option. Running with â€“target es2015 changes TypeScript to target ECMAScript 2015, meaning code should be able to run wherever ECMAScript 2015 is supported. So running tsc â€“target es2015 hello.ts gives us the following output:é»˜è®¤æƒ…å†µä¸‹ï¼ŒTypeScript ç›®æ ‡ ES3ï¼Œä¸€ä¸ªéå¸¸è€çš„ ECMAScript ç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ›´æ–°çš„ç‰ˆæœ¬ï¼Œä½¿ç”¨ target é€‰é¡¹ã€‚è¿è¡Œ tsc --target es2015 hello.ts å°±ä¼šå¾—åˆ°ä»¥ä¸‹çš„è¾“å‡ºï¼š\nfunction greet(person, date) &#123;\n  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);\n&#125;\ngreet(&quot;Maddison&quot;, new Date());\n\nWhile the default target is ES3, the great majority of current browsers support ES2015. Most developers can therefore safely specify ES2015 or above as a target, unless compatibility with certain ancient browsers is important.é»˜è®¤ç›®æ ‡æ˜¯ ES3ï¼Œå¤§å¤šæ•°å½“å‰æµè§ˆå™¨éƒ½æ”¯æŒ ES2015ã€‚å¤§å¤šæ•°å¼€å‘äººå‘˜å¯ä»¥å®‰å…¨åœ°æŒ‡å®š ES2015 æˆ–ä»¥ä¸Šä½œä¸ºç›®æ ‡ï¼Œé™¤ééœ€è¦ä¸æŸäº›å¤è€çš„æµè§ˆå™¨å…¼å®¹ã€‚\nStrictnessä¸¥æ ¼Different users come to TypeScript looking for different things in a type-checker. Some people are looking for a more loose opt-in experience which can help validate only some parts of their program, and still have decent tooling. This is the default experience with TypeScript, where types are optional, inference takes the most lenient types, and thereâ€™s no checking for potentially null&#x2F;undefined values. Much like how tsc emits in the face of errors, these defaults are put in place to stay out of your way. If youâ€™re migrating existing JavaScript, that might be a desirable first step.ä¸åŒçš„ç”¨æˆ·åˆ° TypeScript ä¸Šæ¥çœ‹ï¼Œæœ‰ä¸åŒçš„æ„å›¾ã€‚æœ‰äººæƒ³è¦ä¸€ä¸ªæ›´å®½æ¾çš„é€‰æ‹©ï¼Œè¿™å¯ä»¥å¸®åŠ©éªŒè¯æŸäº›éƒ¨åˆ†çš„ç¨‹åºï¼Œå¹¶ä¸”ä»ç„¶æœ‰å¾ˆå¥½çš„å·¥å…·ã€‚è¿™æ˜¯ TypeScript é»˜è®¤çš„è¡Œä¸ºï¼Œå…¶ä¸­ç±»å‹æ˜¯å¯é€‰çš„ï¼Œæ¨æ–­ä¼šæ¥å—æ›´å®½æ¾çš„ç±»å‹ï¼Œå¹¶ä¸”æ²¡æœ‰æ£€æŸ¥å¯èƒ½ null/undefined çš„å€¼ã€‚å’Œ tsc åœ¨å‡ºç°é”™è¯¯çš„æ—¶å€™ä¸€æ ·ï¼Œè¿™äº›é»˜è®¤å€¼è¢«æ”¾åœ¨äº†ä½ çš„è„šè·Ÿä¸Šï¼ˆå…œåº•ï¼šè¿™äº›é»˜è®¤é€‰é¡¹å¹¶ä¸ä¼šé˜»ç¢ä½ çš„å¼€å‘ï¼‰ã€‚å¦‚æœä½ æ­£åœ¨è¿ç§»å·²æœ‰çš„ JavaScriptï¼Œé‚£ä¹ˆè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæœ€ä½³çš„ç¬¬ä¸€æ­¥ã€‚In contrast, a lot of users prefer to have TypeScript validate as much as it can straight away, and thatâ€™s why the language provides strictness settings as well. These strictness settings turn static type-checking from a switch (either your code is checked or not) into something closer to a dial. The further you turn this dial up, the more TypeScript will check for you. This can require a little extra work, but generally speaking it pays for itself in the long run, and enables more thorough checks and more accurate tooling. When possible, a new codebase should always turn these strictness checks on.ä¸åŒçš„ç”¨æˆ·å–œæ¬¢ç«‹åˆ»éªŒè¯ç¨‹åºï¼Œè€Œä¸æ˜¯ç­‰åˆ°æœ€åã€‚è¿™æ˜¯ TypeScript çš„è¯­è¨€æä¾›äº†ä¸¥æ ¼æ€§è®¾ç½®ï¼Œè¿™äº›è®¾ç½®å¯ä»¥æ”¹å˜é™æ€ç±»å‹æ£€æŸ¥çš„è¡Œä¸ºã€‚è¿™äº›è®¾ç½®å¯ä»¥æ”¹å˜é™æ€ç±»å‹æ£€æŸ¥çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¼€å…³ã€‚è¿™äº›è®¾ç½®è¶Šé«˜ï¼ŒTypeScript è¶Šä¼šæ£€æŸ¥æ›´å¤šçš„ä¿¡æ¯ã€‚è¿™å¯èƒ½éœ€è¦ä¸€ç‚¹é¢å¤–çš„å·¥ä½œï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼Œè¿™èƒ½æä¾›æ›´å¥½çš„å·¥å…·ï¼Œå¹¶ä¸”èƒ½æ›´å¥½åœ°æ”¯æŒä½ çš„ä»£ç ã€‚å½“å¯èƒ½çš„æ—¶å€™ï¼Œä¸€ä¸ªæ–°çš„ä»£ç åº”è¯¥æ€»æ˜¯å¼€å¯è¿™äº›ä¸¥æ ¼æ€§æ£€æŸ¥ã€‚TypeScript has several type-checking strictness flags that can be turned on or off, and all of our examples will be written with all of them enabled unless otherwise stated. The strict flag in the CLI, or â€œstrictâ€: true in a tsconfig.json toggles them all on simultaneously, but we can opt out of them individually. The two biggest ones you should know about are noImplicitAny and strictNullChecks.TypeScript æœ‰å¤šä¸ªä¸¥æ ¼æ€§æ ‡å¿—ï¼Œå¯ä»¥å¼€å¯æˆ–å…³é—­ï¼Œæ‰€æœ‰çš„ç¤ºä¾‹éƒ½å°†ä½¿ç”¨æ‰€æœ‰çš„æ ‡å¿—ï¼Œé™¤éç‰¹åˆ«è¯´æ˜ã€‚CLI ä¸­çš„ strict å¼€å…³ï¼Œæˆ– tsconfig.json ä¸­çš„ strict: true å¼€å¯äº†æ‰€æœ‰çš„æ ‡å¿—ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å•ç‹¬å…³é—­å®ƒä»¬ã€‚ä¸¤ä¸ªæœ€å¤§çš„ï¼Œä½ åº”è¯¥çŸ¥é“çš„æ˜¯ noImplicitAny å’Œ strictNullChecksã€‚\nnoImplicitAnyæ— éšå¼anyRecall that in some places, TypeScript doesnâ€™t try to infer types for us and instead falls back to the most lenient type: any. This isnâ€™t the worst thing that can happen - after all, falling back to any is just the plain JavaScript experience anyway.åœ¨æŸäº›åœ°æ–¹ï¼ŒTypeScript ä¸ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œè€Œæ˜¯ä½¿ç”¨æœ€å®½æ¾çš„ç±»å‹ï¼šanyã€‚è¿™å¹¶ä¸æ˜¯æœ€å·®çš„æƒ…å†µï¼Œå› ä¸ºä»ç„¶æ˜¯ JavaScript çš„ç»éªŒã€‚However, using any often defeats the purpose of using TypeScript in the first place. The more typed your program is, the more validation and tooling youâ€™ll get, meaning youâ€™ll run into fewer bugs as you code. Turning on the noImplicitAny flag will issue an error on any variables whose type is implicitly inferred as any.ä½¿ç”¨ any å¾ˆå®¹æ˜“è®©ä½ çš„ç¨‹åºå˜å¾—æ›´åŠ ä¸å¯é ã€‚å› ä¸ºæ›´åŠ ç±»å‹åŒ–çš„ç¨‹åºï¼Œä½ ä¼šå‘ç°æ›´å¤šçš„é”™è¯¯ï¼Œå¹¶ä¸”æ›´åŠ å®¹æ˜“åœ°è°ƒè¯•ã€‚å¼€å¯ noImplicitAny æ ‡å¿—ä¼šåœ¨ä»»ä½•è‡ªåŠ¨æ¨æ–­ç±»å‹ä¸º any çš„å˜é‡ä¸Šå‘å‡ºé”™è¯¯ã€‚\nstrictNullChecksä¸¥æ ¼nullBy default, values like null and undefined are assignable to any other type. This can make writing some code easier, but forgetting to handle null and undefined is the cause of countless bugs in the world - some consider it a billion dollar mistake! The strictNullChecks flag makes handling null and undefined more explicit, and spares us from worrying about whether we forgot to handle null and undefined.é»˜è®¤æƒ…å†µä¸‹ï¼Œnull å’Œ undefined å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ã€‚è¿™å¯ä»¥è®©å†™ä¸€äº›ä»£ç æ›´å®¹æ˜“ï¼Œä½†æ˜¯å¿˜è®°å¤„ç† null å’Œ undefined å°±ä¼šå¯¼è‡´ä¸–ç•Œä¸Šçš„å¾ˆå¤šé”™è¯¯ï¼Œæœ‰äººè®¤ä¸ºè¿™æ˜¯ä¸€ç™¾äº¿ç¾å…ƒé”™è¯¯ï¼ strictNullChecks å¯ä»¥è®©å¤„ç† null å’Œ undefined æ›´åŠ æ˜ç¡®ï¼Œå¹¶ä¸”è®©æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒæ˜¯å¦å¿˜è®°å¤„ç† null å’Œ undefinedã€‚\nå‚è€ƒé“¾æ¥Typescript The Basics\n","slug":"2022-06-07ts-basics","date":"2022-06-06T07:56:08.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"bb89616b2d7e7f4e050ed00ae2d71539","title":"1.Typescriptèµ·æ­¥","content":"è¯´æ˜æ­¤æ–‡åŠåç»­çš„å‡ ç¯‡æ˜¯å¯¹Typescriptå®˜æ–¹åŸæ–‡çš„ç¿»è¯‘ï¼Œæ–¹ä¾¿é˜…è¯»\nGet Startedtypescript èµ·æ­¥ï¼Œåˆ†åˆ«é’ˆå¯¹ 4 ç±»ä¸åŒçš„ç¨‹åºå¼€å‘è€…è¿›è¡Œå¼•å¯¼ï¼Œ å¯¹å·å…¥åº§\n\næ–°æ‰‹ç¨‹åºçŒ¿ï¼Œæ²¡æœ‰æ¥è§¦è¿‡ä»»ä½•å¼€å‘è¯­è¨€\nJS å¼€å‘è€…\nJava&#x2F;C#å¼€å‘ [è·³è¿‡]\nå‡½æ•°å¼ç¼–ç¨‹äººå‘˜\n5 åˆ†é’Ÿå†…äº†è§£ Typescript\n\næ–°æ‰‹ç¨‹åºçŒ¿Congratulations on choosing TypeScript as one of your first languages â€” youâ€™re already making good decisions!ç¥è´ºæ‚¨é€‰æ‹©äº† TypeScript ä½œä¸ºæ‚¨çš„ç¬¬ä¸€ç§è¯­è¨€ï¼Œæ‚¨å·²ç»åšå‡ºäº†ä¼˜ç§€çš„å†³ç­–ï¼Youâ€™ve probably already heard that TypeScript is a â€œflavorâ€ or â€œvariantâ€ of JavaScript. The relationship between TypeScript (TS) and JavaScript (JS) is rather unique among modern programming languages, so learning more about this relationship will help you understand how TypeScript adds to JavaScript.ä½ å¤§æ¦‚å·²ç»å¬è¯´è¿‡ï¼ŒTypeScript æ˜¯ JavaScript çš„ä¸€ä¸ªå˜ä½“ã€‚TypeScript å’Œ JavaScript çš„å…³ç³»æ˜¯åœ¨ç°ä»£ç¼–ç¨‹è¯­è¨€ä¸­éå¸¸ç‹¬ç‰¹çš„ï¼Œæ‰€ä»¥å­¦ä¹ æ›´å¤šå…³äºè¿™ä¸ªå…³ç³»çš„çŸ¥è¯†å°†å¸®åŠ©ä½ äº†è§£ TypeScript å’Œ JavaScript çš„åŒºåˆ«ã€‚\nWhat is JavaScript? A Brief Historyä»€ä¹ˆæ˜¯ JavaScriptï¼Ÿç®€å•çš„å†å²\nJavaScript (also known as ECMAScript) started its life as a simple scripting language for browsers. At the time it was invented, it was expected to be used for short snippets of code embedded in a web page â€” writing more than a few dozen lines of code would have been somewhat unusual. Due to this, early web browsers executed such code pretty slowly. Over time, though, JS became more and more popular, and web developers started using it to create interactive experiences.JavaScript æ˜¯ä¸€ç§ç®€å•çš„è„šæœ¬è¯­è¨€ï¼Œç”¨äºæµè§ˆå™¨ã€‚åœ¨åˆ›å»ºæ—¶ï¼Œå®ƒé¢„æœŸä¼šè¢«ç”¨äºåµŒå…¥åœ¨ç½‘é¡µä¸­çš„çŸ­ç‰‡ä»£ç  â€” å†™å…¥è¶…è¿‡åå‡ è¡Œä»£ç ä¼šæœ‰ç‚¹ä¸ä¾¿ã€‚Web browser developers responded to this increased JS usage by optimizing their execution engines (dynamic compilation) and extending what could be done with it (adding APIs), which in turn made web developers use it even more. On modern websites, your browser is frequently running applications that span hundreds of thousands of lines of code. This is long and gradual growth of â€œthe webâ€, starting as a simple network of static pages, and evolving into a platform for rich applications of all kinds.Web æµè§ˆå™¨å¼€å‘è€…å¯¹è¿™ä¸ªå¢åŠ äº† JS ä½¿ç”¨çš„å“åº”ï¼Œä¼˜åŒ–äº†ä»–ä»¬çš„æ‰§è¡Œå¼•æ“ï¼ˆåŠ¨æ€ç¼–è¯‘ï¼‰å’Œæ‰©å±•äº†ä»–ä»¬å¯ä»¥åšçš„äº‹æƒ…ï¼ˆæ·»åŠ  APIsï¼‰ï¼Œè¿™ä½¿å¾— Web å¼€å‘è€…ä½¿ç”¨å®ƒæ¥åšæ›´å¤šçš„äº‹æƒ…ã€‚åœ¨ç°ä»£ç½‘ç«™ä¸Šï¼Œæ‚¨çš„æµè§ˆå™¨é€šå¸¸è¿è¡Œç€ä¸€äº›åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬åƒä¸‡è¡Œä»£ç çš„åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é•¿çš„â€œç½‘â€çš„å‘å±•ï¼Œä»ä¸€ä¸ªç®€å•çš„é™æ€é¡µé¢å¼€å§‹ï¼Œå¹¶è¿›å…¥ä¸€ä¸ªä¸°å¯Œçš„åº”ç”¨ç¨‹åºçš„å¹³å°ã€‚More than this, JS has become popular enough to be used outside the context of browsers, such as implementing JS servers using node.js. The â€œrun anywhereâ€ nature of JS makes it an attractive choice for cross-platform development. There are many developers these days that use only JavaScript to program their entire stack!ä¸ä»…å¦‚æ­¤ï¼ŒJS å˜å¾—è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æµè§ˆå™¨ä¹‹å¤–ä½¿ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨ node.js æ¥å®ç° JS æœåŠ¡å™¨ã€‚JS çš„â€œè¿è¡Œåœ¨ä»»ä½•åœ°æ–¹â€æ€§è´¨ä½¿å¾—å®ƒä¸€ä¸ªæå—æ¬¢è¿çš„é€‰æ‹©ã€‚æœ‰è®¸å¤šå¼€å‘è€…ä»Šå¤©åªä½¿ç”¨ JavaScript æ¥ç¼–ç¨‹ä»–ä»¬çš„æ•´ä¸ªå †æ ˆï¼To summarize, we have a language that was designed for quick uses, and then grew to a full-fledged tool to write applications with millions of lines. Every language has its own quirks â€” oddities and surprises, and JavaScriptâ€™s humble beginning makes it have many of these. Some examples:æ¦‚æ‹¬ï¼Œæˆ‘ä»¬æœ‰ä¸€ç§è¯­è¨€ï¼Œè¢«è®¾è®¡ä¸ºå¿«é€Ÿä½¿ç”¨ï¼Œç„¶åæ‰©å±•åˆ°ä¸€ä¸ªå…·æœ‰åƒä¸‡è¡Œä»£ç çš„åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚æ¯ç§è¯­è¨€éƒ½æœ‰è‡ªå·±çš„ç‰¹æ€§ï¼Œæœ‰çš„æœ‰ç‚¹ä¸åŒï¼Œæœ‰çš„æœ‰ç‚¹æƒŠäººï¼Œè€Œ JavaScript çš„è½»é‡æ„Ÿä½¿å¾—å®ƒæœ‰è®¸å¤šè¿™äº›ã€‚æœ‰äº›ä¾‹å­ï¼š\nJavaScriptâ€™s equality operator (&#x3D;&#x3D;) coerces its arguments, leading to unexpected behavior:JavaScript çš„ç›¸ç­‰æ“ä½œç¬¦ï¼ˆ==ï¼‰ä¼šå¼ºåˆ¶è½¬æ¢å®ƒçš„å‚æ•°ï¼Œå¯¼è‡´æ„å¤–çš„è¡Œä¸ºï¼š\nif (&quot;&quot; &#x3D;&#x3D; 0) &#123;\n  &#x2F;&#x2F; It is! But why??\n&#125;\nif (1 &lt; x &lt; 3) &#123;\n  &#x2F;&#x2F; True for *any* value of x!\n&#125;\n\nJavaScript also allows accessing properties which arenâ€™t present:JavaScript ä¹Ÿå…è®¸è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼š\nconst obj &#x3D; &#123; width: 10, height: 15 &#125;;\n&#x2F;&#x2F; Why is this NaN? Spelling is hard!\nconst area &#x3D; obj.width * obj.heigth;\n\nMost programming languages would throw an error when these sorts of errors occur, some would do so during compilation â€” before any code is running. When writing small programs, such quirks are annoying but manageable; when writing applications with hundreds or thousands of lines of code, these constant surprises are a serious problem.å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå½“è¿™äº›é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå®ƒä»¬ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶ã€‚å½“å†™å°å‹ç¨‹åºæ—¶ï¼Œè¿™äº›æƒŠäººçš„æƒŠå–œæ˜¯å¯æ¥å—çš„ï¼›å½“å†™å¤§å‹åº”ç”¨ç¨‹åºæ—¶ï¼Œè¿™äº›æƒŠå–œæ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚\n\nTypeScript: A Static Type Checker\n\nWe said earlier that some languages wouldnâ€™t allow those buggy programs to run at all. Detecting errors in code without running it is referred to as static checking. Determining whatâ€™s an error and whatâ€™s not based on the kinds of values being operated on is known as static type checking.æˆ‘ä»¬è¯´è¿‡ï¼ŒæŸäº›è¯­è¨€ä¸å…è®¸è¿è¡Œé‚£äº›é”™è¯¯çš„ç¨‹åºã€‚æ£€æµ‹ä»£ç ä¸­çš„é”™è¯¯ï¼Œè€Œä¸è¿è¡Œå®ƒ, æ˜¯é™æ€æ£€æŸ¥ã€‚ç¡®å®šå“ªäº›æ˜¯é”™è¯¯çš„ï¼Œå“ªäº›æ˜¯æ­£ç¡®çš„ï¼Œæ˜¯åŸºäºå€¼çš„ç±»å‹çš„é™æ€æ£€æŸ¥ã€‚TypeScript checks a program for errors before execution, and does so based on the kinds of values, itâ€™s a static type checker. For example, the last example above has an error because of the type of obj. Hereâ€™s the error TypeScript found:TypeScript æ£€æµ‹ç¨‹åºå‰ï¼Œå¹¶ä¸”åŸºäºå€¼çš„ç±»å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªé™æ€ç±»å‹æ£€æŸ¥å™¨ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢çš„æœ€åä¸€ä¸ªä¾‹å­æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º obj çš„ç±»å‹æ˜¯ NaNã€‚è¿™é‡Œ TypeScript å‘ç°äº†é”™è¯¯ï¼š\nconst obj &#x3D; &#123; width: 10, height: 15 &#125;;\nconst area &#x3D; obj.width * obj.heigth;\n&#x2F;&#x2F; Property &#39;heigth&#39; does not exist on type &#39;&#123; width: number; height: number; &#125;&#39;. Did you mean &#39;height&#39;?\n\nA Typed Superset of JavaScriptä¸€ä¸ªç±»å‹å®šä¹‰çš„è¶…é›† JavaScript\nHow does TypeScript relate to JavaScript, though?TypeScript çš„ç±»å‹å®šä¹‰æ˜¯ä»€ä¹ˆï¼Œå’Œ JavaScript çš„ç±»å‹å®šä¹‰æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ\nSyntax è¯­æ³•TypeScript is a language that is a superset of JavaScript: JS syntax is therefore legal TS. Syntax refers to the way we write text to form a program. For example, this code has a syntax error because itâ€™s missing a ):Typescript æ˜¯ JavaScript çš„ä¸€ä¸ªå­é›†ï¼šJS è¯­è¨€çš„è¯­æ³•æ˜¯åˆæ³•çš„ TSã€‚è¯­æ³•æ˜¯æŒ‡æˆ‘ä»¬å†™ç¨‹åºçš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œè¿™æ®µä»£ç æœ‰ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œå› ä¸ºæ²¡æœ‰ä¸€ä¸ªï¼‰ã€‚\nlet a &#x3D; (4\n&#39;)&#39; expected.\n\nTypeScript doesnâ€™t consider any JavaScript code to be an error because of its syntax. This means you can take any working JavaScript code and put it in a TypeScript file without worrying about exactly how it is written.TypeScript ä¸ä¼šè®¤ä¸ºä»»ä½• JavaScript ä»£ç æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå®ƒçš„è¯­æ³•ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æŠŠä»»ä½•å·¥ä½œçš„ JavaScript ä»£ç æ”¾åœ¨ TypeScript æ–‡ä»¶ä¸­ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå®ƒçš„è¯­æ³•ã€‚\nTypesç±»å‹\nHowever, TypeScript is a typed superset, meaning that it adds rules about how different kinds of values can be used. The earlier error about obj.heigth was not a syntax error: it is an error of using some kind of value (a type) in an incorrect way.\nç„¶è€Œï¼ŒTypeScript æ˜¯ä¸€ä¸ªç±»å‹çš„è¶…é›†ï¼Œæ„å‘³ç€å®ƒæ·»åŠ äº†ä¸€äº›è§„åˆ™ï¼Œå¦‚ä½•ä½¿ç”¨ä¸åŒç±»å‹çš„å€¼ã€‚å‰é¢çš„é”™è¯¯ï¼Œobj.heigth æ˜¯ä¸æ˜¯ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªé”™è¯¯çš„ä½¿ç”¨æŸç§ç±»å‹çš„å€¼ï¼ˆä¸€ä¸ªç±»å‹ï¼‰çš„æ–¹å¼ã€‚\nAs another example, this is JavaScript code that you can run in your browser, and it will log a value:\nå¦ä¸€ä¸ªä¾‹å­ï¼Œè¿™æ˜¯ä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ JavaScript ä»£ç ï¼Œå®ƒä¼šè®°å½•ä¸€ä¸ªå€¼ï¼š\nconsole.log(4 &#x2F; []);\n&#x2F;&#x2F; The right-hand side of an arithmetic operation must be of type &#39;any&#39;, &#39;number&#39;, &#39;bigint&#39; or an enum type.\n\nItâ€™s possible you really did intend to divide a number by an array, perhaps just to see what happens, but most of the time, though, this is a programming mistake. TypeScriptâ€™s type checker is designed to allow correct programs through while still catching as many common errors as possible. (Later, weâ€™ll learn about settings you can use to configure how strictly TypeScript checks your code.)\nä¹‹å‰ä¸€ä¸ªæ•°é™¤ä»¥ä¸€ä¸ªæ•°ç»„ï¼Œå¯èƒ½ä»…ä»…æ˜¯æƒ³çœ‹ä¸‹ä¼šå‡ºç°ä»€ä¹ˆï¼Œå°½ç®¡ä»–æ˜¯ä¸€ä¸ªé”™è¯¯ç¨‹åºã€‚Typescript çš„ç±»å‹æ£€æŸ¥å™¨æ˜¯è®¾è®¡çš„ï¼Œè®©æ­£ç¡®çš„ç¨‹åºé€šè¿‡ï¼Œå¹¶ä¸”å°½å¯èƒ½å°‘çš„é”™è¯¯ã€‚(åé¢ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•é…ç½® TypeScript æ£€æŸ¥ä½ çš„ä»£ç ã€‚)\nIf you move some code from a JavaScript file to a TypeScript file, you might see type errors depending on how the code is written. These may be legitimate problems with the code, or TypeScript being overly conservative. Throughout this guide weâ€™ll demonstrate how to add various TypeScript syntax to eliminate such errors.\nå¦‚æœä½ ä»ä¸€ä¸ª JavaScript æ–‡ä»¶ç§»åŠ¨åˆ°ä¸€ä¸ª TypeScript æ–‡ä»¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›ç±»å‹é”™è¯¯ï¼Œå–å†³äºä½ çš„ä»£ç å¦‚ä½•å†™ã€‚è¿™äº›å¯èƒ½æ˜¯ä»£ç çš„æ­£ç¡®æ€§ï¼Œæˆ–è€… TypeScript è¿‡äºä¿å®ˆã€‚æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬ä¼šæ¼”ç¤ºå¦‚ä½•æ·»åŠ å„ç§ TypeScript è¯­æ³•ï¼Œä»¥ä¾¿æ¶ˆé™¤è¿™äº›é”™è¯¯ã€‚\nRuntime Behaviorè¿è¡Œæ—¶è¡Œä¸ºTypeScript is also a programming language that preserves the runtime behavior of JavaScript. For example, dividing by zero in JavaScript produces Infinity instead of throwing a runtime exception. As a principle, TypeScript never changes the runtime behavior of JavaScript code.TypeScript ä¹Ÿæ˜¯ä¸€ä¸ªç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä¿ç•™ JavaScript çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œåœ¨ JavaScript ä¸­é™¤ä»¥é›¶ä¼šäº§ç”Ÿæ— ç©·ï¼Œè€Œä¸æ˜¯æŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ã€‚ä½œä¸ºä¸€ä¸ªåŸåˆ™ï¼ŒTypeScript ä¸ä¼šæ”¹å˜ JavaScript ä»£ç çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚This means that if you move code from JavaScript to TypeScript, it is guaranteed to run the same way, even if TypeScript thinks that the code has type errors.è¿™æ„å‘³ç€å¦‚æœä½ ä» JavaScript ç§»åŠ¨åˆ° TypeScriptï¼Œå®ƒå°±ä¿è¯ä¼šè¿è¡Œä¸€æ ·çš„ï¼Œå³ä½¿ TypeScript è®¤ä¸ºä»£ç æœ‰ç±»å‹é”™è¯¯ã€‚Keeping the same runtime behavior as JavaScript is a foundational promise of TypeScript because it means you can easily transition between the two languages without worrying about subtle differences that might make your program stop working.ä¿æŒå’Œ JavaScript çš„è¿è¡Œæ—¶ä¸€è‡´çš„è¡Œä¸ºæ˜¯ TypeScript çš„åŸºç¡€æ‰¿è¯ºï¼Œå› ä¸ºå®ƒæ„å‘³ç€ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ä» JavaScript åˆ° TypeScript è¿‡æ¸¡ï¼Œè€Œä¸ç”¨æ‹…å¿ƒæ½œåœ¨çš„å·®å¼‚ï¼Œå¯èƒ½ä¼šå½±å“ä½ çš„ç¨‹åºçš„æ­£å¸¸è¿è¡Œã€‚\nErased Typesæ“¦é™¤ç±»å‹Roughly speaking, once TypeScriptâ€™s compiler is done with checking your code, it erases the types to produce the resulting â€œcompiledâ€ code. This means that once your code is compiled, the resulting plain JS code has no type information.æ¢å¥è¯è¯´ï¼Œä¸€æ—¦ TypeScript ç¼–è¯‘å™¨å®Œæˆäº†æ£€æŸ¥ä½ çš„ä»£ç ï¼Œå®ƒä¼šæ“¦é™¤ç±»å‹ï¼Œç”Ÿæˆç»“æœçš„â€œç¼–è¯‘â€ä»£ç ã€‚è¿™æ„å‘³ç€ï¼Œä¸€æ—¦ä½ çš„ä»£ç ç¼–è¯‘å®Œæˆï¼Œç»“æœçš„æ™®é€š JS ä»£ç å°†æ²¡æœ‰ç±»å‹ä¿¡æ¯ã€‚This also means that TypeScript never changes the behavior of your program based on the types it inferred. The bottom line is that while you might see type errors during compilation, the type system itself has no bearing on how your program works when it runs.è¿™æ„å‘³ç€ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ç±»å‹é”™è¯¯ï¼Œä½†æ˜¯ç±»å‹ç³»ç»Ÿæœ¬èº«æ²¡æœ‰ä»€ä¹ˆå½±å“ä½ çš„ç¨‹åºçš„è¿è¡Œã€‚åº•çº¿æ˜¯ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ç±»å‹é”™è¯¯ï¼Œä½†æ˜¯ç±»å‹ç³»ç»Ÿæœ¬èº«æ²¡æœ‰ä»€ä¹ˆå½±å“ä½ çš„ç¨‹åºçš„è¿è¡Œã€‚Finally, TypeScript doesnâ€™t provide any additional runtime libraries. Your programs will use the same standard library (or external libraries) as JavaScript programs, so thereâ€™s no additional TypeScript-specific framework to learn.æœ€åï¼ŒTypeScript ä¸æä¾›ä»»ä½•é¢å¤–çš„è¿è¡Œæ—¶åº“ã€‚ä½ çš„ç¨‹åºå°†ä½¿ç”¨å’Œ JavaScript ç¨‹åºä¸€æ ·çš„æ ‡å‡†åº“ï¼ˆæˆ–å¤–éƒ¨åº“ï¼‰ï¼Œæ‰€ä»¥æ²¡æœ‰é¢å¤–çš„ TypeScript-ç‰¹å®šçš„æ¡†æ¶æ¥å­¦ä¹ ã€‚\nLearning JavaScript and TypeScriptå­¦ä¹  JavaScript å’Œ TypeScriptWe frequently see the question â€œShould I learn JavaScript or TypeScript?â€œ.æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼šâ€œæˆ‘åº”è¯¥å­¦ä¹  JavaScript è¿˜æ˜¯ TypeScriptï¼Ÿâ€The answer is that you canâ€™t learn TypeScript without learning JavaScript! TypeScript shares syntax and runtime behavior with JavaScript, so anything you learn about JavaScript is helping you learn TypeScript at the same time.ç­”æ¡ˆæ˜¯ï¼Œä½ ä¸èƒ½å­¦ä¹  TypeScriptï¼Œé™¤éä½ å­¦ä¹  JavaScriptï¼TypeScript å’Œ JavaScript å…±äº«è¯­æ³•å’Œè¿è¡Œæ—¶è¡Œä¸ºï¼Œæ‰€ä»¥ä½ å­¦ä¹  JavaScript çš„ä»»ä½•å†…å®¹éƒ½æ˜¯å¸®åŠ©ä½ å­¦ä¹  TypeScript çš„åŒæ—¶ã€‚There are many, many resources available for programmers to learn JavaScript; you should not ignore these resources if youâ€™re writing TypeScript. For example, there are about 20 times more StackOverflow questions tagged javascript than typescript, but all of the javascript questions also apply to TypeScript.æœ‰å¾ˆå¤šï¼Œå¾ˆå¤šèµ„æºå¯ä¾›ç¨‹åºå‘˜å­¦ä¹  JavaScriptï¼›å¦‚æœä½ å†™ TypeScriptï¼Œä½ ä¸åº”è¯¥å¿½ç•¥è¿™äº›èµ„æºã€‚ä¾‹å¦‚ï¼Œæœ‰ 20 å€çš„ StackOverflow é—®é¢˜æ ‡è®°äº† javascriptï¼Œè€Œ typescript é—®é¢˜ä¹Ÿé€‚ç”¨äº javascriptã€‚If you find yourself searching for something like â€œhow to sort a list in TypeScriptâ€, remember: TypeScript is JavaScriptâ€™s runtime with a compile-time type checker. The way you sort a list in TypeScript is the same way you do so in JavaScript. If you find a resource that uses TypeScript directly, thatâ€™s great too, but donâ€™t limit yourself to thinking you need TypeScript-specific answers for everyday questions about how to accomplish runtime tasks.å¦‚æœä½ å‘ç°è‡ªå·±åœ¨æœç´¢â€œå¦‚ä½•æ’åºä¸€ä¸ªåˆ—è¡¨â€ï¼Œè®°ä½ï¼šTypeScript æ˜¯ JavaScript çš„è¿è¡Œæ—¶ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥å™¨ã€‚ä½ åœ¨ TypeScript ä¸­æ’åºä¸€ä¸ªåˆ—è¡¨çš„æ–¹å¼å’Œåœ¨ JavaScript ä¸­ä¸€æ ·ã€‚å¦‚æœä½ æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨ TypeScript çš„èµ„æºï¼Œé‚£ä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼Œä½†ä¸è¦é™åˆ¶è‡ªå·±åœ¨æ¯å¤©çš„é—®é¢˜ä¸­æƒ³è¦ä½¿ç”¨ TypeScript-ç‰¹å®šçš„ç­”æ¡ˆæ¥å®ç°è¿è¡Œæ—¶ä»»åŠ¡ã€‚\nNext Stepsä¸‹ä¸€æ­¥This was a brief overview of the syntax and tools used in everyday TypeScript. From here, you can:è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¦‚è¿°ï¼Œä»è¿™é‡Œä½ å¯ä»¥ï¼šLearn some of the JavaScript fundamentals, we recommend either:å­¦ä¹  JavaScript åŸºæœ¬åŸç†ï¼Œæˆ‘ä»¬å»ºè®®ï¼šMicrosoftâ€™s JavaScript Resources orJavaScript guide at the Mozilla Web DocsContinue to TypeScript for JavaScript Programmersç»§ç»­å­¦ä¹  TypeScript ä¸º JavaScript ç¨‹åºå‘˜Read the full Handbook from start to finish (30m)é˜…è¯»å…¨éƒ¨æ‰‹å†Œä»å¤´åˆ°å°¾ï¼ˆ30 åˆ†é’Ÿï¼‰å¤§ä½¬å°±æ˜¯å¤§ä½¬ 30 åˆ†é’Ÿèƒ½æå®šï¼Œæˆ‘ä¼°è®¡è¦æ 3 å¤©ï¼Œæ‰‹å†Œè¿™åœ°æ–¹å†…å®¹è¿˜æ˜¯å¾ˆå¤šçš„Explore the Playground examplesæ¢ç´¢ Playground ç¤ºä¾‹\nJS å¼€å‘è€…TypeScript stands in an unusual relationship to JavaScript. TypeScript offers all of JavaScriptâ€™s features, and an additional layer on top of these: TypeScriptâ€™s type system.TypeScript ä¸ JavaScript çš„å…³ç³»æ˜¯ä¸æ­£å¸¸çš„ã€‚TypeScript æä¾›äº† JavaScript çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨è¿™äº›åŠŸèƒ½çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¸€å±‚ï¼šTypeScript çš„ç±»å‹ç³»ç»Ÿã€‚For example, JavaScript provides language primitives like string and number, but it doesnâ€™t check that youâ€™ve consistently assigned these. TypeScript does.ä¾‹å¦‚ï¼ŒJavaScript æä¾›äº†å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œä½†å®ƒä¸æ£€æŸ¥ä½ æ˜¯å¦æŒ‰ç…§ä¸€è‡´çš„æ–¹å¼åˆ†é…è¿™äº›ã€‚TypeScript ä¹Ÿæä¾›äº†ã€‚This means that your existing working JavaScript code is also TypeScript code. The main benefit of TypeScript is that it can highlight unexpected behavior in your code, lowering the chance of bugs.è¿™æ„å‘³ç€ä½ çš„å·²æœ‰çš„å·¥ä½œä¸­çš„ JavaScript ä»£ç ä¹Ÿæ˜¯ TypeScript ä»£ç ã€‚TypeScript çš„ä¸»è¦å¥½å¤„æ˜¯å®ƒå¯ä»¥é«˜äº®ä½ çš„ä»£ç ä¸­çš„æ„å¤–è¡Œä¸ºï¼Œé™ä½ bug çš„å¯èƒ½æ€§ã€‚This tutorial provides a brief overview of TypeScript, focusing on its type system.è¿™ä¸ªæ•™ç¨‹ä¸»è¦ä»‹ç» TypeScript çš„ç±»å‹ç³»ç»Ÿã€‚\nTypes by Inferenceç±»å‹æ¨è®º\nTypeScript knows the JavaScript language and will generate types for you in many cases. For example in creating a variable and assigning it to a particular value, TypeScript will use the value as its type.TypeScript çŸ¥é“ JavaScript è¯­è¨€ï¼Œå¹¶ä¸”ä¼šä¸ºä½ ç”Ÿæˆç±»å‹ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå˜é‡å¹¶ä¸ºå®ƒèµ‹å€¼ï¼ŒTypeScript å°±ä¼šä½¿ç”¨å€¼ä½œä¸ºå®ƒçš„ç±»å‹ã€‚\nlet helloWorld &#x3D; &quot;Hello World&quot;;\n\n&#x2F;&#x2F; let helloWorld: string\n\nBy understanding how JavaScript works, TypeScript can build a type-system that accepts JavaScript code but has types. This offers a type-system without needing to add extra characters to make types explicit in your code. Thatâ€™s how TypeScript knows that helloWorld is a string in the above example.é€šè¿‡äº†è§£ JavaScript å·¥ä½œæ–¹å¼ï¼ŒTypeScript å¯ä»¥å»ºç«‹ä¸€ä¸ªæ¥å— JavaScript ä»£ç ï¼Œä½†æœ‰ç±»å‹çš„ç±»å‹ç³»ç»Ÿã€‚è¿™ä¸ªç±»å‹ç³»ç»Ÿæ²¡æœ‰éœ€è¦åœ¨ä½ çš„ä»£ç ä¸­æ·»åŠ é¢å¤–çš„å­—ç¬¦æ¥æ˜ç¡®ç±»å‹ã€‚è¿™å°±æ˜¯ TypeScript çŸ¥é“ helloWorld æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„åŸå› ã€‚\nYou may have written JavaScript in Visual Studio Code, and had editor auto-completion. Visual Studio Code uses TypeScript under the hood to make it easier to work with JavaScript.ä½ å¯èƒ½åœ¨ Visual Studio Code ä¸­å†™äº† JavaScriptï¼Œå¹¶ä¸”æœ‰è‡ªåŠ¨è¡¥å…¨ã€‚Visual Studio Code ä½¿ç”¨ TypeScript ä½œä¸ºåå°æ¥æ›´åŠ æ–¹ä¾¿åœ°å·¥ä½œã€‚ï¼ˆåŸæ¥å¦‚æ­¤ï¼‰\nDefining Typeså®šä¹‰ç±»å‹You can use a wide variety of design patterns in JavaScript. However, some design patterns make it difficult for types to be inferred automatically (for example, patterns that use dynamic programming). To cover these cases, TypeScript supports an extension of the JavaScript language, which offers places for you to tell TypeScript what the types should be.ä½ å¯ä»¥ä½¿ç”¨ JavaScript çš„è®¸å¤šè®¾è®¡æ¨¡å¼ã€‚_ç„¶è€Œï¼Œæœ‰äº›è®¾è®¡æ¨¡å¼ä½¿å¾—ç±»å‹æ— æ³•è¢«è‡ªåŠ¨æ¨æ–­ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ¨¡å¼_ã€‚ä¸ºäº†è§£å†³è¿™äº›æƒ…å†µï¼ŒTypeScript æ”¯æŒä¸€ä¸ª JavaScript çš„æ‰©å±•ï¼Œå®ƒæä¾›äº†ç»™ä½ å‘Šè¯‰ TypeScript çš„ç±»å‹åº”è¯¥æ˜¯ä»€ä¹ˆçš„åœ°æ–¹ã€‚For example, to create an object with an inferred type which includes name: string and id: number, you can write:ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå…·æœ‰æ¨æ–­ç±»å‹çš„å¯¹è±¡ï¼Œå®ƒåŒ…å« name: string å’Œ id: numberï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š\nconst user &#x3D; &#123;\n  name: &quot;Hayes&quot;,\n  id: 0,\n&#125;;\n\nYou can explicitly describe this objectâ€™s shape using an interface declaration:ä½ å¯ä»¥ä½¿ç”¨æ¥å£å£°æ˜æ¥æ˜ç¡®åœ°æè¿°è¿™ä¸ªå¯¹è±¡çš„å½¢çŠ¶ï¼š\ninterface User &#123;\n  name: string;\n  id: number;\n&#125;\n\nYou can then declare that a JavaScript object conforms to the shape of your new interface by using syntax like : TypeName after a variable declaration:ä½ å¯ä»¥ä½¿ç”¨ç±»å‹åç§°æ¥å‘Šè¯‰ JavaScript ä½ çš„å˜é‡æ˜¯å±äºå“ªä¸ªç±»å‹ï¼š\nconst user: User &#x3D; &#123;\n  name: &quot;Hayes&quot;,\n  id: 0,\n&#125;;\n\nIf you provide an object that doesnâ€™t match the interface you have provided, TypeScript will warn you:å¦‚æœä½ æä¾›çš„å¯¹è±¡ä¸ç¬¦åˆä½ æä¾›çš„æ¥å£ï¼ŒTypeScript å°±ä¼šè­¦å‘Šä½ ï¼š\ninterface User &#123;\n  name: string;\n  id: number;\n&#125;\n\nconst user: User &#x3D; &#123;\n  username: &quot;Hayes&quot;,\n  &#x2F;&#x2F; Type &#39;&#123; username: string; id: number; &#125;&#39; is not assignable to type &#39;User&#39;.\n  &#x2F;&#x2F; Object literal may only specify known properties, and &#39;username&#39; does not exist in type &#39;User&#39;.\n  id: 0,\n&#125;;\n\nSince JavaScript supports classes and object-oriented programming, so does TypeScript. You can use an interface declaration with classes:å› ä¸º JavaScript æ”¯æŒç±»å’Œå¯¹è±¡-é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæ‰€ä»¥ TypeScript ä¹Ÿæ”¯æŒã€‚ä½ å¯ä»¥ä½¿ç”¨æ¥å£å£°æ˜ç±»ï¼š\ninterface User &#123;\n  name: string;\n  id: number;\n&#125;\n\nclass UserAccount &#123;\n  name: string;\n  id: number;\n\n  constructor(name: string, id: number) &#123;\n    this.name &#x3D; name;\n    this.id &#x3D; id;\n  &#125;\n&#125;\n\nconst user: User &#x3D; new UserAccount(&quot;Murphy&quot;, 1);\n\nYou can use interfaces to annotate parameters and return values to functions:ä½ å¯ä»¥ä½¿ç”¨æ¥å£æ¥æ ‡æ³¨å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼š\nfunction getAdminUser(): User &#123;\n  &#x2F;&#x2F;...\n&#125;\n\nfunction deleteUser(user: User) &#123;\n  &#x2F;&#x2F; ...\n&#125;\n\nThere is already a small set of primitive types available in JavaScript: boolean, bigint, null, number, string, symbol, and undefined, which you can use in an interface. TypeScript extends this list with a few more, such as any (allow anything), unknown (ensure someone using this type declares what the type is), never (itâ€™s not possible that this type could happen), and void (a function which returns undefined or has no return value).å·²ç»æœ‰ä¸€äº›ç®€å•çš„åŸå§‹ç±»å‹å¯ç”¨äº JavaScriptï¼šboolean, bigint, null, number, string, symbol, å’Œ undefinedï¼Œä½ å¯ä»¥åœ¨æ¥å£ä¸­ä½¿ç”¨å®ƒä»¬ã€‚TypeScript å°†è¿™äº›ç±»å‹æ‰©å±•äº†ä¸€äº›ï¼Œå¦‚ anyï¼ˆå…è®¸ä»»ä½•ä¸œè¥¿ï¼‰ï¼Œunknownï¼ˆç¡®ä¿ä½¿ç”¨è€…ä½¿ç”¨è¿™ä¸ªç±»å‹æ—¶å£°æ˜äº†å®ƒçš„ç±»å‹ï¼‰ï¼Œneverï¼ˆä¸å¯èƒ½å‘ç”Ÿçš„ç±»å‹ï¼‰ï¼Œå’Œ voidï¼ˆå‡½æ•°è¿”å› undefined æˆ–æ²¡æœ‰è¿”å›å€¼ï¼‰ã€‚\nYouâ€™ll see that there are two syntaxes for building types: Interfaces and Types. You should prefer interface. Use type when you need specific features.ä½ ä¼šçœ‹åˆ°æœ‰ä¸¤ç§ç¼–å†™ç±»å‹çš„è¯­æ³•ï¼šæ¥å£å’Œç±»å‹ã€‚å½“ä½ éœ€è¦ç‰¹å®šçš„åŠŸèƒ½æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨æ¥å£ã€‚ä½¿ç”¨ç±»å‹æ—¶ï¼Œä½ éœ€è¦ç‰¹å®šçš„åŠŸèƒ½ã€‚\nComposing Typesç»„åˆç±»å‹With TypeScript, you can create complex types by combining simple ones. There are two popular ways to do so: with unions, and with generics.é€šè¿‡ä½¿ç”¨è”åˆç±»å‹ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨æ³›å‹æ¥ç»„åˆå¤æ‚çš„ç±»å‹ã€‚\nUnionsè”åˆç±»å‹With a union, you can declare that a type could be one of many types. For example, you can describe a boolean type as being either true or false:é€šè¿‡ä½¿ç”¨è”åˆç±»å‹ï¼Œä½ å¯ä»¥å£°æ˜ä¸€ä¸ªç±»å‹æ˜¯å¯èƒ½æ˜¯ true æˆ– false çš„ç±»å‹ã€‚\ntype MyBool &#x3D; true | false;\n\nNote: If you hover over MyBool above, youâ€™ll see that it is classed as boolean. Thatâ€™s a property of the Structural Type System. More on this below.è¯·æ³¨æ„ï¼Œå¦‚æœä½ å°†é¼ æ ‡ç§»åˆ° MyBool ä¸Šï¼Œä½ ä¼šçœ‹åˆ°å®ƒæ˜¯ä¸€ä¸ª boolean ç±»å‹ã€‚è¿™æ˜¯ç»“æ„ç±»å‹ç³»ç»Ÿçš„ä¸€ä¸ªå±æ€§ã€‚æ›´å¤šå†…å®¹åœ¨ä¸‹é¢ã€‚A popular use-case for union types is to describe the set of string or number literals that a value is allowed to be:è”åˆç±»å‹çš„ä¸€ä¸ªå¸¸è§ç”¨ä¾‹æ˜¯æè¿°ä¸€ä¸ªå€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—çš„é›†åˆï¼š\ntype WindowStates &#x3D; &quot;open&quot; | &quot;closed&quot; | &quot;minimized&quot;;\ntype LockStates &#x3D; &quot;locked&quot; | &quot;unlocked&quot;;\ntype PositiveOddNumbersUnderTen &#x3D; 1 | 3 | 5 | 7 | 9;\n\nUnions provide a way to handle different types too. For example, you may have a function that takes an array or a string:è”åˆç±»å‹å¯ä»¥ç”¨æ¥å¤„ç†ä¸åŒç±»å‹çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„æˆ–å­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°ï¼š\nfunction getLength(obj: string | string[]) &#123;\n  return obj.length;\n&#125;\n\nTo learn the type of a variable, use typeof:ä½¿ç”¨ typeof æ¥æŸ¥çœ‹ä¸€ä¸ªå˜é‡çš„ç±»å‹ï¼š\nType Predicateç±»å‹æ–­è¨€\nstring typeof s &#x3D;&#x3D;&#x3D; &quot;string&quot;\nnumber typeof n &#x3D;&#x3D;&#x3D; &quot;number&quot;\nboolean typeof b &#x3D;&#x3D;&#x3D; &quot;boolean&quot;\nundefined typeof undefined &#x3D;&#x3D;&#x3D; &quot;undefined&quot;\nfunction typeof f &#x3D;&#x3D;&#x3D; &quot;function&quot;\narray Array.isArray(a)\n\nFor example, you can make a function return different values depending on whether it is passed a string or an array:ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç”¨æ¥è¿”å›ä¸åŒçš„å€¼ï¼Œæ ¹æ®ä¼ å…¥çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯æ•°ç»„ï¼š\nfunction wrapInArray(obj: string | string[]) &#123;\n  if (typeof obj &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n    return [obj];\n\n    (parameter) obj: string\n  &#125;\n  return obj;\n&#125;\n\nGenericsæ³›å‹\nGenerics provide variables to types. A common example is an array. An array without generics could contain anything. An array with generics can describe the values that the array contains.æ³›å‹å¯ä»¥æä¾›ç±»å‹å˜é‡ã€‚ä¾‹å¦‚ï¼Œæ•°ç»„ã€‚æ•°ç»„æ²¡æœ‰æ³›å‹å¯ä»¥åŒ…å«ä»»ä½•ä¸œè¥¿ã€‚æ•°ç»„æœ‰æ³›å‹å¯ä»¥æè¿°æ•°ç»„ä¸­åŒ…å«çš„å€¼ã€‚\ntype StringArray &#x3D; Array&lt;string&gt;;\ntype NumberArray &#x3D; Array&lt;number&gt;;\ntype ObjectWithNameArray &#x3D; Array&lt;&#123; name: string &#125;&gt;;\nYou can declare your own types that use generics:\n\nä½ å¯ä»¥å£°æ˜è‡ªå·±çš„ç±»å‹ï¼Œä½¿ç”¨æ³›å‹ã€‚\ninterface Backpack&lt;Type&gt; &#123;\n  add: (obj: Type) &#x3D;&gt; void;\n  get: () &#x3D;&gt; Type;\n&#125;\n\n&#x2F;&#x2F; This line is a shortcut to tell TypeScript there is a\n&#x2F;&#x2F; constant called &#96;backpack&#96;, and to not worry about where it came from.\ndeclare const backpack: Backpack&lt;string&gt;;\n\n&#x2F;&#x2F; object is a string, because we declared it above as the variable part of Backpack.\nconst object &#x3D; backpack.get();\n\n&#x2F;&#x2F; Since the backpack variable is a string, you can&#39;t pass a number to the add function.\nbackpack.add(23);\nArgument of type &#39;number&#39; is not assignable to parameter of type &#39;string&#39;.\n\nStructural Type Systemç»“æ„ç±»å‹ç³»ç»Ÿ\nOne of TypeScriptâ€™s core principles is that type checking focuses on the shape that values have. This is sometimes called â€œduck typingâ€ or â€œstructural typingâ€.ç»“æ„ç±»å‹ç³»ç»Ÿçš„ä¸€ä¸ªæ ¸å¿ƒåŸåˆ™æ˜¯ï¼Œç±»å‹æ£€æŸ¥åªå…³æ³¨å€¼çš„å½¢çŠ¶ã€‚è¿™ç§°ä¸ºâ€œé¸­å­ç±»å‹â€æˆ–â€œç»“æ„ç±»å‹â€ã€‚In a structural type system, if two objects have the same shape, they are considered to be of the same type.åœ¨ç»“æ„ç±»å‹ç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡å…·æœ‰ç›¸åŒçš„å½¢çŠ¶ï¼Œåˆ™è¢«è§†ä¸ºç›¸åŒçš„ç±»å‹ã€‚\ninterface Point &#123;\n  x: number;\n  y: number;\n&#125;\n\nfunction logPoint(p: Point) &#123;\n  console.log(&#96;$&#123;p.x&#125;, $&#123;p.y&#125;&#96;);\n&#125;\n\n&#x2F;&#x2F; logs &quot;12, 26&quot;\nconst point &#x3D; &#123; x: 12, y: 26 &#125;;\nlogPoint(point);\n\nThe point variable is never declared to be a Point type. However, TypeScript compares the shape of point to the shape of Point in the type-check. They have the same shape, so the code passes.point å˜é‡æ²¡æœ‰è¢«å£°æ˜ä¸º Point ç±»å‹ã€‚ä½†æ˜¯ï¼ŒTypeScript å¯¹æ¯” point å’Œ Point çš„å½¢çŠ¶ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„å½¢çŠ¶ï¼Œæ‰€ä»¥ä»£ç é€šè¿‡ã€‚The shape-matching only requires a subset of the objectâ€™s fields to match.ç»“æ„ç±»å‹ç³»ç»Ÿåªéœ€è¦å¯¹è±¡çš„ä¸€éƒ¨åˆ†å­—æ®µåŒ¹é…ã€‚\nconst point3 &#x3D; &#123; x: 12, y: 26, z: 89 &#125;;\nlogPoint(point3); &#x2F;&#x2F; logs &quot;12, 26&quot;\n\nconst rect &#x3D; &#123; x: 33, y: 3, width: 30, height: 80 &#125;;\nlogPoint(rect); &#x2F;&#x2F; logs &quot;33, 3&quot;\n\nconst color &#x3D; &#123; hex: &quot;#187ABF&quot; &#125;;\nlogPoint(color);\n&#x2F;&#x2F; Argument of type &#39;&#123; hex: string; &#125;&#39; is not assignable to parameter of type &#39;Point&#39;.\n&#x2F;&#x2F; Type &#39;&#123; hex: string; &#125;&#39; is missing the following properties from type &#39;Point&#39;: x, y\n\nThere is no difference between how classes and objects conform to shapes:ç±»å’Œå¯¹è±¡éƒ½éµå¾ªç»“æ„ç±»å‹ç³»ç»Ÿã€‚\nclass VirtualPoint &#123;\n  x: number;\n  y: number;\n\n  constructor(x: number, y: number) &#123;\n    this.x &#x3D; x;\n    this.y &#x3D; y;\n  &#125;\n&#125;\n\nconst newVPoint &#x3D; new VirtualPoint(13, 56);\nlogPoint(newVPoint); &#x2F;&#x2F; logs &quot;13, 56&quot;\n\nIf the object or class has all the required properties, TypeScript will say they match, regardless of the implementation details.å¦‚æœå¯¹è±¡æˆ–ç±»æœ‰æ‰€æœ‰å¿…è¦çš„å±æ€§ï¼ŒTypeScriptå°†è®¤ä¸ºå®ƒä»¬åŒ¹é…ï¼Œæ— è®ºå®ç°ç»†èŠ‚ã€‚\nNext Stepsä¸‹ä¸€æ­¥This was a brief overview of the syntax and tools used in everyday TypeScript. From here, you can:ä»è¿™é‡Œå¼€å§‹ï¼Œä½ å¯ä»¥ï¼šRead the full Handbook from start to finish (30m)é˜…è¯»å®Œæ•´æ‰‹å†Œï¼ˆ30åˆ†é’Ÿï¼‰Explore the Playground examplesæ¢ç´¢ Playground ç¤ºä¾‹\nJava&#x2F;C#å¼€å‘è™½ç„¶ Java&#x2F;C#ä¹Ÿæ¥è§¦è¿‡ï¼Œä½†è¿™ä¸æ˜¯æˆ‘æœ¬æ¬¡çš„é‡ç‚¹ï¼Œä¹‹åä¼šè¡¥ä¸Š\nå‡½æ•°å¼ç¼–ç¨‹äººå‘˜TypeScript began its life as an attempt to bring traditional object-oriented types to JavaScript so that the programmers at Microsoft could bring traditional object-oriented programs to the web. As it has developed, TypeScriptâ€™s type system has evolved to model code written by native JavaScripters. The resulting system is powerful, interesting and messy.TypeScript å¼€å§‹äºä¸€ä¸ªå°è¯•ï¼Œå°†ä¼ ç»Ÿå¯¹è±¡-å¯¹è±¡ç±»å‹çš„ç¼–ç¨‹è¯­è¨€è½¬æ¢ä¸º JavaScriptï¼Œè¿™æ ·çš„ç¼–ç¨‹äººå‘˜å¯ä»¥å°†ä¼ ç»Ÿçš„å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ç¨‹åºè½¬æ¢ä¸º Web ç«¯çš„ç¨‹åºã€‚This introduction is designed for working Haskell or ML programmers who want to learn TypeScript. It describes how the type system of TypeScript differs from Haskellâ€™s type system. It also describes unique features of TypeScriptâ€™s type system that arise from its modelling of JavaScript code.è¿™ä¸ªä»‹ç»æ˜¯ä¸ºäº†å·¥ä½œ Haskell æˆ– ML ç¨‹åºå‘˜è€Œè®¾è®¡çš„ï¼Œå®ƒæè¿°äº† TypeScript çš„ç±»å‹ç³»ç»Ÿä¸ Haskell çš„ç±»å‹ç³»ç»Ÿä¹‹é—´çš„ä¸åŒã€‚This introduction does not cover object-oriented programming. In practice, object-oriented programs in TypeScript are similar to those in other popular languages with OO features.è¿™ä¸ªä»‹ç»ä¸ä¼šè®²åˆ°å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ã€‚å®é™…ä¸Šï¼Œåœ¨ TypeScript ä¸­çš„å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ç¨‹åºä¸å…¶ä»–æµè¡Œè¯­è¨€çš„å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ç¨‹åºç›¸ä¼¼ã€‚\nPrerequisiteså…ˆå†³æ¡ä»¶In this introduction, I assume you know the following:åœ¨è¿™ä¸ªä»‹ç»ä¸­ï¼Œæˆ‘å‡è®¾ä½ çŸ¥é“äº†ä»¥ä¸‹å†…å®¹ï¼šHow to program in JavaScript, the good parts.å¦‚ä½•ç¼–å†™ JavaScript ç¨‹åºï¼Œå¥½çš„éƒ¨åˆ†ã€‚Type syntax of a C-descended language.C-descended è¯­è¨€çš„ç±»å‹è¯­æ³•ã€‚If you need to learn the good parts of JavaScript, read JavaScript: The Good Parts. You may be able to skip the book if you know how to write programs in a call-by-value lexically scoped language with lots of mutability and not much else. R4RS Scheme is a good example.å¦‚æœä½ éœ€è¦å­¦ä¹  JavaScriptï¼Œè¯·é˜…è¯» JavaScriptï¼šThe Good Partsã€‚å¦‚æœä½ çŸ¥é“å¦‚ä½•ç¼–å†™åŸºäºå€¼è¯æ³•çš„è¯æ³•ä½œç”¨åŸŸè¯­è¨€ï¼Œå¹¶ä¸”æ‹¥æœ‰å¤§é‡å¯å˜æ€§å’Œä¸å¤šçš„å…¶ä»–ç‰¹æ€§ï¼Œä½ å¯ä»¥è·³è¿‡è¿™æœ¬ä¹¦ã€‚R4RS Scheme æ˜¯ä¸€ä¸ªå¥½ä¾‹å­ã€‚The C++ Programming Language is a good place to learn about C-style type syntax. Unlike C++, TypeScript uses postfix types, like so: x: string instead of string x.C++ ç¼–ç¨‹è¯­è¨€æ˜¯ä¸€ä¸ªå¥½çš„åœ°æ–¹å­¦ä¹  C-style ç±»å‹è¯­æ³•ã€‚\nConcepts not in Haskellåœ¨ Haskell ä¸­ä¸å­˜åœ¨çš„æ¦‚å¿µ\nBuilt-in typeså†…ç½®ç±»å‹JavaScript defines 8 built-in types:JavaScript å®šä¹‰äº† 8 ä¸ªå†…ç½®ç±»å‹ï¼š è¿™é‡Œæ˜¯åŒ…è£…ç±»å‹Type Explanationç±»å‹è¯´æ˜Number a double-precision IEEE 754 floating point.æ•°å­—ï¼ŒåŒç²¾åº¦ IEEE 754 æµ®ç‚¹æ•°ã€‚String an immutable UTF-16 string.å­—ç¬¦ä¸²ï¼Œä¸å¯å˜çš„ UTF-16 å­—ç¬¦ä¸²ã€‚BigInt integers in the arbitrary precision format.å¤§æ•´æ•°ï¼Œä»»æ„ç²¾åº¦æ ¼å¼ã€‚Boolean true and false.å¸ƒå°”å€¼ï¼Œtrue å’Œ falseã€‚Symbol a unique value usually used as a key.ç¬¦å·ï¼Œé€šå¸¸ç”¨ä½œé”®ã€‚Null equivalent to the unit type.ç©ºï¼Œç­‰åŒäºå•å…ƒç±»å‹ã€‚Undefined also equivalent to the unit type.æœªå®šä¹‰ï¼Œä¹Ÿç­‰åŒäºå•å…ƒç±»å‹ã€‚Object similar to records.å¯¹è±¡ï¼Œç±»ä¼¼äºè®°å½•ã€‚See the MDN page for more detail.å‚è§ MDN é¡µé¢ã€‚\nTypeScript has corresponding primitive types for the built-in types:TypeScript æœ‰å¯¹åº”çš„å†…ç½®ç±»å‹çš„åŸå§‹ç±»å‹ï¼šnumberstringbigintbooleansymbolnullundefinedobject\nOther important TypeScript typeså…¶ä»–é‡è¦çš„ TypeScript ç±»å‹Type Explanationç±»å‹è¯´æ˜unknown the top type.æœªçŸ¥ç±»å‹ï¼Œé¡¶çº§ç±»å‹ã€‚never the bottom type.æ°¸è¿œä¸ä¼šæ˜¯ç±»å‹ï¼Œåº•çº§ç±»å‹ã€‚object literal eg { property: Type }å¯¹è±¡å­—é¢é‡ï¼Œä¾‹å¦‚ &#123; property: ç±»å‹ &#125;ã€‚void a subtype of undefined intended for use as a return type.void ç±»å‹ï¼Œä½œä¸ºè¿”å›ç±»å‹ã€‚T[] mutable arrays, also written ArrayT[] å¯å˜æ•°ç»„ï¼Œä¹Ÿç§°ä¸º Array&lt;T&gt;ã€‚[T, T] tuples, which are fixed-length but mutable[T, T] å…ƒç»„ï¼Œå›ºå®šé•¿åº¦ä½†å¯å˜ã€‚(t: T) &#x3D;&gt; U functions(t: T) =&gt; U å‡½æ•°ã€‚Notes:æ³¨æ„ï¼šFunction syntax includes parameter names. This is pretty hard to get used to!å‡½æ•°è¯­æ³•åŒ…æ‹¬å‚æ•°åã€‚è¿™å¾ˆéš¾ä½¿ç”¨ï¼\nlet fst: (a: any, b: any) &#x3D;&gt; any &#x3D; (a, b) &#x3D;&gt; a;\n&#x2F;&#x2F; or more precisely: æˆ–è€…æ›´å‡†ç¡®åœ°ï¼š\nlet fst: &lt;T, U&gt;(a: T, b: U) &#x3D;&gt; T &#x3D; (a, b) &#x3D;&gt; a;\n&#x2F;&#x2F; Object literal type syntax closely mirrors object literal value syntax:\n&#x2F;&#x2F; æ¨¡å¼åŒ¹é…å­—é¢é‡ç±»å‹è¯­æ³•ä¸å¯¹è±¡å­—é¢é‡å€¼è¯­æ³•ç±»ä¼¼ã€‚\n\nlet o: &#123; n: number; xs: object[] &#125; &#x3D; &#123; n: 1, xs: [] &#125;;\n[T, T] is a subtype of T[].\n&#x2F;&#x2F; This is different than Haskell, where tuples are not related to lists.\n&#x2F;&#x2F; æ­¤å¤–ï¼Œè¿™æ˜¯ä¸åŒäº Haskell çš„ï¼Œå…ƒç»„ä¸å’Œåˆ—è¡¨ç›¸å…³ã€‚\n\nBoxed typesåŒ…è£…ç±»å‹JavaScript has boxed equivalents of primitive types that contain the methods that programmers associate with those types. TypeScript reflects this with, for example, the difference between the primitive type number and the boxed type Number. The boxed types are rarely needed, since their methods return primitives.JavaScript æœ‰å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼ŒåŒ…å«ä¸è¿™äº›ç±»å‹ç›¸å…³çš„æ–¹æ³•ã€‚\n(1).toExponential();\n&#x2F;&#x2F; equivalent to\nNumber.prototype.toExponential.call(1);\n\nNote that calling a method on a numeric literal requires it to be in parentheses to aid the parser.è°ƒç”¨æ–¹æ³•åœ¨æ•°å­—å­—é¢é‡ä¸Šéœ€è¦åœ¨æ‹¬å·ä¸­ï¼Œä»¥å¸®åŠ©è§£æå™¨ã€‚\nGradual typingæ¸è¿›ç±»å‹TypeScript uses the type any whenever it canâ€™t tell what the type of an expression should be. Compared to Dynamic, calling any a type is an overstatement. It just turns off the type checker wherever it appears. For example, you can push any value into an any[] without marking the value in any way:TypeScript ä½¿ç”¨ any æ—¶ï¼Œå½“å®ƒä¸èƒ½ç¡®å®šè¡¨è¾¾å¼çš„ç±»å‹æ—¶ã€‚&#x2F;&#x2F; with â€œnoImplicitAnyâ€: false in tsconfig.json, anys: any[]åœ¨ tsconfig.json ä¸­ï¼ŒåŠ å…¥ &quot;noImplicitAny&quot;: false å¯ä»¥ç¦ç”¨ anys: any[]ã€‚\nconst anys &#x3D; [];\nanys.push(1);\nanys.push(&quot;oh no&quot;);\nanys.push(&#123; anything: &quot;goes&quot; &#125;);\n\nAnd you can use an expression of type any anywhere:ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ any ç±»å‹è¡¨è¾¾å¼ã€‚\nanys.map(anys[1]); &#x2F;&#x2F; oh no, &quot;oh no&quot; is not a function\n\nany is contagious, too â€” if you initialize a variable with an expression of type any, the variable has type any too.any ç±»å‹æ˜¯ä¼ æ’­çš„ï¼Œ å¦‚æœåˆå§‹åŒ–ä¸€ä¸ªå˜é‡ä¸º any ç±»å‹ï¼Œå˜é‡çš„ç±»å‹ä¹Ÿæ˜¯ anyã€‚\nlet sepsis &#x3D; anys[0] + anys[1]; &#x2F;&#x2F; this could mean anything\n\nTo get an error when TypeScript produces an any, use â€œnoImplicitAnyâ€: true, or â€œstrictâ€: true in tsconfig.json.ä¸ºäº†åœ¨ TypeScript ç”Ÿæˆ any æ—¶å¾—åˆ°é”™è¯¯æç¤ºï¼Œä½¿ç”¨ &quot;noImplicitAny&quot;: true æˆ– &quot;strict&quot;: true åœ¨ tsconfig.json ä¸­ã€‚\nStructural typingç»“æ„ç±»å‹Structural typing is a familiar concept to most functional programmers, although Haskell and most MLs are not structurally typed. Its basic form is pretty simple:ç»“æ„æ€§ç±»å‹æ˜¯å¤§å¤šæ•°å‡½æ•°ç¼–ç¨‹ç¨‹åºå‘˜ç†Ÿæ‚‰çš„æ¦‚å¿µï¼Œå°½ç®¡ Haskell å’Œå¤§å¤šæ•° ML ä¸æ˜¯ç»“æ„æ€§ç±»å‹ã€‚\n&#x2F;&#x2F; @strict: false\nlet o &#x3D; &#123; x: &quot;hi&quot;, extra: 1 &#125;; &#x2F;&#x2F; ok\nlet o2: &#123; x: string &#125; &#x3D; o; &#x2F;&#x2F; ok\n\nHere, the object literal { x: â€œhiâ€, extra: 1 } has a matching literal type { x: string, extra: number }. That type is assignable to { x: string } since it has all the required properties and those properties have assignable types. The extra property doesnâ€™t prevent assignment, it just makes it a subtype of { x: string }.è¿™é‡Œï¼Œå¯¹è±¡å­—é¢é‡ &#123; x: &quot;hi&quot;, extra: 1 &#125; æœ‰ä¸€ä¸ªåŒ¹é…çš„å­—é¢é‡ç±»å‹ &#123; x: string, extra: number &#125;ã€‚Named types just give a name to a type; for assignability purposes thereâ€™s no difference between the type alias One and the interface type Two below. They both have a property p: string. (Type aliases behave differently from interfaces with respect to recursive definitions and type parameters, however.)å‘½åç±»å‹åªæ˜¯ç»™ä¸€ä¸ªç±»å‹å‘½åï¼›ç”¨äºç±»å‹èµ‹å€¼çš„ç›®çš„ä¸åŒäºæ¥å£ä¸‹é¢çš„ç±»å‹åˆ«åå’Œç±»å‹å‚æ•°ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æœ‰å±æ€§ p: stringã€‚ (ç±»å‹åˆ«åå’Œæ¥å£çš„é€’å½’å®šä¹‰å’Œç±»å‹å‚æ•°æœ‰æ‰€ä¸åŒã€‚)\ntype One &#x3D; &#123; p: string &#125;;\ninterface Two &#123;\n  p: string;\n&#125;\nclass Three &#123;\n  p &#x3D; &quot;Hello&quot;;\n&#125;\n\nlet x: One &#x3D; &#123; p: &quot;hi&quot; &#125;;\nlet two: Two &#x3D; x;\ntwo &#x3D; new Three();\n\nUnionsè”åˆç±»å‹\nIn TypeScript, union types are untagged. In other words, they are not discriminated unions like data in Haskell. However, you can often discriminate types in a union using built-in tags or other properties.åœ¨ TypeScript ä¸­ï¼Œè”åˆç±»å‹æ˜¯æ— æ ‡ç­¾çš„ã€‚ åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œè”åˆç±»å‹æ˜¯æ ‡ç­¾åŒ–çš„ã€‚\nfunction start(\n  arg: string | string[] | (() &#x3D;&gt; string) | &#123; s: string &#125;\n): string &#123;\n  &#x2F;&#x2F; this is super common in JavaScript\n  if (typeof arg &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;\n    return commonCase(arg);\n  &#125; else if (Array.isArray(arg)) &#123;\n    return arg.map(commonCase).join(&quot;,&quot;);\n  &#125; else if (typeof arg &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;\n    return commonCase(arg());\n  &#125; else &#123;\n    return commonCase(arg.s);\n  &#125;\n\n  function commonCase(s: string): string &#123;\n    &#x2F;&#x2F; finally, just convert a string to another string\n    return s;\n  &#125;\n&#125;\n\nstring, Array and Function have built-in type predicates, conveniently leaving the object type for the else branch. It is possible, however, to generate unions that are difficult to differentiate at runtime. For new code, itâ€™s best to build only discriminated unions.å­—ç¬¦ä¸²ã€æ•°ç»„å’Œå‡½æ•°æœ‰å†…ç½®ç±»å‹æ¨æ–­ï¼Œ å¯ä»¥åœ¨ else åˆ†æ”¯ä¸­æ¨æ–­å‡ºå¯¹è±¡ç±»å‹ã€‚The following types have built-in predicates:ä¸‹é¢çš„ç±»å‹æœ‰å†…ç½®æ¨æ–­ï¼šType Predicateç±»å‹æ¨æ–­&#96;\nstring typeof s &#x3D;&#x3D;&#x3D; â€œstringâ€number typeof n &#x3D;&#x3D;&#x3D; â€œnumberâ€bigint typeof m &#x3D;&#x3D;&#x3D; â€œbigintâ€boolean typeof b &#x3D;&#x3D;&#x3D; â€œbooleanâ€symbol typeof g &#x3D;&#x3D;&#x3D; â€œsymbolâ€undefined typeof undefined &#x3D;&#x3D;&#x3D; â€œundefinedâ€function typeof f &#x3D;&#x3D;&#x3D; â€œfunctionâ€array Array.isArray(a)object typeof o &#x3D;&#x3D;&#x3D; â€œobjectâ€\nNote that functions and arrays are objects at runtime, but have their own predicates.å‡½æ•°å’Œæ•°ç»„åœ¨è¿è¡Œæ—¶æ˜¯å¯¹è±¡ï¼Œ ä½†æ˜¯æœ‰è‡ªå·±çš„æ¨æ–­ã€‚&#96;\nIntersectionsäº¤å‰ç±»å‹\nIn addition to unions, TypeScript also has intersections:åœ¨ TypeScript ä¸­ï¼Œè¿˜æœ‰äº¤å‰ç±»å‹ï¼š\ntype Combined &#x3D; &#123; a: number &#125; &amp; &#123; b: string &#125;;\ntype Conflicting &#x3D; &#123; a: number &#125; &amp; &#123; a: string &#125;;\n\nCombined has two properties, a and b, just as if they had been written as one object literal type. Intersection and union are recursive in case of conflicts, so Conflicting.a: number &amp; string.Combined æœ‰ä¸¤ä¸ªå±æ€§ï¼Œa å’Œ bï¼Œ å¦‚æœå†™æˆä¸€ä¸ªå¯¹è±¡å­—é¢é‡ç±»å‹ï¼Œ åˆ™ a å’Œ b éƒ½æ˜¯ number å’Œ string ç±»å‹ã€‚\nUnit typeså•å…ƒç±»å‹Unit types are subtypes of primitive types that contain exactly one primitive value. For example, the string â€œfooâ€ has the type â€œfooâ€. Since JavaScript has no built-in enums, it is common to use a set of well-known strings instead. Unions of string literal types allow TypeScript to type this pattern:å•å…ƒç±»å‹æ˜¯åŸå§‹ç±»å‹çš„å­ç±»å‹ï¼Œ å®ƒä»¬åŒ…å«ä¸€ä¸ªåŸå§‹å€¼ã€‚\ndeclare function pad(s: string, n: number, direction: &quot;left&quot; | &quot;right&quot;): string;\npad(&quot;hi&quot;, 10, &quot;left&quot;);\n\nWhen needed, the compiler widens â€” converts to a supertype â€” the unit type to the primitive type, such as â€œfooâ€ to string. This happens when using mutability, which can hamper some uses of mutable variables:å½“éœ€è¦æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ‰©å±•ï¼Œ å°†å•å…ƒç±»å‹è½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œ ä¾‹å¦‚ &quot;foo&quot; è½¬æ¢ä¸º stringã€‚\nlet s &#x3D; &quot;right&quot;;\npad(&quot;hi&quot;, 10, s); &#x2F;&#x2F; error: &#39;string&#39; is not assignable to &#39;&quot;left&quot; | &quot;right&quot;&#39;\nArgument of type &#39;string&#39; is not assignable to parameter of type &#39;&quot;left&quot; | &quot;right&quot;&#39;.\n\nHereâ€™s how the error happens:è¿™é‡Œæœ‰ä¸€ä¸ªé”™è¯¯ï¼šâ€œrightâ€: â€œrightâ€\ns: string because â€œrightâ€ widens to string on assignment to a mutable variable.string is not assignable to â€œleftâ€ | â€œrightâ€\nYou can work around this with a type annotation for s, but that in turn prevents assignments to s of variables that are not of type â€œleftâ€ | â€œrightâ€.ä½ å¯ä»¥ä½¿ç”¨ç±»å‹æ³¨è§£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ ä½†æ˜¯è¿™ä¼šå¯¼è‡´ s çš„èµ‹å€¼ï¼Œ åªèƒ½èµ‹å€¼ç»™ &quot;left&quot; | &quot;right&quot; ç±»å‹çš„å˜é‡ã€‚\nlet s: &quot;left&quot; | &quot;right&quot; &#x3D; &quot;right&quot;;\npad(&quot;hi&quot;, 10, s);\n\nConcepts similar to Haskellä¸ Haskell ç±»ä¼¼çš„æ¦‚å¿µ\nContextual typingä¸Šä¸‹æ–‡ç±»å‹\nTypeScript has some obvious places where it can infer types, like variable declarations:TypeScript æœ‰ä¸€äº›æ˜æ˜¾çš„åœ°æ–¹ï¼Œ å¯ä»¥æ¨æ–­ç±»å‹ï¼Œ å¦‚å˜é‡å£°æ˜ã€‚\nlet s &#x3D; &quot;I&#39;m a string!&quot;;\n\nBut it also infers types in a few other places that you may not expect if youâ€™ve worked with other C-syntax languages:TypeScript ä¹Ÿå¯ä»¥æ¨æ–­åœ¨æŸäº›åœ°æ–¹æ²¡æœ‰å£°æ˜ç±»å‹çš„æƒ…å†µä¸‹ï¼Œ å¦‚æœä½ å·²ç»ä½¿ç”¨å…¶ä»– C-è¯­è¨€è¯­æ³•ï¼š\ndeclare function map&lt;T, U&gt;(f: (t: T) &#x3D;&gt; U, ts: T[]): U[];\nlet sns &#x3D; map((n) &#x3D;&gt; n.toString(), [1, 2, 3]);\n\nHere, n: number in this example also, despite the fact that T and U have not been inferred before the call. In fact, after [1,2,3] has been used to infer T&#x3D;number, the return type of n &#x3D;&gt; n.toString() is used to infer U&#x3D;string, causing sns to have the type string[].è¿™é‡Œï¼Œ n: number åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¹Ÿï¼Œ å³ä½¿åœ¨è°ƒç”¨ä¹‹å‰æ²¡æœ‰æ¨æ–­ T å’Œ U çš„ç±»å‹ã€‚ åœ¨å®é™…ä¸Šï¼Œ åœ¨ [1,2,3] è¢«ç”¨æ¥æ¨æ–­ T=number çš„æ—¶å€™ï¼Œ n =&gt; n.toString() çš„è¿”å›ç±»å‹ä¼šè¢«ç”¨æ¥æ¨æ–­ U=stringï¼Œ å¯¼è‡´ sns çš„ç±»å‹ä¸º string[]ã€‚Note that inference will work in any order, but intellisense will only work left-to-right, so TypeScript prefers to declare map with the array first:æ³¨æ„ï¼Œ æ¨æ–­ä¼šå·¥ä½œåœ¨ä»»ä½•é¡ºåºï¼Œ ä½†æ˜¯ intellisense åªä¼šä»å·¦åˆ°å³ï¼Œ å› æ­¤ TypeScript åªä¼šä¼˜å…ˆå£°æ˜ map å‡½æ•°ï¼Œ å…ˆå£°æ˜æ•°ç»„ã€‚\ndeclare function map&lt;T, U&gt;(ts: T[], f: (t: T) &#x3D;&gt; U): U[];\n\nContextual typing also works recursively through object literals, and on unit types that would otherwise be inferred as string or number. And it can infer return types from context:ä¸Šä¸‹æ–‡ç±»å‹ä¹Ÿå¯ä»¥é€’å½’åœ°é€šè¿‡å¯¹è±¡å­—é¢é‡ï¼Œ å’Œå•å…ƒç±»å‹ï¼Œ å¦‚æœæ²¡æœ‰å£°æ˜ç±»å‹ï¼Œ åˆ™ä¼šè¢«æ¨æ–­ä¸º string æˆ– numberã€‚ å¹¶ä¸”å¯ä»¥ä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡½æ•°çš„è¿”å›ç±»å‹ã€‚\ndeclare function run&lt;T&gt;(thunk: (t: T) &#x3D;&gt; void): T;\nlet i: &#123; inference: string &#125; &#x3D; run((o) &#x3D;&gt; &#123;\n  o.inference &#x3D; &quot;INSERT STATE HERE&quot;;\n&#125;);\n\nThe type of o is determined to be { inference: string } becauseè¿™ä¸ª o çš„ç±»å‹æ˜¯ç”± run å‡½æ•°çš„å‚æ•°ç±»å‹å†³å®šçš„ï¼Œ å› ä¸ºDeclaration initializers are contextually typed by the declarationâ€™s type: { inference: string }.å£°æ˜åˆå§‹å€¼æ˜¯ç”±å£°æ˜çš„ç±»å‹å†³å®šçš„The return type of a call uses the contextual type for inferences, so the compiler infers that T&#x3D;{ inference: string }.è°ƒç”¨çš„è¿”å›ç±»å‹æ˜¯ç”±ä¸Šä¸‹æ–‡ç±»å‹å†³å®šçš„ï¼Œ å› æ­¤ç¼–è¯‘å™¨ä¼šæ¨æ–­ T=&#123; inference: string &#125;ã€‚Arrow functions use the contextual type to type their parameters, so the compiler gives o: { inference: string }.ç®­å¤´å‡½æ•°ä½¿ç”¨ä¸Šä¸‹æ–‡ç±»å‹æ¥ç±»å‹å‚æ•°ï¼Œ å› æ­¤ç¼–è¯‘å™¨ä¼šç»™ o: &#123; inference: string &#125;ã€‚And it does so while you are typing, so that after typing o., you get completions for the property inference, along with any other properties youâ€™d have in a real program.è€Œä¸”è¿™æ ·ï¼Œ åœ¨ä½ è¾“å…¥ o. çš„æ—¶å€™ï¼Œ ä½ ä¼šå¾—åˆ° inference çš„å±æ€§çš„å®Œæ•´è¡¥å…¨ï¼Œ åŒæ—¶ä¹Ÿä¼šæœ‰å…¶ä»–å®é™…ç¨‹åºä¸­çš„å±æ€§ã€‚Altogether, this feature can make TypeScriptâ€™s inference look a bit like a unifying type inference engine, but it is not.è¿™ä¸ªåŠŸèƒ½å¯ä»¥è®© TypeScript çš„æ¨æ–­çœ‹èµ·æ¥åƒä¸€ä¸ªç»Ÿä¸€ç±»å‹æ¨æ–­å¼•æ“ï¼Œ ä½†æ˜¯å®ƒä¸æ˜¯ã€‚\nType aliasesç±»å‹åˆ«å\nType aliases are mere aliases, just like type in Haskell. The compiler will attempt to use the alias name wherever it was used in the source code, but does not always succeed.ç±»å‹åˆ«åæ˜¯ç±»å‹åˆ«åï¼Œ åƒ Haskell ä¸­çš„ç±»å‹ã€‚ ç¼–è¯‘å™¨ä¼šå°è¯•ä½¿ç”¨åˆ«ååç§°åœ¨æºä»£ç ä¸­ä½¿ç”¨ï¼Œ ä½†ä¸ä¸€å®šæˆåŠŸã€‚\ntype Size &#x3D; [number, number];\nlet x: Size &#x3D; [101.1, 999.9];\n\nThe closest equivalent to newtype is a tagged intersection:æœ€æ¥è¿‘çš„ç­‰ä»·æ˜¯æ ‡è®°äº¤é›†ï¼š\ntype FString &#x3D; string &amp; &#123; **compileTimeOnly: any &#125;;\n\n\nAn FString is just like a normal string, except that the compiler thinks it has a property named **compileTimeOnly that doesnâ€™t actually exist. This means that FString can still be assigned to string, but not the other way round.FString æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸²ï¼Œ ä½†æ˜¯ç¼–è¯‘å™¨è®¤ä¸ºå®ƒæœ‰ä¸€ä¸ªåä¸º **compileTimeOnly çš„å±æ€§ï¼Œ è¿™ä¸ªå±æ€§å¹¶ä¸å­˜åœ¨ã€‚ è¿™æ„å‘³ç€ FString ä»ç„¶å¯ä»¥è¢«èµ‹å€¼ç»™ stringï¼Œ ä½†æ˜¯ä¸èƒ½è¢«èµ‹å€¼ç»™å…¶ä»–ç±»å‹ã€‚\nDiscriminated Unionså¯è¯†åˆ«è”åˆ\nThe closest equivalent to data is a union of types with discriminant properties, normally called discriminated unions in TypeScript:æœ€æ¥è¿‘çš„ç­‰ä»·æ˜¯æ•°æ®çš„ä¸€ä¸ªè”åˆç±»å‹ï¼Œ å¸¸è§çš„æ˜¯ TypeScript ä¸­çš„åˆ†å±‚è”åˆï¼š\ntype Shape &#x3D;\n  | &#123; kind: &quot;circle&quot;; radius: number &#125;\n  | &#123; kind: &quot;square&quot;; x: number &#125;\n  | &#123; kind: &quot;triangle&quot;; x: number; y: number &#125;;\n\nUnlike Haskell, the tag, or discriminant, is just a property in each object type. Each variant has an identical property with a different unit type. This is still a normal union type; the leading | is an optional part of the union type syntax. You can discriminate the members of the union using normal JavaScript code:ä¸ Haskell ä¸åŒï¼Œ æ ‡è®°ï¼Œ æˆ–è€…è¯´åˆ†å±‚è”åˆçš„æ ‡è®°ï¼Œ åœ¨æ¯ä¸ªå¯¹è±¡ç±»å‹ä¸­éƒ½æ˜¯ä¸€ä¸ªå±æ€§ã€‚ æ¯ä¸ªå˜ä½“éƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„å±æ€§ï¼Œ å¹¶ä¸”å®ƒçš„å•å…ƒç±»å‹ä¸åŒã€‚ è¿™ä»ç„¶æ˜¯ä¸€ä¸ªè”åˆç±»å‹ï¼› å‰é¢çš„ | æ˜¯è”åˆç±»å‹çš„å¯é€‰éƒ¨åˆ†ã€‚ ä½ å¯ä»¥ä½¿ç”¨æ™®é€šçš„ JavaScript ä»£ç æ¥åŒºåˆ†è”åˆæˆå‘˜ï¼š\ntype Shape &#x3D;\n| &#123; kind: &quot;circle&quot;; radius: number &#125;\n| &#123; kind: &quot;square&quot;; x: number &#125;\n| &#123; kind: &quot;triangle&quot;; x: number; y: number &#125;;\n\nfunction area(s: Shape) &#123;\n  if (s.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;\n    return Math.PI _ s.radius _ s.radius;\n  &#125; else if (s.kind &#x3D;&#x3D;&#x3D; &quot;square&quot;) &#123;\n    return s.x _ s.x;\n  &#125; else &#123;\n  r eturn (s.x _ s.y) &#x2F; 2;\n  &#125;\n&#125;\n\nNote that the return type of area is inferred to be number because TypeScript knows the function is total. If some variant is not covered, the return type of area will be number | undefined instead.æ³¨æ„ï¼Œ area çš„è¿”å›ç±»å‹è¢«æ¨æ–­ä¸º numberï¼Œ å› ä¸º TypeScript çŸ¥é“å‡½æ•°æ˜¯å®Œå…¨çš„ã€‚ å¦‚æœæŸä¸ªå˜ä½“æ²¡æœ‰è¢«è¦†ç›–ï¼Œ area çš„è¿”å›ç±»å‹å°†ä¼šæ˜¯ number | undefinedã€‚Also, unlike Haskell, common properties show up in any union, so you can usefully discriminate multiple members of the union:ä¸ Haskell ä¸åŒï¼Œ å…±æœ‰å±æ€§åœ¨è”åˆä¸­æ˜¾ç¤ºï¼Œ ä½ å¯ä»¥ä½¿ç”¨æœ‰æ•ˆçš„æ–¹å¼æ¥åŒºåˆ†è”åˆæˆå‘˜ï¼š\nfunction height(s: Shape) &#123;\n  if (s.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;\n    return 2 \\* s.radius;\n  &#125; else &#123;\n  &#x2F;&#x2F; s.kind: &quot;square&quot; | &quot;triangle&quot;\n    return s.x;\n  &#125;\n&#125;\n\nType Parameterså‚æ•°ç±»å‹Like most C-descended languages, TypeScript requires declaration of type parameters:ç±»ä¼¼äºå¤§å¤šæ•° C-descended è¯­è¨€ï¼Œ TypeScript éœ€è¦å£°æ˜ç±»å‹å‚æ•°ï¼š\nfunction liftArray&lt;T&gt;(t: T): Array&lt;T&gt; &#123;\n  return [t];\n&#125;\n\nThere is no case requirement, but type parameters are conventionally single uppercase letters. Type parameters can also be constrained to a type, which behaves a bit like type class constraints:æ²¡æœ‰è¦æ±‚ï¼Œ ä½†æ˜¯ç±»å‹å‚æ•°æ˜¯ä¸€ä¸ªæƒ¯ä¾‹ï¼Œ å•å¤§å†™å­—æ¯ã€‚ ç±»å‹å‚æ•°å¯ä»¥è¢«é™åˆ¶ä¸ºä¸€ä¸ªç±»å‹ï¼Œ è¿™ä¸ªç±»å‹è¡Œä¸ºç±»ä¼¼äºç±»å‹çº¦æŸï¼š\nfunction firstish&lt;T extends &#123; length: number &#125;&gt;(t1: T, t2: T): T &#123;\n  return t1.length &gt; t2.length ? t1 : t2;\n&#125;\n\nTypeScript can usually infer type arguments from a call based on the type of the arguments, so type arguments are usually not needed.TypeScript å¯ä»¥é€šè¿‡è°ƒç”¨å‚æ•°çš„ç±»å‹æ¨æ–­å‡ºç±»å‹å‚æ•°ï¼Œ å› æ­¤é€šå¸¸ä¸éœ€è¦æŒ‡å®šç±»å‹å‚æ•°ã€‚Because TypeScript is structural, it doesnâ€™t need type parameters as much as nominal systems. Specifically, they are not needed to make a function polymorphic. Type parameters should only be used to propagate type information, such as constraining parameters to be the same type:TypeScript æ˜¯ç»“æ„æ€§çš„ï¼Œ ä¸éœ€è¦ç±»å‹å‚æ•°ï¼Œ å› ä¸ºå®ƒä»¬ä¸éœ€è¦ä½¿ä¸€ä¸ªå‡½æ•°å¤šæ€ã€‚ ç±»å‹å‚æ•°åªæ˜¯ç”¨æ¥ä¼ é€’ç±»å‹ä¿¡æ¯ï¼Œ å¦‚é™åˆ¶å‚æ•°ä¸ºç›¸åŒç±»å‹ï¼š\nfunction length&lt;T extends ArrayLike&lt;unknown&gt;&gt;(t: T): number &#123;&#125;\nfunction length(t: ArrayLike&lt;unknown&gt;): number &#123;&#125;\n\nIn the first length, T is not necessary; notice that itâ€™s only referenced once, so itâ€™s not being used to constrain the type of the return value or other parameters.åœ¨ç¬¬ä¸€ä¸ª lengthï¼Œ T æ²¡æœ‰å¿…è¦ï¼› å¯ä»¥æ³¨æ„ï¼Œ å®ƒåªè¢«å¼•ç”¨ä¸€æ¬¡ï¼Œ å› æ­¤å®ƒä¸ä¼šè¢«ç”¨æ¥é™åˆ¶è¿”å›å€¼æˆ–å…¶ä»–å‚æ•°çš„ç±»å‹ã€‚\nHigher-kinded typesé«˜é˜¶ç±»å‹\nTypeScript does not have higher kinded types, so the following is not legal:TypeScript ä¸æ”¯æŒé«˜é˜¶ç±»å‹ï¼Œ å› æ­¤ä¸‹é¢çš„ä¸åˆæ³•ï¼š\nfunction length&lt;T extends ArrayLike&lt;unknown&gt;, U&gt;(m: T&lt;U&gt;) &#123;&#125;\n\nPoint-free programmingPoint-free programming â€” heavy use of currying and function composition â€” is possible in JavaScript, but can be verbose. In TypeScript, type inference often fails for point-free programs, so youâ€™ll end up specifying type parameters instead of value parameters. The result is so verbose that itâ€™s usually better to avoid point-free programming.ç‚¹-free ç¼–ç¨‹ â€” é‡é‡çº§çš„ä½¿ç”¨ curry å’Œå‡½æ•°ç»„åˆ â€” åœ¨ JavaScript ä¸­å¯ä»¥ï¼Œ ä½†æ˜¯å¯èƒ½ä¼šå¾ˆå¤šã€‚ åœ¨ TypeScript ä¸­ï¼Œ ç±»å‹æ¨æ–­å¯¹ç‚¹-free ç¼–ç¨‹å¤±è´¥ï¼Œ å› æ­¤ä½ ä¼šæŒ‡å®šç±»å‹å‚æ•°è€Œä¸æ˜¯å€¼å‚æ•°ã€‚ ç»“æœæ˜¯è¿™æ ·çš„å¤šï¼Œ å› æ­¤æ¯”è¾ƒé€‚åˆé¿å…ç‚¹-free ç¼–ç¨‹ã€‚\nModule systemæ¨¡å—ç³»ç»Ÿ\nJavaScriptâ€™s modern module syntax is a bit like Haskellâ€™s, except that any file with import or export is implicitly a module:JavaScript çš„ç°ä»£æ¨¡å—è¯­æ³•å’Œ Haskell ç±»ä¼¼ï¼Œ åªæ˜¯ä»»ä½•å¸¦æœ‰ import æˆ– export çš„æ–‡ä»¶éƒ½æ˜¯éšå¼çš„æ¨¡å—ï¼š\nimport &#123; value, Type &#125; from &quot;npm-package&quot;;\nimport &#123; other, Types &#125; from &quot;.&#x2F;local-package&quot;;\nimport \\* as prefix from &quot;..&#x2F;lib&#x2F;third-package&quot;;\n\n\nYou can also import commonjs modules â€” modules written using node.jsâ€™ module system:ä½ ä¹Ÿå¯ä»¥å¯¼å…¥ commonjs æ¨¡å— â€” ä½¿ç”¨ node.js çš„æ¨¡å—ç³»ç»Ÿå†™çš„æ¨¡å—ï¼š\nimport f &#x3D; require(&quot;single-function-package&quot;);\n\nYou can export with an export list:ä½ å¯ä»¥ä½¿ç”¨ export åˆ—è¡¨å¯¼å‡ºï¼š\nexport &#123; f &#125;;\nfunction f() &#123;\n  return g();\n&#125;\nfunction g() &#123;&#125; &#x2F;&#x2F; g is not exported\n\nOr by marking each export individually:æˆ–è€…é€šè¿‡å•ç‹¬æ ‡è®°æ¯ä¸ªå¯¼å‡ºï¼š\nexport function f &#123; return g() &#125;\nfunction g() &#123; &#125;\n\nThe latter style is more common but both are allowed, even in the same file.åè€…æ›´å¸¸è§ï¼Œ ä½†æ˜¯éƒ½å¯ä»¥ï¼Œ å³ä½¿åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚\nreadonly and constIn JavaScript, mutability is the default, although it allows variable declarations with const to declare that the reference is immutable. The referent is still mutable:åœ¨ JavaScript ä¸­ï¼Œ å¯å˜æ€§æ˜¯é»˜è®¤çš„ï¼Œ å³ä½¿å®ƒå…è®¸ä½¿ç”¨ const å£°æ˜çš„å˜é‡å£°æ˜å¼•ç”¨æ˜¯ä¸å¯å˜çš„ã€‚ å¼•ç”¨ä»ç„¶å¯å˜ï¼š\nconst a &#x3D; [1, 2, 3];\na.push(102); &#x2F;&#x2F; ):\na[0] &#x3D; 101; &#x2F;&#x2F; D:\n\nTypeScript additionally has a readonly modifier for properties.TypeScript è¿˜æœ‰ä¸€ä¸ª readonly å±æ€§ä¿®é¥°ç¬¦ã€‚\ninterface Rx &#123;\n  readonly x: number;\n&#125;\nlet rx: Rx &#x3D; &#123; x: 1 &#125;;\nrx.x &#x3D; 12; &#x2F;&#x2F; error\n\nIt also ships with a mapped type Readonly that makes all properties readonly:å®ƒè¿˜æœ‰ä¸€ä¸ªæ˜ å°„ç±»å‹ Readonly&lt;T&gt;ï¼Œ è®©æ‰€æœ‰å±æ€§éƒ½å˜æˆåªè¯»çš„ï¼š\ninterface X &#123;\n  x: number;\n&#125;\nlet rx: Readonly&lt;X&gt; &#x3D; &#123; x: 1 &#125;;\nrx.x &#x3D; 12; &#x2F;&#x2F; error\n\nAnd it has a specific ReadonlyArray type that removes side-affecting methods and prevents writing to indices of the array, as well as special syntax for this type:å®ƒè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ ReadonlyArray&lt;T&gt; ç±»å‹ï¼Œ å»é™¤äº†ä¾§å½±å“çš„æ–¹æ³•å’Œé˜²æ­¢å†™å…¥æ•°ç»„ç´¢å¼•ï¼Œ åŒæ—¶è¿˜æœ‰è¿™ç§ç±»å‹çš„ç‰¹æ®Šè¯­æ³•ï¼š\nlet a: ReadonlyArray&lt;number&gt; &#x3D; [1, 2, 3];\nlet b: readonly number[] &#x3D; [1, 2, 3];\na.push(102); &#x2F;&#x2F; error\nb[0] &#x3D; 101; &#x2F;&#x2F; error\n\nYou can also use a const-assertion, which operates on arrays and object literals:ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ const æ–­è¨€ï¼Œ å®ƒæ“ä½œäº†æ•°ç»„å’Œå¯¹è±¡å­—é¢é‡ï¼š\nlet a &#x3D; [1, 2, 3] as const;\na.push(102); &#x2F;&#x2F; error\na[0] &#x3D; 101; &#x2F;&#x2F; error\n\nHowever, none of these options are the default, so they are not consistently used in TypeScript code.ä½†æ˜¯ï¼Œ æ²¡æœ‰è¿™äº›é€‰é¡¹æ˜¯é»˜è®¤çš„ï¼Œ å› æ­¤å®ƒä»¬ä¸æ˜¯ä¸€è‡´åœ°ä½¿ç”¨åœ¨ TypeScript ä»£ç ä¸­ã€‚\nNext Stepsä¸‹ä¸€æ­¥\nThis doc is a high level overview of the syntax and types you would use in everyday code. From here you should:æ­¤æ–‡æ¡£æ˜¯æ—¥å¸¸ä»£ç ä¸­çš„è¯­æ³•å’Œç±»å‹ä¸€ä¸ªé«˜çº§çš„æ¦‚è§ˆï¼Œ ä»è¿™é‡Œä½ åº”è¯¥ï¼šRead the full Handbook from start to finish (30m)é˜…è¯»å®Œæ•´çš„æ‰‹å†Œï¼ˆ30åˆ†é’Ÿï¼‰Explore the Playground examplesæ¢ç´¢ Playground ç¤ºä¾‹\n5 åˆ†é’Ÿå†…äº†è§£ Typescriptè·³è¿‡ï¼Œè¿™éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œçœ‹åŸæ–‡å§ï¼Œä¹‹åé‡ç‚¹æ”¾åˆ°æ‰‹å†Œé‡Œã€‚\n","slug":"2022-06-08ts-start","date":"2022-06-06T01:58:32.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"41038c8a05f130e72afb64f08ff12861","title":"https","content":"åæ§½æ˜é‡‘\nåå°æœ‰å®šæ—¶å™¨åœ¨è¿è¡Œï¼Œä¸€ç›´å‘é€è¯·æ±‚ï¼Œæ‰“å¼€å¤šä¸ª web æ ‡ç­¾é¡µé¢ï¼Œcpu ç›´æ¥é£™å‡åˆ° 100% +ï¼Œé‰´äºæ˜é‡‘å¤ªå¡ï¼Œæ‰€ä»¥è½¬è½½\n\nä¸ºä»€ä¹ˆè¦æœ‰ HTTPSåœ¨ HTTPS å‡ºç°ä¹‹å‰ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ˜¯ä»¥æ˜æ–‡æ–¹å¼é€å‡ºçš„ï¼Œé‚£ä¹ˆå¦‚æœæœ‰äººåœ¨ä¼ è¾“é€”ä¸­å·å¬æˆ–è€…æŠ“åŒ…çš„è¯ï¼Œä½ çš„æ‰€æœ‰é€šä¿¡å†…å®¹éƒ½ä¼šæ³„æ¼ã€‚æ¯”è¾ƒå®‰å…¨çš„æ–¹æ³•æ˜¯å°†é€šä¿¡å†…å®¹åŠ å¯†åœ¨å‘é€ç»™å¯¹æ–¹ã€‚åŠ å¯†æ–¹æ³•æœ‰ä¸¤ç§ï¼Œå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚\nå¯¹ç§°åŠ å¯†\nå¯¹ç§°åŠ å¯†æŒ‡çš„æ˜¯åŠ å¯†å’Œè§£å¯†ç”¨åŒä¸€ä¸ªå¯†é’¥ã€‚\nä½†æ˜¯åœ¨é€šä¿¡ä¹‹å‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯ä¸ä¼šæœ‰è¿™æ ·åŒä¸€æŠŠå¯†é’¥çš„ã€‚éœ€è¦å…¶ä¸­ä¸€æ–¹å°†å¯†é’¥å‘é€ç»™å¯¹æ–¹ã€‚\nåœ¨æ•´ä¸ªä¼ è¾“è¿‡ç¨‹æ²¡æœ‰ä»»ä½•éªŒè¯æ“ä½œï¼Œæ‰€ä»¥é»‘å®¢ä¹Ÿå¯ä»¥æˆªå–åˆ°è¿™æŠŠå¯†é’¥ä»è€Œç ´è¯‘å‡ºåŠ å¯†çš„å†…å®¹ã€‚æ‰€ä»¥çº¯å¯¹ç§°åŠ å¯†æ˜¯ä¸å®‰å…¨çš„ã€‚\n\néå¯¹ç§°åŠ å¯†éå¯¹ç§°åŠ å¯†æŒ‡çš„æ˜¯åŠ å¯†å’Œè§£å¯†ç”¨ä¸åŒçš„å¯†é’¥ã€‚å¯ä»¥æ˜¯ç”¨ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‚ä½†æ˜¯ä¼šæœ‰è¿™ç§æƒ…å†µã€‚\n\næœåŠ¡ç«¯æ‹¥æœ‰ç§é’¥å’Œå…¬é’¥ï¼Œå°†å…¬é’¥å‘ç»™å®¢æˆ·ç«¯ã€‚æ—¢ç„¶å®¢æˆ·ç«¯å¯ä»¥è·å¾—å…¬é’¥ï¼Œé»‘å®¢ä¹Ÿå¯ä»¥è·å¾—å…¬é’¥ã€‚é‚£ä¹ˆæœåŠ¡ç«¯å‘é€ç»™å®¢æˆ·ç«¯çš„æ‰€æœ‰å†…å®¹é»‘å®¢ä¹Ÿæ˜¯å¯ä»¥è§£è¯»çš„ã€‚\nå®¢æˆ·ç«¯ç”¨å…¬é’¥åŠ å¯†å‘é€ç»™æœåŠ¡ç«¯ä¸å—å½±å“ï¼Œå› ä¸ºé»‘å®¢æ‰‹ä¸Šæ²¡æœ‰æœåŠ¡å™¨çš„ç§é’¥ã€‚æ‰€ä»¥çº¯éå¯¹ç§°åŠ å¯†ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ã€‚\n\nä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹\nå›¾è§£ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹HTTPS é‡‡ç”¨å¯¹ç§°åŠ å¯†æ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Œæ‰€ç”¨çš„å¯†é’¥ç§°ä¸º Aã€‚ç”¨éå¯¹ç§°åŠ å¯†æ¥åŠ å¯†å¯†é’¥ A å†å‘é€ç»™å¯¹æ–¹ï¼ˆæœ‰ç‚¹ç»•ï¼‰ã€‚åªè¦å¯†é’¥ A ä¸è½å…¥ä»–äººæ‰‹ä¸­ï¼Œé‚£ä¼ è¾“çš„æ•°æ®å°±ä¸ä¼šè¢«åˆ«äººç ´è¯‘ã€‚\né‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¦å¦‚ä½•å®‰å…¨çš„å°†è¿™æŠŠå¯†é’¥é€åˆ°å¯¹æ–¹æ‰‹ä¸Šå‘¢ï¼Ÿ\næˆ‘ä»¬æ¥çœ‹å¯†é’¥çš„ä¼ è¾“è¿‡ç¨‹\nä¸ºä»€ä¹ˆ HTTPS æ˜¯å¯é çš„ï¼ŸHTTPS æ˜¯å¯é çš„ï¼Œå› ä¸ºå®ƒè§£å†³äº†ä¸‰ä¸ªé—®é¢˜ã€‚\n\nåŠ å¯†é€šä¿¡ï¼Œå³ä½¿åˆ«äººè·å–åˆ°äº†ä¿¡æ¯ä¹Ÿæ²¡æ³•å¤åŸæˆåŸæ¥çš„ä¿¡æ¯ã€‚\né˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚é»‘å®¢æ²¡æ³•å†’å……æœåŠ¡ç«¯ã€‚å› ä¸ºåœ¨ç¬¬ 2 æ­¥ï¼ŒæœåŠ¡ç«¯ç»™äº†å®¢æˆ·ç«¯ä¸€ä¸ª CA è¯ä¹¦ã€‚\n\n\nå¦‚æœå®¢æˆ·ç«¯éªŒè¯äº†è¿™ä¸ªè¯ä¹¦ï¼Œè¯´æ˜è¿™ä¸ªè¯ä¹¦å’Œå…¬é’¥æ˜¯ç”±æœåŠ¡ç«¯å‘æ¥çš„ä¸”çœŸå®å¯é ã€‚\nå¦‚æœå®¢æˆ·ç«¯éªŒè¯ä¸äº†è¿™ä¸ªè¯ä¹¦ï¼Œå°±è¯´æ˜è¿™ä¸ªè¯ä¹¦ä¸å¯é ï¼Œæœ‰å¯èƒ½æ˜¯å‡çš„ã€‚\n\n\nCA è¯ä¹¦çš„å…¬ä¿¡åŠ›CA è¯ä¹¦éœ€è¦ç”±å…¬å¸æˆ–è€…ä¸ªäººå‘å‡ºç”³è¯·ï¼Œå†é€šè¿‡é‚®ç®±éªŒè¯ç­‰æ–¹æ³•éªŒè¯åŸŸåå­˜åœ¨ã€‚é¿å…äº†é»‘å®¢å†’å……ç½‘ç«™è·å–è¯ä¹¦çš„å¯èƒ½ã€‚åœ¨æŠ€æœ¯å±‚é¢ä¸Šï¼ŒCA æœºæ„çš„å…¬é’¥æ˜¯å†™åœ¨æ“ä½œç³»ç»Ÿæˆ–è€…æµè§ˆå™¨é‡Œçš„ã€‚åªæœ‰ç”¨ CA æœºæ„çš„ç§é’¥åŠ å¯†çš„å†…å®¹æ‰èƒ½å®Œæˆè§£å¯†ã€‚ç¡®ä¿äº†è¯ä¹¦çš„ç¡®æ˜¯ CA æœºæ„å‘è¡Œçš„ã€‚\n\nå¯†é’¥çš„ä½œç”¨æœ€åè®©æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹æ¯ä¸€æŠŠå¯†é’¥çš„ä½œç”¨\nHTTPSä¸€å®šå®‰å…¨å—éå…¨ç«™HTTPSå¹¶ä¸å®‰å…¨\nç™»å½•é¡µé¢æ”¯æŒHTTPSä¸å°±è¡Œäº†ï¼Œé¦–é¡µåˆæ²¡æœ‰æ¶‰åŠè´¦æˆ·ä¿¡æ¯å…¶å®è¿™æ˜¯éå¸¸ä¸å®‰å…¨çš„è¡Œä¸ºï¼Œé»‘å®¢ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡Œæ”»å‡»ï¼Œä¸€èˆ¬æ˜¯ä»¥ä¸‹æµç¨‹ï¼š\n1.ç”¨æˆ·åœ¨é¦–é¡µç‚¹å‡»ã€Œç™»å½•ã€ï¼Œé¡µé¢è·³è½¬åˆ°æœ‰htpsçš„ç½‘é“¶é¡µé¢ï¼Œä½†æ­¤æ—¶ç”±äºé¦–é¡µæ˜¯htpè¯·æ±‚ï¼Œæ‰€ä»¥æ˜¯æ˜æ–‡çš„ï¼Œè¿™å°±ä¼šè¢«é»‘å®¢åŠ«æŒ2.é»‘å®¢åŠ«æŒç”¨æˆ·çš„è·³è½¬è¯·æ±‚ï¼Œå°†httpsç½‘é“¶é¡µé¢åœ°å€è½¬æ¢ä¸ºhttpçš„åœ°å€å†å‘é€ç»™é“¶è¡Œ\nç”¨æˆ·&lt;&#x3D;&#x3D;HTTP&#x3D;&#x3D;&gt;é»‘å®¢&lt;&#x3D;&#x3D;HTTPS&#x3D;&#x3D;&gt;é“¶è¡Œ\n1.æ­¤æ—¶å¦‚æœç”¨æˆ·è¾“å…¥è´¦æˆ·ä¿¡æ¯ï¼Œé‚£ä¹ˆä¼šè¢«ä¸­é—´çš„é»‘å®¢è·å–ï¼Œæ­¤æ—¶çš„è´¦å·å¯†ç å°±è¢«æ³„éœ²äº†\nå¥½åœ¨æ˜¯é“¶è¡Œçš„ç½‘é“¶é¡µé¢,åªæ”¯æŒhtps,å› æ­¤ä¸Šè¿°æ”»å‡»æš‚æ—¶æ˜¯æ— æ•ˆçš„\nå‚è€ƒèµ„æ–™ã€web å®‰å…¨ 3ã€‘ã€ç¡¬æ ¸ã€‘HTTPS åŸç†å…¨è§£æ\nä½œè€…ï¼šç«™åœ¨ä¹¦è„Šä¹‹ä¸Šé“¾æ¥ï¼šhttps://juejin.cn/post/6844904160089882631æ¥æºï¼šç¨€åœŸæ˜é‡‘è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n","slug":"2022-06-05https","date":"2022-06-05T03:55:17.000Z","categories_index":"http","tags_index":"http","author_index":"é™ˆæµ·é¾™"},{"id":"e33992d78838483e28879a1cdf87c45e","title":"å†å­¦Vue3-7 æœ€ä½³å®è·µ","content":"æ¦‚è§ˆ\n\n\næ€§èƒ½\nå®‰å…¨\n","slug":"2022-06-02vue-7","date":"2022-06-02T12:05:05.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"9392b2f9395b41b1da45c31165be4e75","title":"å†å­¦Vue3-8 typescript","content":"æ¦‚è§ˆ\n\n\nç»„åˆå¼\né€‰é¡¹å¼\n","slug":"2022-06-02vue-8","date":"2022-06-02T12:05:05.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"f63d02067666595ede9bc0ebd108b1ee","title":"å†å­¦Vue3-6 å‡çº§è§„æ¨¡","content":"æ¦‚è§ˆ\n\n\nçŠ¶æ€ç®¡ç†\n","slug":"2022-06-02vue-6","date":"2022-06-02T11:53:33.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"24ee6bb08e318ca140f4cc0224000a69","title":"å†å­¦Vue3-5 å†…ç½®ç»„ä»¶","content":"æ¦‚è§ˆ\n\n\nKeepAlive\nteleportÂ·ä¼ é€é—¨\nSuspense\nè¿‡æ¸¡ \n","slug":"2022-06-02vue-5","date":"2022-06-02T11:45:19.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"2dcf5d3fa228390b9a53cb50e779c427","title":"å†å­¦Vue3-4 å¯é‡ç”¨æ€§","content":"æ¦‚è§ˆ\n\n\nå¯é‡ç”¨æ€§\nç»„åˆå‡½æ•°\nè‡ªå®šä¹‰æŒ‡ä»¤\næ’ä»¶","slug":"2022-06-02vue-4","date":"2022-06-02T10:49:24.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"64389360ee809707debd2fd41c5138f2","title":"å†å­¦Vue3-3 æ·±å…¥ç»„ä»¶","content":"æ¦‚è§ˆ\n\n\næ·±å…¥ç»„ä»¶\næ³¨å†Œprop\näº‹ä»¶\né€ä¼  Attribute\næ’æ§½\nä¾èµ–æ³¨å…¥\nå¼‚æ­¥ç»„ä»¶\nå¯é‡ç”¨æ€§\nç»„åˆå‡½æ•°\nè‡ªå®šä¹‰æŒ‡ä»¤\næ’ä»¶","slug":"2022-06-02vue-3","date":"2022-06-02T10:49:23.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"f9fd2a8578c770321fc9e0db644f4563","title":"å†å­¦Vue3-2 v3","content":"v3\n\n\nå“åº”å¼åŸºç¡€\nè®¡ç®—å±æ€§\nç”Ÿå‘½å‘¨æœŸ\nä¾¦å¬å™¨\næ¨¡ç‰ˆ ref\nç»„ä»¶åŸºç¡€\n","slug":"2022-06-02vue-2","date":"2022-06-02T10:49:22.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"2620e5e38d0a5713fc7f864f91b17d5f","title":"å†å­¦Vue3-1 åŸºç¡€","content":"æ¦‚è§ˆ\n\nv2\næ¨¡ç‰ˆè¯­æ³•\n\n\næ•°æ®ç»‘å®š\n\n\näº‹ä»¶ç»‘å®š\nè¡¨å•è¾“å…¥ç»‘å®š\næ’ä»¶\n","slug":"2022-06-02vue-1","date":"2022-06-02T10:49:21.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"98cc42407c73e25079ab5c02aa5f251b","title":"å†å­¦Vue3-0 æ¦‚è§ˆ","content":"vue3\nä½¿ç”¨ proxy é‡å†™äº† vue2ï¼Œå¹¶å¢åŠ äº†ç»„åˆå¼ api\nä»¥ä¸‹æ€ç»´å¯¼å›¾ä»¥vue3 æ–‡æ¡£å†…å®¹ä¸ºä¾æ®ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç»˜åˆ¶\nå­¦ä¹ è¿‡ç¨‹ä¸­å¯¹æ¯”äº† vue3 å’Œ react\nå¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡çœ‹vueäº†ï¼Œvue3ä¸€ç›´æ²¡æ¥è§¦ï¼Œåª³å¦‡ä¸å­¦ã€‚ä¸‡ä¸€å“ªå¤©åª³å¦‡éœ€è¦ç”¨vue3äº†ï¼Œæ²¡äººå¸¦å²‚ä¸æ˜¯è¦å¤±ä¸šï¼Œèµ¶ç´§å­¦èµ·æ¥ï½æ¦‚è§ˆ\n\n\n\n\n\né—®é¢˜\nå¿µå¨ç€ æ¸è¿›å¼ ä¾èµ–æ”¶é›† å»å­¦ä¹ vueæŒ‡å—\n\n\n","slug":"2022-06-02vue-0","date":"2022-06-02T10:49:20.000Z","categories_index":"vue","tags_index":"vue","author_index":"é™ˆæµ·é¾™"},{"id":"e7a12532b015cb78e0adb01f9bc03b9e","title":"react useState é”™è¯¯ä½¿ç”¨","content":"Shareconst Share: FC&lt;ShareProps&gt; &#x3D; (props) &#x3D;&gt; &#123;\n  const &#123; entityType, entityCode &#125; &#x3D; props\n\n  const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;\n    value: props.value,\n    title: props.title,\n    shareId: props.shareId,\n    mappingPassword: props.mappingPassword,\n    passwordEnable: props.passwordEnable,\n    mappingState: props.mappingState,\n    expireTime: props.expireTime,\n    shortCode: props.shortCode,\n  &#125;)\n\n\n  const &#123; value &#125; &#x3D; state\n\n  ...\n\n  return (\n    &lt;div&gt;\n      &#123;renderBtn&#125;\n      &lt;ShareModal\n        entityType&#x3D;&#123;entityType&#125;\n        entityCode&#x3D;&#123;entityCode&#125;\n        &#123;...modalProps&#125;\n        state&#x3D;&#123;state&#125;\n        setState&#x3D;&#123;setState&#125;\n      &#x2F;&gt;\n    &lt;&#x2F;div&gt;\n  )\n&#125;\n\nexport default Share\n\n\nShareModal\ninterface ShareModalProps extends ModalFuncProps &#123;\n  entityType: EntityType\n  entityCode: string\n  className?: string\n  state: StateProps\n  setState: (state: StateProps) &#x3D;&gt; void\n&#125;\n\nconst Copy &#x3D; (&#123; text, children &#125;: &#123; text: string; children: string &#125;) &#x3D;&gt; &#123;\n  return (\n    &lt;CopyToClipboard\n      text&#x3D;&#123;text&#125;\n      onCopy&#x3D;&#123;() &#x3D;&gt; &#123;\n        message.success(&#39;é“¾æ¥å·²å¤åˆ¶&#39;)\n      &#125;&#125;\n    &gt;\n      &lt;span&gt;&#123;children&#125;&lt;&#x2F;span&gt;\n    &lt;&#x2F;CopyToClipboard&gt;\n  )\n&#125;\n\nconst ShareModal: FC&lt;ShareModalProps&gt; &#x3D; (props) &#x3D;&gt; &#123;\n  const [form] &#x3D; HookForm.useForm()\n\n  const &#123; state, setState, entityType, entityCode, ...restProps &#125; &#x3D; props\n\n  const &#123; value, title, mappingPassword, shortCode, expireTime &#125; &#x3D; state\n\n  const &#123;\n    onChange: toggle,\n    resetPassword: reset,\n    update,\n  &#125; &#x3D; useShare(&#123;\n    entityCode,\n    entityType,\n    state,\n    setState,\n  &#125;)\n\n\n  ....\n\n  return (\n    &lt;Modal\n      &#123;...restProps&#125;\n      className&#x3D;&#123;styles[&#39;share-modal-wrap&#39;]&#125;\n      title&#x3D;&quot;é“¾æ¥åˆ†äº«&quot;\n      destroyOnClose\n      width&#x3D;&#123;420&#125;\n      footer&#x3D;&#123;null&#125;\n    &gt;\n      &lt;ConditionComponent isShow&#x3D;&#123;value&#125;&gt;\n        ....\n        &lt;HookForm form&#x3D;&#123;form&#125; style&#x3D;&#123;&#123; marginBottom: 10, width: &#39;100%&#39; &#125;&#125; layout&#x3D;&quot;vertical&quot;&gt;\n          &lt;HookForm.Item noStyle shouldUpdate&gt;\n            &#123;() &#x3D;&gt; &#123;\n              const &#123; url, mappingPassword, expireTime &#125; &#x3D; form.getFieldsValue()\n              const text &#x3D; &#96;$&#123;url&#125;ï¼ˆå¯†ç ï¼š$&#123;mappingPassword&#125;ï¼‰ã€Š$&#123;title&#125;ã€‹$&#123;moment(\n                expireTime,\n              ).format(&#39;YYYY-MM-DD HH:mm:ss&#39;)&#125;è¿‡æœŸ&#96;\n              return (\n                &lt;HookForm.Item name&#x3D;&quot;url&quot; label&#x3D;&quot;&quot;&gt;\n                  &lt;Input\n                    className&#x3D;&#123;styles[&#39;share-copy&#39;]&#125;\n                    addonAfter&#x3D;&#123;&lt;Copy text&#x3D;&#123;text&#125;&gt;å¤åˆ¶é“¾æ¥å’Œå¯†ç &lt;&#x2F;Copy&gt;&#125;\n                    disabled\n                  &#x2F;&gt;\n                &lt;&#x2F;HookForm.Item&gt;\n              )\n            &#125;&#125;\n          &lt;&#x2F;HookForm.Item&gt;\n        &lt;&#x2F;HookForm&gt;\n      &lt;&#x2F;ConditionComponent&gt;\n    &lt;&#x2F;Modal&gt;\n  )\n&#125;\n\nexport default ShareModal\n\n\nç”¨æˆ·åé¦ˆä¸ºä»€ä¹ˆåˆ†äº«çš„é“¾æ¥ä¸è¦åˆ†äº«çš„é“¾æ¥å¯¹ä¸ä¸Šï¼Ÿ\nuseCallbackuseCallbackå—ä¾èµ–é¡¹çš„å½±å“ï¼Œä¸æ›´æ–°ï¼Œä¹‹å‰æ”¹è¿‡åŒäº‹çš„ä»£ç ï¼Œè¿™æ¬¡æ‰«äº†ä¸€æ ·ï¼Œæ²¡æœ‰callbackï¼Œå°±è¿™é—®é¢˜ä¿®æ”¹å‡ ä¸ªäº†\nuseState\næ‰¾äº†ä¸‹æ•°æ®ShareModalç»„ä»¶,çœ‹åˆ°ä¸¤ä¸ªå…¥å‚state, setState ï¼Œæˆ‘è‰¹\nç»§ç»­å¾€ä¸Šå±‚æ‰¾&lt;ShareModal\n  entityType&#x3D;&#123;entityType&#125;\n  entityCode&#x3D;&#123;entityCode&#125;\n  &#123;...modalProps&#125;\n  state&#x3D;&#123;state&#125; &#x2F;&#x2F; ğŸ˜“\n  setState&#x3D;&#123;setState&#125; &#x2F;&#x2F;ğŸ˜“ \n&#x2F;&gt;\nå†å¾€ä¸Šæ‰¾ï¼ŒuseState å†…éƒ¨åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ•°æ®åˆå§‹åŒ–å®Œæˆä¸å†æ”¹å˜\n\n\nconst [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;\n  value: props.value,\n  title: props.title,\n  shareId: props.shareId,\n  mappingPassword: props.mappingPassword,\n  passwordEnable: props.passwordEnable,\n  mappingState: props.mappingState,\n  expireTime: props.expireTime,\n  shortCode: props.shortCode,\n&#125;)\n\n\nconst &#123; value &#125; &#x3D; state\n\n\nè¿™é‡Œä»£ç è¿™ä¹ˆå†™ï¼Œå…¶ä»–åœ°æ–¹è‚¯å®šä¹Ÿæœ‰è¿™æ ·çš„å†™æ³•ï¼ŒğŸ˜“\n\næ”¹ä¸€ä¸‹const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;&#125;)\n\n\nuseEffect(() &#x3D;&gt; &#123;\n  setState(&#123; ...props &#125;)\n&#125;, [props.shareId])\n","slug":"2022-05-31bug","date":"2022-05-31T02:30:47.000Z","categories_index":"bug","tags_index":"bug,react","author_index":"é™ˆæµ·é¾™"},{"id":"fa552d7ce8179aea4ff549bb83386b93","title":"ç¼–ç¨‹èŒƒå¼-å‡½æ•°å¼ç¼–ç¨‹ç®€å•äº†è§£","content":"èƒŒæ™¯js ä¸ºäº†å®ç°é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œåšäº†å¾ˆå¤šäº‹æƒ…ï¼Œå¯¼è‡´å¤§å®¶åœ¨å­¦ä¹  js çš„æ—¶å€™ï¼Œä¼šé‡åˆ°å¤æ‚çš„åŸå‹ã€åŸå‹é“¾ã€ç»§æ‰¿ï¼Œè¿˜æœ‰å¯¹äººä¸å‹å¥½çš„ this ï¼›è€Œå½“æˆ‘ä»¬ç”¨è¿™äº›ä¸œè¥¿ç»„åˆèµ·æ¥æ¨¡æ‹Ÿé¢å‘å¯¹è±¡çš„ç‰¹æ€§çš„æ—¶å€™ï¼Œå°±æ›´åŠ ç—›è‹¦äº†ã€‚ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç§æ›´å‹å¥½çš„æ–¹å¼ï¼Œå‡½æ•°å¼ç¼–ç¨‹ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šé¢å‘å¯¹è±¡çš„æ€æƒ³åœ¨jsä¸­ä¸æ˜¯å¾ˆå¥½ç”¨\nä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹å‡½æ•°å¼ç¼–ç¨‹ï¼ˆfunctional programingï¼‰æ˜¯ç¼–ç¨‹èŒƒå¼ä¹‹ä¸€ã€‚æˆ‘ä»¬å¸¸è§çš„èŒƒå¼è¿˜æœ‰é¢å‘è¿‡ç¨‹ã€é¢å‘è¡Œä¸ºã€é¢å‘å¯¹è±¡ç­‰ã€‚\nèŒƒå¼ï¼šæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ç§æ€ç»´æ¨¡å¼åŠ ä¸Šå®ƒçš„å®ç°æ–¹æ³•ï¼Œç®€å•è¯´å°±æ˜¯ç¼–ç¨‹çš„æ–¹æ³•è®ºã€‚\n\né¢å‘è¿‡ç¨‹ç¼–ç¨‹ï¼šç®€å•è§£é‡Šå°±æ˜¯æŒ‰ç…§æ­¥éª¤æ¥å®ç°ã€‚\n\né¢å‘è¡Œä¸ºç¼–ç¨‹ï¼šå®ƒæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„è¡ç”ŸèŒƒå‹ï¼Œå°†ç”µè„‘è¿ç®—å¹³å±•ä¸ºä¸€ç³»åˆ—çš„å˜åŒ–ï¼Œå¹¶ä¸”é¿å…ä½¿ç”¨ç¨‹åºæŒ‡ä»¤ä»¥åŠå †å çš„å¯¹è±¡ã€‚\n\né¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå®ƒçš„æ€ç»´æ–¹å¼æ˜¯æŠŠç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©æŠ½è±¡æˆç¨‹åºä¸–ç•Œä¸­çš„ç±»å’Œå¯¹è±¡ï¼Œç„¶åé€šè¿‡å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€æ¥æ¼”ç¤ºäº‹ç‰©ä¹‹é—´çš„è”ç³»ã€‚\n\né¢å‘å‡½æ•°å¼ç¼–ç¨‹ï¼šå®ƒçš„æ€ç»´æ–¹å¼æ˜¯æŠŠç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©å’Œäº‹ç‰©ä¹‹é—´çš„è”ç³»ï¼ŒæŠ½è±¡åˆ°ç¨‹åºä¸–ç•Œä¸­ã€‚\n\n\nå‡½æ•°å¼ç¼–ç¨‹ç‰¹ç‚¹ï¼š\nç¨‹åºçš„æœ¬è´¨ï¼šå°±æ˜¯åˆ©ç”¨è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›å°†è¾“å…¥è½¬åŒ–æˆå¯¹åº”çš„è¾“å‡ºã€‚\n\nå‡½æ•°å¼ç¼–ç¨‹ä¸­çš„å‡½æ•°æŒ‡çš„ä¸æ˜¯ç¼–ç¨‹è¯­è¨€é‡Œçš„å‡½æ•°ï¼Œè€Œæ˜¯æ•°å­¦æ„ä¹‰ä¸Šçš„æ˜ å°„å…³ç³»ã€‚æ¯”å¦‚ y&#x3D;sin(x) ä¸­ x å’Œ y å€¼çš„æ˜ å°„å…³ç³»ã€‚\n\nçº¯å‡½æ•°ï¼šç›¸åŒçš„è¾“å…¥è·å¾—ç›¸åŒçš„è¾“å‡ºï¼ˆæ— å‰¯ä½œç”¨ï¼‰ã€‚\n\nå‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯å¯¹æ•°æ®(å‡½æ•°)æ˜ å°„å…³ç³»çš„æŠ½è±¡ã€‚\n\n\nä½¿ç”¨åœºæ™¯\né«˜é˜¶å‡½æ•°\né—­åŒ…\nçº¯å‡½æ•°\næŸ¯é‡ŒåŒ–\nç»„åˆå‡½æ•°\n\nå‚è€ƒ\n","slug":"2022-05-28func","date":"2022-05-28T07:25:33.000Z","categories_index":"ç†è®º","tags_index":"ç†è®º","author_index":"é™ˆæµ·é¾™"},{"id":"2e69f09f2b5424b80304135ea166c436","title":"wiki Laser Pen","content":"Laser PenLaser Pen æ˜¯ä¸€å¥—ç”¨æ¥åœ¨ web canvas ä¸Šç»˜åˆ¶é¼ æ ‡è½¨è¿¹çš„å·¥å…·é›†ã€‚\nä½¿ç”¨åœºæ™¯wikiå…¨å±æ¼”ç¤ºæ—¶å€™ï¼Œä¸ºäº†ä¾¿äºå¬ä¼—è·Ÿéšæ¼”è®²è€…è¿›åº¦ï¼Œç»™é¼ æ ‡è½¨è¿¹åŠ ä¸Šæ ‡è®°ã€‚\n\næ³¨ï¼šå…¬å¸é¡¹ç›®ç”±äºç‰ˆæƒé—®é¢˜ï¼Œä¸ä¾¿æ¼”ç¤º\nåˆæ­¥ä¸Šæ‰‹é¦–å…ˆåœ¨ä½ çš„é¡¹ç›®ä¸­æ·»åŠ å¯¹ Laser Pen çš„ä¾èµ–ï¼š\nyarn add laser-pen\næˆ–è€…\nnpm i laser-pen\n\nç„¶åç›‘å¬é¼ æ ‡çš„ move äº‹ä»¶ï¼Œè·å–é¼ æ ‡ç§»åŠ¨è½¨è¿¹çš„åæ ‡ï¼Œå¹¶åŒæ—¶è®°å½• move äº‹ä»¶è§¦å‘æ—¶çš„æ—¶é—´æˆ³ã€‚\n&#x2F;&#x2F; è·å– canvas å…ƒç´ çš„åæ ‡\nconst canvasDom &#x3D; document.querySelector(&#39;canvas&#39;)\nconst canvasPos &#x3D; canvasDom.getBoundingClientRect()\nconst ctx &#x3D; canvas.getContext(&#39;2d&#39;)\n&#x2F;&#x2F; ç”¨æ¥å­˜å‚¨æ‰€æœ‰é¼ æ ‡è½¨è¿¹æ•°æ®\nlet mouseTrack &#x3D; []\n&#x2F;&#x2F; ç›‘å¬é¼ æ ‡äº‹ä»¶\ndocument.addEventListener(&#39;mousemove&#39;, (event) &#x3D;&gt; &#123;\n  mouseTrack.push(&#123;\n    x: event.clientX - canvasPos.x,\n    y: event.clientY - canvasPos.y,\n    time: Date.now(),\n  &#125;)\n&#125;)\n\næœ€ååœ¨è°ƒç”¨ drawLaserPen æ–¹æ³•ç»˜åˆ¶é¼ æ ‡è½¨è¿¹\nimport &#123; drainPoints, drawLaserPen &#125; from &#39;laser-pen&#39;\n\nfunction draw() &#123;\n  &#x2F;&#x2F; è¿‡æ»¤æ‰ä¸€äº›å¤±æ•ˆçš„è½¨è¿¹åæ ‡\n  mouseTrack &#x3D; drainPoints(mouseTrack)\n  if (mouseTrack.length &gt;&#x3D; 3) &#123;\n    &#x2F;&#x2F; ç»˜åˆ¶é¼ æ ‡è½¨è¿¹\n    drawLaserPen(ctx, mouseTrack)\n  &#125;\n  requestAnimation(draw)\n&#125;\n\n\nåˆ°è¿™é‡Œï¼Œä½ åº”è¯¥å·²ç»å¯ä»¥åœ¨ canvas ä¸Šå®ç°é¼ æ ‡è½¨è¿¹çš„ç»˜åˆ¶äº†ã€‚\nå‚æ•°é…ç½®å¦‚æœé»˜è®¤çš„è½¨è¿¹æ•ˆæœä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼ŒLaser Pen è¿˜æä¾›äº†ä¸€äº›æ¥å£è®©ä½ å¯ä»¥æ–¹ä¾¿çš„ä¿®æ”¹é¼ æ ‡è½¨è¿¹çš„æ ·å¼ã€‚\n&#x2F;&#x2F; è®¾ç½®å»¶è¿Ÿæ—¶é—´ï¼Œmousemove äº‹ä»¶äº§ç”Ÿçš„åæ ‡ç‚¹åœ¨è¶…è¿‡å»¶è¿Ÿæ—¶é—´åå°±ä¸ä¼šè¢«ç»˜åˆ¶ï¼Œä¼šç›´æ¥å½±å“è½¨è¿¹çš„é•¿åº¦\nsetDelay: (millisecond: number) &#x3D;&gt; void;\n&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„æœ€å¤§å®½åº¦ï¼Œè½¨è¿¹æ˜¯ä¸€æ¡ç”±ç²—å˜ç»†çš„æ›²çº¿ï¼ŒmaxWidth è¡¨ç¤ºç²—çš„é‚£ä¸€å¤´çš„çº¿å®½\nsetMaxWidth: (width: number) &#x3D;&gt; void;\n&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„æœ€å°å®½åº¦ï¼Œè½¨è¿¹æ˜¯ä¸€æ¡ç”±ç²—å˜ç»†çš„æ›²çº¿ï¼ŒminWidth è¡¨ç¤ºç»†çš„é‚£ä¸€å¤´çš„çº¿å®½\nsetMinWidth: (width: number) &#x3D;&gt; void;\n&#x2F;&#x2F; è®¾ç½®æ›²çº¿å¼ åŠ›å¤§å°ï¼Œå¼ åŠ›è¶Šå¤§æ‹ç‚¹å¤„è¶Šå¹³æ»‘ï¼Œåä¹‹è¶Šå°–é”\nsetTension: (t: number) &#x3D;&gt; void;\n&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„æœ€å°é€æ˜åº¦ï¼Œè½¨è¿¹æ˜¯ä¸€æ¡ç”±ä¸é€æ˜å˜é€æ˜çš„æ›²çº¿ï¼Œopacity è¡¨ç¤ºè½¨è¿¹æœ«å°¾çš„ä¸é€æ˜åº¦\nsetOpacity: (o: number) &#x3D;&gt; void;\n&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„é¢œè‰²\nsetColor: (r: number, g: number, b: number) &#x3D;&gt; void;\n&#x2F;&#x2F; è®¾ç½®è½¨è¿¹å¤´éƒ¨æ˜¯å¦æ˜¯åœ†å½¢\nsetRoundCap: (b: boolean) &#x3D;&gt; void;\n\nåœ¨ä»»ä½•æ—¶å€™è°ƒç”¨ä¸Šè¿°æ¥å£ä¿®æ”¹é¼ æ ‡è½¨è¿¹çš„æ ·å¼ï¼Œéƒ½ä¼šåœ¨ç´§æ¥ç€çš„ä¸‹ä¸€æ¬¡ç»˜åˆ¶ä¸­ç”Ÿæ•ˆã€‚æ‰€ä»¥å¦‚æœä½ æƒ³å®ç°ä¸€ä¸ªç±»ä¼¼ RGB è·‘é©¬ç¯çš„é¼ æ ‡è½¨è¿¹ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\nå®šåˆ¶åŒ–å¼€å‘å¦‚æœä¸Šé¢çš„æ¥å£éƒ½ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦åšä¸€äº›å®šåˆ¶åŒ–çš„å¼€å‘äº†ã€‚\nç»˜åˆ¶é¼ æ ‡è½¨è¿¹çš„è¿‡ç¨‹å¤§æ¦‚åˆ†ä¸º 5 ä¸ªæ­¥éª¤ï¼š\næ¸…æ´—è½¨è¿¹åæ ‡æ•°æ®æ ¹æ®è½¨è¿¹åæ ‡è®¡ç®—æ¯ä¸ªåæ ‡çš„æ§åˆ¶ç‚¹é€šè¿‡åæ ‡ç‚¹å’Œæ§åˆ¶ç‚¹æ•°æ®ç”Ÿæˆ Bezier æ›²çº¿å°†ä¸Šä¸€æ­¥ç”Ÿæˆçš„æ›²çº¿åˆ†å‰²ä¸ºæ›´çŸ­çš„ Bezier æ›²çº¿ï¼Œå¹¶è®¡ç®—æ¯æ¡æ›²çº¿çš„ç»˜åˆ¶æ ·å¼ä¾æ¬¡ç»˜åˆ¶æ¯æ¡ Bezier æ›²çº¿è¿™ 5 ä¸ªæ­¥éª¤å¯¹åº”ä¸‹é¢çš„ç¬¬ 1 åˆ°ç¬¬ 5 ä¸ªæ¥å£ï¼Œæœ€åçš„ drawLaserPen æ¥å£æ˜¯å¯¹å‰é¢ 5 ä¸ªæ¥å£çš„ç»„åˆã€‚ å¦‚æœç›´æ¥è°ƒç”¨ drawLaserPen ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œä½ å¯ä»¥åœ¨å‰ 5 ä¸ªæ¥å£çš„åŸºç¡€ä¸Šè‡ªè¡Œç»„åˆï¼Œå®ç°ä½ æƒ³è¦çš„æ•ˆæœã€‚\n&#x2F;&#x2F; å»æ‰åŸå§‹é¼ æ ‡åæ ‡æ•°æ®ä¸­ä¸åˆç†çš„æ•°æ®ï¼ŒåŒ…æ‹¬è¶…è¿‡å»¶è¿Ÿæ—¶é—´çš„åæ ‡ï¼Œå’Œä¸€äº›æ’åˆ—ä¸åˆæ³•çš„åæ ‡\ndrainPoints: (originalPoints: IOriginalPointData[]) &#x3D;&gt; IOriginalPointData[];\n&#x2F;&#x2F; æ ¹æ®é¼ æ ‡åæ ‡æ•°æ®è®¡ç®—æ¯ä¸ªåæ ‡ç‚¹çš„å‰åæ§åˆ¶ç‚¹\ncalControlPoints: (points: IPoint[]) &#x3D;&gt; IControlPoint[];\n&#x2F;&#x2F; å°†é¼ æ ‡åæ ‡æ•°æ®å’Œæ§åˆ¶ç‚¹æ•°æ®ç»„åˆä¸ºè´å¡å°”æ›²çº¿\ntransformPointToBezier: (\n  points: IPoint[],\n  controlPoints: IControlPoint[]\n) &#x3D;&gt; Bezier[];\n&#x2F;&#x2F; æ ¹æ®åŸå§‹çš„è´å¡å°”æ›²çº¿æ•°æ®ï¼Œè®¡ç®—å‡ºç”¨äºç»˜åˆ¶çš„æ•°æ®ç»“æ„\ncalDrawingData: (\n  bzArray: Bezier[],\n  totalLength: number\n) &#x3D;&gt; IDrawingBezierData[];\n&#x2F;&#x2F; æ ¹æ®è®¡ç®—å‡ºçš„ç»˜åˆ¶æ•°æ®ï¼Œå°†æ›²çº¿ç»˜åˆ¶åˆ°ç”»å¸ƒä¸Š\ndrawDrawingBezierData: (\n  ctx: CanvasRenderingContext2D,\n  data: IDrawingBezierData[]\n) &#x3D;&gt; void;\n&#x2F;&#x2F; ä¸€ä¸ªæ–¹ä¾¿ç®€å•ä½¿ç”¨çš„å…¥å£æ–¹æ³•ï¼Œç›´æ¥é€šè¿‡å¤„ç†å¥½çš„é¼ æ ‡åæ ‡æ•°æ®ï¼Œç»˜åˆ¶é¼ æ ‡è½¨è¿¹\ndrawLaserPen: (ctx: CanvasRenderingContext2D, points: IPoint[]) &#x3D;&gt; void;\n\nå…¶ä»–\nlaser-pen\nçªç„¶æœ‰ä¸ªæƒ³æ³•ï¼šç‹è€…è£è€€çš„æ‹–å°¾æ•ˆæœå®ç°åŸç†ï¼Œæ˜¯ä¸æ˜¯å’Œè¿™ä¸ªç±»ä¼¼ï¼Ÿ\n\n","slug":"2022-05-27wiki-laserPen","date":"2022-05-27T08:07:33.000Z","categories_index":"wiki","tags_index":"wiki","author_index":"é™ˆæµ·é¾™"},{"id":"8b8288a2a8637d5beee93bb6d37a8ba8","title":"redux-loggeræºç ","content":"redux æ—¥å¿—ä¸­é—´ä»¶.\nâ”œâ”€â”€ core.js\nâ”œâ”€â”€ defaults.js\nâ”œâ”€â”€ diff.js\nâ”œâ”€â”€ helpers.js &#x2F;&#x2F; ä¸€äº›å¸®åŠ©å‡½æ•°\nâ””â”€â”€ index.js\n\n0 directories, 5 files\ndefaultLoggerv3 ç‰ˆæœ¬ï¼Œç ´åæ€§å˜æ›´\nä¹‹å‰\nimport createLogger from &quot;redux-logger&quot;;\n\nä¹‹å\nimport &#123; createLogger &#125; from &quot;redux-logger&quot;;\n\næºç \n&#x2F;&#x2F; src&#x2F;index.js\n\nconst defaultLogger &#x3D; (&#123; dispatch, getState &#125; &#x3D; &#123;&#125;) &#x3D;&gt; &#123;\n  if (typeof dispatch &#x3D;&#x3D;&#x3D; &quot;function&quot; || typeof getState &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;\n    &#x2F;&#x2F; createLoggerï¼ŒæŸ¯é‡ŒåŒ– å·¥å‚æ¨¡å¼\n    return createLogger()(&#123; dispatch, getState &#125;);\n  &#125;\n  &#x2F;&#x2F; å¦‚æœæ²¡æœ‰ä¼ é€’dispatchå’ŒgetStateï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯\n  &#x2F;&#x2F; v3ç‰ˆæœ¬ï¼Œç ´åæ€§å˜æ›´, æ ¹æ®ã€Šè¯­ä¹‰åŒ–ç‰ˆæœ¬ã€‹ä¸çœ‹å†…å®¹ä¹ŸçŸ¥é“æœ‰ç ´åæ€§å˜æ›´\n  &#x2F;&#x2F; Since 3.0.0 redux-logger exports by default logger with default settings\n  &#x2F;&#x2F; import createLogger from &#39;redux-logger&#39; &#x3D;&gt; import &#123; createLogger &#125; from &#39;redux-logger&#39;\n  console.error(&#96;\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from &#39;redux-logger&#39;\n[redux-logger v3] to\n[redux-logger v3] import &#123; createLogger &#125; from &#39;redux-logger&#39;\n&#96;);\n&#125;;\n\nexport &#123; defaults, createLogger, defaultLogger as logger &#125;;\n\nexport default defaultLogger;\n\ncreateLogger\nä½¿ç”¨ä¼ å…¥çš„ optionsï¼Œ åˆ›å»ºæ—¥å¿—è®°å½•å™¨\n\n&#x2F;**\n * Creates logger with following options\n * åˆ›å»ºæ—¥å¿—è®°å½•å™¨ï¼Œé…ç½®å¦‚ä¸‹ï¼š\n * @namespace\n * @param &#123;object&#125; options - options for logger\n * @param &#123;string | function | object&#125; options.level - console[level] æ—¥å¿—çº§åˆ«\n * @param &#123;boolean&#125; options.duration - print duration of each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´\n * @param &#123;boolean&#125; options.timestamp - print timestamp with each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´æˆ³\n * @param &#123;object&#125; options.colors - custom colors å®šåˆ¶é¢œè‰²\n * @param &#123;object&#125; options.logger - implementation of the &#96;console&#96; API æ‰“å°æ—¥å¿—çš„å®ç°\n * @param &#123;boolean&#125; options.logErrors - should errors in action execution be caught, logged, and re-thrown? æ˜¯å¦æ•è·actionæ‰§è¡Œé”™è¯¯ï¼Œæ‰“å°é”™è¯¯ï¼Œå¹¶é‡æ–°æŠ›å‡º\n * @param &#123;boolean&#125; options.collapsed - is group collapsed? æ˜¯å¦æŠ˜å ç»„\n * @param &#123;boolean&#125; options.predicate - condition which resolves logger behavior æ¡ä»¶ï¼Œå†³å®šæ—¥å¿—è®°å½•å™¨è¡Œä¸º\n * @param &#123;function&#125; options.stateTransformer - transform state before print æ‰“å°å‰çš„çŠ¶æ€è½¬æ¢\n * @param &#123;function&#125; options.actionTransformer - transform action before print æ‰“å°å‰çš„actionè½¬æ¢\n * @param &#123;function&#125; options.errorTransformer - transform error before print  æ‰“å°å‰çš„é”™è¯¯è½¬æ¢\n *\n * @returns &#123;function&#125; logger middleware è¿”å›ä¸­é—´ä»¶\n *&#x2F;\nfunction createLogger(options &#x3D; &#123;&#125;) &#123;\n  const loggerOptions &#x3D; Object.assign(&#123;&#125;, defaults, options);\n\n  const &#123;\n    logger,\n    stateTransformer,\n    errorTransformer,\n    predicate,\n    logErrors,\n    diffPredicate,\n  &#125; &#x3D; loggerOptions;\n\n  &#x2F;&#x2F; Return if &#39;console&#39; object is not defined\n  &#x2F;&#x2F; å¦‚æœ&#39;console&#39;å¯¹è±¡æœªå®šä¹‰ï¼Œè¿”å›\n  if (typeof logger &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) &#123;\n    return () &#x3D;&gt; (next) &#x3D;&gt; (action) &#x3D;&gt; next(action);\n  &#125;\n\n  &#x2F;&#x2F; Detect if &#39;createLogger&#39; was passed directly to &#39;applyMiddleware&#39;.\n  &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦ä¼ é€’ç»™applyMiddleware\n  if (options.getState &amp;&amp; options.dispatch) &#123;\n    &#x2F;&#x2F; eslint-disable-next-line no-console\n    console.error(&#96;[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n&#x2F;&#x2F; Logger with default options\nimport &#123; logger &#125; from &#39;redux-logger&#39;\nconst store &#x3D; createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n&#x2F;&#x2F; Or you can create your own logger with custom options http:&#x2F;&#x2F;bit.ly&#x2F;redux-logger-options\nimport &#123; createLogger &#125; from &#39;redux-logger&#39;\nconst logger &#x3D; createLogger(&#123;\n  &#x2F;&#x2F; ...options\n&#125;);\nconst store &#x3D; createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n&#96;);\n    &#x2F;&#x2F; ä¸­é—´ä»¶ä¹¦å†™å¥—è·¯\n    return () &#x3D;&gt; (next) &#x3D;&gt; (action) &#x3D;&gt; next(action);\n  &#125;\n\n  const logBuffer &#x3D; [];\n\n  return (&#123; getState &#125;) &#x3D;&gt;\n    (next) &#x3D;&gt;\n    (action) &#x3D;&gt; &#123;\n      &#x2F;&#x2F; Exit early if predicate function returns &#39;false&#39; å¦‚æœpredicateå‡½æ•°è¿”å›falseï¼Œé€€å‡º\n      if (typeof predicate &#x3D;&#x3D;&#x3D; &quot;function&quot; &amp;&amp; !predicate(getState, action)) &#123;\n        return next(action);\n      &#125;\n\n      const logEntry &#x3D; &#123;&#125;;\n\n      logBuffer.push(logEntry);\n\n      logEntry.started &#x3D; timer.now();\n      logEntry.startedTime &#x3D; new Date();\n      logEntry.prevState &#x3D; stateTransformer(getState());\n      logEntry.action &#x3D; action;\n\n      let returnedValue;\n      if (logErrors) &#123;\n        try &#123;\n          returnedValue &#x3D; next(action);\n        &#125; catch (e) &#123;\n          logEntry.error &#x3D; errorTransformer(e);\n        &#125;\n      &#125; else &#123;\n        returnedValue &#x3D; next(action);\n      &#125;\n\n      logEntry.took &#x3D; timer.now() - logEntry.started;\n      logEntry.nextState &#x3D; stateTransformer(getState());\n\n      const diff &#x3D;\n        loggerOptions.diff &amp;&amp; typeof diffPredicate &#x3D;&#x3D;&#x3D; &quot;function&quot;\n          ? diffPredicate(getState, action)\n          : loggerOptions.diff;\n\n      printBuffer(logBuffer, Object.assign(&#123;&#125;, loggerOptions, &#123; diff &#125;));\n      logBuffer.length &#x3D; 0;\n\n      if (logEntry.error) throw logEntry.error;\n      return returnedValue;\n    &#125;;\n&#125;\n\ndefaults é»˜è®¤é…ç½®\n&#x2F;&#x2F; src&#x2F;default.js\nexport default &#123;\n  level: &quot;log&quot;,\n  logger: console,\n  logErrors: true,\n  collapsed: undefined,\n  predicate: undefined,\n  duration: false,\n  timestamp: true,\n  stateTransformer: (state) &#x3D;&gt; state,\n  actionTransformer: (action) &#x3D;&gt; action,\n  errorTransformer: (error) &#x3D;&gt; error,\n  colors: &#123;\n    title: () &#x3D;&gt; &quot;inherit&quot;,\n    prevState: () &#x3D;&gt; &quot;#9E9E9E&quot;,\n    action: () &#x3D;&gt; &quot;#03A9F4&quot;,\n    nextState: () &#x3D;&gt; &quot;#4CAF50&quot;,\n    error: () &#x3D;&gt; &quot;#F20404&quot;,\n  &#125;,\n  diff: false,\n  diffPredicate: undefined,\n\n  &#x2F;&#x2F; Deprecated options å·²åºŸå¼ƒé…ç½®\n  transformer: undefined,\n&#125;;\n&#x2F;&#x2F; å­—æ®µé‡Šä¹‰\n&#x2F;**\n * Creates logger with following options\n * åˆ›å»ºæ—¥å¿—è®°å½•å™¨ï¼Œé…ç½®å¦‚ä¸‹ï¼š\n * @namespace\n * @param &#123;object&#125; options - options for logger\n * @param &#123;string | function | object&#125; options.level - console[level] æ—¥å¿—çº§åˆ«\n * @param &#123;boolean&#125; options.duration - print duration of each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´\n * @param &#123;boolean&#125; options.timestamp - print timestamp with each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´æˆ³\n * @param &#123;object&#125; options.colors - custom colors å®šåˆ¶é¢œè‰²\n * @param &#123;object&#125; options.logger - implementation of the &#96;console&#96; API æ‰“å°æ—¥å¿—çš„å®ç°\n * @param &#123;boolean&#125; options.logErrors - should errors in action execution be caught, logged, and re-thrown? æ˜¯å¦æ•è·actionæ‰§è¡Œé”™è¯¯ï¼Œæ‰“å°é”™è¯¯ï¼Œå¹¶é‡æ–°æŠ›å‡º\n * @param &#123;boolean&#125; options.collapsed - is group collapsed? æ˜¯å¦æŠ˜å ç»„\n * @param &#123;boolean&#125; options.predicate - condition which resolves logger behavior æ¡ä»¶ï¼Œå†³å®šæ—¥å¿—è®°å½•å™¨è¡Œä¸º\n * @param &#123;function&#125; options.stateTransformer - transform state before print æ‰“å°å‰çš„çŠ¶æ€è½¬æ¢\n * @param &#123;function&#125; options.actionTransformer - transform action before print æ‰“å°å‰çš„actionè½¬æ¢\n * @param &#123;function&#125; options.errorTransformer - transform error before print  æ‰“å°å‰çš„é”™è¯¯è½¬æ¢\n *\n * @returns &#123;function&#125; logger middleware è¿”å›ä¸­é—´ä»¶\n *&#x2F;\n\nå¥‡æ€ª\n\nè¿™ä¸¤ä¸ªé…ç½®åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ï¼Œæ²¡æ‰¾åˆ°ç›¸å…³æµ‹è¯•ä»£ç \n\n &#x2F;&#x2F; é…ç½®\n diff: false, &#x2F;&#x2F;\n diffPredicate: undefined,\n\n &#x2F;&#x2F; ...\n\n const diff &#x3D;\n       loggerOptions.diff &amp;&amp; typeof diffPredicate &#x3D;&#x3D;&#x3D; &quot;function&quot;\n         ? diffPredicate(getState, action)\n         : loggerOptions.diff;\n &#x2F;&#x2F; æ‰“å°æ—¥å¿—ä¸­\n printBuffer(logBuffer, Object.assign(&#123;&#125;, loggerOptions, &#123; diff &#125;));\n\n &#x2F;&#x2F; src&#x2F;core.js printBufferçš„å®šä¹‰\nfunction printBuffer(buffer, options) &#123;\n   const &#123;\n     &#x2F;&#x2F; ...\n       diff,\n   &#125; &#x3D; options;\n   &#x2F;&#x2F; å¦‚æœå¼€å¯\n   if (diff) &#123;\n     &#x2F;&#x2F; æ‰§è¡Œäº† diffLogger\n     diffLogger(prevState, nextState, logger, isCollapsed);\n   &#125;\n&#125;\n&#x2F;&#x2F; src&#x2F;diff.js\nexport default function diffLogger(prevState, newState, logger, isCollapsed) &#123;\n  &#x2F;&#x2F; import differ from &#39;deep-diff&#39;;è®¡ç®—å¯¹è±¡å·®å¼‚åŒ–çš„åŒ…\n  const diff &#x3D; differ(prevState, newState);\n\n  try &#123;\n    if (isCollapsed) &#123;\n      logger.groupCollapsed(&#39;diff&#39;);\n    &#125; else &#123;\n      logger.group(&#39;diff&#39;);\n    &#125;\n  &#125; catch (e) &#123;\n    logger.log(&#39;diff&#39;);\n  &#125;\n  &#x2F;&#x2F; æœ‰å·®å¼‚æ‰§è¡Œè¾“å‡ºï¼Œè¿™ä¸ªå·®å¼‚åŒ…å«ç±»å‹kind E:ç¼–è¾‘ N:æ–°å¢ D:åˆ é™¤ A:æ•°ç»„\n  &#x2F;&#x2F; dictionaryä¸ºå¯¹è±¡ï¼Œå¯¹kindå€¼è¿›è¡Œæšä¸¾\n  &#x2F;&#x2F; éå†è¾“å‡º\n  if (diff) &#123;\n    diff.forEach((elem) &#x3D;&gt; &#123;\n      const &#123; kind &#125; &#x3D; elem;\n      const output &#x3D; render(elem);\n\n      logger.log(&#96;%c $&#123;dictionary[kind].text&#125;&#96;, style(kind), ...output);\n    &#125;);\n  &#125; else &#123;\n    logger.log(&#39;â€”â€” no diff â€”â€”&#39;);\n  &#125;\n\n  try &#123;\n    logger.groupEnd();\n  &#125; catch (e) &#123;\n    logger.log(&#39;â€”â€” diff end â€”â€” &#39;);\n  &#125;\n&#125;\n\n\nhelpers&#x2F;&#x2F; repeat + pad &#x3D; padLeft å·¦ä¾§è¡¥é›¶ï¼Œ eså¤šå°‘æœ‰ä¸ªapi\nexport const repeat &#x3D; (str, times) &#x3D;&gt; (new Array(times + 1)).join(str);\n\nexport const pad &#x3D; (num, maxLength) &#x3D;&gt; repeat(&#39;0&#39;, maxLength - num.toString().length) + num;\n&#x2F;&#x2F; æ—¶é—´æ ¼å¼åŒ–\nexport const formatTime &#x3D; time &#x3D;&gt; &#96;$&#123;pad(time.getHours(), 2)&#125;:$&#123;pad(time.getMinutes(), 2)&#125;:$&#123;pad(time.getSeconds(), 2)&#125;.$&#123;pad(time.getMilliseconds(), 3)&#125;&#96;;\n\n&#x2F;&#x2F; Use performance API if it&#39;s available in order to get better precision\nexport const timer &#x3D;\n(typeof performance !&#x3D;&#x3D; &#39;undefined&#39; &amp;&amp; performance !&#x3D;&#x3D; null) &amp;&amp; typeof performance.now &#x3D;&#x3D;&#x3D; &#39;function&#39; ?\n  performance :\n  Date;\nè¿è¡Œæµ‹è¯•ä¸‹\nconst repeat &#x3D; (str, times) &#x3D;&gt; (new Array(times + 1)).join(str);\n\nconst pad &#x3D; (num, maxLength) &#x3D;&gt; repeat(&#39;0&#39;, maxLength - num.toString().length) + num;\n\nconst formatTime &#x3D; time &#x3D;&gt; &#96;$&#123;pad(time.getHours(), 2)&#125;:$&#123;pad(time.getMinutes(), 2)&#125;:$&#123;pad(time.getSeconds(), 2)&#125;.$&#123;pad(time.getMilliseconds(), 3)&#125;&#96;;\n\nconsole.log(formatTime(new Date()))\n&#x2F;&#x2F; è¾“å‡º\n18:58:15.667\n\n\næºç å›¾\ndeep-diff\nçœ‹ä¸‹ä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒçš„äº‹ä¾‹\n\nvar lhs &#x3D; &#123;\n\tname: &#39;my object&#39;,\n\tdescription: &#39;it\\&#39;s an object!&#39;,\n\tdetails: &#123;\n\t\tit: &#39;has&#39;,\n\t\tan: &#39;array&#39;,\n\t\twith: [&#39;a&#39;, &#39;few&#39;, &#39;elements&#39;]\n\t&#125;\n&#125;;\n\nvar rhs &#x3D; &#123;\n\tname: &#39;updated object&#39;,\n\tdescription: &#39;it\\&#39;s an object!&#39;,\n\tdetails: &#123;\n\t\tit: &#39;has&#39;,\n\t\tan: &#39;array&#39;,\n\t\twith: [&#39;a&#39;, &#39;few&#39;, &#39;more&#39;, &#39;elements&#39;, &#123; than: &#39;before&#39; &#125;]\n\t&#125;\n&#125;;\n\nvar differences &#x3D; deep.diff(lhs, rhs);\n\n\n&#x2F;&#x2F; è¾“å‡º\n\n\n27 May 17:27:12 - [\n  DiffEdit &#123;\n    kind: &#39;E&#39;,\n    path: [ &#39;name&#39; ],\n    lhs: &#39;my object&#39;,\n    rhs: &#39;updated object&#39;\n  &#125;,\n  DiffArray &#123;\n    kind: &#39;A&#39;,\n    path: [ &#39;details&#39;, &#39;with&#39; ],\n    index: 4,\n    item: DiffNew &#123; kind: &#39;N&#39;, rhs: &#123; than: &#39;before&#39; &#125; &#125;\n  &#125;,\n  DiffArray &#123;\n    kind: &#39;A&#39;,\n    path: [ &#39;details&#39;, &#39;with&#39; ],\n    index: 3,\n    item: DiffNew &#123; kind: &#39;N&#39;, rhs: &#39;elements&#39; &#125;\n  &#125;,\n  DiffEdit &#123;\n    kind: &#39;E&#39;,\n    path: [ &#39;details&#39;, &#39;with&#39;, 2 ],\n    lhs: &#39;elements&#39;,\n    rhs: &#39;more&#39;\n  &#125;\n]\n","slug":"2022-05-27redux-logger","date":"2022-05-27T05:52:01.000Z","categories_index":"redux","tags_index":"redux,æºç ","author_index":"é™ˆæµ·é¾™"},{"id":"98e904a0d3e9702a10dc20a22eaad4dd","title":"vscode i18n-ally","content":"å›½é™…åŒ–\nå¤§å‹å…¬å¸çš„å›½é™…åŒ–éœ€æ±‚å¾ˆé«˜ï¼Œéœ€è¦æ”¯æŒå¤šè¯­è¨€ï¼Œæ¯”å¦‚ä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰ç­‰ã€‚\ni18n-allyæ˜¯ä¸€ä¸ªåŸºäºvscodeçš„å›½é™…åŒ–å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿçš„å®ç°å›½é™…åŒ–ã€‚\n\nèƒŒæ™¯\nå¦‚æœç»å¸¸åšå›½é™…åŒ–çš„ç ”å‘ï¼Œåº”è¯¥å¾ˆæ¸…æ¥šï¼Œä»£ç ä¸­å†™å¤šè¯­è¨€ï¼Œç„¶è€Œï¼Œå¤šè¯­è¨€åœ¨é¡¹ç›®ä¸­ç»´æŠ¤æ˜¯éå¸¸å›°éš¾çš„ã€‚\nå½“é‡åˆ°å¤§å‹é¡¹ç›®ï¼Œä¸šåŠ¡è¦åšæ‹†åˆ†æˆä¸ºå¾®å‰ç«¯æ¶æ„ï¼Œå¤šè¯­è¨€è¦åœ¨å¤šä¸ªé¡¹ç›®ä¸­ç»´æŠ¤ï¼Œæµªè´¹æ—¶é—´ä¸è¯´ï¼Œè¿˜å¯èƒ½é€ æˆä¸ä¸€è‡´é—®é¢˜\nå¤„ç†æ–¹å¼ï¼š\nå°†å¯¹åº”çš„å¤šè¯­è¨€å¼€å‘ä¸ºnpmåŒ…ï¼Œåœ¨é¡¹ç›®ä¸­å¼•å…¥\næ‹†å¤šè¯­è¨€ä¸ºä¸€ä¸ªåº”ç”¨å¹³å°ï¼Œå®ç°å¤šé¡¹ç›®å…±äº«ï¼Œå®ç°å¯è§†åŒ–äº¤äº’ï¼ˆæˆ‘ä»¬ç›®å‰ä½¿ç”¨ï¼Œè‡ªç ”localizeå¹³å°ï¼Œå®ç°å¤šè¯­è¨€ç®¡ç†ï¼‰\n\n\n\né¢˜å¤–è¯åº”ç”¨å¹³å°\n\nåŠ¨æ€ç”Ÿæ•ˆï¼š ä¿®æ”¹å¤šè¯­è¨€ä¸éœ€è¦é‡å¯ã€å‘å¸ƒæœåŠ¡\nç¿»è¯‘ç®¡ç†ï¼šå¤šäººååŒåœ¨çº¿ç¿»è¯‘\nç‰ˆæœ¬ç®¡ç†ï¼š è®°å½•ç¿»è¯‘å˜æ›´è®°å½•ä»¥åŠå¯¹åº”çš„æ“ä½œäººï¼Œæ–¹ä¾¿å®šä½ä¸æ’é”™\nè‡ªåŠ¨å¤šåŒºåŒæ­¥ï¼šåªéœ€åœ¨ä¸­å›½åŒºä¿®æ”¹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŒæ­¥åˆ°å›½å¤–5åŒº\n\nä¼˜ç‚¹\næç¤ºä¼˜é›…ï¼Œæœªå¤„ç†çš„å¤šè¯­è¨€ä¼šæœ‰æç¤º\nç¼–è¾‘æ–¹ä¾¿\n\n\n\n\n\n\nEnglish | ç®€ä½“ä¸­æ–‡\n\n\n\n\n\n\n\n\n\n\n\n\nv2.0 is released with new Editor UI and Review System ğŸ‰\n\n\n\nMigrate from v1.x\n\n\n\n\n\n\n\n\n\nMaintained by\n\n\nLokalise is the fastest growing language cloud technology made by developers, for developers.\nAs a collaborative productivity platform, it helps structure and automate the translation and localization process for any company in the world.\nLokaliseæ˜¯å¼€å‘äººå‘˜ä¸ºå¼€å‘äººå‘˜å¼€å‘çš„å¢é•¿æœ€å¿«çš„è¯­è¨€äº‘æŠ€æœ¯\nä½œä¸ºä¸€ä¸ªåä½œç”Ÿäº§åŠ›å¹³å°ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä¸–ç•Œä¸Šä»»ä½•å…¬å¸æ„å»ºå’Œè‡ªåŠ¨åŒ–ç¿»è¯‘å’Œæœ¬åœ°åŒ–è¿‡ç¨‹ã€‚\nLearn more\n\n\n\n\n\n\n\nğŸ“– Docs æ–‡æ¡£\n|\nğŸ’­ FAQ é—®ç­”\n|\nâš™ï¸ Configs é…ç½®\n|\nğŸ“œ Supported Formats æ”¯æŒæ ¼å¼\n|\nğŸ§± Contribute è´¡çŒ®\n\n\n\n\n\nInline Annotations è¡Œå†…æç¤º\n\n\nHover and Direct Actions æ‚¬åœå’Œç›´æ¥æ“ä½œ\n\n\nManage All Translations in One Place åœ¨ä¸€ä¸ªä½ç½®ç®¡ç†æ‰€æœ‰ç¿»è¯‘\n\n\nEditor UIç¼–è¾‘ç•Œé¢ & Review System é¢„è§ˆç³»ç»Ÿ\n\n\nExtract Translations from Code ä»ä»£ç ä¸­æå–ç¿»è¯‘\n\n\nReport Missing Translations æŠ¥å‘Šç¼ºå¤±çš„ç¿»è¯‘\n\n\nMachine Translation æœºå™¨ç¿»è¯‘\n\n\nAnnotations for JSON and YAML æ¥æºäºJSON å’Œ YAMLçš„æç¤º\n\n\nGeneral Features\n\n\nSupports multi-root workspaces  æ”¯æŒå¤šä¸ªå·¥ä½œç©ºé—´\nSupports remote development æ”¯æŒè¿œç¨‹å¼€å‘\nSupports numerous popular frameworks æ”¯æŒå¤šç§æµè¡Œæ¡†æ¶\nSupports linked locale messages é“¾æ¥çš„åŒºåŸŸè®¾ç½®æ¶ˆæ¯\nUses i18n for the extension itself, of course. å½“ç„¶ï¼Œå°†i18nç”¨äºæ‰©å±•æœ¬èº«ã€‚ Translation List ç¿»è¯‘åˆ—è¡¨\n\nğŸŒ Multilingual Support å¤šè¯­è¨€æ”¯æŒThis extension itself supports i18n as well. It will be auto-matched to the display language you use in your VS Code editor. We currently support the following languages.è¿™ä¸ªæ‰©å±•æ”¯æŒå¤šè¯­è¨€ã€‚å®ƒå°†è‡ªåŠ¨åŒ¹é…åˆ°ä½ åœ¨VS Codeç¼–è¾‘å™¨ä¸­ä½¿ç”¨çš„è¯­è¨€ã€‚æˆ‘ä»¬ç›®å‰æ”¯æŒçš„è¯­è¨€æœ‰ï¼š\n\n\n\nLanguage\nMaintainer\nContributors\n\n\n\nEnglish   è‹±è¯­\n@antfu\n@rubjo, @EdRands\n\n\nSimplified Chinese (ç®€ä½“ä¸­æ–‡)\n@antfu\n\n\n\nTraditional Chinese (ç¹é«”ä¸­æ–‡)\n@antfu\n\n\n\nNorwegian (Norsk) æŒªå¨è¯­\n\n@rubjo\n\n\nSpanish (EspaÃ±ol) è¥¿ç­ç‰™çš„\n\n@Baltimer\n\n\nJapanese (æ—¥æœ¬èª) æ—¥è¯­\n\n@isdh\n\n\nDutch (Nederlands) è·å…°è¯­\n\n@Niekvdm, @Excalibaard\n\n\nPortuguese (Brazilian) è‘¡è„ç‰™è¯­\n\n@Ibcs16\n\n\nFrench (FranÃ§ais) æ³•è¯­\n\n@Nicoxx45, @eri\n\n\nSwedish (Svenska)ç‘å…¸è¯­\n@vladdeSV\n\n\n\nUkrainian (Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°) ä¹Œå…‹å…°è¯­\n\n@uhodav\n\n\nRussian (Ğ ÑƒÑÑĞºĞ¸Ğ¹) ä¿„è¯­\n\n@uhodav\n\n\nGerman (Deutsch) å¾·è¯­\n@alexanderniebuhr\n\n\n\nTurkish (TÃ¼rkÃ§e) åœŸè€³å…¶è¯­\n\n@eri\n\n\nå¸®å¿™ç¿»è¯‘\n\n\n\n\n\n\n\n\n\nğŸ‘¨â€ğŸ’» å¦‚æœæ‚¨æƒ³å¸®åŠ©ä¸€ç§è¯­è¨€çš„ç¿»è¯‘æ›´æ–°ï¼Œè¯·åœ¨ç»´æŠ¤è€…å­—æ®µä¸­è¾“å…¥æ‚¨çš„å§“åã€‚æˆ‘ä¼šåœ¨éœ€è¦çš„æ—¶å€™æåˆ°ä½ ã€‚éå¸¸æ„Ÿè°¢ã€‚\nâ¤ï¸ æ„Ÿè°¢æ­¤æ’ä»¶çš„çµæ„Ÿæ¥æºäºthink2011&#x2F;vscode-vue-i18n. å¦‚æœæ²¡æœ‰@think2011,i18n-allyä¸ä¼šå­˜åœ¨\nå¯¹Vueå•æ–‡ä»¶ç»„ä»¶ï¼ˆSFCï¼‰çš„æ”¯æŒç”±[kazupon&#x2F;Vue-i18n-locale-message]æä¾›æ”¯æŒ(https://github.com/kazupon/vue-i18n-locale-message)ï¼Œå®ƒæ˜¯ç”±vue-i18nçš„ä½œè€…åˆ›å»ºçš„ã€‚è°¢è°¢ä½ åšè¿™ä¸ªï¼\nä»£ç å…±äº«è€…éå¸¸æ„Ÿè°¢æ‰€æœ‰æ°å‡ºçš„è´¡çŒ®è€…ï¼š\nåè®®MIT License Â© 2019-PRESENT Anthony Fu\nMIT License Â© 2018-2019 think2011\nå®‰è£…Visual Studio Code&gt;Other&gt;i18n Ally\nä½¿ç”¨å‚è€ƒèµ„æ–™github å®˜ç½‘\n","slug":"2022-05-27i18n","date":"2022-05-27T02:47:24.000Z","categories_index":"","tags_index":"å·¥å…·,å¢æ•ˆ,vscode","author_index":"é™ˆæµ·é¾™"},{"id":"ef136ce7ac94dd6f9c2f35712eef1e47","title":"redux-thunkæºç ","content":"æºç ç‰ˆæœ¬v2.4.1\nç”¨é€”\né€šè¿‡reduxæºç applyMiddlewareäº†è§£åˆ°ï¼Œæ˜¯å¯¹store.dispatchè¿›è¡Œå¢å¼º\nå¯ä»¥æ¥å—ä¸€ä¸ªè¿”å›å‡½æ•°çš„action creatorã€‚å¦‚æœè¿™ä¸ªaction creator è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±æŒ‰ç…§åŸæ¥çš„next(action)æ‰§è¡Œã€‚\nå¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­æ‰§è¡Œä¸€äº›å¼‚æ­¥çš„æ“ä½œ\n\nexport function addCount() &#123;\n  return &#123;type: ADD_COUNT&#125;\n&#125; \nexport function addCountAsync() &#123;\n  return dispatch &#x3D;&gt; &#123; &#x2F;&#x2F; dispatchå¯¹åº”æºç çš„ ï¼š action(dispatch, getState, extraArgument);çš„ç¬¬ä¸€ä¸ªå‚æ•°\n    setTimeout( () &#x3D;&gt; &#123;\n      dispatch(addCount())\n    &#125;,2000)\n  &#125;\n&#125;\n\n\naddCountAsyncå‡½æ•°å°±è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œå°†dispatchä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’è¿›å»ï¼Œåœ¨å‡½æ•°å†…è¿›è¡Œå¼‚æ­¥æ“ä½œå°±å¯ä»¥äº†ã€‚\n\npackage.json\nè¿™ä¸ªæ–‡ä»¶ç»“æ„ä¸reduxã€react-reduxç›¸æ¯”ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œè¿™é‡ŒåŠä»¥åå¦‚æ— å¿…è¦ä¸åœ¨è¿›è¡Œé˜…è¯»\nç®€å•æ‰«ä¸€çœ¼å°±å¥½\n\næºç &#x2F;** A function that accepts a potential &quot;extra argument&quot; value to be injected later,\n * and returns an instance of the thunk middleware that uses that value\n *&#x2F;\n&#x2F;** ä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯èƒ½çš„&quot;extra argument&quot;å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªthunkä¸­é—´ä»¶ï¼Œå®ƒä½¿ç”¨è¿™ä¸ªå€¼ *&#x2F;\nfunction createThunkMiddleware&lt;\n  State &#x3D; any,\n  BasicAction extends Action &#x3D; AnyAction,\n  ExtraThunkArg &#x3D; undefined\n&gt;(extraArgument?: ExtraThunkArg) &#123;\n  &#x2F;&#x2F; Standard Redux middleware definition pattern:\n  &#x2F;&#x2F; æ ‡å‡†Reduxä¸­é—´ä»¶å®šä¹‰æ¨¡å¼:\n  &#x2F;&#x2F; See: https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#writing-custom-middleware\n  const middleware: ThunkMiddleware&lt;State, BasicAction, ExtraThunkArg&gt; &#x3D;\n    (&#123; dispatch, getState &#125;) &#x3D;&gt; (next) &#x3D;&gt;  (action) &#x3D;&gt; &#123;\n      &#x2F;&#x2F; The thunk middleware looks for any functions that were passed to &#96;store.dispatch&#96;.\n      &#x2F;&#x2F; If this &quot;action&quot; is really a function, call it and return the result.\n      &#x2F;&#x2F; è¿™ä¸ªthunkä¸­é—´ä»¶ä¼šæŸ¥æ‰¾store.dispatchä¼ å…¥çš„ä»»ä½•å‡½æ•°ã€‚å¦‚æœè¿™ä¸ª&quot;action&quot;æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨å®ƒå¹¶è¿”å›ç»“æœã€‚\n      if (typeof action &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;\n        &#x2F;&#x2F; Inject the store&#39;s &#96;dispatch&#96; and &#96;getState&#96; methods, as well as any &quot;extra arg&quot;\n        &#x2F;&#x2F; æ³¨å…¥storeçš„dispatchå’ŒgetStateæ–¹æ³•ï¼Œä»¥åŠä»»æ„çš„&quot;extra arg&quot;\n        return action(dispatch, getState, extraArgument);\n      &#125;\n      &#x2F;&#x2F; å¦åˆ™ï¼Œåƒå¾€å¸¸ä¸€æ ·å°†æ“ä½œä¼ é€’ç»™ä¸­é—´ä»¶é“¾\n      &#x2F;&#x2F; Otherwise, pass the action down the middleware chain as usual\n      return next(action);\n    &#125;;\n  return middleware;\n&#125;\nä¸­é—´ä»¶æ¨¡å¼\næŸ¯é‡ŒåŒ–ï¼šå°†ä¸€ä¸ªå‡½æ•°çš„å‚æ•°åˆ†è§£æˆå¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªæ–°çš„å‡½æ•°å¯ä»¥è¢«è°ƒç”¨ï¼Œå¹¶ä¸”è¿”å›åŸå‡½æ•°çš„ç»“æœã€‚\nconst anotherExampleMiddleware &#x3D; storeAPI &#x3D;&gt; next &#x3D;&gt; action &#x3D;&gt; &#123;\n  &#x2F;&#x2F; Do something in here, when each action is dispatched\n\n  return next(action)\n&#125;\nstoreAPI\n&#x2F;&#x2F; storeAPI\n\nconst store &#x3D; &#123;\n  dispatch: dispatch as Dispatch&lt;A&gt;,\n  subscribe,\n  getState,\n  replaceReducer,\n  [$$observable]: observable\n&#125; as unknown as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext\nå·¥å‚æ¨¡å¼\n\nconst thunk &#x3D; createThunkMiddleware() as ThunkMiddleware &amp; &#123;\n  withExtraArgument&lt;\n    ExtraThunkArg,\n    State &#x3D; any,\n    BasicAction extends Action &#x3D; AnyAction\n  &gt;(\n    extraArgument: ExtraThunkArg\n  ): ThunkMiddleware&lt;State, BasicAction, ExtraThunkArg&gt;\n&#125;\n\n&#x2F;&#x2F; Attach the factory function so users can create a customized version\n&#x2F;&#x2F; with whatever &quot;extra arg&quot; they want to inject into their thunks\n&#x2F;&#x2F; å°è¯•å°†å·¥å‚å‡½æ•°é™„åŠ åˆ°ç”¨æˆ·å¯ä»¥åˆ›å»ºä»»ä½•é¢å¤–çš„&quot;extra arg&quot;çš„thunkä¸­é—´ä»¶\nthunk.withExtraArgument &#x3D; createThunkMiddleware\n\nexport default thunk\nå‚è€ƒredux-thunkæºç Reduxä¸­é—´ä»¶ä¹‹redux-thunkä½¿ç”¨è¯¦è§£\n","slug":"2022-05-27redux-thunk","date":"2022-05-27T01:21:50.000Z","categories_index":"redux","tags_index":"redux,æºç ,redux-thunk","author_index":"é™ˆæµ·é¾™"},{"id":"33a4c09d5b272c8b61a9dda679d7a5e9","title":"npm åŒ…å‘å¸ƒç›¸å…³","content":"npm åŒ…å‘å¸ƒnpm notice &#x3D;&#x3D;&#x3D; Tarball Details &#x3D;&#x3D;&#x3D; \nnpm notice name:          @tutu-fe&#x2F;wiki-ui                        \nnpm notice version:       0.1.1-beta                              \nnpm notice filename:      @tutu-fe&#x2F;wiki-ui-0.1.1-beta.tgz         \nnpm notice package size:  85.7 kB                                 \nnpm notice unpacked size: 449.9 kB                                \nnpm notice shasum:        973f5eb8d74de04c34b8e9c94536f8924b1f9570\nnpm notice integrity:     sha512-Uyo3zS0eaMOYE[...]60Ywmrmb&#x2F;brxQ&#x3D;&#x3D;\nnpm notice total files:   205                                     \nnpm notice \nnpm ERR! code E403\nnpm ERR! 403 403 Forbidden - PUT https:&#x2F;&#x2F;registry- - [maintainers_error] haotian.chen does not in maintainer list\nnpm ERR! 403 In most cases, you or one of your dependencies are requesting\nnpm ERR! 403 a package version that is forbidden by your security policy, or\nnpm ERR! 403 on a server you do not have access to.\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     &#x2F;Users&#x2F;haotian&#x2F;.npm&#x2F;_logs&#x2F;2022-04-28T09_58_10_365Z-debug.log\n\n\né…ç½®package.json&quot;maintainers&quot;: [\n  &quot;davishua&quot;,Ã¥\n  &quot;haotian.chen&quot;\n],\n\n\nç»“æœ\n","slug":"2022-04-28npm","date":"2022-05-26T14:12:56.671Z","categories_index":"npm","tags_index":"npm","author_index":"é™ˆæµ·é¾™"},{"id":"0539c4f1e60b889c5708d72373a67061","title":"ä¼ä¸šå¾®ä¿¡ï¼š å›¾ç‰‡é™„ä»¶æ— æ³•é¢„è§ˆçš„é—®é¢˜","content":"\n\nèƒŒæ™¯ï¼šå®‰å“é¢„è§ˆæ­£å¸¸ï¼Œéƒ¨åˆ†iOSé¢„è§ˆæœ‰é—®é¢˜ï¼ˆå¤§éƒ¨åˆ†æ‰‹æœºéƒ½æ˜¯æ­£å¸¸çš„ï¼‰downloadAttachment(downloadUrl).then(res &#x3D;&gt; &#123;\n      if (getWechatUserAgent(navigator.userAgent)) &#123; &#x2F;&#x2F; åˆ¤æ–­æ˜¯ä¼ä¸šå¾®ä¿¡\n        const blob &#x3D; new Blob([res]);\n        wx.previewFile(&#123;\n          url: location.origin + downloadUrl, &#x2F;&#x2F; éœ€è¦é¢„è§ˆæ–‡ä»¶çš„åœ°å€(å¿…å¡«ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„)\n          name: attachment.name, &#x2F;&#x2F; éœ€è¦é¢„è§ˆæ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¿…é¡»æœ‰å¸¦æ–‡ä»¶æ ¼å¼çš„åç¼€ï¼Œä¾‹å¦‚.doc(ä¸å¡«çš„è¯å–urlçš„æœ€åéƒ¨åˆ†ï¼Œæœ€åéƒ¨åˆ†æ˜¯ä¸ªåŒ…å«æ ¼å¼åç¼€çš„æ–‡ä»¶å)\n          size: blob.size &#x2F;&#x2F; éœ€è¦é¢„è§ˆæ–‡ä»¶çš„å­—èŠ‚å¤§å°(å¿…å¡«ï¼Œè€Œä¸”å¤§å°å¿…é¡»æ­£ç¡®ï¼Œå¦åˆ™ä¼šæ‰“å¼€å¤±è´¥)\n        &#125;);\n        Toast.loading(i18n.loading, false)\n        return\n      &#125;\n      var reader &#x3D; new FileReader();\n      reader.readAsDataURL(res);   &#x2F;&#x2F; è½¬æ¢ä¸ºbase64ï¼Œå¯ä»¥ç›´æ¥æ”¾å…¥aæ ‡ç­¾href\n      reader.onload &#x3D; function (e) &#123;\n        const anchorEle &#x3D; document.createElement(&#39;a&#39;)\n        document.body.appendChild(anchorEle)\n        anchorEle.href &#x3D; e?.target?.result as any\n        anchorEle.download &#x3D; attachment.name\n        anchorEle.click()\n        document.body.removeChild(anchorEle)\n      &#125;\n      Toast.loading(i18n.loading, false)\n    &#125;).catch(() &#x3D;&gt; &#123;\n      Toast.loading(i18n.loading, false)\n    &#125;)\nè‡ªç ”ç§»åŠ¨ç«¯ã€webç«¯ã€ä¼ä¸šå¾®ä¿¡æ¡Œé¢ç«¯éƒ½æ²¡é—®é¢˜ï¼Œå½“ç„¶å–½ï¼Œæ¯ä¸€ä¸ªç«¯å±•ç¤ºæ•ˆæœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä»£ç ä¹Ÿä¸ä¸€æ ·ã€‚æ’æŸ¥äº†è€—è´¹ä¸€å®šæ—¶é—´ã€‚\n\n\næ’æŸ¥ ä¼ä¸šå¾®ä¿¡ç‰ˆæœ¬ï¼Œ æ¯”å¯¹åå‘ç°ï¼Œå’Œæ­£å¸¸ä½¿ç”¨çš„å¾®ä¿¡ç‰ˆæœ¬ä¸€è‡´\næ’æŸ¥æ‰‹æœºç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œå®¢æˆ·iphone12å’Œ ç³»ç»Ÿç‰ˆæœ¬15.1ï¼Œæˆ‘ä»¬å¼€å‘äººå‘˜æ˜¯14.+ï¼Œæ‰€ä»¥æˆ‘æŠŠæˆ‘çš„æ‰‹æœºå‡çº§åˆ°æœ€æ–°ï¼Œæˆ‘çš„æ‰‹æœºå‡çº§åæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯æ•°æ®é—®é¢˜ï¼Œæ•°æ®\næ’æŸ¥æ•°æ®ï¼Œè¿™æ˜¯è€ç³»ç»Ÿçš„æ•°æ®ï¼Œå’Œæ–°ç³»ç»Ÿæ•°æ®èµ°ä¸åŒçš„ä¸šåŠ¡ä»£ç ï¼Œç»æ’æŸ¥ä¹Ÿæ²¡é—®é¢˜\næ’æŸ¥sizeå¦‚æœä¸å‡†ç¡®ä¹Ÿä¼šå‡ºç°ä¸Šè¿°é—®é¢˜ï¼Œç”±äºé¢„å‘ç¯å¢ƒè·å–ç¥¨æ®çš„ä¿¡æ¯ä¸çº¿ä¸Šæ˜¯ä¸ä¸€è‡´çš„ï¼Œæ‰€ä»¥æ— æ³•åœ¨é¢„å‘è¿›è¡Œæ’æŸ¥ï¼Œèƒ½åšçš„äº‹ä¿è¯ä»£ç æ‰§è¡Œåˆ° const blob = new Blob([res]);ï¼Œå¹¶ä¸”èƒ½å¤Ÿè·å–åˆ°æ­£ç¡®çš„sizeï¼Œæ‰€ä»¥è¿›è¡Œäº†alertè°ƒè¯•ï¼Œè¿™ä¸ªåœ¨æ‰‹æœºä¸Šæ¯”è¾ƒç›´è§‚ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥vconsoleã€æš‚ä¸è€ƒè™‘,å› ä¸ºä¹‹å‰å¼€å‘äººå‘˜æ²¡åŠ ï¼Œéƒ¨é—¨è¢«ç æ‰ï¼Œå¾ˆå¤šäººè¢«è£å‘˜äº†ï¼Œæ‰€æœ‰é¡¹ç›®éƒ½æˆ‘æ¥ç»´æŠ¤ï¼Œæ²¡æ—¶é—´ï¼Œä¸æ•´äº†ã€‘ï¼Œè°ƒè¯•ç»“æœæ˜¯size: 88214,å„ä¸ªæ‰‹æœºéƒ½ä¸€æ ·ï¼Œç”¨æˆ·æ‰‹æœºä¹Ÿæ˜¯88214ï¼Œæ•…æ’é™¤size\næœ€åå¯èƒ½é—®é¢˜åœ¨äºï¼Œç”¨æˆ·æ‰‹æœºä¸Šç‰ˆæœ¬ä¸æ‰‹æœºä¸åŒ¹é…ï¼Œæœ‰å…¼å®¹æ€§bugï¼Œå°è¯•å‡çº§ä¼ä¸šå¾®ä¿¡ï¼Œæœ€åè§£å†³\n\n\n\næ€»ç»“ï¼šå¦‚æœè€ƒè™‘ç›´æ¥å‡çº§ç”¨æˆ·appç‰ˆæœ¬ï¼Œæˆ–è®¸åœ¨ç¬¬ä¸‰æ­¥å°±è§£å†³é—®é¢˜äº†ï¼Œæˆ‘çš„iphoneXä¹Ÿä¸ç”¨å‡çº§åˆ°15.3äº†\n","slug":"2022-04-19wework-preview","date":"2022-05-26T14:12:56.670Z","categories_index":"WeWork","tags_index":"WeWork","author_index":"é™ˆæµ·é¾™"},{"id":"5df43a7a7d0a76be0dcfbc13fca3f3d6","title":"js ä»£ç æ³¨é‡Š","content":"ä»£ç æ³¨é‡Š//è¿™ç§jsæ³¨é‡Šä»£ç åœ¨vscodeå…¶ä»–åœ°æ–¹å¼•ç”¨æ—¶å€™ï¼Œæ²¡æœ‰æç¤ºï¼Œ å¦‚æœéœ€è¦æœ‰æç¤ºï¼Œéœ€è¦å†™æˆ/** æç¤º **/\nå†™æ³•1\nexport enum ELeaveType &#123;\n  MATERNITY_ &#x3D; 17, &#x2F;&#x2F; &quot;äº§å‡&amp;è¡¥å……å‡&quot;, &quot;è¿ç»­ä½¿ç”¨ï¼Œé¢„äº§æœŸå‰15å¤©&quot;),\n&#125;\nå†™æ³•2\nexport enum ELeaveType &#123;\n  &#x2F;&#x2F; &quot;äº§å‡&amp;è¡¥å……å‡&quot;, &quot;è¿ç»­ä½¿ç”¨ï¼Œé¢„äº§æœŸå‰15å¤©&quot;),\n  MATERNITY_ &#x3D; 17, \n&#125;\n\næœ‰æç¤ºæ³¨é‡Šå†™æ³•export enum ELeaveType &#123;\n...\n  &#x2F;**&quot;äº§å‡&amp;è¡¥å……å‡&quot;, &quot;è¿ç»­ä½¿ç”¨ï¼Œé¢„äº§æœŸå‰15å¤©&quot;),**&#x2F;\n  MATERNITY_ &#x3D; 17, \n...\n&#125;\n\n\n","slug":"2022-05-26code","date":"2022-05-26T07:31:20.000Z","categories_index":"code","tags_index":"code","author_index":"é™ˆæµ·é¾™"},{"id":"da6549350c9a9d927d67bdb10bc76a3c","title":"redux æºç  2","content":"redux ç®€ä»‹Predictable state container for JavaScript apps\nå­—é¢æ„æ€\njsåº”ç”¨å¯é¢„æµ‹çŠ¶æ€å®¹å™¨\n\næ€ä¹ˆç”¨ï¼Œä¸ºä»€ä¹ˆç”¨çœ‹å®˜ç½‘ã€‚ã€‚ã€‚\ncreateStoreä»£ç æ³¨é‡Šå¦‚ä¸‹\n\nredux storeæŒæœ‰stateæ ‘ï¼Œå”¯ä¸€å¯ä»¥æ”¹å˜storeä¸­æ•°æ®çš„æ–¹å¼æ˜¯dispatch\nåœ¨ä½ çš„appä¸­åº”è¯¥æœ‰å”¯ä¸€ä¸€ä¸ªstore.ä¸ºäº†åŒºåˆ†ä¸åŒéƒ¨åˆ†å“åº”æ“ä½œçš„çš„çŠ¶æ€æ ‘ï¼Œå¯ä»¥å°†å‡ ä¸ªreduceré€šè¿‡combinereducersåˆå¹¶ä¸ºä¸€ä¸ªreducer\nä¸€ä¸ªæ ¹æ®å½“å‰stateå’Œè¡Œä¸ºè¿”å›æ–°stateçš„å‡½æ•°\nåˆå§‹stateï¼Œ\nstoreä¸­é—´ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶å¢å¼ºstore\nredux store å¯ä»¥è¯»å–stateï¼Œdispatchè¡Œä¸ºï¼Œè®¢é˜…æ”¹å˜\n\n\n&#x2F;**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call &#96;dispatch()&#96; on it.\n * \n * redux storeæŒæœ‰stateæ ‘ï¼Œå”¯ä¸€å¯ä»¥æ”¹å˜storeä¸­æ•°æ®çš„æ–¹å¼æ˜¯dispatch\n * \n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using &#96;combineReducers&#96;.\n *\n * åœ¨ä½ çš„appä¸­åº”è¯¥æœ‰å”¯ä¸€ä¸€ä¸ªstore.ä¸ºäº†åŒºåˆ†ä¸åŒéƒ¨åˆ†å“åº”æ“ä½œçš„çš„çŠ¶æ€æ ‘ï¼Œå¯ä»¥å°†å‡ ä¸ªreduceré€šè¿‡combinereducersåˆå¹¶ä¸ºä¸€ä¸ªreducer\n * \n * @param reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n * \n * ä¸€ä¸ªæ ¹æ®å½“å‰stateå’Œè¡Œä¸ºè¿”å›æ–°stateçš„å‡½æ•°\n *\n * @param preloadedState The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use &#96;combineReducers&#96; to produce the root reducer function, this must be\n * an object with the same shape as &#96;combineReducers&#96; keys.\n *\n * åˆå§‹stateï¼Œ\n * \n * @param enhancer The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is &#96;applyMiddleware()&#96;.\n *\n * storeä¸­é—´ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶å¢å¼ºstore\n * \n * @returns A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n * \n * redux store å¯ä»¥è¯»å–stateï¼Œdispatchè¡Œä¸ºï¼Œè®¢é˜…æ”¹å˜\n *&#x2F;\nå‡½æ•°å£°æ˜\nexport default function createStore&lt;\n  S,\n  A extends Action,\n  Ext &#x3D; &#123;&#125;,\n  StateExt &#x3D; never\n&gt;(\n  reducer: Reducer&lt;S, A&gt;, &#x2F;&#x2F; reducer\n  enhancer?: StoreEnhancer&lt;Ext, StateExt&gt;&#x2F;&#x2F; ä¸­é—´ä»¶\n): Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext\n\nexport default function createStore&lt;\n  S,\n  A extends Action,\n  Ext &#x3D; &#123;&#125;,\n  StateExt &#x3D; never\n&gt;(\n  reducer: Reducer&lt;S, A&gt;, &#x2F;&#x2F; reducer\n  preloadedState?: PreloadedState&lt;S&gt;, &#x2F;&#x2F; &#x2F;&#x2F;åˆå§‹çŠ¶æ€\n  enhancer?: StoreEnhancer&lt;Ext, StateExt&gt; &#x2F;&#x2F; ä¸­é—´ä»¶\n): Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext\n\nexport default function createStore&lt;\n  S,\n  A extends Action,\n  Ext &#x3D; &#123;&#125;,\n  StateExt &#x3D; never\n&gt;(\n  reducer: Reducer&lt;S, A&gt;,&#x2F;&#x2F; reducer\n  preloadedState?: PreloadedState&lt;S&gt; | StoreEnhancer&lt;Ext, StateExt&gt;, &#x2F;&#x2F;åˆå§‹çŠ¶æ€\n  enhancer?: StoreEnhancer&lt;Ext, StateExt&gt;&#x2F;&#x2F; ä¸­é—´ä»¶\n\n  &#x2F;&#x2F; è¿™é‡Œå¯ä»¥çœ‹åˆ° preloadedStateçš„å‚æ•°| StoreEnhancer&lt;Ext, StateExt&gt; ä¸ enhancerç±»å‹ä¸€è‡´ï¼Œ è¿™é‡Œå¤„ç†ç¬¬äºŒå‚æ•°å¯èƒ½æ˜¯ enhancer\n  &#x2F;&#x2F; ä»£ç ä¸»ä½“åˆ†æœ‰åšåˆ¤æ–­ï¼š\n  &#x2F;&#x2F; if (typeof preloadedState &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof enhancer &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;\n  &#x2F;&#x2F;   enhancer &#x3D; preloadedState as StoreEnhancer&lt;Ext, StateExt&gt;\n  &#x2F;&#x2F;   preloadedState &#x3D; undefined\n  &#x2F;&#x2F; &#125; \n\n): Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext &#123;&#125;\ncreateStore ä¸»ä½“ä»£ç \n\nä¸€äº›å…¥å‚æ ¡éªŒ\n\nif (\n  (typeof preloadedState &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof enhancer &#x3D;&#x3D;&#x3D; &#39;function&#39;) ||\n  (typeof enhancer &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof arguments[3] &#x3D;&#x3D;&#x3D; &#39;function&#39;)\n) &#123;\n  throw new Error(\n    &#39;It looks like you are passing several store enhancers to &#39; +\n      &#39;createStore(). This is not supported. Instead, compose them &#39; +\n      &#39;together to a single function. See https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#creating-a-store-with-enhancers for an example.&#39;\n  )\n&#125;\n\nif (typeof preloadedState &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof enhancer &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;\n  enhancer &#x3D; preloadedState as StoreEnhancer&lt;Ext, StateExt&gt;\n  preloadedState &#x3D; undefined\n&#125;\n\nif (typeof enhancer !&#x3D;&#x3D; &#39;undefined&#39;) &#123;\n  if (typeof enhancer !&#x3D;&#x3D; &#39;function&#39;) &#123;\n    throw new Error(\n      &#96;Expected the enhancer to be a function. Instead, received: &#39;$&#123;kindOf(\n        enhancer\n      )&#125;&#39;&#96;\n    )\n  &#125;\n\n  return enhancer(createStore)(\n    reducer,\n    preloadedState as PreloadedState&lt;S&gt;\n  ) as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext\n&#125;\n\nif (typeof reducer !&#x3D;&#x3D; &#39;function&#39;) &#123;\n  throw new Error(\n    &#96;Expected the root reducer to be a function. Instead, received: &#39;$&#123;kindOf(\n      reducer\n    )&#125;&#39;&#96;\n  )\n&#125;\n\n&#x2F;&#x2F; å½“å‰reducer\nlet currentReducer &#x3D; reducer\n&#x2F;&#x2F; å½“å‰çŠ¶æ€\nlet currentState &#x3D; preloadedState as S\n&#x2F;&#x2F; å½“å‰è®¢é˜…\nlet currentListeners: (() &#x3D;&gt; void)[] | null &#x3D; []\n&#x2F;&#x2F; æ–°çš„è®¢é˜…\nlet nextListeners &#x3D; currentListeners\nlet isDispatching &#x3D; false\n\n\n\n&#x2F;**\n * This makes a shallow copy of currentListeners so we can use\n * nextListeners as a temporary list while dispatching.\n *\n * This prevents any bugs around consumers calling\n * subscribe&#x2F;unsubscribe in the middle of a dispatch.\n *&#x2F;\n&#x2F;&#x2F; æµ…æ‹·è´å½“å‰currentListenerså¾—åˆ° nextListeners ç”¨äº dispatching   \n\n&#x2F;&#x2F; ç¡®å®šæ–°çš„å¯å˜ç›‘å¬\nfunction ensureCanMutateNextListeners() &#123;\n  ã€‚ã€‚ã€‚\n&#125;\n\n&#x2F;&#x2F; è·å–storeçš„çŠ¶æ€\nfunction getState(): S &#123;\n  ã€‚ã€‚ã€‚\n&#125;\n&#x2F;&#x2F; ä¼ å…¥ç›‘å¬ï¼Œè¿”å›ç›‘å¬ç§»é™¤çš„å‡½æ•°\nfunction subscribe(listener: () &#x3D;&gt; void) &#123;\n  ã€‚ã€‚ã€‚\n\n  return function unsubscribe() &#123;\n    ã€‚ã€‚ã€‚ã€‚\n  &#125;\n&#125;\n\n\nfunction dispatch(action: A) &#123;\n  ã€‚ã€‚ã€‚\n&#125;\n\n&#x2F;&#x2F; ç”¨äºåŒæ„æ›´æ–°reducer\nfunction replaceReducer&lt;NewState, NewActions extends A&gt;(\n  nextReducer: Reducer&lt;NewState, NewActions&gt;\n): Store&lt;ExtendState&lt;NewState, StateExt&gt;, NewActions, StateExt, Ext&gt; &amp; Ext &#123;\n  ã€‚ã€‚ã€‚\n&#125;\n\n&#x2F;**\n * Interoperability point for observable&#x2F;reactive libraries.\n * @returns A minimal observable of state changes.\n * For more information, see the observable proposal:\n * https:&#x2F;&#x2F;github.com&#x2F;tc39&#x2F;proposal-observable\n *&#x2F;\n&#x2F;&#x2F; å®ç°å°å‹è§‚å¯ŸçŠ¶æ€å˜æ›´\nfunction observable() &#123;\n  ã€‚ã€‚ã€‚\n&#125;\n&#x2F;&#x2F; å½“storeè¢«åˆ›å»ºï¼Œåˆå§‹åŒ–æ“ä½œä¼šè¢«dispatchï¼Œï¼Œæ¯ä¸ªreducerä¼šè¿”å›æœ€åˆçš„state. æœ‰æ•ˆåœ°å¡«å……åˆå§‹çŠ¶æ€æ ‘ã€‚\ndispatch(&#123; type: ActionTypes.INIT &#125; as A)\n\n\nconst store &#x3D; &#123;\n  dispatch: dispatch as Dispatch&lt;A&gt;,\n  subscribe,\n  getState,\n  replaceReducer,\n  [$$observable]: observable\n&#125; as unknown as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext\n\nreturn store &#x2F;&#x2F; storeä¸Šçš„apiæˆ‘ä»¬åˆç†Ÿæ‚‰äº†\n\n\nensureCanMutateNextListeners\n\næµ…æ‹·è´å½“å‰currentListenerså¾—åˆ° nextListeners ç”¨äº dispatching\n\nfunction ensureCanMutateNextListeners() &#123;\n  if (nextListeners &#x3D;&#x3D;&#x3D; currentListeners) &#123;\n    nextListeners &#x3D; currentListeners.slice()\n  &#125;\n&#125;\n\n\n\ngetState\n\nè·å–storeçš„çŠ¶æ€\n\nfunction getState(): S &#123;\n  if (isDispatching) &#123;\n    throw new Error(\n      &#39;You may not call store.getState() while the reducer is executing. &#39; +\n        &#39;The reducer has already received the state as an argument. &#39; +\n        &#39;Pass it down from the top reducer instead of reading it from the store.&#39;\n    )\n  &#125;\n\n  return currentState as S\n&#125;\nsubscribe\n&#x2F;**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call &#96;getState()&#96; to read the current state tree inside the callback.\n   *\n   * You may call &#96;dispatch()&#96; from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every &#96;dispatch()&#96; call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the &#96;dispatch()&#96; that is currently in progress.\n   * However, the next &#96;dispatch()&#96; call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested &#96;dispatch()&#96; before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the &#96;dispatch()&#96; started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param listener A callback to be invoked on every dispatch.\n   * @returns A function to remove this change listener.\n   *&#x2F;\n  &#x2F;&#x2F; ä¸Šè¿°æ³¨é‡Š\n  &#x2F;** æ·»åŠ ä¸€ä¸ªç›‘å¬ï¼Œåœ¨actionè¢«è§¦å‘æ—¶å€™ä¼šè°ƒç”¨ï¼Œstateä¼šè¿›è¡Œæ›´æ–°ï¼Œåœ¨å›è°ƒä¸­å¯ä»¥ç”¨getStateæ–¹æ³•è·å–å½“å‰çŠ¶æ€æ ‘\n   * ä¸¤ä¸ªæ³¨æ„ï¼šè®¢é˜…çš„æ˜¯åœ¨æ¯ä¸ªdispatchä¹‹å‰çš„å¿«ç…§ï¼Œ\n   * 1.\n   * è®¢é˜…æ˜¯åœ¨æ¯æ¬¡&#39;dispatchï¼ˆï¼‰&#39;è°ƒç”¨ä¹‹å‰è¿›è¡Œå¿«ç…§çš„ã€‚\n   * å¦‚æœåœ¨è°ƒç”¨ä¾¦å¬å™¨æ—¶è®¢é˜…æˆ–å–æ¶ˆè®¢é˜…ï¼Œè¿™å°†ä¸ä¼šå¯¹å½“å‰æ­£åœ¨è¿›è¡Œçš„â€œdispatchï¼ˆï¼‰â€äº§ç”Ÿä»»ä½•å½±å“ã€‚\n   * ä½†æ˜¯ï¼Œä¸‹ä¸€ä¸ª&#39;dispatchï¼ˆï¼‰&#39;è°ƒç”¨ï¼ˆæ— è®ºæ˜¯å¦åµŒå¥—ï¼‰å°†ä½¿ç”¨è®¢é˜…åˆ—è¡¨çš„æœ€æ–°å¿«ç…§ã€‚\n   * 2ã€‚\n   * ç›‘å¬å™¨ä¸åº”è¯¥æœŸæœ›çœ‹åˆ°æ‰€æœ‰çš„çŠ¶æ€æ›´æ”¹ï¼Œå› ä¸ºåœ¨è°ƒç”¨ç›‘å¬å™¨ä¹‹å‰ï¼ŒçŠ¶æ€å¯èƒ½åœ¨åµŒå¥—çš„&#39;dispatchï¼ˆï¼‰&#39;æœŸé—´è¢«å¤šæ¬¡æ›´æ–°ã€‚\n   * ä½†æ˜¯ï¼Œå¯ä»¥ä¿è¯åœ¨â€œdispatchï¼ˆï¼‰â€å¯åŠ¨ä¹‹å‰æ³¨å†Œçš„æ‰€æœ‰è®¢é˜…è€…åœ¨é€€å‡ºæ—¶éƒ½å°†ä»¥æœ€æ–°çŠ¶æ€è°ƒç”¨ã€‚\n   * *&#x2F;\n  function subscribe(listener: () &#x3D;&gt; void) &#123;\n    if (typeof listener !&#x3D;&#x3D; &#39;function&#39;) &#123;\n      throw new Error(\n        &#96;Expected the listener to be a function. Instead, received: &#39;$&#123;kindOf(\n          listener\n        )&#125;&#39;&#96;\n      )\n    &#125;\n\n    if (isDispatching) &#123;\n      throw new Error(\n        &#39;You may not call store.subscribe() while the reducer is executing. &#39; +\n          &#39;If you would like to be notified after the store has been updated, subscribe from a &#39; +\n          &#39;component and invoke store.getState() in the callback to access the latest state. &#39; +\n          &#39;See https:&#x2F;&#x2F;redux.js.org&#x2F;api&#x2F;store#subscribelistener for more details.&#39;\n      )\n    &#125;\n\n    let isSubscribed &#x3D; true\n\n    ensureCanMutateNextListeners()\n    nextListeners.push(listener) &#x2F;&#x2F; å¢åŠ \n\n    return function unsubscribe() &#123;\n      if (!isSubscribed) &#123;\n        return\n      &#125;\n\n      if (isDispatching) &#123;\n        throw new Error(\n          &#39;You may not unsubscribe from a store listener while the reducer is executing. &#39; +\n            &#39;See https:&#x2F;&#x2F;redux.js.org&#x2F;api&#x2F;store#subscribelistener for more details.&#39;\n        )\n      &#125;\n\n      isSubscribed &#x3D; false\n\n      ensureCanMutateNextListeners()\n      const index &#x3D; nextListeners.indexOf(listener)\n      nextListeners.splice(index, 1) &#x2F;&#x2F; ç§»é™¤\n      currentListeners &#x3D; null\n    &#125;\n  &#125;\n\ndispatch\n&#x2F;**\n * Dispatches an action. It is the only way to trigger a state change.\n *\n * The &#96;reducer&#96; function, used to create the store, will be called with the\n * current state tree and the given &#96;action&#96;. Its return value will\n * be considered the **next** state of the tree, and the change listeners\n * will be notified.\n *\n * The base implementation only supports plain object actions. If you want to\n * dispatch a Promise, an Observable, a thunk, or something else, you need to\n * wrap your store creating function into the corresponding middleware. For\n * example, see the documentation for the &#96;redux-thunk&#96; package. Even the\n * middleware will eventually dispatch plain object actions using this method.\n *\n * @param action A plain object representing â€œwhat changedâ€. It is\n * a good idea to keep actions serializable so you can record and replay user\n * sessions, or use the time travelling &#96;redux-devtools&#96;. An action must have\n * a &#96;type&#96; property which may not be &#96;undefined&#96;. It is a good idea to use\n * string constants for action types.\n *\n * @returns For convenience, the same action object you dispatched.\n *\n * Note that, if you use a custom middleware, it may wrap &#96;dispatch()&#96; to\n * return something else (for example, a Promise you can await).\n *&#x2F;\nfunction dispatch(action: A) &#123;\n  if (!isPlainObject(action)) &#123; &#x2F;&#x2F; åªèƒ½æ˜¯ç®€å•çš„å¯¹è±¡\n    throw new Error(\n      &#96;Actions must be plain objects. Instead, the actual type was: &#39;$&#123;kindOf(\n        action\n      )&#125;&#39;. You may need to add middleware to your store setup to handle dispatching other values, such as &#39;redux-thunk&#39; to handle dispatching functions. See https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#middleware and https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-6-async-logic#using-the-redux-thunk-middleware for examples.&#96;\n    )\n  &#125;\n\n  if (typeof action.type &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;\n    throw new Error(\n      &#39;Actions may not have an undefined &quot;type&quot; property. You may have misspelled an action type string constant.&#39;\n    )\n  &#125;\n\n  if (isDispatching) &#123;\n    throw new Error(&#39;Reducers may not dispatch actions.&#39;)\n  &#125;\n\n  try &#123;\n    isDispatching &#x3D; true\n    currentState &#x3D; currentReducer(currentState, action) &#x2F;&#x2F; ä¼ å…¥å½“å‰çŠ¶æ€å’Œæ“ä½œï¼Œè¿”å›æ–°çš„çŠ¶æ€\n  &#125; finally &#123;\n    isDispatching &#x3D; false\n  &#125;\n\n  const listeners &#x3D; (currentListeners &#x3D; nextListeners) &#x2F;&#x2F; è§¦å‘æ›´æ–°\n  for (let i &#x3D; 0; i &lt; listeners.length; i++) &#123;\n    const listener &#x3D; listeners[i]\n    listener()\n  &#125;\n\n  return action\n&#125;\ncombineReducers\nä½¿ç”¨æ—¶å€™ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨\n\nä½¿ç”¨\nimport useInfoReducer from &#39;.&#x2F;userInfo&#39;\nimport recordReducer from &#39;.&#x2F;record&#39;\n\nconst rootReducer &#x3D; combineReducers(&#123;\n  useInfoReducer,\n  recordReducer\n&#125;)\n\nconst store &#x3D; createStore(rootReducer)\n\næºç \n\nè¿”å›ä¸æœŸæœ›çš„stateå‹è­¦å‘Šä¿¡æ¯\n\nfunction getUnexpectedStateShapeWarningMessage(\n  inputState: object,\n  reducers: ReducersMapObject,\n  action: Action,\n  unexpectedKeyCache: &#123; [key: string]: true &#125;\n) &#123;\n  const reducerKeys &#x3D; Object.keys(reducers)\n  const argumentName &#x3D;\n    action &amp;&amp; action.type &#x3D;&#x3D;&#x3D; ActionTypes.INIT\n      ? &#39;preloadedState argument passed to createStore&#39;\n      : &#39;previous state received by the reducer&#39;\n\n  if (reducerKeys.length &#x3D;&#x3D;&#x3D; 0) &#123;\n    return (\n      &#39;Store does not have a valid reducer. Make sure the argument passed &#39; +\n      &#39;to combineReducers is an object whose values are reducers.&#39;\n    )\n  &#125;\n\n  if (!isPlainObject(inputState)) &#123;\n    return (\n      &#96;The $&#123;argumentName&#125; has unexpected type of &quot;$&#123;kindOf(\n        inputState\n      )&#125;&quot;. Expected argument to be an object with the following &#96; +\n      &#96;keys: &quot;$&#123;reducerKeys.join(&#39;&quot;, &quot;&#39;)&#125;&quot;&#96;\n    )\n  &#125;\n\n  const unexpectedKeys &#x3D; Object.keys(inputState).filter(\n    key &#x3D;&gt; !reducers.hasOwnProperty(key) &amp;&amp; !unexpectedKeyCache[key]\n  )\n\n  unexpectedKeys.forEach(key &#x3D;&gt; &#123;\n    unexpectedKeyCache[key] &#x3D; true\n  &#125;)\n\n  if (action &amp;&amp; action.type &#x3D;&#x3D;&#x3D; ActionTypes.REPLACE) return\n\n  if (unexpectedKeys.length &gt; 0) &#123;\n    return (\n      &#96;Unexpected $&#123;unexpectedKeys.length &gt; 1 ? &#39;keys&#39; : &#39;key&#39;&#125; &#96; +\n      &#96;&quot;$&#123;unexpectedKeys.join(&#39;&quot;, &quot;&#39;)&#125;&quot; found in $&#123;argumentName&#125;. &#96; +\n      &#96;Expected to find one of the known reducer keys instead: &#96; +\n      &#96;&quot;$&#123;reducerKeys.join(&#39;&quot;, &quot;&#39;)&#125;&quot;. Unexpected keys will be ignored.&#96;\n    )\n  &#125;\n&#125;\n &#x2F;&#x2F; å¯¹ reducerå‹è¿›è¡Œæ–­è¨€\nfunction assertReducerShape(reducers: ReducersMapObject) &#123;\n  Object.keys(reducers).forEach(key &#x3D;&gt; &#123;\n    const reducer &#x3D; reducers[key]\n    const initialState &#x3D; reducer(undefined, &#123; type: ActionTypes.INIT &#125;)\n\n    if (typeof initialState &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;\n      throw new Error(\n         &#x2F;&#x2F; åˆå§‹åŒ–initialStateæ—¶å€™å¯ä»¥ç”¨null,ä½†æ˜¯ä¸å¯ä»¥ç”¨undefined\n        &#96;The slice reducer for key &quot;$&#123;key&#125;&quot; returned undefined during initialization. &#96; +\n          &#96;If the state passed to the reducer is undefined, you must &#96; +\n          &#96;explicitly return the initial state. The initial state may &#96; +\n          &#96;not be undefined. If you don&#39;t want to set a value for this reducer, &#96; +\n          &#96;you can use null instead of undefined.&#96;\n      )\n    &#125;\n\n    if (\n      typeof reducer(undefined, &#123;\n        type: ActionTypes.PROBE_UNKNOWN_ACTION()\n      &#125;) &#x3D;&#x3D;&#x3D; &#39;undefined&#39;\n    ) &#123;\n      throw new Error( \n        &#x2F;&#x2F; 1.éšæœºç±»å‹&#x2F; redux&#x2F;*ç±»å‹ çš„æ“ä½œç±»å‹ä¸ºreduxç§æœ‰ï¼Œä¸å…è®¸ä½¿ç”¨ \n        &#x2F;&#x2F; 2.åˆå§‹åŒ–çŠ¶æ€ä¸å¯ä»¥æ˜¯undefined, \n        &#x2F;&#x2F; 3.æ–°çŠ¶æ€å¦‚æœæ˜¯undefinedçš„ï¼Œå¿…é¡»è¿”å›åˆå§‹çŠ¶æ€\n        &#96;The slice reducer for key &quot;$&#123;key&#125;&quot; returned undefined when probed with a random type. &#96; +\n          &#96;Don&#39;t try to handle &#39;$&#123;ActionTypes.INIT&#125;&#39; or other actions in &quot;redux&#x2F;*&quot; &#96; +\n          &#96;namespace. They are considered private. Instead, you must return the &#96; +\n          &#96;current state for any unknown actions, unless it is undefined, &#96; +\n          &#96;in which case you must return the initial state, regardless of the &#96; +\n          &#96;action type. The initial state may not be undefined, but can be null.&#96;\n      )\n    &#125;\n  &#125;)\n&#125;\n\n&#x2F;&#x2F; combineReducersçš„å®ç°ï¼Œå…¶å®å°±æ˜¯å°†å¤šä¸ªå€¼ï¼Œåˆå¹¶åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­\nexport default function combineReducers(reducers: ReducersMapObject) &#123;\n  const reducerKeys &#x3D; Object.keys(reducers)\n  const finalReducers: ReducersMapObject &#x3D; &#123;&#125;\n  for (let i &#x3D; 0; i &lt; reducerKeys.length; i++) &#123;\n    const key &#x3D; reducerKeys[i]\n\n    if (typeof reducers[key] &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;\n      finalReducers[key] &#x3D; reducers[key]\n    &#125;\n  &#125;\n  const finalReducerKeys &#x3D; Object.keys(finalReducers)\n\n  &#x2F;&#x2F; This is used to make sure we don&#39;t warn about the same\n  &#x2F;&#x2F; keys multiple times.\n  &#x2F;&#x2F;è¿™ç”¨äºç¡®ä¿æˆ‘ä»¬ä¸ä¼šå¤šæ¬¡è­¦å‘Šç›¸åŒçš„keyã€‚\n  let unexpectedKeyCache: &#123; [key: string]: true &#125;\n\n  return function combination(\n    state: StateFromReducersMapObject&lt;typeof reducers&gt; &#x3D; &#123;&#125;,\n    action: AnyAction\n  ) &#123;\n    &#x2F;&#x2F;æ ¡éªŒä¿¡æ¯...\n\n    let hasChanged &#x3D; false\n    const nextState: StateFromReducersMapObject&lt;typeof reducers&gt; &#x3D; &#123;&#125;\n    for (let i &#x3D; 0; i &lt; finalReducerKeys.length; i++) &#123;\n      const key &#x3D; finalReducerKeys[i]\n      &#x2F;&#x2F; reducer\n      const reducer &#x3D; finalReducers[key]\n      &#x2F;&#x2F; ä¹‹å‰çŠ¶æ€\n      const previousStateForKey &#x3D; state[key]\n      &#x2F;&#x2F; æ–°çŠ¶æ€\n      const nextStateForKey &#x3D; reducer(previousStateForKey, action)\n\n\n\n      if (typeof nextStateForKey &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;\n        const actionType &#x3D; action &amp;&amp; action.type\n        throw new Error(\n          &#96;When called with an action of type $&#123;\n            actionType ? &#96;&quot;$&#123;String(actionType)&#125;&quot;&#96; : &#39;(unknown type)&#39;\n          &#125;, the slice reducer for key &quot;$&#123;key&#125;&quot; returned undefined. &#96; +\n            &#96;To ignore an action, you must explicitly return the previous state. &#96; +\n            &#96;If you want this reducer to hold no value, you can return null instead of undefined.&#96;\n        )\n      &#125;\n      nextState[key] &#x3D; nextStateForKey\n      &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦å‘ç”Ÿæ›´æ–°\n      hasChanged &#x3D; hasChanged || nextStateForKey !&#x3D;&#x3D; previousStateForKey\n    &#125;\n    hasChanged &#x3D;\n      hasChanged || finalReducerKeys.length !&#x3D;&#x3D; Object.keys(state).length\n      &#x2F;&#x2F; æ›´æ–°è¿”å›æ–°çš„çŠ¶æ€ï¼Œå¦åˆ™è¿”å›ä¹‹å‰çŠ¶æ€\n    return hasChanged ? nextState : state\n  &#125;\n&#125;\n\n\nbindActionCreators\nç»™actionåŒ…è£¹å±‚dispatch\nactionæœ‰ä¸¤ç§ç±»å‹ï¼š å‡½æ•°ã€é”®å€¼å¯¹\n\nexport default function bindActionCreators(\n  actionCreators: ActionCreator&lt;any&gt; | ActionCreatorsMapObject,\n  dispatch: Dispatch\n) &#123;\n  &#x2F;&#x2F; å‡½æ•°ç±»å‹ç›´æ¥bindActionCreatorè¿”å›\n  if (typeof actionCreators &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;\n    return bindActionCreator(actionCreators, dispatch)\n  &#125;\n\n  if (typeof actionCreators !&#x3D;&#x3D; &#39;object&#39; || actionCreators &#x3D;&#x3D;&#x3D; null) &#123;\n    throw new Error(\n      &#96;bindActionCreators expected an object or a function, but instead received: &#39;$&#123;kindOf(\n        actionCreators\n      )&#125;&#39;. &#96; +\n        &#96;Did you write &quot;import ActionCreators from&quot; instead of &quot;import * as ActionCreators from&quot;?&#96;\n    )\n  &#125;\n\n  const boundActionCreators: ActionCreatorsMapObject &#x3D; &#123;&#125;\n  &#x2F;&#x2F; å¯¹è±¡éå†è°ƒç”¨bindActionCreator\n  for (const key in actionCreators) &#123;\n    const actionCreator &#x3D; actionCreators[key]\n    if (typeof actionCreator &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;\n      boundActionCreators[key] &#x3D; bindActionCreator(actionCreator, dispatch)\n    &#125;\n  &#125;\n  return boundActionCreators\n&#125;\nä½¿ç”¨åŠæµ‹è¯•ä»£ç è§\nredux/test/typescript/actionCreators.ts\nbindActionCreator\n&#x2F;&#x2F; ä½œç”¨æ˜¯æ¯ä¸ªactionCreatorå¢åŠ ä¸€ä¸ªdispatchåŒ…è£¹\nfunction bindActionCreator&lt;A extends AnyAction &#x3D; AnyAction&gt;(\n  actionCreator: ActionCreator&lt;A&gt;,\n  dispatch: Dispatch\n) &#123;\n  return function (this: any, ...args: any[]) &#123;\n    return dispatch(actionCreator.apply(this, args)) &#x2F;&#x2F; ä¸»è¦ä»£ç \n  &#125;\n&#125;\n\n\n\n\napplyMiddleware\nä¸­é—´ä»¶\nå¯¹storeèƒ½åŠ›è¿›è¡Œå¢å¼º\n\nexport default function applyMiddleware(\n  ...middlewares: Middleware[]\n): StoreEnhancer&lt;any&gt; &#123;\n  return (createStore: StoreEnhancerStoreCreator) &#x3D;&gt;\n    &lt;S, A extends AnyAction&gt;(\n      reducer: Reducer&lt;S, A&gt;,\n      preloadedState?: PreloadedState&lt;S&gt;\n    ) &#x3D;&gt; &#123;\n      const store &#x3D; createStore(reducer, preloadedState)\n\n\n      &#x2F;&#x2F; å£°æ˜\n      let dispatch: Dispatch &#x3D; () &#x3D;&gt; &#123;\n        throw new Error(\n          &#39;Dispatching while constructing your middleware is not allowed. &#39; +\n            &#39;Other middleware would not be applied to this dispatch.&#39;\n        )\n      &#125;\n\n      const middlewareAPI: MiddlewareAPI &#x3D; &#123;\n        getState: store.getState,\n                                      &#x2F;&#x2F;ä½¿ç”¨ä¸Šè¿°å‡½æ•°è¿›è¡Œ\n        dispatch: (action, ...args) &#x3D;&gt; dispatch(action, ...args)\n      &#125;\n      &#x2F;&#x2F; ä¸­é—´ä»¶æ•°ç»„\n      const chain &#x3D; middlewares.map(middleware &#x3D;&gt; middleware(middlewareAPI))\n\n\n      &#x2F;&#x2F; å¢å¼ºçš„æ˜¯dispatch\n      dispatch &#x3D; compose&lt;typeof dispatch&gt;(...chain)(store.dispatch)\n\n      return &#123;\n        ...store,\n        dispatch\n      &#125;\n    &#125;\n&#125;\n\n\n&#96;&#96;&#96;ts\n\n      const chain &#x3D; middlewares.map(middleware &#x3D;&gt; middleware(middlewareAPI))\n      \n      dispatch &#x3D; compose&lt;typeof dispatch&gt;(...chain)(store.dispatch)\n\n      return &#123;\n        ...store,\n        dispatch\n      &#125;\n    &#125;\n&#125;\n\ncompose\næ´‹è‘±æ¨¡å‹\n\nä½¿ç”¨\ncompose(f, g, h)\n(...args) &#x3D;&gt; f(g(h(...args)))\n\næºç \nexport default function compose(...funcs: Function[]) &#123;\n  &#x2F;&#x2F; å‚æ•°é•¿åº¦åˆ¤æ–­\n  if (funcs.length &#x3D;&#x3D;&#x3D; 0) &#123;\n    &#x2F;&#x2F; infer the argument type so it is usable in inference down the line\n    return &lt;T&gt;(arg: T) &#x3D;&gt; arg\n  &#125;\n  &#x2F;&#x2F; é•¿åº¦ä¸º1\n  if (funcs.length &#x3D;&#x3D;&#x3D; 1) &#123;\n    return funcs[0]\n  &#125;\n  &#x2F;&#x2F; ä¸»è¦ä»£ç ä¸€è¡Œ\n  return funcs.reduce((a, b) &#x3D;&gt; (...args: any) &#x3D;&gt;  a(b(...args)))\n&#125;\n\nè®²composeçš„æ–‡ç« \nè¿™é‡Œæœ‰ä¸€ç¯‡éå¸¸å¥½\n__DO_NOT_USE__ActionTypes\nä¸€äº›ç§æœ‰çš„actionè¢«reduxä¿ç•™ï¼Œå¯¹äºä¸æ˜ç¡®çš„actionï¼Œå¿…é¡»è¿”å›å½“å‰state.\nå¦‚æœå½“å‰çŠ¶æ€æ˜¯undefined,å¿…é¡»è¿”å›åˆå§‹çŠ¶æ€\nä¸è¦åœ¨ä»£ç ä¸­ç›´æ¥æ¶‰åŠè¿™äº›action\n\nconst ActionTypes &#x3D; &#123;\n  INIT: &#96;@@redux&#x2F;INIT$&#123;&#x2F;* #__PURE__ *&#x2F; randomString()&#125;&#96;,\n  REPLACE: &#96;@@redux&#x2F;REPLACE$&#123;&#x2F;* #__PURE__ *&#x2F; randomString()&#125;&#96;,\n  PROBE_UNKNOWN_ACTION: () &#x3D;&gt; &#96;@@redux&#x2F;PROBE_UNKNOWN_ACTION$&#123;randomString()&#125;&#96;\n&#125;\n\n\næ€»ç»“\n\nå›é¡¾\nå·©å›º\nå‚è€ƒæœ€ç²¾ç®€çš„Reduxæºç è§£æï¼Œçœ‹å®Œä»æ­¤å†ä¹Ÿä¸æ€•é¢è¯•å®˜Redux æºç è§£ægithub æºç \n","slug":"2022-05-25.redux2","date":"2022-05-25T13:32:54.000Z","categories_index":"redux","tags_index":"redux,æºç ","author_index":"é™ˆæµ·é¾™"},{"id":"af1b42282a210ca45f834a49b50349c6","title":"redux æºç  1","content":"ä»‹ç»A Predictable State Container for JS Apps\npackage.json&#123;\n  &quot;name&quot;: &quot;redux&quot;,\n  &quot;version&quot;: &quot;5.0.0-alpha.0&quot;,\n  &quot;description&quot;: &quot;Predictable state container for JavaScript apps&quot;,\n\n\n  &quot;keywords&quot;: [\n    &quot;redux&quot;,\n    &quot;reducer&quot;,  &#x2F;&#x2F; reducer, reduxæ„æˆç»„æˆä¹‹ä¸€\n    &quot;state&quot;,    &#x2F;&#x2F; çŠ¶æ€ç®¡ç†\n    &quot;predictable&quot;,   &#x2F;&#x2F; å¯é¢„æµ‹çš„\n    &quot;functional&quot;,    &#x2F;&#x2F; çº¯å‡½æ•°çš„\n    &quot;immutable&quot;,     &#x2F;&#x2F; ä¸å¯å˜çš„\n    &quot;hot&quot;,\n    &quot;live&quot;,\n    &quot;replay&quot;,        &#x2F;&#x2F; å›æ”¾\n    &quot;flux&quot;,          &#x2F;&#x2F; reduxå¯¹fluxçš„æ”¹è¿›\n    &quot;elm&quot;            &#x2F;&#x2F; Elm æ˜¯ä¸€é—¨ä¸“æ³¨äºWebå‰ç«¯çš„çº¯å‡½æ•°å¼è¯­è¨€, reducerå—elmå¯å‘\n  ],\n\n\n  &#x2F;&#x2F; å…¥å£\n  &quot;main&quot;: &quot;lib&#x2F;redux.js&quot;,\n\n\n  &#x2F;&#x2F; unpkg æ˜¯ä¸€ä¸ªå†…å®¹æºè‡ª npm çš„å…¨çƒå¿«é€Ÿ CDN, å®ƒèƒ½ä»¥å¿«é€Ÿè€Œç®€å•çš„æ–¹å¼æä¾›ä»»æ„åŒ…ã€ä»»æ„æ–‡ä»¶ï¼Œé€šè¿‡ç±»ä¼¼è¿™æ ·çš„ URL ï¼šunpkg.com&#x2F;:package@:version&#x2F;:file\n  &#x2F;&#x2F; å½“ä½ è®¿é—®: https:&#x2F;&#x2F;unpkg.com&#x2F;redux@4.0.3&#x2F;dist&#x2F;redux.min.js æ˜¯å¯¹åº”redux@4.0.3ç‰ˆæœ¬çš„å‹ç¼©åçš„jsæ–‡ä»¶\n  &#x2F;&#x2F; å½“ä½ è®¿é—®: https:&#x2F;&#x2F;unpkg.com&#x2F;redux â€”â€”æ ¹æ®package.jsoné…ç½®çš„unpkg, é‡å®šå‘ä¸º--â€”&gt; https:&#x2F;&#x2F;unpkg.com&#x2F;redux@4.0.4&#x2F;dist&#x2F;redux.js , åšäº†ä¸¤æ¬¡é‡å®šå‘\n  &#x2F;&#x2F; å¦‚ä½•ä½ è®¿é—®: https:&#x2F;&#x2F;unpkg.com&#x2F;redux&#x2F; (æ³¨æ„reduxåæœ‰&#x2F;), æ˜¯ä¸€ä¸ªé¡µé¢\n  &quot;unpkg&quot;: &quot;dist&#x2F;redux.js&quot;, &#x2F;&#x2F; ç”¨unpkgçš„è£¸urlè®¿é—®æ—¶, æŒ‡å®šåˆ°è¯¥æ–‡ä»¶\n\n\n  &#x2F;**\n    module\n      ç‚¹å‡» Setting up multi-platform npm packages æŸ¥çœ‹ç›¸å…³ä»‹ç»ã€‚\n\n      å°±åƒ main å­—æ®µä¸€æ ·ï¼Œå®šä¹‰ä¸€ä¸ªé’ˆå¯¹ es6 æ¨¡å—åŠè¯­æ³•çš„å…¥å£æ–‡ä»¶ã€‚\n\n      æ„å»ºå·¥å…·åœ¨æ„å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°äº†è¿™ä¸ªå­—æ®µï¼Œä¼šé¦–å…ˆä½¿ç”¨è¿™ä¸ªå­—æ®µæŒ‡å‘çš„æ–‡ä»¶ï¼Œå¦‚æœæœªå®šä¹‰ï¼Œåˆ™å›é€€åˆ° main å­—æ®µæŒ‡å‘çš„æ–‡ä»¶ã€‚\n\n      æ”¯æŒçš„å·¥å…·ï¼š\n\n      rollup\n      webpack\n  **&#x2F;\n  &quot;module&quot;: &quot;es&#x2F;redux.js&quot;,\n\n\n\n&#x2F;&#x2F; TypeScriptæ˜¯javascript çš„è¶…é›†, typings&#x2F;typeså­—æ®µ, å®šä¹‰äº†TypeScriptçš„å…¥å£æ–‡ä»¶\n  &quot;types&quot;: &quot;types&#x2F;index.d.ts&quot;,\n\n\n\n  &#x2F;&#x2F; å‘å¸ƒä¸Šä¼ å†…å®¹\n  &#x2F;&#x2F; æ˜¯ä¸€ä¸ªå¯é€‰å­—æ®µ, ç”¨æ¥æè¿°ä½œå°†è½¯ä»¶åŒ…ä½œä¸ºä¾èµ–é¡¹å®‰è£…æ—¶è¦åŒ…å«çš„æ¡ç›®, ç›¸å½“äºç™½åå•, ç±»ä¼¼.gitignoreç±»ä¼¼çš„è¯­æ³•, fileså­—æ®µä¸­åŒ…å«çš„æ–‡ä»¶ä¸èƒ½é€šè¿‡.npmignoreæˆ–.gitignoreæ’é™¤\n  &quot;files&quot;: [\n    &quot;dist&quot;,\n    &quot;lib&quot;,\n    &quot;es&quot;,\n    &quot;src&quot;,\n    &quot;types&quot;\n  ],\n  &quot;scripts&quot;: &#123;\n    ...\n  &#125;,\n  &#x2F;&#x2F; è¡¨ç¤ºåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨è¯¥ä¾èµ–, å¯¹åº” npm install xx -S æˆ– npm install xx --save\n  &quot;dependencies&quot;: &#123;\n    &quot;@babel&#x2F;runtime&quot;: &quot;^7.16.7&quot;\n  &#125;,\n  &#x2F;&#x2F; è¡¨ç¤ºä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨, ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨çš„ä¾èµ–, å¯¹åº” npm install xx -D æˆ– npm install xx --save-dev\n  &quot;devDependencies&quot;: &#123;\n   ...\n  &#125;,\n  &quot;npmName&quot;: &quot;redux&quot;,\n\n\n  &#x2F;&#x2F; npmæ–‡ä»¶æ˜ å°„ã€‚æŠŠéœ€è¦åŒæ­¥åˆ° cdnjs çš„æ–‡ä»¶é…ç½®åœ¨è¿™é‡Œã€‚\n  &quot;npmFileMap&quot;: [\n    &#123;\n      &quot;basePath&quot;: &quot;&#x2F;dist&#x2F;&quot;,\n      &quot;files&quot;: [\n        &quot;*.js&quot;\n      ]\n    &#125;\n  ],\n\n  &#x2F;&#x2F; webpackç›¸å…³å­—æ®µ, å£°æ˜è¯¥æ¨¡å—æ˜¯å¦åŒ…å« sideEffectsï¼ˆå‰¯ä½œç”¨ï¼‰ï¼Œä»è€Œå¯ä»¥ä¸º tree-shaking æä¾›æ›´å¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚\n  &quot;sideEffects&quot;: false\n&#125;\n\nversionå­—æ®µåŒ…çš„ç‰ˆæœ¬, å¿…é¡»æœ‰, è¦ç¬¦åˆsemantic versioning guidelines, å‚è€ƒ è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ, å»ºè®®ä»”ç»†é€šè¯»\nå‚è€ƒé…åˆreduxé¡¹ç›®æ·±åº¦äº†è§£package.jsonsemantic versioning guidelinesè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ\næºç ç›®å½•.\nâ”œâ”€â”€ applyMiddleware.ts\nâ”œâ”€â”€ bindActionCreators.ts\nâ”œâ”€â”€ combineReducers.ts\nâ”œâ”€â”€ compose.ts\nâ”œâ”€â”€ createStore.ts\nâ”œâ”€â”€ index.ts\nâ”œâ”€â”€ types\nâ”‚   â”œâ”€â”€ actions.ts\nâ”‚   â”œâ”€â”€ middleware.ts\nâ”‚   â”œâ”€â”€ reducers.ts\nâ”‚   â””â”€â”€ store.ts\nâ””â”€â”€ utils\n    â”œâ”€â”€ actionTypes.ts\n    â”œâ”€â”€ formatProdErrorMessage.ts\n    â”œâ”€â”€ isPlainObject.ts\n    â”œâ”€â”€ kindOf.ts\n    â”œâ”€â”€ symbol-observable.ts\n    â””â”€â”€ warning.ts\n\n2 directories, 16 files\n\nindex.tsexport &#123;\n  createStore,\n  combineReducers,\n  bindActionCreators,\n  applyMiddleware,\n  compose,\n  __DO_NOT_USE__ActionTypes\n&#125;","slug":"2022-05-25.redux","date":"2022-05-25T05:48:17.000Z","categories_index":"redux","tags_index":"redux,æºç ","author_index":"é™ˆæµ·é¾™"},{"id":"d512c56f4cbf1792b4d8bab0668985ad","title":"react-redux  æºç 2","content":"æºç ç‰ˆæœ¬&quot;version&quot;: &quot;8.0.2&quot;,\nProvider\nä¸»è¦ä½œç”¨é€šè¿‡subscriptionè°ƒç”¨reduxä¸­storeçš„subscriptionäº§ç”Ÿè®¢é˜…ï¼Œè®¢é˜…å†…å®¹æ˜¯onStateChangeçš„å›è°ƒ\né€šè¿‡reactçš„ProvideråŠŸèƒ½ï¼Œæä¾›ä¼ é€’ç»™æ ¹çš„storeå’Œæ ¹çš„subscriptionç»™åç»­ä½¿ç”¨äº†connectçš„ç»„ä»¶\n\n&#x2F;* provider ç»„ä»¶ä»£ç  *&#x2F;\nfunction Provider(&#123; store, context, children &#125;) &#123;\n   &#x2F;* åˆ©ç”¨useMemoï¼Œè·Ÿæ®storeå˜åŒ–åˆ›å»ºå‡ºä¸€ä¸ªcontextValue åŒ…å«ä¸€ä¸ªæ ¹å…ƒç´ è®¢é˜…å™¨å’Œå½“å‰store  *&#x2F; \n  const contextValue &#x3D; useMemo(() &#x3D;&gt; &#123;\n      &#x2F;* åˆ›å»ºäº†ä¸€ä¸ªæ ¹ Subscription è®¢é˜…å™¨ *&#x2F;\n    const subscription &#x3D; new Subscription(store)\n    &#x2F;* subscription çš„ notifyNestedSubs æ–¹æ³• ï¼Œèµ‹å€¼ç»™  onStateChangeæ–¹æ³• *&#x2F;\n    &#x2F;&#x2F;onStateChangeå°±æ˜¯ä¹‹åè§¦å‘çš„listenr\n    subscription.onStateChange &#x3D; subscription.notifyNestedSubs  \n    return &#123;\n      store,\n      subscription\n    &#125; &#x2F;*  store æ”¹å˜åˆ›å»ºæ–°çš„contextValue *&#x2F;\n  &#125;, [store])\n  &#x2F;*  è·å–æ›´æ–°ä¹‹å‰çš„stateå€¼ ï¼Œå‡½æ•°ç»„ä»¶é‡Œé¢çš„ä¸Šä¸‹æ–‡è¦ä¼˜å…ˆäºç»„ä»¶æ›´æ–°æ¸²æŸ“  *&#x2F;\n  const previousState &#x3D; useMemo(() &#x3D;&gt; store.getState(), [store])\n\n  useEffect(() &#x3D;&gt; &#123;\n    const &#123; subscription &#125; &#x3D; contextValue\n    &#x2F;* è§¦å‘trySubscribeæ–¹æ³•æ‰§è¡Œï¼Œåˆ›å»ºlistens *&#x2F;\n    subscription.trySubscribe() &#x2F;&#x2F; å‘èµ·è®¢é˜…\n    if (previousState !&#x3D;&#x3D; store.getState()) &#123;\n        &#x2F;* ç»„ä»¶æ›´æ–°æ¸²æŸ“ä¹‹åï¼Œå¦‚æœæ­¤æ—¶stateå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆç«‹å³è§¦å‘ subscription.notifyNestedSubs æ–¹æ³•  *&#x2F;\n        &#x2F;&#x2F;è§¦å‘æ‰€æœ‰çš„listener\n      subscription.notifyNestedSubs() \n    &#125;\n    &#x2F;*   *&#x2F;\n    return () &#x3D;&gt; &#123;\n      subscription.tryUnsubscribe()  &#x2F;&#x2F; å¸è½½è®¢é˜…\n      subscription.onStateChange &#x3D; null\n    &#125;\n    &#x2F;*  contextValue state æ”¹å˜å‡ºå‘æ–°çš„ effect *&#x2F;\n  &#125;, [contextValue, previousState])\n\n  &#x2F;&#x2F;è‹¥Provideræ²¡æœ‰æ˜¾ç¤ºä¼ å…¥contextï¼Œåˆ™ä¸ºä½¿ç”¨React.createContextåˆ›å»ºçš„ä¸Šä¸‹æ–‡\n  const Context &#x3D; context || ReactReduxContext\n\n  return &lt;Context.Provider value&#x3D;&#123;contextValue&#125;&gt;&#123;children&#125;&lt;&#x2F;Context.Provider&gt;\n&#125;\n\nSubscription\nè®¢é˜…æ¶ˆæ¯ã€å‘èµ·æ›´æ–°\nåœ¨æ ¹çš„Providerçš„ä½œç”¨æ˜¯è°ƒç”¨reduxä¸­storeçš„è®¢é˜…æ–¹æ³•ï¼Œå°†æ ¹çš„onStateChangeè¿›è¡Œè®¢é˜…\nåœ¨å­ä»£ä¸­æ˜¯æ”¶é›†æ‰€æœ‰è¢« connect åŒ…è£¹çš„ç»„ä»¶ä¸­çš„Subscriptionçš„æ›´æ–°å‡½æ•° onstatechangeï¼Œç„¶åå½¢æˆä¸€ä¸ª callback é“¾è¡¨ï¼Œå†ç”±çˆ¶çº§ Subscription ç»Ÿä¸€æ´¾å‘æ‰§è¡Œæ›´æ–°ï¼Œåªä¼šå¾€ä¸Šä¼ é€’ä¸€å±‚ï¼Œä¸ä¼šä¸€ç›´ä¼ é€’ä½¿å¾—æ¯ä¸€ä¸ªä¸Šçº§éƒ½æœ‰è‡ªèº«çš„æ›´æ–°å‡½æ•°\n\n&#x2F;* å‘å¸ƒè®¢é˜…è€…æ¨¡å¼ *&#x2F;\nexport default class Subscription &#123;\n  constructor(store, parentSub) &#123;\n    this.store &#x3D; store\n    this.parentSub &#x3D; parentSub\n    this.unsubscribe &#x3D; null\n    this.listeners &#x3D; nullListeners\n\n    this.handleChangeWrapper &#x3D; this.handleChangeWrapper.bind(this)\n  &#125;\n  &#x2F;* è´Ÿè´£æ£€æµ‹æ˜¯å¦è¯¥ç»„ä»¶è®¢é˜…ï¼Œç„¶åæ·»åŠ è®¢é˜…è€…ä¹Ÿå°±æ˜¯listener *&#x2F;  \n  &#x2F;&#x2F;å½“çˆ¶ä»£è°ƒç”¨è¿‡trySubscribeåï¼Œå­ä»£å†è°ƒç”¨ï¼Œå› ä¸ºthis.unsubscribeæœ‰å€¼ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå®é™…æ‰§è¡Œçˆ¶ä»£çš„trySubscribeï¼Œè€Œåªæ˜¯å°†listeneræ”¾è¿›çˆ¶ä»£ä¸­ç®¡ç†\n  addNestedSub(listener) &#123;\n    this.trySubscribe()\n    return this.listeners.subscribe(listener)\n  &#125;\n  &#x2F;* å‘listenerså‘å¸ƒé€šçŸ¥ *&#x2F;\n  notifyNestedSubs() &#123;\n    this.listeners.notify()\n  &#125;\n  &#x2F;* å¯¹äº Provide onStateChange å°±æ˜¯ notifyNestedSubs æ–¹æ³•ï¼Œ\n  å¯¹äº connect åŒ…è£¹æ¥å—æ›´æ–°çš„ç»„ä»¶ ï¼ŒonStateChange å°±æ˜¯ è´Ÿè´£æ›´æ–°ç»„ä»¶çš„å‡½æ•° ã€‚   *&#x2F;\n  handleChangeWrapper() &#123;\n    if (this.onStateChange) &#123;\n      this.onStateChange()\n    &#125;\n  &#125;\n   &#x2F;* åˆ¤æ–­æœ‰æ²¡æœ‰å¼€å¯è®¢é˜… *&#x2F;\n  isSubscribed() &#123;\n    return Boolean(this.unsubscribe)\n  &#125;\n  &#x2F;* å¼€å¯è®¢é˜…æ¨¡å¼ é¦–å…ˆåˆ¤æ–­å½“å‰è®¢é˜…å™¨æœ‰æ²¡æœ‰çˆ¶çº§è®¢é˜…å™¨ ï¼Œ å¦‚æœæœ‰çˆ¶çº§è®¢é˜…å™¨(å°±æ˜¯çˆ¶çº§Subscription)ï¼ŒæŠŠè‡ªå·±çš„handleChangeWrapperæ”¾å…¥åˆ°ç›‘å¬è€…é“¾è¡¨ä¸­ *&#x2F;\n  trySubscribe() &#123;\n    &#x2F;*\n    \tparentSubå³æ˜¯provide value é‡Œé¢çš„ Subscription è¿™é‡Œå¯ä»¥ç†è§£ä¸º çˆ¶çº§å…ƒç´ çš„ Subscription\n    *&#x2F;\n    &#x2F;&#x2F;å½“Subscriptionæ‰§è¡Œè¿‡ä¸€æ¬¡æ”¹æ–¹æ³•åï¼Œå†è°ƒç”¨å› ä¸ºthis.unsubscribeæœ‰å€¼\n    &#x2F;&#x2F;æ‰€ä»¥è¯¥æ–¹æ³•è°ƒç”¨ä¸€æ¬¡åå°±ä¸ä¼šå†è¢«è°ƒç”¨äº†\n    &#x2F;&#x2F;æ„å‘³ç€addNestedSubä¸­åªä¼šæ·»åŠ listenerï¼Œè€Œä¸ä¼šå†è°ƒç”¨trySubscribeï¼Œä½¿å¾—listenerä¸ä¼šå¾€ä¸Šä¼ é€’\n    if (!this.unsubscribe) &#123;\n      this.unsubscribe &#x3D; this.parentSub\n        ? this.parentSub.addNestedSub(this.handleChangeWrapper)\n        &#x2F;* providerçš„Subscriptionæ˜¯ä¸å­˜åœ¨parentSubï¼Œæ‰€ä»¥æ­¤æ—¶trySubscribe å°±ä¼šè°ƒç”¨ store.subscribe   *&#x2F;\n        : this.store.subscribe(this.handleChangeWrapper)\n      this.listeners &#x3D; createListenerCollection()\n    &#125;\n  &#125;\n  &#x2F;* å–æ¶ˆè®¢é˜… *&#x2F;\n  tryUnsubscribe() &#123;\n    if (this.unsubscribe) &#123;\n      this.unsubscribe()\n      this.unsubscribe &#x3D; null\n      this.listeners.clear()\n\n      this.listeners &#x3D; nullListeners\n    &#125;\n  &#125;\n&#125;\n\n\n\né¦–å…ˆProvideråˆ›å»º Subscription æ—¶å€™æ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±è¯´æ˜provider ä¸­çš„Subscription ä¸å­˜åœ¨ parentSub ã€‚\né‚£ä¹ˆå†è°ƒç”¨Providerç»„ä»¶ä¸­useEffecté’©å­ä¸­trySubscribeçš„æ—¶å€™,ä¼šè§¦å‘this.store.subscribe , subscribe å°±æ˜¯ redux çš„ subscribe ,æ­¤æ—¶çœŸæ­£å‘èµ·äº†è®¢é˜…\nè®¢é˜…çš„å†…å®¹æ˜¯notifyNestedSubsï¼Œå³é€šçŸ¥æ ¹ç®¡ç†çš„listenersè§¦å‘subscription.onStateChange &#x3D; subscription.notifyNestedSubs \n\n&#x2F;* å‘listenerså‘å¸ƒé€šçŸ¥ *&#x2F;\nnotifyNestedSubs() &#123;\n  this.listeners.notify()\n&#125;\n\ncreateListenerCollectioné€šè¿‡åŒå‘é“¾è¡¨çš„ç»“æ„ç®¡ç†æ¯ä¸€ä¸ªlistenerä»¥é“¾è¡¨çš„å½¢å¼æ”¶é›†å¯¹åº”çš„ listeners (æ¯ä¸€ä¸ªSubscription) çš„handleChangeWrapperå‡½æ•°å³onStateChangeã€‚é€šè¿‡ batch æ–¹æ³•( react-dom ä¸­çš„ unstable_batchedUpdates ) æ¥è¿›è¡Œæ‰¹é‡æ›´æ–°ï¼Œè®¸å°†ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­çš„æ‰€æœ‰ React æ›´æ–°éƒ½ä¸€èµ·æ‰¹é‡å¤„ç†åˆ°ä¸€ä¸ªæ¸²æŸ“è¿‡ç¨‹ä¸­ã€‚import &#123; unstable_batchedUpdates as batch &#125; from &#39;.&#x2F;utils&#x2F;reactBatchedUpdates&#39;\nsetBatch(batch)\n\n\nfunction createListenerCollection() &#123;\n   &#x2F;* batch ç”±getBatchå¾—åˆ°çš„ unstable_batchedUpdates æ–¹æ³• *&#x2F;\n  const batch &#x3D; getBatch()\n  let first &#x3D; null\n  let last &#x3D; null\n\n  return &#123;\n    &#x2F;* æ¸…é™¤å½“å‰listenersçš„æ‰€æœ‰listener *&#x2F;\n    clear() &#123;\n      first &#x3D; null\n      last &#x3D; null\n    &#125;,\n    &#x2F;* æ´¾å‘æ›´æ–° *&#x2F;\n    notify() &#123;\n      batch(() &#x3D;&gt; &#123;\n        let listener &#x3D; first\n        while (listener) &#123;\n          listener.callback()\n          listener &#x3D; listener.next\n        &#125;\n      &#125;)\n    &#125;,\n    &#x2F;* è·å–listenersçš„æ‰€æœ‰listener *&#x2F;\n    get() &#123;\n      let listeners &#x3D; []\n      let listener &#x3D; first\n      while (listener) &#123;\n        listeners.push(listener)\n        listener &#x3D; listener.next\n      &#125;\n      return listeners\n    &#125;,\n     &#x2F;* æ¥æ”¶è®¢é˜…ï¼Œå°†å½“å‰çš„callbackï¼ˆhandleChangeWrapperï¼‰å­˜åˆ°å½“å‰çš„é“¾è¡¨ä¸­  *&#x2F;\n    subscribe(callback) &#123;\n      let isSubscribed &#x3D; true\n\n      let listener &#x3D; (last &#x3D; &#123;\n        callback,\n        next: null,\n        prev: last &#x2F;&#x2F;é¦–æ¬¡lastä¸ºç©º\n      &#125;)\n\t   \t\n      if (listener.prev) &#123;\n        listener.prev.next &#x3D; listener\n      &#125; else &#123;\n        first &#x3D; listener\n      &#125;\n      &#x2F;* å–æ¶ˆå½“å‰ handleChangeWrapper çš„è®¢é˜…*&#x2F;\n      return function unsubscribe() &#123;\n        if (!isSubscribed || first &#x3D;&#x3D;&#x3D; null) return\n        isSubscribed &#x3D; false\n\t\t\n\t\t&#x2F;&#x2F;åŒå‘é“¾è¡¨åˆ é™¤èŠ‚ç‚¹çš„æ“ä½œ\n        if (listener.next) &#123;\n          listener.next.prev &#x3D; listener.prev\n        &#125; else &#123;\n          last &#x3D; listener.prev\n        &#125;\n        if (listener.prev) &#123;\n          listener.prev.next &#x3D; listener.next\n        &#125; else &#123;\n          first &#x3D; listener.next\n        &#125;\n      &#125;\n    &#125;\n  &#125;\n&#125;\n\nconnectåŸºæœ¬ä½¿ç”¨function connect(mapStateToProps?, mapDispatchToProps?, mergeProps?, options?)\n\nconst mapStateToProps &#x3D; state &#x3D;&gt; (&#123; todos: state.todos &#125;)\nconst mapDispatchToProps &#x3D; dispatch &#x3D;&gt; &#123;\n  return &#123;\n    increment: () &#x3D;&gt; dispatch(&#123; type: &#39;INCREMENT&#39; &#125;),\n    decrement: () &#x3D;&gt; dispatch(&#123; type: &#39;DECREMENT&#39; &#125;),\n    reset: () &#x3D;&gt; dispatch(&#123; type: &#39;RESET&#39; &#125;)\n  &#125;\n&#125;\n&#x2F;*\n* stateProps , state æ˜ å°„åˆ° props ä¸­çš„å†…å®¹\n* dispatchPropsï¼Œ dispatch æ˜ å°„åˆ° props ä¸­çš„å†…å®¹ã€‚\n* ownProps ç»„ä»¶æœ¬èº«çš„ props\nå½“æœªä¼ é€’æ—¶ï¼Œé»˜è®¤çš„åˆå¹¶è§„åˆ™ä¸º\n&#123; ...ownProps, ...stateProps, ...dispatchProps &#125;\n\n*&#x2F;\nmergeProps&#x3D;(stateProps, dispatchProps, ownProps) &#x3D;&gt; Object\n\noptions&#x3D;&#123;\n  context?: Object,   &#x2F;&#x2F; è‡ªå®šä¹‰ä¸Šä¸‹æ–‡\n  pure?: boolean, &#x2F;&#x2F; é»˜è®¤ä¸º true , å½“ä¸º true çš„æ—¶å€™ ï¼Œé™¤äº† mapStateToProps å’Œ props ,å…¶ä»–è¾“å…¥æˆ–è€…state æ”¹å˜ï¼Œå‡ä¸ä¼šæ›´æ–°ç»„ä»¶ã€‚\n  areStatesEqual?: Function, &#x2F;&#x2F; å½“pure true , æ¯”è¾ƒå¼•è¿›store ä¸­stateå€¼ æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚ (next: Object, prev: Object) &#x3D;&gt; boolean\n  areOwnPropsEqual?: Function, &#x2F;&#x2F; å½“pure true , æ¯”è¾ƒ props å€¼, æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚ (next: Object, prev: Object) &#x3D;&gt; boolean\n  areStatePropsEqual?: Function, &#x2F;&#x2F; å½“pure true , æ¯”è¾ƒ mapStateToProps åçš„å€¼ æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚  (next: Object, prev: Object) &#x3D;&gt; boolean\n  areMergedPropsEqual?: Function, &#x2F;&#x2F; å½“ pure ä¸º true æ—¶ï¼Œ æ¯”è¾ƒ ç»è¿‡ mergeProps åˆå¹¶åçš„å€¼ ï¼Œ æ˜¯å¦ä¸ä¹‹å‰ç­‰  (next: Object, prev: Object) &#x3D;&gt; boolean\n  forwardRef?: boolean, &#x2F;&#x2F;å½“ä¸ºtrue æ—¶å€™,å¯ä»¥é€šè¿‡ref è·å–è¢«connectåŒ…è£¹çš„ç»„ä»¶å®ä¾‹ã€‚\n&#125;\n\n\n\n&#x2F;**\n * Connects a React component to a Redux store.\n *\n * - Without arguments, just wraps the component, without changing the behavior &#x2F; props\n *\n * - If 2 params are passed (3rd param, mergeProps, is skipped), default behavior\n * is to override ownProps (as stated in the docs), so what remains is everything that&#39;s\n * not a state or dispatch prop\n *\n * - When 3rd param is passed, we don&#39;t know if ownProps propagate and whether they\n * should be valid component props, because it depends on mergeProps implementation.\n * As such, it is the user&#39;s responsibility to extend ownProps interface from state or\n * dispatch props or both when applicable\n *\n * @param mapStateToProps A function that extracts values from state\n * @param mapDispatchToProps Setup for dispatching actions\n * @param mergeProps Optional callback to merge state and dispatch props together\n * @param options Options for configuring the connection\n *\n *&#x2F;\nfunction connect&lt;\n  TStateProps &#x3D; &#123;&#125;,\n  TDispatchProps &#x3D; &#123;&#125;,\n  TOwnProps &#x3D; &#123;&#125;,\n  TMergedProps &#x3D; &#123;&#125;,\n  State &#x3D; unknown\n&gt;(\n  mapStateToProps?: MapStateToPropsParam&lt;TStateProps, TOwnProps, State&gt;,\n  mapDispatchToProps?: MapDispatchToPropsParam&lt;TDispatchProps, TOwnProps&gt;,\n  mergeProps?: MergeProps&lt;TStateProps, TDispatchProps, TOwnProps, TMergedProps&gt;,\n  &#123;\n    &#x2F;&#x2F; The &#96;pure&#96; option has been removed, so TS doesn&#39;t like us destructuring this to check its existence.\n    &#x2F;&#x2F; @ts-ignore\n    pure,\n    areStatesEqual &#x3D; strictEqual,\n    areOwnPropsEqual &#x3D; shallowEqual,\n    areStatePropsEqual &#x3D; shallowEqual,\n    areMergedPropsEqual &#x3D; shallowEqual,\n\n    &#x2F;&#x2F; use React&#39;s forwardRef to expose a ref of the wrapped component\n    forwardRef &#x3D; false,\n\n    &#x2F;&#x2F; the context consumer to use\n    context &#x3D; ReactReduxContext,\n  &#125;: ConnectOptions&lt;unknown, unknown, unknown, unknown&gt; &#x3D; &#123;&#125;\n): unknown &#123;\n  \n\n  const Context &#x3D; context\n\n  &#x2F;*\n  * stateProps , state æ˜ å°„åˆ° props ä¸­çš„å†…å®¹\n  * dispatchPropsï¼Œ dispatch æ˜ å°„åˆ° props ä¸­çš„å†…å®¹ã€‚\n  * ownProps ç»„ä»¶æœ¬èº«çš„ props\n  å½“æœªä¼ é€’æ—¶ï¼Œé»˜è®¤çš„åˆå¹¶è§„åˆ™ä¸º\n  &#123; ...ownProps, ...stateProps, ...dispatchProps &#125;\n\n  *&#x2F;\n &#x2F;* ç»è¿‡ä»£ç†åŒ…è£…åçš„ mapStateToProps,å®Œæˆä¼ å…¥storeç­‰æ“ä½œ*&#x2F;\n  const initMapStateToProps &#x3D; mapStateToPropsFactory(mapStateToProps)\n  &#x2F;* ç»è¿‡ä»£ç†åŒ…è£…åçš„ mapDispatchToPropsï¼Œå®Œæˆä¼ å…¥store.dispatchç­‰æ“ä½œ*&#x2F;\n  const initMapDispatchToProps &#x3D; mapDispatchToPropsFactory(mapDispatchToProps)\n  &#x2F;* ç»è¿‡ä»£ç†åŒ…è£…åçš„ mergePropsï¼Œç”¨äºå½¢æˆçœŸæ­£çš„ mergePropså‡½æ•°ï¼Œåˆå¹¶ä¸šåŠ¡ç»„ä»¶çš„ props , state æ˜ å°„çš„ props , dispatch æ˜ å°„çš„ props *&#x2F;\n  const initMergeProps &#x3D; mergePropsFactory(mergeProps)\n\n  const shouldHandleStateChanges &#x3D; Boolean(mapStateToProps)\n\n  &#x2F;&#x2F;é»˜è®¤çš„é«˜é˜¶ç»„ä»¶connectAdvancedï¼Œå®é™…æ¸²æŸ“çš„ç»„ä»¶æ˜¯å…¶ä¸­è¿”å›çš„ä¸€ä¸ªConnectFunction\n\t&#x2F;&#x2F;selectorFactoryä¸ºæ•´åˆconnectæ›´æ–°è¿‡ç¨‹ä¸­çš„å½¢æˆæ–°propsçš„ä¸»è¦å‡½æ•°\n\t&#x2F;&#x2F;selectorFactoryä¸ºåé¢çš„finalPropsSelectorFactory\n  const wrapWithConnect: AdvancedComponentDecorator&lt;\n    TOwnProps,\n    WrappedComponentProps\n  &gt; &#x3D; (WrappedComponent) &#x3D;&gt; &#123;\n    ...\n  &#125;\n&#125;\n\n\nå½“æˆ‘ä»¬ä¸å‘connectä¼ é€’ç¬¬ä¸‰ä¸ªå‚æ•°mergeProps çš„æ—¶å€™ï¼Œé»˜è®¤çš„defaultMergePropså¦‚ä¸‹ï¼Œä½œä¸ºæ–°çš„ props ä¼ é€’ç»™äº†ä¸šåŠ¡ç»„ä»¶\n\nexport function defaultMergeProps(stateProps, dispatchProps, ownProps) &#123;\n  return &#123; ...ownProps, ...stateProps, ...dispatchProps &#125;\n&#125;\n\n\n\nselectorFactory\n\né¦–å…ˆå¾—åˆ°çœŸæ­£connect ç»è¿‡ä¸€å±‚ä»£ç†å‡½æ•° mapStateToProps ,mapDispatchToProps ,mergeProps\nç„¶åè°ƒç”¨selectorFactory (åœ¨pureæ¨¡å¼ä¸‹ï¼ŒselectorFactory å°±æ˜¯ pureFinalPropsSelectorFactory )export default function finalPropsSelectorFactory(\n  dispatch,\n  &#123; initMapStateToProps, initMapDispatchToProps, initMergeProps, ...options &#125;\n) &#123;\n  &#x2F;&#x2F; mapStateToProps mapDispatchToProps mergeProps ä¸ºçœŸæ­£connect ç»è¿‡ä¸€å±‚ä»£ç†çš„ proxy å‡½æ•°\n  const mapStateToProps &#x3D; initMapStateToProps(dispatch, options)\n  const mapDispatchToProps &#x3D; initMapDispatchToProps(dispatch, options)\n  const mergeProps &#x3D; initMergeProps(dispatch, options)\n\n  &#x2F;&#x2F;é»˜è®¤pureä¸ºtrueï¼ŒselectorFactoryé»˜è®¤ä¸ºpureFinalPropsSelectorFactory\n  const selectorFactory &#x3D; options.pure ? pureFinalPropsSelectorFactory : impureFinalPropsSelectorFactory\n   &#x2F;&#x2F; è¿”å›ä¸€ä¸ª å‡½æ•°ç”¨äºç”Ÿæˆæ–°çš„ props \n  return selectorFactory(\n    mapStateToProps,\n    mapDispatchToProps,\n    mergeProps,\n    dispatch,\n    options\n  )\n&#125;\n\n\npureFinalPropsSelectorFactory\n\nå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ï¼Œé‚£ä¹ˆç›´æ¥è°ƒç”¨mergePropsåˆå¹¶ownProps,stateProps,dispatchProps å½¢æˆæœ€ç»ˆçš„propsã€‚\nå¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œé‚£ä¹ˆåˆ¤æ–­åˆ°åº•æ˜¯propsè¿˜æ˜¯ store.state å‘ç”Ÿæ”¹å˜ï¼Œç„¶åé’ˆå¯¹é‚£é‡Œå˜åŒ–ï¼Œé‡æ–°ç”Ÿæˆå¯¹åº”çš„propsï¼Œæœ€ç»ˆåˆå¹¶åˆ°çœŸæ­£çš„props\næ•´ä¸ª selectorFactory é€»è¾‘å°±æ˜¯å½¢æˆæ–°çš„propsä¼ é€’ç»™æˆ‘ä»¬çš„ä¸šåŠ¡ç»„ä»¶ã€‚\n\n&#x2F;** pureç»„ä»¶å¤„ç† ï¼Œ å¯¹æ¯” props æ˜¯å¦å‘ç”Ÿå˜åŒ– ç„¶å åˆå¹¶props *&#x2F;\nexport function pureFinalPropsSelectorFactory(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps,\n  dispatch,\n  &#123; areStatesEqual, areOwnPropsEqual, areStatePropsEqual &#125; &#x2F;&#x2F;åˆ¤æ–­ state prop æ˜¯å¦ç›¸ç­‰\n) &#123;\n  let hasRunAtLeastOnce &#x3D; false\n  let state\n  let ownProps\n  let stateProps\n  let dispatchProps\n  let mergedProps\n \n  &#x2F;* ç¬¬ä¸€æ¬¡ ç›´æ¥å½¢æˆ ownProps  stateProps  dispatchProps åˆå¹¶  å½¢æˆæ–°çš„ props *&#x2F;\n  function handleFirstCall(firstState, firstOwnProps) &#123;\n    state &#x3D; firstState\n    ownProps &#x3D; firstOwnProps\n    &#x2F;&#x2F;è·å–ä¸šåŠ¡ç»„ä»¶ä¸­mapStateToPropså‡½æ•°çš„è¿”å›å€¼\n    stateProps &#x3D; mapStateToProps(state, ownProps)\n    &#x2F;&#x2F;è·å–ä¸šåŠ¡ç»„ä»¶ä¸­mapDispatchToPropså‡½æ•°çš„è¿”å›å€¼\n    dispatchProps &#x3D; mapDispatchToProps(dispatch, ownProps)\n    &#x2F;&#x2F;åˆå¹¶stateã€dispatchã€ç»„ä»¶è‡ªèº«çš„propsï¼Œå½¢æˆæœ€ç»ˆä¼ é€’ç»™ç»„ä»¶çš„props\n    mergedProps &#x3D; mergeProps(stateProps, dispatchProps, ownProps)\n    hasRunAtLeastOnce &#x3D; true\n    return mergedProps\n  &#125;\n  \n  function handleNewPropsAndNewState() &#123;\n    &#x2F;&#x2F;  props å’Œ state éƒ½æ”¹å˜  mergeProps \n  &#125;\n\n  function handleNewProps() &#123;\n    &#x2F;&#x2F; props æ”¹å˜  mergeProps\n  &#125;\n\n  function handleNewState() &#123;\n     &#x2F;&#x2F; state æ”¹å˜ mergeProps\n  &#125;\n\n  &#x2F;*  ä¸æ˜¯ç¬¬ä¸€æ¬¡çš„æƒ…å†µ props æˆ–è€… store.state å‘ç”Ÿæ”¹å˜çš„æƒ…å†µã€‚ *&#x2F;\n  function handleSubsequentCalls(nextState, nextOwnProps) &#123;\n      &#x2F;* åˆ¤æ–­ä¸¤æ¬¡ props æ˜¯å¦ç›¸ç­‰ *&#x2F;\n    const propsChanged &#x3D; !areOwnPropsEqual(nextOwnProps, ownProps) \n      &#x2F;* åˆ¤æ–­ä¸¤æ¬¡ store.state æ˜¯å¦ç›¸ç­‰ *&#x2F;\n    const stateChanged &#x3D; !areStatesEqual(nextState, state)\n    state &#x3D; nextState\n    ownProps &#x3D; nextOwnProps\n    \n    &#x2F;&#x2F;æ ¹æ®æ”¹å˜çš„ç±»å‹ä¸åŒï¼Œè¿”å›å¯¹åº”åˆå¹¶ç­–ç•¥ä¸‹çš„props\n    if (propsChanged &amp;&amp; stateChanged) return handleNewPropsAndNewState()\n    if (propsChanged) return handleNewProps()\n    if (stateChanged) return handleNewState()\n    return mergedProps\n  &#125;\n  \n  &#x2F;&#x2F;æ ¹æ®æ˜¯å¦ç¬¬ä¸€æ¬¡å½¢æˆpropsï¼Œæ‰§è¡Œå¯¹åº”æ–¹æ³•\n  return function pureFinalPropsSelector(nextState, nextOwnProps) &#123;\n    return hasRunAtLeastOnce\n      ? handleSubsequentCalls(nextState, nextOwnProps)\n      : handleFirstCall(nextState, nextOwnProps)\n  &#125;\n&#125;\n\nconnectHOCconst mapStateToProp &#x3D; (store) &#x3D;&gt; (&#123; userInfo: store.root.userInfo &#125;)\n\nfunction Index()&#123;\n    &#x2F;* ..... *&#x2F;\n    return &lt;div&gt; &#123; &#x2F;* .... *&#x2F; &#125; &lt;&#x2F;div&gt;\n&#125;\nexport default connect(mapStateToProp)(Index)\n\n\n\nconnect(mapStateToProp)&#x3D;&#x3D;&#x3D;connectAdvanced()\n\n\nç‚¹å‡»æŸ¥çœ‹æ›´å¤š\n\nè¿™éƒ¨åˆ†ä»£ç ï¼Œåœ¨8.x.xç‰ˆæœ¬åœ¨conncetä¸­ç›´æ¥å¤„ç†ï¼Œå¹¶æ²¡æœ‰æ‹†åˆ†ä¸ºå•ç‹¬å‡½æ•°\n\nexport default function connectAdvanced(\n  selectorFactory, &#x2F;&#x2F; æ¯æ¬¡ props,stateæ”¹å˜æ‰§è¡Œ ï¼Œç”¨äºç”Ÿæˆæ–°çš„ propsã€‚\n  &#123;\n    getDisplayName &#x3D; name &#x3D;&gt; &#96;ConnectAdvanced($&#123;name&#125;)&#96;,\n    &#x2F;&#x2F;å¯èƒ½è¢«åŒ…è£…å‡½æ•°ï¼ˆå¦‚connectï¼ˆï¼‰ï¼‰é‡å†™\n    methodName &#x3D; &#39;connectAdvanced&#39;,\n    &#x2F;&#x2F;å¦‚æœå®šä¹‰äº†ï¼Œåˆ™ä¼ é€’ç»™åŒ…è£…å…ƒç´ çš„å±æ€§çš„åç§°ï¼ŒæŒ‡ç¤ºè¦å‘ˆç°çš„è°ƒç”¨ã€‚ç”¨äºç›‘è§†react devtoolsä¸­ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚\n    renderCountProp &#x3D; undefined,\n    shouldHandleStateChanges &#x3D; true,  &#x2F;&#x2F;ç¡®å®šæ­¤HOCæ˜¯å¦è®¢é˜…å­˜å‚¨æ›´æ”¹\n    storeKey &#x3D; &#39;store&#39;,\n    withRef &#x3D; false,\n    forwardRef &#x3D; false, &#x2F;&#x2F; æ˜¯å¦ ç”¨ forwarRef æ¨¡å¼\n    context &#x3D; ReactReduxContext,&#x2F;&#x2F; Provider ä¿å­˜çš„ä¸Šä¸‹æ–‡\n    ...connectOptions\n  &#125; &#x3D; &#123;&#125;\n) &#123;\n  &#x2F;* ReactReduxContext å°±æ˜¯storeå­˜åœ¨çš„context *&#x2F;\n  const Context &#x3D; context\n   &#x2F;* WrappedComponent ä¸ºconnect åŒ…è£¹çš„ç»„ä»¶æœ¬èº«  *&#x2F;   \n  return  function wrapWithConnect(WrappedComponent)&#123;\n      &#x2F;&#x2F; WrappedComponent è¢« connect çš„ä¸šåŠ¡ç»„ä»¶æœ¬èº«\n  &#125;\n&#125;\n\næ‹¿åˆ°Provideræä¾›çš„contextä¸Šä¸‹æ–‡\n\n\n\nwrapWithConnectwrapWithConnectä½œä¸ºé«˜é˜¶ç»„ä»¶ï¼Œä¼šè¿”å›ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä¼šå¯¹åŸæœ‰çš„ä¸šåŠ¡ç»„ä»¶ï¼Œè¿›è¡Œä¸€ç³»åˆ—å¢å¼ºç­‰å·¥ä½œåˆ¤æ–­æ˜¯å¦æ˜¯ pure çº¯ç»„ä»¶æ¨¡å¼ï¼Œå¦‚æœæ˜¯ç”¨react.memoåŒ…è£¹,è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¼šå‘ pureComponent ä¸€æ ·å¯¹ props è¿›è¡Œæµ…æ¯”è¾ƒå¦‚æœ connect æœ‰forwardRefé…ç½®é¡¹ï¼Œç”¨React.forwardRefå¤„ç†\nfunction wrapWithConnect(WrappedComponent) &#123;\n\t&#x2F;&#x2F;WrappedComponentä¸ºå®é™…ä¼ é€’çš„ä¸šåŠ¡ç»„ä»¶\n    const wrappedComponentName &#x3D;\n      WrappedComponent.displayName || WrappedComponent.name || &#39;Component&#39;\n  \n    const displayName &#x3D; getDisplayName(wrappedComponentName)\n    \n    &#x2F;&#x2F;è¦åˆå¹¶éƒ½å†…å®¹ï¼ŒconnectOptionsä¸ºä¸Šä¸€æ­¥é—­åŒ…æ‹¿åˆ°çš„å†…å®¹\n    const selectorFactoryOptions &#x3D; &#123;\n      ...connectOptions,\n      getDisplayName,\n      methodName,\n      renderCountProp,\n      shouldHandleStateChanges,\n      storeKey,\n      displayName,\n      wrappedComponentName,\n      WrappedComponent\n    &#125;\n    const &#123; pure &#125; &#x3D; connectOptions\n    \n    &#x2F;&#x2F;selectorFactoryä¸ºfinalPropsSelectorFactory\n    function createChildSelector(store) &#123;\n      &#x2F;&#x2F; åˆå¹¶å‡½æ•° mergeprops å¾—åˆ°æœ€æ–°çš„props\n      &#x2F;&#x2F; åŠé»˜è®¤è¿”å›pureFinalPropsSelectorFactoryï¼Œä¼šæ ¹æ®æ˜¯å¦ç¬¬ä¸€æ¬¡åˆå¹¶ã€ä¿®æ”¹ç±»å‹ç­‰è¿›è¡Œä¸åŒç­–ç•¥ç­‰åˆå¹¶ä»¥åŠè¿”å›æœ€ç»ˆéƒ½props\n      return selectorFactory(store.dispatch, selectorFactoryOptions)\n    &#125;\n    &#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦æ˜¯pureçº¯ç»„ä»¶æ¨¡å¼ å¦‚æœæ˜¯å°†ç”¨ useMemo ç¼“å­˜ç»„ä»¶æå‡æ€§èƒ½\n    const usePureOnlyMemo &#x3D; pure ? useMemo : callback &#x3D;&gt; callback()\n    &#x2F;&#x2F; è´Ÿè´£æ›´æ–°çš„å®¹å™¨å­ç»„ä»¶ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å®é™…æ¸²æŸ“çš„ç±»ç»„ä»¶\n    function ConnectFunction (props)&#123;\n        &#x2F;&#x2F; props ä¸º ä¸šåŠ¡ç»„ä»¶ çœŸæ­£çš„ props \n    &#125;\n    &#x2F;&#x2F;å¦‚æœ\n    const Connect &#x3D; pure ? React.memo(ConnectFunction) : ConnectFunction\n  \n    Connect.WrappedComponent &#x3D; WrappedComponent\n    Connect.displayName &#x3D; displayName\n    &#x2F;* forwardRef *&#x2F;\n    if (forwardRef) &#123;\n      const forwarded &#x3D; React.forwardRef(function forwardConnectRef(\n        props,\n        ref\n      ) &#123;\n      \t&#x2F;&#x2F;connectä¸­æ˜¯å¦ä¼ é€’äº†forwardRefé€‰é¡¹\n        return &lt;Connect &#123;...props&#125; reactReduxForwardedRef&#x3D;&#123;ref&#125; &#x2F;&gt;\n      &#125;)\n  \n      forwarded.displayName &#x3D; displayName\n      forwarded.WrappedComponent &#x3D; WrappedComponent\n      &#x2F;&#x2F;hoistStaticsä¸ºä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œè´Ÿè´£æŠŠä¸€ä¸ªç±»ä¸­çš„é™æ€å±æ€§æ‹·è´åˆ°å¦ä¸€ä¸ªç±»ä¸­\n      return hoistStatics(forwarded, WrappedComponent)\n    &#125;\n  \n    return hoistStatics(Connect, WrappedComponent)\n  &#125;\n&#125;\n\nä¸ºä½•è¦ä¼ é€’forwardRefï¼Ÿconnect(mapStateToProp,mapDispatchToProps,mergeProps,&#123; forwardRef:true  &#125;)(Child)\n\nå¦‚æœä¸ä¼ é€’ï¼Œè€Œæ˜¯åœ¨å…¶ä»–ç»„ä»¶ä¸­ç›´æ¥æ”¾refåˆ°ä½¿ç”¨äº†connectçš„ç»„ä»¶ï¼Œåˆ™refå®é™…åº”ç”¨åˆ°çš„æ˜¯ConncectFunctionç»„ä»¶ï¼Œè€ŒéçœŸæ­£çš„WrappedComponentç»„ä»¶æ‰€ä»¥react-reduxæä¾›forwardRefé€‰é¡¹ï¼Œä½¿ç”¨React.forwardRefï¼Œå°†refå®é™…æ”¾åˆ°çœŸæ­£çš„WrappedComponentä¸Š\nConnectFunction\nå®é™…æ¸²æŸ“çš„ç»„ä»¶\nfunction ConnectFunction(props) &#123;\n    &#x2F;* TODO:  ç¬¬ä¸€æ­¥ æŠŠ context ForwardedRef props å–å‡ºæ¥ *&#x2F;\n    &#x2F;&#x2F;å–å‡ºforwardRefå’Œä¼ é€’ç»™ConnectFunctionçš„æ‰€æœ‰é™¤forwardRefçš„props\n    &#x2F;&#x2F;é™¤äº†forwardRefä»¥å¤–çš„propsä¹Ÿå°±æ˜¯å®é™…ä¸šåŠ¡ä»£ç ä¸­ä¼ é€’ç»™conncecåŒ…è£¹ç»„ä»¶éƒ½props\n    const [\n      reactReduxForwardedRef,\n      wrapperProps &#x2F;&#x2F; props ä¼ é€’çš„props\n    ] &#x3D; useMemo(() &#x3D;&gt; &#123;\n      const &#123; reactReduxForwardedRef, ...wrapperProps &#125; &#x3D; props\n      return [reactReduxForwardedRef, wrapperProps]\n    &#125;, [props])\n \n\t  &#x2F;&#x2F; è·å–ä¸Šå±‚Provideræä¾›çš„contextï¼Œå¤šä¸ªProvideråªä¼šå–æœ€è¿‘çš„Provider\n    &#x2F;&#x2F; è·å– contextå†…å®¹ é‡Œé¢å«æœ‰  redux ä¸­store å’Œ subscription\n    const contextValue &#x3D; useContext(Context)\n\n    &#x2F;&#x2F;TODO: åˆ¤æ–­ store æ˜¯å¦æ¥è‡ªprops  didStoreComeFromProps ,æ­£å¸¸æƒ…å†µä¸‹ ï¼Œprop ä¸­æ˜¯ä¸å­˜åœ¨ store æ‰€ä»¥  didStoreComeFromProps &#x3D; false\n    const didStoreComeFromProps &#x3D;\n      Boolean(props.store) &amp;&amp;\n      Boolean(props.store.getState) &amp;&amp;\n      Boolean(props.store.dispatch)\n    &#x2F;&#x2F;storeæ˜¯å¦æ¥è‡ªProvideræä¾›çš„ä¸Šä¸‹æ–‡\n    const didStoreComeFromContext &#x3D;\n      Boolean(contextValue) &amp;&amp; Boolean(contextValue.store)\n\n    &#x2F;&#x2F;æ ¹æ®ä¸¤ç§æƒ…å†µè·å–store\n    const store &#x3D; didStoreComeFromProps ? props.store : contextValue.store\n     \n     &#x2F;&#x2F;è¿”å›mergeå‡½æ•° ç”¨äºç”ŸæˆçœŸæ­£ä¼ ç»™å­ç»„ä»¶ props\n    const childPropsSelector &#x3D; useMemo(() &#x3D;&gt; &#123;\n    \t&#x2F;&#x2F;é»˜è®¤æƒ…å†µä¸‹pureä¸ºtrueï¼Œè¿”å›çš„æ˜¯pureFinalPropsSelectorFactory\n      return createChildSelector(store)\n    &#125;, [store])\n\n\n    &#x2F;&#x2F; TODO:  ç¬¬äºŒæ­¥  åˆ›å»ºconnectç»„ä»¶è‡ªèº«çš„subscription ç›‘å¬è€…å®ä¾‹  \n    const [subscription, notifyNestedSubs] &#x3D; useMemo(() &#x3D;&gt; &#123;\n        &#x2F;&#x2F; å¦‚æœæ²¡æœ‰è®¢é˜…æ›´æ–°ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ï¼Œé»˜è®¤æƒ…å†µä¸‹å¼€å¯äº†è®¢é˜…\n      if (!shouldHandleStateChanges) return NO_SUBSCRIPTION_ARRAY\n\t\t&#x2F;&#x2F;ä¸ºæ¯ä¸€ä¸ªconncetçš„ç»„ä»¶åˆ›å»ºè®¢é˜…å™¨ï¼Œè·å–ä¸Šå±‚Provideræä¾›çš„contextValue.subscription\n\t\t&#x2F;&#x2F;connctçš„ç»„ä»¶è·å–çš„æ˜¯ä¸Šå±‚çš„Provderæä¾›çš„subscriptionï¼Œæœ‰å¤šä¸ªProviderï¼Œåªä¼šå–å±‚çº§æœ€è¿‘çš„ä¸€ä¸ª\n\t\t&#x2F;&#x2F;æ‰€ä»¥connectä¸­çš„connectç»„ä»¶ï¼Œè·å–åˆ°çš„æ˜¯ç¦»å®ƒæœ€è¿‘çš„Providerä¸­çš„è®¢é˜…å™¨ï¼Œé€šè¿‡å®ƒæ¥ç®¡ç†è‡ªèº«çš„listeneræ›´æ–°å‡½æ•°\n      const subscription &#x3D; new Subscription(\n        store,\n        didStoreComeFromProps ? null : contextValue.subscription &#x2F;&#x2F; å’Œ ä¸Šçº§ &#96;subscription&#96; å»ºç«‹èµ·å…³ç³»ã€‚ this.parentSub &#x3D; contextValue.subscription\n      )\n      &#x2F;&#x2F; notifyNestedSubs è§¦å‘ noticy æ‰€æœ‰å­ä»£ listener ç›‘å¬è€… -&gt; è§¦å‘batchæ–¹æ³•,è§¦å‘ batchupdateæ–¹æ³• ,æ‰¹é‡æ›´æ–°\n      &#x2F;&#x2F;å¹¶æ›´æ–°ä¸€ä¸‹thisæŒ‡å‘\n      const notifyNestedSubs &#x3D; subscription.notifyNestedSubs.bind(\n        subscription\n      )\n\n      return [subscription, notifyNestedSubs]\n    &#125;, [store, didStoreComeFromProps, contextValue])\n\n    &#x2F;*  åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„contextValue ,æŠŠçˆ¶çº§çš„ subscription æ¢æˆè‡ªå·±çš„ subscription   *&#x2F;\n    const overriddenContextValue &#x3D; useMemo(() &#x3D;&gt; &#123;   \n      if (didStoreComeFromProps) &#123; \n        return contextValue\n      &#125;\n      &#x2F;&#x2F;é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿”å›è‡ªèº«çš„è®¢é˜…å™¨ä»¥åŠreduxä¸­çš„storeç»™è‡ªèº«çš„å­ä»£connectä¸­è·å–\n      return &#123;\n        ...contextValue,\n        subscription\n      &#125;\n    &#125;, [didStoreComeFromProps, contextValue, subscription])\n    \n    &#x2F;&#x2F;å®šä¹‰äº†ä¸€ä¸ªuseReducerï¼Œå½“actualChildPropså˜åŒ–æ—¶ï¼Œè°ƒç”¨dispatchæ–¹æ³•forceComponentUpdateDispatchè¿›è¡Œç»„ä»¶æ›´æ–°\n    const [\n      [previousStateUpdateResult], &#x2F;&#x2F;è°ƒç”¨dispatchæ›´æ–°åçš„å†…å®¹\n      forceComponentUpdateDispatch  &#x2F;*  *&#x2F;\n    ] &#x3D; useReducer(storeStateUpdatesReducer, EMPTY_ARRAY, initStateUpdates)\n\n\n    &#x2F;&#x2F; TODO: ç¬¬ä¸‰æ­¥ç¼“å­˜ç»„ä»¶æœ¬æ¬¡çš„propsç­‰å†…å®¹ï¼Œåœ¨ä¸‹ä¸€æ¬¡ç»„ä»¶æ›´æ–°æ—¶åšæ¯”è¾ƒ\n    const lastChildProps &#x3D; useRef() &#x2F;&#x2F;ä¿å­˜ä¸Šä¸€æ¬¡ åˆå¹¶è¿‡çš„ propsä¿¡æ¯ï¼ˆç»è¿‡ ownprops ,stateProps , dispatchProps åˆå¹¶è¿‡çš„ ï¼‰\n    const lastWrapperProps &#x3D; useRef(wrapperProps) &#x2F;&#x2F;ä¿å­˜æœ¬æ¬¡ä¸šåŠ¡ç»„ä»¶çš„ props \n    const childPropsFromStoreUpdate &#x3D; useRef() &#x2F;&#x2F;ç”¨æ¥ä¿å­˜æ›´æ–°åçš„æœ€æ–°çš„props\n    const renderIsScheduled &#x3D; useRef(false) &#x2F;&#x2F; å½“å‰ç»„ä»¶æ˜¯å¦å¤„äºæ¸²æŸ“é˜¶æ®µ\n    \n    &#x2F;&#x2F; actualChildProps ä¸ºå½“å‰çœŸæ­£å¤„ç†è¿‡åï¼Œç»è¿‡åˆå¹¶çš„ props\n    const actualChildProps &#x3D; usePureOnlyMemo(() &#x3D;&gt; &#123;\n        &#x2F;&#x2F; è°ƒç”¨ mergeProps è¿›è¡Œåˆå¹¶ï¼Œè¿”å›åˆå¹¶åçš„æœ€æ–° porps\n        &#x2F;&#x2F;åŠè°ƒç”¨pureFinalPropsSelectorFactoryåçš„åˆå¹¶ç»“æœ\n      return childPropsSelector(store.getState(), wrapperProps)\n    \n    \t &#x2F;&#x2F;ä¼šåœ¨storeã€è°ƒç”¨äº†checkForUpdatesã€ä¼ é€’ç»™ç»„å»ºçš„propså‘ç”Ÿå˜åŒ–åï¼Œé‡æ–°è®¡ç®—è·å–åˆå¹¶åçš„props \n    &#125;, [store, previousStateUpdateResult, wrapperProps])\n\n   &#x2F;* è´Ÿè´£æ›´æ–°ç¼“å­˜å˜é‡ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™æ¯”è¾ƒ *&#x2F;\n    useEffect(()&#x3D;&gt;&#123;\n      captureWrapperProps(...[\n          lastWrapperProps,\n          lastChildProps,\n          renderIsScheduled,\n          wrapperProps,\n          actualChildProps,\n          childPropsFromStoreUpdate,\n          notifyNestedSubs\n       ])\n    &#125;)\n    \n    &#x2F;&#x2F;å®é™…è®¢é˜…æ›´æ–°ç»„ä»¶çš„åœ°æ–¹\n    useEffect(()&#x3D;&gt;&#123;\n        subscribeUpdates(...[\n        shouldHandleStateChanges,\n        store,\n        subscription,\n        childPropsSelector,\n        lastWrapperProps,\n        lastChildProps,\n        renderIsScheduled,\n        childPropsFromStoreUpdate,\n        notifyNestedSubs,\n        forceComponentUpdateDispatch\n       ])\n    &#125;,[store, subscription, childPropsSelector])\n\n\n\n    &#x2F;&#x2F; TODO: ç¬¬å››æ­¥ï¼šæ¸²æŸ“å®é™…æŒ‚è½½çš„ç»„ä»¶ï¼Œé€šè¿‡useMemoè¿›è¡Œç»„ä»¶çš„ç¼“å­˜\n    const renderedWrappedComponent &#x3D; useMemo(\n      () &#x3D;&gt; (\n        &lt;WrappedComponent\n          &#123;...actualChildProps&#125;\n          ref&#x3D;&#123;reactReduxForwardedRef&#125;\n        &#x2F;&gt;\n      ),\n      &#x2F;&#x2F;å½“actualChildPropså‘ç”Ÿå˜åŒ–çš„æ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶\n      &#x2F;&#x2F;è¿™é‡Œå°±æ˜¯ç»„ä»¶é‡æ–°æ¸²æŸ“çš„åŸå› ï¼šä¸»è¦é€šè¿‡ç›‘å¬actualChildPropsçš„å˜åŒ–\n      [reactReduxForwardedRef, WrappedComponent, actualChildProps]\n    )\n    &#x2F;&#x2F; å°†ä¸Šä¸€æ­¥çš„renderedWrappedComponentåŒ…è£¹ä¸€å±‚Provider\n    &#x2F;&#x2F; æä¾›è¯¥connectç»„ä»¶è‡ªèº«çš„è®¢é˜…å™¨ã€storeç»™å­ä»£ä¸­çš„connectç»„ä»¶è·å–\n    const renderedChild &#x3D; useMemo(() &#x3D;&gt; &#123;\n      &#x2F;&#x2F;shouldHandleStateChanges æ¥æº connectæ˜¯å¦æœ‰ç¬¬ä¸€ä¸ªå‚æ•°\n      if (shouldHandleStateChanges) &#123;\n        return (\n          &#x2F;&#x2F; ContextToUse ä¼ é€’ context \n          &lt;ContextToUse.Provider value&#x3D;&#123;overriddenContextValue&#125;&gt;\n            &#123;renderedWrappedComponent&#125;\n          &lt;&#x2F;ContextToUse.Provider&gt;\n        )\n      &#125;\n\n      return renderedWrappedComponent\n    &#125;, [ContextToUse, renderedWrappedComponent, overriddenContextValue])\n\n    return renderedChild\n  &#125;\n\n\n\nåˆ›å»ºè¯¥connectç»„ä»¶è‡ªèº«çš„subscription, å¹¶ä½¿ç”¨ProvideråŒ…è£¹ï¼Œå±‚å±‚ä¼ é€’æ–°çš„context(å¾ˆé‡è¦)\n\næ‰€ä»¥connectç»„ä»¶çš„å­ä»£connectç»„ä»¶ï¼Œè·å–åˆ°çš„éƒ½æ˜¯å…¶ä¸Šå±‚æœ€è¿‘çš„connectæä¾›çš„Providerä¸­çš„è®¢é˜…å™¨ï¼Œç„¶åå°†æ›´æ–°å‡½æ•°checkForUpdatesæ”¾è¿›å…¶ä¸­ç®¡ç†\n\nç„¶åé€šè¿‡ useMemo åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„ contextValue ,æŠŠçˆ¶çº§çš„ subscription æ¢æˆè‡ªå·±çš„ subscriptionã€‚ç”¨äºé€šè¿‡ Provider ä¼ é€’æ–°çš„ context\n\næ¥ä¸‹æ¥é€šè¿‡useReduceråˆ¶é€ å‡ºçœŸæ­£è§¦å‘æ›´æ–°çš„forceComponentUpdateDispatch è¿™ä¸ªdispatchå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯æ•´ä¸ª state æˆ–è€…æ˜¯ propsæ”¹å˜ï¼Œè§¦å‘ç»„ä»¶æ›´æ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ”¾è¿›checkForUpdatesä¸­æ‰§è¡Œ\n\n\ncaptureWrapperProps\nè¿›è¡Œå†…å®¹ç¼“å­˜ï¼Œä¸ºäº†ä¸‹æ¬¡ç»„ä»¶æ›´æ–°è¿›è¡Œæ¯”è¾ƒ&#x2F;&#x2F;è·å–åŒ…è£…çš„props \nfunction captureWrapperProps(\n  lastWrapperProps,\n  lastChildProps,\n  renderIsScheduled,\n  wrapperProps,\n  actualChildProps,\n  childPropsFromStoreUpdate,\n  notifyNestedSubs\n) &#123;\n  lastWrapperProps.current &#x3D; wrapperProps  &#x2F;&#x2F;å­props \n  lastChildProps.current &#x3D; actualChildProps &#x2F;&#x2F;ç»è¿‡ megeprops ä¹‹åå½¢æˆçš„æ–°prop\n  renderIsScheduled.current &#x3D; false  &#x2F;&#x2F; å½“å‰ç»„ä»¶æ¸²æŸ“å®Œæˆ\n&#125;\n\n\nsubscribeUpdates\nå®é™…æ·»åŠ æ›´æ–°å›è°ƒçš„åœ°æ–¹\nfunction subscribeUpdates(\n  shouldHandleStateChanges,\n  store,\n  subscription,\n  childPropsSelector,\n  lastWrapperProps,  &#x2F;&#x2F;å­props \n  lastChildProps, &#x2F;&#x2F;ç»è¿‡ megeprops ä¹‹åå½¢æˆçš„ prop\n  renderIsScheduled,\n  childPropsFromStoreUpdate,\n  notifyNestedSubs,\n  forceComponentUpdateDispatch\n) &#123;\n  if (!shouldHandleStateChanges) return\n\n   &#x2F;&#x2F; æ•è·å€¼ä»¥æ£€æŸ¥æ­¤ç»„ä»¶æ˜¯å¦å¸è½½ä»¥åŠä½•æ—¶å¸è½½\n  let didUnsubscribe &#x3D; false\n  let lastThrownError &#x3D; null\n   &#x2F;&#x2F;storeæ›´æ–°è®¢é˜…ä¼ æ’­åˆ°æ­¤ç»„ä»¶æ—¶ï¼Œè¿è¡Œæ­¤å›è°ƒ\n  const checkForUpdates &#x3D; ()&#x3D;&gt;&#123;\n      &#x2F;&#x2F;....\n  &#125;\n  &#x2F;&#x2F;å°†checkForUpdatesä½œä¸ºlistener\n  subscription.onStateChange &#x3D; checkForUpdates\n  &#x2F;&#x2F;å¼€å¯è®¢é˜…è€… ï¼Œå½“å‰æ˜¯è¢«connect åŒ…è½¬çš„æƒ…å†µ ä¼šæŠŠ å½“å‰çš„ checkForceUpdate æ”¾åœ¨å­˜å…¥ çˆ¶å…ƒç´ çš„addNestedSubä¸­ã€‚\n  subscription.trySubscribe()\n  &#x2F;&#x2F;åœ¨ç¬¬ä¸€æ¬¡å‘ˆç°ä¹‹åä»å­˜å‚¨ä¸­æå–æ•°æ®ï¼Œä»¥é˜²å­˜å‚¨ä»æˆ‘ä»¬å¼€å§‹å°±æ”¹å˜äº†ã€‚\n  &#x2F;&#x2F;ç¡®ä¿è·å–åˆ°çš„æœ€æ–°çš„store.getState,ç„¶ååˆ¤æ–­æ˜¯å¦æ›´æ–°ç»„ä»¶\n  checkForUpdates()\n  &#x2F;* å¸è½½è®¢é˜…èµ· *&#x2F;\n  const unsubscribeWrapper &#x3D; () &#x3D;&gt; &#123;\n    didUnsubscribe &#x3D; true\n    subscription.tryUnsubscribe()\n    subscription.onStateChange &#x3D; null\n  &#125;\n\n  return unsubscribeWrapper\n&#125;\n\n\né¦–å…ˆå£°æ˜ store æ›´æ–°è®¢é˜…ä¼ æ’­åˆ°æ­¤ç»„ä»¶æ—¶çš„å›è°ƒå‡½æ•°checkForUpdatesæŠŠå®ƒèµ‹å€¼ç»™onStateChange,å¦‚æœstoreä¸­çš„stateå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆåœ¨ç»„ä»¶è®¢é˜…äº†stateå†…å®¹ä¹‹åï¼Œç›¸å…³è”çš„stateæ”¹å˜å°±ä¼šè§¦å‘å½“å‰ç»„ä»¶çš„onStateChange,æ¥åˆå¹¶å¾—åˆ°æ–°çš„props\n\nsubscription.trySubscribe()æŠŠè®¢é˜…å‡½æ•°onStateChangeç»‘å®šç»™çˆ¶çº§subscription,è¿›è¡Œäº†å±‚å±‚è®¢é˜…\n\nä¸ºäº†ç¡®ä¿æ‹¿åˆ°çš„storeå†…å®¹æ˜¯æœ€æ–°çš„ï¼Œæ‰€ä»¥é¦–å…ˆæ‰§è¡Œäº†ä¸€æ¬¡checkForUpdates\ncheckForUpdates\nåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°çš„å‡½æ•°\n&#x2F;&#x2F;storeæ›´æ–°è®¢é˜…ä¼ æ’­åˆ°æ­¤ç»„ä»¶æ—¶ï¼Œè¿è¡Œæ­¤å›è°ƒ\nconst checkForUpdates &#x3D; () &#x3D;&gt; &#123;\n  if (didUnsubscribe) &#123;\n    &#x2F;&#x2F;å¦‚æœå–æ¶ˆè®¢é˜…äº†\n    return\n  &#125;\n   &#x2F;&#x2F; è·å– store é‡Œstate\n  const latestStoreState &#x3D; store.getState()q\n  let newChildProps, error\n  try &#123;\n    &#x2F;* å¾—åˆ°æœ€æ–°çš„ props *&#x2F;\n    newChildProps &#x3D; childPropsSelector(\n      latestStoreState,\n      lastWrapperProps.current\n    )\n  &#125; \n  &#x2F;&#x2F;å¦‚æœæ–°çš„åˆå¹¶çš„ propsæ²¡æœ‰æ›´æ”¹ï¼Œåˆ™æ­¤å¤„ä¸åšä»»ä½•æ“ä½œ-å±‚å è®¢é˜…æ›´æ–°\n  if (newChildProps &#x3D;&#x3D;&#x3D; lastChildProps.current) &#123; \n    if (!renderIsScheduled.current) &#123;  \n      notifyNestedSubs() &#x2F;* é€šçŸ¥å­ä»£ subscription è§¦å‘ checkForUpdates æ¥æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ã€‚ *&#x2F;\n    &#125;\n  &#125; else &#123;\n    lastChildProps.current &#x3D; newChildProps\n    childPropsFromStoreUpdate.current &#x3D; newChildProps\n    renderIsScheduled.current &#x3D; true\n    &#x2F;&#x2F; è§¦å‘useReducerçš„dispatchæ¥è¿›è¡Œæ›´æ–°ï¼Œè¯¥dispatchä¼šæ”¹å˜useReducerè¿”å›çš„previousStateUpdateResult\n    &#x2F;&#x2F; è€ŒpreviousStateUpdateResultæ˜¯ä½œä¸ºactualChildPropsçš„ä¾èµ–é¡¹å¼•å‘actualChildPropsçš„æ”¹å˜\n    &#x2F;&#x2F; actualChildPropsåˆæ˜¯å®é™…æ¸²æŸ“ç»„ä»¶çš„ä¾èµ–æ€§ï¼Œä»è€Œå¼•å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“æ›´æ–°\n    forceComponentUpdateDispatch(&#123;\n      type: &#39;STORE_UPDATED&#39;,\n      payload: &#123;\n        error\n      &#125;\n    &#125;)\n  &#125;\n&#125;\n\ncheckForUpdates é€šè¿‡è°ƒç”¨ childPropsSelectoræ¥å½¢æˆæ–°çš„props,ç„¶ååˆ¤æ–­ä¹‹å‰çš„ prop å’Œå½“å‰æ–°çš„ prop æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœç›¸ç­‰ï¼Œè¯æ˜æ²¡æœ‰å‘ç”Ÿå˜åŒ–,æ— é¡»æ›´æ–°å½“å‰ç»„ä»¶ï¼Œé‚£ä¹ˆé€šè¿‡è°ƒç”¨notifyNestedSubsæ¥é€šçŸ¥å­ä»£å®¹å™¨ç»„ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å¦‚æœä¸ç›¸ç­‰è¯æ˜è®¢é˜…çš„store.stateå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç«‹å³æ‰§è¡ŒforceComponentUpdateDispatchæ¥è§¦å‘ç»„ä»¶çš„æ›´æ–°\n\n\næ•´ä¸ªè®¢é˜…æµç¨‹æ•´ä¸ªè®¢é˜…çš„æµç¨‹æ˜¯ï¼Œå¦‚æœè¢«connectåŒ…è£¹ï¼Œå¹¶ä¸”å…·æœ‰ç¬¬ä¸€ä¸ªå‚æ•°ã€‚é¦–å…ˆé€šè¿‡contextè·å–æœ€è¿‘çš„ subscriptionï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„subscription,å¹¶ä¸”å’Œçˆ¶çº§çš„subscriptionå»ºç«‹èµ·å…³è”ã€‚å½“ç¬¬ä¸€æ¬¡hocå®¹å™¨ç»„ä»¶æŒ‚åœ¨å®Œæˆåï¼Œåœ¨useEffecté‡Œï¼Œè¿›è¡Œè®¢é˜…ï¼Œå°†è‡ªå·±çš„è®¢é˜…å‡½æ•°checkForUpdates,ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œé€šè¿‡trySubscribe å’Œthis.parentSub.addNestedSub ,åŠ å…¥åˆ°çˆ¶çº§subscriptionçš„listenersä¸­ã€‚ç”±æ­¤å®Œæˆæ•´ä¸ªè®¢é˜…æµç¨‹\næ•´ä¸ªå‘å¸ƒæµç¨‹æ•´ä¸ªæ›´æ–°æµç¨‹æ˜¯ï¼Œå½“ç»„ä»¶ä¸­è°ƒç”¨dispatchè§¦å‘äº†reduxçš„stateæ”¹å˜å’Œreduxçš„è®¢é˜…å™¨ï¼Œä»è€Œè§¦å‘æ ¹è®¢é˜…å™¨çš„è§¦å‘listeners.notify ,ä¹Ÿå°±æ˜¯checkForUpdateså‡½æ•°ï¼Œç„¶åcheckForUpdateså‡½æ•°é¦–å…ˆæ ¹æ®mapStoretopropsï¼Œmergepropsç­‰æ“ä½œï¼ŒéªŒè¯è¯¥ç»„ä»¶æ˜¯å¦å‘èµ·è®¢é˜…ï¼Œprops æ˜¯å¦æ”¹å˜ï¼Œå¹¶æ›´æ–°ï¼Œå¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆè§¦å‘useReducerçš„forceComponentUpdateDispatchå‡½æ•°ï¼Œæ¥æ›´æ–°ä¸šåŠ¡ç»„ä»¶ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œé‚£ä¹ˆé€šè¿‡è°ƒç”¨notifyNestedSubs,æ¥é€šçŸ¥å½“å‰subscriptionçš„listenersæ£€æŸ¥æ˜¯å¦æ›´æ–°ï¼Œç„¶åå°½å¿ƒå±‚å±‚checkForUpdates,é€çº§å‘ä¸‹ï¼Œå€Ÿæ­¤å®Œæˆæ•´ä¸ªæ›´æ–°æµç¨‹ã€‚\næ€»ç»“\nconnectä½¿ç”¨æŸ¯é‡ŒåŒ–\nuseMemoç¼“å­˜æ¸²æŸ“ç»„ä»¶çš„æ“ä½œ\nå‘å¸ƒè®¢é˜…æ¨¡å¼ä»¥åŠé€šè¿‡åŒå‘é“¾è¡¨æ¥ç®¡ç†\nå¦‚ä½•é€šè¿‡Providerè¿›è¡Œå±‚å±‚è®¢é˜…\nreact-reduxè§¦å‘æ›´æ–°çš„ä¾æ®æ˜¯actualChildPropsæ˜¯å¦æ”¹å˜\n\nå‚è€ƒreact-reduxæºç è§£ægithub æºç React-reduxæºç è§£æâ€“å‡†å¤‡çŸ¥è¯†React-reduxæºç è§£æ\n","slug":"2022-05-24react-redux2","date":"2022-05-24T13:15:31.000Z","categories_index":"react-redux","tags_index":"react-redux,redux,æºç ","author_index":"é™ˆæµ·é¾™"},{"id":"83401137c3fcd92a859b6d9e289c2c88","title":"react-redux æºç 1","content":"react-reduxå®˜æ–¹ä»‹ç»\nå®˜æ–¹UIç»‘å®šå±‚ã€‚ React Redux is the official React UI bindings layer for Redux. \nä»reduxçš„storeè¯»æ•°æ®ã€‚ It lets your React components read data from a Redux store,\nè§¦å‘è¡Œä¸ºç»™storeæ¥æ›´æ–°çŠ¶æ€ã€‚and dispatch actions to the store to update state.\n\nreact-redux æºç .\nâ”œâ”€â”€ alternate-renderers.ts\nâ”œâ”€â”€ components\nâ”‚Â Â  â”œâ”€â”€ Context.ts\nâ”‚Â Â  â”œâ”€â”€ Provider.tsx\nâ”‚Â Â  â””â”€â”€ connect.tsx # å¤§éƒ¨åˆ†ä»£ç éƒ½åœ¨è¿™é‡Œ\nâ”œâ”€â”€ connect # ç»™ connect.tsxä½¿ç”¨\nâ”‚Â Â  â”œâ”€â”€ invalidArgFactory.ts\nâ”‚Â Â  â”œâ”€â”€ mapDispatchToProps.ts\nâ”‚Â Â  â”œâ”€â”€ mapStateToProps.ts\nâ”‚Â Â  â”œâ”€â”€ mergeProps.ts\nâ”‚Â Â  â”œâ”€â”€ selectorFactory.ts\nâ”‚Â Â  â”œâ”€â”€ verifySubselectors.ts\nâ”‚Â Â  â””â”€â”€ wrapMapToProps.ts\nâ”œâ”€â”€ exports.ts\nâ”œâ”€â”€ hooks\nâ”‚Â Â  â”œâ”€â”€ useDispatch.ts\nâ”‚Â Â  â”œâ”€â”€ useReduxContext.ts\nâ”‚Â Â  â”œâ”€â”€ useSelector.ts\nâ”‚Â Â  â””â”€â”€ useStore.ts\nâ”œâ”€â”€ index.ts\nâ”œâ”€â”€ next.ts\nâ”œâ”€â”€ types.ts\nâ””â”€â”€ utils\n    â”œâ”€â”€ Subscription.ts\n    â”œâ”€â”€ batch.ts\n    â”œâ”€â”€ bindActionCreators.ts\n    â”œâ”€â”€ isPlainObject.ts\n    â”œâ”€â”€ reactBatchedUpdates.native.ts\n    â”œâ”€â”€ reactBatchedUpdates.ts\n    â”œâ”€â”€ shallowEqual.ts\n    â”œâ”€â”€ useIsomorphicLayoutEffect.native.ts\n    â”œâ”€â”€ useIsomorphicLayoutEffect.ts\n    â”œâ”€â”€ useSyncExternalStore.ts\n    â”œâ”€â”€ verifyPlainObject.ts\n    â””â”€â”€ warning.ts\npackge.json&#x2F;&#x2F; packge.json\n&#123;\n  &quot;name&quot;: &quot;react-redux&quot;,\n  &quot;version&quot;: &quot;8.0.2&quot;,\n  &quot;description&quot;: &quot;Official React bindings for Redux&quot;,\n  &quot;keywords&quot;: [\n    &quot;react&quot;,\n    &quot;reactjs&quot;,\n    &quot;redux&quot;\n  ],\n  &quot;license&quot;: &quot;MIT&quot;,\n  &quot;author&quot;: &quot;Dan Abramov &lt;dan.abramov@me.com&gt; (https:&#x2F;&#x2F;github.com&#x2F;gaearon)&quot;,\n  &quot;homepage&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;reduxjs&#x2F;react-redux&quot;,\n  &quot;repository&quot;: &quot;github:reduxjs&#x2F;react-redux&quot;,\n  &quot;bugs&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;reduxjs&#x2F;react-redux&#x2F;issues&quot;,\n  &#x2F;&#x2F; æ‰¾æ‰¾å…¥å£ï¼Œå…¥å£æœ‰3ç§ï¼š\n  &quot;main&quot;: &quot;.&#x2F;lib&#x2F;index.js&quot;, &#x2F;&#x2F; å¸¸è§„æ“ä½œå…¥å£\n  &quot;types&quot;: &quot;.&#x2F;es&#x2F;index.d.ts&quot;, &#x2F;&#x2F; ç±»å‹å…¥å£\n  &quot;unpkg&quot;: &quot;dist&#x2F;react-redux.js&quot;, &#x2F;&#x2F; cdnå…¥å£\n  &quot;module&quot;: &quot;es&#x2F;index.js&quot;,&#x2F;&#x2F;esmå…¥å£\n  &#x2F;&#x2F; npmå‘å¸ƒä¸Šä¼ çš„æ–‡ä»¶\n  &quot;files&quot;: [\n    &quot;dist&quot;,\n    &quot;lib&quot;,\n    &quot;src&quot;, &#x2F;&#x2F; ä¸€èˆ¬ç”¨äºå¼€å‘é˜¶æ®µä»£ç è°ƒè¯•,soucemap\n    &quot;es&quot;\n  ],\n  &quot;scripts&quot;: &#123;\n    &#x2F;&#x2F; è„šæœ¬ä¸çœ‹äº†...\n  &#125;,\n  &#x2F;&#x2F; é…ç½®äº†ä¾èµ–é¡¹ï¼Œè¿™äº›ä¾èµ–é¡¹ä¸éœ€è¦åœ¨æœ¬åŒ…å®‰è£…ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£…å³å¯\n  &quot;peerDependencies&quot;: &#123;\n    &quot;@types&#x2F;react&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,\n    &quot;@types&#x2F;react-dom&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,\n    &quot;react&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,\n    &quot;react-dom&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,\n    &quot;react-native&quot;: &quot;&gt;&#x3D;0.59&quot;,\n    &quot;redux&quot;: &quot;^4&quot;\n  &#125;,\n  &quot;peerDependenciesMeta&quot;: &#123;\n    &quot;@types&#x2F;react&quot;: &#123;\n      &quot;optional&quot;: true\n    &#125;,\n    &quot;@types&#x2F;react-dom&quot;: &#123;\n      &quot;optional&quot;: true\n    &#125;,\n    &quot;react-dom&quot;: &#123;\n      &quot;optional&quot;: true\n    &#125;,\n    &quot;react-native&quot;: &#123;\n      &quot;optional&quot;: true\n    &#125;,\n    &quot;redux&quot;: &#123;\n      &quot;optional&quot;: true\n    &#125;\n  &#125;,\n  &#x2F;&#x2F; å‘å¸ƒåï¼Œä¸šåŠ¡å¼€å‘è€…ä½¿ç”¨ï¼Œéœ€è¦å®‰è£…ï¼Œ&#x2F;&#x2F;è‡ªåŠ¨å®‰è£…\n  &quot;dependencies&quot;: &#123;\n    &quot;@babel&#x2F;runtime&quot;: &quot;^7.12.1&quot;,\n    &quot;@types&#x2F;hoist-non-react-statics&quot;: &quot;^3.3.1&quot;,\n    &quot;@types&#x2F;use-sync-external-store&quot;: &quot;^0.0.3&quot;,\n    &quot;hoist-non-react-statics&quot;: &quot;^3.3.2&quot;,\n    &quot;react-is&quot;: &quot;^18.0.0&quot;,\n    &quot;use-sync-external-store&quot;: &quot;^1.0.0&quot;\n  &#125;,\n  &#x2F;&#x2F; å¼€å‘é˜¶æ®µéœ€è¦ç”¨åˆ°çš„ï¼Œä¸€èˆ¬æ˜¯examplesä¸­demoä½¿ç”¨\n  &quot;devDependencies&quot;: &#123;\n    &#x2F;&#x2F;...\n  &#125;\n&#125;\nexports.tsexport &#123;\n  Provider, &#x2F;&#x2F; import Provider from &#39;.&#x2F;components&#x2F;Provider&#39;\n\n  ReactReduxContext, &#x2F;&#x2F; import &#123; ReactReduxContext &#125; from &#39;.&#x2F;components&#x2F;Context&#39;\n\n  connect, &#x2F;&#x2F; import connect from &#39;.&#x2F;components&#x2F;connect&#39;\n\n  useDispatch, &#x2F;&#x2F; import &#123; useDispatch, createDispatchHook &#125; from &#39;.&#x2F;hooks&#x2F;useDispatch&#39;\n  createDispatchHook, &#x2F;&#x2F; import &#123; useDispatch, createDispatchHook &#125; from &#39;.&#x2F;hooks&#x2F;useDispatch&#39;\n\n  useSelector, &#x2F;&#x2F; import &#123; useSelector, createSelectorHook &#125; from &#39;.&#x2F;hooks&#x2F;useSelector&#39;\n  createSelectorHook, &#x2F;&#x2F; import &#123; useSelector, createSelectorHook &#125; from &#39;.&#x2F;hooks&#x2F;useSelector&#39;\n\n  useStore, &#x2F;&#x2F; import &#123; useStore, createStoreHook &#125; from &#39;.&#x2F;hooks&#x2F;useStore&#39;\n  createStoreHook, &#x2F;&#x2F; import &#123; useStore, createStoreHook &#125; from &#39;.&#x2F;hooks&#x2F;useStore&#39;\n\n  shallowEqual, &#x2F;&#x2F; import shallowEqual from &#39;.&#x2F;utils&#x2F;shallowEqual&#39;\n&#125;\n\n\nProviderå…ˆçœ‹ä¸‹ ï¼Œæœ€ç†Ÿæ‚‰çš„api\n&#x2F;&#x2F; components&#x2F;Provider.tsx\n&#x2F;&#x2F; è¿™ä¸ªç»„ä»¶åšçš„äº‹æƒ…\n&#x2F;&#x2F; 1. åˆå¹¶æµè§ˆå™¨å’ŒæœåŠ¡å™¨çš„çŠ¶æ€\n&#x2F;&#x2F; 2. å¯¹äºåŒæ„çš„åº”ç”¨ï¼Œå¤„ç†subscriptionè®¢é˜…\nfunction Provider&lt;A extends Action &#x3D; AnyAction&gt;(&#123;\n  store,\n  context,\n  children,\n  serverState,\n&#125;: ProviderProps&lt;A&gt;) &#123;\n  &#x2F;&#x2F; 1.useMemoï¼Œå¯¹å…¥å‚è¿›è¡Œæ ¼å¼åŒ–ã€Œå¤„ç†äº†storeå’Œ æœåŠ¡ç«¯çš„ serverStateã€\n  const contextValue &#x3D; useMemo(() &#x3D;&gt; &#123;\n    const subscription &#x3D; createSubscription(store)\n    return &#123;\n      store,\n      subscription,\n      getServerState: serverState ? () &#x3D;&gt; serverState : undefined,\n    &#125;\n  &#125;, [store, serverState])\n  &#x2F;&#x2F; 2.ä¹‹å‰çš„stateçŠ¶æ€ä»storeä¸­ç›´æ¥è·å–\n  const previousState &#x3D; useMemo(() &#x3D;&gt; store.getState(), [store])\n  &#x2F;&#x2F; 3.åŒæ„ç›¸å…³ï¼Œè·³è¿‡\n  useIsomorphicLayoutEffect(() &#x3D;&gt; &#123;\n    const &#123; subscription &#125; &#x3D; contextValue\n    subscription.onStateChange &#x3D; subscription.notifyNestedSubs\n    subscription.trySubscribe()\n\n    if (previousState !&#x3D;&#x3D; store.getState()) &#123;\n      subscription.notifyNestedSubs()\n    &#125;\n    return () &#x3D;&gt; &#123;\n      subscription.tryUnsubscribe()\n      subscription.onStateChange &#x3D; undefined\n    &#125;\n  &#125;, [contextValue, previousState])\n  &#x2F;&#x2F; 4.react-reduxä¸Šä¸‹æ–‡\n  const Context &#x3D; context || ReactReduxContext\n\n  &#x2F;&#x2F; @ts-ignore &#39;AnyAction&#39; is assignable to the constraint of type &#39;A&#39;, but &#39;A&#39; could be instantiated with a different subtype\n  return &lt;Context.Provider value&#x3D;&#123;contextValue&#125;&gt;&#123;children&#125;&lt;&#x2F;Context.Provider&gt; &#x2F;&#x2F; è¿™è¡Œä»£ç æ˜¯ä¸æ˜¯éå¸¸ç†Ÿæ‚‰äº†\n&#125;\n\nexport default Provider\n\nReactReduxContext&#x2F;&#x2F; .&#x2F;components&#x2F;Context.tsx\n&#x2F;&#x2F; è¿™ä¸ªç»„ä»¶åšçš„äº‹æƒ…\n&#x2F;&#x2F; 1.åˆ›å»ºä¸ªcreateContext\n&#x2F;&#x2F; 2.ç»™ä¸ªåå­—displayName\n\n&#x2F;&#x2F; ...ç±»å‹ä»£ç ä¸å…³æ³¨\nexport const ReactReduxContext &#x3D;&#x2F;*#__PURE__*&#x2F; React.createContext&lt;ReactReduxContextValue&gt;(null as any)\n\n&#x2F;&#x2F; ...ç±»å‹ä»£ç ä¸å…³æ³¨\n\nif (process.env.NODE_ENV !&#x3D;&#x3D; &#39;production&#39;) &#123;\n  ReactReduxContext.displayName &#x3D; &#39;ReactRedux&#39;\n&#125;\n\nexport default ReactReduxContext\nconnect&#x2F;&#x2F; .&#x2F;components&#x2F;connect.tsx\n&#x2F;&#x2F; è¿™ä¸ªæ–‡ä»¶æ¯”è¾ƒé•¿ï¼Œå…ˆä¸çœ‹\n&#x2F;&#x2F; hoist-non-react-staticsè¿™ä¸ªä¾èµ–å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨æ‹·è´éReactçš„é™æ€æ–¹æ³•\nuseDispatchã€createDispatchHookæŠŠtsç±»å‹åˆ åˆ ï¼Œçœ‹ä¸Šå»æ›´ç®€å•äº†\n&#x2F;&#x2F; .&#x2F;hooks&#x2F;useDispatch\n&#x2F;&#x2F; ç”¨createDispatchHooké’©å­å·¥å‚åˆ›å»ºäº†ä¸ªé’©å­useDispatch\nexport function createDispatchHook(context) &#123;\n  &#x2F;&#x2F; TODO: createStoreHookä¸‹é¢å†çœ‹ï¼Œå…ˆè·³è¿‡\n  const useStore &#x3D; context &#x3D;&#x3D;&#x3D; ReactReduxContext ? useDefaultStore : createStoreHook(context)\n  return function useDispatch() &#123;\n    const store &#x3D; useStore()\n    &#x2F;&#x2F; @ts-ignore\n    return store.dispatch\n  &#125;\n&#125;\n&#x2F;**\n * A hook to access the redux &#96;dispatch&#96; function.\n *\n * @returns &#123;any|function&#125; redux store&#39;s &#96;dispatch&#96; function\n *\n * @example\n *\n * import React, &#123; useCallback &#125; from &#39;react&#39;\n * import &#123; useDispatch &#125; from &#39;react-redux&#39;\n *\n * export const CounterComponent &#x3D; (&#123; value &#125;) &#x3D;&gt; &#123;\n *   const dispatch &#x3D; useDispatch()\n *   const increaseCounter &#x3D; useCallback(() &#x3D;&gt; dispatch(&#123; type: &#39;increase-counter&#39; &#125;), [])\n *   return (\n *     &lt;div&gt;\n *       &lt;span&gt;&#123;value&#125;&lt;&#x2F;span&gt;\n *       &lt;button onClick&#x3D;&#123;increaseCounter&#125;&gt;Increase counter&lt;&#x2F;button&gt;\n *     &lt;&#x2F;div&gt;\n *   )\n * &#125;\n *&#x2F;\nexport const useDispatch &#x3D; &#x2F;*#__PURE__*&#x2F; createDispatchHook()\n\nuseSelectorã€createSelectorHook&#x2F;&#x2F; .&#x2F;hooks&#x2F;useSelector\n&#x2F;&#x2F; ç”¨ createSelectorHook é’©å­å·¥å‚åˆ›å»ºäº†ä¸ªé’©å­ useSelector\n\nlet useSyncExternalStoreWithSelector &#x3D; notInitialized as uSESWS\nexport const initializeUseSelector &#x3D; (fn: uSESWS) &#x3D;&gt; &#123;\n  useSyncExternalStoreWithSelector &#x3D; fn\n&#125;\n\nconst refEquality: EqualityFn&lt;any&gt; &#x3D; (a, b) &#x3D;&gt; a &#x3D;&#x3D;&#x3D; b\n\n&#x2F;&#x2F; ä¸‹é¢çš„ä»£ç ä¿ç•™èŒƒå‹ï¼ŒSelected\nexport function createSelectorHook(\n  context &#x3D; ReactReduxContext\n): &lt;TState &#x3D; unknown, Selected &#x3D; unknown&gt;(\n  selector: (state: TState) &#x3D;&gt; Selected,\n  equalityFn?: EqualityFn&lt;Selected&gt;\n) &#x3D;&gt; Selected &#123;\n  const useReduxContext &#x3D;\n    context &#x3D;&#x3D;&#x3D; ReactReduxContext\n      ? useDefaultReduxContext\n      : () &#x3D;&gt; useContext(context)\n\n  return function useSelector(\n    selector,\n    equalityFn &#x3D; refEquality\n  ) &#123;\n\n    const &#123; store, subscription, getServerState &#125; &#x3D; useReduxContext()!\n\n    const selectedState &#x3D; useSyncExternalStoreWithSelector(\n      subscription.addNestedSub,\n      store.getState,\n      getServerState || store.getState,\n      selector,\n      equalityFn\n    )\n\n    useDebugValue(selectedState) &#x2F;&#x2F; æ ‡è®°\n\n    return selectedState\n  &#125;\n&#125;\n\n&#x2F;**\n * A hook to access the redux store&#39;s state. This hook takes a selector function\n * as an argument. The selector is called with the store state.\n *\n * This hook takes an optional equality comparison function as the second parameter\n * that allows you to customize the way the selected state is compared to determine\n * whether the component needs to be re-rendered.\n *\n * @param &#123;Function&#125; selector the selector function\n * @param &#123;Function&#x3D;&#125; equalityFn the function that will be used to determine equality\n *\n * @returns &#123;any&#125; the selected state\n *\n * @example\n *\n * import React from &#39;react&#39;\n * import &#123; useSelector &#125; from &#39;react-redux&#39;\n *\n * export const CounterComponent &#x3D; () &#x3D;&gt; &#123;\n *   const counter &#x3D; useSelector(state &#x3D;&gt; state.counter)\n *   return &lt;div&gt;&#123;counter&#125;&lt;&#x2F;div&gt;\n * &#125;\n *&#x2F;\nexport const useSelector &#x3D; &#x2F;*#__PURE__*&#x2F; createSelectorHook()\nuseStoreã€createStoreHook\n&#x2F;&#x2F; 1.ç”¨é’©å­å·¥å‚åˆ›å»ºäº†ä¸ªé’©å­\n&#x2F;&#x2F; 2.ä»   const &#123; store &#125; &#x3D; useReduxContext()! è·å–store\n\n&#x2F;**\n * Hook factory, which creates a &#96;useStore&#96; hook bound to a given context.\n *\n * @param &#123;React.Context&#125; [context&#x3D;ReactReduxContext] Context passed to your &#96;&lt;Provider&gt;&#96;.\n * @returns &#123;Function&#125; A &#96;useStore&#96; hook bound to the specified context.\n *&#x2F;\nexport function createStoreHook&lt;\n  S &#x3D; unknown,\n  A extends BasicAction &#x3D; AnyAction\n  &#x2F;&#x2F; @ts-ignore\n&gt;(context?: Context&lt;ReactReduxContextValue&lt;S, A&gt;&gt; &#x3D; ReactReduxContext) &#123;\n  const useReduxContext &#x3D;\n    &#x2F;&#x2F; @ts-ignore\n    context &#x3D;&#x3D;&#x3D; ReactReduxContext\n      ? useDefaultReduxContext\n      : () &#x3D;&gt; useContext(context)\n  return function useStore&lt;\n    State &#x3D; S,\n    Action extends BasicAction &#x3D; A\n    &#x2F;&#x2F; @ts-ignore\n  &gt;() &#123;\n    const &#123; store &#125; &#x3D; useReduxContext()!\n    &#x2F;&#x2F; @ts-ignore\n    return store as Store&lt;State, Action&gt;\n  &#125;\n&#125;\n\n&#x2F;**\n * A hook to access the redux store.\n *\n * @returns &#123;any&#125; the redux store\n *\n * @example\n *\n * import React from &#39;react&#39;\n * import &#123; useStore &#125; from &#39;react-redux&#39;\n *\n * export const ExampleComponent &#x3D; () &#x3D;&gt; &#123;\n *   const store &#x3D; useStore()\n *   return &lt;div&gt;&#123;store.getState()&#125;&lt;&#x2F;div&gt;\n * &#125;\n *&#x2F;\nexport const useStore &#x3D; &#x2F;*#__PURE__*&#x2F; createStoreHook()\n\nconnect è§ï¼šreact-redux æºç 2\n","slug":"2022-05-24react-redux","date":"2022-05-24T05:58:32.000Z","categories_index":"react-redux","tags_index":"react-redux,redux,æºç ","author_index":"é™ˆæµ·é¾™"},{"id":"eb38c4ce852a081263435b4198b57084","title":"flex width:0","content":"flexåµŒå¥—å†…éƒ¨å…ƒç´ å®½åº¦é»˜è®¤100%ï¼Œæ’‘å¼€çˆ¶å…ƒç´ ï¼Œçˆ¶å…ƒç´ çš„æ ¹å…ƒç´ é™åˆ¶æœ€å¤§å®½åº¦ï¼Œå­å…ƒç´ å¹¶ä¸å—flexæ§åˆ¶\né‡åˆ°å¤šæ¬¡äº†ï¼Œè¿™æ¬¡æ˜¯ç»´æŠ¤å…¶ä»–åŒäº‹çš„ä»£ç ï¼Œåˆæ’è§äº†ï¼Œè¯´æ˜è¿™ä¸ªé—®é¢˜å¾ˆå¸¸è§ï¼Œä¸€ä¸ªä¸ç•™ç¥ï¼Œå°±è¸©åˆ°äº†\næ ¹å…ƒç´ \n  â€¦â€¦\n  - çˆ¶å…ƒç´ flex\n  â€¦â€¦ flex\n   - å­å…ƒç´ flex(é»˜è®¤å®½åº¦100%)\n\n\n.doc-tree-base-title-node .doc-tree-base-title-text &gt; a &#123;\n    display: flex;\n    align-items: center;\n    color: #777;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    flex: 1;\n&#125;\n\né—®é¢˜\n è§‚å¯Ÿä¸‹å‘ç°ï¼Œflexæ˜¯åµŒå¥—çš„ï¼Œæœ€å¤–å±‚çš„è¿˜æ˜¯flexï¼Œä¸€å±‚ä¸€å±‚ï¼Œæœ€å¤–å±‚çš„å®½åº¦ï¼Œå´æ˜¯ç”±æœ€å†…å±‚çš„å®½åº¦å†³å®šï¼ˆè¿™ä¸ªè°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼‰\nè°ƒè¯•\nå›¾1\n\n \n\nå›¾2\n\n \n\nå›¾3\n\n \nåˆ†æ å›¾1 å…ƒç´ æ²¡æœ‰å®½åº¦ï¼Œå®½åº¦é»˜è®¤æ˜¯100%\n å›¾1åˆ°å›¾3æ˜¯ç”±aæ ‡ç­¾å­å…ƒç´ æ’‘å¼€çš„ï¼Œå®½åº¦æ˜¯100%,åŠ ä¸Šæ“ä½œæŒ‰é’®ï¼Œå…ƒç´ å®½åº¦è¶…100%\n è€Œåœ¨ä¾§è¾¹æ ‘ç»“æ„çš„æœ€å¤–å±‚è®¾ç½®äº†max-width: 500px,è€Œå†…éƒ¨å­å…ƒç´ å°ºå¯¸å´æ˜¯599.48 x 36\n æ˜¾ç„¶æ˜¯ä¸åˆç†çš„\nä¿®å¤ æ ¹å…ƒç´ \n  â€¦â€¦\n  - çˆ¶å…ƒç´ flex\n  â€¦â€¦ flex\n   - å­å…ƒç´ flex(é»˜è®¤å®½åº¦è®¾ç½®å®½åº¦0 æˆ–è€…å…¶ä»–å°ç‚¹çš„å®½åº¦ï¼Œè¶Šå°è¶Šå¥½)\n\n \nä»€ä¹ˆåŸå› å¯¼è‡´çš„MDN flex\nè¯­æ³•\n&#x2F;* å…³é”®å­—å€¼ *&#x2F;\nflex: auto;\nflex: initial;\nflex: none;\n\n&#x2F;* ä¸€ä¸ªå€¼, æ— å•ä½æ•°å­—: flex-grow *&#x2F;\nflex: 2;\n\n&#x2F;* ä¸€ä¸ªå€¼, width&#x2F;height: flex-basis *&#x2F;\nflex: 10em;\nflex: 30px;\nflex: min-content;\n\n&#x2F;* ä¸¤ä¸ªå€¼: flex-grow | flex-basis *&#x2F;\nflex: 1 30px;\n\n&#x2F;* ä¸¤ä¸ªå€¼: flex-grow | flex-shrink *&#x2F;\nflex: 2 2;\n\n&#x2F;* ä¸‰ä¸ªå€¼: flex-grow | flex-shrink | flex-basis *&#x2F;\nflex: 2 2 10%;\n\n&#x2F;*å…¨å±€å±æ€§å€¼ *&#x2F;\nflex: inherit;\nflex: initial;\nflex: unset;\n\n\n\nå¯ä»¥ä½¿ç”¨ä¸€ä¸ªï¼Œä¸¤ä¸ªæˆ–ä¸‰ä¸ªå€¼æ¥æŒ‡å®š flexå±æ€§ã€‚\n1.å•å€¼è¯­æ³•: å€¼å¿…é¡»ä¸ºä»¥ä¸‹å…¶ä¸­ä¹‹ä¸€:\n\nä¸€ä¸ªæ— å•ä½æ•°(&lt;number&gt;): å®ƒä¼šè¢«å½“ä½œflex: 1 0; çš„å€¼è¢«å‡å®šä¸º1ï¼Œç„¶å çš„å€¼è¢«å‡å®šä¸º0ã€‚\nä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦(width)å€¼: å®ƒä¼šè¢«å½“ä½œ çš„å€¼ã€‚\nå…³é”®å­—noneï¼Œautoæˆ–initial.\n\n2.åŒå€¼è¯­æ³•: ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ  çš„å€¼ã€‚ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä»¥ä¸‹ä¹‹ä¸€ï¼š\n\nä¸€ä¸ªæ— å•ä½æ•°ï¼šå®ƒä¼šè¢«å½“ä½œ  çš„å€¼ã€‚\nä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼: å®ƒä¼šè¢«å½“ä½œ  çš„å€¼ã€‚\n\n3.ä¸‰å€¼è¯­æ³•:\n\nç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ  çš„å€¼ã€‚\nç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ   çš„å€¼ã€‚\nç¬¬ä¸‰ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼ï¼Œ å¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ  çš„å€¼ã€‚\n\n å¯ä»¥çœ‹åˆ°å•å€¼ï¼Œä½œä¸ºåŒå€¼å¤„ç†\n flex-shrink:1;\nflex-basis: 0;\n\nflex-basis è‡ªæ¥çœ‹ä¸‹flex-base\n æŸ¥çœ‹æ–‡æ¡£åå‘ç°ï¼Œæ–‡æ¡£ä¸Šæ²¡è¯´å…³äºflex-basic: 0 çš„äº‹æƒ…,ç»™äº†ä¸ªæ¼”ç¤ºï¼Œä¹Ÿçœ‹ä¸å‡ºæ¥æƒ³è¡¨è¾¾ä»€ä¹ˆ\nflex-basis å±æ€§çš„å«ä¹‰w3c flex-basis-propertyflexå¸ƒå±€ä¸€èˆ¬ç”±flexå®¹å™¨ï¼ˆdisplay å±æ€§å€¼ä¸º flex æˆ– inline-flexï¼‰å’Œå…¶å­å…ƒç´ ï¼ˆåæ–‡äº¦ç§°flexå­é¡¹æˆ–flex itemï¼‰æ„æˆã€‚flex-basis å±æ€§ä¸€èˆ¬ä½œç”¨åœ¨flexå­é¡¹ä¸Šï¼Œå®ƒå®šä¹‰äº†ï¼šåœ¨flexå®¹å™¨åˆ†é…å‰©ä½™ç©ºé—´å‰flexå­é¡¹åœ¨ä¸»è½´æ–¹å‘ä¸Šçš„åˆå§‹å°ºå¯¸ã€‚flexå­é¡¹åœ¨ä¸»è½´æ–¹å‘ä¸Šçš„å®é™…å°ºå¯¸æ˜¯æ ¹æ®å…ƒç´ è‡ªèº«å°ºå¯¸ã€flex-basisã€flex-growã€flex-shrink ç­‰å±æ€§å…±åŒå†³å®šçš„ã€‚å¦‚ä½•è®¡ç®—å®é™…å°ºå¯¸ä¸æ˜¯æœ¬æ–‡é‡ç‚¹ï¼Œä¸ç»§ç»­å±•å¼€ã€‚\nflex-basis:0pxä¸0%\nå¦‚æœ flex-basis çš„å€¼ä¸ºç™¾åˆ†æ•°ï¼Œä¸”å®ƒflexå®¹å™¨çš„å°ºå¯¸æ²¡æœ‰è¢«æ˜¾å¼è®¾ç½®ï¼Œæ­¤æ—¶ flex-basis çš„å€¼ä¼šè¢«è§£æä¸º content\n\n\nå…¶ä»–ï¼Œå€¼å¾—ä¸€çœ‹flex: 1åœ¨æµè§ˆå™¨ä¸­ï¼Œflex: 1 çš„ flex-basis å€¼ä¸ºä»€ä¹ˆä¸æ˜¯W3Cæ–‡æ¡£ä¸­æåˆ°çš„ 0 ï¼Ÿ\nå½“ä½¿ç”¨ flex å±æ€§ä½†åˆçœç•¥ä¸å†™å®ƒå…¶ä¸­çš„ flex-basis å€¼æ—¶ï¼Œä¼šå°† flex-basis è®¾ç½®ä¸º 0.\nè¿™é‡Œçš„ 0 å•ä½æ˜¯ px è¿˜æ˜¯ % æˆ‘ä»¬åœ¨Chromeæµè§ˆå™¨é‡Œå°±èƒ½éªŒè¯ï¼š\n\n\nç­”æ¡ˆæ˜¯ px.\nè¿™æ®µæ˜¯2015å¹´ä¿®æ­£æ—¥å¿—é‡Œçš„ï¼Œæ„æ€æ˜¯å°†ä¹‹å‰ flex ç®€å†™è¯­æ³•é‡Œçš„ flex-basis çš„è§£æå€¼ä» 0% æ¢å¤ä¸ºåŸæ¥çš„ 0.\næ³¨æ„ï¼š è¿™ä¸ªå€¼çš„è§£æè§„åˆ™ç»å†äº† 0px -&gt; 0% -&gt; 0px çš„å˜åŒ–ï¼Œè¿™æ˜¯W3C flex æ ‡å‡†æ–‡æ¡£çš„è§†è§’ã€‚\nç®€è€Œè¨€ä¹‹å°±æ˜¯æœ‰å…¼å®¹æ€§é—®é¢˜ã€‚ç°åœ¨å·²æœ‰å¾ˆå¤šç½‘é¡µéƒ½åˆ©ç”¨äº† flex å±æ€§çš„è¿™ä¸ªç‰¹æ€§æ¥å¼€å‘ã€‚å¦‚æœç®€å†™è¯­æ³•é‡Œ flex-basis çš„è§£æä» 0% å˜ä¸º 0px ä¼šå¯¼è‡´éƒ¨åˆ†æƒ…å†µä¸‹flexå®¹å™¨å¡Œé™·ï¼Œè‡´ä½¿å¾ˆå¤šç½‘é¡µå¼‚å¸¸\nå»ºè®®çœ‹åŸæ–‡\n","slug":"2022-05-23width0","date":"2022-05-23T09:16:21.000Z","categories_index":"css3","tags_index":"bug,css3","author_index":"é™ˆæµ·é¾™"},{"id":"436e39263be04b5730d01a19facc4657","title":"CSSå¦‚ä½•å·¥ä½œ","content":"æµè§ˆå™¨å·¥ä½œåŸç†\n\n\n\n\n\n\n\n\nå½“æµè§ˆå™¨å±•ç¤ºä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå®ƒå¿…é¡»å…¼é¡¾æ–‡ä»¶çš„å†…å®¹å’Œæ–‡ä»¶çš„æ ·å¼ä¿¡æ¯\nå¦‚ä½•åŠ è½½CSSå’ŒHTMLä¸‹é¢çš„æ­¥éª¤æ˜¯æµè§ˆåŠ è½½ç½‘é¡µçš„ç®€åŒ–ç‰ˆæœ¬:\n\næµè§ˆå™¨è½½å…¥HTMLæ–‡ä»¶ï¼ˆæ¯”å¦‚ä»ç½‘ç»œä¸Šè·å–ï¼‰ã€‚\nå°†HTMLæ–‡ä»¶è½¬åŒ–æˆä¸€ä¸ªDOMï¼ˆDocument Object Modelï¼‰ï¼ŒDOMæ˜¯æ–‡ä»¶åœ¨è®¡ç®—æœºå†…å­˜ä¸­çš„è¡¨ç°å½¢å¼ï¼Œä¸‹ä¸€èŠ‚å°†æ›´åŠ è¯¦ç»†çš„è§£é‡ŠDOMã€‚\næ¥ä¸‹æ¥ï¼Œæµè§ˆå™¨ä¼šæ‹‰å–è¯¥HTMLç›¸å…³çš„å¤§éƒ¨åˆ†èµ„æºï¼Œæ¯”å¦‚åµŒå…¥åˆ°é¡µé¢çš„å›¾ç‰‡ã€è§†é¢‘å’ŒCSSæ ·å¼ã€‚JavaScriptåˆ™ä¼šç¨åè¿›è¡Œå¤„ç†ï¼Œç®€å•èµ·è§ï¼ŒåŒæ—¶æ­¤èŠ‚ä¸»è®²CSSï¼Œæ‰€ä»¥è¿™é‡Œå¯¹å¦‚ä½•åŠ è½½JavaScriptä¸ä¼šå±•å¼€å™è¿°ã€‚\næµè§ˆå™¨æ‹‰å–åˆ°CSSä¹‹åä¼šè¿›è¡Œè§£æï¼Œæ ¹æ®é€‰æ‹©å™¨çš„ä¸åŒç±»å‹ï¼ˆæ¯”å¦‚elementã€classã€idç­‰ç­‰ï¼‰æŠŠä»–ä»¬åˆ†åˆ°ä¸åŒçš„â€œæ¡¶â€ä¸­ã€‚æµè§ˆå™¨åŸºäºå®ƒæ‰¾åˆ°çš„ä¸åŒçš„é€‰æ‹©å™¨ï¼Œå°†ä¸åŒçš„è§„åˆ™ï¼ˆåŸºäºé€‰æ‹©å™¨çš„è§„åˆ™ï¼Œå¦‚å…ƒç´ é€‰æ‹©å™¨ã€ç±»é€‰æ‹©å™¨ã€idé€‰æ‹©å™¨ç­‰ï¼‰åº”ç”¨åœ¨å¯¹åº”çš„DOMçš„èŠ‚ç‚¹ä¸­ï¼Œå¹¶æ·»åŠ èŠ‚ç‚¹ä¾èµ–çš„æ ·å¼ï¼ˆè¿™ä¸ªä¸­é—´æ­¥éª¤ç§°ä¸ºæ¸²æŸ“æ ‘ï¼‰ã€‚\nä¸Šè¿°çš„è§„åˆ™åº”ç”¨äºæ¸²æŸ“æ ‘ä¹‹åï¼Œæ¸²æŸ“æ ‘ä¼šä¾ç…§åº”è¯¥å‡ºç°çš„ç»“æ„è¿›è¡Œå¸ƒå±€ã€‚\nç½‘é¡µå±•ç¤ºåœ¨å±å¹•ä¸Šï¼ˆè¿™ä¸€æ­¥è¢«ç§°ä¸ºç€è‰²ï¼‰ã€‚\n\nè¿è¡Œå›¾\n\n\n\n\næ— æ³•è§£æçš„CSSä¼šå‘ç”Ÿä»€ä¹ˆ\n\n\n\n\n\n\n\n\nç­”æ¡ˆå°±æ˜¯æµè§ˆå™¨ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œç»§ç»­è§£æä¸‹ä¸€ä¸ªCSSæ ·å¼ï¼\nä»¥ä¸‹æ˜¯åºŸè¯ï¼š\n\næµè§ˆå™¨å¹¶ä¸ä¼šåŒæ—¶å®ç°æ‰€æœ‰çš„æ–°CSSï¼Œæ­¤å¤–å¾ˆå¤šäººä¹Ÿä¸ä¼šä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ã€‚é‰´äºCSSä¸€ç›´ä¸æ–­çš„å¼€å‘ï¼Œå› æ­¤é¢†å…ˆäºæµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„èŒƒå›´ï¼Œé‚£ä¹ˆä½ ä¹Ÿè®¸ä¼šå¥½å¥‡å½“æµè§ˆå™¨é‡åˆ°æ— æ³•è§£æçš„CSSé€‰æ‹©å™¨æˆ–å£°æ˜çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ\n\nCSSè§„åˆ™ï¼š å¦‚æœä¸€ä¸ªæµè§ˆå™¨åœ¨è§£æä½ æ‰€ä¹¦å†™çš„CSSè§„åˆ™çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†æ— æ³•ç†è§£çš„å±æ€§æˆ–è€…å€¼ï¼Œå®ƒä¼šå¿½ç•¥è¿™äº›å¹¶ç»§ç»­è§£æä¸‹é¢çš„CSSå£°æ˜ã€‚åœ¨ä½ ä¹¦å†™äº†é”™è¯¯çš„CSSä»£ç ï¼ˆæˆ–è€…è¯¯æ‹¼å†™ï¼‰ï¼Œåˆæˆ–è€…å½“æµè§ˆå™¨é‡åˆ°å¯¹äºå®ƒæ¥è¯´å¾ˆæ–°çš„è¿˜æ²¡æœ‰æ”¯æŒçš„CSSä»£ç çš„æ—¶å€™ä¸Šè¿°çš„æƒ…å†µåŒæ ·ä¼šå‘ç”Ÿï¼ˆç›´æ¥å¿½ç•¥ï¼‰ã€‚\n\né€‰æ‹©å™¨ï¼š ç›¸ä¼¼çš„ï¼Œå½“æµè§ˆå™¨é‡åˆ°æ— æ³•è§£æçš„é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œä»–ä¼šç›´æ¥å¿½ç•¥æ•´ä¸ªé€‰æ‹©å™¨è§„åˆ™ï¼Œç„¶åè§£æä¸‹ä¸€ä¸ªCSSé€‰æ‹©å™¨ã€‚\n\n\n\n\nå…³äºDOMä¸€ä¸ªDOMæœ‰ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œæ ‡è®°è¯­è¨€ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ã€å±æ€§ä»¥åŠæ¯ä¸€æ®µæ–‡å­—éƒ½å¯¹åº”ç€ç»“æ„æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆNode&#x2F;DOMæˆ–DOM nodeï¼‰ã€‚èŠ‚ç‚¹ç”±èŠ‚ç‚¹æœ¬èº«å’Œå…¶ä»–DOMèŠ‚ç‚¹çš„å…³ç³»å®šä¹‰ï¼Œæœ‰äº›èŠ‚ç‚¹æœ‰çˆ¶èŠ‚ç‚¹ï¼Œæœ‰äº›èŠ‚ç‚¹æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼ˆåŒçº§èŠ‚ç‚¹ï¼‰ã€‚\nå¯¹äºDOMçš„ç†è§£ä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå¸®åŠ©ä½ è®¾è®¡ã€è°ƒè¯•å’Œç»´æŠ¤ä½ çš„CSSï¼Œå› ä¸ºDOMæ˜¯ä½ çš„CSSæ ·å¼å’Œæ–‡ä»¶å†…å®¹çš„ç»“åˆã€‚å½“ä½ ä½¿ç”¨æµè§ˆå™¨F12è°ƒè¯•çš„æ—¶å€™ä½ éœ€è¦æ“ä½œDOMä»¥æŸ¥çœ‹ä½¿ç”¨äº†å“ªäº›è§„åˆ™ã€‚\n&lt;p&gt;\n  Let&#39;s use:\n  &lt;span&gt;Cascading&lt;&#x2F;span&gt;\n  &lt;span&gt;Style&lt;&#x2F;span&gt;\n  &lt;span&gt;Sheets&lt;&#x2F;span&gt;\n&lt;&#x2F;p&gt;\n\n\nP\nâ”œâ”€ &quot;Let&#39;s use:&quot;\nâ”œâ”€ SPAN\n|  â””â”€ &quot;Cascading&quot;\nâ”œâ”€ SPAN\n|  â””â”€ &quot;Style&quot;\nâ””â”€ SPAN\n   â””â”€ &quot;Sheets&quot;\n\n\n\nå‚è€ƒMDN\n","slug":"2022-05-23css","date":"2022-05-23T07:53:28.000Z","categories_index":"æµè§ˆå™¨åŸç†","tags_index":"æµè§ˆå™¨åŸç†","author_index":"é™ˆæµ·é¾™"},{"id":"98f521cd056816f8a9831692e48a6839","title":"monorepo","content":"èƒŒæ™¯\nè°ƒè¯•æºç æ—¶å€™ï¼Œæ€»ä¼šé‡åˆ°å¤šåŒ…çš„ä»“åº“ï¼Œé‡åˆ°äº†ä¸æ™“å¾—å¦‚ä½•è°ƒè¯•\nå¼€å‘ä¸ªåº“æˆ–è€…æ˜¯æ’ä»¶ä¹‹ç±»çš„å¼€å‘çš„æ¯”è¾ƒæ··ä¹±\nç»å†å¤šä¸ªé¡¹ç›®çš„æ¯’æ‰“ï¼Œç»ˆäºæœ‰æ—¶é—´å­¦ä¸‹monorepo\n\nlernaã€yarn workspace\nå’Œjavaå¾®æœåŠ¡æ¶æ„ä»£ç å¾ˆåƒ\nå¾ˆå¤šé¡¹ç›®æ˜¯ lerna+yarn workspaceï¼Œå¦‚æœä¸æ‡‚ï¼Œæˆ–è€…äº†è§£äº†ä¸€ç‚¹lernaã€‚ä¸Šå»ä¸€é¡¿æ“ä½œï¼Œå„ç§æŠ¥é”™ï¼Œåœ¨æ‰€éš¾å…ï¼ˆäº²èº«ç»å†ï¼‰\n\nmonorepoç®¡ç†å¯¹äºç»´æŠ¤è¿‡å¤šä¸ªpackage(åŠŸèƒ½ç›¸è¿‘)çš„åŒå­¦æ¥è¯´ï¼Œéƒ½ä¼šé‡åˆ°ä¸€ä¸ªé€‰æ‹©é¢˜ï¼Œè¿™äº›packageæ˜¯æ”¾åœ¨ä¸€ä¸ªä»“åº“é‡Œç»´æŠ¤è¿˜æ˜¯æ”¾åœ¨å¤šä¸ªä»“åº“é‡Œå•ç‹¬ç»´æŠ¤ã€‚Multirepo æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„åšæ³•ï¼Œå³æ¯ä¸€ä¸ª package éƒ½å•ç‹¬ç”¨ä¸€ä¸ªä»“åº“æ¥è¿›è¡Œç®¡ç†ã€‚Monorepo æ˜¯ç®¡ç†é¡¹ç›®ä»£ç çš„ä¸€ä¸ªæ–¹å¼ï¼ŒæŒ‡åœ¨ä¸€ä¸ªé¡¹ç›®ä»“åº“ (repo) ä¸­ç®¡ç†å¤šä¸ªæ¨¡å—&#x2F;åŒ… (package)ï¼Œä¸åŒäºå¸¸è§çš„æ¯ä¸ªæ¨¡å—å»ºä¸€ä¸ª repoã€‚\nç›®å‰æœ‰ä¸å°‘å¤§å‹å¼€æºé¡¹ç›®é‡‡ç”¨äº†è¿™ç§æ–¹å¼ï¼Œå¦‚ Babelï¼ŒReact, Meteor, Ember, Angular,Jest, Umijs, Vue, è¿˜æœ‰ create-react-app, react-router ç­‰ã€‚å‡ ä¹æˆ‘ä»¬ç†ŸçŸ¥çš„ä»“åº“ï¼Œéƒ½æ— ä¸€ä¾‹å¤–çš„é‡‡ç”¨äº†monorepo çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹åˆ°è¿™äº›é¡¹ç›®çš„ç¬¬ä¸€çº§ç›®å½•çš„å†…å®¹ä»¥è„šæ‰‹æ¶ä¸ºä¸»ï¼Œä¸»è¦å†…å®¹éƒ½åœ¨ packagesç›®å½•ä¸­ã€åˆ†å¤šä¸ª package è¿›è¡Œç®¡ç†ã€‚\nç›®å½•ç»“æ„å¦‚ä¸‹:\nâ”œâ”€â”€ packages\n|   â”œâ”€â”€ pkg1\n|   |   â”œâ”€â”€ package.json\n|   â”œâ”€â”€ pkg2\n|   |   â”œâ”€â”€ package.json\nâ”œâ”€â”€ package.json\n\nmonorepo æœ€ä¸»è¦çš„å¥½å¤„æ˜¯ç»Ÿä¸€çš„å·¥ä½œæµå’ŒCode Sharingã€‚æ¯”å¦‚æˆ‘æƒ³çœ‹ä¸€ä¸ª pacakge çš„ä»£ç ã€äº†è§£æŸæ®µé€»è¾‘ï¼Œä¸éœ€è¦æ‰¾å®ƒçš„ repoï¼Œç›´æ¥å°±åœ¨å½“å‰ repoï¼›å½“æŸä¸ªéœ€æ±‚è¦ä¿®æ”¹å¤šä¸ª pacakge æ—¶ï¼Œä¸éœ€è¦åˆ†åˆ«åˆ°å„è‡ªçš„ repo è¿›è¡Œä¿®æ”¹ã€æµ‹è¯•ã€å‘ç‰ˆæˆ–è€… npm linkï¼Œç›´æ¥åœ¨å½“å‰ repo ä¿®æ”¹ï¼Œç»Ÿä¸€æµ‹è¯•ã€ç»Ÿä¸€å‘ç‰ˆã€‚åªè¦æ­å»ºä¸€å¥—è„šæ‰‹æ¶ï¼Œå°±èƒ½ç®¡ç†ï¼ˆæ„å»ºã€æµ‹è¯•ã€å‘å¸ƒï¼‰å¤šä¸ª packageã€‚\nä¸€å›¾èƒœåƒè¨€:\nå‰è€…å…è®¸å¤šå…ƒåŒ–å‘å±•ï¼ˆå„é¡¹ç›®å¯ä»¥æœ‰è‡ªå·±çš„æ„å»ºå·¥å…·ã€ä¾èµ–ç®¡ç†ç­–ç•¥ã€å•å…ƒæµ‹è¯•æ–¹æ³•ï¼‰ï¼Œåè€…å¸Œæœ›é›†ä¸­ç®¡ç†ï¼Œå‡å°‘é¡¹ç›®é—´çš„å·®å¼‚å¸¦æ¥çš„æ²Ÿé€šæˆæœ¬ã€‚\nè™½ç„¶æ‹†åˆ†å­ä»“åº“ã€æ‹†åˆ†å­ npm åŒ…æ˜¯è¿›è¡Œé¡¹ç›®éš”ç¦»çš„å¤©ç„¶æ–¹æ¡ˆï¼Œä½†å½“ä»“åº“å†…å®¹å‡ºç°å…³è”æ—¶ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ç§è°ƒè¯•æ–¹å¼æ¯”æºç æ”¾åœ¨ä¸€èµ·æ›´é«˜æ•ˆã€‚\nç»“åˆshop-serviceé—¨æˆ·çš„å®é™…åœºæ™¯å’Œä¸šåŠ¡éœ€è¦ï¼Œå¤©ç„¶çš„ MonoRepo ! ä¸€ä¸ªç†æƒ³çš„å¼€å‘ç¯å¢ƒå¯ä»¥æŠ½è±¡æˆè¿™æ ·ï¼š\n\n\n\n\n\n\n\n\n\nâ€œåªå…³å¿ƒä¸šåŠ¡ä»£ç ï¼Œå¯ä»¥ç›´æ¥è·¨ä¸šåŠ¡å¤ç”¨è€Œä¸å…³å¿ƒå¤ç”¨æ–¹å¼ï¼Œè°ƒè¯•æ—¶æ‰€æœ‰ä»£ç éƒ½åœ¨æºç ä¸­ã€‚â€\nåœ¨å‰ç«¯å¼€å‘ç¯å¢ƒä¸­ï¼Œå¤š Git Repoï¼Œå¤š npm åˆ™æ˜¯è¿™ä¸ªç†æƒ³çš„é˜»åŠ›ï¼Œå®ƒä»¬å¯¼è‡´å¤ç”¨è¦å…³å¿ƒç‰ˆæœ¬å·ï¼Œè°ƒè¯•éœ€è¦ npm linkã€‚è€Œè¿™äº›æ˜¯ MonoRepo æœ€å¤§çš„ä¼˜åŠ¿ã€‚\nä¸Šå›¾ä¸­æåˆ°çš„åˆ©ç”¨ç›¸å…³å·¥å…·å°±æ˜¯ä»Šå¤©çš„ä¸»è§’ Lerna ! Lernaæ˜¯ä¸šç•ŒçŸ¥ååº¦æœ€é«˜çš„ Monorepo ç®¡ç†å·¥å…·ï¼ŒåŠŸèƒ½å®Œæ•´ã€‚\nLernaLerna æ˜¯ä¸€ä¸ªç®¡ç†å¤šä¸ª npm æ¨¡å—çš„å·¥å…·ï¼Œæ˜¯ Babel è‡ªå·±ç”¨æ¥ç»´æŠ¤è‡ªå·±çš„ Monorepo å¹¶å¼€æºå‡ºçš„ä¸€ä¸ªé¡¹ç›®ã€‚ä¼˜åŒ–ç»´æŠ¤å¤šåŒ…çš„å·¥ä½œæµï¼Œè§£å†³å¤šä¸ªåŒ…äº’ç›¸ä¾èµ–ï¼Œä¸”å‘å¸ƒéœ€è¦æ‰‹åŠ¨ç»´æŠ¤å¤šä¸ªåŒ…çš„é—®é¢˜ã€‚\n2.1 å®‰è£…æ¨èå…¨å±€å®‰è£…ï¼Œå› ä¸ºä¼šç»å¸¸ç”¨åˆ° lerna å‘½ä»¤\nnpm i -g lerna\n2.2 åˆå§‹åŒ–é¡¹ç›®\nlerna init\n\nå…¶ä¸­ package.json &amp; lerna.json å¦‚ä¸‹:\n&#x2F;&#x2F; package.json\n&#123;\n  &quot;name&quot;: &quot;root&quot;,\n  &quot;private&quot;: true, &#x2F;&#x2F; ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å‘å¸ƒï¼Œæ˜¯ç®¡ç†æ•´ä¸ªé¡¹ç›®ï¼Œä¸è¦å‘å¸ƒåˆ°npmçš„è§£è€¦\n  &quot;devDependencies&quot;: &#123;\n    &quot;lerna&quot;: &quot;^3.15.0&quot;\n  &#125;\n&#125;\n \n&#x2F;&#x2F; lerna.json\n&#123;\n  &quot;packages&quot;: [\n    &quot;packages&#x2F;*&quot;\n  ],\n  &quot;version&quot;: &quot;0.0.0&quot;\n&#125;\n\n\n2.3 åˆ›å»ºnpmåŒ…å¢åŠ ä¸¤ä¸ª packages\n\n2.4 å¢åŠ æ¨¡å—ä¾èµ–åˆ†åˆ«ç»™ç›¸åº”çš„ package å¢åŠ ä¾èµ–æ¨¡å—\nlerna add chalk &#x2F;&#x2F; ä¸ºæ‰€æœ‰ package å¢åŠ  chalk æ¨¡å— \nlerna add semver --scope @mo-demo&#x2F;cli-shared-utils &#x2F;&#x2F; ä¸º @mo-demo&#x2F;cli-shared-utils å¢åŠ  semver æ¨¡å— \nlerna add @mo-demo&#x2F;cli-shared-utils --scope @mo-demo&#x2F;cli &#x2F;&#x2F; å¢åŠ å†…éƒ¨æ¨¡å—ä¹‹é—´çš„ä¾èµ–\n\n2.5 å‘å¸ƒ\nlerna publish\n\n2.6 ä¾èµ–åŒ…ç®¡ç†ä¸Šè¿°1-5æ­¥å·²ç»åŒ…å«äº† Lerna æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„è¿‡ç¨‹äº†ï¼Œä½†å½“æˆ‘ä»¬ç»´æŠ¤è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œæ–°æ‹‰ä¸‹æ¥ä»“åº“çš„ä»£ç åï¼Œéœ€è¦ä¸ºå„ä¸ª package å®‰è£…ä¾èµ–åŒ…ã€‚\næˆ‘ä»¬åœ¨ç¬¬4æ­¥ lerna add æ—¶ä¹Ÿå‘ç°äº†ï¼Œä¸ºæŸä¸ª package å®‰è£…çš„åŒ…è¢«æ”¾åˆ°äº†è¿™ä¸ª package ç›®å½•ä¸‹çš„ node_modules ç›®å½•ä¸‹ã€‚è¿™æ ·å¯¹äºå¤šä¸ª package éƒ½ä¾èµ–çš„åŒ…ï¼Œä¼šè¢«å¤šä¸ª package å®‰è£…å¤šæ¬¡ï¼Œå¹¶ä¸”æ¯ä¸ª package ä¸‹éƒ½ç»´æŠ¤ node_modules ï¼Œä¹Ÿä¸æ¸…çˆ½ã€‚äºæ˜¯æˆ‘ä»¬ä½¿ç”¨ â€“hoist æ¥æŠŠæ¯ä¸ª package ä¸‹çš„ä¾èµ–åŒ…éƒ½æå‡åˆ°å·¥ç¨‹æ ¹ç›®å½•ï¼Œæ¥é™ä½å®‰è£…ä»¥åŠç®¡ç†çš„æˆæœ¬ã€‚\nlerna bootstrap --hoist\n\nä¸ºäº†çœå»æ¯æ¬¡éƒ½è¾“å…¥ â€“hoist å‚æ•°çš„éº»çƒ¦ï¼Œå¯ä»¥åœ¨ lerna.json é…ç½®ï¼š\n&#123;\n  &quot;packages&quot;: [\n    &quot;packages&#x2F;*&quot;\n  ],\n  &quot;command&quot;: &#123;\n    &quot;bootstrap&quot;: &#123;\n      &quot;hoist&quot;: true\n    &#125;\n  &#125;,\n  &quot;version&quot;: &quot;0.0.1-alpha.0&quot;\n&#125;\né…ç½®å¥½åï¼Œå¯¹äºä¹‹å‰ä¾èµ–åŒ…å·²ç»è¢«å®‰è£…åˆ°å„ä¸ª package ä¸‹çš„æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦æ¸…ç†ä¸€ä¸‹å®‰è£…çš„ä¾èµ–å³å¯ï¼š\nlerna clean\n\nç„¶åæ‰§è¡Œ lerna bootstrap å³å¯çœ‹åˆ° package çš„ä¾èµ–éƒ½è¢«å®‰è£…åˆ°æ ¹ç›®å½•ä¸‹çš„ `node_modules` ä¸­äº†ã€‚\n\nLerna + Monorepo æœ€ä½³å®è·µ\n\n\n\n\n\n\n\n\nlernaä¸è´Ÿè´£æ„å»ºï¼Œæµ‹è¯•ç­‰ä»»åŠ¡ï¼Œå®ƒæå‡ºäº†ä¸€ç§é›†ä¸­ç®¡ç†packageçš„ç›®å½•æ¨¡å¼ï¼Œæä¾›äº†ä¸€å¥—è‡ªåŠ¨åŒ–ç®¡ç†ç¨‹åºï¼Œè®©å¼€å‘è€…ä¸å¿…å†æ·±è€•åˆ°å…·ä½“çš„ç»„ä»¶é‡Œç»´æŠ¤å†…å®¹ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•å°±å¯ä»¥å…¨å±€æŒæ§ï¼ŒåŸºäº npm scriptsï¼Œä½¿ç”¨è€…å¯ä»¥å¾ˆå¥½åœ°å®Œæˆç»„ä»¶æ„å»ºï¼Œä»£ç æ ¼å¼åŒ–ç­‰æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼Œå¦‚æœåŸºäº Lernaï¼Œå¹¶ç»“åˆå…¶å®ƒå·¥å…·æ¥æ­å»º Monorepo é¡¹ç›®çš„æœ€ä½³å®è·µã€‚\nç›®å‰æœ€å¸¸è§çš„ monorepo è§£å†³æ–¹æ¡ˆæ˜¯ Lerna å’Œ yarn çš„ workspaces ç‰¹æ€§ï¼ŒåŸºäºlernaå’Œyarn workspaceçš„monorepoå·¥ä½œæµã€‚ç”±äºyarnå’Œlernaåœ¨åŠŸèƒ½ä¸Šæœ‰è¾ƒå¤šçš„é‡å ,æˆ‘ä»¬é‡‡ç”¨yarnå®˜æ–¹æ¨èçš„åšæ³•,ç”¨yarnæ¥å¤„ç†ä¾èµ–é—®é¢˜ï¼Œç”¨lernaæ¥å¤„ç†å‘å¸ƒé—®é¢˜ã€‚èƒ½ç”¨yarnåšçš„å°±ç”¨yarnåšå§\nyarn workspace3.1.1 æ­å»ºç¯å¢ƒæ™®é€šé¡¹ç›®ï¼šcloneä¸‹æ¥åé€šè¿‡yarn install,å³å¯æ­å»ºå®Œé¡¹ç›®ï¼Œæœ‰æ—¶éœ€è¦é…åˆpostinstall hooks,æ¥è¿›è¡Œè‡ªåŠ¨ç¼–è¯‘ï¼Œæˆ–è€…å…¶ä»–è®¾ç½®ã€‚\nmonorepo: å„ä¸ªåº“ä¹‹é—´å­˜åœ¨ä¾èµ–ï¼Œå¦‚Aä¾èµ–äºBï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸éœ€è¦å°†B linkåˆ°Açš„node_moduleé‡Œï¼Œä¸€æ—¦ä»“åº“å¾ˆå¤šçš„è¯ï¼Œæ‰‹åŠ¨çš„ç®¡ç†è¿™äº›linkæ“ä½œè´Ÿæ‹…å¾ˆå¤§ï¼Œå› æ­¤éœ€è¦è‡ªåŠ¨åŒ–çš„linkæ“ä½œï¼ŒæŒ‰ç…§æ‹“æ‰‘æ’åºå°†å„ä¸ªä¾èµ–è¿›è¡Œlink\nè§£å†³æ–¹å¼ï¼šé€šè¿‡ä½¿ç”¨workspaceï¼Œyarn installä¼šè‡ªåŠ¨çš„å¸®å¿™è§£å†³å®‰è£…å’Œlinké—®é¢˜\nyarn install # ç­‰ä»·äº lerna bootstrap --npm-client yarn --use-workspaces\n\n3.1.2 æ¸…ç†ç¯å¢ƒåœ¨ä¾èµ–ä¹±æ‰æˆ–è€…å·¥ç¨‹æ··ä¹±çš„æƒ…å†µä¸‹ï¼Œæ¸…ç†ä¾èµ–\næ™®é€šé¡¹ç›®ï¼š ç›´æ¥åˆ é™¤node_modulesä»¥åŠç¼–è¯‘åçš„äº§ç‰©ã€‚\nmonorepoï¼š ä¸ä»…éœ€è¦åˆ é™¤rootçš„node_modulesçš„ç¼–è¯‘äº§ç‰©è¿˜éœ€è¦åˆ é™¤å„ä¸ªpackageé‡Œçš„node_modulesä»¥åŠç¼–è¯‘äº§ç‰©\nè§£å†³æ–¹å¼ï¼šä½¿ç”¨lerna cleanæ¥åˆ é™¤æ‰€æœ‰çš„node_modulesï¼Œä½¿ç”¨yarn workspaces run cleanæ¥æ‰§è¡Œæ‰€æœ‰packageçš„æ¸…ç†å·¥ä½œ\nlerna clean # æ¸…ç†æ‰€æœ‰çš„node_modules\nyarn workspaces run clean # æ‰§è¡Œæ‰€æœ‰packageçš„cleanæ“ä½œ\n\n3.1.3 å®‰è£…|åˆ é™¤ä¾èµ–æ™®é€šé¡¹ç›®ï¼š é€šè¿‡yarn addå’Œyarn removeå³å¯ç®€å•å§è§£å†³ä¾èµ–åº“çš„å®‰è£…å’Œåˆ é™¤é—®é¢˜\nmonorepo: ä¸€èˆ¬åˆ†ä¸ºä¸‰ç§åœºæ™¯\nç»™æŸä¸ªpackageå®‰è£…ä¾èµ–ï¼šyarn workspace packageB add packageA å°†packageAä½œä¸ºpackageBçš„ä¾èµ–è¿›è¡Œå®‰è£…\nç»™æ‰€æœ‰çš„packageå®‰è£…ä¾èµ–: ä½¿ç”¨yarn workspaces add lodash ç»™æ‰€æœ‰çš„packageå®‰è£…ä¾èµ–\nç»™root å®‰è£…ä¾èµ–ï¼šä¸€èˆ¬çš„å…¬ç”¨çš„å¼€å‘å·¥å…·éƒ½æ˜¯å®‰è£…åœ¨rooté‡Œï¼Œå¦‚typescript,æˆ‘ä»¬ä½¿ç”¨yarn add -W -D typescriptæ¥ç»™rootå®‰è£…ä¾èµ–\nå¯¹åº”çš„ä¸‰ç§åœºæ™¯åˆ é™¤ä¾èµ–å¦‚ä¸‹\nyarn workspace packageB remove packageA\nyarn workspaces remove lodash\nyarn remove -W -D typescript\n\n\n3.1.4 é¡¹ç›®æ„å»ºæ™®é€šé¡¹ç›®ï¼šå»ºç«‹ä¸€ä¸ªbuildçš„npm scriptï¼Œä½¿ç”¨yarn buildå³å¯å®Œæˆé¡¹ç›®æ„å»º\nmonorepo:åŒºåˆ«äºæ™®é€šé¡¹ç›®ä¹‹å¤„åœ¨äºå„ä¸ªpackageä¹‹é—´å­˜åœ¨ç›¸äº’ä¾èµ–ï¼Œå¦‚packageBåªæœ‰åœ¨packageAæ„å»ºå®Œä¹‹åæ‰èƒ½è¿›è¡Œæ„å»ºï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ï¼Œè¿™å®é™…ä¸Šè¦æ±‚æˆ‘ä»¬ä»¥ä¸€ç§æ‹“æ‰‘æ’åºçš„è§„åˆ™è¿›è¡Œæ„å»ºã€‚\næˆ‘ä»¬å¯ä»¥è‡ªå·±æ„å»ºæ‹“æ‰‘æ’åºè§„åˆ™ï¼Œå¾ˆä¸å¹¸çš„æ˜¯yarnçš„workspaceæš‚æ—¶å¹¶æœªæ”¯æŒæŒ‰ç…§æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤,è™½ç„¶è¯¥ rfcå·²ç»è¢«acceptedï¼Œä½†æ˜¯å°šæœªå®ç°, å¹¸è¿çš„æ˜¯lernaæ”¯æŒæŒ‰ç…§æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤, â€“sortå‚æ•°å¯ä»¥æ§åˆ¶ä»¥æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤\nlerna run --stream --sort build\n3.1.5 ç‰ˆæœ¬å‡çº§åŠå‘åŒ…é¡¹ç›®æµ‹è¯•å®Œæˆåï¼Œå°±æ¶‰åŠåˆ°ç‰ˆæœ¬å‘å¸ƒï¼Œç‰ˆæœ¬å‘å¸ƒä¸€èˆ¬æ¶‰åŠåˆ°å¦‚ä¸‹ä¸€äº›æ­¥éª¤\næ¡ä»¶éªŒè¯: å¦‚éªŒè¯æµ‹è¯•æ˜¯å¦é€šè¿‡ï¼Œæ˜¯å¦å­˜åœ¨æœªæäº¤çš„ä»£ç ï¼Œæ˜¯å¦åœ¨ä¸»åˆ†æ”¯ä¸Šè¿›è¡Œç‰ˆæœ¬å‘å¸ƒæ“ä½œ\nversion_bump:å‘ç‰ˆçš„æ—¶å€™éœ€è¦æ›´æ–°ç‰ˆæœ¬å·ï¼Œè¿™æ—¶å€™å¦‚ä½•æ›´æ–°ç‰ˆæœ¬å·å°±æ˜¯ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬å¤§å®¶éƒ½ä¼šéµå¾ª semVerè¯­ä¹‰ï¼Œ\nç”Ÿæˆchangelog: ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æ¯ä¸ªpackageæ¯ä¸ªç‰ˆæœ¬è§£å†³äº†å“ªäº›åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªpackageéƒ½ç”Ÿæˆä¸€ä»½changelogæ–¹ä¾¿ç”¨æˆ·æŸ¥çœ‹å„ä¸ªç‰ˆæœ¬çš„åŠŸèƒ½å˜åŒ–ã€‚\nç”Ÿæˆgit tagï¼šä¸ºäº†æ–¹ä¾¿åç»­å›æ»šé—®é¢˜åŠé—®é¢˜æ’æŸ¥é€šå¸¸éœ€è¦ç»™æ¯ä¸ªç‰ˆæœ¬åˆ›å»ºä¸€ä¸ªgit tag\ngit å‘å¸ƒç‰ˆæœ¬ï¼šæ¯æ¬¡å‘ç‰ˆæˆ‘ä»¬éƒ½éœ€è¦å•ç‹¬ç”Ÿæˆä¸€ä¸ªcommitè®°å½•æ¥æ ‡è®°milestone\nå‘å¸ƒnpmåŒ…ï¼šå‘å¸ƒå®Œgitåæˆ‘ä»¬è¿˜éœ€è¦å°†æ›´æ–°çš„ç‰ˆæœ¬å‘å¸ƒåˆ°npmä¸Šï¼Œä»¥ä¾¿å¤–éƒ¨ç”¨æˆ·ä½¿ç”¨\næˆ‘ä»¬å‘ç°æ‰‹åŠ¨çš„æ‰§è¡Œè¿™äº›æ“ä½œæ˜¯å¾ˆéº»çƒ¦çš„ä¸”åŠå…¶å®¹æ˜“å‡ºé”™ï¼Œå¹¸è¿çš„æ˜¯lernaå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™äº›é—®é¢˜\nyarnå®˜æ–¹å¹¶ä¸æ‰“ç®—æ”¯æŒå‘å¸ƒæµç¨‹ï¼Œåªæ˜¯æƒ³åšå¥½åŒ…ç®¡ç†å·¥å…·ï¼Œå› æ­¤è¿™éƒ¨åˆ†è¿˜æ˜¯éœ€è¦é€šè¿‡lernaæ”¯æŒ\nlernaæä¾›äº†publishå’Œversionæ¥æ”¯æŒç‰ˆæœ¬çš„å‡çº§å’Œå‘å¸ƒ, publishçš„åŠŸèƒ½å¯ä»¥å³åŒ…å«versionçš„å·¥ä½œï¼Œä¹Ÿå¯ä»¥å•çº¯çš„åªåšå‘å¸ƒæ“ä½œã€‚\n3.2 ä¼˜é›…çš„æäº¤3.2.1 commitizen &amp;&amp; cz-lerna-changelogcommitizen æ˜¯ç”¨æ¥æ ¼å¼åŒ– git commit message çš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ç§é—®è¯¢å¼çš„æ–¹å¼å»è·å–æ‰€éœ€çš„æäº¤ä¿¡æ¯ã€‚\ncz-lerna-changelog æ˜¯ä¸“é—¨ä¸º Lerna é¡¹ç›®é‡èº«å®šåˆ¶çš„æäº¤è§„èŒƒï¼Œåœ¨é—®è¯¢çš„è¿‡ç¨‹ï¼Œä¼šæœ‰ç±»ä¼¼å½±å“å“ªäº› package çš„é€‰æ‹©ã€‚å¦‚ä¸‹ï¼š\n\næˆ‘ä»¬ä½¿ç”¨ commitizen å’Œ cz-lerna-changelog æ¥è§„èŒƒæäº¤ï¼Œä¸ºåé¢è‡ªåŠ¨ç”Ÿæˆæ—¥å¿—ä½œå¥½å‡†å¤‡ã€‚\nå› ä¸ºè¿™æ˜¯æ•´ä¸ªå·¥ç¨‹çš„å¼€å‘ä¾èµ–ï¼Œæ‰€ä»¥åœ¨æ ¹ç›®å½•å®‰è£…ï¼š\nyarn add  -D commitizen\nyarn add  -D cz-lerna-changelog\n\nå®‰è£…å®Œæˆåï¼Œåœ¨ package.json ä¸­å¢åŠ  config å­—æ®µï¼ŒæŠŠ cz-lerna-changelog é…ç½®ç»™ commitizenã€‚åŒæ—¶å› ä¸ºcommitizenä¸æ˜¯å…¨å±€å®‰å…¨çš„ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ  scripts è„šæœ¬æ¥æ‰§è¡Œ git-cz\n&#123;\n  &quot;name&quot;: &quot;root&quot;,\n  &quot;private&quot;: true,\n  &quot;scripts&quot;: &#123;\n    &quot;commit&quot;: &quot;git-cz&quot;\n  &#125;,\n  &quot;config&quot;: &#123;\n    &quot;commitizen&quot;: &#123;\n      &quot;path&quot;: &quot;.&#x2F;node_modules&#x2F;cz-lerna-changelog&quot;\n    &#125;\n  &#125;,\n  &quot;devDependencies&quot;: &#123;\n    &quot;commitizen&quot;: &quot;^3.1.1&quot;,\n    &quot;cz-lerna-changelog&quot;: &quot;^2.0.2&quot;,\n    &quot;lerna&quot;: &quot;^3.15.0&quot;\n  &#125;\n&#125;\n\n\nä¹‹ååœ¨å¸¸è§„çš„å¼€å‘ä¸­å°±å¯ä»¥ä½¿ç”¨ yarn run commit æ¥æ ¹æ®æç¤ºä¸€æ­¥ä¸€æ­¥è¾“å…¥ï¼Œæ¥å®Œæˆä»£ç çš„æäº¤ã€‚\n3.2.2 commitlint &amp;&amp; huskyä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº† commitizen æ¥è§„èŒƒæäº¤ï¼Œä½†è¿™ä¸ªè¦é å¼€å‘è‡ªè§‰ä½¿ç”¨yarn run commit ã€‚ä¸‡ä¸€å¿˜è®°äº†ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ git commit æäº¤æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆå°±æ˜¯åœ¨æäº¤æ—¶å¯¹æäº¤ä¿¡æ¯è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä¸ç¬¦åˆè¦æ±‚å°±ä¸è®©æäº¤ï¼Œå¹¶æç¤ºã€‚æ ¡éªŒçš„å·¥ä½œç”± commitlint æ¥å®Œæˆï¼Œæ ¡éªŒçš„æ—¶æœºåˆ™ç”± husky æ¥æŒ‡å®šã€‚husky ç»§æ‰¿äº† Git ä¸‹æ‰€æœ‰çš„é’©å­ï¼Œåœ¨è§¦å‘é’©å­çš„æ—¶å€™ï¼Œhusky å¯ä»¥é˜»æ­¢ä¸åˆæ³•çš„ commit,push ç­‰ç­‰ã€‚\nå®‰è£… commitlint ä»¥åŠè¦éµå®ˆçš„è§„èŒƒ\nyarn add -D @commitlint&#x2F;cli @commitlint&#x2F;config-conventional\n\nåœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸º commitlint å¢åŠ é…ç½®æ–‡ä»¶ commitlint.config.js ä¸ºcommitlint æŒ‡å®šç›¸åº”çš„è§„èŒƒ\nmodule.exports &#x3D; &#123; \n\textends: [&#39;@commitlint&#x2F;config-conventional&#39;] \n&#125;\n\nå®‰è£… husky\nyarn add -D husky\n\n\nåœ¨ package.json ä¸­å¢åŠ å¦‚ä¸‹é…ç½®\n&quot;husky&quot;: &#123; \n\t\t&quot;hooks&quot;: &#123; \n   \t\t&quot;commit-msg&quot;: &quot;commitlint -E HUSKY_GIT_PARAMS&quot; \n    &#125;\n&#125;\n\n\nâ€œcommit-msgâ€æ˜¯gitæäº¤æ—¶æ ¡éªŒæäº¤ä¿¡æ¯çš„é’©å­ï¼Œå½“è§¦å‘æ—¶ä¾¿ä¼šä½¿ç”¨ commitlit æ¥æ ¡éªŒã€‚å®‰è£…é…ç½®å®Œæˆåï¼Œæƒ³é€šè¿‡ git commit æˆ–è€…å…¶å®ƒç¬¬ä¸‰æ–¹å·¥å…·æäº¤æ—¶ï¼Œåªè¦æäº¤ä¿¡æ¯ä¸ç¬¦åˆè§„èŒƒå°±æ— æ³•æäº¤ã€‚ä»è€Œçº¦æŸå¼€å‘è€…ä½¿ç”¨ yarn run commit æ¥æäº¤ã€‚\n3.2.3 eslint &amp;&amp; lint-stagedé™¤äº†è§„èŒƒæäº¤ä¿¡æ¯ï¼Œä»£ç æœ¬èº«è‚¯å®šä¹Ÿå°‘äº†é è§„èŒƒæ¥ç»Ÿä¸€é£æ ¼ã€‚\nå®‰è£…\nyarn add  -D standard lint-staged\n\n\neslintå°±æ˜¯å®Œæ•´çš„ä¸€å¥— JavaScriptï¼ˆtypescriptï¼‰ ä»£ç è§„èŒƒï¼Œè‡ªå¸¦ linter &amp; ä»£ç è‡ªåŠ¨ä¿®æ­£ã€‚è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç å¹¶ä¿®æ­£ï¼Œæå‰å‘ç°é£æ ¼ä»¥åŠç¨‹åºé—®é¢˜, åŒæ—¶ä¹Ÿæ”¯æŒtypescriptçš„ä»£ç è§„èŒƒæ ¡éªŒï¼Œeslintrc.jsoné…ç½®ï¼š\n&#123;\n    &quot;extends&quot;: [\n        &quot;yayajing&quot;,\n        &quot;plugin:@typescript-eslint&#x2F;recommended&quot;\n    ],\n    &quot;parser&quot;: &quot;typescript-eslint-parser&quot;,\n    &quot;plugins&quot;: [&quot;@typescript-eslint&quot;],\n    &quot;rules&quot;: &#123;\n        &quot;eqeqeq&quot;:&quot;off&quot;,\n        &quot;@typescript-eslint&#x2F;explicit-function-return-type&quot;: &quot;off&quot;,\n        &quot;no-template-curly-in-string&quot;: &quot;off&quot;\n    &#125;\n  &#125;\n\n\nlint-staged staged æ˜¯ Git é‡Œçš„æ¦‚å¿µï¼Œè¡¨ç¤ºæš‚å­˜åŒºï¼Œlint-staged è¡¨ç¤ºåªæ£€æŸ¥å¹¶çŸ«æ­£æš‚å­˜åŒºä¸­çš„æ–‡ä»¶ã€‚ä¸€æ¥æé«˜æ ¡éªŒæ•ˆç‡ï¼ŒäºŒæ¥å¯ä»¥ä¸ºè€çš„é¡¹ç›®å¸¦å»å·¨å¤§çš„æ–¹ä¾¿ã€‚package.jsoné…ç½®\n&#x2F;&#x2F; package.json\n&#123;\n  &quot;name&quot;: &quot;root&quot;,\n  &quot;private&quot;: true,\n  &quot;scripts&quot;: &#123;\n    &quot;c&quot;: &quot;git-cz&quot;\n  &#125;,\n  &quot;config&quot;: &#123;\n    &quot;commitizen&quot;: &#123;\n      &quot;path&quot;: &quot;.&#x2F;node_modules&#x2F;cz-lerna-changelog&quot;\n    &#125;\n  &#125;,\n  &quot;husky&quot;: &#123;\n    &quot;hooks&quot;: &#123;\n      &quot;pre-commit&quot;: &quot;lint-staged&quot;,\n      &quot;commit-msg&quot;: &quot;commitlint -E HUSKY_GIT_PARAMS&quot;\n    &#125;\n  &#125;,\n  &quot;lint-staged&quot;: &#123;\n    &quot;*.ts&quot;: [\n      &quot;eslint --fix&quot;,\n      &quot;git add&quot;\n    ]\n  &#125;,\n  &quot;devDependencies&quot;: &#123;\n    &quot;@commitlint&#x2F;cli&quot;: &quot;^8.1.0&quot;,\n    &quot;@commitlint&#x2F;config-conventional&quot;: &quot;^8.1.0&quot;,\n    &quot;commitizen&quot;: &quot;^3.1.1&quot;,\n    &quot;cz-lerna-changelog&quot;: &quot;^2.0.2&quot;,\n    &quot;husky&quot;: &quot;^3.0.0&quot;,\n    &quot;lerna&quot;: &quot;^3.15.0&quot;,\n    &quot;lint-staged&quot;: &quot;^9.2.0&quot;\n  &#125;\n&#125;\n\n\nå®‰è£…å®Œæˆåï¼Œåœ¨ package.json å¢åŠ  lint-staged é…ç½®ï¼Œå¦‚ä¸Šæ‰€ç¤ºè¡¨ç¤ºå¯¹æš‚å­˜åŒºä¸­çš„ js æ–‡ä»¶æ‰§è¡Œ eslint â€“fix æ ¡éªŒå¹¶è‡ªåŠ¨ä¿®å¤ã€‚é‚£ä»€ä¹ˆæ—¶å€™å»æ ¡éªŒå‘¢ï¼Œå°±åˆç”¨åˆ°äº†ä¸Šé¢å®‰è£…çš„ husky ï¼Œhuskyçš„é…ç½®ä¸­å¢åŠ pre-commitçš„é’©å­ç”¨æ¥æ‰§è¡Œ lint-staged çš„æ ¡éªŒæ“ä½œã€‚\næ­¤æ—¶æäº¤ ts æ–‡ä»¶æ—¶ï¼Œä¾¿ä¼šè‡ªåŠ¨ä¿®æ­£å¹¶æ ¡éªŒé”™è¯¯ã€‚å³ä¿è¯äº†ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œåˆèƒ½æé«˜ä»£ç è´¨é‡ã€‚\n3.3 å‘å¸ƒè‡ªåŠ¨ç”Ÿæˆæ—¥å¿—æœ‰äº†ä¹‹å‰çš„è§„èŒƒæäº¤ï¼Œè‡ªåŠ¨ç”Ÿæˆæ—¥å¿—ä¾¿æ°´åˆ°æ¸ æˆäº†ã€‚å†è¯¦ç»†çœ‹ä¸‹ lerna publish æ—¶åšäº†å“ªäº›äº‹æƒ…ï¼š\n3.3.1 lerna version æ›´æ–°ç‰ˆæœ¬\n\næ‰¾å‡ºä»ä¸Šä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒä»¥æ¥æœ‰è¿‡å˜æ›´çš„ package\n\næç¤ºå¼€å‘è€…ç¡®å®šè¦å‘å¸ƒçš„ç‰ˆæœ¬å·\n\nå°†æ‰€æœ‰æ›´æ–°è¿‡çš„çš„ package ä¸­çš„package.jsonçš„versionå­—æ®µæ›´æ–°\n\nå°†ä¾èµ–æ›´æ–°è¿‡çš„ package çš„ åŒ…ä¸­çš„ä¾èµ–ç‰ˆæœ¬å·æ›´æ–°\n\næ›´æ–° lerna.json ä¸­çš„ version å­—æ®µ\n\næäº¤ä¸Šè¿°ä¿®æ”¹ï¼Œå¹¶æ‰“ä¸€ä¸ª tag\n\næ¨é€åˆ° git ä»“åº“\n\n\n3.3.2 ä½¿ç”¨ npm publish å°†æ–°ç‰ˆæœ¬æ¨é€åˆ° npmCHANGELOG å¾ˆæ˜æ˜¾æ˜¯å’Œ version ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨ lerna version ä¸­æƒ³åŠæ³•ï¼ŒæŸ¥çœ‹ lerna version å‘½ä»¤çš„è¯¦ç»†è¯´æ˜åï¼Œä¼šçœ‹åˆ°ä¸€ä¸ªé…ç½®å‚æ•° --conventional-commitsã€‚æ²¡é”™ï¼Œåªè¦æˆ‘ä»¬æŒ‰è§„èŒƒæäº¤åï¼Œåœ¨ lerna version çš„è¿‡ç¨‹ä¸­ä¼šä¾¿ä¼šè‡ªåŠ¨ç”Ÿæˆå½“å‰è¿™ä¸ªç‰ˆæœ¬çš„ CHANGELOGã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œä¸ç”¨æ¯æ¬¡è¾“å…¥å‚æ•°ï¼Œå¯ä»¥é…ç½®åœ¨ lerna.jsonä¸­ï¼Œå¦‚ä¸‹ï¼š\n&#123;\n  &quot;packages&quot;: [\n    &quot;packages&#x2F;*&quot;\n  ],\n  &quot;command&quot;: &#123;\n    &quot;bootstrap&quot;: &#123;\n      &quot;hoist&quot;: true\n    &#125;,\n    &quot;version&quot;: &#123;\n      &quot;conventionalCommits&quot;: true\n    &#125;\n  &#125;,\n  &quot;ignoreChanges&quot;: [\n    &quot;**&#x2F;*.md&quot;\n  ],\n  &quot;version&quot;: &quot;0.0.1-alpha.1&quot;\n&#125;\n\n\nlerna version ä¼šæ£€æµ‹ä»ä¸Šä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒä»¥æ¥çš„å˜åŠ¨ï¼Œä½†æœ‰ä¸€äº›æ–‡ä»¶çš„æäº¤ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è§¦å‘ç‰ˆæœ¬çš„å˜åŠ¨ï¼Œè­¬å¦‚ .md æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå¹¶æ²¡æœ‰å®é™…å¼•èµ· package é€»è¾‘çš„å˜åŒ–ï¼Œä¸åº”è¯¥è§¦å‘ç‰ˆæœ¬çš„å˜æ›´ã€‚å¯ä»¥é€šè¿‡ ignoreChanges é…ç½®æ’é™¤ã€‚å¦‚ä¸Šã€‚\nå®é™… lerna versionå¾ˆå°‘ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåŒ…å«åœ¨ lerna publish ä¸­äº†ï¼Œç›´æ¥ä½¿ç”¨ lerna publishå°±å¥½äº†ã€‚\n3.4 å®Œå–„çš„æµ‹è¯•ç”¨ä¾‹monorepoé¡¹ç›®ï¼šæµ‹è¯•æœ‰ä¸¤ç§æ–¹å¼\n\nä½¿ç”¨ç»Ÿä¸€çš„jestæµ‹è¯•é…ç½®è¿™æ ·æ–¹ä¾¿å…¨å±€çš„è·‘jestå³å¯ï¼Œå¥½å¤„æ˜¯å¯ä»¥æ–¹ä¾¿ç»Ÿè®¡æ‰€æœ‰ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡ï¼Œåå¤„æ˜¯å¦‚æœpackageæ¯”è¾ƒå¼‚æ„ï¼ˆå¦‚å°ç¨‹åºï¼Œå‰ç«¯ï¼Œnode æœåŠ¡ç«¯ç­‰ï¼‰ï¼Œç»Ÿä¸€çš„æµ‹è¯•é…ç½®ä¸å¤ªå¥½ç¼–å†™\n\næ¯ä¸ªpackageå•ç‹¬æ”¯æŒtestå‘½ä»¤ï¼Œä½¿ç”¨yarn workspace run testï¼Œåå¤„æ˜¯ä¸å¥½ç»Ÿä¸€æ”¶é›†æ‰€æœ‰ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡\n\n\nå¦‚æœé‡‡ç”¨jestç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæ”¯æŒtypescriptçš„è¯ï¼Œéœ€è¦åˆå§‹åŒ–é…ç½®jest.config.jsï¼š\nmodule.exports &#x3D; &#123;\n  preset: &#39;ts-jest&#39;,\n  moduleFileExtensions: [&#39;ts&#39;],\n  testEnvironment: &#39;node&#39;\n&#125;\n\n4 å®è·µæ€»ç»“åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå·²ç»æ„å»ºäº†åŸºäºlernaå’Œyarn workspaceçš„monorepoé¡¹ç›®çš„æœ€ä½³å®è·µäº†ï¼Œè¯¥æœ‰çš„åŠŸèƒ½éƒ½æœ‰ï¼š\n\nå®Œå–„çš„å·¥ä½œæµ\n\ntypescriptæ”¯æŒ\n\né£æ ¼ç»Ÿä¸€çš„ç¼–ç \n\nå®Œæ•´çš„å•å…ƒæµ‹è¯•\n\nä¸€é”®å¼çš„å‘å¸ƒæœºåˆ¶\n\nå®Œç¾çš„æ›´æ–°æ—¥å¿—\n\n\nâ€¦â€¦\nå½“ç„¶ï¼Œæ„å»ºä¸€å¥—å®Œå–„çš„ä»“åº“ç®¡ç†æœºåˆ¶ï¼Œå¯èƒ½å®ƒçš„æ”¶ç›Šä¸æ˜¯ä¸€äº›é‡åŒ–çš„æŒ‡æ ‡å¯ä»¥è¡¡é‡å‡ºæ¥çš„ï¼Œä¹Ÿæ²¡æœ‰ç›´æ¥çš„ä»·å€¼è¾“å‡ºï¼Œä½†å®ƒèƒ½åœ¨æ—¥å¸¸çš„å·¥ä½œä¸­æå¤§çš„æé«˜å·¥ä½œæ•ˆç‡ï¼Œè§£æ”¾ç”Ÿäº§åŠ›ï¼ŒèŠ‚çœå¤§é‡çš„äººåŠ›æˆæœ¬ã€‚\nå‚è€ƒlerna+yarn workspace+monorepoé¡¹ç›®çš„æœ€ä½³å®è·µ5åˆ†é’Ÿææ‡‚Monorepo2021å¹´ç®¡ç†Monorepoä»£ç åº“çš„11ç§å‡ºè‰²å·¥å…·\n","slug":"2022-05-23monorepo","date":"2022-05-23T06:45:12.000Z","categories_index":"npm","tags_index":"å¢æ•ˆ,npm,monorepo","author_index":"é™ˆæµ·é¾™"},{"id":"a8dbdf02ab5e598ef229ef514965f17c","title":"ä¿¡æ ‡ï¼ˆBeacon ï¼‰","content":"Beacon  ç‰¹ç‚¹\næ¥å£ç”¨äºå°†å¼‚æ­¥å’Œéé˜»å¡è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚\nè¯·æ±‚ä½¿ç”¨HTTPåè®®ä¸­çš„POSTæ–¹æ³•ï¼Œè¯·æ±‚é€šå¸¸ä¸éœ€è¦å“åº”ã€‚\nè¿™ä¸ªè¯·æ±‚è¢«ä¿è¯åœ¨ï¼Œé¡µé¢çš„unloadçŠ¶æ€ä»å‘èµ·åˆ°å®Œæˆä¹‹å‰ï¼Œè¢«å‘é€ã€‚è€Œå¹¶ä¸éœ€è¦ä¸€ä¸ªé˜»å¡è¯·æ±‚ï¼Œä¾‹å¦‚ XMLHttpRequest ã€‚Beacon  åœºæ™¯å‘é€å¼‚æ­¥éé˜»å¡æ•°æ®åˆ°æœåŠ¡ç«¯ä¸ºä»€ä¹ˆæ˜¯ä¿¡æ ‡ï¼ŸBeacon æ¥å£æ»¡è¶³äº†åˆ†æå’Œè¯Šæ–­ä»£ç çš„éœ€è¦ï¼Œè¿™äº›ä»£ç é€šå¸¸ä¼šå°è¯•åœ¨å¸è½½æ–‡æ¡£ä¹‹å‰å°†æ•°æ®å‘é€åˆ° webæœåŠ¡å™¨ã€‚å‘é€æ•°æ®çš„ä»»ä½•è¿‡æ—©æ—¶æœºéƒ½å¯èƒ½å¯¼è‡´é”™å¤±æ”¶é›†æ•°æ®çš„æœºä¼šã€‚ä½†æ˜¯ï¼Œç¡®ä¿åœ¨å¸è½½æ–‡æ¡£æœŸé—´å‘é€æ•°æ®æ˜¯å¼€å‘äººå‘˜éš¾ä»¥åšåˆ°çš„ã€‚\n\nç”¨æˆ·ä»£ç†é€šå¸¸ä¼šå¿½ç•¥å¸è½½æ–‡æ¡£å¤„ç†ç¨‹åºä¸­çš„å¼‚æ­¥ XMLHttpRequests è¯·æ±‚ã€‚è‹¥è¦è§£å†³æ­¤é—®é¢˜ï¼Œä¸ºäº†åˆ†æå’Œè¯Šæ–­ä»£ç ï¼Œé€šå¸¸ä¼šåœ¨ unload (en-US) äº‹ä»¶æˆ– beforeunload (en-US) äº‹ä»¶ä¸­åˆ›å»ºåŒæ­¥ XMLHttpRequest è¯·æ±‚ä»¥æäº¤æ•°æ®ã€‚åŒæ­¥ XMLHttpRequest è¯·æ±‚å¼ºåˆ¶æµè§ˆå™¨å»¶è¿Ÿå¸è½½æ–‡æ¡£ï¼Œå¹¶ä½¿ä¸‹ä¸€ä¸ªé¡µé¢è·³è½¬çœ‹èµ·æ¥è¾ƒæ…¢ã€‚ä¸‹ä¸€é¡µé¢æ²¡æœ‰ä»»ä½•åŠæ³•æ¥é¿å…è¿™ç§é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½³çš„æ„Ÿè§‰ã€‚\nå…¶ä»–æŠ€æœ¯å…¶ä¸­ä¸€ç§æŠ€æœ¯æ˜¯é€šè¿‡åˆ›å»º Image å…ƒç´ å¹¶åœ¨å¸è½½æ–‡æ¡£å¤„ç†ç¨‹åºä¸­è®¾ç½®å…¶ src å±æ€§æ¥å»¶è¿Ÿå¸è½½ä»¥æäº¤æ•°æ®ã€‚ç”±äºå¤§å¤šæ•°ç”¨æˆ·ä»£ç†ä¼šå»¶è¿Ÿæ–‡æ¡£å¸è½½ï¼Œä»¥å®ŒæˆæŒ‚èµ·çš„å›¾ç‰‡åŠ è½½ï¼Œå› æ­¤å¯ä»¥åœ¨å¸è½½è¿‡ç¨‹ä¸­æäº¤æ•°æ®ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨å¸è½½å¤„ç†ç¨‹åºä¸­åˆ›å»ºä¸€ä¸ªæ— æ“ä½œå¾ªç¯ï¼ŒèŠ±è´¹æ•°ç§’ä»¥å»¶è¿Ÿå¸è½½å¹¶å°†æ•°æ®æäº¤åˆ°æœåŠ¡å™¨ã€‚\nä½†æ˜¯ä¸Šè¿°æŠ€æœ¯ä¸ä»…ä»£è¡¨äº†è¾ƒå·®çš„ç¼–ç æ¨¡å¼ï¼Œå…¶ä¸­ä¸€äº›è¿˜æ˜¯ä¸å¯é çš„ï¼Œä¼šå¯¼è‡´ä¸‹ä¸€ä¸ªå¯¼èˆªçš„é¡µé¢åŠ è½½æ€§èƒ½è¾ƒå·®çš„æ„Ÿè§‰ã€‚ä¿¡æ ‡ API æä¾›äº†è§£å†³è¿™äº›é—®é¢˜çš„æ ‡å‡†æ–¹æ³•ã€‚\nå…¨å±€ç¯å¢ƒBeacon API çš„ Navigator.sendBeacon() æ–¹æ³•ç”¨äºåœ¨å…¨å±€æµè§ˆä¸Šä¸‹æ–‡ä¸­å‘æœåŠ¡å™¨å‘é€æ•°æ®ä¿¡æ ‡ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒURLå’Œè¦åœ¨è¯·æ±‚ä¸­å‘é€çš„æ•°æ®dataã€‚dataå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå…¶ç±»å‹å¯ä»¥æ˜¯ ArrayBufferViewã€Blobã€DOMString æˆ–FormDataã€‚å¦‚æœæµè§ˆå™¨æˆåŠŸçš„ä»¥é˜Ÿåˆ—å½¢å¼æ’åˆ—äº†ç”¨äºä¼ é€’çš„è¯·æ±‚ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›â€œtrueâ€ï¼Œå¦åˆ™è¿”å›â€œfalseâ€ã€‚\nç”Ÿäº§ç¯å¢ƒBeacon APIçš„ WorkerNavigator.sendBeacon() æ–¹æ³•ç”¨äºä» worker global scope å‘æœåŠ¡å™¨å‘é€æ•°æ®ä¿¡æ ‡ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒURLå’Œè¦åœ¨è¯·æ±‚ä¸­å‘é€çš„æ•°æ®dataã€‚dataå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå…¶ç±»å‹å¯ä»¥æ˜¯ ArrayBufferViewã€Blobã€DOMString æˆ– FormDataã€‚å¦‚æœæµè§ˆå™¨æˆåŠŸçš„ä»¥é˜Ÿåˆ—å½¢å¼æ’åˆ—äº†ç”¨äºä¼ é€’çš„è¯·æ±‚ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›â€œtrueâ€ï¼Œå¦åˆ™è¿”å›â€œfalseâ€ã€‚\nä¼˜ç‚¹\nAPI æä¾›äº†è§£å†³è¿™äº›é—®é¢˜çš„æ ‡å‡†æ–¹æ³•\n\nç¼ºç‚¹\næµè§ˆå™¨å…¼å®¹æ€§Navigator.sendBeacon().Browser_compatibilityè¡¨è¯´æ˜äº†è¯¥æ–¹æ³•å…·æœ‰ç›¸å¯¹å¹¿æ³›åœ°å®ç°ã€‚ä½†æ˜¯ï¼ŒWorkerNavigator.sendBeacon().Browser_compatibilityæ•°æ®æ˜¾ç¤ºè¯¥æ–¹æ³•æ²¡æœ‰è¢«å®ç°ã€‚\n\n","slug":"2022-05-23beacon","date":"2022-05-23T03:12:16.000Z","categories_index":"æµè§ˆå™¨","tags_index":"æµè§ˆå™¨","author_index":"é™ˆæµ·é¾™"},{"id":"2ed8e0ec0aaa29d8d085170a13236bf8","title":"flutter Bruno","content":"BrunoBruno æ˜¯ç”±è´å£³ã€Œç”¨æˆ·ä½“éªŒä¸­å¿ƒ &amp; ç§»åŠ¨ç«¯ä½œä¸šç»„ã€è”åˆæ‰“é€ çš„ä¸€å¥—ä¼ä¸šçº§ç§»åŠ¨ç«¯ Flutter ç»„ä»¶åº“ï¼Œäº 12 æœˆ 10 æ—¥æ­£å¼å¼€æº:\nå®˜ç½‘\nPub åœ°å€\nGitHub ä»“åº“\nèƒŒæ™¯è´å£³è‡ª 2018 å¹´åº•å¼€å§‹å¯¹ Flutter çš„æ¢ç´¢å’Œå®è·µï¼ŒFlutter è½åœ°ä¸šåŠ¡æœ‰æ•ˆåœ°æå‡äº†äº§ç ”æ•ˆç‡ã€‚ä½†è·¨ä¸šåŠ¡çº¿ååŒæ•ˆç‡è¾ƒä½ï¼Œé‡å¤åŠ³åŠ¨åŠ›å¤§ï¼Œä»£ç ç»´æŠ¤æˆæœ¬é«˜ç­‰é—®é¢˜ä¾æ—§å‡¸æ˜¾ã€‚Bruno æ˜¯è´å£³é’ˆå¯¹ä¸Šè¿°é—®é¢˜åœ¨å…¬å¸å†…å‘èµ·çš„ææ•ˆä¸“é¡¹ï¼Œè‡´åŠ›äºæ‰“é€ è´å£³æ ‡å‡† Flutter ç”Ÿæ€ã€‚ç»è¿‡ä¸¤å¹´çš„æ‰“ç£¨å’Œæ²‰æ·€ï¼ŒBruno ç°å·²æœåŠ¡è´å£³ B ç«¯å…¨çº¿ä¸šåŠ¡ï¼Œæ¶µç›– 30 å¤šç§ç±»å‹ 100+  ç»„ä»¶ï¼Œä¸ºè¿‘ 18 ä¸ª App æœåŠ¡ï¼Œæ–°å¢é¡µé¢ç»„ä»¶è¦†ç›–ç‡å¹³å‡è¾¾åˆ° 80% ä»¥ä¸Šã€‚\nç›¸ä¿¡è´å£³é‡åˆ°çš„é—®é¢˜ä¹Ÿæ˜¯å¤§å‹å›¢é˜Ÿæˆ–è€…ä¸ªäººå¼€å‘è€…ä¸å¯é¿å…çš„é—®é¢˜ï¼Œç›®å‰é’ˆå¯¹è¯¥ç±»é—®é¢˜çš„ä¸­åå°è§£å†³æ–¹æ¡ˆå±‚å‡ºä¸ç©·ï¼Œä½†åœ¨ Flutter ç”Ÿæ€ä¸­ç±»ä¼¼æˆç†Ÿè§£å†³æ–¹æ¡ˆåŒ®ä¹ã€‚æˆ‘ä»¬å¸Œæœ›å°†è´å£³åœ¨ Flutter é¢†åŸŸçš„å®è·µç»éªŒå›é¦ˆç»™ç¤¾åŒºï¼Œæ›´åŠ å®Œå–„ Flutter ç”Ÿæ€ï¼Œå› æ­¤ Bruno æ­£å¼å¼€æºã€‚\nè®¾è®¡ç†å¿µBruno åŸºäºç”Ÿé•¿ã€åŒ…å®¹ã€è”æ¥çš„è®¾è®¡ç†å¿µï¼Œèµ‹äºˆç»„ä»¶è½»å·§çµæ´»ã€æ‹¥æŠ±å˜åŒ–ã€åŒ…å®¹ä¸‡ç‰©çš„å“è´¨ã€‚\nBruno çš„ä¼˜åŠ¿\né€‚åº¦çµæ´»ã€å……åˆ†å¯æ‰©å±•\n\nBruno å€¡å¯¼æ ‡å‡†åŒ–ä¸‹çš„è‡ªç”±ã€ç®€å•ã€çµæ´»ï¼ŒåŸºäº Flutter åŸºç¡€ç»„ä»¶çš„å°è£…ï¼Œä½¿å…¶å…·å¤‡é€‚åº¦çµæ´»ï¼Œä½¿ç”¨ç»„ä»¶ææ•ˆå°¤ä¸ºé‡è¦ã€‚åŒæ—¶ç»„ä»¶æ”¯æŒå……åˆ†å¯æ‰©å±•ï¼Œæ—¢å¯æ»¡è¶³å¤šäº§å“çš„å¿«é€Ÿæ¥å…¥åˆèƒ½åŒ…å®¹ç‰¹æ®Šåœºæ™¯ã€‚\nç»è¿‡ä¸¤å¹´çš„ä¸šåŠ¡å®è·µï¼Œæˆ‘ä»¬æœ€ç»ˆäº§å‡ºäº† 102 ä¸ªç»„ä»¶ï¼Œè¦†ç›–ç±»å‹æœ‰ å›¾è¡¨ã€å¯¼èˆªã€æ•°æ®å½•å…¥ã€æ“ä½œåé¦ˆã€å†…å®¹å±•ç¤º ç­‰ã€‚\n2. è¿æ¥è®¾è®¡&lt;â€“&gt;å¼€å‘\nBruno åŸºäº Sketch MeaXure äºŒæ¬¡å¼€å‘ï¼Œå®ç°ç»„ä»¶è‡ªåŠ¨è¯†åˆ«å’Œæ ‡æ³¨ã€‚å¼€å‘è€…å¯ä»¥ä»è®¾è®¡ä¾§äº§å‡ºçš„æ ‡æ³¨ç¨¿ä¸­æ¸…æ™°çš„çœ‹åˆ°é¡µé¢æ¶µç›–çš„ç»„ä»¶ï¼Œä¿¡æ¯æ— ç¼ä¼ è¾¾ï¼Œé«˜æ•ˆè¿æ¥è®¾è®¡ä¸å¼€å‘ã€‚\n3. ä¸»é¢˜å®šåˆ¶ã€å“ç‰Œé£æ ¼è‡ªå®šä¹‰\nBruno ä¸ä»…æ”¯æŒå…¨å±€è‰²å·çš„æ›¿æ¢ï¼Œè¿˜æ”¯æŒç»„ä»¶åœ†è§’ã€å­—ä½“å¤§å°ã€å†…éƒ¨é—´è·ç­‰å±æ€§çš„å®šåˆ¶ã€‚åœ¨å®šåˆ¶å…¨å±€æ ·å¼æ‰“é€ è‡ªæœ‰å“ç‰Œé£æ ¼çš„åŒæ—¶ï¼Œæ”¯æŒå•ä¸ªç»„ä»¶è‡ªå®šä¹‰æ»¡è¶³ç‰¹å¼‚åŒ–åœºæ™¯éœ€æ±‚ã€‚\n\né»˜è®¤åŸºç¡€è§„èŒƒ\n\n\n\n\n\nå…¨å±€æ ·å¼å®šåˆ¶\n\n\n\nå•ç»„ä»¶æ ·å¼å®šåˆ¶\n\nBruno è¿˜å¯æ”¯æŒå•ä¸šåŠ¡çš„å…¨å±€é…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ æ˜¯ç»„ä»¶åŒ–å·¥ç¨‹ç»“æ„ï¼Œé‚£ä¹ˆä½ å¯ä»¥å®šä¹‰æ¯ä¸ªä¸šåŠ¡ç»„ä»¶çš„ç‰¹æœ‰é£æ ¼ã€‚\n\nç‰©æ–™æ‰¿è½½ã€æ•™ç¨‹æŒ‡å¼•\n\nBruno å®˜ç½‘æ‰¿è½½äº§å“è®¾è®¡ç‰©æ–™ã€ç»„ä»¶é…å¥—æ–‡æ¡£ã€Demo ä¸‹è½½ã€æœç´¢ç­‰åŸºç¡€èƒ½åŠ›ï¼ŒåŒæ—¶é…æœ‰æ•™ç¨‹æŒ‡å¼•å¼€å‘ä¹Ÿå¯æ“ä½œ Sketch æ’ä»¶è®¾è®¡é¡µé¢ï¼Œå®ç°é›¶è®¾è®¡èµ„æºä»‹å…¥ã€‚\nBruno å®˜ç½‘: https://bruno.ke.com\næœªæ¥å±•æœ›\nä¸°å¯Œå’Œå®Œå–„ç»„ä»¶\n\nç›®å‰ Bruno ç»„ä»¶æ¶µç›–ç§ç±»å¯ä»¥è¦†ç›–å¸¸è§ä½¿ç”¨åœºæ™¯ï¼Œæ»¡è¶³ä¼ä¸šå»ºç«‹è‡ªæœ‰å“ç‰Œå½¢è±¡ App éœ€æ±‚ã€‚æœªæ¥æˆ‘ä»¬ä¼šæ ¹æ®ä¸šåŠ¡å‘å±•å’Œäº§å“å‡çº§ä¸æ–­è¿­ä»£ç»„ä»¶ï¼Œä¸°å¯Œäº§å“å†…å®¹æå‡è§†è§‰ä½“éªŒã€‚\n\næå‡è½åœ°æ•ˆç‡\n\næˆ‘ä»¬ä¸æ­¢å…³æ³¨ç»„ä»¶çš„è®¾è®¡ä¸ç ”å‘ï¼Œç»„ä»¶è½åœ°ä¹Ÿæ˜¯æå‡äº§ç ”æ•ˆç‡è‡³å…³é‡è¦çš„ç¯èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬å¯¹ Sketch MeaXure åšäº†äºŒæ¬¡æ”¹é€ ï¼Œå®ç°ç»„ä»¶è‡ªåŠ¨åŒ–æ ‡æ³¨ã€‚åŒæ—¶è´å£³äº§ç ”å›¢é˜ŸæŠŠè‡ªåŠ¨åŒ–æ ‡æ³¨èƒ½åŠ›çº¿ä¸ŠåŒ–ï¼Œè¿›ä¸€æ­¥æå‡ç»„ä»¶è½åœ°æ•ˆç‡ã€‚\n3ã€UI è‡ªåŠ¨åŒ–èµ°æŸ¥\nè´å£³äº§ç ”å›¢é˜Ÿä¹Ÿåœ¨æ¢ç´¢ UI è‡ªåŠ¨åŒ–èµ°æŸ¥æ–¹å‘ï¼ŒæœŸæœ›è§£æ”¾è®¾è®¡ä¾§èµ°æŸ¥äººåŠ›ï¼Œè®©è®¾è®¡å¸ˆæ›´å¤šæŠ•å…¥å¯¹äº§å“çš„æ´å¯Ÿç†è§£ï¼Œåˆ›é€ ä¼˜è´¨è®¾è®¡ï¼Œæå‡è§†è§‰ä½“éªŒã€‚\n","slug":"2022-05-20fluter-bruno","date":"2022-05-20T02:52:49.000Z","categories_index":"flutter","tags_index":"å¢æ•ˆ,flutter,mobile","author_index":"é™ˆæµ·é¾™"},{"id":"4250bd0ddd67048179ff9fddd5b6e876","title":"npmå¼€å‘wikiç¼–è¾‘å™¨é—®é¢˜æ€»ç»“","content":"åŸæ¶æ„\né‡æ„å\ntsconfig.ts&#123;\n  &#x2F;&#x2F; ç¼–è¯‘é€‰é¡¹\n  &quot;compilerOptions&quot;: &#123;\n    &#x2F;&#x2F; ç”Ÿæˆä»£ç çš„è¯­è¨€ç‰ˆæœ¬ï¼šå°†æˆ‘ä»¬å†™çš„ TS ä»£ç ç¼–è¯‘æˆå“ªä¸ªç‰ˆæœ¬çš„ JS ä»£ç \n    &quot;target&quot;: &quot;es5&quot;,\n    &#x2F;&#x2F; æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„ library\n    &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;TypeScript&#x2F;blob&#x2F;90e83adb44&#x2F;lib&#x2F;lib.dom.iterable.d.ts\n    &quot;lib&quot;: [&quot;dom&quot;, &quot;dom.iterable&quot;, &quot;esnext&quot;],\n    &#x2F;&#x2F; å…è®¸ ts ç¼–è¯‘å™¨ç¼–è¯‘ js æ–‡ä»¶\n    &quot;allowJs&quot;: true,\n    &#x2F;&#x2F; è·³è¿‡ç±»å‹å£°æ˜æ–‡ä»¶çš„ç±»å‹æ£€æŸ¥\n    &quot;skipLibCheck&quot;: true,\n    &#x2F;&#x2F; es æ¨¡å— äº’æ“ä½œï¼Œå±è”½ ESModule å’Œ CommonJS ä¹‹é—´çš„å·®å¼‚\n    &quot;esModuleInterop&quot;: true,\n    &#x2F;&#x2F; å…è®¸é€šè¿‡ import x from &#39;y&#39; å³ä½¿æ¨¡å—æ²¡æœ‰æ˜¾å¼æŒ‡å®š default å¯¼å‡º\n    &quot;allowSyntheticDefaultImports&quot;: true,\n    &#x2F;&#x2F; å¼€å¯ä¸¥æ ¼æ¨¡å¼\n    &quot;strict&quot;: true,\n    &#x2F;&#x2F; å¯¹æ–‡ä»¶åç§°å¼ºåˆ¶åŒºåˆ†å¤§å°å†™\n    &quot;forceConsistentCasingInFileNames&quot;: true,\n    &#x2F;&#x2F; ä¸º switch è¯­å¥å¯ç”¨é”™è¯¯æŠ¥å‘Š\n    &quot;noFallthroughCasesInSwitch&quot;: true,\n    &#x2F;&#x2F; ç”Ÿæˆä»£ç çš„æ¨¡å—åŒ–æ ‡å‡†\n    &quot;module&quot;: &quot;esnext&quot;,\n    &#x2F;&#x2F; æ¨¡å—è§£æï¼ˆæŸ¥æ‰¾ï¼‰ç­–ç•¥\n    &quot;moduleResolution&quot;: &quot;node&quot;,\n    &#x2F;&#x2F; å…è®¸å¯¼å…¥æ‰©å±•åä¸º.jsonçš„æ¨¡å—\n    &quot;resolveJsonModule&quot;: true,\n    &#x2F;&#x2F; æ˜¯å¦å°†æ²¡æœ‰ import&#x2F;export çš„æ–‡ä»¶è§†ä¸ºæ—§ï¼ˆå…¨å±€è€Œéæ¨¡å—åŒ–ï¼‰è„šæœ¬æ–‡ä»¶\n    &quot;isolatedModules&quot;: true,\n    &#x2F;&#x2F; ç¼–è¯‘æ—¶ä¸ç”Ÿæˆä»»ä½•JSæ–‡ä»¶ï¼ˆåªè¿›è¡Œç±»å‹æ£€æŸ¥ï¼‰\n    &quot;noEmit&quot;: true,\n    &#x2F;&#x2F; æŒ‡å®šå°† JSX ç¼–è¯‘æˆä»€ä¹ˆå½¢å¼\n    &quot;jsx&quot;: &quot;react-jsx&quot;\n  &#125;,\n  &#x2F;&#x2F; æŒ‡å®šå…è®¸ ts å¤„ç†çš„ç›®å½•\n  &quot;include&quot;: [&quot;src&quot;]\n&#125;\n&#x2F;&#x2F; https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_62118859&#x2F;article&#x2F;details&#x2F;124543485\nCannot read properties of nullreact.development.js:1621 Uncaught TypeError: Cannot read properties of null\n\n\nahooks  ç‰ˆæœ¬\nuseControlledValue\nUncaught SyntaxError: The requested module &#39;&#x2F;node_modules&#x2F;.vite&#x2F;deps&#x2F;ahooks.js?v&#x3D;a7b43f7a&#39; does not provide an export named &#39;useControlledValue&#39; (at index.tsx:2:1)\n\n\n\n\n\n\n\n\n\nDeprecated the useControlledValue naming left over from 1.0, please use useControllableValue insteadv3.0.0-alpha.4\n\n\nuseRequest\n\n\nreact_devtools_backend.js:4026 Warning: Failed prop type: The prop &#96;loadMore&#96; is marked as required in &#96;InfiniteScroll&#96;, but its value is &#96;undefined&#96;.\n\n\n\n\n\n\n\n\n\n\n\nRemoved loadMore related attributes, it is recommended to use useInfiniteScroll to achieve unlimited loading capacity.v3.0.0-alpha.4\né™¤äº† dependencies å’Œ devDependenciesï¼Œå…¶ä»–çš„ä¾èµ–æœ‰ä»€ä¹ˆä½œç”¨å‘¢\nPre-bundling dependencies:\nreact\nrecoil\nreact-dom\nreact-router-dom\nantd\n(...and 29 more)\n\næœ¬åœ°npm linkå¤„ç†ä¸äº†ä¾èµ–å†²çª\nè€ç‰ˆæœ¬å¯ä»¥è¿è¡Œ\n\n\n\næ–°ç‰ˆæœ¬æŠ¥é”™\nåŸå›  ahooks^3.x.xæ²¡æœ‰v2ç‰ˆæœ¬api\n\n\n\nå‘å¸ƒå®‰è£…åˆ°é¡¹ç›®ä¸­æµ‹è¯•\nå‘å¸ƒ\n\n\nnpm è„šæœ¬\n&quot;scripts&quot;: &#123;\n    &quot;dev&quot;: &quot;vite --port 3004&quot;,\n    &quot;start&quot;: &quot;yarn build:css &amp;&amp; webpack serve --config config&#x2F;webpack.dev.config.js&quot;,\n    &quot;copy:css&quot;: &quot;cp src&#x2F;**&#x2F;*.css dist&#x2F; &amp;&amp; rsync src&#x2F;styles&#x2F;*.css dist&#x2F;styles&#x2F;&quot;,\n    &quot;build&quot;: &quot;tsc&quot;,\n    &quot;build:css&quot;: &quot;node-sass src&#x2F; -o src&#x2F; &quot;,\n    &quot;prepublishOnly&quot;: &quot;rm -rf dist&#x2F; &amp;&amp; yarn build &amp;&amp; yarn build:css &amp;&amp; yarn copy:css&quot;,\n    &quot;t&quot;: &quot;rm -rf dist&#x2F; &amp;&amp; yarn build &amp;&amp; yarn build:css &amp;&amp; yarn copy:css&quot;,\n    &quot;push:beta&quot;: &quot;npm publish --tag beta&quot;\n  &#125;,\n\næ‰§è¡Œè„šæœ¬$ yarn push:beta\n\nå‘å¸ƒç»“æœ\n\n\n\n## Current Tags\n\n\n*   [0.0.1Â ](https:&#x2F;&#x2F;tnpm.ty-inc.top&#x2F;package&#x2F;@ty-fe&#x2F;slate-wiki-pro&#x2F;v&#x2F;0.0.1)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â  ... Â Â Â Â Â Â Â Â Â Â betaÂ (a few seconds ago)\n*   [0.0.1Â ](https:&#x2F;&#x2F;tnpm.ty-inc.top&#x2F;package&#x2F;@ty-fe&#x2F;slate-wiki-pro&#x2F;v&#x2F;0.0.1)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â  ... Â Â Â Â Â Â Â Â Â Â latestÂ (a few seconds ago)\n\n\n\n\nå›¾ç‰‡æ²¡æœ‰æ¸²æŸ“ï¼Œä¿®æ”¹ï¼Œæ‰“åŒ…é‡æ–°å‘å¸ƒ0.0.1-220519betaç‰ˆæœ¬æµ‹è¯•slate-wiki@0.0.1-220519beta\n\nnpm notice &#x3D;&#x3D;&#x3D; Tarball Details &#x3D;&#x3D;&#x3D; \nnpm notice name:          @ty-fe&#x2F;slate-wiki                     \nnpm notice version:       0.0.1-220519beta                        \nnpm notice filename:      @ty-fe&#x2F;slate-wiki-0.0.1-220519beta.tgz\nnpm notice package size:  228.0 kB                                \nnpm notice unpacked size: 1.2 MB                                  \nnpm notice shasum:        a2991de4933a9e5039ceb7082c5e0a80c2db828c\nnpm notice integrity:     sha512-iHQKpR2LM+F6Z[...]XDN40tHfwMxNg&#x3D;&#x3D;\nnpm notice total files:   417                                     \nnpm notice \n+ @ty-fe&#x2F;slate-wiki@0.0.1-220519beta\nâœ¨  Done in 16.36s.\n\n\nslate-wiki-pro@0.0.1-220519beta\n\nnpm notice &#x3D;&#x3D;&#x3D; Tarball Details &#x3D;&#x3D;&#x3D; \nnpm notice name:          @ty-fe&#x2F;slate-wiki-pro                     \nnpm notice version:       0.0.1-220519beta                            \nnpm notice filename:      @ty-fe&#x2F;slate-wiki-pro-0.0.1-220519beta.tgz\nnpm notice package size:  83.5 kB                                     \nnpm notice unpacked size: 413.7 kB                                    \nnpm notice shasum:        85cbe6fbffafc75db16e02427d1eac9b6a906ec3    \nnpm notice integrity:     sha512-3viVco6ssb2N3[...]xxisHN9+qYnCA&#x3D;&#x3D;    \nnpm notice total files:   205                                         \nnpm notice \n+ @ty-fe&#x2F;slate-wiki-pro@0.0.1-220519beta\nâœ¨  Done in 14.68s.\n\n\né—®é¢˜\nä¼ æŸ“æ€§slate-wiki-pro,ä¾èµ–äºslate-wikiã€‚slate-wikiæ”¹åŠ¨ï¼Œé¡¹ç›®ä¾èµ–slate-wiki-proï¼Œéœ€è¦å‘slate-wikiå’Œslate-wiki-proï¼Œé¡¹ç›®è¦å®‰è£…slate-wiki-pro\n\næ˜¯å¦å¯ä»¥è®©é¡¹ç›®ç›´æ¥ä¾èµ–slate-wikiã€slate-wiki-proæ”¹åŠ¨å“ªä¸ªå‘å¸ƒå“ªä¸ªï¼Œäº’ä¸å½±å“ï¼Ÿ\n\né¡¹ç›®å¾ˆå¡\n\nå°†slateã€slate-wikiã€slate-wiki-proä½¿ç”¨umdèµ„æºï¼Œé¿å…é‡å¤ç¼–è¯‘æ˜¯å¦å¯ä»¥ï¼Ÿ\n\nä¾èµ–è´¼å¤š\n\n[######--------------------------------------------------] 49992&#x2F;102014\n\n\nå¯åŠ¨æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¿«äº†\n\nviteé¢„ç¼–è¯‘æ—¶é—´è¿‡é•¿  130262ms &#x2F; 1000 &#x2F; 60 å¤§æ¦‚ä¸¤åˆ†é’Ÿï¼ŒåŠ è½½ç¼–è¯‘å¤§æ¦‚å‡ åˆ†é’Ÿï¼Œæ…¢çš„å“äºº\n\nvite v2.7.1 dev server running at:\n\n&gt; Local: http:&#x2F;&#x2F;localhost:3005&#x2F;\n&gt; Network: use &#96;--host&#96; to expose\n\nready in 130262ms.  #é¦–æ¬¡ç¼–è¯‘\n\n\n\nvite v2.7.1 dev server running at:\n\n&gt; Local: http:&#x2F;&#x2F;localhost:3005&#x2F;\n&gt; Network: use &#96;--host&#96; to expose\n\nready in 43312ms. #éé¦–æ¬¡ç¼–è¯‘\n\n\nä»£ç æ”¾ä»“åº“\nslate-wiki\n\n\nCommand line instructionsYou can also upload existing files from your computer using the instructions below.\nGit global setup\ngit config --global user.name &quot;é™ˆæµ·é¾™&quot;\ngit config --global user.email &quot;haotian.chen@ty.com&quot;\nCreate a new repository\ngit clone ssh:&#x2F;&#x2F;git@registry.code.ty-inc.top:10023&#x2F;fe-efficacy&#x2F;slate-wiki.git\ncd slate-wiki\ntouch README.md\ngit add README.md\ngit commit -m &quot;add README&quot;\nPush an existing folder\ncd existing_folder\ngit init\ngit remote add origin ssh:&#x2F;&#x2F;git@registry.code.ty-inc.top:10023&#x2F;fe-efficacy&#x2F;slate-wiki.git\ngit add .\ngit commit -m &quot;Initial commit&quot;\nPush an existing Git repository\ncd existing_repo\ngit remote rename origin old-origin\ngit remote add origin ssh:&#x2F;&#x2F;git@registry.code.ty-inc.top:10023&#x2F;fe-efficacy&#x2F;slate-wiki.git\n\n\nslate-wiki-proç•¥\n\næ·±å…¥äº†è§£æ‰“åŒ…ï¼Œæœ¬ç«™è¯·æœnpm ç‰ˆæœ¬çš„ä¾èµ–\nreact-codemirrorä½¿ç”¨ç‰ˆæœ¬react16,æ’ä»¶åŠé¡¹ç›®ä½¿ç”¨react18react-dom.development.js:22738 Uncaught TypeError: cm is not a function\n    at UnControlled.componentDidMount (react-codemirror.tsx:718:19)\n    at commitLayoutEffectOnFiber (react-dom.development.js:23204:30)\n    at commitLayoutMountEffects_complete (react-dom.development.js:24578:9)\n    at commitLayoutEffects_begin (react-dom.development.js:24564:7)\n    at commitLayoutEffects (react-dom.development.js:24502:3)\n    at commitRootImpl (react-dom.development.js:26779:5)\n    at commitRoot (react-dom.development.js:26638:5)\n    at performSyncWorkOnRoot (react-dom.development.js:26073:3)\n    at flushSyncCallbacks (react-dom.development.js:12009:22)\n    at flushSyncCallbacksOnlyInLegacyMode (react-dom.development.js:11988:5)\n\n\nvite å…³äº global is not defined é—®é¢˜react-codemirror2 æºç \ndeclare let global: any;\ndeclare let require: any;\n\nconst SERVER_RENDERED &#x3D; (typeof navigator &#x3D;&#x3D;&#x3D; &#39;undefined&#39; || (typeof global !&#x3D;&#x3D; &#39;undefined&#39; &amp;&amp; global[&#39;PREVENT_CODEMIRROR_RENDER&#39;] &#x3D;&#x3D;&#x3D; true));\n\nlet cm;\nif (!SERVER_RENDERED) &#123;\n  cm &#x3D; require(&#39;codemirror&#39;);\n&#125;\n\n\nvite 404Could not load content for http:&#x2F;&#x2F;localhost:3005&#x2F;node_modules&#x2F;@tuya-fe&#x2F;slate-wiki&#x2F;src&#x2F;slate&#x2F;3rd&#x2F;react-codemirror.tsx \n\n(HTTP error: status code 404, net::ERR_HTTP_RESPONSE_CODE_FAILURE)\n\ntodo\ncodemirror åœ¨viteä¸­è¿è¡ŒæŠ¥é”™ï¼Œcodemirroræ‰¾ä¸åˆ°ï¼Œwebpackæ‰“åŒ…æ­£å¸¸\n\n","slug":"2022-05-19npm-pkg","date":"2022-05-19T10:34:53.000Z","categories_index":"npm","tags_index":"npm,wiki","author_index":"é™ˆæµ·é¾™"},{"id":"2bd0e979bc9d9166a8f1986cef49a4e4","title":"npm ç‰ˆæœ¬çš„ä¾èµ–","content":"å‰è¨€æèµ· npmï¼Œå¤§å®¶ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„åº”è¯¥å°±æ˜¯ npm install äº†ï¼Œä½†æ˜¯ npm install ä¹‹åç”Ÿæˆçš„ node_modules å¤§å®¶æœ‰è§‚å¯Ÿè¿‡å—ï¼Ÿpackage-lock.json æ–‡ä»¶çš„ä½œç”¨å¤§å®¶çŸ¥é“å—ï¼Ÿé™¤äº† dependencies å’Œ devDependenciesï¼Œå…¶ä»–çš„ä¾èµ–æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæœ¬æ–‡å°†é’ˆå¯¹ npm ä¸­çš„ä½ å¯èƒ½å¿½ç•¥çš„ç»†èŠ‚å’Œå¤§å®¶åˆ†äº«ä¸€äº›ç»éªŒ ã€‚\nnpm å®‰è£…æœºåˆ¶A å’Œ B åŒæ—¶ä¾èµ– Cï¼ŒC è¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼ŸC çš„ç‰ˆæœ¬ç›¸åŒå’Œç‰ˆæœ¬ä¸åŒæ—¶å®‰è£…ä¼šæœ‰ä»€ä¹ˆå·®å¼‚å‘¢ï¼Ÿpackage.json ä¸­åŒ…çš„å‰åé¡ºåºå¯¹äºå®‰è£…æ—¶æœ‰ä»€ä¹ˆå½±å“å—ï¼Ÿè¿™äº›é—®é¢˜å¹³æ—¶å¤§å®¶å¯èƒ½æ²¡æœ‰æ³¨æ„è¿‡ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸€èµ·ç ”ç©¶ä¸€ä¸‹å§ã€‚\nA å’Œ B åŒæ—¶ä¾èµ– Cï¼Œè¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼Ÿå‡å¦‚æœ‰ A å’Œ B ä¸¤ä¸ªåŒ…ï¼Œä¸¤ä¸ªåŒ…éƒ½ä¾èµ– C è¿™ä¸ªåŒ…ï¼Œnpm 2 ä¼šä¾æ¬¡é€’å½’å®‰è£… A å’Œ B ä¸¤ä¸ªåŒ…åŠå…¶å­ä¾èµ–åŒ…åˆ° node_modules ä¸­ã€‚\bæ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° ./node_modules è¿™å±‚ç›®å½•åªå«æœ‰è¿™ä¸¤ä¸ªå­ç›®å½•ï¼š\nnode_modules&#x2F; \nâ”œâ”€â”¬ A \nâ”‚ â”œâ”€â”€ C \nâ”œâ”€â”¬ B \nâ”‚ â””â”€â”€ C \nå¦‚æœä½¿ç”¨ npm 3 æ¥è¿›è¡Œå®‰è£…çš„è¯ï¼Œ./node_modules ä¸‹çš„ç›®å½•å°†ä¼šåŒ…å«ä¸‰ä¸ªå­ç›®å½•ï¼š\nnode_modules&#x2F; \nâ”œâ”€â”¬ A \nâ”œâ”€â”¬ B \nâ”œâ”€â”¬ C \nä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„åŒºåˆ«å‘¢ï¼Ÿè¿™å°±è¦ä» npm çš„å·¥ä½œæ–¹å¼è¯´èµ·äº†ï¼š\nnpm 2 å’Œ npm 3 æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚è™½ç„¶ç›®å‰æœ€æ–°çš„ npm ç‰ˆæœ¬æ˜¯ npm 6ï¼Œä½† npm 2 åˆ° npm 3 çš„ç‰ˆæœ¬å˜æ›´ä¸­å®ç°äº†ç›®å½•æ‰“å¹³ï¼Œä¸å…¶ä»–ç‰ˆæœ¬ç›¸æ¯”å·®åˆ«è¾ƒå¤§ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬å…·ä½“çœ‹ä¸‹è¿™ä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚ã€‚\nnpm 2 åœ¨å®‰è£…ä¾èµ–åŒ…æ—¶ï¼Œé‡‡ç”¨\bç®€å•çš„é€’å½’å®‰è£…æ–¹æ³•ã€‚æ‰§è¡Œ npm install åï¼Œnpm æ ¹æ® dependencies å’Œ devDependencies å±æ€§ä¸­æŒ‡å®šçš„åŒ…æ¥ç¡®å®šç¬¬ä¸€å±‚ä¾èµ–ï¼Œnpm 2 ä¼šæ ¹æ®ç¬¬ä¸€å±‚ä¾èµ–çš„å­ä¾èµ–ï¼Œé€’å½’å®‰è£…å„ä¸ªåŒ…åˆ°å­ä¾èµ–çš„ node_modules ä¸­ï¼Œç›´åˆ°å­ä¾èµ–ä¸å†ä¾èµ–å…¶ä»–æ¨¡å—ã€‚\bæ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° .&#x2F;node_modules è¿™å±‚ç›®å½•ä¸­åŒ…å«æœ‰æˆ‘ä»¬ package.json æ–‡ä»¶ä¸­æ‰€æœ‰çš„ä¾èµ–åŒ…ï¼Œè€Œè¿™äº›ä¾èµ–åŒ…çš„å­ä¾èµ–åŒ…éƒ½å®‰è£…åœ¨äº†è‡ªå·±çš„ node_modules ä¸­ ï¼Œå½¢æˆç±»ä¼¼äºä¸‹é¢çš„ä¾èµ–æ ‘ï¼š\n\nè¿™æ ·çš„ç›®å½•æœ‰è¾ƒä¸ºæ˜æ˜¾çš„å¥½å¤„ï¼š\n1ï¼‰å±‚çº§ç»“æ„éå¸¸æ˜æ˜¾ï¼Œå¯ä»¥æ¸…æ¥šçš„åœ¨ç¬¬ä¸€å±‚çš„ node_modules ä¸­çœ‹åˆ°æˆ‘ä»¬å®‰è£…çš„æ‰€æœ‰åŒ…çš„å­ç›®å½•ï¼›\n2ï¼‰åœ¨å·²çŸ¥è‡ªå·±æ‰€éœ€åŒ…çš„åå­—ä»¥åŠç‰ˆæœ¬å·æ—¶ï¼Œå¯ä»¥å¤åˆ¶ç²˜è´´ç›¸åº”çš„æ–‡ä»¶åˆ° node_modules ä¸­ï¼Œç„¶åæ‰‹åŠ¨æ›´æ”¹ package.json ä¸­çš„é…ç½®ï¼›\n3ï¼‰å¦‚æœæƒ³è¦åˆ é™¤æŸä¸ªåŒ…ï¼Œåªéœ€è¦ç®€å•çš„åˆ é™¤ package.json æ–‡ä»¶ä¸­ç›¸åº”çš„æŸä¸€è¡Œï¼Œç„¶ååˆ é™¤ node_modules ä¸­è¯¥åŒ…çš„ç›®å½•ï¼›\nä½†æ˜¯è¿™æ ·çš„å±‚çº§ç»“æ„ä¹Ÿæœ‰è¾ƒä¸ºæ˜æ˜¾çš„ç¼ºé™·ï¼Œå½“æˆ‘çš„ Aï¼ŒBï¼ŒC ä¸‰ä¸ªåŒ…ä¸­æœ‰ç›¸åŒçš„ä¾èµ– D æ—¶ï¼Œæ‰§è¡Œ npm install åï¼ŒD ä¼šè¢«é‡å¤ä¸‹è½½ä¸‰æ¬¡ï¼Œè€Œéšç€æˆ‘ä»¬çš„é¡¹ç›®è¶Šæ¥è¶Šå¤æ‚ï¼Œnode_modules ä¸­çš„ä¾èµ–æ ‘ä¹Ÿä¼šè¶Šæ¥è¶Šå¤æ‚ï¼Œåƒ D è¿™æ ·çš„åŒ…ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šï¼Œé€ æˆäº†å¤§é‡çš„å†—ä½™ï¼›åœ¨ windows ç³»ç»Ÿä¸­ï¼Œç”šè‡³ä¼šå› ä¸ºç›®å½•çš„å±‚çº§å¤ªæ·±å¯¼è‡´æ–‡ä»¶çš„è·¯å¾„è¿‡é•¿ï¼Œè§¦å‘æ–‡ä»¶è·¯å¾„ä¸èƒ½è¶…è¿‡ 280 ä¸ªå­—ç¬¦çš„é”™è¯¯ï¼›\nä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œnpm 3 çš„ node_modules ç›®å½•æ”¹æˆäº†æ›´ä¸ºæ‰å¹³çŠ¶çš„å±‚çº§ç»“æ„ï¼Œå°½é‡æŠŠä¾èµ–ä»¥åŠä¾èµ–çš„ä¾èµ–å¹³é“ºåœ¨ node_modules æ–‡ä»¶å¤¹ä¸‹å…±äº«ä½¿ç”¨ã€‚\nnpm 3 å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿnpm 3 ä¼šéå†æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œé€ä¸ªå°†æ¨¡å—æ”¾åœ¨ node_modules çš„ç¬¬ä¸€å±‚ï¼Œå½“å‘ç°æœ‰é‡å¤æ¨¡å—æ—¶ï¼Œåˆ™ä¸¢å¼ƒï¼Œ å¦‚æœé‡åˆ°æŸäº›ä¾èµ–ç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜ï¼Œåˆ™ç»§ç»­é‡‡ç”¨ npm 2 çš„å¤„ç†æ–¹å¼ï¼Œå‰é¢çš„æ”¾åœ¨ node_modules ç›®å½•ä¸­ï¼Œåé¢çš„æ”¾åœ¨ä¾èµ–æ ‘ä¸­ã€‚ä¸¾ä¸ªä¾‹å­ï¼š Aï¼ŒBï¼Œä¾èµ– D(v 0.0.1)ï¼ŒC ä¾èµ– D(v 0.0.2):\n\nä½†æ˜¯ npm 3 ä¼šå¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç”±äºåœ¨æ‰§è¡Œ npm install çš„æ—¶å€™ï¼ŒæŒ‰ç…§ package.json é‡Œä¾èµ–çš„é¡ºåºä¾æ¬¡è§£æï¼Œä¸Šå›¾å¦‚æœ C çš„é¡ºåºåœ¨ Aï¼ŒB çš„å‰è¾¹ï¼Œnode_modules æ ‘åˆ™ä¼šæ”¹å˜ï¼Œä¼šå‡ºç°ä¸‹è¾¹çš„æƒ…å†µï¼š\n\nç”±æ­¤å¯è§ï¼Œnpm 3 å¹¶æœªå®Œå…¨è§£å†³å†—ä½™çš„é—®é¢˜ï¼Œç”šè‡³è¿˜ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚\nä¸ºä»€ä¹ˆä¼šå‡ºç° package-lock.json å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¼šæœ‰ package-lock.json æ–‡ä»¶å‘¢ï¼Ÿè¿™ä¸ªæˆ‘ä»¬å°±è¦å…ˆä» package.json æ–‡ä»¶è¯´èµ·äº†ã€‚\npackage.json çš„ä¸è¶³ä¹‹å¤„npm install æ‰§è¡Œåï¼Œä¼šç”Ÿæˆä¸€ä¸ª node_modules æ ‘ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œ å¸Œæœ›å¯¹äºåŒä¸€ä¸ª package.json æ€»æ˜¯ç”Ÿæˆå®Œå…¨ç›¸åŒ node_modules æ ‘ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¡®å®å¦‚æ­¤ã€‚ä½†åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œnpm æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼š\n1ï¼‰æŸäº›ä¾èµ–é¡¹è‡ªä¸Šæ¬¡å®‰è£…ä»¥æ¥ï¼Œå¯èƒ½å·²å‘å¸ƒäº†æ–°ç‰ˆæœ¬ ã€‚æ¯”å¦‚ï¼šA åŒ…åœ¨å›¢é˜Ÿä¸­ç¬¬ä¸€ä¸ªäººå®‰è£…çš„æ—¶å€™æ˜¯ 1.0.5 ç‰ˆæœ¬ï¼Œpackage.json ä¸­çš„é…ç½®é¡¹ä¸º A: &#39;^1.0.5&#39; ï¼›å›¢é˜Ÿä¸­ç¬¬äºŒä¸ªäººæŠŠä»£ç æ‹‰ä¸‹æ¥çš„æ—¶å€™ï¼ŒA åŒ…çš„ç‰ˆæœ¬å·²ç»å‡çº§æˆäº† 1.0.8ï¼Œæ ¹æ® package.json ä¸­çš„ semver-range version è§„èŒƒï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªäºº npm install å A çš„ç‰ˆæœ¬ä¸º 1.0.8ï¼› å¯èƒ½ä¼šé€ æˆå› ä¸ºä¾èµ–ç‰ˆæœ¬ä¸åŒè€Œå¯¼è‡´çš„ bugï¼›\n2ï¼‰é’ˆå¯¹ 1ï¼‰ä¸­çš„é—®é¢˜ï¼Œå¯èƒ½æœ‰çš„å°ä¼™ä¼´ä¼šæƒ³ï¼ŒæŠŠ A çš„ç‰ˆæœ¬å·å›ºå®šä¸º A: &#39;1.0.5&#39; ä¸å°±å¯ä»¥äº†å—ï¼Ÿä½†æ˜¯è¿™æ ·çš„åšæ³•å…¶å®å¹¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œ æ¯”å¦‚ A çš„æŸä¸ªä¾èµ–åœ¨ç¬¬ä¸€ä¸ªäººä¸‹è½½çš„æ—¶å€™æ˜¯ 2.1.3 ç‰ˆæœ¬ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªäººä¸‹è½½çš„æ—¶å€™å·²ç»å‡çº§åˆ°äº† 2.2.5 ç‰ˆæœ¬ï¼Œæ­¤æ—¶ç”Ÿæˆçš„ node_modules æ ‘ä¾æ—§ä¸å®Œå…¨ç›¸åŒ ï¼Œå›ºå®šç‰ˆæœ¬åªæ˜¯å›ºå®šæ¥è‡ªèº«çš„ç‰ˆæœ¬ï¼Œä¾èµ–çš„ç‰ˆæœ¬æ— æ³•å›ºå®šã€‚\né’ˆå¯¹ package.json ä¸è¶³çš„è§£å†³æ–¹æ³•ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ä»¥åŠ npm 3 çš„é—®é¢˜ï¼Œåœ¨ npm 5.0 ç‰ˆæœ¬åï¼Œnpm install åéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª package-lock.json æ–‡ä»¶ ï¼Œå½“åŒ…ä¸­æœ‰ package-lock.json æ–‡ä»¶æ—¶ï¼Œnpm install æ‰§è¡Œæ—¶ï¼Œå¦‚æœ package.json å’Œ package-lock.json ä¸­çš„ç‰ˆæœ¬å…¼å®¹ï¼Œä¼šæ ¹æ® package-lock.json ä¸­çš„ç‰ˆæœ¬ä¸‹è½½ï¼›å¦‚æœä¸å…¼å®¹ï¼Œå°†ä¼šæ ¹æ® package.json çš„ç‰ˆæœ¬ï¼Œæ›´æ–° package-lock.json ä¸­çš„ç‰ˆæœ¬ï¼Œå·²ä¿è¯ package-lock.json ä¸­çš„ç‰ˆæœ¬å…¼å®¹ package.jsonã€‚\npackage-lock.json æ–‡ä»¶çš„ç»“æ„package-lock.json æ–‡ä»¶ä¸­çš„ nameã€version ä¸ package.json ä¸­çš„ nameã€version ä¸€æ ·ï¼Œæè¿°äº†å½“å‰åŒ…çš„åå­—å’Œç‰ˆæœ¬ï¼Œdependencies æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å’Œ node_modules ä¸­çš„åŒ…ç»“æ„ä¸€ä¸€å¯¹åº”ï¼Œå¯¹è±¡çš„ key ä¸ºåŒ…çš„åç§°ï¼Œå€¼ä¸ºåŒ…çš„ä¸€äº›æè¿°ä¿¡æ¯ï¼Œ æ ¹æ® package-lock-jsonå®˜æ–¹æ–‡æ¡£ï¼Œä¸»è¦çš„ç»“æ„å¦‚ä¸‹ï¼š\n\nversion ï¼šåŒ…ç‰ˆæœ¬ï¼Œå³è¿™ä¸ªåŒ…å½“å‰å®‰è£…åœ¨ node_modules ä¸­çš„ç‰ˆæœ¬\n\nresolved ï¼šåŒ…å…·ä½“çš„å®‰è£…æ¥æº\n\nintegrity ï¼šåŒ… hash å€¼ï¼ŒéªŒè¯å·²å®‰è£…çš„è½¯ä»¶åŒ…æ˜¯å¦è¢«æ”¹åŠ¨è¿‡ã€æ˜¯å¦å·²å¤±æ•ˆ\n\nrequires ï¼šå¯¹åº”å­ä¾èµ–çš„ä¾èµ–ï¼Œä¸å­ä¾èµ–çš„ package.json ä¸­ dependencies çš„ä¾èµ–é¡¹ç›¸åŒ\n\ndependencies ï¼šç»“æ„å’Œå¤–å±‚çš„ dependencies ç»“æ„ç›¸åŒï¼Œå­˜å‚¨å®‰è£…åœ¨å­ä¾èµ– node_modules ä¸­çš„ä¾èµ–åŒ…\n\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­ä¾èµ–éƒ½æœ‰ dependencies å±æ€§ï¼Œåªæœ‰å­ä¾èµ–çš„ä¾èµ–å’Œå½“å‰å·²å®‰è£…åœ¨æ ¹ç›®å½•çš„ node_modules ä¸­çš„ä¾èµ–å†²çªä¹‹åï¼Œæ‰ä¼šæœ‰è¿™ä¸ªå±æ€§ã€‚\npackage-lock.json æ–‡ä»¶çš„ä½œç”¨åœ¨å›¢é˜Ÿå¼€å‘ä¸­ï¼Œç¡®ä¿æ¯ä¸ªå›¢é˜Ÿæˆå‘˜å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬æ˜¯ä¸€è‡´çš„ï¼Œç¡®å®šä¸€æ£µå”¯ä¸€çš„ node_modules æ ‘ï¼›\nnode_modules ç›®å½•æœ¬èº«æ˜¯ä¸ä¼šè¢«æäº¤åˆ°ä»£ç åº“çš„ï¼Œä½†æ˜¯ package-lock.json å¯ä»¥æäº¤åˆ°ä»£ç åº“ï¼Œå¦‚æœå¼€å‘äººå‘˜æƒ³è¦å›æº¯åˆ°æŸä¸€å¤©çš„ç›®å½•çŠ¶æ€ï¼Œåªéœ€è¦æŠŠ package.json å’Œ package-lock.json è¿™ä¸¤ä¸ªæ–‡ä»¶å›é€€åˆ°é‚£ä¸€å¤©å³å¯ ã€‚\nç”±äº package-lock.json å’Œ node_modules ä¸­çš„ä¾èµ–åµŒå¥—å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥æ›´åŠ æ¸…æ¥šçš„äº†è§£æ ‘çš„ç»“æ„åŠå…¶å˜åŒ–ã€‚\nåœ¨å®‰è£…æ—¶ï¼Œnpm ä¼šæ¯”è¾ƒ node_modules å·²æœ‰çš„åŒ…ï¼Œå’Œ package-lock.json è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœé‡å¤çš„è¯ï¼Œå°±è·³è¿‡å®‰è£… ï¼Œä»è€Œä¼˜åŒ–äº†å®‰è£…çš„è¿‡ç¨‹ã€‚\nä¾èµ–çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯npm ç›®å‰æ”¯æŒä»¥ä¸‹å‡ ç±»ä¾èµ–åŒ…ç®¡ç†åŒ…æ‹¬\ndependencies\n\ndevDependencies\n\noptionalDependencies å¯é€‰æ‹©çš„ä¾èµ–åŒ…\n\npeerDependencies åŒç­‰ä¾èµ–\n\nbundledDependencies æ†ç»‘ä¾èµ–åŒ…\n\n\nä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™å‡ ç§ä¾èµ–çš„åŒºåˆ«ä»¥åŠå„è‡ªçš„åº”ç”¨åœºæ™¯ï¼š\ndependenciesdependencies æ˜¯æ— è®ºåœ¨å¼€å‘ç¯å¢ƒè¿˜æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒéƒ½å¿…é¡»ä½¿ç”¨çš„ä¾èµ–ï¼Œæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ä¾èµ–åŒ…ç®¡ç†å¯¹è±¡ï¼Œä¾‹å¦‚ Reactï¼ŒLoadshï¼ŒAxios ç­‰ï¼Œé€šè¿‡ npm install XXX ä¸‹è½½çš„åŒ…éƒ½ä¼šé»˜è®¤å®‰è£…åœ¨ dependencies å¯¹è±¡ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ npm install XXX --save ä¸‹è½½ dependencies ä¸­çš„åŒ…ï¼›\n&quot;devDependencies&quot;:&#123;\n  &quot;eslint&quot;: &quot;^5.0.0&quot;,\n  &quot;debug&quot;: &quot;^3.1.0&quot;,\n&#125;\n\n\ndevDependenciesdevDependencies æ˜¯æŒ‡å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨çš„ä¾èµ–ï¼Œä¾‹å¦‚ eslintï¼Œdebug ç­‰ï¼Œé€šè¿‡ npm install packageName --save-dev ä¸‹è½½çš„åŒ…éƒ½ä¼šåœ¨ devDependencies å¯¹è±¡ä¸­ï¼›\ndependencies å’Œ devDependencies æœ€å¤§çš„åŒºåˆ«æ˜¯åœ¨æ‰“åŒ…è¿è¡Œæ—¶ï¼Œæ‰§è¡Œ npm install æ—¶é»˜è®¤ä¼šæŠŠæ‰€æœ‰ä¾èµ–å…¨éƒ¨å®‰è£…ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ npm install --production æ—¶å°±åªä¼šå®‰è£… dependencies ä¸­çš„ä¾èµ–ï¼Œå¦‚æœæ˜¯ node æœåŠ¡é¡¹ç›®ï¼Œå°±å¯ä»¥é‡‡ç”¨è¿™æ ·çš„æ–¹å¼ç”¨äºæœåŠ¡è¿è¡Œæ—¶å®‰è£…å’Œæ‰“åŒ…ï¼Œå‡å°‘åŒ…å¤§å°ã€‚\noptionalDependenciesoptionalDependencies æŒ‡çš„æ˜¯å¯ä»¥é€‰æ‹©çš„ä¾èµ–ï¼Œå½“ä½ å¸Œæœ›æŸäº›ä¾èµ–å³ä½¿ä¸‹è½½å¤±è´¥æˆ–è€…æ²¡æœ‰æ‰¾åˆ°æ—¶ï¼Œé¡¹ç›®ä¾ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œæˆ–è€… npm ç»§ç»­è¿è¡Œçš„æ—¶ï¼Œå°±å¯ä»¥æŠŠè¿™äº›ä¾èµ–æ”¾åœ¨ optionalDependencies å¯¹è±¡ä¸­ï¼Œä½†æ˜¯ optionalDependencies ä¼šè¦†ç›– dependencies ä¸­çš„åŒåä¾èµ–åŒ…ï¼Œæ‰€ä»¥ä¸è¦æŠŠä¸€ä¸ªåŒ…åŒæ—¶å†™è¿›ä¸¤ä¸ªå¯¹è±¡ä¸­ã€‚\noptionalDependencies å°±åƒæ˜¯æˆ‘ä»¬çš„ä»£ç çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ä¸€æ ·ï¼Œå¦‚æœåŒ…å­˜åœ¨çš„è¯å°±èµ°å­˜åœ¨çš„é€»è¾‘ï¼Œä¸å­˜åœ¨çš„å°±èµ°ä¸å­˜åœ¨çš„é€»è¾‘ã€‚\ntry &#123; \n  var axios &#x3D; require(&#39;axios&#39;) \n  var fooVersion &#x3D; require(&#39;axios&#x2F;package.json&#39;).version \n&#125; catch (er) &#123; \n  foo &#x3D; null \n&#125; \n&#x2F;&#x2F; .. then later in your program .. \nif (foo) &#123; \n  foo.doFooThings() \n&#125; \n\n\npeerDependenciespeerDependencies ç”¨äºæŒ‡å®šä½ å½“å‰çš„æ’ä»¶å…¼å®¹çš„å®¿ä¸»å¿…é¡»è¦å®‰è£…çš„åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼šæˆ‘ä»¬å¸¸ç”¨çš„ react ç»„ä»¶åº“ ant-design@3.x çš„ package.json ä¸­çš„é…ç½®å¦‚ä¸‹ï¼š\n&quot;peerDependencies&quot;: &#123; \n  &quot;react&quot;: &quot;&gt;&#x3D;16.9.0&quot;, \n  &quot;react-dom&quot;: &quot;&gt;&#x3D;16.9.0&quot; \n &#125;, \nå‡è®¾æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º project çš„é¡¹ç›®ï¼Œåœ¨æ­¤é¡¹ç›®ä¸­æˆ‘ä»¬è¦ä½¿ç”¨ ant-design@3.x è¿™ä¸ªæ’ä»¶ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„é¡¹ç›®å°±å¿…é¡»å…ˆå®‰è£… React &gt;&#x3D; 16.9.0 å’Œ React-dom &gt;&#x3D; 16.9.0 çš„ç‰ˆæœ¬ã€‚\nåœ¨ npm 2 ä¸­ï¼Œå½“æˆ‘ä»¬ä¸‹è½½ ant-design@3.x æ—¶ï¼ŒpeerDependencies ä¸­æŒ‡å®šçš„ä¾èµ–ä¼šéšç€ ant-design@3.x ä¸€èµ·è¢«å¼ºåˆ¶å®‰è£…ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦åœ¨å®¿ä¸»é¡¹ç›®çš„ package.json æ–‡ä»¶ä¸­æŒ‡å®š peerDependencies ä¸­çš„ä¾èµ–ï¼Œä½†æ˜¯åœ¨ npm 3 ä¸­ï¼Œä¸ä¼šå†å¼ºåˆ¶å®‰è£… peerDependencies ä¸­æ‰€æŒ‡å®šçš„åŒ…ï¼Œè€Œæ˜¯é€šè¿‡è­¦å‘Šçš„æ–¹å¼æ¥æç¤ºæˆ‘ä»¬ï¼Œæ­¤æ—¶å°±éœ€è¦æ‰‹åŠ¨åœ¨ package.json æ–‡ä»¶ä¸­æ‰‹åŠ¨æ·»åŠ ä¾èµ–ï¼›\nbundledDependenciesè¿™ä¸ªä¾èµ–é¡¹ä¹Ÿå¯ä»¥è®°ä¸º bundleDependenciesï¼Œä¸å…¶ä»–å‡ ç§ä¾èµ–é¡¹ä¸åŒï¼Œä»–ä¸æ˜¯ä¸€ä¸ªé”®å€¼å¯¹çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œæ˜¯åŒ…åçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š\n&#123; \n  &quot;name&quot;: &quot;project&quot;, \n  &quot;version&quot;: &quot;1.0.0&quot;, \n  &quot;bundleDependencies&quot;: [ \n    &quot;axios&quot;,  \n    &quot;lodash&quot; \n  ] \n&#125; \nå½“ä½¿ç”¨ npm pack çš„æ–¹å¼æ¥æ‰“åŒ…æ—¶ï¼Œä¸Šè¿°çš„ä¾‹å­ä¼šç”Ÿæˆä¸€ä¸ª project-1.0.0.tgz çš„æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨äº† bundledDependencies åï¼Œæ‰“åŒ…æ—¶ä¼šæŠŠ Axios å’Œ Lodash è¿™ä¸¤ä¸ªä¾èµ–ä¸€èµ·æ”¾å…¥åŒ…ä¸­ï¼Œä¹‹åæœ‰äººä½¿ç”¨ npm install project-1.0.0.tgz ä¸‹è½½åŒ…æ—¶ï¼ŒAxios å’Œ Lodash è¿™ä¸¤ä¸ªä¾èµ–ä¹Ÿä¼šè¢«å®‰è£…ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å®‰è£…ä¹‹å Axios å’Œ Lodash è¿™ä¸¤ä¸ªåŒ…çš„ä¿¡æ¯åœ¨ dependencies ä¸­ï¼Œå¹¶ä¸”ä¸åŒ…æ‹¬ç‰ˆæœ¬ä¿¡æ¯ã€‚\n&quot;bundleDependencies&quot;: [ \n    &quot;axios&quot;, \n    &quot;lodash&quot; \n  ], \n&quot;dependencies&quot;: &#123; \n  &quot;axios&quot;: &quot;*&quot;, \n  &quot;lodash&quot;: &quot;*&quot; \n&#125;, \nå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¸¸è§„çš„ npm publish æ¥å‘å¸ƒçš„è¯ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥æ—¥å¸¸æƒ…å†µä¸­ä½¿ç”¨çš„è¾ƒå°‘ã€‚\næ€»ç»“æœ¬æ–‡ä»‹ç»çš„æ˜¯ npm 2ï¼Œnpm 3ï¼Œpackage-lock.json ä»¥åŠå‡ ç§ä¾èµ–çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ï¼Œå¸Œæœ›èƒ½å¤Ÿè®©å¤§å®¶å¯¹ npm çš„äº†è§£æ›´åŠ å¤šä¸€ç‚¹ï¼Œæœ‰ä»€ä¹ˆä¸æ¸…æ¥šçš„åœ°æ–¹æˆ–è€…ä¸è¶³ä¹‹å¤„æ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºç•™è¨€ã€‚\nå‚è€ƒæ–‡çŒ®\nåŸæ–‡\npackage.jsonå®˜æ–¹æ–‡æ¡£\npackage-lock-jsonå®˜æ–¹æ–‡æ¡£\nnpmæ–‡æ¡£æ€»ç»“\nnpm-pack\n\n","slug":"2022-05-19npm","date":"2022-05-19T10:10:47.000Z","categories_index":"npm","tags_index":"å·¥å…·,npm","author_index":"é™ˆæµ·é¾™"},{"id":"72e60ad0a93fafff72edb1b0852502a0","title":"TypeScript noEmit","content":"No Emit -noEmitDo not emit compiler output files like JavaScript source code, source-maps or declarations.ä¸è¦å‘å‡ºç¼–è¯‘å™¨è¾“å‡ºæ–‡ä»¶ï¼Œå¦‚JavaScriptæºä»£ç ã€æºæ˜ å°„æˆ–å£°æ˜ã€‚\nThis makes room for another tool like Babel, or swc to handle converting the TypeScript file to a file which can run inside a JavaScript environment.\nYou can then use TypeScript as a tool for providing editor integration, and as a source code type-checker.\nå¯¼è‡´outDirä¸è¾“å‡º\n","slug":"2022-05-18ts","date":"2022-05-18T08:55:53.000Z","categories_index":"typescript","tags_index":"typescript","author_index":"é™ˆæµ·é¾™"},{"id":"38b6e3ab42ce78e34a964ff2e90b3a7d","title":"Slate å­¦ä¹ ","content":"æ–‡æ¡£slate ä¸­æ–‡æ–‡æ¡£slate è‹±æ–‡æ–‡æ¡£\næ˜¯ä»€ä¹ˆ\n\n\n\n\n\n\n\n\nSlate æ˜¯ä¸€ä¸ª å®Œå…¨ å¯å®šåˆ¶çš„å¯Œæ–‡æœ¬ç¼–è¾‘æ¡†æ¶ã€‚é€šè¿‡ Slateï¼Œä½ å¯ä»¥æ„å»ºå‡ºç±»ä¼¼ Mediumã€Dropbox Paper æˆ–è€… Canvas è¿™æ ·ä½¿ç”¨ç›´è§‚ã€å¯Œäº¤äº’ã€ä½“éªŒä¸šå·²æˆä¸º Web åº”ç”¨æ ‡æ†çš„ç¼–è¾‘å™¨ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿæ— éœ€æ‹…å¿ƒåœ¨ä»£ç å®ç°ä¸Šé™·å…¥å¤æ‚åº¦çš„æ³¥æ½­ä¹‹ä¸­ã€‚\nèƒ½åšä»€ä¹ˆ\n\n\n\n\n\n\n\n\né€šè¿‡ Slateï¼Œä½ å¯ä»¥æ„å»ºå‡ºç±»ä¼¼ Mediumã€Dropbox Paper æˆ–è€… Canvas è¿™æ ·ä½¿ç”¨ç›´è§‚ã€å¯Œäº¤äº’ã€ä½“éªŒä¸šå·²æˆä¸º Web åº”ç”¨æ ‡æ†çš„ç¼–è¾‘å™¨ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿæ— éœ€æ‹…å¿ƒåœ¨ä»£ç å®ç°ä¸Šé™·å…¥å¤æ‚åº¦çš„æ³¥æ½­ä¹‹ä¸­ã€‚Slate ä¹‹æ‰€ä»¥èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ˜¯å› ä¸ºå®ƒçš„æ‰€æœ‰é€»è¾‘éƒ½æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„æ’ä»¶å®ç°çš„ã€‚è¿™æ ·ï¼Œä½ å°±å†ä¹Ÿä¸ä¼šè¢«æŸé¡¹ç‰¹æ€§ åœ¨ æˆ– ä¸åœ¨ ç¼–è¾‘å™¨ã€æ ¸å¿ƒã€‘è¾¹ç•Œä¹‹å†…çš„é—®é¢˜æ‰€å›°æ‰°äº†ã€‚ä½ å¯ä»¥å°†å®ƒç†è§£ä¸ºåœ¨ React å’Œ Immutable åŸºç¡€ä¸Šï¼Œä¸€ç§å¯æ’æ‹”çš„ contenteditable å®ç°ã€‚å¦å¤–ï¼Œå®ƒçš„çµæ„Ÿæ¥è‡ªäº Draft.jsï¼ŒProsemirror å’Œ Quill ç­‰ç±»åº“ã€‚\näº§ç”Ÿçš„èƒŒæ™¯\n\n\n\n\n\n\n\n\nä¸ºä»€ä¹ˆå‘æ˜ Slate å‘¢ï¼Ÿå¥½å§â€¦ï¼ˆæ³¨æ„ï¼Œè¿™éƒ¨åˆ†å†…å®¹åŒ…å«äº†ä¸€äº›æˆ‘çš„ä¸ªäººè§‚ç‚¹ï¼ï¼‰\n\n\n\n\n\n\n\n\n\nåœ¨å‘æ˜ Slate ä¹‹å‰ï¼Œæˆ‘å°è¯•äº†è®¸å¤šä¸åŒçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€‚æˆ‘å‘ç°è™½ç„¶å®ƒä»¬åœ¨ç¼–å†™ç®€å•ç¤ºä¾‹æ—¶åŸºæœ¬æ²¡æœ‰é—®é¢˜ï¼Œä½†ä¸€æ—¦æƒ³è¦æ„å»ºä¸€äº›ç±»ä¼¼ Mediumã€Dropbox Paper æˆ–è€… Google Docs è¿™æ ·çš„å†…å®¹ï¼Œä½ å°±ä¼šå‘ç°ä¸€äº›æ·±å±‚æ¬¡çš„é—®é¢˜ï¼Œæ¯”å¦‚â€¦\n\n\n\n\n\n\n\n\n\nç¼–è¾‘å™¨ç¡¬ç¼–ç äº†æ–‡æ¡£çš„ç»“æ„è§„èŒƒï¼Œéš¾ä»¥å®šåˆ¶ã€‚ç±»ä¼¼åŠ ç²—å’Œæ–œä½“çš„ç»“æ„å¯ä»¥å¼€ç®±å³ç”¨ï¼Œä½†è¯„è®ºã€åµŒå…¥å†…å®¹ä»¥åŠæ›´å¤šçš„å®šåˆ¶æ€§éœ€æ±‚å‘¢ï¼Ÿ\n\n\n\n\n\n\n\n\n\nå¯¹æ–‡æ¡£çš„ç¼–ç¨‹å¼å˜æ¢éå¸¸é”™ç»¼å¤æ‚ã€‚ç”¨æˆ·çš„ç¼–å†™ä½“éªŒå¯èƒ½ä¸é”™ï¼Œä½†åœ¨æ‰§è¡Œç¼–ç¨‹å¼å˜æ›´æ—¶å´ä¸å¿…è¦åœ°å¤æ‚ï¼Œè€Œè¿™å¯¹äºæ„å»ºé«˜çº§çš„ç¼–è¾‘è¡Œä¸ºè‡³å…³é‡è¦ã€‚\n\n\n\n\n\n\n\n\n\nå¯¹ HTMLã€Markdown ç­‰å†…å®¹çš„åºåˆ—åŒ–æ”¯æŒçœ‹èµ·æ¥åƒæ˜¯äº‹ååŠ ä¸Šçš„ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼Œä½†è¦å®ç°å°†æ–‡æ¡£è½¬æ¢ä¸º HTML æˆ– Markdown çš„ç®€å•åŠŸèƒ½éƒ½éœ€è¦ç¼–å†™å¤§é‡çš„æ¨¡æ¿ä»£ç ã€‚\n\n\n\n\n\n\n\n\n\né‡æ–°å­¦ä¹ ä¸€ä¸ªæ–°çš„è§†å›¾å±‚æ•ˆç‡ä¸é«˜ä¸”ååˆ†å—é™ã€‚å„ç§ç¼–è¾‘å™¨åœ¨é‡æ–°å‘æ˜è§†å›¾å±‚çš„è½®å­ï¼Œè€Œéä½¿ç”¨ React è¿™æ ·å·²æœ‰çš„æŠ€æœ¯æ–¹æ¡ˆã€‚ä½ å¿…é¡»å­¦ä¹ ä¸€å¥—å¸¦ç€è‡ªæœ‰é™åˆ¶å’Œé™·é˜±çš„æ–°ç³»ç»Ÿã€‚\n\n\n\n\n\n\n\n\n\n**å¯¹ååŒç¼–è¾‘æ²¡æœ‰é¢„å…ˆè®¾è®¡å¥½çš„æ”¯æŒ**ã€‚ç¼–è¾‘å™¨å†…éƒ¨çš„æ•°æ®ç»“æ„ä½¿å…¶æ— æ³•ç”¨äºå®æ—¶ã€åä½œçš„ç¼–è¾‘åœºæ™¯ä¸­ï¼Œé™¤éé‡å†™ç¼–è¾‘å™¨ã€‚\n\n\n\n\n\n\n\n\n\nä»£ç ä»“åº“æ˜¯å•ä½“çš„ï¼Œè€Œéå°è€Œå¯å¤ç”¨çš„ã€‚è®¸å¤šç¼–è¾‘å™¨æ²¡æœ‰å¯¹å¤–å¼€æ”¾æœ¬åº”ä¸ºå¼€å‘è€…æ‰€å¤ç”¨çš„å†…éƒ¨å·¥å…·ï¼Œä»¥è‡³äºä¸å¾—ä¸é‡æ–°å‘æ˜è½®å­ã€‚\n\n\n\n\n\n\n\n\n\næ— æ³•æ„å»ºå¤æ‚è€Œå­˜åœ¨åµŒå¥—å…³ç³»çš„æ–‡æ¡£ã€‚ä¸å°‘ç¼–è¾‘å™¨æ˜¯å›´ç»•ç®€å•çš„ã€æ‰å¹³ã€‘æ–‡æ¡£ç»“æ„è®¾è®¡çš„ï¼Œè¿™ä½¿å¾—è¡¨æ ¼ã€åµŒå…¥å†…å®¹å’Œå­—å¹•ç­‰å†…å®¹éš¾ä»¥ç†è§£ï¼Œæœ‰æ—¶ç”šè‡³æ— æ³•å®ç°ã€‚\n\n\n\n\n\n\n\n\n\nå½“ç„¶ï¼Œå¹¶éæ‰€æœ‰çš„ç¼–è¾‘å™¨éƒ½å­˜åœ¨ä»¥ä¸Šçš„é—®é¢˜ï¼Œä½†å¦‚æœä½ å·²ç»å°è¯•è¿‡ä¸€äº›ç¼–è¾‘å™¨ï¼Œä½ å¯èƒ½å·²ç»è¸©è¿‡ç±»ä¼¼çš„å‘äº†ã€‚ä¸ºäº†æ‘†è„±å®ƒä»¬åœ¨ API ä¸Šçš„é™åˆ¶æ¥è¾¾åˆ°ä½ æœŸæœ›çš„ç”¨æˆ·ä½“éªŒï¼Œä½ å¾—ä½¿ç”¨å„ç§å¥‡æŠ€æ·«å·§ï¼Œæœ‰äº›ä½“éªŒç”šè‡³æ˜¯å®Œå…¨æ— æ³•å®ç°çš„ã€‚\n\n\n\n\n\n\n\n\n\nå¦‚æœä½ é‡åˆ°äº†ç›¸ä¼¼çš„é—®é¢˜ï¼Œé‚£ä¹ˆä¹Ÿè®¸ä½ ä¼šå–œæ¬¢ä¸Š Slateã€‚è®©æˆ‘æ¥ä»‹ç»ä¸€ä¸‹ Slate æ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„å§â€¦\næä¾›äº†ä»€ä¹ˆèƒ½åŠ›\n\n\n\n\n\n\n\n\nSlate å°è¯•é€šè¿‡ä¸€äº›åŸåˆ™æ¥è§£å†³ â€œWhy?â€ è¿™ä¸€èŠ‚ä¸­\bçš„é—®é¢˜ï¼š\n\n\n\n\n\n\n\n\n\nä½œä¸ºä¸€ç­‰å…¬æ°‘çš„æ’ä»¶ã€‚ åœ¨ Slate ä¸­æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæ’ä»¶æ˜¯ä¸€ç­‰å…¬æ°‘ï¼ˆfirst-classï¼‰çš„å®ä½“â€”â€”ç”šè‡³è¿ç¼–è¾‘å™¨çš„æ ¸å¿ƒé€»è¾‘éƒ½æ˜¯é€šè¿‡æ’ä»¶å®ç°çš„ã€‚è¿™æ„å‘³ç€ä½ èƒ½å¤Ÿ å®Œå…¨åœ° å®šåˆ¶ç¼–è¾‘ä½“éªŒï¼Œæ„å»ºå‡ºå¯¹æ ‡ Medium å’Œ Canvas é‚£æ ·çš„å¤æ‚ç¼–è¾‘å™¨ï¼Œè€Œæ— éœ€å¯¹æŠ—å„ç§ç±»åº“çš„é¢„è®¾æ¡ä»¶ã€‚\n\n\n\n\n\n\n\n\n\nç²¾ç®€ Schema çš„æ ¸å¿ƒã€‚ Slate çš„æ ¸å¿ƒé€»è¾‘å¹¶ä¸å¯¹ä½ æ‰€ç¼–è¾‘çš„æ•°æ®ç»“æ„åšä»»ä½•å‡è®¾ï¼Œè¿™æ„å‘³ç€ä½ åœ¨éœ€è¦åº”å¯¹å¤æ‚åœºæ™¯æ—¶ä¸ä¼šè¢«ç¼–è¾‘å™¨é¢„ç½®çš„å†…å®¹æ‰€æŸç¼šï¼ˆè¯‘è€…æ³¨ï¼šæ­¤å¤„ Schema å¯ç†è§£ä¸ºç±»ä¼¼ XML Schema çš„æ–‡æ¡£ç»“æ„è§„èŒƒï¼‰ã€‚\n\n\n\n\n\n\n\n\n\næ”¯æŒåµŒå¥—çš„æ–‡æ¡£æ¨¡å‹ã€‚ Slate æ‰€ä½¿ç”¨çš„æ–‡æ¡£æ¨¡å‹æ˜¯ä¸€æ£µåµŒå¥—çš„ã€é€’å½’çš„æ ‘ï¼Œå’Œ DOM æœ¬èº«ååˆ†æ¥è¿‘ã€‚è¿™ä½¿å¾—æ„å»ºè¡¨æ ¼å’ŒåµŒå¥—å¼•ç”¨ç­‰èƒ½å¤Ÿæ»¡è¶³è¿›é˜¶éœ€æ±‚çš„å¤æ‚ç»„ä»¶æˆä¸ºäº†å¯èƒ½ã€‚å½“ç„¶ï¼Œä½ åŒæ ·å¯ä»¥ä½¿ç”¨å•ä¸€çš„å±‚çº§å…³ç³»ä»¥ä¿è¯ç®€å•æ€§ã€‚\n\n\n\n\n\n\n\n\n\næ— çŠ¶æ€ã€ä¸å¯å˜çš„æ•°æ®ã€‚ é€šè¿‡ä½¿ç”¨ React å’Œ Immutable.jsï¼Œæˆ‘ä»¬æ˜¯åŸºäºä¸å¯å˜æ•°æ®ç»“æ„ï¼Œä»¥æ— çŠ¶æ€çš„æ–¹å¼æ„å»º Slate ç¼–è¾‘å™¨çš„ã€‚è¿™å¤§å¤§é™ä½äº†ç†è§£ä»£ç çš„éš¾åº¦ï¼Œä¹ŸèŠ‚çº¦äº†å¤§é‡å¼€å‘æ’ä»¶çš„æ—¶é—´ã€‚\n\n\n\n\n\n\n\n\n\nç›´è§‚çš„ changesã€‚ Slate ä¸­çš„å†…å®¹æ˜¯é€šè¿‡ â€œchangeâ€ æ¥ç¼–è¾‘çš„ï¼Œè¿™æ˜¯ä¸€ç§è¢«è®¾è®¡ä¸ºæ”¯æŒé«˜é˜¶ä½¿ç”¨ï¼Œä¸”æå…¶ç¬¦åˆç›´è§‰çš„æ¦‚å¿µã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿé€šè¿‡å®ƒæ¥å°½å¯èƒ½ç®€å•åœ°ç¼–å†™æ’ä»¶å’Œè‡ªå®šä¹‰åŠŸèƒ½äº†ã€‚\n\n\n\n\n\n\n\n\n\n**ä¸ºååŒç¼–è¾‘å‡†å¤‡çš„æ•°æ®æ¨¡å‹**ã€‚ Slate ä½¿ç”¨çš„æ•°æ®æ¨¡å‹â€”â€”å°¤å…¶æ˜¯ç”± change æ›´æ”¹æ–‡æ¡£çš„æ–¹å¼â€”â€”åœ¨è®¾è®¡æ—¶å°±å·²è€ƒè™‘åˆ°å¯¹ååŒç¼–è¾‘çš„æ”¯æŒã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ å†³å®šä¸ºç¼–è¾‘å™¨æ·»åŠ åä½œåŠŸèƒ½ï¼Œä½ ä¸éœ€è¦è¿›è¡Œå½»åº•çš„é‡æ„ã€‚ï¼ˆå½“ç„¶ï¼Œè¿™è¿˜éœ€è¦ä½ æŠ•å…¥æ›´å¤šçš„åŠªåŠ›ï¼ï¼‰\n\n\n\n\n\n\n\n\n\næ˜ç¡®çš„ã€æ ¸å¿ƒã€‘è¾¹ç•Œåˆ’åˆ†ã€‚ é€šè¿‡æ’ä»¶ä¼˜å…ˆçš„æ¶æ„ä¸ç²¾ç®€ Schema çš„å†…æ ¸ï¼ŒSlate å¯¹äºã€æ ¸å¿ƒã€‘å’Œã€è‡ªå®šä¹‰ã€‘æœ‰ç€æ˜ç¡®å¾—å¤šçš„åˆ’åˆ†ï¼Œä»è€Œä¿è¯æ ¸å¿ƒçš„ç¼–è¾‘ä½“éªŒä¸ä¼šä¸ºå„ç§è¾¹ç¼˜æƒ…å†µæ‰€å›°æ‰°ã€‚\nååŒç¼–è¾‘ï¼Œè¿™ä¸ªåé¢ä¼šæŒç»­å…³æ³¨slate-yjsyjs\nslate æ–‡æ¡£ä¸æ˜¯å¾ˆå¤šï¼ŒåŠå°æ—¶çœ‹å®Œä¸»è¦å†…å®¹ \n\næ’ä»¶å®šåˆ¶åŒ–\næ¸²æŸ“èŠ‚ç‚¹å®šåˆ¶åŒ–\næŒ‰é”®ç›‘å¬å¤„ç†\næ•°æ®æ ¼å¼ç¼–ç ã€åç¼–ç \næ•°æ®å­˜å‚¨\n\nå°±è¿™ç‚¹ä¸œè¥¿ğŸ˜±ç«Ÿç„¶æœ‰äº›åŒå­¦å‡­å€Ÿslateçš„ä½¿ç”¨æ‹¿äº†3.75,èµ¶ç´§å­¦ï½\n","slug":"2022-04-29slate-lean","date":"2022-05-16T13:00:00.000Z","categories_index":"wiki","tags_index":"wiki","author_index":"é™ˆæµ·é¾™"},{"id":"deffdaaa2a24a19ee257667b3b36743c","title":"è®¾è®¡æ¨¡å¼","content":"å…ˆèŠç”¨åˆ°è¿‡å“ªäº›ï¼ŒèƒŒåçš„è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆ\nå®ä¾‹åŒ–ä¸€ä¸ª axios å®ä¾‹ï¼Œå…¨å±€éƒ½æ¥ä½¿ç”¨å®ƒ å•ä¾‹æ¨¡å¼\nå…„å¼Ÿç»„ä»¶é€šä¿¡,äº‹ä»¶ç›‘å¬ è§‚å¯Ÿè€…æ¨¡å¼\næ„é€ å‡½æ•°ç»§æ‰¿ã€ç±»çš„ç»§æ‰¿ æ„é€ å‡½æ•°æ¨¡å¼\nå®ä¾‹åŒ–ä¸åŒçš„å®ä¾‹ å·¥å‚æ¨¡å¼\nä¼˜åŒ–ä¸­çš„äº‹ä»¶ä»£ç†ä»£ç†æ¨¡å¼\nesmã€commonjsæ¨¡å—æ¨¡å¼\n\nç†Ÿæ‚‰è€Œåˆé™Œç”Ÿï¼šç†Ÿæ‚‰çš„æ˜¯ä¸€ç›´åœ¨ç”¨ï¼Œé™Œç”Ÿçš„æ˜¯å­¦åç«Ÿç„¶æ˜¯è¿™äº›ã€‚æˆ‘éƒ½æœ‰ç‚¹æ€€ç–‘äº†ï¼Œè¿™æ˜¯çœŸçš„å—ï¼Ÿæ˜¯çœŸçš„å—ï¼Ÿï½ï½ï½\n\n   æ¥ï½æ¥ï½æ¥ï½ï¼Œæˆ‘ä»¬ç»§ç»­ã€‚ã€‚ã€‚\n\nå•¥å‘€\n\n\n\n\n\n\n\n\nâ€œè®¾è®¡æ¨¡å¼(è‹±è¯­ design pattern)æ˜¯å¯¹é¢å‘å¯¹è±¡è®¾è®¡ä¸­åå¤å‡ºç°çš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ä¸ªæœ¯è¯­æ˜¯åœ¨1990å¹´ä»£ç”±Erich Gammaç­‰äººä»å»ºç­‘è®¾è®¡é¢†åŸŸå¼•å…¥åˆ°è®¡ç®—æœºç§‘å­¦ä¸­æ¥çš„ã€‚â€\nç­–ç•¥æ¨¡å¼ä»£ç†æ¨¡å¼\nä½œç”¨ï¼šè®¿é—®æ§åˆ¶\nåœºæ™¯ï¼šäº‹ä»¶ä»£ç†ã€Proxyã€Object.defineProperty\n\nå•ä¾‹æ¨¡å¼\nå®šä¹‰ï¼šå”¯ä¸€å®ä¾‹ï¼Œå…¨å±€å¯è®¿é—®\nåœºæ™¯ï¼šè¯·æ±‚å®ä¾‹ã€å…¨å±€ç¼“å­˜ã€çº¿ç¨‹æ± ã€window å¯¹è±¡ã€ç™»å½•æµ®æ¡†\nå®ç°ï¼šå·²ç»åˆ›å»ºè¿‡çš„ç›´æ¥è¿”å›ï¼Œä¸é‡å¤åˆ›å»º\n\nå·¥å‚æ¨¡å¼\nä½œç”¨ï¼šåˆ›å»ºåŒä¸€ç±»å¯¹è±¡\nåˆ†ç±»ï¼šç®€å•å·¥å‚_ã€_æ–¹æ³•å·¥å‚\n\n1. ç®€å•å·¥å‚\nä¾‹å¦‚ï¼šé¡¹ç›®ä¸­æ ¹æ®ç”¨æˆ·æƒé™æ¸²æŸ“ä¸åŒçš„é¡µé¢ï¼Œåœ¨ä¸åŒæƒé™ç­‰çº§ç”¨æˆ·çš„æ„é€ å‡½æ•°ä¸­ï¼Œä¿å­˜ç”¨æˆ·å¯ä»¥çœ‹åˆ°çš„é¡µé¢\nä¼˜ç‚¹ï¼šä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œæ— éœ€çŸ¥é“å…¶åˆ›å»ºçš„å…·ä½“ç»†èŠ‚\nç¼ºç‚¹ï¼šå‡½æ•°ä¼šæˆä¸ºä¸€ä¸ªè¶…çº§å‡½æ•°ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œç®€å•å·¥å‚é€‚ç”¨äºåˆ›å»ºå°‘é‡å¯¹è±¡ï¼Œå¯¹è±¡çš„é€»è¾‘ä¸èƒ½å¤æ‚\n\n2. å·¥å‚æ–¹æ³•\næœ¬è´¨ï¼šå°†åˆ›å»ºå¯¹è±¡çš„å·¥ä½œï¼Œæ¨è¿Ÿåˆ°å­ç±»ä¸­ï¼Œè¿™æ ·æ ¸å¿ƒç±»å°±å˜æˆæŠ½è±¡ç±»\n\nlet UserFactory &#x3D; function (type) &#123;\n  if (this instanceof UserFactory) &#123;\n    return new this[type]();\n  &#125; else &#123;\n    return new UserFactory(type);\n  &#125;\n&#125;;\n\n&#x2F;&#x2F; å·¥å‚æ–¹æ³•ï¼Œå‡½æ•°çš„åŸå‹ä¸­è®¾ç½®æ‰€æœ‰å¯¹è±¡çš„æ„é€ å‡½æ•°\n\nUserFactory.prototype &#x3D; &#123;\n  SuperAdmin: function () &#123;\n    this.name &#x3D; &quot;è¶…çº§ç®¡ç†å‘˜&quot;;\n    this.viewPage &#x3D; [&quot;é¦–é¡µ&quot;, &quot;è®¢å•ç®¡ç†&quot;, &quot;ç”¨æˆ·ç®¡ç†&quot;, &quot;åº”ç”¨ç®¡ç†&quot;, &quot;æƒé™ç®¡ç†&quot;];\n  &#125;,\n  Admin: function () &#123;\n    this.name &#x3D; &quot;ç®¡ç†å‘˜&quot;;\n    this.viewPage &#x3D; [&quot;é¦–é¡µ&quot;, &quot;è®¢å•ç®¡ç†&quot;, &quot;ç”¨æˆ·ç®¡ç†&quot;];\n  &#125;,\n  NormalUser: function () &#123;\n    this.name &#x3D; &quot;æ™®é€šç”¨æˆ·&quot;;\n    this.viewPage &#x3D; [&quot;é¦–é¡µ&quot;, &quot;è®¢å•ç®¡ç†&quot;];\n  &#125;,\n&#125;;\n\n&#x2F;&#x2F; è°ƒç”¨\nlet superAdmin &#x3D; new UserFactory(&quot;SuperAdmin&quot;);\nlet admin &#x3D; new UserFactory(&quot;Admin&quot;);\nlet normalUser &#x3D; new UserFactory(&quot;NormalUser&quot;);\n\n3. æŠ½è±¡å·¥å‚\n\n\næ„é€ å‡½æ•°æ¨¡å¼ğŸ‘€ è§‚å¯Ÿè€…æ¨¡å¼\nå®šä¹‰ï¼š å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»\nä½œç”¨ï¼šä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä¾èµ–ä»–çš„å¯¹è±¡ï¼Œéƒ½å°†å¾—åˆ°é€šçŸ¥\nä¼˜ç‚¹ï¼šè§£è€¦\nç»„æˆï¼šå‘å¸ƒè€…ã€è®¢é˜…è€…\nåœºæ™¯ï¼šäº‹ä»¶ç›‘å¬ã€eventBus\n\ndocument.body.addEventListener(&quot;click&quot;, function () &#123;&#125;, false);\n\næ··åˆæ¨¡å¼æ¨¡å—æ¨¡å¼\nä½œç”¨ï¼šé¿å…å…¨å±€æ±¡æŸ“ï¼ŒæŒ‰éœ€æš´éœ²\nå®ç°ï¼šå¤šé‡‡ç”¨é—­åŒ…\n\nvar Person &#x3D; (function () &#123;\n  var name &#x3D; &quot;xxx&quot;;\n  function sayName(params) &#123;\n    console.log(name);\n  &#125;\n  return &#123;\n    name,\n    sayName,\n  &#125;;\n&#125;)();\n","slug":"2022-05-13design_mode","date":"2022-05-13T09:01:15.000Z","categories_index":"å‰ç«¯","tags_index":"å‰ç«¯,è®¾è®¡æ¨¡å¼","author_index":"é™ˆæµ·é¾™"},{"id":"e2b55be84d65cc914ce2f0d3a3e083d3","title":"ant design formè®¾ç½®å€¼ !== è·å–å€¼","content":"æœ‰æ„æ€çš„äº‹\nä»Šå¤©ç»´æŠ¤é¡¹ç›®é‡åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„äº‹ï¼Œç›´è§‚æ„Ÿå—ï¼Œè®¾ç½®å€¼ï¼Œå†å–å‡ºæ¥ï¼Œè²Œä¼¼æ²¡æ¯›ç—…  &#x2F;&#x2F; ...\n  const [values, setValues] &#x3D; useState&lt;Record&lt;string, any&gt;&gt;()\n\n  const &#123; applyStartTime, applyEndTime, attendanceType, staffId &#125; &#x3D; values || &#123;&#125;\n\n  const getDetail &#x3D; usePersistFn(async () &#x3D;&gt; &#123;\n    &#x2F;&#x2F; ...ç•¥\n    const obj: Record&lt;string, any&gt; &#x3D; &#123;\n      staffId: applyStaff.staffId,\n      attendanceType: res.result.attendanceType,\n      applyStartTime: &#123;\n        value: moment(res.result.applyStartTime),\n        half: res.result.startDayType,\n      &#125;,\n      applyEndTime: &#123;\n        value: moment(res.result.applyEndTime),\n        half: res.result.endDayType,\n      &#125;,\n      applyReason,\n      applyAttachments,\n    &#125;\n    &#x2F;&#x2F; ...ç•¥\n    form.setFieldsValue(obj)\n    setValues(form.getFieldsValue())\n  &#125;)\n\n  &#x2F;&#x2F; ...ç•¥\n  const &#123; total, loading: totalLoading &#125; &#x3D; useCaculateDays(\n    &#123;\n      start: applyStartTime,\n      end: applyEndTime,\n    &#125;,\n    staffId,\n    attendanceType,\n  )\n  &#x2F;&#x2F; ...ç•¥\n\n  &#x2F;&#x2F; AnualFormç»„ä»¶\n  &lt;Form.Item name&#x3D;&quot;applyStartTime&quot; label&#x3D;&quot;èµ·å§‹æ—¥æœŸ&quot; rules&#x3D;&#123;[&#123; required: true &#125;]&#125;&gt;\n      &lt;HalftDatePicker predict&#x3D;&#123;&#123; lessThan: end?.value &#125;&#125; &#x2F;&gt;\n    &lt;&#x2F;Form.Item&gt;\n  &lt;Form.Item name&#x3D;&quot;applyEndTime&quot; label&#x3D;&quot;ç»“æŸæ—¥æœŸ&quot; rules&#x3D;&#123;[&#123; required: true &#125;]&#125;&gt;\n    &lt;HalftDatePicker predict&#x3D;&#123;&#123; moreThan: start?.value &#125;&#125; &#x2F;&gt;\n  &lt;&#x2F;Form.Item&gt;\n\n\n  type IValue &#x3D; &#123;\n    value?: moment.Moment\n    half: 1 | 2\n  &#125;\n &#x2F;&#x2F; HalftDatePickerç»„ä»¶\nconst HalftDatePicker: React.ForwardRefRenderFunction&lt;any, PickerProps&lt;moment.Moment&gt; &amp; &#123;\n  value?: IValue\n  onChange?: (v?: IValue) &#x3D;&gt; void\n  predict?: &#123;\n    lessThan?: moment.Moment\n    moreThan?: moment.Moment\n    holiday?: boolean\n  &#125;\n&#125;&gt; &#x3D; (props, ref) &#x3D;&gt; &#123;\n  &#x2F;&#x2F; ...ç•¥\n&#125;\n\nä»£ç çš„ç›®çš„æ˜¯ï¼š \n\nè¯·æ±‚è¯¦æƒ…\nè£…é…æ•°æ®ï¼Œæ›´æ–°values\nuseCaculateDays é€šè¿‡åå°åŠ¨æ€è®¡ç®—æœ‰æ•ˆå·¥ä½œæ—¥ï¼Œè¿”å›totalè¯·å‡å¤©æ•°ï¼Œ\næ¸²æŸ“totalåˆ°è¡¨å•å¯¹åº”ä½ç½®\n\nè°ƒè¯•ç»è¿‡ä¸€ç‚¹ä¸€ç‚¹å›æº¯è°ƒè¯•ï¼Œå‘ç° useCaculateDays æ²¡è¯·æ±‚ï¼Œè¢«åˆ¤æ–­æ‹¦æˆªæ‰äº†ï¼Œå¾€ä¸Šæ‰¾æ‰¾ï¼Œ\nform.setFieldsValue(obj)\nsetValues(form.getFieldsValue())\n\næ‰“ä¸Šæ—¥å¿—&#x2F;&#x2F; ...ç•¥\nconsole.log(&quot;obj&quot;,obj);\nform.setFieldsValue(obj)\nconsole.log(&quot;obj1&quot;,form.getFieldsValue());\nsetValues(obj)\n\nå‘ç°objé”®å€¼å†…å®¹ä¸ç­‰äºobj1\n\nobj\n\n&#123;\n    &quot;staffId&quot;: &quot;02333&quot;,\n    &quot;attendanceType&quot;: 11,\n    &quot;applyStartTime&quot;: &#123;\n        &quot;value&quot;: &quot;2022-03-23T16:00:00.000Z&quot;,\n        &quot;half&quot;: 1\n    &#125;,\n    &quot;applyEndTime&quot;: &#123;\n        &quot;value&quot;: &quot;2022-03-23T16:00:00.000Z&quot;,\n        &quot;half&quot;: 2\n    &#125;,\n    &quot;applyReason&quot;: &quot;&quot;,\n    &quot;applyAttachments&quot;: []\n&#125;\n\n\nobj1&#123;\n    &quot;staffId&quot;: &quot;02333&quot;,\n    &quot;attendanceType&quot;: 11,\n    &quot;applyReason&quot;: &quot;&quot;,\n    &quot;applyAttachments&quot;: []\n&#125;\n\nçŒœæƒ³\n\nä¼šä¸ä¼šform.setFieldsValueå¼‚æ­¥ï¼ŸæŸ¥äº†ä¸‹apiæ˜¯åŒæ­¥çš„æ’é™¤è¿™ç§å¯èƒ½\næ–­ç‚¹è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šé‡åˆ°è¡¨å•æ¸²æŸ“ä¸€åŠçš„æƒ…å†µï¼ŒAnualFormç»„ä»¶æ˜¯æ¡ä»¶æ¸²æŸ“ï¼Œå¦‚æœè¿™å—è¡¨å•æ²¡æœ‰æ¸²æŸ“å‡ºæ¥ï¼Œé€šè¿‡form.getFieldsValueå°±æ‹¿ä¸åˆ°\n\nä¿®æ”¹ä»£ç éªŒè¯ä¸‹çŒœæƒ³console.log(&quot;obj&quot;,obj);\nform.setFieldsValue(obj)\nconsole.log(&quot;obj1&quot;,form.getFieldsValue());\nsetTimeout(() &#x3D;&gt; &#123;\n  setValues(form.getFieldsValue())\n  &#125;, 5000);\n&#125;\n\n\næœ€ç»ˆä¿®æ”¹form.setFieldsValue(obj)\nsetValues(obj)","slug":"2022-05-13react","date":"2022-05-13T07:39:33.000Z","categories_index":"React","tags_index":"React,bug","author_index":"é™ˆæµ·é¾™"},{"id":"f31094f49d8642b9a610a9630bcdbff8","title":"ModHeader","content":"é€šè¿‡ä¸åŒè¯·æ±‚å¤´å­—æ®µæ ‡è¯†è¯·æ±‚ä¸åŒçš„ç¯å¢ƒ\n\nRequesr HeadersAccept: *&#x2F;*\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8,zh-TW;q&#x3D;0.7\nCache-Control: no-cache\nConnection: keep-alive\ncontent-type: application&#x2F;json; charset&#x3D;utf-8\nCookie: perfLang&#x3D;zh; \nenvtag: ladon-1        \nHost: localhost:3119\nPragma: no-cache\nReferer: http:&#x2F;&#x2F;localhost:3119&#x2F;\nsec-ch-ua: &quot; Not A;Brand&quot;;v&#x3D;&quot;99&quot;, &quot;Chromium&quot;;v&#x3D;&quot;101&quot;, &quot;Google Chrome&quot;;v&#x3D;&quot;101&quot;\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: &quot;macOS&quot;\nä¸ç”Ÿæ•ˆäº†ç†è®ºä¸Šæ˜¯æ²¡é—®é¢˜ï¼Œåº”è¯¥æ˜¯ç”±äºæŸäº›åŸå› å¯¼è‡´è¿™ä¸ªæ’ä»¶å†…éƒ¨è¿è¡Œå‡ºäº†é—®é¢˜ï¼Œå…·ä½“ä»€ä¹ˆé—®é¢˜ä¸çŸ¥å¤„ç†ï¼šå°†æµè§ˆå™¨é‡å¯åŠ¨å,è¯·æ±‚å¤´envtag: ladon-1å¢åŠ æˆåŠŸ\n","slug":"2022-05-13modeheader","date":"2022-05-13T06:59:19.000Z","categories_index":"Chrome","tags_index":"å·¥å…·,Chrome","author_index":"é™ˆæµ·é¾™"},{"id":"b4153b96463af3b17371df43a1c660ca","title":"æµè§ˆå™¨é¦–å±ä¼˜åŒ–-é¦–å±æ—¶é—´è·å–","content":"ä¼˜åŒ–çš„æŒ‡æ ‡ç™½å±æ—¶é—´ &#x3D; åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨å‡ºç°ç¬¬ä¸€ä¸ªå…ƒç´ é¦–å±æ—¶é—´ &#x3D; åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨ç¬¬ä¸€å±æ¸²æŸ“å®Œæˆ\nå½±å“ç™½å±æ—¶é—´çš„å› ç´ ï¼šç½‘ç»œï¼ŒæœåŠ¡ç«¯æ€§èƒ½ï¼Œå‰ç«¯é¡µé¢ç»“æ„è®¾è®¡ã€‚å½±å“é¦–å±æ—¶é—´çš„å› ç´ ï¼šç™½å±æ—¶é—´ï¼Œèµ„æºä¸‹è½½æ‰§è¡Œæ—¶é—´ã€‚\né€šå¸¸åœ¨ head è§£æå®Œï¼Œbody å¼€å§‹æ¸²æŸ“æ­¤æ—¶æ˜¯ç™½å±ç»“æŸç™½å±æ—¶é—´ &#x3D; firstPaint - performance.timing.navigationStart || pageStartTime\nå¸¸ç”¨æ–¹æ³•\né¦–å±æ¨¡å—æ ‡ç­¾æ ‡è®°ï¼Œ ä½ è§‰å¾—é¦–å±å®Œæˆçš„åœ°æ–¹æ’å…¥è„šæœ¬\nåŒçº§é¦–å±å†…åŠ è½½æœ€æ…¢çš„å›¾ç‰‡&#x2F;iframe\n\nè¿™ä¸ªå›¾çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¾€ä¸‹çœ‹ï¼Œåé¢ä¼šä»¥ç®€ä¹¦ä»£ç å’Œæ˜é‡‘æ¥éªŒè¯è¿™å¹…å›¾çš„æ­£ç¡®æ€§\n\nè¾“å…¥ url å‘ç”Ÿäº†ä»€ä¹ˆ\n1ã€å½“æµè§ˆå™¨åœ°å€ä¸­è¾“å…¥ url åï¼ŒnavigationStartå¦‚æœä¹‹å‰æœ‰å‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢ä¸ä¸€å®šåŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³,å¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰,\n2ã€æ¥ç€ï¼Œæ˜¯å¦æœ‰é‡å®šå‘ï¼ˆredirect ï¼‰\n3ã€æ¥ç€ï¼Œå‡†å¤‡ç”¨ HTTP æŠ“å–æ–‡æ¡£çš„å†…å®¹ï¼ˆfetchStartï¼‰\nåŸŸåæŸ¥è¯¢ï¼ˆdomainLookupStartã€domainLookupEndï¼‰\nTCP è¿æ¥ï¼ˆconnectStartã€connectEndï¼‰,å¦‚æœæ˜¯å®‰å…¨é“¾æ¥ï¼Œåœ¨ connectEnd ä¹‹å‰ï¼Œä¼šæœ‰ SSL è¿æ¥(secureConnectionStart)\n\n\n4ã€æ¥ç€ï¼ŒHTTP è¯·æ±‚ï¼ˆrequestStartã€responseStartã€responseEndï¼‰,å¦‚æœæœ‰ç¼“å­˜ï¼Œåœ¨ responseStart ä¹‹å‰ï¼Œä¼šæœ‰ cacheStartï¼Œå¦‚æœä¹‹å‰æœ‰ç½‘é¡µï¼Œè¿˜æ¶‰åŠåˆ°ç½‘é¡µçš„ unloadï¼Œåœ¨ cacheStart ä¹‹å‰ï¼Œä¼šæœ‰unloadStartã€unloadEnd\n5ã€æ¥ç€ï¼Œdom è§£æ\ndomLoadingDocument.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\ndomInteractiveDocument.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\ndomContentLoadedEventStartã€domContentLoadedEventEnd DOM è§£æå®Œæˆåï¼Œ\nç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹ï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\nç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\n\n\nloadEventStartload äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œ\nloadEventEndload äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´\ndomCompleteDocument.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\nè¯´æ˜ï¼šdom è§£æè¿‡ç¨‹ï¼ŒHTML ç”Ÿæˆ dom æ ‘ï¼Œè§£æ CSS æ–‡ä»¶ç”Ÿæˆ CSSOM æ ‘ï¼ŒDOM æ ‘å’Œ CSSOM æ ‘ç”Ÿæˆ render æ ‘ï¼Œä¹Ÿå°±æ˜¯æ¸²æŸ“æ ‘ï¼Œ render æ ‘ä¸­å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå¸ƒå±€ï¼Œè®¡ç®—æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œç¡®å®šå…¶åœ¨å±å¹•ä¸­çš„ä½ç½®ï¼Œç»˜åˆ¶ã€‚æ ¹æ® render æ ‘å’Œå¸ƒå±€å°†æ˜¾ç¤ºé¡µé¢\n\n\n\nåŠ è½½é˜¶æ®µå·¦è¾¹çº¢çº¿ä»£è¡¨çš„æ˜¯ç½‘ç»œä¼ è¾“å±‚é¢çš„è¿‡ç¨‹ï¼Œå³è¾¹çº¢çº¿ä»£è¡¨äº†æœåŠ¡å™¨ä¼ è¾“å›å­—èŠ‚åæµè§ˆå™¨çš„å„ç§äº‹ä»¶çŠ¶æ€ï¼Œè¿™ä¸ªé˜¶æ®µåŒ…å«äº†æµè§ˆå™¨å¯¹æ–‡æ¡£çš„è§£æï¼ŒDOM æ ‘æ„å»ºï¼Œå¸ƒå±€ï¼Œç»˜åˆ¶ç­‰ç­‰ã€‚1. prompt for unload\n\nnavigationStart: è¡¨ç¤ºä»ä¸Šä¸€ä¸ªæ–‡æ¡£å¸è½½ç»“æŸæ—¶çš„ unix æ—¶é—´æˆ³ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸€ä¸ªæ–‡æ¡£ï¼Œè¿™ä¸ªå€¼å°†å’Œ fetchStart ç›¸ç­‰ã€‚2. å‰ä¸€ä¸ªç½‘é¡µå¸è½½\nunloadEventStart: è¡¨ç¤ºå‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢åŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload æˆ–è€…å‰ä¸€ä¸ªç½‘é¡µä¸å½“å‰é¡µé¢ä¸åŒåŸŸï¼Œåˆ™å€¼ä¸º 0ã€‚\nunloadEventEnd: è¿”å›å‰ä¸€ä¸ªé¡µé¢ unload æ—¶é—´ç»‘å®šçš„å›æ‰å‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´æˆ³ã€‚3. é‡å®šå‘\nredirectStart: ç¬¬ä¸€ä¸ª HTTP é‡å®šå‘å‘ç”Ÿæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0ã€‚\nredirectEnd: æœ€åä¸€ä¸ª HTTP é‡å®šå‘å®Œæˆæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…éƒ¨çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0ã€‚4. ä½¿ç”¨ HTTP è¯·æ±‚\nfetchStart: æµè§ˆå™¨å‡†å¤‡å¥½ä½¿ç”¨ HTTP è¯·æ±‚æŠ“å–æ–‡æ¡£çš„æ—¶é—´ï¼Œè¿™å‘ç”Ÿåœ¨æ£€æŸ¥æœ¬åœ°ç¼“å­˜ä¹‹å‰ã€‚5. åŸŸåè§£æ\ndomainLookupStart&#x2F;domainLookupEnd: DNS åŸŸåæŸ¥è¯¢å¼€å§‹&#x2F;ç»“æŸçš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰6. tcp é“¾æ¥\nconnectStart: HTTPï¼ˆTCPï¼‰å¼€å§‹&#x2F;é‡æ–° å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰ã€‚\nconnectEnd: HTTPï¼ˆTCPï¼‰ å®Œæˆå»ºç«‹è¿æ¥çš„æ—¶é—´ï¼ˆå®Œæˆæ¡æ‰‹ï¼‰ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰ã€‚7. ssl å»ºç«‹\nsecureConnectionStart: HTTPS è¿æ¥å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œåˆ™å€¼ä¸º 0ã€‚8. è¯»å–æ–‡æ¡£\nrequestStart: HTTP è¯·æ±‚è¯»å–çœŸå®æ–‡æ¡£å¼€å§‹çš„æ—¶é—´ï¼ˆå®Œæˆå»ºç«‹è¿æ¥ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚9. å“åº”\nresponseStart: HTTP å¼€å§‹æ¥æ”¶å“åº”çš„æ—¶é—´ï¼ˆè·å–åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚\nresponseEnd: HTTP å“åº”å…¨éƒ¨æ¥æ”¶å®Œæˆçš„æ—¶é—´ï¼ˆè·å–åˆ°æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚10. è§£æ dom\ndomLoading: å¼€å§‹è§£ææ¸²æŸ“ DOM æ ‘çš„æ—¶é—´ï¼Œæ­¤æ—¶ Document.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ã€‚11. dom å¯äº¤äº’\ndomInteractive: å®Œæˆè§£æ DOM æ ‘çš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ï¼Œæ³¨æ„åªæ˜¯ DOM æ ‘è§£æå®Œæˆï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰å¼€å§‹åŠ è½½ç½‘é¡µå†…çš„èµ„æºã€‚12. é¡µé¢å†…èµ„æºåŠ è½½\ndomContentLoadedEventStart: DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹çš„æ—¶é—´ï¼Œåœ¨ DOMContentLoaded äº‹ä»¶æŠ›å‡ºå‰å‘ç”Ÿã€‚\ndomContentLoadedEventEnd: DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆçš„æ—¶é—´ï¼ˆå¦‚ JS è„šæœ¬åŠ è½½æ‰§è¡Œå®Œæ¯•ï¼‰ã€‚13. dom æ ‘è§£æå®Œæˆ\ndomComplete: DOM æ ‘è§£æå®Œæˆï¼Œä¸”èµ„æºä¹Ÿå‡†å¤‡å°±ç»ªçš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ã€‚14. load äº‹ä»¶\nloadEventStart: load äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ã€‚\nloadEventEnd: load äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´ã€‚\n\nPerformance æ¥å£Performance æ¥å£å¯ä»¥è·å–åˆ°å½“å‰é¡µé¢ä¸æ€§èƒ½ç›¸å…³çš„ä¿¡æ¯ã€‚\n\n\n\n\n\n\nTIP\næ•°æ®å…ˆä¸è¦å…³æ³¨æ—¶é—´å¾ªåºï¼Œåé¢æˆ‘ä»¬ä¼šä»å¤šä¸ªè§’åº¦æ¥éªŒè¯é¡ºåº\n\n&#123;\n  &quot;timeOrigin&quot;: 1652338539312.5,\n  &#x2F;&#x2F; é¡ºåºå·²ç»æ’å¥½äº†\n  &quot;timing&quot;: &#123;\n    &#x2F;&#x2F; åœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­ï¼Œå‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢ä¸ä¸€å®šåŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰\n    &quot;navigationStart&quot;: 1652338539312,\n    &#x2F;&#x2F; ç¬¬ä¸€ä¸ª HTTP é‡å®šå‘å‘ç”Ÿæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0\n    &quot;redirectStart&quot;: 0,\n    &#x2F;&#x2F; æœ€åä¸€ä¸ª HTTP é‡å®šå‘å®Œæˆæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…éƒ¨çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0\n    &quot;redirectEnd&quot;: 0,\n    &#x2F;&#x2F; æµè§ˆå™¨å‡†å¤‡å¥½ä½¿ç”¨ HTTP è¯·æ±‚æŠ“å–æ–‡æ¡£çš„æ—¶é—´ï¼Œè¿™å‘ç”Ÿåœ¨æ£€æŸ¥æœ¬åœ°ç¼“å­˜ä¹‹å‰\n    &quot;fetchStart&quot;: 1652338539316,\n    &#x2F;&#x2F; DNS åŸŸåæŸ¥è¯¢å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰\n    &quot;domainLookupStart&quot;: 1652338539353,\n    &#x2F;&#x2F; DNS åŸŸåæŸ¥è¯¢å®Œæˆçš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰\n    &quot;domainLookupEnd&quot;: 1652338539353,\n    &#x2F;&#x2F; HTTPï¼ˆTCPï¼‰ å¼€å§‹å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰\n    &#x2F;&#x2F; æ³¨æ„å¦‚æœåœ¨ä¼ è¾“å±‚å‘ç”Ÿäº†é”™è¯¯ä¸”é‡æ–°å»ºç«‹è¿æ¥ï¼Œåˆ™è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯æ–°å»ºç«‹çš„è¿æ¥å¼€å§‹çš„æ—¶é—´\n    &quot;connectStart&quot;: 1652338539353,\n    &#x2F;&#x2F; HTTPS è¿æ¥å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œåˆ™å€¼ä¸º 0\n    &quot;secureConnectionStart&quot;: 1652338539401,\n    &#x2F;&#x2F; HTTPï¼ˆTCPï¼‰ å®Œæˆå»ºç«‹è¿æ¥çš„æ—¶é—´ï¼ˆå®Œæˆæ¡æ‰‹ï¼‰ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰\n    &#x2F;&#x2F; æ³¨æ„å¦‚æœåœ¨ä¼ è¾“å±‚å‘ç”Ÿäº†é”™è¯¯ä¸”é‡æ–°å»ºç«‹è¿æ¥ï¼Œåˆ™è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯æ–°å»ºç«‹çš„è¿æ¥å®Œæˆçš„æ—¶é—´\n    &#x2F;&#x2F; æ³¨æ„è¿™é‡Œæ¡æ‰‹ç»“æŸï¼ŒåŒ…æ‹¬å®‰å…¨è¿æ¥å»ºç«‹å®Œæˆã€SOCKS æˆæƒé€šè¿‡\n    &quot;connectEnd&quot;: 1652338539504,\n    &#x2F;&#x2F; HTTP è¯·æ±‚è¯»å–çœŸå®æ–‡æ¡£å¼€å§‹çš„æ—¶é—´ï¼ˆå®Œæˆå»ºç«‹è¿æ¥ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜\n    &#x2F;&#x2F; è¿æ¥é”™è¯¯é‡è¿æ—¶ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„ä¹Ÿæ˜¯æ–°å»ºç«‹è¿æ¥çš„æ—¶é—´\n    &quot;requestStart&quot;: 1652338539505,\n    &#x2F;&#x2F; HTTP å¼€å§‹æ¥æ”¶å“åº”çš„æ—¶é—´ï¼ˆè·å–åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜\n    &quot;responseStart&quot;: 1652338539807,\n    &#x2F;&#x2F; å‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢åŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload æˆ–è€…å‰ä¸€ä¸ªç½‘é¡µä¸å½“å‰é¡µé¢ä¸åŒåŸŸï¼Œåˆ™å€¼ä¸º 0\n    &quot;unloadEventStart&quot;: 0,\n    &#x2F;&#x2F; å’Œ unloadEventStart ç›¸å¯¹åº”ï¼Œè¿”å›å‰ä¸€ä¸ªç½‘é¡µ unload äº‹ä»¶ç»‘å®šçš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´æˆ³\n    &quot;unloadEventEnd&quot;: 0,\n    &#x2F;&#x2F; HTTP å“åº”å…¨éƒ¨æ¥æ”¶å®Œæˆçš„æ—¶é—´ï¼ˆè·å–åˆ°æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜\n    &quot;responseEnd&quot;: 1652338539828,\n    &#x2F;&#x2F; å¼€å§‹è§£ææ¸²æŸ“ DOM æ ‘çš„æ—¶é—´ï¼Œæ­¤æ—¶ Document.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\n    &quot;domLoading&quot;: 1652338539823,\n    &#x2F;&#x2F; å®Œæˆè§£æ DOM æ ‘çš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\n    &#x2F;&#x2F; æ³¨æ„åªæ˜¯ DOM æ ‘è§£æå®Œæˆï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰å¼€å§‹åŠ è½½ç½‘é¡µå†…çš„èµ„æº\n    &quot;domInteractive&quot;: 1652338540574,\n    &#x2F;&#x2F; DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹çš„æ—¶é—´\n    &#x2F;&#x2F; åœ¨ DOMContentLoaded äº‹ä»¶æŠ›å‡ºå‰å‘ç”Ÿ\n    &quot;domContentLoadedEventStart&quot;: 1652338540574,\n    &#x2F;&#x2F; DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆçš„æ—¶é—´ï¼ˆå¦‚ JS è„šæœ¬åŠ è½½æ‰§è¡Œå®Œæ¯•ï¼‰\n    &quot;domContentLoadedEventEnd&quot;: 1652338540575,\n    &#x2F;&#x2F; load äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶é—´\n    &#x2F;&#x2F; æ³¨æ„å¦‚æœæ²¡æœ‰ç»‘å®š load äº‹ä»¶ï¼Œå€¼ä¸º 0\n    &quot;loadEventStart&quot;: 1652338542489,\n    &#x2F;&#x2F; load äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´\n    &quot;loadEventEnd&quot;: 1652338542492,\n    &#x2F;&#x2F; DOM æ ‘è§£æå®Œæˆï¼Œä¸”èµ„æºä¹Ÿå‡†å¤‡å°±ç»ªçš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶\n    &quot;domComplete&quot;: 1652338542489\n  &#125;,\n  &quot;navigation&quot;: &#123;\n    &#x2F;&#x2F; 0   å³ TYPE_NAVIGATENEXT æ­£å¸¸è¿›å…¥çš„é¡µé¢ï¼ˆéåˆ·æ–°ã€éé‡å®šå‘ç­‰ï¼‰\n    &#x2F;&#x2F; 1   å³ TYPE_RELOAD       é€šè¿‡ window.location.reload() åˆ·æ–°çš„é¡µé¢\n    &#x2F;&#x2F; 2   å³ TYPE_BACK_FORWARD é€šè¿‡æµè§ˆå™¨çš„å‰è¿›åé€€æŒ‰é’®è¿›å…¥çš„é¡µé¢ï¼ˆå†å²è®°å½•ï¼‰\n    &#x2F;&#x2F; 255 å³ TYPE_UNDEFINED    éä»¥ä¸Šæ–¹å¼è¿›å…¥çš„é¡µé¢\n    &quot;type&quot;: 0,\n    &quot;redirectCount&quot;: 0 &#x2F;&#x2F; &#x2F;&#x2F; å¦‚æœæœ‰é‡å®šå‘çš„è¯ï¼Œé¡µé¢é€šè¿‡å‡ æ¬¡é‡å®šå‘è·³è½¬è€Œæ¥\n  &#125;\n&#125;\n\nfunction getPerfermanceTiming() &#123;\n  let t &#x3D; performance.timing;\n\n  &#x2F;&#x2F; é‡å®šå‘ç»“æŸæ—¶é—´ - é‡å®šå‘å¼€å§‹æ—¶é—´\n  let redirect &#x3D; t.redirectEnd - t.redirectStart;\n  &#x2F;&#x2F; DNS æŸ¥è¯¢å¼€å§‹æ—¶é—´ - fetech start æ—¶é—´\n  let appCache &#x3D; t.domainLookupStart - t.fetchStart;\n  &#x2F;&#x2F; DNS æŸ¥è¯¢ç»“æŸæ—¶é—´ - DNS æŸ¥è¯¢å¼€å§‹æ—¶é—´\n  let dns &#x3D; t.domainLookupEnd - t.domainLookupStart;\n  &#x2F;&#x2F; å®Œæˆ TCP è¿æ¥æ¡æ‰‹æ—¶é—´ - TCP è¿æ¥å¼€å§‹æ—¶é—´\n  let tcp &#x3D; t.connectEnd - t.connectStart;\n  &#x2F;&#x2F; ä»è¯·æ±‚å¼€å§‹åˆ°æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªå“åº”å­—ç¬¦çš„æ—¶é—´\n  let ttfb &#x3D; t.responseStart - t.requestStart;\n  &#x2F;&#x2F; èµ„æºä¸‹è½½æ—¶é—´ï¼Œå“åº”ç»“æŸæ—¶é—´ - å“åº”å¼€å§‹æ—¶é—´\n  let contentDL &#x3D; t.responseEnd - t.responseStart;\n  &#x2F;&#x2F; ä»è¯·æ±‚å¼€å§‹åˆ°å“åº”ç»“æŸçš„æ—¶é—´\n  let httpTotal &#x3D; t.responseEnd - t.requestStart;\n  &#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° domContentLoadedEventEnd\n  let domContentloaded &#x3D; t.domContentLoadedEventEnd - t.navigationStart;\n  &#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° loadEventEnd\n  let loaded &#x3D; t.loadEventEnd - t.navigationStart;\n\n  let result &#x3D; [\n    &#123; key: &quot;Redirect&quot;, desc: &quot;ç½‘é¡µé‡å®šå‘çš„è€—æ—¶&quot;, value: redirect &#125;,\n    &#123; key: &quot;AppCache&quot;, desc: &quot;æ£€æŸ¥æœ¬åœ°ç¼“å­˜çš„è€—æ—¶&quot;, value: appCache &#125;,\n    &#123; key: &quot;DNS&quot;, desc: &quot;DNSæŸ¥è¯¢çš„è€—æ—¶&quot;, value: dns &#125;,\n    &#123; key: &quot;TCP&quot;, desc: &quot;TCPè¿æ¥çš„è€—æ—¶&quot;, value: tcp &#125;,\n    &#123;\n      key: &quot;Waiting(TTFB)&quot;,\n      desc: &quot;ä»å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚åˆ°æ¥æ”¶åˆ°å“åº”çš„æ—¶é—´ &#x2F; Time To First Byte&quot;,\n      value: ttfb,\n    &#125;,\n    &#123;\n      key: &quot;Content Download&quot;,\n      desc: &quot;ä¸‹è½½æœåŠ¡ç«¯è¿”å›æ•°æ®çš„æ—¶é—´&quot;,\n      value: contentDL,\n    &#125;,\n    &#123; key: &quot;HTTP Total Time&quot;, desc: &quot;httpè¯·æ±‚æ€»è€—æ—¶&quot;, value: httpTotal &#125;,\n    &#123;\n      key: &quot;DOMContentLoaded&quot;,\n      desc: &quot;domåŠ è½½å®Œæˆçš„æ—¶é—´&quot;,\n      value: domContentloaded,\n    &#125;,\n    &#123; key: &quot;Loaded&quot;, desc: &quot;é¡µé¢loadçš„æ€»è€—æ—¶&quot;, value: loaded &#125;,\n  ];\n  return result;\n&#125;\ngetPerfermanceTiming();\n\n\n\nèŠä¸‹æ€§èƒ½è®¡ç®—&#x2F;&#x2F; è®¡ç®—åŠ è½½æ—¶é—´\nfunction getPerformanceTiming() &#123;\n  var performance &#x3D; window.performance;\n\n  if (!performance) &#123;\n    &#x2F;&#x2F; å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ\n    console.log(&quot;ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ performance æ¥å£&quot;);\n    return;\n  &#125;\n\n  var t &#x3D; performance.timing;\n  var times &#x3D; &#123;&#125;;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘é¡µé¢åŠ è½½å®Œæˆçš„æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘è¿™å‡ ä¹ä»£è¡¨äº†ç”¨æˆ·ç­‰å¾…é¡µé¢å¯ç”¨çš„æ—¶é—´\n  times.loadPage &#x3D; t.loadEventEnd - t.navigationStart;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘è§£æ DOM æ ‘ç»“æ„çš„æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘åçœä¸‹ä½ çš„ DOM æ ‘åµŒå¥—æ˜¯ä¸æ˜¯å¤ªå¤šäº†ï¼\n  times.domReady &#x3D; t.domComplete - t.responseEnd;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘é‡å®šå‘çš„æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘æ‹’ç»é‡å®šå‘ï¼æ¯”å¦‚ï¼Œhttp:&#x2F;&#x2F;example.com&#x2F; å°±ä¸è¯¥å†™æˆ http:&#x2F;&#x2F;example.com\n  times.redirect &#x3D; t.redirectEnd - t.redirectStart;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘DNS æŸ¥è¯¢æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘DNS é¢„åŠ è½½åšäº†ä¹ˆï¼Ÿé¡µé¢å†…æ˜¯ä¸æ˜¯ä½¿ç”¨äº†å¤ªå¤šä¸åŒçš„åŸŸåå¯¼è‡´åŸŸåæŸ¥è¯¢çš„æ—¶é—´å¤ªé•¿ï¼Ÿ\n  &#x2F;&#x2F; å¯ä½¿ç”¨ HTML5 Prefetch é¢„æŸ¥è¯¢ DNS ï¼Œè§ï¼š[HTML5 prefetch](http:&#x2F;&#x2F;segmentfault.com&#x2F;a&#x2F;1190000000633364)\n  times.lookupDomain &#x3D; t.domainLookupEnd - t.domainLookupStart;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘è¯»å–é¡µé¢ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘è¿™å¯ä»¥ç†è§£ä¸ºç”¨æˆ·æ‹¿åˆ°ä½ çš„èµ„æºå ç”¨çš„æ—¶é—´ï¼ŒåŠ å¼‚åœ°æœºæˆ¿äº†ä¹ˆï¼ŒåŠ CDN å¤„ç†äº†ä¹ˆï¼ŸåŠ å¸¦å®½äº†ä¹ˆï¼ŸåŠ  CPU è¿ç®—é€Ÿåº¦äº†ä¹ˆï¼Ÿ\n  &#x2F;&#x2F; TTFB å³ Time To First Byte çš„æ„æ€\n  &#x2F;&#x2F; ç»´åŸºç™¾ç§‘ï¼šhttps:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Time_To_First_Byte\n  times.ttfb &#x3D; t.responseStart - t.navigationStart;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘å†…å®¹åŠ è½½å®Œæˆçš„æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘é¡µé¢å†…å®¹ç»è¿‡ gzip å‹ç¼©äº†ä¹ˆï¼Œé™æ€èµ„æº css&#x2F;js ç­‰å‹ç¼©äº†ä¹ˆï¼Ÿ\n  times.request &#x3D; t.responseEnd - t.requestStart;\n\n  &#x2F;&#x2F;ã€é‡è¦ã€‘æ‰§è¡Œ onload å›è°ƒå‡½æ•°çš„æ—¶é—´\n  &#x2F;&#x2F;ã€åŸå› ã€‘æ˜¯å¦å¤ªå¤šä¸å¿…è¦çš„æ“ä½œéƒ½æ”¾åˆ° onload å›è°ƒå‡½æ•°é‡Œæ‰§è¡Œäº†ï¼Œè€ƒè™‘è¿‡å»¶è¿ŸåŠ è½½ã€æŒ‰éœ€åŠ è½½çš„ç­–ç•¥ä¹ˆï¼Ÿ\n  times.loadEvent &#x3D; t.loadEventEnd - t.loadEventStart;\n\n  &#x2F;&#x2F; DNS ç¼“å­˜æ—¶é—´\n  times.appcache &#x3D; t.domainLookupStart - t.fetchStart;\n\n  &#x2F;&#x2F; å¸è½½é¡µé¢çš„æ—¶é—´\n  times.unloadEvent &#x3D; t.unloadEventEnd - t.unloadEventStart;\n\n  &#x2F;&#x2F; TCP å»ºç«‹è¿æ¥å®Œæˆæ¡æ‰‹çš„æ—¶é—´\n  times.connect &#x3D; t.connectEnd - t.connectStart;\n\n  return times;\n&#125;\n\nèŠä¸‹æ€§èƒ½ä¼˜åŒ–å‡è®¾ä½ å¯¹ performance API å¾ˆç†Ÿæ‚‰\n\nå‡å°‘é‡å®šå‘æ¬¡æ•°\nDNS æŸ¥è¯¢æ—¶é—´ï¼šHTML5 Prefetch é¢„æŸ¥è¯¢\nTCP è¿æ¥: http1.1 å¼€å¯ connect: keep-alive, http2.0ï¼Œ å¦‚æœå¯ä»¥çš„è¯ http3.0 å¯ä»¥çœ‹æœ¬ç«™å¦ä¸€ç¯‡æ–‡ç« \nèµ„æºå‹ç¼©ï¼šgzipã€brotliã€å›¾ç‰‡å‹ç¼©ã€tree-shakingã€console ç§»é™¤\nèµ„æºæ•´åˆï¼šå‡å°‘è¯·æ±‚æ¬¡æ•°ã€å‡å°‘ç½‘ç»œè¯·æ±‚ï¼Œé›ªç¢§å›¾ï¼ˆè™½ç„¶ http2 æä¾›äº†å¤šè·¯å¤ç”¨[å¤šè·¯å¤ç”¨ä»£æ›¿äº† HTTP1.x çš„åºåˆ—å’Œé˜»å¡æœºåˆ¶ï¼Œæ‰€æœ‰çš„ç›¸åŒåŸŸåè¯·æ±‚éƒ½é€šè¿‡åŒä¸€ä¸ª TCP è¿æ¥å¹¶å‘å®Œæˆã€‚åœ¨ HTTP1.x ä¸­ï¼Œå¹¶å‘å¤šä¸ªè¯·æ±‚éœ€è¦å¤šä¸ª TCP è¿æ¥ï¼Œæµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºä¼šæœ‰ 6-8 ä¸ª TCP è¿æ¥éƒ½é™åˆ¶,å•ä¸ªè¿æ¥ä¸Šå¯ä»¥å¹¶è¡Œäº¤é”™çš„è¯·æ±‚å’Œå“åº”ï¼Œä¹‹é—´äº’ä¸å¹²æ‰°,ä½†æ˜¯æ•°é‡çŒ›å¢ï¼ŒæœåŠ¡å™¨è¦å¤„ç†ï¼Œå¤šå¤šå°‘å°‘ä¹Ÿè€—æ€§èƒ½]çš„èƒ½åŠ›ï¼Œè€Œä¸”ç°åœ¨è¿˜æœ‰ä½¿ç”¨çš„å¸¸è§ï¼Œæ¯”èŠå¤©è¡¨æƒ…ï¼Œé£ä¹¦ä¹Ÿåœ¨ç”¨ï¼‰\nèµ„æºåŠ è½½ï¼šCDNã€å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€æŒ‰éœ€åŠ è½½\nDOM è§£æï¼šè‡ªä¸Šè€Œä¸‹ï¼Œscript æ ‡ç­¾æ”¾åœ¨åº•éƒ¨ï¼Œcss æ”¾åœ¨ä¸Šé¢ï¼Œæ— è®ºæ˜¯ html è¿˜æ˜¯ css çš„å±‚çº§ï¼Œåº”å°½é‡å°‘çš„è§£æï¼Œè§£ææ¶ˆè€—æ€§èƒ½\næ¸²æŸ“æ—¶å€™ï¼šå›æµå’Œé‡ç»˜ã€æ‡’åŠ è½½ã€è™šæ‹Ÿåˆ—è¡¨\n\nä¸¤ä¸ªäº‹ä¾‹é£ä¹¦é›ªç¢§å›¾\n\nä¸ºä»€ä¹ˆæ‹¿é£ä¹¦æ¡Œç«¯æ•°æ®æ¥è¯´ï¼ˆä¹‹å‰å¼€å‘æ¡Œé¢ç«¯Electronï¼Œæ‰’æ‹‰è¿‡é£ä¹¦åº”ç”¨åŒ…çš„æ•°æ®)\n\n\n\näº¬ä¸œç§»åŠ¨ç«¯ dns-prefetch\n\nä¸ºä»€ä¹ˆæ‹¿äº¬ä¸œæ•°æ®æ¥è¯´ï¼ˆä¹‹å‰çˆ¬å–è¿‡äº¬ä¸œç§»åŠ¨ç«¯æ•°æ®å¼€å‘ RN)\n\n\n&lt;head&gt;\n  &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;\n  &lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;\n    window.alert &#x3D; console.log;\n  &lt;&#x2F;script&gt;\n  &lt;script&gt;\n    window._PFM_TIMING &#x3D; [[1351, new Date()]]; &#x2F;&#x2F;TODO\n  &lt;&#x2F;script&gt;\n  &lt;meta\n    name&#x3D;&quot;viewport&quot;\n    content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;0&quot;\n  &#x2F;&gt;\n  &lt;title&gt;å¤šå¿«å¥½çœï¼Œè´­ç‰©ä¸Šäº¬ä¸œï¼&lt;&#x2F;title&gt;\n  &lt;!-- å¼ºç¼“å­˜Cache-Control --&gt;\n  &lt;meta http-equiv&#x3D;&quot;Cache-Control&quot; content&#x3D;&quot;max-age&#x3D;180&quot; &#x2F;&gt;\n  &lt;meta name&#x3D;&quot;apple-mobile-web-app-capable&quot; content&#x3D;&quot;yes&quot; &#x2F;&gt;\n  &lt;meta name&#x3D;&quot;apple-mobile-web-app-status-bar-style&quot; content&#x3D;&quot;black&quot; &#x2F;&gt;\n  &lt;meta name&#x3D;&quot;format-detection&quot; content&#x3D;&quot;telephone&#x3D;no&quot; &#x2F;&gt;\n  &lt;!-- äº¬ä¸œ &lt;meta name&#x3D;&quot;format-detection&quot; content&#x3D;&quot;telephone&#x3D;no&quot; &#x2F;&gt; å†™é‡å¤äº† --&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;m.360buyimg.com&quot; &#x2F;&gt;\n  &lt;meta name&#x3D;&quot;format-detection&quot; content&#x3D;&quot;telephone&#x3D;no&quot; &#x2F;&gt;\n  &lt;meta\n    name&#x3D;&quot;viewport&quot;\n    content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;0, shrink-to-fit&#x3D;no, viewport-fit&#x3D;cover&quot;\n  &#x2F;&gt;\n  &lt;!-- X-DNS-Prefetch-Control å¤´æ§åˆ¶ç€æµè§ˆå™¨çš„ DNS é¢„è¯»å–åŠŸèƒ½  DNS é¢„è¯»å–æ˜¯ä¸€é¡¹ä½¿æµè§ˆå™¨ä¸»åŠ¨å»æ‰§è¡ŒåŸŸåè§£æçš„åŠŸèƒ½--&gt;\n  &lt;meta http-equiv&#x3D;&quot;x-dns-prefetch-control&quot; content&#x3D;&quot;on&quot; &#x2F;&gt;\n\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img11.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img10.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img12.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img13.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img14.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img20.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img30.360buyimg.com&quot; &#x2F;&gt;\n  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;wq.360buyimg.com&quot; &#x2F;&gt;\n&lt;&#x2F;head&gt;\n\nperformance æ•°æ®èƒ½å¹²å•¥ç”¨ï¼Ÿï¼ˆå¼€å‘è€…ï¼‰ç†Ÿæ‚‰ Chrome å¼€å‘è€…å·¥å…·çš„æœ‹å‹åº”è¯¥çŸ¥é“ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œå…¶å®æˆ‘ä»¬è‡ªå·±æ‰“å¼€ Chrome çš„å¼€å‘è€…å·¥å…·ï¼Œåˆ‡æ¢åˆ°ç½‘ç»œé¢æ¿ï¼Œå°±èƒ½å¾ˆè¯¦ç»†çš„çœ‹åˆ°ç½‘é¡µæ€§èƒ½ç›¸å…³çš„æ•°æ®ã€‚\nï¼ˆç½‘ç«™ç”¨æˆ·ï¼‰ä½†å½“æˆ‘ä»¬éœ€è¦ç»Ÿè®¡åˆ†æç”¨æˆ·æ‰“å¼€æˆ‘ä»¬ç½‘é¡µæ—¶çš„æ€§èƒ½å¦‚ä½•æ—¶ï¼Œæˆ‘ä»¬å°† performance åŸå§‹ä¿¡æ¯æˆ–é€šè¿‡ç®€å•è®¡ç®—åçš„ä¿¡æ¯ (å¦‚ä¸Šé¢å†™åˆ°çš„ getPerformanceTiming()) ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œé…åˆå…¶ä»–ä¿¡æ¯ï¼ˆå¦‚ HTTP è¯·æ±‚å¤´ä¿¡æ¯ï¼‰ï¼Œå°±å®Œç¾å•¦~\næ¥çœ‹ä¸‹ç®€ä¹¦\né“¾æ¥ ç®€ä¹¦ ,æ‰“å¼€æ§åˆ¶å°å¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æœä¸€ä¸ªæ•°ç»„ï¼ˆå¦‚æœç®€ä¹¦æ²¡å°†æ­¤æ—¥å¿—å»é™¤ï¼‰\nç®€ä¹¦ä»£ç \n\nwindow.addEventListener(&quot;load&quot;, function () &#123;\n  setTimeout(function () &#123;\n    var e &#x3D; window.performance;\n    if (e) &#123;\n      var t &#x3D; e.getEntriesByType(&quot;navigation&quot;)[0],\n        r &#x3D; 0;\n      t || (r &#x3D; (t &#x3D; e.timing).navigationStart);\n      var n &#x3D; [\n        &#123;\n          key: &quot;Redirect&quot;,\n          desc: &quot;\\u7f51\\u9875\\u91cd\\u5b9a\\u5411\\u7684\\u8017\\u65f6&quot;,\n          value: t.redirectEnd - t.redirectStart,\n        &#125;,\n        &#123;\n          key: &quot;AppCache&quot;,\n          desc: &quot;\\u68c0\\u67e5\\u672c\\u5730\\u7f13\\u5b58\\u7684\\u8017\\u65f6&quot;,\n          value: t.domainLookupStart - t.fetchStart,\n        &#125;,\n        &#123;\n          key: &quot;DNS&quot;,\n          desc: &quot;DNS\\u67e5\\u8be2\\u7684\\u8017\\u65f6&quot;,\n          value: t.domainLookupEnd - t.domainLookupStart,\n        &#125;,\n        &#123;\n          key: &quot;TCP&quot;,\n          desc: &quot;TCP\\u8fde\\u63a5\\u7684\\u8017\\u65f6&quot;,\n          value: t.connectEnd - t.connectStart,\n        &#125;,\n        &#123;\n          key: &quot;Waiting(TTFB)&quot;,\n          desc: &quot;\\u4ece\\u5ba2\\u6237\\u7aef\\u53d1\\u8d77\\u8bf7\\u6c42\\u5230\\u63a5\\u6536\\u5230\\u54cd\\u5e94\\u7684\\u65f6\\u95f4 &#x2F; Time To First Byte&quot;,\n          value: t.responseStart - t.requestStart,\n        &#125;,\n        &#123;\n          key: &quot;Content Download&quot;,\n          desc: &quot;\\u4e0b\\u8f7d\\u670d\\u52a1\\u7aef\\u8fd4\\u56de\\u6570\\u636e\\u7684\\u65f6\\u95f4&quot;,\n          value: t.responseEnd - t.responseStart,\n        &#125;,\n        &#123;\n          key: &quot;HTTP Total Time&quot;,\n          desc: &quot;http\\u8bf7\\u6c42\\u603b\\u8017\\u65f6&quot;,\n          value: t.responseEnd - t.requestStart,\n        &#125;,\n        &#123;\n          key: &quot;DOMContentLoaded&quot;,\n          desc: &quot;dom\\u52a0\\u8f7d\\u5b8c\\u6210\\u7684\\u65f6\\u95f4&quot;,\n          value: t.domContentLoadedEventEnd - r,\n        &#125;,\n        &#123;\n          key: &quot;Loaded&quot;,\n          desc: &quot;\\u9875\\u9762load\\u7684\\u603b\\u8017\\u65f6&quot;,\n          value: t.loadEventEnd - r,\n        &#125;,\n      ];\n      if (Math.random() &gt; 0.75) &#123;\n        var s &#x3D; window.location,\n          i &#x3D; s.href,\n          c &#x3D; s.pathname,\n          u &#x3D; navigator.userAgent,\n          d &#x3D; i.split(&quot;?&quot;)[0];\n        o.a\n          .post(&quot;https:&#x2F;&#x2F;tr.jianshu.com&#x2F;fe&#x2F;1&#x2F;mon&#x2F;atf&quot;, &#123;\n            app: &quot;shakespeare-performance&quot;,\n            url: d,\n            ua: u,\n            path: c,\n            stats_ttfb: t.responseStart - t.requestStart,\n            stats_domLoaded: t.domContentLoadedEventEnd - r,\n            stats_loaded: t.loadEventEnd - r,\n          &#125;)\n          .then(a.a)\n          .catch(a.a);\n      &#125;\n      console &amp;&amp; console.log &amp;&amp; console.log(n);\n    &#125;\n  &#125;, 0);\n&#125;);\n\nç®€ä¹¦æˆªå›¾\ndomContentLoaded ä¸ loaded&#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° domContentLoadedEventEnd\nlet domContentloaded &#x3D; t.domContentLoadedEventEnd - t.navigationStart;\n&#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° loadEventEnd\nlet loaded &#x3D; t.loadEventEnd - t.navigationStart;\n\ndomContentLoadedEventEnd æ¯” loaded å…ˆè§¦å‘\n\n\n\næ˜é‡‘é¡µé¢\nè¯è¯´å·²ç»åˆ°äº† 6 æœˆ 6 å·ï¼Œé—²é€›æ˜é‡‘ï¼Œé‡åˆ°é¢è¯•é¢˜ï¼šä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆï¼Œçªç„¶æƒ³èµ·ä¸ª performance,å°±æ‹¿æ˜é‡‘çš„ä¸€ä¸ªé¡µé¢æ¥éªŒè¯è¿™å¹…å›¾\n\n\n\n\n\n\n\n\n\n\nWARNING\næ³¨æ„ï¼šæ­¤ä»£ç æ”¾åˆ° dayjs ç½‘ç«™çš„ Sources&#x2F;Snippets ä¸­æ‰§è¡Œï¼Œåˆ©ç”¨å…¨å±€çš„ dayjsï¼Œæ— éœ€å¼•å…¥ dayjs\n\ndayjs ç½‘ç«™\n\n\nä»£ç æ˜¯ä¸ºäº†å¯¹performance.timingæŒ‰ç…§æ—¶é—´å€¼è¿›è¡Œæ’åºï¼Œæ’åºç»“æœå¤§è‡´æ˜¯æ‰§è¡Œçš„é¡ºåºï¼Œç¨å¾®æœ‰å‡ºå…¥ï¼Œä¼šæ‰‹åŠ¨åšè°ƒæ•´\nä»£ç å¦‚ä¸‹ï¼š\n\nvar timing &#x3D; &#123;\n  connectStart: 1654499041800,\n  navigationStart: 1654499041744,\n  loadEventEnd: 1654499043641,\n  domLoading: 1654499042279,\n  secureConnectionStart: 1654499041820,\n  fetchStart: 1654499041746,\n  domContentLoadedEventStart: 1654499042718,\n  responseStart: 1654499042247,\n  responseEnd: 1654499042304,\n  domInteractive: 1654499042495,\n  domainLookupEnd: 1654499041800,\n  redirectStart: 0,\n  requestStart: 1654499041849,\n  unloadEventEnd: 1654499042267,\n  unloadEventStart: 1654499042267,\n  domComplete: 1654499043640,\n  domainLookupStart: 1654499041750,\n  loadEventStart: 1654499043641,\n  domContentLoadedEventEnd: 1654499042718,\n  redirectEnd: 0,\n  connectEnd: 1654499041849,\n&#125;;\n&#x2F;&#x2F; YYYY-MM-DD HH:ä¸€å®šä¸€è‡´ï¼Œè¿™ä¸ªå°±ä¸çœ‹äº†\nvar fmt &#x3D; &quot;mm:ss:SSS&quot;;\nvar arr &#x3D; [];\nvar sort_obj &#x3D; &#123;&#125;;\n\nfunction fmt_sort_key(obj) &#123;\n  for (let [key, value] of Object.entries(obj)) &#123;\n    arr.push(&#123;\n      key,\n      value,\n    &#125;);\n  &#125;\n\n  const sortArr &#x3D; arr.sort((a, b) &#x3D;&gt; a.value - b.value);\n\n  const fmtSortArr &#x3D; sortArr.map((item) &#x3D;&gt; &#123;\n    if (!item.value) return item;\n    return &#123;\n      ...item,\n      value: dayjs(item.value).format(fmt),\n    &#125;;\n  &#125;);\n\n  console.log(fmtSortArr);\n&#125;\nfmt_sort_key(timing);\n\néæ— ç—•é¦–æ¬¡è®¿é—®const timing &#x3D; &#123;\n  connectStart: 1654391072118,\n  navigationStart: 1654391071928,\n  loadEventEnd: 1654391076402,\n  domLoading: 1654391072670,\n  secureConnectionStart: 1654391072118,\n  fetchStart: 1654391071969,\n  domContentLoadedEventStart: 1654391074189,\n  responseStart: 1654391072621,\n  responseEnd: 1654391072664,\n  domInteractive: 1654391073865,\n  domainLookupEnd: 1654391072118,\n  redirectStart: 0,\n  requestStart: 1654391072199,\n  &#x2F;&#x2F; æ²¡æœ‰ä¹‹å‰é¡µé¢çš„å¸è½½\n  unloadEventEnd: 0,\n  unloadEventStart: 0,\n\n  domComplete: 1654391076400,\n  domainLookupStart: 1654391072118,\n  loadEventStart: 1654391076400,\n  domContentLoadedEventEnd: 1654391074189,\n  redirectEnd: 0,\n  connectEnd: 1654391072199,\n&#125;;\n\n&#x2F;&#x2F; æ—¶é—´æˆ³ 1654391072118ï¼š connectStartã€secureConnectionStartã€domainLookupStartã€domainLookupEnd ï¼Œè¿™ä¸ªå€¼æ˜¯ç›¸åŒçš„\n\n&#x2F;&#x2F; æŠŠä¸Šè¿° timing ä½¿ç”¨dayjsè¿›è¡Œè½¬åŒ–ï¼Œçœ‹ä¸‹æ¯ä¸ªkeyå¯¹åº”çš„time,å¯¹äº0æ˜¯æ²¡æœ‰è¿›è¡Œçš„æ“ä½œï¼Œæˆ‘ä»¬è·³è¿‡ä¸å¤„ç†ï¼ˆçŸ¥é“æ²¡è¿›è¡Œï¼‰\n\nvar timingfmt &#x3D; [\n  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº\n  &#123; key: &quot;navigationStart&quot;, value: &quot;04:31:928&quot; &#125;,\n\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;fetchStart&quot;, value: &quot;04:31:969&quot; &#125;,\n  &#123; key: &quot;connectStart&quot;, value: &quot;04:32:118&quot; &#125;,\n  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;04:32:118&quot; &#125;,\n  &#123; key: &quot;domainLookupStart&quot;, value: &quot;04:32:118&quot; &#125;,\n  &#123; key: &quot;secureConnectionStart&quot;, value: &quot;04:32:118&quot; &#125;,\n  &#123; key: &quot;requestStart&quot;, value: &quot;04:32:199&quot; &#125;,\n  &#123; key: &quot;connectEnd&quot;, value: &quot;04:32:199&quot; &#125;,\n\n  &#123; key: &quot;responseStart&quot;, value: &quot;04:32:621&quot; &#125;,\n  &#123; key: &quot;unloadEventStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;unloadEventEnd&quot;, value: 0 &#125;,\n  &#123; key: &quot;responseEnd&quot;, value: &quot;04:32:664&quot; &#125;,\n\n  &#123; key: &quot;domLoading&quot;, value: &quot;04:32:670&quot; &#125;,\n  &#123; key: &quot;domInteractive&quot;, value: &quot;04:33:865&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;04:34:189&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;04:34:189&quot; &#125;,\n  &#123; key: &quot;domComplete&quot;, value: &quot;04:36:400&quot; &#125;,\n  &#123; key: &quot;loadEventStart&quot;, value: &quot;04:36:400&quot; &#125;,\n  &#123; key: &quot;loadEventEnd&quot;, value: &quot;04:36:402&quot; &#125;,\n];\n\næˆ‘ä»¬çœ‹ä¸‹ç»“æœ 2022-06-05 09:04ï¼Œå¹´æœˆæ—¥æ—¶åˆ†éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸‰ä½çš„æ¯«ç§’æ•°\néæ— ç—•ç¬¬äºŒæ¬¡è®¿é—®const timing2 &#x3D; &#123;\n  connectStart: 1654494048918,\n  navigationStart: 1654494048902,\n  loadEventEnd: 1654494054146,\n  domLoading: 1654494049851,\n  secureConnectionStart: 0, &#x2F;&#x2F; èµ°ç¼“å­˜\n  fetchStart: 1654494048918,\n  domContentLoadedEventStart: 1654494051380,\n  responseStart: 1654494049430,\n  responseEnd: 1654494049514,\n  domInteractive: 1654494051115,\n  domainLookupEnd: 1654494048918,\n  redirectStart: 0,\n  requestStart: 1654494048942,\n  &#x2F;&#x2F; æœ‰ä¹‹å‰é¡µé¢å¸è½½\n  unloadEventEnd: 1654494049537,\n  unloadEventStart: 1654494049536,\n\n  domComplete: 1654494054143,\n  domainLookupStart: 1654494048918,\n  loadEventStart: 1654494054143,\n  domContentLoadedEventEnd: 1654494051381,\n  redirectEnd: 0,\n  connectEnd: 1654494048918,\n&#125;;\n\nvar timingfmt2 &#x3D; [\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº\n  &#123; key: &quot;navigationStart&quot;, value: &quot;40:48:902&quot; &#125;,\n\n  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;fetchStart&quot;, value: &quot;40:48:918&quot; &#125;,\n\n  &#123; key: &quot;connectStart&quot;, value: &quot;40:48:918&quot; &#125;,\n  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;40:48:918&quot; &#125;,\n  &#123; key: &quot;domainLookupStart&quot;, value: &quot;40:48:918&quot; &#125;,\n  &#123; key: &quot;secureConnectionStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;connectEnd&quot;, value: &quot;40:48:918&quot; &#125;,\n  &#123; key: &quot;requestStart&quot;, value: &quot;40:48:942&quot; &#125;,\n  &#123; key: &quot;responseStart&quot;, value: &quot;40:49:430&quot; &#125;,\n  &#123; key: &quot;responseEnd&quot;, value: &quot;40:49:514&quot; &#125;,\n  &#123; key: &quot;unloadEventStart&quot;, value: &quot;40:49:536&quot; &#125;,\n  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;40:49:537&quot; &#125;,\n  &#123; key: &quot;domLoading&quot;, value: &quot;40:49:851&quot; &#125;,\n\n  &#123; key: &quot;domInteractive&quot;, value: &quot;40:51:115&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;40:51:380&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;40:51:381&quot; &#125;,\n  &#123; key: &quot;domComplete&quot;, value: &quot;40:54:143&quot; &#125;,\n  &#123; key: &quot;loadEventStart&quot;, value: &quot;40:54:143&quot; &#125;,\n  &#123; key: &quot;loadEventEnd&quot;, value: &quot;40:54:146&quot; &#125;,\n];\n\néæ— ç—• f5 æ‰‹åŠ¨åˆ·æ–°var timing3 &#x3D; &#123;\n  connectStart: 1654495600379,\n  navigationStart: 1654495600360,\n  loadEventEnd: 1654495604101,\n  domLoading: 1654495601005,\n  secureConnectionStart: 1654495600389,\n  fetchStart: 1654495600364,\n  domContentLoadedEventStart: 1654495601947,\n  responseStart: 1654495600935,\n  responseEnd: 1654495600989,\n  domInteractive: 1654495601794,\n  domainLookupEnd: 1654495600379,\n  redirectStart: 0,\n  requestStart: 1654495600404,\n  unloadEventEnd: 1654495600971,\n  unloadEventStart: 1654495600970,\n  domComplete: 1654495604099,\n  domainLookupStart: 1654495600379,\n  loadEventStart: 1654495604099,\n  domContentLoadedEventEnd: 1654495601947,\n  redirectEnd: 0,\n  connectEnd: 1654495600403,\n&#125;;\n\nvar timingfmt3 &#x3D; [\n  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº\n  &#123; key: &quot;navigationStart&quot;, value: &quot;06:40:360&quot; &#125;,\n\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;fetchStart&quot;, value: &quot;06:40:364&quot; &#125;,\n\n  &#123; key: &quot;connectStart&quot;, value: &quot;06:40:379&quot; &#125;,\n  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;06:40:379&quot; &#125;,\n  &#123; key: &quot;domainLookupStart&quot;, value: &quot;06:40:379&quot; &#125;,\n\n  &#123; key: &quot;secureConnectionStart&quot;, value: &quot;06:40:389&quot; &#125;,\n\n  &#123; key: &quot;connectEnd&quot;, value: &quot;06:40:403&quot; &#125;,\n  &#123; key: &quot;requestStart&quot;, value: &quot;06:40:404&quot; &#125;,\n\n  &#123; key: &quot;responseStart&quot;, value: &quot;06:40:935&quot; &#125;,\n  &#123; key: &quot;unloadEventStart&quot;, value: &quot;06:40:970&quot; &#125;,\n  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;06:40:971&quot; &#125;,\n  &#123; key: &quot;responseEnd&quot;, value: &quot;06:40:989&quot; &#125;,\n\n  &#123; key: &quot;domLoading&quot;, value: &quot;06:41:005&quot; &#125;,\n  &#123; key: &quot;domInteractive&quot;, value: &quot;06:41:794&quot; &#125;,\n\n  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;06:41:947&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;06:41:947&quot; &#125;,\n  &#123; key: &quot;domComplete&quot;, value: &quot;06:44:099&quot; &#125;,\n  &#123; key: &quot;loadEventStart&quot;, value: &quot;06:44:099&quot; &#125;,\n  &#123; key: &quot;loadEventEnd&quot;, value: &quot;06:44:101&quot; &#125;,\n];\n\næ— ç—•æ¨¡å¼é¦–æ¬¡var timing4 &#x3D; &#123;\n  connectStart: 1654496795083,\n  navigationStart: 1654496795041,\n  loadEventEnd: 1654496799718,\n  domLoading: 1654496795428,\n  secureConnectionStart: 1654496795093,\n  fetchStart: 1654496795050,\n  domContentLoadedEventStart: 1654496796111,\n  responseStart: 1654496795420,\n  responseEnd: 1654496795469,\n  domInteractive: 1654496795680,\n  domainLookupEnd: 1654496795083,\n  redirectStart: 0,\n  requestStart: 1654496795123,\n  unloadEventEnd: 0,\n  unloadEventStart: 0,\n  domComplete: 1654496799718,\n  domainLookupStart: 1654496795057,\n  loadEventStart: 1654496799718,\n  domContentLoadedEventEnd: 1654496796111,\n  redirectEnd: 0,\n  connectEnd: 1654496795123,\n&#125;;\n\nvar timing4fmt &#x3D; [\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº\n  &#123; key: &quot;navigationStart&quot;, value: &quot;26:35:041&quot; &#125;,\n\n  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;fetchStart&quot;, value: &quot;26:35:050&quot; &#125;,\n\n  &#123; key: &quot;domainLookupStart&quot;, value: &quot;26:35:057&quot; &#125;,\n\n  &#123; key: &quot;connectStart&quot;, value: &quot;26:35:083&quot; &#125;,\n  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;26:35:083&quot; &#125;,\n  &#123; key: &quot;secureConnectionStart&quot;, value: &quot;26:35:093&quot; &#125;,\n  &#123; key: &quot;requestStart&quot;, value: &quot;26:35:123&quot; &#125;,\n  &#123; key: &quot;connectEnd&quot;, value: &quot;26:35:123&quot; &#125;,\n\n  &#123; key: &quot;responseStart&quot;, value: &quot;26:35:420&quot; &#125;,\n\n  &#123; key: &quot;unloadEventEnd&quot;, value: 0 &#125;,\n  &#123; key: &quot;unloadEventStart&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;domLoading&quot;, value: &quot;26:35:428&quot; &#125;,\n  &#123; key: &quot;responseEnd&quot;, value: &quot;26:35:469&quot; &#125;,\n\n  &#123; key: &quot;domInteractive&quot;, value: &quot;26:35:680&quot; &#125;,\n\n  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;26:36:111&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;26:36:111&quot; &#125;,\n\n  &#123; key: &quot;loadEventEnd&quot;, value: &quot;26:39:718&quot; &#125;,\n  &#123; key: &quot;domComplete&quot;, value: &quot;26:39:718&quot; &#125;,\n  &#123; key: &quot;loadEventStart&quot;, value: &quot;26:39:718&quot; &#125;,\n];\n\næ— ç—•æ¨¡å¼åˆ·æ–°var timing5 &#x3D; &#123;\n  connectStart: 1654496848681,\n  navigationStart: 1654496848679,\n  loadEventEnd: 1654496850263,\n  domLoading: 1654496848983,\n  secureConnectionStart: 0,\n  fetchStart: 1654496848681,\n  domContentLoadedEventStart: 1654496849277,\n  responseStart: 1654496848959,\n  responseEnd: 1654496849017,\n  domInteractive: 1654496849096,\n  domainLookupEnd: 1654496848681,\n  redirectStart: 0,\n  requestStart: 1654496848702,\n  unloadEventEnd: 1654496848979,\n  unloadEventStart: 1654496848979,\n  domComplete: 1654496850262,\n  domainLookupStart: 1654496848681,\n  loadEventStart: 1654496850262,\n  domContentLoadedEventEnd: 1654496849277,\n  redirectEnd: 0,\n  connectEnd: 1654496848681,\n&#125;;\n\nvar timing5fmt &#x3D; [\n  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº\n  &#123; key: &quot;navigationStart&quot;, value: &quot;27:28:679&quot; &#125;,\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;fetchStart&quot;, value: &quot;27:28:681&quot; &#125;,\n  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;27:28:681&quot; &#125;,\n  &#123; key: &quot;domainLookupStart&quot;, value: &quot;27:28:681&quot; &#125;,\n  &#123; key: &quot;connectStart&quot;, value: &quot;27:28:681&quot; &#125;,\n  &#123; key: &quot;connectEnd&quot;, value: &quot;27:28:681&quot; &#125;,\n\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#123; key: &quot;secureConnectionStart&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;requestStart&quot;, value: &quot;27:28:702&quot; &#125;,\n  &#123; key: &quot;responseStart&quot;, value: &quot;27:28:959&quot; &#125;,\n\n  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;27:28:979&quot; &#125;,\n  &#123; key: &quot;unloadEventStart&quot;, value: &quot;27:28:979&quot; &#125;,\n\n  &#123; key: &quot;domLoading&quot;, value: &quot;27:28:983&quot; &#125;,\n  &#123; key: &quot;responseEnd&quot;, value: &quot;27:29:017&quot; &#125;,\n\n  &#123; key: &quot;domInteractive&quot;, value: &quot;27:29:096&quot; &#125;,\n\n  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;27:29:277&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;27:29:277&quot; &#125;,\n\n  &#123; key: &quot;domComplete&quot;, value: &quot;27:30:262&quot; &#125;,\n\n  &#123; key: &quot;loadEventStart&quot;, value: &quot;27:30:262&quot; &#125;,\n  &#123; key: &quot;loadEventEnd&quot;, value: &quot;27:30:263&quot; &#125;,\n];\n\næ— ç—•æ¨¡å¼åˆ·æ–° + disable-cachevar timing6 &#x3D; &#123;\n  connectStart: 1654496917781,\n  navigationStart: 1654496917780,\n  loadEventEnd: 1654496921224,\n  domLoading: 1654496918186,\n  secureConnectionStart: 0,\n  fetchStart: 1654496917781,\n  domContentLoadedEventStart: 1654496918836,\n  responseStart: 1654496918156,\n  responseEnd: 1654496918293,\n  domInteractive: 1654496918654,\n  domainLookupEnd: 1654496917781,\n  redirectStart: 0,\n  requestStart: 1654496917784,\n  unloadEventEnd: 1654496918182,\n  unloadEventStart: 1654496918182,\n  domComplete: 1654496921224,\n  domainLookupStart: 1654496917781,\n  loadEventStart: 1654496921224,\n  domContentLoadedEventEnd: 1654496918836,\n  redirectEnd: 0,\n  connectEnd: 1654496917781,\n&#125;;\nvar timing6fmt &#x3D; [\n  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº\n  &#123; key: &quot;navigationStart&quot;, value: &quot;28:37:780&quot; &#125;,\n\n  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†\n  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,\n  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;fetchStart&quot;, value: &quot;28:37:781&quot; &#125;,\n\n  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;28:37:781&quot; &#125;,\n  &#123; key: &quot;domainLookupStart&quot;, value: &quot;28:37:781&quot; &#125;,\n  &#123; key: &quot;connectStart&quot;, value: &quot;28:37:781&quot; &#125;,\n  &#123; key: &quot;connectEnd&quot;, value: &quot;28:37:781&quot; &#125;,\n\n  &#123; key: &quot;secureConnectionStart&quot;, value: 0 &#125;,\n\n  &#123; key: &quot;requestStart&quot;, value: &quot;28:37:784&quot; &#125;,\n  &#123; key: &quot;responseStart&quot;, value: &quot;28:38:156&quot; &#125;,\n  &#x2F;&#x2F; å’Œ timing5fmtæ¯”è¾ƒï¼Œä¹‹å‰é¡µé¢çš„å¸è½½ï¼Œéå¸¸å¿«\n  &#123; key: &quot;unloadEventStart&quot;, value: &quot;28:38:182&quot; &#125;,\n  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;28:38:182&quot; &#125;,\n  &#x2F;&#x2F; æ³¨æ„ domLoading å’Œ responseEnd,è¿™ä¸¤ä¸ªï¼Œé¡ºåºä¸å®š\n  &#123; key: &quot;domLoading&quot;, value: &quot;28:38:186&quot; &#125;,\n  &#123; key: &quot;responseEnd&quot;, value: &quot;28:38:293&quot; &#125;,\n\n  &#123; key: &quot;domInteractive&quot;, value: &quot;28:38:654&quot; &#125;,\n\n  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;28:38:836&quot; &#125;,\n  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;28:38:836&quot; &#125;,\n\n  &#123; key: &quot;loadEventEnd&quot;, value: &quot;28:41:224&quot; &#125;,\n  &#123; key: &quot;domComplete&quot;, value: &quot;28:41:224&quot; &#125;,\n  &#123; key: &quot;loadEventStart&quot;, value: &quot;28:41:224&quot; &#125;,\n];\n\nè¿™ä¸ªæ“ä½œç«Ÿç„¶æœ‰ä¸€ä¸ª base64 ç¼–ç å›¾ç‰‡ä¾ç„¶è¢«ç¼“å­˜äº†,æµè§ˆå™¨ disable-cache å¯¹äºæœ‰äº›å†…å­˜ç¼“å­˜çš„å›¾ç‰‡ç«Ÿç„¶æ˜¯æ— æ•ˆçš„.\nRequest URL: data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC\nRequest Method: GET\nStatus Code: 200 OK (from memory cache)\nReferrer Policy: strict-origin-when-cross-origin\n\n\nå‚è€ƒèµ„æ–™Web æ€§èƒ½ä¼˜åŒ–-é¦–å±å’Œç™½å±æ—¶é—´åˆæ¢ performance â€“ ç›‘æ§ç½‘é¡µä¸ç¨‹åºæ€§èƒ½ç®€è¿°æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶\n","slug":"2022-05-12performance","date":"2022-05-12T10:27:05.000Z","categories_index":"performance","tags_index":"å‰ç«¯,performance,æµè§ˆå™¨åŸç†","author_index":"é™ˆæµ·é¾™"},{"id":"832da5e8309651301e718ddb27ca95fd","title":"vscodeæ’ä»¶ paste code to snippets","content":"ç²˜è´´ä»£ç ï¼Œç”Ÿæˆç”¨æˆ·ä»£ç ç‰‡æ®µèƒŒæ™¯\nå…¶ä»–æ’ä»¶å…·æœ‰å…±æ€§ï¼Œè€Œä¸å…·ç‰¹æ€§ ï¼Œæ¯æ¬¡å†™ä»£ç ï¼Œè¦ä¹ˆç”¨ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œç°æˆçš„ä»£ç ç‰‡æ®µï¼Œæ—¶å¸¸ä¸èƒ½æ»¡è¶³æ—¥å¸¸å¼€å‘éœ€è¦\nè‡ªå®šä¹‰ä»£ç ç‰‡æ®µï¼Œæ‰‹å†™ è´¹æ—¶è´¹åŠ›ï¼Œä¸€èˆ¬æ­¥éª¤ï¼Œç²˜è´´ã€ä¿®æ”¹ã€æ ¼å¼åŒ–\nå…¶ä»–æ’ä»¶ç±»ä¼¼vscodeå®å˜é‡çš„ä½¿ç”¨å°‘ä¹‹åˆå°‘ï¼Œ è¦ä¹ˆå°†å¼€æºæ’ä»¶å®šåˆ¶åŒ–ï¼Œè¦ä¹ˆé‡æ–°å¼€å‘\nå¿«æ·å˜é‡è®°ä¸ä½\n\npaste code to snippets ä¼˜ç‚¹ï¼š\né«˜åº¦å®šåˆ¶åŒ–\nè·¨è¯­è¨€ï¼ˆä»»ä½•vscodeæ”¯æŒçš„è¯­è¨€ï¼Œéƒ½å¯åœ¨å¯¹åº”ç±»å‹ç‰‡æ®µæ–‡ä»¶ä¸­è¿›è¡Œå¢åŠ ï¼‰\nä½¿ç”¨ç®€å• ï¼ˆå¤åˆ¶ã€å”¤èµ·å‘½ä»¤ã€æŒ–å­”ï¼‰\nå¿«æ·å˜é‡å®Œå…¨è‡ªå®šä¹‰ï¼ˆæƒ³æ€ä¹ˆå†™å°±æ€ä¹ˆå†™ï¼‰\n\næ“ä½œGIF\né—®é¢˜\nå¦‚æœé…ç½®äº†ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰æç¤º, æŸ¥çœ‹settings.jsonå¯¹åº”\næ‰“å¼€ settings.json å‘½ä»¤ï¼š command + shift + p, æœ &gt;settings\n\nä»¥markdownä¸ºä¾‹ é»˜è®¤åªè¯»é…ç½®åœ¨å‡çº§åå˜æˆäº†false\n&#x2F;&#x2F; Configure settings to be overridden for the markdown language.\n&quot;[markdown]&quot;:  &#123;\n\t&quot;editor.unicodeHighlight.ambiguousCharacters&quot;: false,\n\t&quot;editor.unicodeHighlight.invisibleCharacters&quot;: false,\n\t&quot;editor.wordWrap&quot;: &quot;on&quot;,\n\t&quot;editor.quickSuggestions&quot;: false \n&#125;,\n\n\nä¿®æ”¹\n\n","slug":"2022-05-11vscode","date":"2022-05-11T01:38:30.000Z","categories_index":"vscode","tags_index":"å¢æ•ˆ,vscode","author_index":"é™ˆæµ·é¾™"},{"id":"8a3cd3de20e0b1971e27a9e96209af62","title":"HTTP3","content":"ç°çŠ¶\n\n\n\n\n\n\n\n\n\nHTTP/3 çš„åŸºç¡€å³è°·æ­Œå¤šå¹´æ¢ç´¢çš„åŸºäº UDP çš„ QUIC åè®®ã€‚ä¸ TCP ç›¸æ¯”ï¼Œä½¿ç”¨ UDP å¯ä»¥æä¾›æ›´å¤§çš„çµæ´»æ€§ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ QUIC å®Œå…¨äºç”¨æˆ·ç©ºé—´ä¸­å®ç°â€”â€”å¯¹åè®®å®ç°çš„æ›´æ–°ä¸åƒ TCP é‚£æ ·éœ€è¦ç»‘å®šåˆ°æ“ä½œç³»ç»Ÿæ›´æ–°ã€‚ä½¿ç”¨ QUICï¼Œå¯ä»¥ç®€å•åœ°å°† HTTP çº§åˆ«çš„æµæ˜ å°„åˆ° QUIC æµçš„é¡¶éƒ¨ï¼Œä»è€Œç»§æ‰¿ HTTP/2 çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œè€Œä¸ä¼šäº§ç”Ÿé˜Ÿå¤´é˜»å¡ã€‚HTTP/3 è™½ä»å¤„äºè‰æ¡ˆçŠ¶æ€ï¼Œä½†å¾ˆå¤šç”¨æˆ·å·²ç»è·ƒè·ƒæ¬²è¯•ã€‚\nä¼˜åŠ¿\nHTTP&#x2F;3 åˆ©ç”¨ QUIC åŠ é€Ÿ HTTP è¯·æ±‚ï¼ŒQUIC æä¾›æ¯” TCP å’Œ TLS æ›´é«˜çš„åŠ å¯†å’Œæ€§èƒ½\nQUIC æ˜¯ä¸€ç§é»˜è®¤åŠ å¯†çš„æ–°ä¼ è¾“åè®®ï¼Œæ—¨åœ¨åŠ å¿« HTTP ä¼ è¾“é€Ÿåº¦ä»¥åŠä½¿å…¶æ›´åŠ å®‰å…¨\nHTTP&#x2F;3 åŸºäº UDPï¼Œå¦‚æœæ•°æ®åŒ…ä¸¢å¤±ï¼Œåªä¼šä¸­æ–­ä¸€ä¸ªæµï¼Œè€Œä¸ä¼šä¸­æ–­æ‰€æœ‰æµï¼Œæé«˜äº†åŒæ—¶è·å–å¤šä¸ªå¯¹è±¡çš„æ€§èƒ½\næ”¯æŒ 0-RTTï¼Œæ¶ˆé™¤æœåŠ¡å™¨çš„ TLS ç¡®è®¤ï¼Œä½¿åç»­è¿æ¥çš„å¯åŠ¨é€Ÿåº¦æ›´å¿«\n\næ¼”ç¤ºä¸‹å›¾è¡¨ç¤º HTTP&#x2F;2 å’Œ HTTP&#x2F;3 å¤šè·¯å¤ç”¨ä¸¤ä¸ªè¯·æ±‚æ—¶ï¼Œæ•°æ®åŒ…ä¸¢å¤±åŠå…¶å½±å“ï¼ˆè¯·æ±‚åŠå…¶ç›¸å…³çš„å“åº”åˆ†åˆ«ä¸ºæ·±è“å’Œæµ…è“è‰²ï¼‰\nHTTP&#x2F;2 å¤šè·¯å¤ç”¨ 2 ä¸ªè¯·æ±‚ã€‚å“åº”è¢«åˆ†è§£ä¸ºå¤šä¸ªæ•°æ®åŒ…ï¼Œä¸€æ—¦ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œä¸¤ä¸ªè¯·æ±‚éƒ½è¢«é˜»æ­¢ã€‚HTTP&#x2F;3 å¤ç”¨ 2 ä¸ªè¯·æ±‚ã€‚è™½ç„¶æµ…è‰²çš„æ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œä½†æ˜¯æ·±è‰²çš„æ•°æ®åŒ…ä¼ è¾“å¾—å¾ˆå¥½ã€‚åœ¨ç›¸åŒä¸¢åŒ…ç‡çš„æ¡ä»¶ä¸‹ï¼ŒHTTP&#x2F;3 å’Œ HTTP&#x2F;2 æ€§èƒ½æµ‹è¯•å¯¹æ¯”å¦‚ä¸‹æµ‹è¯•ç¯å¢ƒï¼šæœåŠ¡ç«¯ï¼ˆHTTP&#x2F;3 with cubic &amp; HTTP&#x2F;2 with bbrï¼‰ã€å®¢æˆ·ç«¯ï¼ˆcubicï¼‰\næ›´å¤šæŸ¥çœ‹æ›´å¤š\n","slug":"2022-05-11http","date":"2022-05-11T01:26:00.000Z","categories_index":"å·¥å…·","tags_index":"å·¥å…·","author_index":"é™ˆæµ·é¾™"},{"id":"f5ccfd5f1ce5f78727a64a19669811c7","title":"Slate wiki-uiè¯„è®ºåŠŸèƒ½å…‰æ ‡ä¹±è·³","content":"bugå¤ç°bugå¤ç° (node:29) UnhandledPromiseRejectionWarning: Error: Forbidden at &amp;#x2F;code&amp;#x2F;client&amp;#x2F;.next&amp;#x2F;server&amp;#x2F;pages&amp;#x2F;_app-a05...\n\nåœ¨vite reacté¡¹ç›®ä¸Šï¼Œè¾“å…¥æ±‰å­—çš„åŒæ—¶æŒ‰ä½åˆ é™¤é”®ï¼Œå…‰æ ‡ä¼šä¹±è·³\næ’æŸ¥1:wikiï¼ˆesmï¼‰ç»„ä»¶é—®é¢˜ï¼Œæ£€æŸ¥wiki-uiç»„ä»¶åº“ï¼Œè¿è¡Œæ­£å¸¸\n&quot;react&quot;: &quot;^16.8.0&quot;,\n&quot;react-dom&quot;: &quot;^16.8.0&quot;,\næ’æŸ¥2:viteåŠ è½½wiki-uiç»„ä»¶æ—¶å€™ï¼Œå› ä¸ºviteåªèƒ½å¤„ç†esmï¼Œåœ¨vite.config.ts, esbuildOptionsè‡ªå®šä¹‰æ’ä»¶è¿›è¡Œå¤„ç†wiki-uiï¼Œä¸æ˜¯å¾ˆæ‡‚ï¼Œæ¢ä¸ªè§’åº¦\nesbuildOptions: &#123;\n  plugins: [\n    &#123;\n      name: &#39;originjs:commonjs&#39;,\n      setup(build) &#123;\n        build.onLoad(\n          &#123;\n            filter: &#x2F;@æ•æ„Ÿæ•°æ®-fe\\&#x2F;wiki-ui\\&#x2F;dist&#x2F;,\n            namespace: &#39;file&#39;,\n          &#125;,\n          async (&#123; path: id &#125;) &#x3D;&gt; &#123;\n            const code &#x3D; readFileSync(id).toString()\n            const result &#x3D; transformRequire(code, id)\n\n            return &#123;\n              contents: result,\n              loader: &#39;js&#39;,\n            &#125;\n          &#125;,\n        ),\n          build.onLoad(\n            &#123;\n              filter: &#x2F;@æ•æ„Ÿæ•°æ®-fe\\&#x2F;wiki-ui\\&#x2F;dist\\&#x2F;components\\&#x2F;iconfont&#x2F;,\n              namespace: &#39;file&#39;,\n            &#125;,\n            async (&#123; path: id &#125;) &#x3D;&gt; &#123;\n              const code &#x3D; readFileSync(id).toString()\n              const result &#x3D; transformRequire(code, id)\n\n              return &#123;\n                contents: result,\n                loader: &#39;js&#39;,\n              &#125;\n            &#125;,\n          )\n      &#125;,\n    &#125;,\n    esbuildPluginMonacoEditorNls(&#123;\n      locale: Languages.zh_hans,\n    &#125;),\n  ],\n&#125;,\næ’æŸ¥3:å°†wiki-uiç»„ä»¶æ”¾åˆ°umijsåº”ç”¨ä¸­è¿è¡Œ\n# æ­å»ºä¸ªé¡¹ç›®\n# ç§»åŠ¨demoç»„ä»¶åˆ°æ–°é¡¹ç›®\n# è¿è¡Œï¼Œå‘ç°æœ‰ç›¸åŒçš„é—®é¢˜\nåˆ†æï¼š1.domè¾“å…¥è¿‡ç¨‹ä¸­ç‚¹å‡»åˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè¾“å…¥çš„å†…å®¹æ˜¯åœ¨contenteditable=&quot;true&quot; ä¸­è¿è¡Œ\n&lt;div data-gramm&#x3D;&quot;false&quot; role&#x3D;&quot;textbox&quot; spellcheck&#x3D;&quot;false&quot; class&#x3D;&quot;slash-slate-core&quot; id&#x3D;&quot;SLASH_SLATE_CORE&quot; data-app-id&#x3D;&quot;5A9BEA&quot; autocorrect&#x3D;&quot;false&quot; autocapitalize&#x3D;&quot;false&quot; data-slate-editor&#x3D;&quot;true&quot; data-slate-node&#x3D;&quot;value&quot; contenteditable&#x3D;&quot;true&quot; style&#x3D;&quot;position: relative; outline: none; white-space: pre-wrap; overflow-wrap: break-word;&quot;&gt;&lt;p data-slate-node&#x3D;&quot;element&quot;&gt;&lt;span data-slate-node&#x3D;&quot;text&quot;&gt;&lt;span data-slate-leaf&#x3D;&quot;true&quot;&gt;&lt;span data-slate-string&#x3D;&quot;true&quot;&gt;12121212å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆh h h h h h h h h h h h hs f s d f&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;\n2.åˆæˆäº‹ä»¶åº”è¯¥ä¼šèµ°åˆæˆäº‹ä»¶ï¼Œåˆæˆäº‹ä»¶ä¹‹åä¼šæ‰§è¡Œæ¸²æŸ“ï¼Œwebç«¯èµ°çš„æ˜¯react-domï¼Œæ¯”å¯¹æ­£å¸¸è¿è¡Œçš„é¡¹ç›®ï¼Œå’Œæ–°é¡¹ç›®çš„ç‰ˆæœ¬\n# react 17ç‰ˆæœ¬\n# react-dom 17ç‰ˆæœ¬\n3.reactå…ˆè¿›è¡Œreacté™ç‰ˆæœ¬ 16.14.0ï¼Œæ£€æŸ¥åˆæˆäº‹ä»¶æ˜¯å¦æœ‰é—®é¢˜ï¼Œé™ç‰ˆæœ¬åï¼Œè¿è¡Œï¼Œé—®é¢˜åŒæ ·å­˜åœ¨ï¼Œå¤§æ¦‚å¯ä»¥æ–­å®šæ˜¯react-domæ¸²æŸ“å‡ºäº†é—®é¢˜ï¼Œ\n4.react-domå¯¹react-domé™ä½ç‰ˆæœ¬åˆ°16.14.0, åè¿è¡Œæ­£å¸¸ï¼Œé‚£ä¹ˆé—®é¢˜åº”è¯¥åœ¨react-domä¸Š\n5.githubç‰ˆæœ¬ 16.14.0ä¸¤ä¸ªç‰ˆæœ¬æœ‰ä»€ä¹ˆä¸åŒï¼šæŸ¥çœ‹reactå‘å¸ƒæ—¥å¿—ï¼Œ16.14.0ä¹‹åçš„ä¸€ä¸ªç‰ˆæœ¬æ˜¯17.0.0 (October 20, 2020) çœ‹ä¸Šå»ä¸äº‹ä»¶å’Œæ¸²æŸ“ç›¸å…³çš„ä¸œè¥¿ä¸å¤š\nUse browser focusin and focusout for onFocus and onBlur. (@trueadm in #19186)\nMake all Capture events use the browser capture phase. (@trueadm in #19221)\nThrow if forwardRef or memo component returns undefined. (@gaearon in #19550)\nRemove event pooling. (@trueadm in #18969)\nFix onBeforeInput reporting an incorrect event.type. (@eps1lon in #19561)\nFix event.relatedTarget reported as undefined in Firefox. (@claytercek in #19607)\nFix rendering into a shadow root. (@Jack-Works in #15894)\nFix movementX&#x2F;Y polyfill with capture events. (@gaearon in #19672)\nArtifacts\nreact: https:&#x2F;&#x2F;unpkg.com&#x2F;react@17.0.1&#x2F;umd&#x2F;\nreact-art: https:&#x2F;&#x2F;unpkg.com&#x2F;react-art@17.0.1&#x2F;umd&#x2F;\nreact-dom: https:&#x2F;&#x2F;unpkg.com&#x2F;react-dom@17.0.1&#x2F;umd&#x2F;\nreact-is: https:&#x2F;&#x2F;unpkg.com&#x2F;react-is@17.0.1&#x2F;umd&#x2F;\nreact-test-renderer: https:&#x2F;&#x2F;unpkg.com&#x2F;react-test-renderer@17.0.1&#x2F;umd&#x2F;\nscheduler: https:&#x2F;&#x2F;unpkg.com&#x2F;scheduler@0.20.1&#x2F;umd&#x2F;\n6.githubç‰ˆæœ¬ 18.1.0åœ¨å¾€åæ‰¾æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå‘ç°åœ¨18.1.0 (April 26, 2022)ï¼Œæ”¹äº†ä¸€å †react-domçš„bug,çœ‹ä¸Šå»ä¹Ÿæ²¡ç›¸å…³çš„\nFix the false positive warning about react-dom&#x2F;client when using UMD bundle. (@alireza-molaee in #24274)\nFix suppressHydrationWarning to work in production too. (@gaearon in #24271)\nFix componentWillUnmount firing twice inside of Suspense. (@acdlite in #24308)\nFix some transition updates being ignored. (@acdlite in #24353)\nFix useDeferredValue causing an infinite loop when passed an unmemoized value. (@acdlite in #24247)\nFix throttling of revealing Suspense fallbacks. (@sunderls in #24253)\nFix an inconsistency in whether the props object is the same between renders. (@Andarist and @acdlite in #24421)\nFix a missing warning about a setState loop in useEffect. (@gaearon in #24298)\nFix a spurious hydration error. (@gnoff in #24404)\nWarn when calling setState in useInsertionEffect. (@gaearon in #24295)\nEnsure the reason for hydration errors is always displayed. (@gaearon in #24276)\n\nå¯ç”¨ç‰ˆæœ¬&quot;react&quot;: &quot;^16.14.0&quot;,\n&quot;react-dom&quot;: &quot;16.14.0&quot;,\n\n\nè¿™ä¸ªæ¼”ç¤ºä»£ç æ­£å¸¸&lt;embed type&#x3D;&quot;text&#x2F;html&quot; src&#x3D;&quot;https:&#x2F;&#x2F;stackblitz.com&#x2F;edit&#x2F;react-ts-m3y5yv?embed&#x3D;1&amp;file&#x3D;App.tsx&amp;view&#x3D;preview&quot; width&#x3D;&quot;100%&quot; height&#x3D;&quot;200&quot;&gt;\n&lt;!--åŠ è½½å¤ªæ…¢ï¼Œå¤åˆ¶åœ°å€æŸ¥çœ‹å§--&gt; \n&lt;!--https:&#x2F;&#x2F;stackblitz.com&#x2F;edit&#x2F;react-ts-m3y5yv?embed&#x3D;1&amp;file&#x3D;App.tsx&amp;view&#x3D;preview--&gt; \n\næ‡µé€¼ã€‚ã€‚ã€‚ä»å¤´å¼€å§‹\nå¾…åŠäº‹é¡¹ä¸­çš„è¯„è®ºåŠŸèƒ½ï¼ˆç»„ä»¶é—®é¢˜ï¼‰å…‰æ ‡ä¹±è·³çš„é—®é¢˜ï¼›\n0. é¡¹ç›® + wiki-ui å¼‚å¸¸\n1. å•è¿è¡Œwiki-ui demo æ­£å¸¸\n2. è¿è¡Œslate + umijs æ­£å¸¸\n3. è¿è¡Œwiki-ui  + umijs å¼‚å¸¸\n4. slate ä¸  wiki-ui  ä¸ä¸€æ ·åœ¨äºslateç‰ˆæœ¬\n5. wiki-ui åšäº†ä»€ä¹ˆäº‹æƒ…ï¼š å®šåˆ¶åŒ–ä¸€äº›èŠ‚ç‚¹å±•ç¤ºï¼Œå…‰æ ‡çš„æ¸²æŸ“å’Œwiki-uiæ— å…³\nè´«åƒ§å…ˆå»slateå®˜ç½‘åŒ–ç¼˜ï¼Œå›æ¥å†æˆ˜slate-lean\nåŒ–ç¼˜å½’æ¥é—®é¢˜æ€ä¹ˆè§£å†³\n","slug":"2022-04-29slate","date":"2022-05-10T05:00:00.000Z","categories_index":"wiki","tags_index":"wiki","author_index":"é™ˆæµ·é¾™"},{"id":"1827bdebccdb6131916a11069d50f729","title":"è·¨åŸŸé—®é¢˜","content":"èƒŒæ™¯æµè§ˆå™¨å®‰å…¨ç­–ç•¥é™åˆ¶è·¨åŸŸè®¿é—®\nå†…å®¹å®‰å…¨ç­–ç•¥æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚\n\nä½¿ç”¨æ–¹å¼ä¸ºä½¿ CSP å¯ç”¨, ä½ éœ€è¦é…ç½®ä½ çš„ç½‘ç»œæœåŠ¡å™¨è¿”å› Content-Security-Policyï¼Œæˆ–è€…åœ¨ HTML  å…ƒç´ ç§ä¹Ÿå¯é…ç½®è¯¥ç­–ç•¥, ä¾‹å¦‚ï¼š\n\n&lt;meta\n  http-equiv&#x3D;&quot;Content-Security-Policy&quot;\n  content&#x3D;&quot;default-src &#39;self&#39;; img-src https:&#x2F;&#x2F;*; child-src &#39;none&#39;;&quot;\n&#x2F;&gt;\n\n\né…ç½®ç¤ºä¾‹ï¼ˆ1ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…æƒ³è¦æ‰€æœ‰å†…å®¹å‡æ¥è‡ªç«™ç‚¹çš„åŒä¸€ä¸ªæº (ä¸åŒ…æ‹¬å…¶å­åŸŸå)\n\nContent-Security-Policy: default-src &#39;self&#39;\n\nï¼ˆ2ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸å†…å®¹æ¥è‡ªä¿¡ä»»çš„åŸŸååŠå…¶å­åŸŸå (åŸŸåä¸å¿…é¡»ä¸ CSP è®¾ç½®æ‰€åœ¨çš„åŸŸåç›¸åŒ)\nContent-Security-Policy: default-src &#39;self&#39; *.trusted.com\n\nï¼ˆ3ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸ç½‘é¡µåº”ç”¨çš„ç”¨æˆ·åœ¨ä»–ä»¬è‡ªå·±çš„å†…å®¹ä¸­åŒ…å«æ¥è‡ªä»»ä½•æºçš„å›¾ç‰‡, ä½†æ˜¯é™åˆ¶éŸ³é¢‘æˆ–è§†é¢‘éœ€ä»ä¿¡ä»»çš„èµ„æºæä¾›è€…(è·å¾—)ï¼Œæ‰€æœ‰è„šæœ¬å¿…é¡»ä»ç‰¹å®šä¸»æœºæœåŠ¡å™¨è·å–å¯ä¿¡çš„ä»£ç ã€‚\nContent-Security-Policy: default-src &#39;self&#39;;\nimg-src *;\nmedia-src media1.com media2.com; script-src userscripts.example.com\n\nåœ¨è¿™é‡Œï¼Œå„ç§å†…å®¹é»˜è®¤ä»…å…è®¸ä»æ–‡æ¡£æ‰€åœ¨çš„æºè·å–, ä½†å­˜åœ¨å¦‚ä¸‹ä¾‹å¤–:\nå›¾ç‰‡å¯ä»¥ä»ä»»ä½•åœ°æ–¹åŠ è½½(æ³¨æ„ â€œ*â€œ é€šé…ç¬¦)ã€‚å¤šåª’ä½“æ–‡ä»¶ä»…å…è®¸ä» media1.com å’Œ media2.com åŠ è½½(ä¸å…è®¸ä»è¿™äº›ç«™ç‚¹çš„å­åŸŸå)ã€‚å¯è¿è¡Œè„šæœ¬ä»…å…è®¸æ¥è‡ªäº userscripts.example.comã€‚\nä½œè€…ï¼šèœé¸¡å‰ç«¯é“¾æ¥ï¼šhttps://www.jianshu.com/p/a45924e99a6dæ¥æºï¼šç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nå¤„ç†æ–¹å¼nginx\nè„šæœ¬\n\n\nlisten 80; # ç›‘å¬çš„ç«¯â¼\n   add_header &#39;Access-Control-Allow-Origin&#39; &#39;$http_origin&#39; ;\n   add_header &#39;Access-Control-Allow-Credentials&#39; &#39;true&#39; ;\n   add_header &#39;Access-Control-Allow-Methods&#39; &#39;PUT,POST,GET,DELETE,OPTIONS&#39; ;\n   add_header &#39;Access-Control-Allow-Headers&#39; &#39;Content-Type,Content-Length,Authorization,Accept,X-Requested-With&#39; ;\n\n\nå®é™…æ“ä½œ\n\n\njsonp æ–¹å¼ &lt;åŠ¨æ€ script&gt;æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼ nginxå…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰","slug":"2022-05-09cors","date":"2022-05-09T13:30:47.000Z","categories_index":"é¢è¯•","tags_index":"é¢è¯•","author_index":"é™ˆæµ·é¾™"},{"id":"99460a2013287be2d51642da6dd169f8","title":"é¢è¯•é¢˜æ±‡æ€»","content":"å€¼å¾—æ”¶è—çš„é“¾æ¥\nç ä¸Šé€šå¤©\né¢è¯•å®Œ50ä¸ªäººåæˆ‘å†™ä¸‹è¿™ç¯‡æ€»ç»“\nif æˆ‘æ˜¯å‰ç«¯å›¢é˜Ÿ Leaderï¼Œæ€ä¹ˆåˆ¶å®šå‰ç«¯åä½œè§„èŒƒ?\nåšäº†ä¸€ä»½å‰ç«¯é¢è¯•å¤ä¹ è®¡åˆ’ï¼Œä¿ç†Ÿï½\n\n","slug":"2022-05-08interview","date":"2022-05-08T08:27:00.000Z","categories_index":"","tags_index":"é¢è¯•","author_index":"é™ˆæµ·é¾™"},{"id":"8c2ce163d41ac846e552a207bb84d5a9","title":"jså˜é‡å’Œä½œç”¨åŸŸ","content":"å˜é‡var let conståŒºåˆ«\nå˜é‡æå‡ï¼švar å­˜åœ¨å˜é‡æå‡ï¼Œletã€constæ²¡æœ‰ï¼ˆletã€constå­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼‰\nä½œç”¨åŸŸçš„é™åˆ¶ï¼švarä¸å—ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œè€Œletã€constå—å½“å‰ä½œç”¨åŸŸçš„é™åˆ¶\né‡å¤å£°æ˜ï¼švarå¯ä»¥é‡å¤å£°æ˜ï¼Œletã€constä¸å¯ä»¥\nconstæ˜¯å¸¸é‡ï¼Œå¿…é¡»æœ‰åˆå§‹å€¼ï¼Œå¦åˆ™æŠ¥é”™ï¼Œä¸èƒ½æ›´æ”¹ï¼Œä½†æ˜¯å¯ä»¥æ›´æ”¹å¯¹è±¡å†…éƒ¨å±æ€§\n\nå˜é‡åˆ†ç±»\njsä¸­çš„å˜é‡åˆ†ä¸ºä¸¤ç§ï¼š\nå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚å…¨å±€å˜é‡å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯åœ¨jsä»»ä½•åœ°æ–¹éƒ½èƒ½å¤Ÿè°ƒç”¨çš„å˜é‡ï¼›\nè€Œå±€éƒ¨å˜é‡å°±åªèƒ½åœ¨å‡½æ•°çš„å†…éƒ¨æ‰èƒ½å¤Ÿè°ƒç”¨çš„å˜é‡ã€‚\n\n\n\nvar a&#x3D;10;\nfunction show()&#123;\n  console.log(&#39;a:&#39;+a); &#x2F;&#x2F;a:10\n  var b&#x3D;2;\n  console.log(&#39;inside b:&#39;+b); &#x2F;&#x2F;inside b:2\n&#125;\nshow();\nconsole.log(&#39;outside b:&#39;+b); &#x2F;&#x2F;b is no defined\nã€€ã€€åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œå˜é‡aå°±æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°çš„å†…éƒ¨èƒ½å¤Ÿè°ƒç”¨ã€‚ä½†æ˜¯è¿™é‡Œçš„å˜é‡bå°±æ˜¯å±€éƒ¨å˜é‡ï¼Œå½“å‡½æ•°ç»“æŸè°ƒç”¨åï¼Œå˜é‡bå°±è¢«å›æ”¶äº†ï¼Œå› æ­¤åœ¨å‡½æ•°å¤–éƒ¨è°ƒç”¨å¤±è´¥ã€‚\nå¦å¤–éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼š\n\n\n\n\n\n\n\n\n\nå¦‚æœåœ¨å£°æ˜å±€éƒ¨å˜é‡æ—¶ä¸ç”¨varå£°æ˜ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡è‡ªåŠ¨â€œæå‡â€ä¸ºå…¨å±€å˜é‡ã€‚\nvar a&#x3D;10;\nfunction show()&#123;\n  console.log(&#39;a:&#39;+a); &#x2F;&#x2F;a:10\n  b&#x3D;2;\n  console.log(&#39;inside b:&#39;+b); &#x2F;&#x2F;inside b:2\n&#125;\nshow();\nconsole.log(&#39;outside b:&#39;+b); &#x2F;&#x2F;outside b:2\nå¯¹æ¯”ä¸¤æ®µä»£ç ï¼Œå¦‚æœä½ åœ¨å£°æ˜b&#x3D;2æ—¶æ²¡æœ‰å†™varï¼Œé‚£ä¹ˆbå°±éšå¼åœ°å£°æ˜ä¸ºå…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°å¤–é¢è¿˜æ˜¯èƒ½å¤Ÿè¢«è°ƒç”¨åˆ°çš„ã€‚è™½ç„¶ä½¿ç”¨å…¨å±€å˜é‡èƒ½å¤Ÿåœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ï¼Œå¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å…¨å±€å˜é‡çš„ä¼˜ç‚¹ä¹Ÿç»™ä»–å¸¦æ¥äº†ç¼ºç‚¹ï¼š\n\nä¸€ç›´å ç”¨å†…å­˜ï¼šå…¨å±€å˜é‡ä¿å­˜åœ¨é™æ€å­˜å‚¨åŒºï¼Œå¦‚æœå…¨å±€å˜é‡è¿‡å¤šä¼šå å¤šå¤§é‡å†…å­˜ï¼Œä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½ã€‚\nå½±å“äº†å‡½æ•°çš„ç‹¬ç«‹æ€§ï¼šä¸€èˆ¬å‡½æ•°éƒ½æ˜¯ä¼ å…¥å‚æ•°å’Œä¼ å‡ºè¿”å›å€¼è¿›è¡Œè¿ç®—çš„ï¼Œå¦‚æœå‡½æ•°ä¾èµ–äºå…¨å±€å˜é‡ï¼Œç ´åäº†å‡½æ•°çš„è¿™ç§ç‹¬ç«‹æ€§ï¼Œ\nå¯ç§»æ¤æ€§: åŒæ—¶ä¹Ÿé™ä½äº†å‡½æ•°çš„å¯ç§»æ¤æ€§ã€‚\n\nå› æ­¤æˆ‘ä»¬åœ¨å®šä¹‰å˜é‡æ—¶ä¸€èˆ¬è¦å°½å¯èƒ½å°‘çš„å®šä¹‰å…¨å±€å˜é‡ã€‚\nå˜é‡å£°æ˜\n\n\n\n\n\n\n\n\nå‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡å£°æ˜\nã€€ã€€ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥è¯´æ˜.\nvar a; \nfunction a()&#123;\n&#125;\nconsole.log(typeof a); &#x2F;&#x2F;function\n&#x2F;&#x2F; æˆ–è®¸æœ‰äººæ˜¯è®¤ä¸ºå‡½æ•°å£°æ˜åœ¨åé¢çš„åŸå› ï¼Œé‚£ä¹ˆè°ƒæ¢ä¸€ä¸‹ä½ç½®ã€‚\nfunction a()&#123;\n&#125;\nvar a; \nconsole.log(typeof a); &#x2F;&#x2F;function\n&#x2F;&#x2F; è°ƒæ¢ä½ç½®åå˜é‡açš„ç±»å‹è¿˜æ˜¯functionï¼Œè¿™æ—¶å€™å£°æ˜å˜é‡açš„è¯­å¥æ²¡æœ‰èµ·ä½œç”¨ï¼Œè¢«å‡½æ•°å£°æ˜è¦†ç›–äº†ã€‚\n&#x2F;&#x2F; å› æ­¤å‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡çš„å£°æ˜ã€‚\n&#x2F;&#x2F; ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨å£°æ˜çš„åŒæ—¶ç»™aè¿›è¡Œèµ‹å€¼ã€‚\nfunction a()&#123;\n&#125;\nvar a&#x3D;&#39;xyf&#39;; \nconsole.log(typeof a); &#x2F;&#x2F;string\n&#x2F;&#x2F; æˆ‘ä»¬å°†å…¶è°ƒæ¢ä¸€ä¸‹ä½ç½®å†æ¬¡è¿›è¡ŒéªŒè¯ã€‚\nvar a&#x3D;&#39;xyf&#39;; \nfunction a()&#123;\n&#125;\nconsole.log(typeof a); &#x2F;&#x2F;string\n&#x2F;&#x2F; å¯ä»¥çœ‹åˆ°ï¼Œç»™å˜é‡aè¿›è¡Œèµ‹å€¼åï¼Œä¸ç®¡å˜é‡aåœ¨å“ªï¼Œå…¶ç±»å‹å˜ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œä¸Šé¢ä¸¤æ®µä»£ç ç›¸å½“äºå¦‚ä¸‹ä»£ç ï¼š\nfunction a()&#123;\n&#125;\nvar a;\na&#x3D;&#39;xyf&#39;;\nconsole.log(typeof a); &#x2F;&#x2F;string\n&#x2F;&#x2F; aæœ€åè¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå› æ­¤açš„ç±»å‹è‡ªç„¶æ˜¯å­—ç¬¦ä¸²\nä½œç”¨åŸŸå…¨å±€ä½œç”¨åŸŸã€€jsä¸­ä½œç”¨åŸŸåªæœ‰å‡½æ•°ä½œç”¨åŸŸå’Œå…¨å±€ä½œç”¨åŸŸï¼Œ\nå‡½æ•°ä½œç”¨åŸŸã€€jsä¸­ä½œç”¨åŸŸåªæœ‰å‡½æ•°ä½œç”¨åŸŸå’Œå…¨å±€ä½œç”¨åŸŸï¼Œ\nå—çº§ä½œç”¨åŸŸ  let constæœ‰å—çº§ä½œç”¨åŸŸã€‚å‡½æ•°ä½œç”¨åŸŸæ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯å—çº§ä½œç”¨åŸŸå‘¢ï¼Ÿ  &#123;var a &#x3D; 1&#125;\n\nconsole.log(a)\nVM2355:1 1\n  &#123;let a &#x3D;1&#125;\n\nconsole.log(a)\nVM2079:1 Uncaught ReferenceError: a is not defined\n\n\n\n\n\n\n\n\n\nä»»ä½•ä¸€å¯¹èŠ±æ‹¬å·ï¼ˆï½›å’Œï½ï¼‰ä¸­çš„è¯­å¥é›†éƒ½å±äºä¸€ä¸ªå—ï¼Œåœ¨è¿™ä¹‹ä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡åœ¨ä»£ç å—å¤–éƒ½æ˜¯ä¸å¯è§çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå—çº§ä½œç”¨åŸŸã€‚\nã€€ã€€ç†è§£äº†å—çº§ä½œç”¨åŸŸï¼Œæ¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„å°ä¾‹å­ã€‚\nconsole.log(v); &#x2F;&#x2F;undefined\nvar v &#x3D; &quot;world&quot;;\nã€€ã€€&#x2F;&#x2F; è¿™æ®µä»£ç å¾ˆå¥½ç†è§£ï¼Œç”±äºå˜é‡våœ¨æ²¡æœ‰èµ‹å€¼å‰ä½¿ç”¨äº†ï¼Œæ‰€ä»¥æ˜¯undefinedã€‚å…¶å®è¿™é‡Œå­˜åœ¨ç€å£°æ˜çš„æå‰ã€‚\nå½“å‰ä½œç”¨åŸŸå†…çš„å£°æ˜éƒ½ä¼šæå‡åˆ°ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°çš„å£°æ˜\nç”±äºjsä½œç”¨åŸŸä¸­çš„å£°æ˜éƒ½ä¼šè¢«æå‡åˆ°ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼Œæ‰€ä»¥ï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºï¼š\nvar v;\nconsole.log(v); &#x2F;&#x2F;undefined\nv &#x3D; &quot;world&quot;;\n&#x2F;&#x2F; è¿™æ ·å°±èƒ½å¾ˆæ¸…æ™°åœ°ç†è§£ä¸ºä»€ä¹ˆå˜é‡væ˜¯undefinedçš„äº†ã€‚\n&#x2F;&#x2F;ä¸‹é¢æˆ‘ä»¬æŠŠå˜é‡væ”¾åˆ°ä¸€ä¸ªæ–¹æ³•ä¸­å»ï¼š\nif(true)&#123;\n  var v &#x3D; &quot;hello&quot;;\n&#125;\nconsole.log(v); &#x2F;&#x2F;hello\n&#x2F;&#x2F; åœ¨è¿™é‡Œç”±äºjsæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥ifæ–¹æ³•æ²¡æœ‰â€œå½¢æˆâ€ä¸€ä¸ªå°é—­çš„ä½œç”¨åŸŸï¼Œ\n&#x2F;&#x2F; å¹¶ä¸èƒ½å¤Ÿâ€œé˜»æŒ¡â€å¤–é¢çš„ä»£ç è·å–é‡Œé¢çš„å˜é‡ã€‚\nå‡½æ•°ä½œç”¨åŸŸã€€ã€€æˆ‘ä»¬å†æŠŠå˜é‡væ”¾åˆ°å‡½æ•°ä¸­å»ï¼š\nfunction show()&#123;\n  var v&#x3D;&#39;world&#39;;\n&#125;\nshow();\nconsole.log(v); &#x2F;&#x2F;undefined\nã€€ã€€ç”±äºshowå‡½æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œâ€œé˜»æŒ¡â€å¤–é¢çš„ä»£ç è·å–é‡Œé¢å˜é‡ï¼ˆå¹¶ä¸èƒ½é˜»æŒ¡é‡Œé¢çš„ä»£ç è·å–å¤–é¢çš„å˜é‡ï¼‰ï¼Œæ‰€ä»¥å‡½æ•°å¤–éƒ¨å¹¶ä¸èƒ½è·å–åˆ°å‡½æ•°é‡Œé¢çš„å˜é‡vã€‚å› æ­¤è¯æ˜äº†jsä¸­åªæœ‰å‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸã€‚ã€€ã€€å†æ¥çœ‹ä¸‹é¢çš„ä¸€æ®µä»£ç ï¼š\nvar v&#x3D;&#39;hello&#39;;\nfunction show()&#123;\n  console.log(v); &#x2F;&#x2F;undefined\n  var v&#x3D;&#39;world&#39;;\n&#125;\nshow();\nã€€ã€€å¾ˆå¤šäººçœ‹åˆ°è¿™è¾¹éƒ½ä¼šå¾ˆç–‘æƒ‘ï¼Œä¸æ˜¯è¯´è¿™è¾¹showå‡½æ•°ä¸­èƒ½å¤Ÿè·å–åˆ°å‡½æ•°å¤–é¢çš„å˜é‡çš„ä¹ˆï¼Ÿä½†æ˜¯ç”±äºè¿™è¾¹æ˜¯ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œè€Œå‡½æ•°ä½œç”¨åŸŸå­˜åœ¨ç€å˜é‡å£°æ˜çš„æå‰ï¼Œå› æ­¤ï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºä¸‹é¢çš„ä»£ç ï¼š\nvar v&#x3D;&#39;hello&#39;;\nfunction show()&#123;\n\tvar v;\n\tconsole.log(v); &#x2F;&#x2F;undefined\n\tv&#x3D;&#39;world&#39;;\n&#125;\nshow();\nã€€ã€€è¿™é‡ŒæŠŠå˜é‡vçš„å£°æ˜æ”¾åˆ°äº†æ•´ä¸ªå‡½æ•°ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼Œå› æ­¤æ˜¾ç¤ºä¸ºundefinedã€‚ç†è§£äº†ä¸Šé¢çš„ä»£ç ï¼Œç›¸ä¿¡ä¸‹é¢çš„ä»£ç ä¹Ÿä¸éš¾ç†è§£äº†ã€‚\nvar v &#x3D; &quot;hello&quot;;\n(function()&#123;\n  console.log(v);\n  var v &#x3D; &quot;world&quot;;\n&#125;)();\n\nã€€ã€€åœ¨è¿™é‡Œè‡ªæ‰§è¡Œå‡½æ•°å½¢æˆäº†å‡½æ•°ä½œç”¨åŸŸ\néœ€è¦æ³¨æ„çš„æ˜¯å˜é‡æå‡åªæå‡å‡½æ•°çš„å£°æ˜ï¼Œå¹¶ä¸æå‡å‡½æ•°çš„å®šä¹‰\nshow(); &#x2F;&#x2F;show is not a function\nvar show&#x3D;function()&#123;\n\t&#x2F;&#x2F;...\n&#125;\nshow(); &#x2F;&#x2F;æˆåŠŸè¿è¡Œ\n\nã€€ã€€æˆ–è®¸æœ‰äººæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¿™è¾¹å®šä¹‰çš„å‡½æ•°å°±ä¸èƒ½æ‰§è¡Œå‘¢ï¼Ÿåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ˜ç™½å‡½æ•°åœ¨jsä¸­æ˜¯å¦‚ä½•è¿›è¡Œå®šä¹‰çš„ã€‚\n\n\n\n\n\n\n\n\n\nå‡½æ•°æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ï¼Œä¸€ç§æ˜¯å‡½æ•°å£°æ˜ï¼Œå¦ä¸€ç§æ˜¯å‡½æ•°è¡¨è¾¾å¼ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å‡½æ•°å£°æ˜ä»€ä¹ˆæ˜¯å‡½æ•°è¡¨è¾¾å¼å‘¢ï¼Ÿ\n&#x2F;&#x2F;å‡½æ•°å£°æ˜\nfunction show()&#123;\n\t&#x2F;&#x2F;....\n&#125;\n&#x2F;&#x2F;å‡½æ•°è¡¨è¾¾å¼\nvar show&#x3D;function()&#123;\n\t&#x2F;&#x2F;...\n&#125;\nä¹ä¸€çœ‹ï¼Œä»–ä»¬é•¿å¾—å¾ˆåƒï¼Œå†™æ³•éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚\n\njsçš„è§£æå™¨å¯¹å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼å¹¶ä¸æ˜¯ä¸€è§†åŒä»çš„å¯¹å¾…çš„ï¼Œæœ‰ç‚¹â€œç§æ—æ­§è§†â€çš„æ„æ€åœ¨é‡Œé¢ã€‚\nå‡½æ•°å£°æ˜å°±åƒæ˜¯â€œä¸€ç­‰å…¬æ°‘â€ï¼Œjsä¼šä¼˜å…ˆè¯»å–ï¼Œç¡®ä¿åœ¨æ‰§è¡Œå‰å°±å·²ç»è¢«è§£æäº†ï¼Œæ‰€ä»¥å‡½æ•°å£°æ˜æ”¾åœ¨å½“å‰ä½œç”¨åŸŸçš„ä»»ä½•åœ°æ–¹éƒ½èƒ½å¤Ÿè¢«è°ƒç”¨ï¼Œç”šè‡³æ”¾åˆ°è°ƒç”¨å‡½æ•°å£°æ˜ä¹‹åé¢ã€‚\nè€Œå‡½æ•°è¡¨è¾¾å¼å°±æ˜¾å¾—æ¯”è¾ƒâ€œæ™®é€šâ€ï¼Œå’Œä¸€èˆ¬çš„å˜é‡ä¸€æ ·ï¼Œåªæœ‰åˆ°æ‰§è¡Œåˆ°è¯¥è¡Œæ—¶æ‰è¿›è¡Œè§£æï¼Œå› æ­¤ï¼Œè°ƒç”¨å‡½æ•°è¡¨è¾¾å¼è¦åœ¨å®šä¹‰åè¿›è¡Œä½¿ç”¨ã€‚\n\notherhttps://juejin.cn/post/6844904019165446158\n","slug":"2022-05-08varible","date":"2022-05-08T02:00:00.000Z","categories_index":"é¢è¯•","tags_index":"é¢è¯•","author_index":"é™ˆæµ·é¾™"},{"id":"39b06ee79b8fd96256d44a33e065e573","title":"å¦‚ä½•æ›´å¥½çš„æ²‰æ·€","content":"èƒŒæ™¯\nå·¥ä½œæ—¥å¸¸ç»éªŒæ€§æ€»ç»“æ”¾å“ªï¼Ÿ\nå­˜ç”µè„‘ï¼Œç”µè„‘åäº†é‡åšç³»ç»Ÿæ²¡äº†ï¼Œ\næ”¾åˆ°ç”µè„‘å¤‡å¿˜å½•ï¼Œå§æ§½ï¼Œæ€ä¹ˆæ²¡åŠæ—¶æ›´æ–°\næ”¾è‡ªå·±çš„æœåŠ¡å™¨ï¼Œæ²¡æ—¶é—´æ‰“ç†ï¼ŒæœåŠ¡å™¨åˆ°æœŸï¼Œå—å±äº†ï¼Œæ²¡æ¥çš„åŠè¿ç§»\n\nhexo\nhexoç”±äºæœ‰ä¸°å¯Œçš„æ’ä»¶å’Œä¸»é¢˜ï¼Œä½¿ç”¨åŠéƒ¨ç½²æ–¹ä¾¿ï¼Œå¤‡å—æ¬¢è¿\nè‡ªå·±è´­ä¹°æœåŠ¡å™¨éƒ¨ç½²ï¼ŒæœåŠ¡å™¨åˆ°æœŸåç»­è´¹å¾ˆè´µ\næ”¾åˆ°ç¬¬ä¸‰æ–¹åšå®¢ä¸Šï¼Œå¥½ä¸€ç‚¹çš„åƒç®€ä¹¦ï¼Œæ¯å¤©å‘å¸ƒé™åˆ¶ä¸¤ç¯‡ï¼Œå¯æ§æ€§å¤ªå·®\n\nhexo ä¸»é¢˜è¿™é‡Œä½¿ç”¨ aurora\ntheme: aurora\ntridiamondAlphaHinex\né˜¿é‡Œäº‘oss\nå›¾ç‰‡èµ„æºæ”¾åˆ°githubä¸Šï¼Œè®¿é—®è¾ƒæ…¢ï¼Œä¸ºäº†æå‡ä½“éªŒï¼Œå°†èµ„æºæ”¾åˆ°ossä¸Šï¼Œæƒé™é…ç½®ä¸ºå…¬å¼€ï¼Œå¯è¢«ä»»ä½•ç”¨æˆ·è®¿é—®\n\né˜¿é‡Œäº‘åŸŸå\nåŸŸåè®¿é—®æ¯”è¾ƒæ–¹ä¾¿ï¼Œå›¾ç‰‡èµ„æºåªæœ‰åœ¨ä½¿ç”¨åŸŸåçš„æƒ…å†µä¸‹ï¼Œå„èµ„æºå¯ä»¥é¢„è§ˆï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸‹è½½\n\nPicGoå›¾åºŠã€Œè´¼å¥½ç”¨ï¼Œ\næ€è€ƒï¼šé™¤æ­¤ä¹‹å¤–ï¼Œå› ä¸ºå…¶å¼€æºæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‹ä½œè€…æ˜¯å¦‚ä½•å¤„ç†æ’ä»¶çš„ã€\nä¸ºåšå®¢ä¸­mdæ–‡æ¡£æä¾›å›¾ç‰‡é“¾æ¥ï¼Œæ”¾åˆ°é˜¿é‡Œäº‘ossä¸Š\nä¸Šä¼ æˆåŠŸ\nå› ä¸ºå¼€å‘è¿‡electronï¼Œç¬¬ä¸€æƒ³åˆ°çš„æ˜¯æˆ‘è¦debug,æ‰“å¼€æ§åˆ¶å°\nåŸŸåé…é”™ä¸å¯è®¿é—®\né‡åˆ°å›¾ç‰‡,ä½œä¸ºç¨‹åºçŒ¿ç¬¬ä¸€ååº”è¦ä¼˜åŒ–ã€Œå‹ç¼©ã€compress\næ’ä»¶ä¸‹è½½\næ’ä»¶å¯ç”¨\næ’ä»¶æ˜¯å¦ç”Ÿæ•ˆäº†\næ’ä»¶åˆ—è¡¨githubé“¾æ¥\n\nä¹¦å†™æ–‡ç«  hexoé¡µé¢ä¸çƒ­é‡è½½ï¼Ÿyarn add global browser-sync\nyarn add hexo-browsersync\n\nå¯ç”¨è¯„è®º# For local development only!\ngitalk:\n  enable: false\n  autoExpand: true\n  clientID: &#39;&#39;\n  clientSecret: &#39;&#39;\n  repo: &#39;dev-blog-comments&#39;\n  owner: &#39;TriDiamond&#39;\n  admin: [&#39;TriDiamond&#39;]\n  id: uid\n  language: en\n  distractionFreeMode: true\n  recentComment: true\n  proxy: &#39;&#39;\n\n# Valine comment plugin (recommended!)\n# see https:&#x2F;&#x2F;valine.js.org&#x2F;quickstart.html\nvaline:\n  enable: true\n  app_id: å»ç”³è¯·\n  app_key: å»ç”³è¯·\n  avatar: &#39;http:&#x2F;&#x2F;t-blog-images.aijs.top&#x2F;img&#x2F;avatar.jpeg&#39;\n  placeholder: Leave your thoughts behind~\n  visitor: true\n  lang: en\n  avatarForce: false\n  meta: [&#39;nick&#39;, &#39;mail&#39;]\n  requiredFields: []\n  admin: &#39;æµ·é¾™&#39;\n  recentComment: true\n\n\nå›¾ç‰‡å¢åŠ æ°´å°é…ç½®åŠæ•ˆæœ\npicgoç”Ÿæˆä»£ç \nå¯é€‰ä¸åŒçš„ä»£ç æ–¹å¼\n\nå¸¸è§é—®é¢˜\næ¯æ¬¡å‘å¸ƒåï¼Œgithub page è‡ªå®šä¹‰åŸŸåä¼šä¸¢å¤±\n\n\n\n\n\n\n\n\nåœ¨_postsç›®å½•ä¸‹å»ºç«‹CNAMEæ–‡ä»¶ å¡«å†™ä¸Šè‡ªå·±çš„åŸŸå\n\nå›¾åºŠpicGoï¼Œä¸Šä¼ äº†å›¾ç‰‡ï¼Œåœ¨ossä¸ŠæŸ¥çœ‹ä¹ŸæˆåŠŸäº†ï¼Œä½†æ˜¯picGoç›¸å†Œä¸­æ²¡æœ‰å±•ç¤º\n\n\n\n\n\n\n\n\n/Users/chenhailong/Library/Application Support/picgoç›®å½•ä¸‹ï¼Œåˆ é™¤ rm picgo.db,é‡æ–°å¯åŠ¨è§issue #781\n\nè°ƒæ•´åšå®¢æ–‡ä»¶æ—¶é—´ï¼Œè¿è¡Œåæ–‡ç« æ’åºå¹¶æ²¡æœ‰æ”¹å˜ï¼Œéœ€è¦æ¸…ç†æ ¹ç›®å½•ä¸‹db.json\n\næ€»ç»“ï¼šæ€»ä½“è€Œè¨€picgoå·²ç»å¾ˆå¥½äº†ï¼Œæœ‰å‡ ç‚¹å¯ä»¥ä¼˜åŒ–\n\nå·²æœ‰å›¾ç‰‡äºŒæ¬¡é‡æ–°ä¸Šä¼ å‹ç¼©åŠŸèƒ½\nçª—å£å®åœ¨æ˜¯å¤ªå°äº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥æ‰‹åŠ¨æ‹–æ‹½æ”¹å˜å¤§å°\næ’ä»¶åˆ—è¡¨æ’ä»¶å¡ç‰‡éƒ¨åˆ†é‡å \n\n","slug":"2022-04-28åšå®¢åˆ›å»º","date":"2022-05-06T01:17:27.000Z","categories_index":"","tags_index":"","author_index":"é™ˆæµ·é¾™"},{"id":"4e47b6e9bf7ea41cfbf0d4f0a3fe5d3c","title":"Lernaè°ƒè¯•å¼€æºåº“é‡åˆ°çš„é—®é¢˜","content":"yarn install --mutex network:42424 --non-interactive\n\nğŸ‘‘ ~&#x2F;Desktop&#x2F;slate git:(main) $ lerna --version\n4.0.0\n\n\nğŸ‘‘ ~&#x2F;Desktop&#x2F;slate git:(main) $ yarn global add lerna@3.19.0    \nUsage Error: The &#39;yarn global&#39; commands have been removed in 2.x - consider using &#39;yarn dlx&#39; or a third-party plugin instead\n\n$ yarn run [--inspect] [--inspect-brk] &lt;scriptName&gt; ...\nğŸ‘‘ ~&#x2F;Desktop&#x2F;slate git:(main) $ yarn --version              \n3.0.1","slug":"2022-05-05lerna","date":"2022-05-05T13:30:47.000Z","categories_index":"å·¥å…·","tags_index":"å·¥å…·","author_index":"é™ˆæµ·é¾™"},{"id":"80947b2a66ed033838be54dc8f90264b","title":"MACå­˜å‚¨ç©ºé—´ä¸è¶³é—®é¢˜","content":"\n","slug":"2022-05-05mac","date":"2022-05-05T13:30:47.000Z","categories_index":"å·¥å…·","tags_index":"å·¥å…·","author_index":"é™ˆæµ·é¾™"},{"id":"462f06ba8f007318cafbef853cf322ba","title":"Stringç›¸å…³é¢è¯•ä»£ç ","content":"è½¬åŒ–ä¸ºé©¼å³°å‘½å\n\n\n\n\n\n\n\n\nvar s1 = &quot;get-element-by-id&quot;\nvar f &#x3D; function (s) &#123;\n  return s.replace(&#x2F;-\\w&#x2F;g, function (x) &#123;\n    return x.splice(1).toUpperCase();\n  &#125;);\n&#125;;\n\næ¨¡ç‰ˆå¼•æ“å®ç°let template &#x3D; &quot;æˆ‘æ˜¯&#123;&#123;name&#125;&#125;,å¹´é¾„&#123;&#123;age&#125;&#125;,æ€§åˆ«&#123;&#123;sex&#125;&#125;&quot;;\nlet data &#x3D; &#123;\n  name: &quot;å§“å&quot;,\n  age: 18,\n&#125;;\n\nrender(template, data); &#x2F;&#x2F;æˆ‘æ˜¯å§“å,å¹´é¾„18,æ€§åˆ«undefined\n\nfunction render(template, data) &#123;\n  &#x2F;&#x2F; æ¨¡ç‰ˆå­—ç¬¦ä¸²æ­£åˆ™\n  const resg &#x3D; &#x2F;\\&#123;\\&#123;(\\w+)\\&#125;\\&#125;&#x2F;;\n  &#x2F;&#x2F; åˆ¤æ–­æ¨¡ç‰ˆé‡Œæ˜¯å¦æœ‰æ¨¡ç‰ˆå­—ç¬¦ä¸²\n  if (reg.test(template)) &#123;\n    &#x2F;&#x2F; æŸ¥æ‰¾å½“å‰æ¨¡ç‰ˆé‡Œç¬¬ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„å­—ç¬¦\n    const name &#x3D; reg.exec(template)[1];\n    &#x2F;&#x2F; å°†ç¬¬ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²æ¸²æŸ“\n    template &#x3D; template.replace(reg, data[name]);\n    &#x2F;&#x2F; é€’å½’çš„æ¸²æŸ“å¹¶è¿”å›æ¸²æŸ“åçš„ç»“æ„\n    return render(template, data);\n  &#125;\n&#125;\n\nè§£æ URL Params ä¸ºå¯¹è±¡let url &#x3D;\n  &quot;http:&#x2F;&#x2F;www.domain.com&#x2F;?user&#x3D;anonymouse&amp;id&#x3D;123&amp;id&#x3D;456&amp;city&#x3D;%E5%8C%97%E4%BA%AC&amp;enabled&quot;;\n\n&#x2F;**\n * ç»“æœ\n * &#123;\n *  user: &#39;anonymouse&#39;,\n *  id: [123,456], &#x2F;&#x2F; é‡å¤å‡ºç°çš„keyï¼Œè¦è½¬åŒ–æˆæ•°ç»„\n *  city: &#39;åŒ—äº¬&#39;, &#x2F;&#x2F; ä¸­æ–‡éœ€è¦è§£ç \n *  enabled: true &#x2F;&#x2F; æœªæŒ‡å®šå€¼çš„keyï¼Œçº¦å®šä¸ºtrue\n *\n *\n * &#125;\n *\n **&#x2F;\nfunction paramParam(url) &#123;\n  const paramsStr &#x3D; &#x2F;.+\\?(.+)$&#x2F;.exec(url)[1];\n  const paramsArr &#x3D; paramsArr.split(&quot;&amp;&quot;);\n  let paramsObj &#x3D; &#123;&#125;;\n\n  paramsArr.forEach((param) &#x3D;&gt; &#123;\n    if (&#x2F;&#x3D;&#x2F;.test(param)) &#123;\n      let [key, val] &#x3D; param.split(&quot;&#x3D;&quot;); &#x2F;&#x2F; æ‹†åˆ†é”®&#x2F;å€¼\n      val &#x3D; decodeURLComponent(val); &#x2F;&#x2F; æ±‰å­—è§£ç \n      val &#x3D; &#x2F;^\\d+$&#x2F;.test(val) ? parseFloat(val) : val; &#x2F;&#x2F; æ•°å­—è½¬åŒ–\n      if (paramsObj.hasOwnProperty(key)) &#123;\n        paramsObj[key] &#x3D; [].concat(paramsObj[key], val); &#x2F;&#x2F; é‡å¤keyè½¬æ•°ç»„\n      &#125; else &#123;\n        paramsObj[key] &#x3D; val;\n      &#125;\n    &#125; else &#123;\n      paramsObj[key] &#x3D; true; &#x2F;&#x2F; å¤„ç†çº¦å®š\n    &#125;\n  &#125;);\n&#125;\n\næŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ï¼Œå‡ºç°æœ€å¤šçš„å­—ç¬¦å’Œä¸ªæ•°let str &#x3D; &quot;abcabcabcbbcccc&quot;;\nlet num &#x3D; 0;\nlet char &#x3D; &quot;&quot;;\n\n&#x2F;&#x2F; å…ˆæ’åºï¼Œåç”¨æ­£åˆ™å¤„ç†ä¸ªæ•°\n\nstr &#x3D; str.split(&quot;&quot;).sort().join(&quot;&quot;);\n\nlet re &#x3D; &#x2F;(\\w)\\1+&#x2F;g;\n\nstr.replace(re, ($0, $1) &#x3D;&gt; &#123;\n  if (num &lt; $0.length) &#123;\n    num &#x3D; $0.length;\n    char &#x3D; $1;\n  &#125;\n&#125;);\n\nå­—ç¬¦ä¸²æŸ¥æ‰¾a &#x3D; &quot;34&quot;;\nb &#x3D; &quot;1234567&quot;; &#x2F;&#x2F; è¿”å›2\na &#x3D; &quot;35&quot;;\nb &#x3D; &quot;1234567&quot;; &#x2F;&#x2F; è¿”å› -1\na &#x3D; &quot;355&quot;;\nb &#x3D; &quot;1234355&quot;; &#x2F;&#x2F; è¿”å›5\n\nfunction isContain(a, b) &#123;\n  for (let i in b) &#123;\n    if (a[0] &#x3D;&#x3D;&#x3D; b[i]) &#123;\n      let tmp &#x3D; true;\n      for (let j in a) &#123;\n        if (a[j] !&#x3D;&#x3D; b[~~i + ~~j]) &#123;\n          tmp &#x3D; false;\n        &#125;\n      &#125;\n      if (tmp) &#123;\n        return i;\n      &#125;\n    &#125;\n  &#125;\n  return -1;\n&#125;\n\nå®ç°åƒåˆ†ä½åˆ†éš”ç¬¦&#x2F;&#x2F; ä¿ç•™ä¸‰ä½å°æ•°\nparaseToMoney(1234.56); &#x2F;&#x2F; return &#39;1,234.56&#39;\nparaseToMoney(123456789); &#x2F;&#x2F; return 123,456,789\nparaseToMoney(1087654.321); &#x2F;&#x2F; return 1,087,654.321\n\nfunction paraseToMoney(params) &#123;\n  num &#x3D; parseFloat(num.toFixed(3));\n  let [integer, decimal] &#x3D; String.prototype.split.call(num, &quot;.&quot;);\n  integer &#x3D; integer.replace(&#x2F;\\d(?&#x3D;(\\d&#123;3&#125;))+$&#x2F;, &quot;$&amp;,&quot;);\n  return integer + &quot;.&quot; + (decimal ?? &quot;&quot;);\n&#125;\n\nåˆ¤æ–­æ˜¯å¦æ˜¯ç”µè¯å·ç function isPhone(str) &#123;\n  let regx &#x3D; &#x2F;^1[34578]\\d&#123;9&#125;$&#x2F;;\n  return regx.test(str);\n&#125;\n\nåˆ¤æ–­æ˜¯å¦æ˜¯é‚®ç®±function isEmail(mail) &#123;\n  var regx &#x3D; &#x2F;^(a-zA-Z0-9_\\-)+@(a-zA-Z0-9_\\-)+(\\.[a-zA-Z0-9_\\-])+$&#x2F;;\n\n  return regx.test(email);\n&#125;\n\næ ¡éªŒèº«ä»½è¯function isCard(number) &#123;\n  var regx &#x3D; &#x2F;(^\\d&#123;15&#125;$)|(^\\d&#123;17&#125;(\\d|X|x)$)&#x2F;;\n\n  return regx.test(number);\n&#125;\n","slug":"2022-05-03string","date":"2022-05-04T00:00:00.000Z","categories_index":"å‰ç«¯","tags_index":"å‰ç«¯","author_index":"é™ˆæµ·é¾™"},{"id":"be2d536c56c87a429a3dc062a6c5cd1f","title":"æ¶æ„è®¾è®¡å¼•å‘çš„è¡€æ¡ˆ","content":"è®°å½•ä¸ªbug,å¹¶åœ¨æ­¤æ–‡ä¸­è§„é¿æ­¤å¤„è®°ä¸‹ hexo-theme-aurora æºç bugï¼Œæ²¡ç©ºæ—¶å€™å¸®ä»–æ”¹\n.article .article-content p &#123;\n    font-size: .875rem;\n    line-height: 1.25rem;\n    margin-bottom: 0.5rem;\n    padding-bottom: 1rem;\n    word-break: break-all;\n&#125;\nbugå¤ç°\n(node:29) UnhandledPromiseRejectionWarning: Error: Forbidden\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Object.getDataReport (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11494:19)\n    at async Promise.all (index 3)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\n(Use &#96;node --trace-warnings ...&#96; to show where the warning was created)\n(node:29) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag &#96;--unhandled-rejections&#x3D;strict&#96; (see https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;cli.html#cli_unhandled_rejections_mode). (rejection id: 19)\n(node:29) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n(node:29) UnhandledPromiseRejectionWarning: Error: Forbidden\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Object.getDataReport (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11494:19)\n    at async Promise.all (index 3)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\n(node:29) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag &#96;--unhandled-rejections&#x3D;strict&#96; (see https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;cli.html#cli_unhandled_rejections_mode). (rejection id: 44)\nError: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Object.refreshPendingPerformanceNum (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11487:25)\n    at async Promise.all (index 2)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\nError: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Promise.all (index 0)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\nError: Forbidden\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Object.getDataReport (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11494:19)\n    at async Promise.all (index 3)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\nError: Forbidden\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Promise.all (index 0)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\nError: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Promise.all (index 0)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\nError: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Object.refreshPendingPerformanceNum (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11487:25)\n    at async Promise.all (index 2)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)\n\n\næºä»£ç const [resp] &#x3D; await Promise.all([\n  getLoginInfo(ctx),\n  CommonModel.effects.refreshPendingObjectiveNum(req, ctx),\n  CommonModel.effects.refreshPendingPerformanceNum(req, ctx),\n  CommonModel.effects.getDataReport(req, ctx),\n])\n\nif (resp.success) &#123;\n  UserModal.actions.setUser(resp.result, req)\n&#125;\nå¢åŠ å¼‚å¸¸æ•è·const [resp] &#x3D; await Promise.all([\n  getLoginInfo(ctx),\n  CommonModel.effects.refreshPendingObjectiveNum(req, ctx),\n  CommonModel.effects.refreshPendingPerformanceNum(req, ctx),\n  CommonModel.effects.getDataReport(req, ctx),\n]).catch(e&#x3D;&gt;&#123;\n  console.log(&quot;å‘ç”Ÿé”™è¯¯&quot;)\n  console.log(e)\n&#125;)\næ—¥å¿—æ—¥å¿—ä»… Forbidden æœ‰æ•ˆä¿¡æ¯ï¼Œå¤§æ¦‚æ˜¯æ¥å£\nå‘ç”Ÿé”™è¯¯\nError: Forbidden\n    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-7be1c2d9b56a41e863e3.js:13144:29\n    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)\n    at async Promise.all (index 0)\n    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-7be1c2d9b56a41e863e3.js:12208:22)\n\n\n\næ€»ç»“ï¼š\nå› ä¸ºacl ä¼ä¸šæƒé™æ•´äº†180å¤©ï¼ˆé¡¶é…ï¼‰ï¼Œæ—¶ä¸æ—¶å°±å‡ºç°ç³»ç»Ÿç˜«ç—ªçš„æƒ…å†µï¼Œæ—¥å¸¸ã€çº¿ä¸Šéƒ½æœ‰æ­¤é—®é¢˜è¿™æ¶æ„è®¾è®¡çš„ï¼Œä¼°è®¡æ²¡è°äº†ã€‚å®Œå…¨å¯ä»¥æ”¹æˆç¦»èŒåï¼Œç³»ç»Ÿè‡ªåŠ¨å°†ç”¨æˆ·ç¦æƒå³å¯\né™¤æ­¤ä¹‹å¤–ï¼Œssoä¹Ÿæœ‰ä¸ªé€šç—…ï¼Œä¸‰ä¸ªæœˆæ²¡æ”¹è¿‡å¯†ç ï¼Œç”¨æˆ·è´¦æˆ·æ— æ³•ç™»å½•ï¼Œéœ€è¦é‡æ–°å¯†ç æ–¹å¯ç™»å½•\n\n","slug":"2022-04-29nextjs","date":"2022-04-29T02:56:00.000Z","categories_index":"bug","tags_index":"bug","author_index":"é™ˆæµ·é¾™"},{"id":"ea6c6af45eb8fb66a729fbe0ec8cd8f3","title":"Nestjs ç»“åˆ knife4j","content":"nest-knife4jknife4j githubknife4j æ–‡æ¡£knife4jå¯ä»¥ç†è§£ä¸ºä¸€å¥—swaggerçš®è‚¤ï¼Œä¸ä½¿ç”¨knife4jé»˜è®¤æ˜¯swagger 1ç‰ˆæœ¬çš„æ ·å¼\n","slug":"2022-02-29node","date":"2022-03-01T11:55:47.000Z","categories_index":"Node","tags_index":"Node","author_index":"é™ˆæµ·é¾™"},{"id":"0523d16168244c5c50ce4e647b1f2e1c","title":"Nestjsæ–‡ä»¶ä¸Šä¼ ","content":"æ–‡ä»¶ä¸Šä¼ Nestjs ä¸Šä¼ æ–‡ä»¶Nestjs ä¸Šä¼ æ–‡ä»¶\n","slug":"2022-02-28node","date":"2022-02-28T12:55:47.000Z","categories_index":"Node","tags_index":"Node","author_index":"é™ˆæµ·é¾™"},{"id":"517bb0f5aa3a9a70442efc92a9ecc4e8","title":"React æ‹–æ‹½å…¼å®¹","content":"æ‹–æ‹½åœ¨web pc ç«¯ã€iframeã€h5ç§»åŠ¨ç«¯å­˜åœ¨å·®å¼‚\nweb pc ç«¯æ”¯æŒï¼šonMouseDownã€onMouseUpã€onMousemoveã€onDragStartã€onDragEndã€nDragOver\niframe web pc ç«¯æ”¯æŒï¼šonMouseDownã€onMouseUpã€onMousemove\nh5ç§»åŠ¨ç«¯æ”¯æŒï¼šonTouchStartã€onTouchEndã€onTouchmoveä»£ç \n\nexport default function Draggable(props: Props) &#123;\n  const &#123; children, style, className, onDragFinish, onDraggingStart, onPositionGet, boundary &#x3D; &#123; x: MARGIN_TO_PAGE, y: MARGIN_TO_PAGE &#125; &#125; &#x3D; props\n  const [dragging, setDragging] &#x3D; useState(false)\n  const [attaching, setAttaching] &#x3D; useState(false)\n  const [top, setTop] &#x3D; useState(0)\n  const [left, setLeft] &#x3D; useState(0)\n  const ghostRef: MutableRefObject&lt;HTMLDivElement&gt; &#x3D; useRef()\n  const elRef: MutableRefObject&lt;HTMLDivElement&gt; &#x3D; useRef()\n\n  const onDragStart &#x3D; useCallback((e: DragEvent&lt;HTMLDivElement&gt; | TouchEvent&lt;HTMLDivElement&gt;) &#x3D;&gt; &#123;\n    let x\n    let y\n    if (isDrag(e)) &#123;\n      if (e.target !&#x3D;&#x3D; elRef.current) &#123;\n        return\n      &#125;\n      e.dataTransfer.setDragImage(emptyImg, 0, 0)\n      x &#x3D; e.clientX\n      y &#x3D; e.clientY\n    &#125; else &#123;\n      if (!e.target || !(e.target instanceof HTMLElement)) &#123;\n        return\n      &#125;\n      if (!parentHasClass(e.target, [rootStyles.feedbackRoot])) &#123;\n        return\n      &#125;\n      x &#x3D; e.touches[0].clientX\n      y &#x3D; e.touches[0].clientY\n    &#125;\n    e.stopPropagation()\n\n\n    const rect &#x3D; e.currentTarget.getBoundingClientRect()\n    const offsetX &#x3D; x - rect.x\n    const offsetY &#x3D; y - rect.y\n    setTop(rect.y)\n    setLeft(rect.x)\n    setDragging(true)\n\n    if (isDrag(e)) &#123;\n      dragoverHandle &#x3D; (event: DragEvent) &#x3D;&gt; &#123;\n        if (event.clientX || event.clientY) &#123;\n          setTop(event.clientY - offsetY)\n          setLeft(event.clientX - offsetX)\n        &#125;\n      &#125;\n      &#x2F;&#x2F; firefox ä¸­ï¼Œondrag æ‹¿ä¸åˆ°é¼ æ ‡çš„åæ ‡ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ document çš„ dragover\n      document.addEventListener(&#39;dragover&#39;, dragoverHandle)\n    &#125; else &#123;\n      dragoverHandle &#x3D; (event: TouchEvent) &#x3D;&gt; &#123;\n        const touch &#x3D; event.touches[0]\n        if (touch.clientX || touch.clientY) &#123;\n          setTop(touch.clientY - offsetY)\n          setLeft(touch.clientX - offsetX)\n        &#125;\n      &#125;\n      document.addEventListener(&#39;touchmove&#39;, dragoverHandle)\n    &#125;\n    onDraggingStart()\n  &#125;, [])\n\n  const onDragEnd &#x3D; useCallback((event) &#x3D;&gt; &#123;\n    if (!ghostRef.current) &#123;\n      setDragging(false)\n      return\n    &#125;\n    const rect &#x3D; ghostRef.current.getBoundingClientRect()\n    const &#123; rel, abs &#125; &#x3D; calcAttachSide(rect, boundary)\n\n    setTop(abs.top)\n    setLeft(abs.left)\n    setAttaching(true)\n\n    if (isDrag(event)) &#123;\n      document.removeEventListener(&#39;dragover&#39;, dragoverHandle)\n    &#125; else &#123;\n      document.removeEventListener(&#39;touchmove&#39;, dragoverHandle)\n    &#125;\n\n    &#x2F;&#x2F; onPosition &amp;&amp; onPosition(rel) &#x2F;&#x2F; å…¶ä»–ä¸šåŠ¡\n\n\n    dragoverHandle &#x3D; null\n\n    setTimeout(() &#x3D;&gt; &#123;\n      onDragFinish(rel)\n      setAttaching(false)\n      setDragging(false)\n    &#125;, 300)\n  &#125;, [])\n\n  const onMousedown &#x3D; useCallback((e) &#x3D;&gt; &#123;\n    const x &#x3D; e.clientX\n    const y &#x3D; e.clientY\n    const rect &#x3D; e.currentTarget.getBoundingClientRect()\n    const offsetX &#x3D; x - rect.x\n    const offsetY &#x3D; y - rect.y\n    setTop(rect.y)\n    setLeft(rect.x)\n    setDragging(true)\n    if (e.preventDefault) &#123;\n      e.preventDefault()\n    &#125; else &#123;\n      e.returnValue &#x3D; false\n    &#125;\n    document.onmousemove &#x3D; function (ev: any) &#123;\n      const _event &#x3D; ev || window.event\n      const endx &#x3D; _event.clientX - offsetX\n      const endy &#x3D; _event.clientY - offsetY\n      setTop(endy)\n      setLeft(endx)\n    &#125;\n  &#125;, [])\n\n  const onMouseup &#x3D; useCallback((e) &#x3D;&gt; &#123;\n    if (!ghostRef.current) &#123;\n      setDragging(false)\n      return\n    &#125;\n    const rect &#x3D; ghostRef.current.getBoundingClientRect()\n    const &#123; rel, abs &#125; &#x3D; calcAttachSide(rect, boundary)\n\n    setTop(abs.top)\n    setLeft(abs.left)\n    setAttaching(true)\n\n    document.onmousemove &#x3D; null\n    onPositionGet &amp;&amp; onPositionGet(rel)\n    setTimeout(() &#x3D;&gt; &#123;\n      onDragFinish(rel)\n      setAttaching(false)\n      setDragging(false)\n    &#125;, 300)\n  &#125;, [])\n &#x2F;&#x2F; èƒ½åŠ›æ£€æµ‹\n  if (&#39;dragover&#39; in document.documentElement || &#39;ontouchstart&#39; in document.documentElement) &#123;\n    return (\n      &lt;div\n        style&#x3D;&#123;style&#125;\n        className&#x3D;&#123;className&#125;\n        draggable\n        onTouchStart&#x3D;&#123;onDragStart&#125;\n        onTouchEnd&#x3D;&#123;onDragEnd&#125;\n        onDragStart&#x3D;&#123;onDragStart&#125;\n        onDragEnd&#x3D;&#123;onDragEnd&#125;\n        onDragOver&#x3D;&#123;prevent&#125;\n        ref&#x3D;&#123;elRef&#125;\n      &gt;\n        &lt;div\n          style&#x3D;&#123;dragging ? &#123; top, left &#125; : null&#125;\n          className&#x3D;&#123;cn(&#123;\n            [styles.dragging]: dragging,\n            [styles.attaching]: attaching,\n          &#125;)&#125;\n          ref&#x3D;&#123;ghostRef&#125;\n        &gt;\n          &#123;children&#125;\n        &lt;&#x2F;div&gt;\n      &lt;&#x2F;div&gt;\n    )\n  &#125;\n  return (\n    &lt;div\n      style&#x3D;&#123;style&#125;\n      className&#x3D;&#123;className&#125;\n      draggable\n      onMouseDown&#x3D;&#123;onMousedown&#125;\n      onMouseUp&#x3D;&#123;onMouseup&#125;\n      ref&#x3D;&#123;elRef&#125;\n    &gt;\n      &lt;div\n        style&#x3D;&#123;dragging ? &#123; top, left &#125; : null&#125;\n        className&#x3D;&#123;cn(&#123;\n          [styles.dragging]: dragging,\n          [styles.attaching]: attaching,\n        &#125;)&#125;\n        ref&#x3D;&#123;ghostRef&#125;\n      &gt;\n        &#123;children&#125;\n      &lt;&#x2F;div&gt;\n    &lt;&#x2F;div&gt;\n  )\n&#125;","slug":"2022-02-27react","date":"2022-02-27T13:30:47.000Z","categories_index":"React","tags_index":"React","author_index":"é™ˆæµ·é¾™"},{"id":"4bcdaa6034eed07b809bf3bc6eec819f","title":"React DOM","content":"17.0.0 (October 20, 2020)\n\n\n\n\n\n\n\n\nDelegate events to roots instead of documentæ¥çœ‹ä¸‹åŸå› \n\n\n\n\n\n\n\n\n\nReactè‡ªé¦–æ¬¡å‘å¸ƒä»¥æ¥ä¸€ç›´åœ¨è‡ªåŠ¨æ‰§è¡Œäº‹ä»¶å§”æ´¾ã€‚å®ƒç›´æ¥åœ¨æ–‡æ¡£èŠ‚ç‚¹ä¸Šä¸ºæ¯ä¸ªäº‹ä»¶ç±»å‹é™„åŠ ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚\n\n\n\n\n\n\n\n\n\nè™½ç„¶å®ƒæé«˜äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œä½†ç”±äºæ–‡æ¡£èŠ‚ç‚¹ä¸Šçš„äº‹ä»¶å§”æ´¾ï¼Œå·²ç»æŠ¥å‘Šäº†è®¸å¤šé—®é¢˜ã€‚\n\n\n\n\n\n\n\n\n\nä¸ºäº†æ¼”ç¤ºå…¶ä¸­ä¸€ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬ä»¥selectä¸‹æ‹‰åˆ—è¡¨ä¸ºä¾‹ã€‚ä¸‹é¢ç¤ºä¾‹ä¸­çš„CountryDropDownæ˜¯ç”¨äºå›½å®¶é€‰æ‹©çš„Reactç»„ä»¶ï¼Œå®ƒå°†è¢«å‘ˆç°ç»™idä¸ºReact rootçš„divã€‚react DOMå®¹å™¨å°è£…åœ¨idä¸ºmainçš„divä¸­ï¼Œè¯¥divæœ‰ä¸€ä¸ªåŒ…å«stopPropagationï¼ˆï¼‰çš„æ›´æ”¹äº‹ä»¶ã€‚\n&lt;!--Div&#39;s change event contains stopPropagation()--&gt;\n&lt;div id&#x3D;&quot;main&quot;&gt;\n  &lt;!--Div where react component will be rendered --&gt;\n  &lt;div id&#x3D;&quot;react-root&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;div&gt;\n\n\nclass CountryDropDown extends React.Component &#123;\n  state &#x3D; &#123;\n    country: &#39;&#39;,\n  &#125;\n  const handleChange &#x3D; e &#x3D;&gt; &#123;\n    this.setState(&#123; country: e.target.value &#125;);\n  &#125;\n  render() &#123;\n    return (\n      &lt;table class&#x3D;&quot;table table-striped table-condensed&quot;&gt;\n        &lt;thead&gt;\n          &lt;tr&gt;\n            &lt;th&gt;Country&lt;&#x2F;th&gt;\n            &lt;th&gt;Selected country&lt;&#x2F;th&gt;\n          &lt;&#x2F;tr&gt;\n        &lt;&#x2F;thead&gt;\n        &lt;tbody&gt;\n          &lt;tr&gt;\n            &lt;td&gt;\n              &lt;select value&#x3D;&#123;this.state.country&#125;\n                onChange&#x3D;&#123;this.handleChange&#125;\n              &gt;\n                &lt;option value&#x3D;&quot;&quot;&gt;--Select--&lt;&#x2F;option&gt;\n                &lt;option value&#x3D;&quot;India&quot;&gt;India&lt;&#x2F;option&gt;\n                &lt;option value&#x3D;&quot;US&quot;&gt;US&lt;&#x2F;option&gt;\n                &lt;option value&#x3D;&quot;Dubai&quot;&gt;Dubai&lt;&#x2F;option&gt;\n              &lt;&#x2F;select&gt;\n            &lt;&#x2F;td&gt;\n            &lt;td&gt;\n              &#123;this.state.country&#125;\n            &lt;&#x2F;td&gt;\n          &lt;&#x2F;tr&gt;\n        &lt;&#x2F;tbody&gt;\n      &lt;&#x2F;table&gt;\n    );\n  &#125;\n&#125;\nReactDOM.render(&lt;CountryDropDown &#x2F;&gt;, document.getElementById(&#39;react-root&#39;));\n\n\n\n\n\n\n\n\n\n\nå°†æ›´æ”¹äº‹ä»¶é™„åŠ åˆ°ä¸»div\ndocument.getElementById(&quot;main&quot;).addEventListener(\n  &quot;change&quot;,\n  function (e) &#123;\n    e.stopPropagation();\n  &#125;,\n  false\n);\n\n\n\n\n\n\n\n\n\nå½“é€‰æ‹©ä¸€ä¸ªå›½å®¶æ—¶ï¼Œæˆ‘ä»¬æ— æ³•çœ‹åˆ°æ‰€é€‰çš„å›½å®¶\n\n\n\n\n\n\n\n\n\næ­¤æ„å¤–è¡Œä¸ºçš„åŸå› æ˜¯é™„åŠ åˆ°æ–‡æ¡£èŠ‚ç‚¹çš„onChange dropdownäº‹ä»¶ã€‚åŒ…å«e.stopPropagationï¼ˆï¼‰çš„ä¸»divçš„changeäº‹ä»¶é˜»æ­¢äº†ä¸‹æ‹‰èœå•çš„onChangeäº‹ä»¶ã€‚\n\n\n\n\n\n\n\n\n\nä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜ï¼ŒReact 17ä¸å†åœ¨æ–‡æ¡£çº§åˆ«é™„åŠ äº‹ä»¶å¤„ç†ç¨‹åºã€‚ç›¸åï¼Œå®ƒå°†å®ƒä»¬é™„åŠ åˆ°æ ¹DOMå®¹å™¨ä¸­ï¼ŒReactæ ‘å°†è¢«æ¸²æŸ“åˆ°è¯¥å®¹å™¨ä¸­ã€‚\n\n\n\n\n\n\n\n\n\nåœ¨React 17ä¸­è¿›è¡Œæ›´æ”¹åï¼Œäº‹ä»¶è¢«é™„åŠ åˆ°æ ¹DOMå®¹å™¨ï¼ŒReactæ ‘è¢«å‘ˆç°åˆ°è¯¥å®¹å™¨ä¸­ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒonChangeäº‹ä»¶çš„ä¸‹æ‹‰åˆ—è¡¨å°†é™„åŠ åˆ°idä¸ºreact rootçš„divã€‚å½“é€‰æ‹©ä»»ä½•å›½å®¶&#x2F;åœ°åŒºå‘ˆç°é¢„æœŸè¡Œä¸ºæ—¶ï¼Œå°†è§¦å‘æ­¤äº‹ä»¶ã€‚\n","slug":"2022-05-04react","date":"2022-02-27T13:30:47.000Z","categories_index":"React","tags_index":"React","author_index":"é™ˆæµ·é¾™"},{"id":"0fe71bf4ca9007e9b607927107758aa8","title":"Sentryé”™è¯¯æ—¥å¿—è·å–","content":"\nå…ˆä¸Šå›¾\n\n\n\nThis is a quick getting started guide. For in-depth instructions on integrating Sentry withÂ React, viewÂ our complete documentation.\nTo instrument your React application with Sentry, first install theÂ @sentry/reactÂ andÂ @sentry/tracingÂ packages:\n# Using yarn\nyarn add @sentry&#x2F;react @sentry&#x2F;tracing\n\n# Using npm\nnpm install --save @sentry&#x2F;react @sentry&#x2F;tracing\n\nNext, import and initialize the Sentry module as early as possible, before initializing React:\nimport React from &quot;react&quot;;\nimport ReactDOM from &quot;react-dom&quot;;\nimport * as Sentry from &quot;@sentry&#x2F;react&quot;;\nimport &#123; Integrations &#125; from &quot;@sentry&#x2F;tracing&quot;;\nimport App from &quot;.&#x2F;App&quot;;\n\nSentry.init(&#123;\n  dsn: &quot;https:&#x2F;&#x2F;a5f1c39789b24bb7a434868b677e0c65@&#x2F;1063&quot;,\n  integrations: [new Integrations.BrowserTracing()],\n\n  &#x2F;&#x2F; Set tracesSampleRate to 1.0 to capture 100%\n  &#x2F;&#x2F; of transactions for performance monitoring.\n  &#x2F;&#x2F; We recommend adjusting this value in production\n  tracesSampleRate: 1.0,\n&#125;);\n\nReactDOM.render(&lt;App &#x2F;&gt;, document.getElementById(&quot;root&quot;));\n\n&#x2F;&#x2F; Can also use with React Concurrent Mode\n&#x2F;&#x2F; ReactDOM.createRoot(document.getElementById(&#39;root&#39;)).render(&lt;App &#x2F;&gt;);\n\nThe above configuration captures both error and performance data. To reduce the volume of performance data captured, changeÂ tracesSampleRateÂ to a value between 0 and 1.\nAfter this step, Sentry will report any uncaught exceptions triggered by your application.\nYou can trigger your first event from your development environment by raising an exception somewhere within your application. An example of this would be rendering a button whoseÂ onClickÂ handler attempts to invoke a method that does not exist:\nreturn &lt;button onClick&#x3D;&#123;methodDoesNotExist&#125;&gt;Break the world&lt;&#x2F;button&gt;;\n\nOnce youâ€™ve verified the library is initialized properly and sent a test event, consider visiting ourÂ complete React docs. There youâ€™ll find additional instructions for surfacing valuable context from React error boundaries, React Router, Redux, and more.\n","slug":"2021-06-20sentry","date":"2021-06-20T12:12:47.000Z","categories_index":"Web","tags_index":"Web","author_index":"é™ˆæµ·é¾™"},{"id":"40c248981d4dc9431fe8a0d461ef29a9","title":"CSS è‡ªåŠ¨ç”Ÿæˆ .d.ts","content":"CSS Module Typedvscode æ’ä»¶åˆ—è¡¨ä¸­æœ‰å¥½å¤šä¸ªï¼Œä¸è¦å®‰è£…é”™äº†\n\naddresslink\nInstallInstall deps first:\nrequirenpm install typed-css-modules\nif you need lessnpm install less\nif you need scss&#x2F;sassnpm install sass\nif you need stylusnpm install stylus\n\n\n\n\n\n\n\n\n\nModules can be installed globally. yarn is supported.\n\n\n\n\n\n\n\n\n\nTo switch the package manager (npm or yarn), you need to change the settings npm.packageManager of the built-in module vscode.npm.\nConfiguringBy default, the option to automatically format .d.ts files using eslint is enabled. You can disable this feature through the setting â€œtyped-css-modules.eslint.enableâ€: false.\nUsageput\n// @type\nor\n/* @type */\nahead of your .css&#x2F;.less&#x2F;.scss&#x2F;.sass&#x2F;.styl file, and save, you will get a d.ts file in same directory.\npreview\ndemo&#x2F;* @type *&#x2F;\n\n.root &#123;\n  padding: 16px;\n  min-height: 100%;\n\n  .empty-wrapper &#123;\n    height: 380px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  &#125;\n\n  &gt; h3 &#123;\n    font-size: inherit;\n    margin-bottom: 4px;\n  &#125;\n\n  .toolbar-wrapper &#123;\n    position: relative;\n\n    .toolbar &#123;\n      position: absolute;\n      margin: 12px 0;\n      z-index: 1;\n\n      &amp;.static &#123;\n        position: static;\n      &#125;\n\n      &gt; *:not(:first-child) &#123;\n        margin-left: 8px;\n      &#125;\n    &#125;\n  &#125;\n  .buttons &#123;\n    button &#123;\n      margin-right: 8px;\n    &#125;\n  &#125;\n&#125;\n.use-select &#123;\n  width: 300px;\n&#125;\n\ndeclare const styles: &#123;\n  readonly root: string;\n  readonly &quot;empty-wrapper&quot;: string;\n  readonly &quot;toolbar-wrapper&quot;: string;\n  readonly toolbar: string;\n  readonly static: string;\n  readonly buttons: string;\n  readonly &quot;use-select&quot;: string;\n&#125;;\nexport &#x3D; styles;\n\nproblem\n\n\n\n\n\n\n\n\nCreates .d.ts files from css-modules .css&#x2F;.less&#x2F;.scss&#x2F;.sass&#x2F;.styl files.\n\n\n\n\n\n\n\n\n\nError: vscode-typed-css-modules: Cannot find global module â€˜typed-css-modulesâ€™\nnpm install -g typed-css-modules\n","slug":"2021-06-10scss2type","date":"2021-06-10T13:30:47.000Z","categories_index":"å·¥å…·","tags_index":"å·¥å…·,å¢æ•ˆ,vscode","author_index":"é™ˆæµ·é¾™"},{"id":"b9663f58f18133b35bfe243f3e916a80","title":"Hello World","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n","slug":"hello-world","date":"2021-03-19T16:00:00.000Z","categories_index":"","tags_index":"","author_index":"é™ˆæµ·é¾™"},{"id":"c52c4d2131250825dcd85d4b917f6cb4","title":"vscode GitHub Copilot","content":"Copilot\n\n\n\nYour AI pair programmer\nå®˜ç½‘\næ”¯æŒå¼€å‘å·¥å…·\n\n\n\n\n\n\n\n\nsupport Visual Studio Code, Neovim, and IntelliJ-based IDEs like JetBrains IntelliJ IDEA, Android Studio or PyCharm.\næ³¨å†Œ\néœ€è¦äººå‘˜å®¡æ‰¹é€šè¿‡ï¼Œç­‰[1-2 å·¥ä½œæ—¥]\n\næ³¨å†Œ&#x2F;ç»“æœæŸ¥çœ‹\næˆ‘ç­‰åˆ°äº†5æœˆ25å·æ‰é€šè¿‡ï¼Œå¥½åƒæœ‰ä¸¤å‘¨çš„æ ·å­ğŸ˜‚\n\n\n\n\n\n\n\n\n\nJoin the GitHub Copilot waitlistAccess is limited to a small group of testers during the technical preview of GitHub Copilot. Sign up today for your chance to try it out and help us improve.\n\n\n\n\n\n\n\n\n\nYouâ€™re already on the waitlist for GitHub Copilot! Weâ€™ll notify you when weâ€™ve enabled it on your account. Make sure your primary email address is up-to-date so we can notify you.\nvscode å®‰è£…æ’ä»¶ Copilot\nè¯»æºç çš„åˆ©å™¨\nå†™æ–‡æ¡£çš„åˆ©å™¨\næˆ‘è¿™é‡Œéœ€è¦æŸç§æ ¼å¼çš„ç¿»è¯‘æ•ˆæœ\n\n","slug":"2022-05-08vscode","date":"2020-05-08T03:25:00.000Z","categories_index":"vscode","tags_index":"å¢æ•ˆ,vscode,AIç¼–ç¨‹","author_index":"é™ˆæµ·é¾™"},{"id":"e8f86794a8b73abb4c26e162bb1c7550","title":"Git public key","content":"[root@izbp1hun1qsl59e2nzqyvcz ~]# git config --global user.name &quot;hailong.chen&quot;\n[root@izbp1hun1qsl59e2nzqyvcz ~]# git config --global user.email &quot;841660202@qq.com&quot;\n\n\n\n\n\n\n\n\n\n\nSSHSSH keysSSH key å¯ä»¥è®©ä½ åœ¨ä½ çš„ç”µè„‘å’ŒCodeæœåŠ¡å™¨ä¹‹é—´å»ºç«‹å®‰å…¨çš„åŠ å¯†è¿æ¥ã€‚ å…ˆæ‰§è¡Œä»¥ä¸‹è¯­å¥æ¥åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨æœ¬åœ°å…¬é’¥ï¼šcat ~/.ssh/id_rsa.pubå¦‚æœä½ çœ‹åˆ°ä¸€é•¿ä¸²ä»¥Â ssh-rsaæˆ–Â ssh-dsaå¼€å¤´çš„å­—ç¬¦ä¸², ä½ å¯ä»¥è·³è¿‡Â ssh-keygençš„æ­¥éª¤ã€‚æç¤º: æœ€å¥½çš„æƒ…å†µæ˜¯ä¸€ä¸ªå¯†ç å¯¹åº”ä¸€ä¸ªssh keyï¼Œä½†æ˜¯é‚£ä¸æ˜¯å¿…é¡»çš„ã€‚ä½ å®Œå…¨å¯ä»¥è·³è¿‡åˆ›å»ºå¯†ç è¿™ä¸ªæ­¥éª¤ã€‚è¯·è®°ä½è®¾ç½®çš„å¯†ç å¹¶ä¸èƒ½è¢«ä¿®æ”¹æˆ–è·å–ã€‚ä½ å¯ä»¥æŒ‰å¦‚ä¸‹å‘½ä»¤æ¥ç”Ÿæˆssh keyssh-keygen -t rsa -C &quot;841660202@qq.com&quot;è¿™ä¸ªæŒ‡ä»¤ä¼šè¦æ±‚ä½ æä¾›ä¸€ä¸ªä½ç½®å’Œæ–‡ä»¶åå»å­˜æ”¾é”®å€¼å¯¹å’Œå¯†ç ï¼Œä½ å¯ä»¥ç‚¹å‡»Enteré”®å»ä½¿ç”¨é»˜è®¤å€¼ã€‚ç”¨ä»¥ä¸‹å‘½ä»¤è·å–ä½ ç”Ÿæˆçš„å…¬é’¥ï¼šcat ~/.ssh/id_rsa.pubå¤åˆ¶è¿™ä¸ªå…¬é’¥æ”¾åˆ°ä½ çš„ä¸ªäººè®¾ç½®ä¸­çš„SSH&#x2F;My SSH Keysä¸‹ï¼Œè¯·å®Œæ•´æ‹·è´ä»ssh-å¼€å§‹ç›´åˆ°ä½ çš„ç”¨æˆ·åå’Œä¸»æœºåä¸ºæ­¢çš„å†…å®¹ã€‚å¦‚æœæ‰“ç®—æ‹·è´ä½ çš„å…¬é’¥åˆ°ä½ çš„ç²˜è´´æ¿ä¸‹ï¼Œè¯·å‚è€ƒä½ çš„æ“ä½œç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹çš„å‘½ä»¤ï¼šWindows:clip &lt; ~/.ssh/id_rsa.pubMac:pbcopy &lt; ~/.ssh/id_rsa.pubGNU&#x2F;Linux (requires xclip):xclip -sel clip &lt; ~/.ssh/id_rsa.pubApplicationsEclipseå¦‚ä½•åœ¨Eclipseä¸­æ·»åŠ ssh key:Â https://wiki.eclipse.org/EGit/User_Guide#Eclipse_SSH_ConfigurationTip: Non-default OpenSSH key file names or locationså¦‚æœï¼Œä¸ç®¡ä½ æœ‰ä»€ä¹ˆç†ç”±ï¼Œå½“ä½ å†³å®šå»ç”¨ä¸€ä¸ªéé»˜è®¤çš„ä½ç½®æˆ–æ–‡ä»¶åå»å­˜æ”¾ä½ çš„ssh keyã€‚ä½ å¿…é¡»é…ç½®å¥½ä½ çš„sshå®¢æˆ·ç«¯ä»¥æ‰¾åˆ°ä½ çš„sshç§é’¥å»è¿æ¥CodeæœåŠ¡å™¨ï¼Œå¯¹äºOpenSSHå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªé€šå¸¸æ˜¯åœ¨~&#x2F;.ssh&#x2F;configç±»ä¼¼çš„ä½ç½®é…ç½®çš„ï¼šHost my-git.company.comRSAAuthentication yesIdentityFile ~&#x2F;my-ssh-key-directory&#x2F;company-com-private-key-filename\nLast login: Sun Apr 17 16:06:15 on console\nN&#x2F;A: version &quot;N&#x2F;A -&gt; N&#x2F;A&quot; is not yet installed.\n\nYou need to run &quot;nvm install N&#x2F;A&quot; to install it before using it.\nN&#x2F;A: version &quot;N&#x2F;A -&gt; N&#x2F;A&quot; is not yet installed.\n\nYou need to run &quot;nvm install N&#x2F;A&quot; to install it before using it.\n\nThe default interactive shell is now zsh.\nTo update your account to use zsh, please run &#96;chsh -s &#x2F;bin&#x2F;zsh&#96;.\nFor more details, please visit https:&#x2F;&#x2F;support.apple.com&#x2F;kb&#x2F;HT208050.\nchenhailong@chenhailongdeMacBook-Pro:~$ &#x2F;Users&#x2F;chenhailong&#x2F;Desktop \n-bash: &#x2F;Users&#x2F;chenhailong&#x2F;Desktop: is a directory\nchenhailong@chenhailongdeMacBook-Pro:~$ cd &#x2F;Users&#x2F;chenhailong&#x2F;Desktop \nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git clone git@github.com:841660202&#x2F;841660202.github.io.git\nCloning into &#39;841660202.github.io&#39;...\nThe authenticity of host &#39;github.com (20.205.243.166)&#39; can&#39;t be established.\nED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF&#x2F;zLDA0zPMSvHdkr4UvCOqU.\nThis key is not known by any other names\nAre you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])? yes\nWarning: Permanently added &#39;github.com&#39; (ED25519) to the list of known hosts.\ngit@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git clone git@github.com:841660202&#x2F;841660202.github.io.git\nCloning into &#39;841660202.github.io&#39;...\ngit@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa.pub\n-bash: &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub: No such file or directory\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ cat ~&#x2F;.ssh&#x2F;id_rsa.pub\ncat: &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub: No such file or directory\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git config --global user.name &quot;hailong.chen&quot;\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ \nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git config --global user.email &quot;841660202@qq.com&quot;\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ cat ~&#x2F;.ssh&#x2F;id_rsa.pub\ncat: &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub: No such file or directory\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ ssh-keygen -t rsa -C &quot;841660202@qq.com&quot;\nGenerating public&#x2F;private rsa key pair.\nEnter file in which to save the key (&#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa): \nEnter passphrase (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa\nYour public key has been saved in &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub\nThe key fingerprint is:\nSHA256:bdtIDeRXGKxGTEa&#x2F;Ex3QdPtVoOUiwuiq7YKjKrLakbU 841660202@qq.com\nThe key&#39;s randomart image is:\n+---[RSA 3072]----+\n|         +&#x3D;.o**.o|\n|       o +o.o*.oo|\n|      . o.+.* o..|\n|     .   oo&#x3D; +  o|\n|    . . S.+ +   .|\n|   o o   o + .   |\n| .o E     o .    |\n|&#x3D;..+             |\n|@oooo            |\n+----[SHA256]-----+\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa.pub\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git clone git@github.com:841660202&#x2F;841660202.github.io.git\nCloning into &#39;841660202.github.io&#39;...\nremote: Enumerating objects: 441, done.\nremote: Counting objects: 100% (441&#x2F;441), done.\nremote: Compressing objects: 100% (216&#x2F;216), done.\nremote: Total 441 (delta 208), reused 401 (delta 168), pack-reused 0\nReceiving objects: 100% (441&#x2F;441), 1.34 MiB | 1.05 MiB&#x2F;s, done.\nResolving deltas: 100% (208&#x2F;208), done.\nchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ \n\n\nè®¾ç½®github SSH keyshttps://github.com/settings/keys\n","slug":"2016-06-20git","date":"2019-10-30T13:30:47.000Z","categories_index":"git","tags_index":"git","author_index":"é™ˆæµ·é¾™"},{"id":"2f05eb6cd7f25d74fcf01b828267389c","title":"MAC Iterm2ç¾åŒ–ç»ˆç«¯","content":"MAC ç¯å¢ƒæ³¨æ„ï¼šä»¥ä¸‹å†…å®¹ä»…é™MAC,å…¶ä»–ç¯å¢ƒï¼Œè¯·è‡ªè¡Œè°·æ­Œ\noh-my-zsh æ’ä»¶æ¨è :\nautojump è¿™ä¸ªæ²¡ç”¨èµ·æ¥ï¼Œä½¿ç”¨æ²¡ä»€ä¹ˆæ•ˆæœğŸ¥¹\nzsh-autosuggestion å‘½ä»¤è¡Œè¾“å…¥æœ‰æç¤ºï¼Œï¼ˆå‘½ä»¤ä¸‹è½½å¤±è´¥ï¼Œæ‰‹åŠ¨ä¸‹è½½ï¼Œæ‹·è´åˆ° ~/.oh-my-zsh/custom/plugins/zsh-autosuggestionsï¼‰\nzsh-syntax-highlighting\n\nå®‰è£…zsh1.ä½¿ç”¨ brew å®‰è£…\nbrew install oh-my-zsh\n2. æ‰‹åŠ¨å®‰è£…\ngit clone git:&#x2F;&#x2F;github.com&#x2F;robbyrussell&#x2F;oh-my-zsh.git ~&#x2F;.oh-my-zsh\n\ncp ~&#x2F;.oh-my-zsh&#x2F;templates&#x2F;zshrc.zsh-template ~&#x2F;.zshrc\n\n\nå®‰è£… autojump1.å®‰è£…\nbrew install autojump\n2.é…ç½®code ~/.zshrcï¼ŒæŠŠä»¥ä¸‹ä»£ç åŠ åˆ°å°¾éƒ¨\n# ä½¿ç”¨brewå®‰è£…çš„\n\n[[ -s $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh ]] &amp;&amp; . $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh\nsource $ZSH&#x2F;oh-my-zsh.sh\n\n# ä½¿ç”¨gitå®‰è£…çš„\n\n[[ -s ~&#x2F;.autojump&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh ]] &amp;&amp; . ~&#x2F;.autojump&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh\n3.åˆ·æ–°é…ç½®\nsource ~&#x2F;.zshrc\nå®‰è£… zsh-autosuggestiongit clone git:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-autosuggestions $ZSH_CUSTOM&#x2F;plugins&#x2F;zsh-autosuggestions\n\nå®‰è£… zsh-syntax-highlightinggit clone https:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~&#x2F;.oh-my-zsh&#x2F;custom&#125;&#x2F;plugins&#x2F;zsh-syntax-highlighting\n\nåˆ·æ–°é…ç½®æœ€åç”¨ source ~/.zshrc å‘½ä»¤æ›´æ–°é…ç½®æ–‡ä»¶\n.zshrc é…ç½®å¦‚ä¸‹ï¼š\nè‡ªå·±ç”µè„‘é…ç½®ï¼Œä¸‹é¢æˆªå›¾æ˜¯åŠå…¬ç”µè„‘æˆªå›¾# If you come from bash you might have to change your $PATH.\n# export PATH&#x3D;$HOME&#x2F;bin:&#x2F;usr&#x2F;local&#x2F;bin:$PATH\n\n# Path to your oh-my-zsh installation.\nexport ZSH&#x3D;&quot;$HOME&#x2F;.oh-my-zsh&quot;\n\n# Set name of the theme to load --- if set to &quot;random&quot;, it will\n# load a random theme each time oh-my-zsh is loaded, in which case,\n# to know which specific one was loaded, run: echo $RANDOM_THEME\n# See https:&#x2F;&#x2F;github.com&#x2F;ohmyzsh&#x2F;ohmyzsh&#x2F;wiki&#x2F;Themes\nZSH_THEME&#x3D;&quot;robbyrussell&quot;\n\n# Set list of themes to pick from when loading at random\n# Setting this variable when ZSH_THEME&#x3D;random will cause zsh to load\n# a theme from this variable instead of looking in $ZSH&#x2F;themes&#x2F;\n# If set to an empty array, this variable will have no effect.\n# ZSH_THEME_RANDOM_CANDIDATES&#x3D;( &quot;robbyrussell&quot; &quot;agnoster&quot; )\n\n# Uncomment the following line to use case-sensitive completion.\n# CASE_SENSITIVE&#x3D;&quot;true&quot;\n\n# Uncomment the following line to use hyphen-insensitive completion.\n# Case-sensitive completion must be off. _ and - will be interchangeable.\n# HYPHEN_INSENSITIVE&#x3D;&quot;true&quot;\n\n# Uncomment one of the following lines to change the auto-update behavior\n# zstyle &#39;:omz:update&#39; mode disabled  # disable automatic updates\n# zstyle &#39;:omz:update&#39; mode auto      # update automatically without asking\n# zstyle &#39;:omz:update&#39; mode reminder  # just remind me to update when it&#39;s time\n\n# Uncomment the following line to change how often to auto-update (in days).\n# zstyle &#39;:omz:update&#39; frequency 13\n\n# Uncomment the following line if pasting URLs and other text is messed up.\n# DISABLE_MAGIC_FUNCTIONS&#x3D;&quot;true&quot;\n\n# Uncomment the following line to disable colors in ls.\n# DISABLE_LS_COLORS&#x3D;&quot;true&quot;\n\n# Uncomment the following line to disable auto-setting terminal title.\n# DISABLE_AUTO_TITLE&#x3D;&quot;true&quot;\n\n# Uncomment the following line to enable command auto-correction.\n# ENABLE_CORRECTION&#x3D;&quot;true&quot;\n\n# Uncomment the following line to display red dots whilst waiting for completion.\n# You can also set it to another string to have that shown instead of the default red dots.\n# e.g. COMPLETION_WAITING_DOTS&#x3D;&quot;%F&#123;yellow&#125;waiting...%f&quot;\n# Caution: this setting can cause issues with multiline prompts in zsh &lt; 5.7.1 (see #5765)\n# COMPLETION_WAITING_DOTS&#x3D;&quot;true&quot;\n\n# Uncomment the following line if you want to disable marking untracked files\n# under VCS as dirty. This makes repository status check for large repositories\n# much, much faster.\n# DISABLE_UNTRACKED_FILES_DIRTY&#x3D;&quot;true&quot;\n\n# Uncomment the following line if you want to change the command execution time\n# stamp shown in the history command output.\n# You can set one of the optional three formats:\n# &quot;mm&#x2F;dd&#x2F;yyyy&quot;|&quot;dd.mm.yyyy&quot;|&quot;yyyy-mm-dd&quot;\n# or set a custom format using the strftime function format specifications,\n# see &#39;man strftime&#39; for details.\n# HIST_STAMPS&#x3D;&quot;mm&#x2F;dd&#x2F;yyyy&quot;\n\n# Would you like to use another custom folder than $ZSH&#x2F;custom?\n# ZSH_CUSTOM&#x3D;&#x2F;path&#x2F;to&#x2F;new-custom-folder\n\n# Which plugins would you like to load?\n# Standard plugins can be found in $ZSH&#x2F;plugins&#x2F;\n# Custom plugins may be added to $ZSH_CUSTOM&#x2F;plugins&#x2F;\n# Example format: plugins&#x3D;(rails git textmate ruby lighthouse)\n# Add wisely, as too many plugins slow down shell startup.\n# æ’ä»¶ä¿¡æ¯\nplugins&#x3D;(\n  git\n  zsh-syntax-highlighting\n  zsh-autosuggestions\n  autojump\n)\n\nsource $ZSH&#x2F;oh-my-zsh.sh\n\n[[ -s $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh ]] &amp;&amp; . $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh\nsource $ZSH&#x2F;oh-my-zsh.sh\n\n# User configuration\nPROMPT&#x3D;&quot;%(?:%&#123;$fg_bold[yellow]%&#125;â™  :%&#123;$fg_bold[red]%&#125;â™  )%&#123;$fg[cyan]%&#125;%d $ &quot;\n# PROMPT&#x3D;&quot;%(?:%&#123;$fg_bold[yellow]%&#125;â™  :%&#123;$fg_bold[red]%&#125;â™  )%&#123;$fg[cyan]%&#125;%d %&#123;$fg_bold[magenta]%&#125;$ &quot;\nPROMPT+&#x3D;&#39;%&#123;$reset_color%&#125;&#39;\n\nZSH_THEME_GIT_PROMPT_PREFIX&#x3D;&quot;%&#123;$fg_bold[blue]%&#125;&quot;\nZSH_THEME_GIT_PROMPT_SUFFIX&#x3D;&quot;%&#123;$reset_color%&#125; &quot;\nZSH_THEME_GIT_PROMPT_DIRTY&#x3D;&quot;%&#123;$fg[blue]%&#125;) %&#123;$fg[yellow]%&#125;âœ—&quot;\nZSH_THEME_GIT_PROMPT_CLEAN&#x3D;&quot;%&#123;$fg[blue]%&#125;)&quot;\n\n# å‚è€ƒ https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;b84d8b7b134e\n\n# code\tvalue\n# %T\tç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶ï¼šåˆ†ï¼‰\n# %*\tç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶ï¼šåˆ†ï¼šç§’ï¼‰\n# %D\tç³»ç»Ÿæ—¥æœŸï¼ˆå¹´-æœˆ-æ—¥ï¼‰\n# %n\tç”¨æˆ·å\n# %B - %b\tå¼€å§‹åˆ°ç»“æŸä½¿ç”¨ç²—ä½“æ‰“å°\n# %U - %u\tå¼€å§‹åˆ°ç»“æŸä½¿ç”¨ä¸‹åˆ’çº¿æ‰“å°\n# %c\tä»…å½“å‰æ–‡ä»¶å¤¹è·¯å¾„\n# %d\tå½“å‰ç›®å½•è·¯å¾„å®Œæ•´\n# %~\tå½“å‰ç›®å½•ç›¸å¯¹äºï½çš„ç›¸å¯¹è·¯å¾„\n# %M\tè®¡ç®—æœºçš„ä¸»æœºå\n# %m\tè®¡ç®—æœºçš„ä¸»æœºåï¼ˆåœ¨ç¬¬ä¸€ä¸ªå¥å·ä¹‹å‰æˆªæ–­\n# %l\tå½“å‰çš„tty\n\n\n\n# export MANPATH&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;man:$MANPATH&quot;\n\n# You may need to manually set your language environment\n# export LANG&#x3D;en_US.UTF-8\n\n# Preferred editor for local and remote sessions\n# if [[ -n $SSH_CONNECTION ]]; then\n#   export EDITOR&#x3D;&#39;vim&#39;\n# else\n#   export EDITOR&#x3D;&#39;mvim&#39;\n# fi\n\n# Compilation flags\n# export ARCHFLAGS&#x3D;&quot;-arch x86_64&quot;\n\n# Set personal aliases, overriding those provided by oh-my-zsh libs,\n# plugins, and themes. Aliases can be placed here, though oh-my-zsh\n# users are encouraged to define aliases within the ZSH_CUSTOM folder.\n# For a full list of active aliases, run &#96;alias&#96;.\n#\n# Example aliases\n# alias zshconfig&#x3D;&quot;mate ~&#x2F;.zshrc&quot;\n# alias ohmyzsh&#x3D;&quot;mate ~&#x2F;.oh-my-zsh&quot;\n\næ¨èåšå®¢å·¦å²¸åšå®¢ä½¿ç”¨æ•ˆæœ\n\n","slug":"2017-07-09item2","date":"2019-10-30T13:30:47.000Z","categories_index":"å·¥å…·","tags_index":"å·¥å…·,å¢æ•ˆ","author_index":"é™ˆæµ·é¾™"},{"id":"8efdd810acba9c22bd1fc9e846bc2c89","title":"æ‰¹é‡åˆ é™¤ç›®å½•","content":"åˆ é™¤æŸä¸ªç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„node_modules# æŸ¥æ‰¾ &#x2F;tmp&#x2F;test&#x2F; å­ç›®å½•ä¸‹æ‰€æœ‰ modu æ‰§è¡Œåˆ é™¤\nfind &#x2F;tmp&#x2F;test&#x2F; -type d -name modu |xargs rm -rf\n\n# æŸ¥æ‰¾ &#x2F;tmp&#x2F;test&#x2F; å­ç›®å½•ä¸‹æ‰€æœ‰ node_modules æ‰§è¡Œåˆ é™¤\nfind &#x2F;tmp&#x2F;test&#x2F; -type d -name node_modules |xargs rm -rf","slug":"2019-10-30shell","date":"2019-10-30T13:30:47.000Z","categories_index":"Shell","tags_index":"å¢æ•ˆ,Shell","author_index":"é™ˆæµ·é¾™"},{"id":"9898e57ef559824ae32861e6fc17d4db","title":"Layoffs","content":"ä¸€å®¶ä¸Šå¸‚å…¬å¸è¿‘æœŸã€ŒBä¸šã€äººæ•°å˜åŒ–\n","slug":"2022-03-25Layoffs","date":"2019-10-30T13:30:47.000Z","categories_index":"Layoffs","tags_index":"Layoffs","author_index":"é™ˆæµ·é¾™"},{"id":"fa6ca4165b8b582ff1a69b1ccf9de547","title":"NestjsæœåŠ¡ç«¯æŠ€æœ¯æ ˆ","content":"NestJSä¸­æ–‡æ–‡æ¡£NestJSä¸­æ–‡æ–‡æ¡£NestJSä¸­æ–‡æ–‡æ¡£github 42.2K\n\n\n\n\n\n\n\n\n\nA progressive Node.js framework for building efficient, scalable, and enterprise-grade server-side applications on top of TypeScript &amp; JavaScript (ES6, ES7, ES8) ğŸš€\nTypeORMTypeORMä¸­æ–‡æ–‡æ¡£githubåœ°å€ 26.3K\n\n\n\n\n\n\n\n\n\nORM for TypeScript and JavaScript (ES7, ES6, ES5). Supports MySQL, PostgreSQL, MariaDB, SQLite, MS SQL Server, Oracle, SAP Hana, WebSQL databases. Works in NodeJS, Browser, Ionic, Cordova and Electron platforms.\n","slug":"2021-06-30node","date":"2015-11-12T02:55:47.000Z","categories_index":"Node","tags_index":"Node","author_index":"é™ˆæµ·é¾™"},{"id":"6f9f700e5a026be1d86747100cd27059","title":"Web officeé¢„è§ˆ","content":"ç¬¬ä¸€æ­¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°ä½ çš„æœåŠ¡å™¨é‡Œï¼Œå¹¶æ”¯æŒurlä¸‹è½½è¿™ä¸ªæ–‡ä»¶ã€‚ç¬¬äºŒæ­¥è®¿é—®ï¼šhttp://view.officeapps.live.com/op/view.aspx?src=è¦é¢„è§ˆæ–‡ä»¶çš„urlåœ°å€ï¼ˆè®°å¾—urlç¼–ç å“¦ï¼‰ç¬¬ä¸‰æ­¥å¯ä»¥ä½¿ç”¨iframeåµŒå…¥ä½ çš„ç³»ç»Ÿæ›´å¤šè¯¦æƒ…æŸ¥çœ‹ï¼šhttps://www.microsoft.com/en-us/microsoft-365/blog/2013/04/10/office-web-viewer-view-office-documents-in-a-browser/?eu=true\n","slug":"2021-09-07web","date":"2015-11-12T02:55:47.000Z","categories_index":"Web","tags_index":"Web","author_index":"é™ˆæµ·é¾™"},{"id":"038636b617c3d3d43c65b95b558e1735","title":"node-dev","content":"åœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev\nä½œç”¨ï¼šåœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev\nä¼˜ç‚¹ï¼š\nä»»æ„ä¾èµ–çš„æ–‡ä»¶æ”¹å˜æ—¶å€™ï¼Œé‡å¯node processï¼Œä½†æ˜¯å…±äº«tsç¼–è¯‘çº¿ç¨‹ã€‚\nå› ä¸ºä¸éœ€è¦æ¯æ¬¡ts-nodeç¼–è¯‘çš„å®ä¾‹åŒ–ï¼Œè€Œæå‡æ€§èƒ½\n\n\né…ç½®é¡¹ï¼š\næ³¨æ„äº‹é¡¹ï¼š\næˆªå›¾ï¼š\n\n","slug":"2021-11-02node","date":"2015-11-12T02:55:47.000Z","categories_index":"Node","tags_index":"Node","author_index":"é™ˆæµ·é¾™"},{"id":"c15b0fd9b66d6749d042b7d88c5bcd12","title":"ç®€ä¹¦è¿ç§»åˆ°OSS","content":"å‘½ä»¤cat .&#x2F;* |grep uploadimages.jianshu.io &gt; image.txt\nmkdir img3d\ncd img3d\nwget -i ..&#x2F;image.txt\nsed -i&#39;&#39; -e &#39;s&#x2F;!\\[image.png\\](&#x2F;&#x2F;g&#39; image.txt\nsed -i&#39;&#39; -e &#39;s&#x2F;)&#x2F;&#x2F;g&#39; image.txt\nè¿ç§»ç®€ä¹¦å›¾ç‰‡ä¸‹è½½åé‡å‘½å#! &#x2F;bin&#x2F;sh\n\nfor eachfile in &#96;ls -B&#96;\ndo  \n  # echo $&#123;eachfile%%\\%3F*&#125; # æˆªæ‰æœ€å.txt    # $ % https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;b3bdc3b3968e\n  filename&#x3D;$&#123;eachfile%%\\%3F*&#125;\n  filehead&#x3D;&#96;echo $eachfile | awk -F \\%3F &#39;&#123;print $1 &#125;&#39;&#96;\n  filelast&#x3D;&#96;echo $eachfile | awk -F \\%3F &#39;&#123;print $2 &#125;&#39;&#96;\n  # mv $filename.txt $&#123;filelast&#125;_$filehead.txt\n  # https:&#x2F;&#x2F;baijiahao.baidu.com&#x2F;s?id&#x3D;1726788915185806701&amp;wfr&#x3D;spider&amp;for&#x3D;pc\n  echo &#39;--&#39;\n  # echo $filename\n  echo $filehead #åˆ†å‰²å­—ç¬¦å·¦è¾¹éƒ¨åˆ†\n  echo $filelast #åˆ†å‰²å­—ç¬¦å³è¾¹éƒ¨åˆ†\n  # å³è¾¹æ–‡ä»¶å­˜åœ¨çš„æƒ…å†µä¸‹æ‰å¤„ç†\n  if [ &quot;$filelast&quot; !&#x3D; &quot;&quot; ]\n  then\n    echo &#39;æ‰§è¡Œrename &#39;\n    mv $eachfile $filehead\n  fi\n\ndone\n","slug":"2022-04-27mv-blog-jianshu","date":"2015-11-12T02:55:47.000Z","categories_index":"Shell","tags_index":"Shell","author_index":"é™ˆæµ·é¾™"}]