{"title":"","uid":"1cd19fc71517798e2fa5b7457d1fb06e","text":"// 每个Browser有三个属性： 可回退数量、当前地址、内存管理者 class Browser { // new 调用后会生成这么个对象 // { // fallBackNumber: 2, // address: '', // memoryCareTaker: Memory...","date":"2022-10-31T13:18:24.948Z","updated":"2022-10-31T13:18:24.948Z","comments":true,"path":"api/pages/test/设计模式/备忘录模式.js","covers":null,"excerpt":"","content":"// 每个Browser有三个属性： 可回退数量、当前地址、内存管理者\nclass Browser {\n  // new 调用后会生成这么个对象\n  // {\n  //   fallBackNumber: 2,\n  //   address: '',\n  //   memoryCareTaker: MemoryCareTaker { memoryList: [] }\n  // }\n  constructor() {\n    // 可回退数量\n    this.fallBackNumber = 2;\n    // 当前地址\n    this.address = \"\";\n    // 内存管理者\n    this.memoryCareTaker = new MemoryCareTaker();\n  }\n  // 这里同时更新了两组数据，address, memoryCareTaker\n  setAddress(address) {\n    this.address = address; // 这里赋值\n    this.memoryCareTaker.add(this.setAddressToMemory()); // 这里生成一个memory对象\n    if (this.fallBackNumber !== 2) this.fallBackNumber = 2;\n    console.log(\"当前:\", this.address);\n  }\n\n  getAddress(address) {\n    return this.address;\n  }\n\n  setAddressToMemory() {\n    return new Memory(this.address);\n  }\n\n  getAddressFromMemory(memory) {\n    this.content = memory.getContent();\n  }\n\n  fallBack() {\n    const lg = this.memoryCareTaker.getLength();\n\n    this.address = this.memoryCareTaker\n      .get(lg - this.fallBackNumber++) // 通过下标返回一个memory对象\n      .getContent(); // memory.getContent\n\n    console.log(\"退后到:\", this.getAddress());\n  }\n}\n// 每个memory对象有一个content属性\nclass Memory {\n  // new 会生成这么个对象\n  //  { content: undefined }\n  constructor(content) {\n    this.content = content;\n    console.log(\"记录:\", this.content);\n  }\n\n  getContent() {\n    return this.content;\n  }\n}\n// 每个内存管理者有一个memoryList属性\nclass MemoryCareTaker {\n  // new调用后，会返回一个对象 { memoryList: [] }\n  constructor() {\n    this.memoryList = [];\n  }\n\n  add(memory) {\n    this.memoryList.push(memory);\n  }\n\n  get(index) {\n    return this.memoryList[index];\n  }\n\n  getLength() {\n    return this.memoryList.length;\n  }\n}\n\nconst browser = new Browser();\nbrowser.setAddress(\"www.baidu.com\");\nbrowser.setAddress(\"www.bilibili.com\");\nbrowser.setAddress(\"juejin.im/timeline\");\nbrowser.fallBack();\nbrowser.fallBack();\nbrowser.setAddress(\"www.bilibili.com\");\nbrowser.fallBack();\nbrowser.fallBack();\n\nconsole.log(\"browser\", JSON.stringify(browser, null, 2));\n\nconsole.log(\"Memory\", new Memory());\n/**\n *   打印的值为：\n *   记录: www.baidu.com\n *   当前: www.baidu.com\n *   记录: www.bilibili.com\n *   当前: www.bilibili.com\n *   记录: juejin.im/timeline\n *   当前: juejin.im/timeline\n *   退后到: www.bilibili.com\n *   退后到: www.baidu.com\n *   记录: www.bilibili.com\n *   当前: www.bilibili.com\n *   退后到: juejin.im/timeline\n *   退后到: www.bilibili.com\n */\n","count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"toc":""}