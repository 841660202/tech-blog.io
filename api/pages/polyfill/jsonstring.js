{"title":"","uid":"1cd19fc71517798e2fa5b7457d1fb06e","text":"// 1. 基本数据类型 // null -> \"null\" // number -> string || \"null\" // bool -> string // undefined -> undefined, 对象中的属性会被滤除会被滤除，如果作为undefined会被 // ...","date":"2023-02-20T21:20:56.499Z","updated":"2023-02-20T21:20:56.499Z","comments":true,"path":"api/pages/polyfill/jsonstring.js","covers":null,"excerpt":"","content":"//  1. 基本数据类型\n//       null -> \"null\"\n//       number -> string || \"null\"\n//       bool -> string\n//       undefined -> undefined, 对象中的属性会被滤除会被滤除，如果作为undefined会被\n\n//  2. 对象类型数据\n//        Array-> 递归 拼接\"[\", \"]\"\n//        Object-> 递归 转化成数组,然后join()\n//        function-> 直接处理成.toJSON()>>>>>>> 函数类型会给转丢掉 MDN 有误\n\nvar isBase = (val) => Object.prototype.toString.call(val);\nvar isArray = (val) => Object.prototype.toString.call(val) === \"[object Array]\";\n// prettier-ignore\nvar isObject = (val) => Object.prototype.toString.call(val) === \"[object Object]\";\n\n// prettier-ignore\nvar escMap = {'\"': '\\\\\"', '\\\\': '\\\\\\\\', '\\b': '\\\\b', '\\f': '\\\\f', '\\n': '\\\\n', '\\r': '\\\\r', '\\t': '\\\\t'};\n// prettier-ignore\nvar escFunc = function (m) { return escMap[m] || '\\\\u' + (m.charCodeAt(0) + 0x10000).toString(16).substr(1); };\n\nvar escRE = /[\\\\\"\\u0000-\\u001F\\u2028\\u2029]/g;\n\nfunction stringify(value) {\n  // null\n  if (value == null) {\n    return \"null\";\n    // number, 无限值转化成null\n  } else if (typeof value === \"number\") {\n    return isFinite(value) ? value.toString() : \"null\";\n    // bool, 转化成string\n  } else if (typeof value === \"boolean\") {\n    return value.toString();\n    // 对象类型\n  } else if (typeof value === \"object\") {\n    // 函数类型 MDN bug\n    // if (typeof value.toJSON === \"function\") {\n    //   return stringify(value.toJSON());\n    //   // 数组类型\n    // } else\n\n    if (isArray(value)) {\n      // 数据拼接\n      var res = \"[\";\n      for (var i = 0; i < value.length; i++)\n        res += (i ? \", \" : \"\") + stringify(value[i]);\n      return res + \"]\";\n\n      // 对象类型\n    } else if (toString.call(value) === \"[object Object]\") {\n      // 这个地方用了join做技巧\n      var tmp = [];\n      for (var k in value) {\n        if (value.hasOwnProperty(k))\n          tmp.push(stringify(k) + \": \" + stringify(value[k]));\n      }\n      return \"{\" + tmp.join(\", \") + \"}\";\n    }\n  }\n  return '\"' + value.toString().replace(escRE, escFunc) + '\"';\n}\n","count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"toc":""}