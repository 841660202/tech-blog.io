<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¾…åŠäº‹é¡¹</title>
      <link href="//post/todo.html"/>
      <url>//post/todo.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç‰¹æ®Šè®°å¿†"><a href="#ç‰¹æ®Šè®°å¿†" class="headerlink" title="ç‰¹æ®Šè®°å¿†"></a>ç‰¹æ®Šè®°å¿†</h2><div style="display:flex;flex-direction:row; flex-wrap:wrap"><img src="http://t-blog-images.aijs.top/img/20220731104741.png"  style="max-width: 100%; width: 400px"/><img src="http://t-blog-images.aijs.top/img/20220731105416.png" style="max-width: 100%; width: 400px;"/></div><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; 1. headless-recorder&#x2F;&#x2F; 2. lightHouse https:&#x2F;&#x2F;blog.csdn.net&#x2F;tangdou369098655&#x2F;article&#x2F;details&#x2F;122531766&#x2F;&#x2F; 3. åšå®¢å°é¢ç”Ÿæˆ&#x2F;&#x2F;              https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;7132111156554301471?share_token&#x3D;4d225658-a9a2-4288-bc4e-892ca5f361fa&#x2F;&#x2F; 4. è£…é¥°å™¨æ¨¡å¼ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;decorator&#x2F;&#x2F; 5. iconfontè‡ªå®šä¹‰å›¾æ ‡ ï¼ˆé“¾æ¥æ”¾é”™äº†ï¼Œä»¥åè¡¥ä¸Šï¼Œå…ˆåˆ æ‰äº†ï¼‰&#x2F;&#x2F; 6. å‡½æ•°å¼ç¼–ç¨‹ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;function-production&#x2F;&#x2F; 7. æ¢è‚¤ https:&#x2F;&#x2F;www.zoo.team&#x2F;article&#x2F;theme-scss&#x2F;&#x2F; 8.[x] vscode setting sync å¦ä¸€å°ç”µè„‘é…ç½®æ— æ³•åŒæ­¥åˆ°æœ¬ç”µè„‘&#x2F;&#x2F; 9.[x]item2æœ¬æœºé‡æ–°é…ç½®&#x2F;&#x2F; 10.[x]vscode ä»£ç ç‰‡æ®µåœ¨mdä¸Šå¤±æ•ˆäº†&#x2F;&#x2F; 11.[x]typescript å·¥å…·ç±»å‹æºç &#x2F;&#x2F; 12. reactæºç &#x2F;&#x2F; 13. ocræ¡Œé¢ç«¯å·¥å…· å¯ä»¥å€Ÿé‰´ï¼šæƒ³ä½¿ç”¨ tauri æï¼Œæ²¡é‡åˆ°å¥½çš„æˆªå±&#x2F;&#x2F;                     1. https:&#x2F;&#x2F;github.com&#x2F;wulkano&#x2F;Kap  react + Electronå¼€å‘&#x2F;&#x2F;                     2. vscodeæ’ä»¶ ImageToText&#x2F;&#x2F; 14.reactæºç  debugger https:&#x2F;&#x2F;blog.csdn.net&#x2F;lin_fightin&#x2F;article&#x2F;details&#x2F;125136985?spm&#x3D;1001.2014.3001.5502&#x2F;&#x2F; 15. [x]å¦‚ä½•è®©ä¸€ä¸ªçŸ¥è¯†ç‚¹åˆ†æå›¾åŠ¨èµ·æ¥ï¼Ÿ pptåŠ¨ç”»&#x2F;&#x2F; 16. paste code to snippets å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–&#x2F;&#x2F; 17. è¿›ç¨‹çš„stdoutä¿¡æ¯ ååº”åˆ°podä¸Š ç„¶åè¢«k8sçš„æ—¥å¿—æ”¶é›†ç³»ç»Ÿæ”¶é›†å’Œå¤„ç†å å­˜å‚¨åœ¨æ—¥å¿—å¹³å°çš„ https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;92a4c11e77ba&#x2F;&#x2F; 18. [x]æ–‡ä»¶æŠ“å–ç¼“å­˜åœ¨æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹ã€ä¼˜å…ˆçº§é«˜ã€‘ fileName &#x3D;ã€‹download disk&#x2F;&#x2F; 19. node-kafka(ä»¥å‰æˆ‘æ€»å¬æˆ â€˜å¡ä¸å¡â€™ï¼Œ æˆ‘å›â€˜ä¸å¡ä¸å¡â€™)&#x2F;&#x2F; 20. å°è£…å…¬ç”¨é¢„è§ˆç»„ä»¶ï¼Œæ”¯æŒå„ç§å½¢å¼,pcã€mobile&#x2F;&#x2F; 21. git https:&#x2F;&#x2F;blog.csdn.net&#x2F;Q1761991696&#x2F;article&#x2F;details&#x2F;123572766&#x2F;&#x2F; 22. [x]gif æ’­æ”¾æ§åˆ¶&#x2F;&#x2F;                 æ–¹æ¡ˆ1: png + gif :https:&#x2F;&#x2F;www.cnblogs.com&#x2F;volodya&#x2F;p&#x2F;15897439.html&#x2F;&#x2F;                 æ–¹æ¡ˆ2: canvas : https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;d5cc47f6a998?utm_campaign&#x3D;haruki&#x2F;&#x2F;                 æ–¹æ¡ˆ3: é™æ€å›¾ + video å®ç° çŸ¥ä¹ https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;41543963&#x2F;&#x2F; 23. threejs https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;7112696052884439070&#x2F;&#x2F; 24. [x]reduxä¸­é—´ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆactionã€reducerã€effect&#x2F;&#x2F; 25. ts. ç›´æ¥åœ¨jsä¸­ä½¿ç”¨ requirets ä»£ç ä¸¢äº†ï¼Œè¦é‡å†™&#x2F;&#x2F; 26. ä¸šåŠ¡åœºæ™¯chat botæœºå™¨äºº</code></pre><p>äº‹é¡¹ï¼š</p><img src="http://t-blog-images.aijs.top/img/20220610103503.webp" width=300 height=/><p><a href="https://github.com/pipipi-pikachu/PPTist" target="_blank" >ppt</a></p><h2 id="å¥½çš„åšå®¢"><a href="#å¥½çš„åšå®¢" class="headerlink" title="å¥½çš„åšå®¢"></a>å¥½çš„åšå®¢</h2><p><a href="https://www.jianshu.com/u/99b8712e8850" target="_blank" >JerryWang_æ±ªå­ç†™ </a></p><h2 id="å…¶ä»–è®°å½•-æœªæ•´ç†"><a href="#å…¶ä»–è®°å½•-æœªæ•´ç†" class="headerlink" title="å…¶ä»–è®°å½• æœªæ•´ç†"></a>å…¶ä»–è®°å½• æœªæ•´ç†</h2><p><a href="https://juejin.cn/post/7107189225509879838" target="_blank" >ahooks ä¸­é‚£äº›æ§åˆ¶â€œæ—¶æœºâ€çš„ hook éƒ½æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</a></p><p>require-ts é¡¹ç›®ä¸¢äº†<br><img src="http://t-blog-images.aijs.top/img/202209021409257.webp" /></p><h2 id="å¾…åˆ é™¤"><a href="#å¾…åˆ é™¤" class="headerlink" title="å¾…åˆ é™¤"></a>å¾…åˆ é™¤</h2><ul><li><a href="http://t-blog-images.aijs.top/img/js">http://t-blog-images.aijs.top/img/js</a> æ•°ç»„.png</li></ul>]]></content>
      
      
      <categories>
          
          <category> Todo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Todo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ä¸šå¾®ä¿¡ï¼š å›¾ç‰‡é™„ä»¶æ— æ³•é¢„è§ˆçš„é—®é¢˜</title>
      <link href="//post/2022-04-19wework-preview.html"/>
      <url>//post/2022-04-19wework-preview.html</url>
      
        <content type="html"><![CDATA[<p><img src="http://t-blog-images.aijs.top/img/11460713-13685d46ead24558.png"></p><ul><li>èƒŒæ™¯ï¼šå®‰å“é¢„è§ˆæ­£å¸¸ï¼Œéƒ¨åˆ†iOSé¢„è§ˆæœ‰é—®é¢˜ï¼ˆå¤§éƒ¨åˆ†æ‰‹æœºéƒ½æ˜¯æ­£å¸¸çš„ï¼‰<pre class="line-numbers language-none"><code class="language-none">downloadAttachment(downloadUrl).then(res &#x3D;&gt; &#123;      if (getWechatUserAgent(navigator.userAgent)) &#123; &#x2F;&#x2F; åˆ¤æ–­æ˜¯ä¼ä¸šå¾®ä¿¡        const blob &#x3D; new Blob([res]);        wx.previewFile(&#123;          url: location.origin + downloadUrl, &#x2F;&#x2F; éœ€è¦é¢„è§ˆæ–‡ä»¶çš„åœ°å€(å¿…å¡«ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„)          name: attachment.name, &#x2F;&#x2F; éœ€è¦é¢„è§ˆæ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¿…é¡»æœ‰å¸¦æ–‡ä»¶æ ¼å¼çš„åç¼€ï¼Œä¾‹å¦‚.doc(ä¸å¡«çš„è¯å–urlçš„æœ€åéƒ¨åˆ†ï¼Œæœ€åéƒ¨åˆ†æ˜¯ä¸ªåŒ…å«æ ¼å¼åç¼€çš„æ–‡ä»¶å)          size: blob.size &#x2F;&#x2F; éœ€è¦é¢„è§ˆæ–‡ä»¶çš„å­—èŠ‚å¤§å°(å¿…å¡«ï¼Œè€Œä¸”å¤§å°å¿…é¡»æ­£ç¡®ï¼Œå¦åˆ™ä¼šæ‰“å¼€å¤±è´¥)        &#125;);        Toast.loading(i18n.loading, false)        return      &#125;      var reader &#x3D; new FileReader();      reader.readAsDataURL(res);   &#x2F;&#x2F; è½¬æ¢ä¸ºbase64ï¼Œå¯ä»¥ç›´æ¥æ”¾å…¥aæ ‡ç­¾href      reader.onload &#x3D; function (e) &#123;        const anchorEle &#x3D; document.createElement(&#39;a&#39;)        document.body.appendChild(anchorEle)        anchorEle.href &#x3D; e?.target?.result as any        anchorEle.download &#x3D; attachment.name        anchorEle.click()        document.body.removeChild(anchorEle)      &#125;      Toast.loading(i18n.loading, false)    &#125;).catch(() &#x3D;&gt; &#123;      Toast.loading(i18n.loading, false)    &#125;)</code></pre><code>è‡ªç ”ç§»åŠ¨ç«¯</code>ã€<code>webç«¯</code>ã€<code>ä¼ä¸šå¾®ä¿¡æ¡Œé¢ç«¯</code>éƒ½æ²¡é—®é¢˜ï¼Œå½“ç„¶å–½ï¼Œæ¯ä¸€ä¸ªç«¯å±•ç¤ºæ•ˆæœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä»£ç ä¹Ÿä¸ä¸€æ ·ã€‚æ’æŸ¥äº†è€—è´¹ä¸€å®šæ—¶é—´ã€‚</li></ul><ol><li>æ’æŸ¥ ä¼ä¸šå¾®ä¿¡ç‰ˆæœ¬ï¼Œ æ¯”å¯¹åå‘ç°ï¼Œå’Œæ­£å¸¸ä½¿ç”¨çš„å¾®ä¿¡ç‰ˆæœ¬ä¸€è‡´</li><li>æ’æŸ¥æ‰‹æœºç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œå®¢æˆ·iphone12å’Œ ç³»ç»Ÿç‰ˆæœ¬15.1ï¼Œæˆ‘ä»¬å¼€å‘äººå‘˜æ˜¯14.+ï¼Œæ‰€ä»¥æˆ‘æŠŠæˆ‘çš„æ‰‹æœºå‡çº§åˆ°æœ€æ–°ï¼Œæˆ‘çš„æ‰‹æœºå‡çº§åæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯æ•°æ®é—®é¢˜ï¼Œæ•°æ®</li><li>æ’æŸ¥æ•°æ®ï¼Œè¿™æ˜¯è€ç³»ç»Ÿçš„æ•°æ®ï¼Œå’Œæ–°ç³»ç»Ÿæ•°æ®èµ°ä¸åŒçš„ä¸šåŠ¡ä»£ç ï¼Œç»æ’æŸ¥ä¹Ÿæ²¡é—®é¢˜</li><li>æ’æŸ¥<code>size</code>å¦‚æœä¸å‡†ç¡®ä¹Ÿä¼šå‡ºç°ä¸Šè¿°é—®é¢˜ï¼Œç”±äºé¢„å‘ç¯å¢ƒè·å–ç¥¨æ®çš„ä¿¡æ¯ä¸çº¿ä¸Šæ˜¯ä¸ä¸€è‡´çš„ï¼Œæ‰€ä»¥æ— æ³•åœ¨é¢„å‘è¿›è¡Œæ’æŸ¥ï¼Œèƒ½åšçš„äº‹ä¿è¯ä»£ç æ‰§è¡Œåˆ°<code> const blob = new Blob([res]);</code>ï¼Œå¹¶ä¸”èƒ½å¤Ÿè·å–åˆ°æ­£ç¡®çš„sizeï¼Œæ‰€ä»¥è¿›è¡Œäº†alertè°ƒè¯•ï¼Œè¿™ä¸ªåœ¨æ‰‹æœºä¸Šæ¯”è¾ƒç›´è§‚ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥<code>vconsole</code>ã€æš‚ä¸è€ƒè™‘,å› ä¸ºä¹‹å‰å¼€å‘äººå‘˜æ²¡åŠ ï¼Œéƒ¨é—¨è¢«ç æ‰ï¼Œå¾ˆå¤šäººè¢«è£å‘˜äº†ï¼Œæ‰€æœ‰é¡¹ç›®éƒ½æˆ‘æ¥ç»´æŠ¤ï¼Œæ²¡æ—¶é—´ï¼Œä¸æ•´äº†ã€‘ï¼Œè°ƒè¯•ç»“æœæ˜¯size: 88214,å„ä¸ªæ‰‹æœºéƒ½ä¸€æ ·ï¼Œç”¨æˆ·æ‰‹æœºä¹Ÿæ˜¯88214ï¼Œæ•…æ’é™¤size</li><li>æœ€åå¯èƒ½é—®é¢˜åœ¨äºï¼Œç”¨æˆ·æ‰‹æœºä¸Šç‰ˆæœ¬ä¸æ‰‹æœºä¸åŒ¹é…ï¼Œæœ‰å…¼å®¹æ€§bugï¼Œå°è¯•å‡çº§ä¼ä¸šå¾®ä¿¡ï¼Œæœ€åè§£å†³</li></ol><br/><p>æ€»ç»“ï¼šå¦‚æœè€ƒè™‘ç›´æ¥å‡çº§ç”¨æˆ·appç‰ˆæœ¬ï¼Œæˆ–è®¸åœ¨ç¬¬ä¸‰æ­¥å°±è§£å†³é—®é¢˜äº†ï¼Œæˆ‘çš„iphoneXä¹Ÿä¸ç”¨å‡çº§åˆ°15.3äº†</p>]]></content>
      
      
      <categories>
          
          <category> ä¼ä¸šå¾®ä¿¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ä¸šå¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vite react antd</title>
      <link href="//post/2022-09-07vite-react.html"/>
      <url>//post/2022-09-07vite-react.html</url>
      
        <content type="html"><![CDATA[<h2 id="nextjs-sun-antd"><a href="#nextjs-sun-antd" class="headerlink" title="nextjs + sun (antd)"></a>nextjs + sun (antd)</h2><p>ä¹‹å‰éƒ¨é—¨ç”¨çš„å…¬å¸çš„è¿™å¥—ç»„åˆï¼Œè¢«ç°åœ¨çš„éƒ¨é—¨å«Œå¼ƒ</p><h2 id="umijs-x2F-max"><a href="#umijs-x2F-max" class="headerlink" title="@umijs&#x2F;max"></a>@umijs&#x2F;max</h2><p>è¯•ç”¨äº† umijs&#x2F;max MFSU, åœ¨å¼€å‘æ›´æ–°ä½“éªŒä¸Šè¿˜æ˜¯è§‰å¾—æ…¢</p><h2 id="vite-react-antd-ahooks-axios-antv-canvas-svg-ts"><a href="#vite-react-antd-ahooks-axios-antv-canvas-svg-ts" class="headerlink" title="vite + react + antd + ahooks + axios + antv + canvas(svg) + ts"></a>vite + react + antd + ahooks + axios + antv + canvas(svg) + ts</h2><ul><li>react è¯» hook éƒ¨åˆ†æºç </li><li>ahooks è¯»è¿‡æºç </li><li>axios è¯»è¿‡æºç </li><li>canvas(svg) éƒ¨åˆ†å¯è§†åŒ–å®šåˆ¶è¦æ±‚é«˜ï¼Œantv æ— æ³•å®ç°</li></ul><p>æœ€ç»ˆé€‰æ‹©äº†è¿™å¥—æ–¹æ¡ˆ</p><h3 id="tså…¨å±€å£°æ˜é…ç½®"><a href="#tså…¨å±€å£°æ˜é…ç½®" class="headerlink" title="tså…¨å±€å£°æ˜é…ç½®"></a>tså…¨å±€å£°æ˜é…ç½®</h3><h3 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h3><h3 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;compilerOptions&quot;: &#123;    &quot;target&quot;: &quot;ESNext&quot;,    &quot;useDefineForClassFields&quot;: true,    &quot;lib&quot;: [&quot;DOM&quot;, &quot;DOM.Iterable&quot;, &quot;ESNext&quot;],    &quot;allowJs&quot;: false,    &quot;skipLibCheck&quot;: true,    &quot;esModuleInterop&quot;: false,    &quot;allowSyntheticDefaultImports&quot;: true,    &quot;strict&quot;: true,    &quot;forceConsistentCasingInFileNames&quot;: true,    &quot;module&quot;: &quot;ESNext&quot;,    &quot;moduleResolution&quot;: &quot;Node&quot;,    &quot;resolveJsonModule&quot;: true,    &quot;isolatedModules&quot;: true,    &quot;noEmit&quot;: true,    &quot;jsx&quot;: &quot;react-jsx&quot;,    &quot;paths&quot;: &#123;      &quot;@&#x2F;*&quot;: [&quot;.&#x2F;src&#x2F;*&quot;],      &quot;@&#x2F;components&#x2F;*&quot;: [&quot;.&#x2F;src&#x2F;components&#x2F;*&quot;]    &#125;  &#125;,  &quot;include&quot;: [&quot;src&quot;],  &quot;references&quot;: [&#123; &quot;path&quot;: &quot;.&#x2F;tsconfig.node.json&quot; &#125;]&#125;</code></pre><p>é…ç½®å®Œæˆä»ç„¶æç¤º</p><pre class="line-numbers language-none"><code class="language-none">Cannot find module &#39;@&#x2F;components&#x2F;test&#39; or its corresponding type declarations.</code></pre><p>è§£å†³ï¼š vscode é‡æ–°å¯åŠ¨</p><p><a href="https://blog.csdn.net/q95548854/article/details/121899607" target="_blank" >ç»ˆæè§£å†³ TS æˆ–è€… Vetur æŠ¥é”™ï¼ŒCannot find module â€˜@&#x2F;xx&#x2F;xxxâ€˜ï¼Œæ‰¾ä¸åˆ°*.vue ç­‰ç¼–è¯‘é—®é¢˜</a></p><h3 id="antd-æŒ‰éœ€åŠ è½½"><a href="#antd-æŒ‰éœ€åŠ è½½" class="headerlink" title="antd æŒ‰éœ€åŠ è½½"></a>antd æŒ‰éœ€åŠ è½½</h3><h3 id="è¯·æ±‚å·¥å…·å°è£…"><a href="#è¯·æ±‚å·¥å…·å°è£…" class="headerlink" title="è¯·æ±‚å·¥å…·å°è£…"></a>è¯·æ±‚å·¥å…·å°è£…</h3><h3 id="antd-å®šåˆ¶ä¸»é¢˜"><a href="#antd-å®šåˆ¶ä¸»é¢˜" class="headerlink" title="antd å®šåˆ¶ä¸»é¢˜"></a>antd å®šåˆ¶ä¸»é¢˜</h3><h3 id="æ‰“åŒ…ä¼˜åŒ–"><a href="#æ‰“åŒ…ä¼˜åŒ–" class="headerlink" title="æ‰“åŒ…ä¼˜åŒ–"></a>æ‰“åŒ…ä¼˜åŒ–</h3><img src="http://t-blog-images.aijs.top/img/202209071639635.webp" /><img src="http://t-blog-images.aijs.top/img/202209071640618.webp" /><h3 id="å¦‚ä½•éƒ¨ç½²"><a href="#å¦‚ä½•éƒ¨ç½²" class="headerlink" title="å¦‚ä½•éƒ¨ç½²"></a>å¦‚ä½•éƒ¨ç½²</h3><p>è¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä¹‹å‰æˆ‘çœ‹æœ‰åŒäº‹ï¼Œç”¨ vite å¼€å‘ï¼Œç”¨ webpack æ‰“åŒ…éƒ¨ç½²</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> vite </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nest 413</title>
      <link href="//post/2022-09-06nestjs.html"/>
      <url>//post/2022-09-06nestjs.html</url>
      
        <content type="html"><![CDATA[<h2 id="æœ‰é—®é¢˜çš„é¡¹ç›®"><a href="#æœ‰é—®é¢˜çš„é¡¹ç›®" class="headerlink" title="æœ‰é—®é¢˜çš„é¡¹ç›®"></a>æœ‰é—®é¢˜çš„é¡¹ç›®</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; NestFactory &#125; from &quot;@nestjs&#x2F;core&quot;;import &#123; NestExpressApplication &#125; from &quot;@nestjs&#x2F;platform-express&quot;;import &#123; AppModule &#125; from &quot;.&#x2F;app.module&quot;;import &#123; join &#125; from &quot;path&quot;;import &#123; rootDir &#125; from &quot;.&#x2F;utils&#x2F;path&quot;;import &#123; config &#125; from &quot;.&#x2F;config&quot;;import * as bodyParser from &quot;body-parser&quot;;async function bootstrap() &#123;  &#x2F;&#x2F; const app &#x3D; await NestFactory.create(AppModule);  const app &#x3D; await NestFactory.create&lt;NestExpressApplication&gt;(AppModule, &#123;    cors: true,  &#125;);  app.setGlobalPrefix(&quot;api&quot;);  app.useStaticAssets(join(rootDir, &quot;public&quot;), &#123;    prefix: config.static, &#x2F;&#x2F;è®¾ç½®è™šæ‹Ÿè·¯å¾„  &#125;);  &#x2F;&#x2F; limit  app.use(bodyParser.urlencoded(&#123; extended: true, limit: &quot;8mb&quot; &#125;));  app.use(bodyParser.json(&#123; limit: &quot;8mb&quot; &#125;));  app.enableCors();  await app.listen(config.port);&#125;bootstrap();</code></pre><h2 id="æ–°æ„å»ºçš„é¡¹ç›®-413"><a href="#æ–°æ„å»ºçš„é¡¹ç›®-413" class="headerlink" title="æ–°æ„å»ºçš„é¡¹ç›® 413"></a>æ–°æ„å»ºçš„é¡¹ç›® 413</h2><p>åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è¯•äº† n ééƒ½æŠ¥åŒæ ·çš„é”™è¯¯</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; NestFactory &#125; from &quot;@nestjs&#x2F;core&quot;;import &#123; AppModule &#125; from &quot;.&#x2F;app.module&quot;;async function bootstrap() &#123;  const app &#x3D; await NestFactory.create(AppModule);  await app.listen(8000);&#125;bootstrap();&#x2F;&#x2F;</code></pre><img src="http://t-blog-images.aijs.top/img/202209062047875.png" /><h2 id="æ–°æ„å»ºçš„é¡¹ç›®-200"><a href="#æ–°æ„å»ºçš„é¡¹ç›®-200" class="headerlink" title="æ–°æ„å»ºçš„é¡¹ç›® 200"></a>æ–°æ„å»ºçš„é¡¹ç›® 200</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; it&#39;s okimport &#123; NestFactory &#125; from &quot;@nestjs&#x2F;core&quot;;import &#123; AppModule &#125; from &quot;.&#x2F;app.module&quot;;import * as bodyParser from &quot;body-parser&quot;;async function bootstrap() &#123;  const app &#x3D; await NestFactory.create(AppModule);  &#x2F;&#x2F; é…ç½®limit  app.use(bodyParser.json(&#123; limit: &quot;50mb&quot; &#125;));  app.use(bodyParser.urlencoded(&#123; limit: &quot;50mb&quot;, extended: true &#125;));  await app.listen(8000);&#125;bootstrap();</code></pre><img src="http://t-blog-images.aijs.top/img/202209062043913.png" /><h2 id="æ–°æ„å»ºçš„é¡¹ç›®-ä½¿ç”¨-NestExpressApplication"><a href="#æ–°æ„å»ºçš„é¡¹ç›®-ä½¿ç”¨-NestExpressApplication" class="headerlink" title="æ–°æ„å»ºçš„é¡¹ç›® ä½¿ç”¨ NestExpressApplication"></a>æ–°æ„å»ºçš„é¡¹ç›® ä½¿ç”¨ NestExpressApplication</h2><p>é…ç½®å¦‚ä¸‹ï¼Œsrc ç›¸å…³ä»£ç å®Œå…¨ä¸€è‡´</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#123;  &quot;name&quot;: &quot;nest-413&quot;,  &quot;version&quot;: &quot;0.0.1&quot;,  &quot;description&quot;: &quot;&quot;,  &quot;author&quot;: &quot;&quot;,  &quot;private&quot;: true,  &quot;license&quot;: &quot;UNLICENSED&quot;,  &quot;scripts&quot;: &#123;    &quot;prebuild&quot;: &quot;rimraf dist&quot;,    &quot;build&quot;: &quot;nest build&quot;,    &quot;format&quot;: &quot;prettier --write \&quot;src&#x2F;**&#x2F;*.ts\&quot; \&quot;test&#x2F;**&#x2F;*.ts\&quot;&quot;,    &quot;start&quot;: &quot;nest start&quot;,    &quot;start:dev&quot;: &quot;nest start --watch&quot;,    &quot;start:debug&quot;: &quot;nest start --debug --watch&quot;,    &quot;start:prod&quot;: &quot;node dist&#x2F;main&quot;,    &quot;lint&quot;: &quot;eslint \&quot;&#123;src,apps,libs,test&#125;&#x2F;**&#x2F;*.ts\&quot; --fix&quot;,    &quot;test&quot;: &quot;jest&quot;,    &quot;test:watch&quot;: &quot;jest --watch&quot;,    &quot;test:cov&quot;: &quot;jest --coverage&quot;,    &quot;test:debug&quot;: &quot;node --inspect-brk -r tsconfig-paths&#x2F;register -r ts-node&#x2F;register node_modules&#x2F;.bin&#x2F;jest --runInBand&quot;,    &quot;test:e2e&quot;: &quot;jest --config .&#x2F;test&#x2F;jest-e2e.json&quot;  &#125;,  &quot;dependencies&quot;: &#123;    &quot;@nestjs&#x2F;common&quot;: &quot;^9.0.0&quot;,    &quot;@nestjs&#x2F;core&quot;: &quot;^9.0.0&quot;,    &quot;@nestjs&#x2F;platform-express&quot;: &quot;^9.0.11&quot;,    &quot;@nestjs&#x2F;typeorm&quot;: &quot;^9.0.1&quot;,    &quot;body-parser&quot;: &quot;^1.20.0&quot;,    &quot;mysql2&quot;: &quot;^2.3.3&quot;,    &quot;reflect-metadata&quot;: &quot;^0.1.13&quot;,    &quot;request&quot;: &quot;^2.88.2&quot;,    &quot;rimraf&quot;: &quot;^3.0.2&quot;,    &quot;rxjs&quot;: &quot;^7.2.0&quot;,    &quot;typeorm&quot;: &quot;^0.3.9&quot;  &#125;,  &quot;devDependencies&quot;: &#123;    &quot;@nestjs&#x2F;cli&quot;: &quot;^9.0.0&quot;,    &quot;@nestjs&#x2F;schematics&quot;: &quot;^9.0.0&quot;,    &quot;@nestjs&#x2F;testing&quot;: &quot;^9.0.0&quot;,    &quot;@types&#x2F;express&quot;: &quot;^4.17.13&quot;,    &quot;@types&#x2F;jest&quot;: &quot;28.1.8&quot;,    &quot;@types&#x2F;node&quot;: &quot;^16.0.0&quot;,    &quot;@types&#x2F;supertest&quot;: &quot;^2.0.11&quot;,    &quot;@typescript-eslint&#x2F;eslint-plugin&quot;: &quot;^5.0.0&quot;,    &quot;@typescript-eslint&#x2F;parser&quot;: &quot;^5.0.0&quot;,    &quot;eslint&quot;: &quot;^8.0.1&quot;,    &quot;eslint-config-prettier&quot;: &quot;^8.3.0&quot;,    &quot;eslint-plugin-prettier&quot;: &quot;^4.0.0&quot;,    &quot;jest&quot;: &quot;28.1.3&quot;,    &quot;prettier&quot;: &quot;^2.3.2&quot;,    &quot;source-map-support&quot;: &quot;^0.5.20&quot;,    &quot;supertest&quot;: &quot;^6.1.3&quot;,    &quot;ts-jest&quot;: &quot;28.0.8&quot;,    &quot;ts-loader&quot;: &quot;^9.2.3&quot;,    &quot;ts-node&quot;: &quot;^10.0.0&quot;,    &quot;tsconfig-paths&quot;: &quot;4.1.0&quot;,    &quot;typescript&quot;: &quot;^4.7.4&quot;  &#125;,  &quot;jest&quot;: &#123;    &quot;moduleFileExtensions&quot;: [      &quot;js&quot;,      &quot;json&quot;,      &quot;ts&quot;    ],    &quot;rootDir&quot;: &quot;src&quot;,    &quot;testRegex&quot;: &quot;.*\\.spec\\.ts$&quot;,    &quot;transform&quot;: &#123;      &quot;^.+\\.(t|j)s$&quot;: &quot;ts-jest&quot;    &#125;,    &quot;collectCoverageFrom&quot;: [      &quot;**&#x2F;*.(t|j)s&quot;    ],    &quot;coverageDirectory&quot;: &quot;..&#x2F;coverage&quot;,    &quot;testEnvironment&quot;: &quot;node&quot;  &#125;&#125;</code></pre><h2 id="æœ‰é—®é¢˜é¡¹ç›®é…ç½®"><a href="#æœ‰é—®é¢˜é¡¹ç›®é…ç½®" class="headerlink" title="æœ‰é—®é¢˜é¡¹ç›®é…ç½®"></a>æœ‰é—®é¢˜é¡¹ç›®é…ç½®</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#123;  &quot;name&quot;: &quot;mitm-cache&quot;,  &quot;version&quot;: &quot;0.0.1&quot;,  &quot;description&quot;: &quot;&quot;,  &quot;author&quot;: &quot;&quot;,  &quot;private&quot;: true,  &quot;license&quot;: &quot;UNLICENSED&quot;,  &quot;scripts&quot;: &#123;    &quot;prebuild&quot;: &quot;rimraf dist&quot;,    &quot;build&quot;: &quot;nest build&quot;,    &quot;format&quot;: &quot;prettier --write \&quot;src&#x2F;**&#x2F;*.ts\&quot; \&quot;test&#x2F;**&#x2F;*.ts\&quot;&quot;,    &quot;start&quot;: &quot;nest start&quot;,    &quot;start:dev&quot;: &quot;nest start --watch&quot;,    &quot;start:debug&quot;: &quot;nest start --debug --watch&quot;,    &quot;start:prod&quot;: &quot;node dist&#x2F;main&quot;,    &quot;lint&quot;: &quot;eslint \&quot;&#123;src,apps,libs,test&#125;&#x2F;**&#x2F;*.ts\&quot; --fix&quot;,    &quot;test&quot;: &quot;jest&quot;,    &quot;test:watch&quot;: &quot;jest --watch&quot;,    &quot;test:cov&quot;: &quot;jest --coverage&quot;,    &quot;test:debug&quot;: &quot;node --inspect-brk -r tsconfig-paths&#x2F;register -r ts-node&#x2F;register node_modules&#x2F;.bin&#x2F;jest --runInBand&quot;,    &quot;test:e2e&quot;: &quot;jest --config .&#x2F;test&#x2F;jest-e2e.json&quot;  &#125;,  &quot;dependencies&quot;: &#123;    &quot;@nestjs&#x2F;common&quot;: &quot;^8.0.0&quot;,    &quot;@nestjs&#x2F;core&quot;: &quot;^8.0.0&quot;,    &quot;@nestjs&#x2F;platform-express&quot;: &quot;^8.4.7&quot;,    &quot;@nestjs&#x2F;typeorm&quot;: &quot;^8.1.4&quot;,    &quot;mysql2&quot;: &quot;^2.3.3&quot;,    &quot;reflect-metadata&quot;: &quot;^0.1.13&quot;,    &quot;request&quot;: &quot;^2.88.2&quot;,    &quot;rimraf&quot;: &quot;^3.0.2&quot;,    &quot;rxjs&quot;: &quot;^7.2.0&quot;,    &quot;typeorm&quot;: &quot;^0.3.6&quot;  &#125;,  &quot;devDependencies&quot;: &#123;    &quot;@nestjs&#x2F;cli&quot;: &quot;^8.0.0&quot;,    &quot;@nestjs&#x2F;schematics&quot;: &quot;^8.0.0&quot;,    &quot;@nestjs&#x2F;testing&quot;: &quot;^8.0.0&quot;,    &quot;@types&#x2F;express&quot;: &quot;^4.17.13&quot;,    &quot;@types&#x2F;jest&quot;: &quot;27.5.0&quot;,    &quot;@types&#x2F;node&quot;: &quot;^16.0.0&quot;,    &quot;@types&#x2F;supertest&quot;: &quot;^2.0.11&quot;,    &quot;@typescript-eslint&#x2F;eslint-plugin&quot;: &quot;^5.0.0&quot;,    &quot;@typescript-eslint&#x2F;parser&quot;: &quot;^5.0.0&quot;,    &quot;eslint&quot;: &quot;^8.0.1&quot;,    &quot;eslint-config-prettier&quot;: &quot;^8.3.0&quot;,    &quot;eslint-plugin-prettier&quot;: &quot;^4.0.0&quot;,    &quot;jest&quot;: &quot;28.0.3&quot;,    &quot;prettier&quot;: &quot;^2.3.2&quot;,    &quot;source-map-support&quot;: &quot;^0.5.20&quot;,    &quot;supertest&quot;: &quot;^6.1.3&quot;,    &quot;ts-jest&quot;: &quot;28.0.1&quot;,    &quot;ts-loader&quot;: &quot;^9.2.3&quot;,    &quot;ts-node&quot;: &quot;^10.0.0&quot;,    &quot;tsconfig-paths&quot;: &quot;4.0.0&quot;,    &quot;typescript&quot;: &quot;^4.3.5&quot;  &#125;,  &quot;jest&quot;: &#123;    &quot;moduleFileExtensions&quot;: [      &quot;js&quot;,      &quot;json&quot;,      &quot;ts&quot;    ],    &quot;rootDir&quot;: &quot;src&quot;,    &quot;testRegex&quot;: &quot;.*\\.spec\\.ts$&quot;,    &quot;transform&quot;: &#123;      &quot;^.+\\.(t|j)s$&quot;: &quot;ts-jest&quot;    &#125;,    &quot;collectCoverageFrom&quot;: [      &quot;**&#x2F;*.(t|j)s&quot;    ],    &quot;coverageDirectory&quot;: &quot;..&#x2F;coverage&quot;,    &quot;testEnvironment&quot;: &quot;node&quot;  &#125;&#125;</code></pre><h2 id="çŒœæµ‹"><a href="#çŒœæµ‹" class="headerlink" title="çŒœæµ‹"></a>çŒœæµ‹</h2><p>åœ¨ src ä»£ç ä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œnest ç›¸å…³ç‰ˆæœ¬ä½¿ç”¨æœ€æ–°çš„ï¼Œå¯ä»¥æ–­å®š nest v8 æœ‰é—®é¢˜</p><h2 id="å…¬å¸ç”µè„‘éªŒè¯"><a href="#å…¬å¸ç”µè„‘éªŒè¯" class="headerlink" title="å…¬å¸ç”µè„‘éªŒè¯"></a>å…¬å¸ç”µè„‘éªŒè¯</h2><p>å¯åŠ¨çš„ç«¯å£ä¸€ç›´æ˜¯ä¿®æ”¹å‰çš„ç«¯å£ï¼Œæ‰§è¡Œ é¡¹ç›®ä¸­ <code>yarn prebuild</code> ä¼šæ¸…ç† dist ç›®å½•ï¼Œæ¸…ç†å®Œæˆåé‡å¯å¯ä»¥äº†</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;scripts&quot;: &#123;    &quot;prebuild&quot;: &quot;rimraf dist&quot;, &#x2F;&#x2F; è¿™ä¸ª    &quot;build&quot;: &quot;nest build&quot;,    &quot;format&quot;: &quot;prettier --write \&quot;src&#x2F;**&#x2F;*.ts\&quot; \&quot;test&#x2F;**&#x2F;*.ts\&quot;&quot;,    &quot;start&quot;: &quot;nest start&quot;,    &quot;start:dev&quot;: &quot;nest start --watch&quot;,    &quot;start:debug&quot;: &quot;nest start --debug --watch&quot;,    &quot;start:prod&quot;: &quot;node dist&#x2F;main&quot;,    &quot;lint&quot;: &quot;eslint \&quot;&#123;src,apps,libs,test&#125;&#x2F;**&#x2F;*.ts\&quot; --fix&quot;,    &quot;test&quot;: &quot;jest&quot;,    &quot;test:watch&quot;: &quot;jest --watch&quot;,    &quot;test:cov&quot;: &quot;jest --coverage&quot;,    &quot;test:debug&quot;: &quot;node --inspect-brk -r tsconfig-paths&#x2F;register -r ts-node&#x2F;register node_modules&#x2F;.bin&#x2F;jest --runInBand&quot;,    &quot;test:e2e&quot;: &quot;jest --config .&#x2F;test&#x2F;jest-e2e.json&quot;  &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> nest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React useImperativeHandle</title>
      <link href="//post/2022-09-06useImperativeHandle.html"/>
      <url>//post/2022-09-06useImperativeHandle.html</url>
      
        <content type="html"><![CDATA[<h2 id="å°æ’æ›²"><a href="#å°æ’æ›²" class="headerlink" title="å°æ’æ›²"></a>å°æ’æ›²</h2><p>vscode æŠŠ js ä»£ç åšåšäº† ts æ ¡éªŒ</p><img src="http://t-blog-images.aijs.top/img/202209061141505.webp" /><p>é—®é¢˜å¤„ç†</p><img src="http://t-blog-images.aijs.top/img/202209061143356.webp" /><h2 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h2><p>use Imperative Handle ä½¿ç”¨å‘½ä»¤å¥æŸ„</p><p><code>useImperativeHandle(ref, createHandle, [deps])</code></p><p><code>useImperativeHandle </code> å¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ <code>ref</code> æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”å½“é¿å…ä½¿ç”¨ <code>ref </code>è¿™æ ·çš„å‘½ä»¤å¼ä»£ç ã€‚<code>useImperativeHandle </code> åº”å½“ä¸ <code>forwardRef</code> ä¸€èµ·ä½¿ç”¨ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function FancyInput(props, ref) &#123;  const inputRef &#x3D; useRef();  useImperativeHandle(ref, () &#x3D;&gt; (&#123;    focus: () &#x3D;&gt; &#123;      inputRef.current.focus();    &#125;,  &#125;));  return &lt;input ref&#x3D;&#123;inputRef&#125; &#x2F;*...*&#x2F; &#x2F;&gt;;&#125;FancyInput &#x3D; forwardRef(FancyInput);</code></pre><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæ¸²æŸ“ Â <code>&lt;FancyInput ref=&#123;inputRef&#125; /&gt;</code>Â  çš„çˆ¶ç»„ä»¶å¯ä»¥è°ƒç”¨ Â <code>inputRef.current.focus()</code>ã€‚</p><h2 id="antd-form"><a href="#antd-form" class="headerlink" title="antd form"></a>antd form</h2><h2 id="useImperativeHandle-æºç "><a href="#useImperativeHandle-æºç " class="headerlink" title="useImperativeHandle æºç "></a>useImperativeHandle æºç </h2><pre class="line-numbers language-none"><code class="language-none"></code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jianshu.com/p/1b31b54ab7c0" target="_blank" >vscodeä¸­å¯¹JSæ–‡ä»¶ä½¿ç”¨äº†typeScriptæ£€æµ‹</a></p><p><a href="https://github.com/yaofly2012/note/issues/219" target="_blank" >useImperativeHandle ç¬”è®°</a></p><p><a href="https://segmentfault.com/q/1010000023311358" target="_blank" >ä¸ºä»€ä¹ˆ React æºç ä¸­æœ‰ new.js å’Œ old.js ï¼Ÿ</a></p><p><a href="https://juejin.cn/post/6932763604492140557" target="_blank" >useEffectå’ŒuseLayoutEffectæºç æµ…æ</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode react-javascript-snippetsæºç </title>
      <link href="//post/2022-09-05vscode.html"/>
      <url>//post/2022-09-05vscode.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>è¦åˆ†äº«è‡ªå·±å¼€å‘çš„ä»£ç ç‰‡æ®µå·¥å…· <a href="http://v.aijs.top/post/2022-05-11vscode" target="_blank" ><code>vs-snippets</code></a>ï¼Œæ­£æ‰€è°“ï¼š<code>æ²¡æœ‰å¯¹æ¯”ï¼Œå°±æ²¡æœ‰ä¼¤å®³</code>,äº†è§£ä¸‹åˆ«äººæ˜¯å¦‚ä½•å¼€å‘ä»£ç ç‰‡æ®µæ’ä»¶çš„æ€è·¯ï¼Œåšä¸ªå¯¹æ¯”</p><p>ä¸å¾—ä¸è¯´ï¼Œ<code>react-javascript-snippets</code> æ— è®ºä»æºä»£ç ç»„ç»‡è¿˜æ˜¯æ”¯æŒçš„ä»£ç ç‰‡æ®µæ¥è®²éƒ½éå¸¸ä¼˜ç§€ï¼Œå¯¹äºå¤§ä¼—åŒ–æ¥è®²éå¸¸ niceã€‚ ç„¶è€Œé¡¹ç›®å¼€å‘æ€»æœ‰é‚£ä¹ˆå¤šå®šåˆ¶åŒ–ï¼Œä½œä¸ºä¸€æ¬¾ä»£ç ç‰‡æ®µæ’ä»¶æ¥è®²ï¼Œç§æœ‰å®šåˆ¶åŒ–å´å¹¶ä¸æ˜¯é‚£ä¹ˆçµæ´»</p><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>.json æ–‡ä»¶ä¸èƒ½å¢åŠ æ³¨é‡Š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;name&quot;: &quot;es7-react-js-snippets&quot;,  &quot;displayName&quot;: &quot;ES7+ React&#x2F;Redux&#x2F;React-Native snippets&quot;,  &quot;description&quot;: &quot;Extensions for React, React-Native and Redux in JS&#x2F;TS with ES7+ syntax. Customizable. Built-in integration with prettier.&quot;,  &quot;version&quot;: &quot;4.4.3&quot;,  &quot;publisher&quot;: &quot;dsznajder&quot;,  &quot;icon&quot;: &quot;images&#x2F;logo.png&quot;,  &quot;browser&quot;: &quot;.&#x2F;lib&#x2F;index.js&quot;,  &quot;main&quot;: &quot;.&#x2F;lib&#x2F;index.js&quot;,  &quot;keywords&quot;: [    &quot;snippets&quot;,    &quot;react&quot;,    &quot;redux&quot;,    &quot;react-native&quot;,    &quot;customizable&quot;,    &quot;javascript&quot;,    &quot;typescript&quot;,    &quot;prettier&quot;  ],  &quot;license&quot;: &quot;MIT&quot;,  &quot;repository&quot;: &#123;    &quot;type&quot;: &quot;git&quot;,    &quot;url&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;dsznajder&#x2F;vscode-es7-javascript-react-snippets&quot;  &#125;,  &quot;engines&quot;: &#123;    &quot;vscode&quot;: &quot;^1.60.0&quot;  &#125;,  &#x2F;&#x2F; https:&#x2F;&#x2F;code.visualstudio.com&#x2F;api&#x2F;references&#x2F;extension-manifest#combining-extension-contributions  &quot;categories&quot;: [&quot;Snippets&quot;],  &quot;extensionKind&quot;: [&quot;ui&quot;, &quot;workspace&quot;],  &quot;capabilities&quot;: &#123;    &quot;virtualWorkspaces&quot;: true,    &quot;untrustedWorkspaces&quot;: &#123;      &quot;supported&quot;: true    &#125;  &#125;,  &#x2F;&#x2F; https:&#x2F;&#x2F;code.visualstudio.com&#x2F;api&#x2F;references&#x2F;extension-manifest  &quot;activationEvents&quot;: [    &quot;onLanguage:typescript&quot;,    &quot;onLanguage:typescriptReact&quot;,    &quot;onLanguage:javascript&quot;,    &quot;onLanguage:javascriptReact&quot;,    &quot;onCommand:reactSnippets.search&quot;,    &quot;onStartupFinished&quot;  ],  &quot;contributes&quot;: &#123;    &#x2F;&#x2F; æŸ¥è¯¢å‘½ä»¤    &quot;commands&quot;: [      &#123;        &quot;command&quot;: &quot;reactSnippets.search&quot;,        &quot;title&quot;: &quot;Snippet search&quot;      &#125;    ],    &#x2F;&#x2F; ç»‘å®šå¿«æ·é”®    &quot;keybindings&quot;: [      &#123;        &quot;command&quot;: &quot;reactSnippets.search&quot;,        &quot;key&quot;: &quot;ctrl+alt+r&quot;,        &quot;mac&quot;: &quot;shift+cmd+r&quot;,        &quot;when&quot;: &quot;editorTextFocus&quot;      &#125;    ],    &#x2F;&#x2F; é…ç½®ä¿¡æ¯    &quot;configuration&quot;: &#123;      &quot;title&quot;: &quot;ES React&#x2F;React-Native&#x2F;Redux snippets&quot;,      &quot;properties&quot;: &#123;        &#x2F;&#x2F; æ˜¯å¦å¯ç”¨prettieræ ¼å¼ä»£ç         &quot;reactSnippets.settings.prettierEnabled&quot;: &#123;          &quot;type&quot;: &quot;boolean&quot;,          &quot;markdownDescription&quot;: &quot;[EXPERIMENTAL: MIGHT NOT WORK]: Integrate prettier settings with code generated from snippets.&quot;,          &quot;default&quot;: false        &#125;,        &#x2F;&#x2F; æ˜¯å¦åœ¨é¡¶éƒ¨å¼•å…¥ react importReactOnTop        &quot;reactSnippets.settings.importReactOnTop&quot;: &#123;          &quot;type&quot;: &quot;boolean&quot;,          &quot;markdownDescription&quot;: &quot;Controls if snippets should add &#96;import React from &#39;react&#39;;&#96; at the top of components.\nUse if you have React +17 and use jsx transform.&quot;,          &quot;default&quot;: true        &#125;,        &#x2F;&#x2F; æ˜¯å¦ä½¿ç”¨typescript        &quot;reactSnippets.settings.typescript&quot;: &#123;          &quot;type&quot;: &quot;boolean&quot;,          &quot;markdownDescription&quot;: &quot;Controls if React components have typescript Props typing.&quot;,          &quot;default&quot;: true        &#125;,        &#x2F;&#x2F; è¯­è¨€èŒƒå›´        &quot;reactSnippets.settings.languageScopes&quot;: &#123;          &quot;type&quot;: &quot;string&quot;,          &quot;markdownDescription&quot;: &quot;defines the language scopes for which the snippets will be available.\nUse comma separated values.\nFor example: &#96;typescript,typescriptreact,javascript,javascriptreact&#96;&quot;,          &quot;default&quot;: &quot;typescript,typescriptreact,javascript,javascriptreact&quot;        &#125;,        &#x2F;&#x2F; props&#x2F;state. ä½¿ç”¨typeè¿˜æ˜¯interface        &quot;reactSnippets.settings.typescriptPropsStatePrefix&quot;: &#123;          &quot;type&quot;: &quot;string&quot;,          &quot;markdownDescription&quot;: &quot;Controls which prefix for typescript snippets should use for props&#x2F;state.&quot;,          &quot;default&quot;: &quot;type&quot;,          &quot;enum&quot;: [&quot;type&quot;, &quot;interface&quot;]        &#125;      &#125;    &#125;,    &quot;snippets&quot;: [      &#x2F;&#x2F; jsè¯­è¨€      &#123;        &quot;language&quot;: &quot;javascript&quot;,        &quot;path&quot;: &quot;.&#x2F;lib&#x2F;snippets&#x2F;generated.json&quot;      &#125;,      &#x2F;&#x2F; jsxè¯­è¨€      &#123;        &quot;language&quot;: &quot;javascriptreact&quot;,        &quot;path&quot;: &quot;.&#x2F;lib&#x2F;snippets&#x2F;generated.json&quot;      &#125;,      &#x2F;&#x2F; tsè¯­è¨€      &#123;        &quot;language&quot;: &quot;typescript&quot;,        &quot;path&quot;: &quot;.&#x2F;lib&#x2F;snippets&#x2F;generated.json&quot;      &#125;,      &#x2F;&#x2F; tsxè¯­è¨€      &#123;        &quot;language&quot;: &quot;typescriptreact&quot;,        &quot;path&quot;: &quot;.&#x2F;lib&#x2F;snippets&#x2F;generated.json&quot;      &#125;    ]  &#125;,  &quot;scripts&quot;: &#123;    &quot;vscode:prepublish&quot;: &quot;yarn compile&quot;,    &quot;compile&quot;: &quot;rm -rf lib; tsc -p .&#x2F; --noEmit false --module commonjs --outDir lib&quot;,    &quot;compile:dev&quot;: &quot;rm -rf lib; tsc -p .&#x2F; --noEmit false --module commonjs --outDir lib&quot;,    &quot;lint&quot;: &quot;eslint --ext .js,.ts,.tsx .&#x2F;src&#x2F;&quot;,    &quot;watch&quot;: &quot;tsc -watch -p .&#x2F;&quot;,    &quot;typescript&quot;: &quot;tsc --noEmit&quot;  &#125;,  &quot;dependencies&quot;: &#123;    &quot;prettier&quot;: &quot;2.5.1&quot;  &#125;,  &quot;peerDependencies&quot;: &#123;    &quot;prettier&quot;: &quot;^2&quot;  &#125;,  &quot;devDependencies&quot;: &#123;    &quot;prettier&quot;: &quot;2.5.1&quot;,    &quot;typescript&quot;: &quot;4.5.5&quot;  &#125;,  &#x2F;&#x2F; prettier  é…ç½®  &quot;prettier&quot;: &#123;    &quot;bracketSameLine&quot;: false,    &quot;bracketSpacing&quot;: true,    &quot;printWidth&quot;: 80,    &quot;semi&quot;: true,    &quot;singleQuote&quot;: true,    &quot;tabWidth&quot;: 2,    &quot;trailingComma&quot;: &quot;all&quot;,    &quot;useTabs&quot;: false,    &quot;endOfLine&quot;: &quot;auto&quot;  &#125;&#125;</code></pre><h2 id="tsrcredux-å‘½ä»¤ä¸¾ä¾‹"><a href="#tsrcredux-å‘½ä»¤ä¸¾ä¾‹" class="headerlink" title="tsrcredux å‘½ä»¤ä¸¾ä¾‹"></a>tsrcredux å‘½ä»¤ä¸¾ä¾‹</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123;  exportDefault,  innerComponent,  innerComponentReturn,  propsStateInterface,  propsTypeInterface,  react,  reactComponent,  reactPureComponent,  reduxComponentExport,&#125; from &quot;.&#x2F;sharedSnippets&quot;;&#x2F;&#x2F; src&#x2F;sourceSnippets&#x2F;typescript.ts&#x2F;&#x2F; æºç é“¾æ¥ï¼šhttps:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;vscode-react-javascript-snippets&#x2F;blob&#x2F;185bb91a0b692c54136663464e8225872c434637&#x2F;src&#x2F;sourceSnippets&#x2F;typescript.ts#L175const typescriptReactClassComponentRedux: TypescriptSnippet &#x3D; &#123;  key: &quot;typescriptReactClassComponentRedux&quot;,  prefix: &quot;tsrcredux&quot;,  body: [    &quot;import &#123; connect &#125; from &#39;react-redux&#39;&quot;,    ...reactComponent, &#x2F;&#x2F; æºç  https:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;vscode-react-javascript-snippets&#x2F;blob&#x2F;185bb91a0b692c54136663464e8225872c434637&#x2F;src&#x2F;sourceSnippets&#x2F;sharedSnippets.ts#L18 &#x2F;&#x2F; å¤ç”¨ import React, &#123; Component &#125; from &#39;react&#39;    &quot;&quot;,    ...propsStateInterface, &#x2F;&#x2F; æºç  https:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;vscode-react-javascript-snippets&#x2F;blob&#x2F;185bb91a0b692c54136663464e8225872c434637&#x2F;src&#x2F;sourceSnippets&#x2F;sharedSnippets.ts#L52 type Props &#x3D; &#123;&#125; type State &#x3D; &#123;&#125;    &#96;export class $&#123;Placeholders.FileName&#125; extends Component&lt;Props, State&gt; &#123;&#96;,    &quot;  state &#x3D; &#123;&#125;&quot;,    &quot;&quot;,    ...innerComponentReturn, &#x2F;&#x2F; æºç  https:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;vscode-react-javascript-snippets&#x2F;blob&#x2F;185bb91a0b692c54136663464e8225872c434637&#x2F;src&#x2F;sourceSnippets&#x2F;sharedSnippets.ts#L40    &quot;&#125;&quot;,    ...reduxComponentExport, &#x2F;&#x2F; æºç  https:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;vscode-react-javascript-snippets&#x2F;blob&#x2F;185bb91a0b692c54136663464e8225872c434637&#x2F;src&#x2F;sourceSnippets&#x2F;sharedSnippets.ts#L25  ],  description:    &quot;Creates a React component class with connected redux and ES7 module system and TypeScript interfaces&quot;,&#125;;</code></pre><p>æµ‹è¯•ç»“æœ</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import &#123; connect &#125; from &quot;react-redux&quot;;import React, &#123; Component &#125; from &quot;react&quot;;type Props &#x3D; &#123;&#125;;type State &#x3D; &#123;&#125;;export class tsrcredux&#x2F;**æ–‡ä»¶å *&#x2F; extends Component&lt;Props, State&gt; &#123;  state &#x3D; &#123;&#125;;  render() &#123;    return &lt;div&gt;tsrcreduxx&lt;!--æ–‡ä»¶å --&gt;&lt;&#x2F;div&gt;;  &#125;&#125;const mapStateToProps &#x3D; (state) &#x3D;&gt; (&#123;&#125;);const mapDispatchToProps &#x3D; &#123;&#125;;export default connect(mapStateToProps, mapDispatchToProps)(tsrcreduxx&#x2F;**æ–‡ä»¶å *&#x2F;);</code></pre><img src="http://t-blog-images.aijs.top/img/202209051036707.webp" /><h2 id="æºç è§£è¯»"><a href="#æºç è§£è¯»" class="headerlink" title="æºç è§£è¯»"></a>æºç è§£è¯»</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">ğŸ‘‘ ~&#x2F;haotian&#x2F;github&#x2F;vscode-plugins&#x2F;vscode-react-javascript-snippets&#x2F;src git:(master) $ tree -l.â”œâ”€â”€ helpers &#x2F;&#x2F; å·¥å…·â”‚   â”œâ”€â”€ extensionConfig.ts &#x2F;&#x2F; è·å–å·¥ä½œç©ºé—´çš„é…ç½®ä¿¡æ¯â”‚   â”œâ”€â”€ formatters.ts &#x2F;&#x2F; ä»é…ç½®å·¥ä½œç©ºé—´ä¸­æ‹¿åˆ°é…ç½®ä¿¡æ¯å¯¹ä»£ç ç‰‡æ®µè¿›è¡Œæ ¼å¼åŒ–ï¼Œå¯¹ä»£ç ç‰‡æ®µè¿›è¡Œè§£æï¼Œè½¬åŒ–æˆvscodeæ”¯æŒçš„è¯­æ³•â”‚   â”œâ”€â”€ generateSnippets.ts &#x2F;&#x2F; è·å–sourceSnippets ç›®å½•ä¸‹çš„ä»£ç ç‰‡æ®µï¼Œè¿›è¡Œæ ¼å¼åŒ–è¾“å‡ºåˆ° __dirname + &#39;&#x2F;..&#x2F;snippets&#x2F;generated.json&#39;â”‚   â”œâ”€â”€ getPrettierConfig.ts &#x2F;&#x2F;  è·å–prettierçš„é…ç½®ä¿¡æ¯â”‚   â”œâ”€â”€ parseSnippetToBody.ts &#x2F;&#x2F; å°†ä»£ç ç‰‡æ®µæ”¾åˆ°bodyä¸­ï¼Œä¸­é—´è¿‡ç¨‹å¤„ç†äº†æ˜¯å¦éœ€è¦å¼•å…¥reactâ”‚   â”œâ”€â”€ replaceOrRemoveReactImport.ts &#x2F;&#x2F; æœ‰å¼•å…¥reactå¾—å‰ç¼€æšä¸¾, å¯¹äºä¸éœ€è¦å¼•å…¥reactå¾—è¡Œè¿›è¡Œæ›¿æ¢é™¤å»â”‚   â”œâ”€â”€ snippetPlaceholders.ts &#x2F;&#x2F; 1.Mappings é”®è½¬åŒ–æˆå€¼ï¼Œ 2.Mappings å€¼è½¬åŒ–æˆé”®â”‚   â””â”€â”€ snippetSearch.ts &#x2F;&#x2F;è·å–ä»£ç ç‰‡æ®µï¼Œæ ¼å¼åŒ–æˆ vscode showQuickPick å¯ä»¥ä½¿ç”¨çš„æ•°æ®â”œâ”€â”€ index.ts &#x2F;&#x2F; æ’ä»¶å…¥å£ï¼Œ æ’ä»¶æ¿€æ´»æ—¶å€™ï¼Œ1.å·¥ä½œç©ºé—´é…ç½®æ›´æ”¹ç›‘å¬ï¼Œ window.showWarningMessageæç¤ºæ˜¯å¦éœ€è¦é‡å¯æ’ä»¶ï¼›2.å‘½ä»¤æ³¨å†Œâ”œâ”€â”€ snippetsâ”‚   â””â”€â”€ generated.json &#x2F;&#x2F; generateSnippets ç”Ÿæˆç›®å½•ï¼Œä»¥åŠpackage.json snippetså­—æ®µ ç”¨äºè¯­è¨€åŸŸé…ç½®â”œâ”€â”€ sourceSnippets &#x2F;&#x2F; æºä»£ç ç‰‡æ®µç›®å½•â”‚   â”œâ”€â”€ components.ts &#x2F;&#x2F; reactç»„ä»¶ç›¸å…³â”‚   â”œâ”€â”€ console.ts &#x2F;&#x2F; æ—¥å¿—ç›¸å…³â”‚   â”œâ”€â”€ hooks.ts &#x2F;&#x2F; react hooksç›¸å…³â”‚   â”œâ”€â”€ imports.ts &#x2F;&#x2F; æä¾›äº†ä¸åŒçš„å¼•å…¥æ–¹å¼â”‚   â”œâ”€â”€ others.ts &#x2F;&#x2F; å…¶ä»–ä¹±ä¸ƒå…«ç³Ÿçš„å½’ä¸ºä¸€ç±» js å‡½æ•°ã€æ•°ç»„ã€ç»“æ„ã€classã€å£°æ˜å‘¨æœŸã€react createRef å­å•¦å­å•¦ä¸€å †â”‚   â”œâ”€â”€ propTypes.ts &#x2F;&#x2F; å±æ€§ç›¸å…³çš„â”‚   â”œâ”€â”€ reactNative.ts &#x2F;&#x2F; rn ç›¸å…³çš„â”‚   â”œâ”€â”€ redux.ts &#x2F;&#x2F; reduxç›¸å…³çš„â”‚   â”œâ”€â”€ sharedSnippets.ts &#x2F;&#x2F; è¢«å…¶ä»–ä»£ç ç‰‡æ®µå…±äº«å¤ç”¨çš„éƒ¨åˆ†â”‚   â”œâ”€â”€ tests.ts &#x2F;&#x2F; æµ‹è¯•ä»£ç ç‰‡æ®µï¼Œéæµ‹è¯•æ–‡ä»¶â”‚   â””â”€â”€ typescript.ts &#x2F;&#x2F; tsè¯­æ³•çš„çš„ä»£ç ç‰‡æ®µâ””â”€â”€ types.ts &#x2F;&#x2F; ä¸vsocdeå¯è¯†åˆ«è¯­æ³•çš„ æ˜ å°„å…³ç³»3 directories, 22 files</code></pre><h2 id="è¯¦ç»†æºç æ³¨é‡Š"><a href="#è¯¦ç»†æºç æ³¨é‡Š" class="headerlink" title="è¯¦ç»†æºç æ³¨é‡Š"></a>è¯¦ç»†æºç æ³¨é‡Š</h2><p><a href="https://github.com/841660202/vscode-react-javascript-snippets/blob/master/src/index.ts" target="_blank" >github fork</a></p><h2 id="ç‰‡æ®µè¯­æ³•"><a href="#ç‰‡æ®µè¯­æ³•" class="headerlink" title="ç‰‡æ®µè¯­æ³•"></a>ç‰‡æ®µè¯­æ³•</h2><p><a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets#_snippet-syntax" target="_blank" >è§ visualstudio</a><br><a href="https://blog.csdn.net/maokelong95/article/details/54379046" target="_blank" >è§ åšå®¢</a><br><a href="https://code.visualstudio.com/api/references/extension-manifest#combining-extension-contributions" target="_blank" >extension-manifest categories</a><br><a href="https://code.visualstudio.com/api/references/extension-manifest" target="_blank" >activationEvents</a></p>]]></content>
      
      
      <categories>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ä¸šå¾®ä¿¡ ä¸‹è½½/å¯¼å‡º</title>
      <link href="//post/2022-09-02wx-download.html"/>
      <url>//post/2022-09-02wx-download.html</url>
      
        <content type="html"><![CDATA[<h2 id="æµè§ˆå™¨ç¯å¢ƒ"><a href="#æµè§ˆå™¨ç¯å¢ƒ" class="headerlink" title="æµè§ˆå™¨ç¯å¢ƒ"></a>æµè§ˆå™¨ç¯å¢ƒ</h2><h3 id="a-æ ‡ç­¾æ–¹å¼"><a href="#a-æ ‡ç­¾æ–¹å¼" class="headerlink" title="a æ ‡ç­¾æ–¹å¼"></a>a æ ‡ç­¾æ–¹å¼</h3><p>ä¸€èˆ¬æƒ…å†µ</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * @param &#123; String &#125; target ä¸‹è½½å¯¹è±¡ * @param &#123; String &#125; type ç±»å‹ url &#x2F; blob *&#x2F;export const downloadFile &#x3D; (target, filename &#x3D; &quot;&quot;, type &#x3D; &quot;url&quot;) &#x3D;&gt; &#123;  const link &#x3D; document.createElement(&quot;a&quot;);  const body &#x3D; document.querySelector(&quot;body&quot;);  if (!body) return;  &#x2F;&#x2F; éœ€ä¸‹è½½çš„æ–‡ä»¶ç±»å‹  if (type &#x3D;&#x3D;&#x3D; &quot;url&quot;) &#123;    link.href &#x3D; target;  &#125; else if (type &#x3D;&#x3D;&#x3D; &quot;blob&quot;) &#123;    link.href &#x3D; window.URL.createObjectURL(target);  &#125;  &#x2F;&#x2F; æ–‡ä»¶å  if (filename) link.download &#x3D; filename;  link.style.display &#x3D; &quot;none&quot;;  body.appendChild(link);  link.click();  window.URL.revokeObjectURL(link.href); &#x2F;&#x2F; é‡Šæ”¾ URL å¯¹è±¡  body.removeChild(link);&#125;;</code></pre><h3 id="window-api-æ–¹å¼"><a href="#window-api-æ–¹å¼" class="headerlink" title="window api æ–¹å¼"></a>window api æ–¹å¼</h3><p><code>window.open</code> ã€<code>window.location.href</code></p><p>é€šè¿‡ name å½¢å¼</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">window.open(&quot;url?name&#x3D;èµ„æºæ–‡ä»¶&quot;);window.location.href &#x3D; &quot;url?name&#x3D;èµ„æºæ–‡ä»¶&quot;;</code></pre><h2 id="ä¼ä¸šå¾®ä¿¡ç¯å¢ƒ"><a href="#ä¼ä¸šå¾®ä¿¡ç¯å¢ƒ" class="headerlink" title="ä¼ä¸šå¾®ä¿¡ç¯å¢ƒ"></a>ä¼ä¸šå¾®ä¿¡ç¯å¢ƒ</h2><p>ä¸æ”¯æŒä¸Šè¿°ä¸¤ç§æ–¹å¼æ›´æ”¹ï¼Œå®Œå…¨ç”±åå°æ¥å£è¿”å›æ§åˆ¶</p><img src="http://t-blog-images.aijs.top/img/202209021704425.webp" /><ul><li><p>å¹¶ä¸”ä¼ä¸šå¾®ä¿¡ä¸‹è½½ï¼Œéœ€è¦äºŒæ¬¡ç¡®è®¤ï¼Œä¸‹è½½ä¹‹åï¼Œå¹¶ä¸åƒæµè§ˆå™¨é‚£æ ·æç¤ºåœ¨åº•éƒ¨æç¤ºå·²ä¸‹è½½çš„æ–‡ä»¶</p></li><li><p>å¦‚æœè¿™ä¸ªåœ°æ–¹ <code>Content-Disposition</code> åå°æ²¡æœ‰å¡ filename å­—æ®µï¼Œä¼ä¸šå¾®ä¿¡æç¤ºäºŒæ¬¡ç¡®è®¤æ—¶å€™çš„é‡å‘½å <span style="color: red">è¾“å…¥æ¡†é»˜è®¤æ˜¯ç©ºçš„</span></p></li><li><p>ä¼ä¸šå¾®ä¿¡æ–‡ä»¶APIç†è®ºä¸Šå¯ä»¥ç”¨ï¼Œä½†æ˜¯æœ‰äº›IOSæ‰‹æœºè¿˜æ˜¯å‘å¤šå¤š</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> ä¼ä¸šå¾®ä¿¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ä¸šå¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ahooksæºç </title>
      <link href="//post/2022-08-24ahooks.html"/>
      <url>//post/2022-08-24ahooks.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>éšæ„çœ‹çœ‹ï¼Œäº†è§£ä¸‹ï¼Œæ— å›ºå®šé¡ºåºï¼Œå…¨å‡­å…´è¶£</p><h2 id="useUpdate"><a href="#useUpdate" class="headerlink" title="useUpdate"></a>useUpdate</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>useUpdate ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°ä¼šå¼ºåˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useCallback, useState &#125; from &quot;react&quot;;const useUpdate &#x3D; () &#x3D;&gt; &#123;  const [, setState] &#x3D; useState(&#123;&#125;);  return useCallback(() &#x3D;&gt; setState(&#123;&#125;), []); &#x2F;&#x2F; setState(&#123;&#125;) æ¯æ¬¡ç½®ä¸ºæ–°çš„å¯¹è±¡ï¼Œå³ä½¿é¡µé¢æ²¡æœ‰ç”¨åˆ°è¯¥useStateçš„è¿”å›å€¼ï¼Œä¹Ÿä¼šæ›´æ–°&#125;;export default useUpdate;</code></pre><h2 id="useControllableValue"><a href="#useControllableValue" class="headerlink" title="useControllableValue"></a>useControllableValue</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åœ¨æŸäº›ç»„ä»¶å¼€å‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç»„ä»¶çš„çŠ¶æ€æ—¢å¯ä»¥è‡ªå·±ç®¡ç†ï¼Œä¹Ÿå¯ä»¥è¢«å¤–éƒ¨æ§åˆ¶ï¼ŒuseControllableValue å°±æ˜¯å¸®ä½ ç®¡ç†è¿™ç§çŠ¶æ€çš„ Hookã€‚</p></blockquote><p>ç®€å•æ¥è¯´ï¼Œé»˜è®¤æƒ…å†µä¸‹,å¤–å±‚ç»„ä»¶æœ‰ value, onChange å°±ç”¨å¤–å±‚çš„ï¼Œå¤–å±‚æ²¡æœ‰ï¼Œè‡ªå·±å¤„ç†</p><img src="http://t-blog-images.aijs.top/img/202208241724077.webp" /><p>è™½ç„¶æ˜¯å¤ç”¨ï¼Œå¯è¿™é‡Œè¿™ä¹ˆå†™æœ‰ç‚¹å¥‡æ€ª</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemo, useRef &#125; from &quot;react&quot;;import type &#123; SetStateAction &#125; from &quot;react&quot;;import &#123; isFunction &#125; from &quot;..&#x2F;utils&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;import useUpdate from &quot;..&#x2F;useUpdate&quot;;export interface Options&lt;T&gt; &#123;  defaultValue?: T;  defaultValuePropName?: string;  valuePropName?: string;  trigger?: string;&#125;export type Props &#x3D; Record&lt;string, any&gt;;export interface StandardProps&lt;T&gt; &#123;  value: T;  defaultValue?: T;  onChange: (val: T) &#x3D;&gt; void;&#125;function useControllableValue&lt;T &#x3D; any&gt;(  props: StandardProps&lt;T&gt;): [T, (v: SetStateAction&lt;T&gt;) &#x3D;&gt; void];function useControllableValue&lt;T &#x3D; any&gt;(  props?: Props,  options?: Options&lt;T&gt;): [T, (v: SetStateAction&lt;T&gt;, ...args: any[]) &#x3D;&gt; void];function useControllableValue&lt;T &#x3D; any&gt;(  props: Props &#x3D; &#123;&#125;,  options: Options&lt;T&gt; &#x3D; &#123;&#125;) &#123;  &#x2F;&#x2F; è¿™é‡Œä¸€å †ï¼Œæ˜¯å‡½æ•°é‡å†™ï¼Ÿ  const &#123;    defaultValue,    defaultValuePropName &#x3D; &quot;defaultValue&quot;,    valuePropName &#x3D; &quot;value&quot;,    trigger &#x3D; &quot;onChange&quot;,  &#125; &#x3D; options;  const value &#x3D; props[valuePropName] as T;  &#x2F;&#x2F; options é»˜è®¤æƒ…å†µï¼Œ å¦‚æœ props æœ‰ value å­—æ®µï¼Œåˆ™ç”±çˆ¶çº§æ¥ç®¡æ§åˆ¶ state  const isControlled &#x3D; props.hasOwnProperty(valuePropName);  const initialValue &#x3D; useMemo(() &#x3D;&gt; &#123;    if (isControlled) &#123;      &#x2F;&#x2F; å¦‚æœæ˜¯å—æ§ï¼Œè¿”å›å—æ§çš„value      return value;    &#125;    if (props.hasOwnProperty(defaultValuePropName)) &#123;      &#x2F;&#x2F; éå—æ§ï¼Œpropsæœ‰é»˜è®¤å€¼ï¼Œè¿”å›é»˜è®¤å€¼      return props[defaultValuePropName];    &#125;    return defaultValue;  &#125;, []);  const stateRef &#x3D; useRef(initialValue); &#x2F;&#x2F; å­˜çš„æ˜¯çˆ¶ç»„ä»¶çš„å€¼  if (isControlled) &#123;    stateRef.current &#x3D; value;  &#125;  const update &#x3D; useUpdate(); &#x2F;&#x2F; ä¸Šé¢äº†è§£åˆ°ï¼Œè¯¥ç»„ä»¶ä¼šå¼ºåˆ¶reactè¿›è¡Œé‡æ¸²æŸ“  &#x2F;&#x2F; options é»˜è®¤æƒ…å†µï¼Œstateå˜åŒ–æ—¶å€™ï¼Œä¼šè§¦å‘onChange  function setState(v: SetStateAction&lt;T&gt;, ...args: any[]) &#123;    const r &#x3D; isFunction(v) ? v(stateRef.current) : v;    if (!isControlled) &#123;      &#x2F;&#x2F; éå—æ§ï¼Œé‡æ¸²æŸ“      stateRef.current &#x3D; r;      update();    &#125;    if (props[trigger]) &#123;      &#x2F;&#x2F; æœ‰å›è°ƒï¼Œæ‰§è¡Œå›è°ƒ      props[trigger](r, ...args);    &#125;  &#125;  &#x2F;&#x2F; è¿”å›å­˜çš„å€¼, å¯¹setStateè¿›è¡Œç¼“å­˜  return [stateRef.current, useMemoizedFn(setState)] as const;&#125;export default useControllableValue;</code></pre><h2 id="useLatest"><a href="#useLatest" class="headerlink" title="useLatest"></a>useLatest</h2><h2 id="é—­åŒ…é™·é˜±"><a href="#é—­åŒ…é™·é˜±" class="headerlink" title="é—­åŒ…é™·é˜±"></a>é—­åŒ…é™·é˜±</h2><p>å°†å€¼æ”¾åˆ° ref ä¸Šï¼Œå¹¶è¿”å›ï¼Œå¯ä»¥é˜²â€œé—­åŒ…é™·é˜±â€ï¼Œ</p><p><a href="https://juejin.cn/post/6972893133243695141" target="_blank" >è§</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>useRef æ¯æ¬¡ render æ—¶éƒ½ä¼šè¿”å›åŒä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡ï¼Œæˆ‘ä»¬è®¾ç½®å€¼å’Œè¯»å–å€¼éƒ½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šå¤„ç†ï¼Œè¿™æ ·å°±èƒ½è·å–åˆ°æœ€æ–°çš„ value å€¼äº†ã€‚<br>â€œé—­åŒ…é™·é˜±â€ æœ€å¤§çš„é—®é¢˜å°±æ˜¯åœ¨å‡½æ•°æ•°å†…æ— æ³•è·å–çš„æœ€æ–°çš„ state çš„å€¼ï¼Œé‚£ React æä¾›äº†å“ªäº›æ–¹æ³•æ¥è§£å†³å‘¢ï¼Ÿ</p><ul><li>useRef ä¸Šé¢å·²æœ‰ä»‹ç»</li><li>useState æ›´æ–°å€¼æ—¶ä¼ å…¥å›è°ƒå‡½æ•°</li></ul></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useRef &#125; from &quot;react&quot;;function useLatest&lt;T&gt;(value: T) &#123;  const ref &#x3D; useRef(value);  ref.current &#x3D; value;  return ref;&#125;export default useLatest;</code></pre><h2 id="useMemoizedFn"><a href="#useMemoizedFn" class="headerlink" title="useMemoizedFn"></a>useMemoizedFn</h2><ul><li>2+ç‰ˆæœ¬ï¼Œä¸º<code>usePersistFn</code>, ä½¿ç”¨æ—¶å€™æœ€å¥½ï¼Œå°†è¿™äº› hooks æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ä½œä¸ºå¼•ç”¨çš„è¿‡åº¦æ–‡ä»¶ã€‚ä»¥é˜²ä»¥åå…¨å±€æœ <code>usePersistFn</code> æ›¿æ¢ä¸º <code>useMemoizedFn</code></li></ul><p><code>useMemoizedFn</code> å¦‚ä½•å®ç° <code>useCallback</code> æ•ˆæœï¼Œå´ä¸ç”¨ä½¿ç”¨ç¬¬äºŒå‚æ•° <code>deps</code> å‘¢ï¼Ÿ</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemo, useRef &#125; from &quot;react&quot;;import &#123; isFunction &#125; from &quot;..&#x2F;utils&quot;;type noop &#x3D; (this: any, ...args: any[]) &#x3D;&gt; any;type PickFunction&lt;T extends noop&gt; &#x3D; (  this: ThisParameterType&lt;T&gt;,  ...args: Parameters&lt;T&gt;) &#x3D;&gt; ReturnType&lt;T&gt;;function useMemoizedFn&lt;T extends noop&gt;(fn: T) &#123;  const fnRef &#x3D; useRef&lt;T&gt;(fn);  &#x2F;&#x2F; why not write &#96;fnRef.current &#x3D; fn&#96;?  &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;alibaba&#x2F;hooks&#x2F;issues&#x2F;728  fnRef.current &#x3D; useMemo(() &#x3D;&gt; fn, [fn]); &#x2F;&#x2F; ä¸ºäº†å…¼å®¹ react devtool  const memoizedFn &#x3D; useRef&lt;PickFunction&lt;T&gt;&gt;();  if (!memoizedFn.current) &#123;    &#x2F;&#x2F; ä¸å­˜åœ¨ï¼Œåˆ™é‡æ–°ç”Ÿæˆå‡½æ•°ï¼Œ è¿™é‡Œç”¨äºç¼“å­˜ä¼˜åŒ–ï¼Œä½†æ˜¯å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ä¸Šä¸‹æ–‡ä¸­çš„å‚æ•°æ˜¯æœ€æ–°çš„ï¼Œè§ä¸‹é¢æ¨¡æ‹Ÿï¼ˆå‡ºäºè¿™ç‚¹ï¼Œæ‰€ä»¥ä¸éœ€è¦depsï¼‰    memoizedFn.current &#x3D; function (this, ...args) &#123;      return fnRef.current.apply(this, args);    &#125;;  &#125;  return memoizedFn.current as T;&#125;export default useMemoizedFn;</code></pre><p><strong>æ¨¡æ‹Ÿå‡½æ•°å£°æ˜ï¼Œå‡½æ•°å†…å˜é‡æ›´æ–°</strong></p><img src="http://t-blog-images.aijs.top/img/202208241826880.webp" /><h2 id="useToggle"><a href="#useToggle" class="headerlink" title="useToggle"></a>useToggle</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemo, useState &#125; from &quot;react&quot;;export interface Actions&lt;T&gt; &#123;  setLeft: () &#x3D;&gt; void;  setRight: () &#x3D;&gt; void;  set: (value: T) &#x3D;&gt; void;  toggle: () &#x3D;&gt; void;&#125;&#x2F;&#x2F; 1function useToggle&lt;T &#x3D; boolean&gt;(): [boolean, Actions&lt;T&gt;];&#x2F;&#x2F; 2function useToggle&lt;T&gt;(defaultValue: T): [T, Actions&lt;T&gt;];&#x2F;&#x2F; 3function useToggle&lt;T, U&gt;(  defaultValue: T,  reverseValue: U): [T | U, Actions&lt;T | U&gt;];&#x2F;&#x2F; 4function useToggle&lt;D, R&gt;(  defaultValue: D &#x3D; false as unknown as D,  reverseValue?: R) &#123;  &#x2F;&#x2F; å¯ä»¥ç†è§£ä¸ºç¼“å­˜å§  const [state, setState] &#x3D; useState&lt;D | R&gt;(defaultValue);  const actions &#x3D; useMemo(() &#x3D;&gt; &#123;    &#x2F;&#x2F; æœ€åˆçš„ç›¸åå€¼ &#x3D; è®¾ç½®çš„ç›¸åå€¼ or æ˜¯åˆå§‹å€¼çš„å–å    const reverseValueOrigin &#x3D; (      reverseValue &#x3D;&#x3D;&#x3D; undefined ? !defaultValue : reverseValue    ) as D | R;    &#x2F;&#x2F; é»˜è®¤å€¼å–å    const toggle &#x3D; () &#x3D;&gt;      setState((s) &#x3D;&gt; (s &#x3D;&#x3D;&#x3D; defaultValue ? reverseValueOrigin : defaultValue));    &#x2F;&#x2F; è®¾ç½®å€¼    const set &#x3D; (value: D | R) &#x3D;&gt; setState(value);    &#x2F;&#x2F; è®¾ç½®åˆå§‹å€¼    const setLeft &#x3D; () &#x3D;&gt; setState(defaultValue);    &#x2F;&#x2F; è®¾ç½®ä¸ºç›¸åå€¼    const setRight &#x3D; () &#x3D;&gt; setState(reverseValueOrigin);    &#x2F;&#x2F; è¿™å°±æœ‰ç‚¹æ„æ€äº†ï¼Œå·¦è¾¹å³è¾¹ï¼Œåè¿‡æ¥ï¼Œå†ç¿»è¿‡å»ï¼Œåˆšå¥½ toggle    return &#123;      toggle,      set,      setLeft,      setRight,    &#125;;    &#x2F;&#x2F; useToggle ignore value change    &#x2F;&#x2F; &#125;, [defaultValue, reverseValue]);  &#125;, []);  return [state, actions &#x2F;**è¿™é‡Œæ˜¯å¯¹è±¡ï¼Œå´ç”¨äº†sç»“å°¾ï¼Œä¹ä¸€çœ‹è¿˜ä»¥ä¸ºæ•°ç»„ *&#x2F;];&#125;export default useToggle;</code></pre><h2 id="useBoolean"><a href="#useBoolean" class="headerlink" title="useBoolean"></a>useBoolean</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemo &#125; from &quot;react&quot;;import useToggle from &quot;..&#x2F;useToggle&quot;;&#x2F;&#x2F; è¿™é‡Œä¸ useToggleå¾ˆåƒexport interface Actions &#123;  setTrue: () &#x3D;&gt; void;  setFalse: () &#x3D;&gt; void;  set: (value: boolean) &#x3D;&gt; void;  toggle: () &#x3D;&gt; void;&#125;&#x2F;&#x2F; ä¸»è¦ç”¨toggleæ•´äº†ç‚¹äº‹ï¼Œç„¶åæš´éœ²æ›´å…·æœ‰è¯­ä¹‰è¯çš„apiexport default function useBoolean(defaultValue &#x3D; false): [boolean, Actions] &#123;  const [state, &#123; toggle, set &#125;] &#x3D; useToggle(defaultValue);  const actions: Actions &#x3D; useMemo(() &#x3D;&gt; &#123;    &#x2F;&#x2F; const set &#x3D; (value: D | R) &#x3D;&gt; setState(value);    const setTrue &#x3D; () &#x3D;&gt; set(true);    const setFalse &#x3D; () &#x3D;&gt; set(false);    return &#123;      toggle,      set: (v) &#x3D;&gt; set(!!v),      setTrue,      setFalse,    &#125;;  &#125;, []);  return [state, actions];&#125;</code></pre><h2 id="useMount"><a href="#useMount" class="headerlink" title="useMount"></a>useMount</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect &#125; from &quot;react&quot;;import &#123; isFunction &#125; from &quot;..&#x2F;utils&quot;;const useMount &#x3D; (fn: () &#x3D;&gt; void) &#x3D;&gt; &#123;  &#x2F;&#x2F; åˆ å‡  useEffect(() &#x3D;&gt; &#123;    fn?.();  &#125;, []);&#125;;export default useMount;</code></pre><h2 id="useUnmount"><a href="#useUnmount" class="headerlink" title="useUnmount"></a>useUnmount</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect &#125; from &quot;react&quot;;import useLatest from &quot;..&#x2F;useLatest&quot;;import &#123; isFunction &#125; from &quot;..&#x2F;utils&quot;;const useUnmount &#x3D; (fn: () &#x3D;&gt; void) &#x3D;&gt; &#123;  &#x2F;&#x2F; åˆ å‡  const fnRef &#x3D; useLatest(fn);  useEffect(    () &#x3D;&gt; () &#x3D;&gt; &#123;      fnRef.current();    &#125;,    []  );&#125;;export default useUnmount;</code></pre><h2 id="useUnmountedRef"><a href="#useUnmountedRef" class="headerlink" title="useUnmountedRef"></a>useUnmountedRef</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>è·å–å½“å‰ç»„ä»¶æ˜¯å¦å·²ç»å¸è½½çš„ Hookã€‚</p></blockquote><p>ä»€ä¹ˆä¸šåŠ¡åœºæ™¯ä¼šä½¿ç”¨ï¼Ÿï¼Ÿ</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect, useRef &#125; from &quot;react&quot;;const useUnmountedRef &#x3D; () &#x3D;&gt; &#123;  const unmountedRef &#x3D; useRef(false); &#x2F;&#x2F; é»˜è®¤æ²¡æœ‰å¸è½½  useEffect(() &#x3D;&gt; &#123;    unmountedRef.current &#x3D; false; &#x2F;&#x2F; æŒ‚è½½    return () &#x3D;&gt; &#123;      unmountedRef.current &#x3D; true; &#x2F;&#x2F; å¸è½½    &#125;;  &#125;, []);  return unmountedRef;&#125;;export default useUnmountedRef;</code></pre><h2 id="useUpdateEffect-æœ‰ä¾èµ–é¡¹"><a href="#useUpdateEffect-æœ‰ä¾èµ–é¡¹" class="headerlink" title="useUpdateEffect (æœ‰ä¾èµ–é¡¹)"></a>useUpdateEffect (æœ‰ä¾èµ–é¡¹)</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>useUpdateEffect ç”¨æ³•ç­‰åŒäº useEffectï¼Œä½†æ˜¯ä¼šå¿½ç•¥é¦–æ¬¡æ‰§è¡Œï¼Œåªåœ¨ä¾èµ–æ›´æ–°æ—¶æ‰§è¡Œã€‚</p></blockquote><p><span style="color: red">å¦‚ä½•å®ç°å¿½ç•¥é¦–æ¬¡æ‰§è¡Œçš„</span></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect &#125; from &quot;react&quot;;import &#123; createUpdateEffect &#125; from &quot;..&#x2F;createUpdateEffect&quot;; &#x2F;&#x2F; è§ä¸‹é¢æºç export default createUpdateEffect(useEffect);</code></pre><h2 id="createUpdateEffect"><a href="#createUpdateEffect" class="headerlink" title="createUpdateEffect"></a>createUpdateEffect</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useRef &#125; from &quot;react&quot;;import type &#123; useEffect, useLayoutEffect &#125; from &quot;react&quot;;type EffectHookType &#x3D; typeof useEffect | typeof useLayoutEffect;&#x2F;&#x2F; export const createUpdateEffect: (hook: EffectHookType) &#x3D;&gt; EffectHookType &#x3D; (hook) &#x3D;&gt; (effect, deps) &#x3D;&gt; &#123;export const createUpdateEffect &#x3D; (hook &#x2F;** useEffect *&#x2F;) &#x3D;&gt; (effect, deps) &#x3D;&gt; &#123;  &#x2F;&#x2F; æŸ¯é‡ŒåŒ–  const isMounted &#x3D; useRef(false);  &#x2F;&#x2F; for react-refresh reactåˆ·æ–°æ—¶å€™æ‰§è¡Œå¸è½½  hook(() &#x3D;&gt; &#123;    &#x2F;&#x2F;å¸è½½    return () &#x3D;&gt; &#123;      isMounted.current &#x3D; false;    &#125;;  &#125;, []);  hook(() &#x3D;&gt; &#123;    &#x2F;&#x2F; æŒ‚åœ¨    if (!isMounted.current) &#123;      &#x2F;&#x2F; éç¬¬ä¸€æ¬¡ï¼Œ isMounted.current &#x3D; true , æ­¤æ—¶èµ°  effect()      isMounted.current &#x3D; true;    &#125; else &#123;      return effect();    &#125;  &#125;, deps);&#125;;export default createUpdateEffect;</code></pre><h2 id="useHistoryTravel"><a href="#useHistoryTravel" class="headerlink" title="useHistoryTravel"></a>useHistoryTravel</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ç®¡ç†çŠ¶æ€å†å²å˜åŒ–è®°å½•ï¼Œæ–¹ä¾¿åœ¨å†å²è®°å½•ä¸­å‰è¿›ä¸åé€€ã€‚</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useRef, useState &#125; from &quot;react&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;import &#123; isNumber &#125; from &quot;..&#x2F;utils&quot;;interface IData&lt;T&gt; &#123;  present?: T;  past: T[];  future: T[];&#125;const dumpIndex &#x3D; &lt;T&gt;(step: number, arr: T[]) &#x3D;&gt; &#123;  let index &#x3D;    step &gt; 0      ? step - 1 &#x2F;&#x2F; move forward      : arr.length + step; &#x2F;&#x2F; move backward  if (index &gt;&#x3D; arr.length - 1) &#123;    index &#x3D; arr.length - 1;  &#125;  if (index &lt; 0) &#123;    index &#x3D; 0;  &#125;  return index;&#125;;const split &#x3D; &lt;T&gt;(step: number, targetArr: T[]) &#x3D;&gt; &#123;  const index &#x3D; dumpIndex(step, targetArr);  return &#123;    _current: targetArr[index],    _before: targetArr.slice(0, index),    _after: targetArr.slice(index + 1),  &#125;;&#125;;export default function useHistoryTravel&lt;T&gt;(initialValue?: T) &#123;  const [history, setHistory] &#x3D; useState&lt;IData&lt;T | undefined&gt;&gt;(&#123;    present: initialValue, &#x2F;&#x2F; å½“å‰    past: [], &#x2F;&#x2F; å†å²è®°å½•    future: [], &#x2F;&#x2F; æœªæ¥è®°å½•  &#125;);  const &#123; present, past, future &#125; &#x3D; history;  const initialValueRef &#x3D; useRef(initialValue);  const reset &#x3D; (...params: any[]) &#x3D;&gt; &#123;    const _initial &#x3D; params.length &gt; 0 ? params[0] : initialValueRef.current;    initialValueRef.current &#x3D; _initial;    setHistory(&#123;      present: _initial,      future: [],      past: [],    &#125;);  &#125;;  const updateValue &#x3D; (val: T) &#x3D;&gt; &#123;    setHistory(&#123;      present: val,      future: [],      past: [...past, present],    &#125;);  &#125;;  &#x2F;&#x2F; å‘å‰  const _forward &#x3D; (step: number &#x3D; 1) &#x3D;&gt; &#123;    if (future.length &#x3D;&#x3D;&#x3D; 0) &#123;      return;    &#125;    const &#123; _before, _current, _after &#125; &#x3D; split(step, future);    setHistory(&#123;      past: [...past, present, ..._before],      present: _current,      future: _after,    &#125;);  &#125;;  &#x2F;&#x2F; å‘å  const _backward &#x3D; (step: number &#x3D; -1) &#x3D;&gt; &#123;    if (past.length &#x3D;&#x3D;&#x3D; 0) &#123;      return;    &#125;    const &#123; _before, _current, _after &#125; &#x3D; split(step, past);    setHistory(&#123;      past: _before,      present: _current,      future: [..._after, present, ...future],    &#125;);  &#125;;  &#x2F;&#x2F; å¯è¿›ï¼Œå¯é€€ï¼Œå¯ä¸åŠ¨  const go &#x3D; (step: number) &#x3D;&gt; &#123;    const stepNum &#x3D; isNumber(step) ? step : Number(step);    if (stepNum &#x3D;&#x3D;&#x3D; 0) &#123;      return;    &#125;    if (stepNum &gt; 0) &#123;      return _forward(stepNum);    &#125;    _backward(stepNum);  &#125;;  return &#123;    value: present, &#x2F;&#x2F; å½“å‰    backLength: past.length, &#x2F;&#x2F; å¯åé€€é•¿åº¦    forwardLength: future.length, &#x2F;&#x2F; å¯å‰è¿›é•¿åº¦    setValue: useMemoizedFn(updateValue), &#x2F;&#x2F; è·³è½¬åˆ°å“ªä¸ªè®°å½•    go: useMemoizedFn(go), &#x2F;&#x2F; å›é€€åˆ°å“ªä¸ª    back: useMemoizedFn(() &#x3D;&gt; &#123;      &#x2F;&#x2F; å›é€€ä¸€ä¸ª      go(-1);    &#125;),    forward: useMemoizedFn(() &#x3D;&gt; &#123;      &#x2F;&#x2F; å‰è¿›ä¸€ä¸ª      go(1);    &#125;),    reset: useMemoizedFn(reset), &#x2F;&#x2F; é‡ç½®  &#125;;&#125;</code></pre><h2 id="useInfiniteScroll"><a href="#useInfiniteScroll" class="headerlink" title="useInfiniteScroll"></a>useInfiniteScroll</h2><p>useInfiniteScroll å°è£…äº†å¸¸è§çš„æ— é™æ»šåŠ¨é€»è¾‘ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const &#123; data, loading, loadingMore, loadMore &#125; &#x3D; useInfiniteScroll(service);</code></pre><p>useInfiniteScroll çš„ç¬¬ä¸€ä¸ªå‚æ•° service æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå¯¹è¿™ä¸ªå‡½æ•°çš„å…¥å‚å’Œå‡ºå‚æœ‰å¦‚ä¸‹ <span style="color: red">çº¦å®š</span>ï¼š</p><p>service è¿”å›çš„æ•°æ®å¿…é¡»åŒ…å« list æ•°ç»„ï¼Œç±»å‹ä¸º <code>&#123; list: any[], ...rest &#125;</code><br>service çš„å…¥å‚ä¸ºæ•´åˆåçš„æœ€æ–° data<br>å‡å¦‚ç¬¬ä¸€æ¬¡è¯·æ±‚è¿”å›æ•°æ®ä¸º<code> &#123; list: [1, 2, 3], nextId: 4 &#125;</code>, ç¬¬äºŒæ¬¡è¿”å›çš„æ•°æ®ä¸º<code> &#123; list: [4, 5, 6], nextId: 7 &#125;</code>, åˆ™æˆ‘ä»¬ä¼šè‡ªåŠ¨åˆå¹¶ listï¼Œæ•´åˆåçš„çš„ data ä¸º <code>&#123; list: [1, 2, 3, 4, 5, 6], nextId: 7 &#125;</code>ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemo, useState &#125; from &quot;react&quot;;import useEventListener from &quot;..&#x2F;useEventListener&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;; &#x2F;&#x2F; ç®€åŒ–ç‰ˆuseCallbackimport useRequest from &quot;..&#x2F;useRequest&quot;; &#x2F;&#x2F; è¯·æ±‚å°è£…çš„hook&#x2F;&#x2F; useUpdateEffect ç”¨æ³•ç­‰åŒäº useEffectï¼Œä½†æ˜¯ä¼šå¿½ç•¥é¦–æ¬¡æ‰§è¡Œï¼Œåªåœ¨ä¾èµ–æ›´æ–°æ—¶æ‰§è¡Œã€‚import useUpdateEffect from &quot;..&#x2F;useUpdateEffect&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getClientHeight, getScrollHeight, getScrollTop &#125; from &quot;..&#x2F;utils&#x2F;rect&quot;;import type &#123; Data, InfiniteScrollOptions, Service &#125; from &quot;.&#x2F;types&quot;;const useInfiniteScroll &#x3D; &lt;TData extends Data&gt;(  service: Service&lt;TData&gt;,  options: InfiniteScrollOptions&lt;TData&gt; &#x3D; &#123;&#125;) &#x3D;&gt; &#123;  const &#123;    target,    isNoMore,    threshold &#x3D; 100,    reloadDeps &#x3D; [],    manual,    onBefore,    onSuccess,    onError,    onFinally,  &#125; &#x3D; options;  const [finalData, setFinalData] &#x3D; useState&lt;TData&gt;();  const [loadingMore, setLoadingMore] &#x3D; useState(false);  const noMore &#x3D; useMemo(() &#x3D;&gt; &#123;    if (!isNoMore) return false;    return isNoMore(finalData);  &#125;, [finalData]);  const &#123; loading, run, runAsync, cancel &#125; &#x3D; useRequest(    async (lastData?: TData) &#x3D;&gt; &#123;      const currentData &#x3D; await service(lastData);      if (!lastData) &#123;        setFinalData(currentData);      &#125; else &#123;        setFinalData(&#123;          ...currentData,          &#x2F;&#x2F; @ts-ignore          list: [...lastData.list, ...currentData.list],        &#125;);      &#125;      return currentData;    &#125;,    &#123;      manual,      onFinally: (_, d, e) &#x3D;&gt; &#123;        setLoadingMore(false);        onFinally?.(d, e);      &#125;,      onBefore: () &#x3D;&gt; onBefore?.(),      onSuccess: (d) &#x3D;&gt; &#123;        setTimeout(() &#x3D;&gt; &#123;          &#x2F;&#x2F; eslint-disable-next-line @typescript-eslint&#x2F;no-use-before-define          scrollMethod();        &#125;);        onSuccess?.(d);      &#125;,      onError: (e) &#x3D;&gt; onError?.(e),    &#125;  );  const loadMore &#x3D; () &#x3D;&gt; &#123;    if (noMore) return;    setLoadingMore(true);    run(finalData);  &#125;;  const loadMoreAsync &#x3D; () &#x3D;&gt; &#123;    if (noMore) return Promise.reject();    setLoadingMore(true);    return runAsync(finalData);  &#125;;  const reload &#x3D; () &#x3D;&gt; run();  const reloadAsync &#x3D; () &#x3D;&gt; runAsync();  &#x2F;&#x2F; scrollMethodä¼šå°è¯•å»æ£€æµ‹æ˜¯å¦æ»¡è¶³åŠ è½½æ¡ä»¶  const scrollMethod &#x3D; () &#x3D;&gt; &#123;    const el &#x3D; getTargetElement(target);    if (!el) &#123;      return;    &#125;    const scrollTop &#x3D; getScrollTop(el);    const scrollHeight &#x3D; getScrollHeight(el);    const clientHeight &#x3D; getClientHeight(el);    if (scrollHeight - scrollTop &lt;&#x3D; clientHeight + threshold) &#123;      loadMore();    &#125;  &#125;;  &#x2F;&#x2F; ç›‘å¬æ»šåŠ¨ï¼ŒåŠ è½½ä¸­çš„ä¼šè¢«æ‹¦æ‰ï¼Œ  useEventListener(    &quot;scroll&quot;,    () &#x3D;&gt; &#123;      if (loading || loadingMore) &#123;        return;      &#125;      scrollMethod();    &#125;,    &#123; target &#125;  );  useUpdateEffect(() &#x3D;&gt; &#123;    run();  &#125;, [...reloadDeps]);  return &#123;    &#x2F;&#x2F; æ•°æ®    data: finalData,    loading: !loadingMore &amp;&amp; loading,    loadingMore,    noMore,    &#x2F;&#x2F; ä¸€äº›æ–¹æ³•    loadMore: useMemoizedFn(loadMore),    loadMoreAsync: useMemoizedFn(loadMoreAsync),    &#x2F;&#x2F; è¿™ä¸¤ä¸ªå£°æ˜çš„å‡½æ•°ç›´æ¥è¿”å›    &#x2F;&#x2F; const reload &#x3D; () &#x3D;&gt; run();    &#x2F;&#x2F; const reloadAsync &#x3D; () &#x3D;&gt; runAsync();    reload: useMemoizedFn(reload),    reloadAsync: useMemoizedFn(reloadAsync),    mutate &#x2F;**æ•°æ®çªå˜ *&#x2F;: setFinalData,    cancel,  &#125;;&#125;;export default useInfiniteScroll;</code></pre><h3 id="getTargetElement"><a href="#getTargetElement" class="headerlink" title="getTargetElement"></a>getTargetElement</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import type &#123; MutableRefObject &#125; from &quot;react&quot;;import &#123; isFunction &#125; from &quot;.&#x2F;index&quot;;import isBrowser from &quot;.&#x2F;isBrowser&quot;;type TargetValue&lt;T&gt; &#x3D; T | undefined | null;type TargetType &#x3D; HTMLElement | Element | Window | Document;export type BasicTarget&lt;T extends TargetType &#x3D; Element&gt; &#x3D;  | (() &#x3D;&gt; TargetValue&lt;T&gt;) &#x2F;&#x2F; å‡½æ•°  | TargetValue&lt;T&gt; &#x2F;&#x2F; ç›´æ¥dom  | MutableRefObject&lt;TargetValue&lt;T&gt;&gt;; &#x2F;&#x2F; refexport function getTargetElement&lt;T extends TargetType&gt;(  target: BasicTarget&lt;T&gt;,  defaultElement?: T) &#123;  &#x2F;&#x2F; æœåŠ¡ç«¯æ¸²æŸ“æƒ…å†µ  if (!isBrowser) &#123;    return undefined;  &#125;  &#x2F;&#x2F; å‡è®¾ï¼Œä¸€å®šå­˜åœ¨  if (!target) &#123;    return defaultElement;  &#125;  let targetElement: TargetValue&lt;T&gt;;  &#x2F;&#x2F; å‡½æ•°  if (isFunction(target)) &#123;    targetElement &#x3D; target();    &#x2F;&#x2F; ref  &#125; else if (&quot;current&quot; in target) &#123;    targetElement &#x3D; target.current;    &#x2F;&#x2F; ç›´æ¥dom  &#125; else &#123;    targetElement &#x3D; target;  &#125;  return targetElement;&#125;</code></pre><h3 id="getClientHeight-getScrollHeight-getScrollTop"><a href="#getClientHeight-getScrollHeight-getScrollTop" class="headerlink" title="getClientHeight, getScrollHeight, getScrollTop"></a>getClientHeight, getScrollHeight, getScrollTop</h3><p>ä½¿ç”¨<code>Math.max</code>ï¼Œå¯¹ rect çš„è®¡ç®—è¿›è¡Œå…¼å®¹æ€§å¤„ç†</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const getScrollTop &#x3D; (el: Document | Element) &#x3D;&gt; &#123;  if (el &#x3D;&#x3D;&#x3D; document || el &#x3D;&#x3D;&#x3D; document.body) &#123;    &#x2F;&#x2F; å¤„ç†æµè§ˆå™¨å…¼å®¹æ€§    &#x2F;&#x2F; IE6&#x2F;7&#x2F;8ï¼š    &#x2F;&#x2F; å¯ä»¥ä½¿ç”¨ document.documentElement.scrollTopï¼›    &#x2F;&#x2F; IE9åŠä»¥ä¸Šï¼š    &#x2F;&#x2F; å¯ä»¥ä½¿ç”¨window.pageYOffsetæˆ–è€…document.documentElement.scrollTop    &#x2F;&#x2F; Safari:    &#x2F;&#x2F; safariï¼š window.pageYOffset ä¸document.body.scrollTopéƒ½å¯ä»¥ï¼›    &#x2F;&#x2F; Firefox:    &#x2F;&#x2F; ç«ç‹ç­‰ç­‰ç›¸å¯¹æ ‡å‡†äº›çš„æµè§ˆå™¨å°±çœå¿ƒå¤šäº†ï¼Œç›´æ¥ç”¨window.pageYOffset æˆ–è€… document.documentElement.scrollTop ï¼›    &#x2F;&#x2F; Chromeï¼š    &#x2F;&#x2F; è°·æ­Œæµè§ˆå™¨åªè®¤è¯†document.body.scrollTop;    return Math.max(      window.pageYOffset,      document.documentElement.scrollTop,      document.body.scrollTop    );  &#125;  return (el as Element).scrollTop;&#125;;</code></pre><img src="http://t-blog-images.aijs.top/img/202208301756200.webp" /><p><a href="https://segmentfault.com/a/1190000008065472" target="_blank" >JS åŸºç¡€ç¯‡â€“ body.scrollTop ä¸ documentElement.scrollTop</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const getScrollHeight &#x3D; (el: Document | Element) &#x3D;&gt; &#123;  return (    (el as Element).scrollHeight ||    Math.max(document.documentElement.scrollHeight, document.body.scrollHeight)  );&#125;;const getClientHeight &#x3D; (el: Document | Element) &#x3D;&gt; &#123;  return (    (el as Element).clientHeight ||    Math.max(document.documentElement.clientHeight, document.body.clientHeight)  );&#125;;export &#123; getScrollTop, getScrollHeight, getClientHeight &#125;;</code></pre><h2 id="useEventListener"><a href="#useEventListener" class="headerlink" title="useEventListener"></a>useEventListener</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useLatest from &quot;..&#x2F;useLatest&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useEffectWithTarget from &quot;..&#x2F;utils&#x2F;useEffectWithTarget&quot;;type noop &#x3D; (...p: any) &#x3D;&gt; void;export type Target &#x3D; BasicTarget&lt;HTMLElement | Element | Window | Document&gt;;type Options&lt;T extends Target &#x3D; Target&gt; &#x3D; &#123;  target?: T;  capture?: boolean;  once?: boolean;  passive?: boolean;&#125;;function useEventListener&lt;K extends keyof HTMLElementEventMap&gt;(  eventName: K,  handler: (ev: HTMLElementEventMap[K]) &#x3D;&gt; void,  options?: Options&lt;HTMLElement&gt;): void;function useEventListener&lt;K extends keyof ElementEventMap&gt;(  eventName: K,  handler: (ev: ElementEventMap[K]) &#x3D;&gt; void,  options?: Options&lt;Element&gt;): void;function useEventListener&lt;K extends keyof DocumentEventMap&gt;(  eventName: K,  handler: (ev: DocumentEventMap[K]) &#x3D;&gt; void,  options?: Options&lt;Document&gt;): void;function useEventListener&lt;K extends keyof WindowEventMap&gt;(  eventName: K,  handler: (ev: WindowEventMap[K]) &#x3D;&gt; void,  options?: Options&lt;Window&gt;): void;function useEventListener(  eventName: string,  handler: noop,  options: Options): void;function useEventListener(  eventName: string,  handler: noop,  options: Options &#x3D; &#123;&#125;) &#123;  const handlerRef &#x3D; useLatest(handler);  useEffectWithTarget(    &#x2F;&#x2F; åšäº†ç¼“å­˜    &#x2F;&#x2F; effect    () &#x3D;&gt; &#123;      const targetElement &#x3D; getTargetElement(options.target, window);      if (!targetElement?.addEventListener) &#123;        return;      &#125;      const eventListener &#x3D; (event: Event) &#x3D;&gt; &#123;        return handlerRef.current(event);      &#125;;      targetElement.addEventListener(eventName, eventListener, &#123;        capture: options.capture,        once: options.once,        passive: options.passive,      &#125;);      return () &#x3D;&gt; &#123;        targetElement.removeEventListener(eventName, eventListener, &#123;          capture: options.capture,        &#125;);      &#125;;    &#125;,    &#x2F;&#x2F; deps ä¾èµ–é¡¹    [eventName, options.capture, options.once, options.passive],    &#x2F;&#x2F; target    options.target  );&#125;export default useEventListener;</code></pre><h2 id="useEffectWithTarget"><a href="#useEffectWithTarget" class="headerlink" title="useEffectWithTarget"></a>useEffectWithTarget</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect &#125; from &quot;react&quot;;import createEffectWithTarget from &quot;.&#x2F;createEffectWithTarget&quot;;&#x2F;&#x2F; createEffectWithTargetå°†useEffectè¿›è¡ŒåŒ…è£¹const useEffectWithTarget &#x3D; createEffectWithTarget(useEffect);export default useEffectWithTarget;</code></pre><h2 id="createEffectWithTarget"><a href="#createEffectWithTarget" class="headerlink" title="createEffectWithTarget"></a>createEffectWithTarget</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import type &#123;  DependencyList,  EffectCallback,  useEffect,  useLayoutEffect,&#125; from &quot;react&quot;;import &#123; useRef &#125; from &quot;react&quot;;import useUnmount from &quot;..&#x2F;useUnmount&quot;;import depsAreSame from &quot;.&#x2F;depsAreSame&quot;;import type &#123; BasicTarget &#125; from &quot;.&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;.&#x2F;domTarget&quot;;const createEffectWithTarget &#x3D; (  useEffectType: typeof useEffect | typeof useLayoutEffect) &#x3D;&gt; &#123;  &#x2F;**   *   * @param effect   * @param deps   * @param target target should compare ref.current vs ref.current, dom vs dom, ()&#x3D;&gt;dom vs ()&#x3D;&gt;dom   *&#x2F;  const useEffectWithTarget &#x3D; (    effect: EffectCallback,    deps: DependencyList,    target: BasicTarget&lt;any&gt; | BasicTarget&lt;any&gt;[]  ) &#x3D;&gt; &#123;    const hasInitRef &#x3D; useRef(false);    const lastElementRef &#x3D; useRef&lt;(Element | null)[]&gt;([]);    const lastDepsRef &#x3D; useRef&lt;DependencyList&gt;([]);    const unLoadRef &#x3D; useRef&lt;any&gt;();    &#x2F;&#x2F; ç±»å‹ useEffectType: typeof useEffect | typeof useLayoutEffect    useEffectType(() &#x3D;&gt; &#123;      const targets &#x3D; Array.isArray(target) ? target : [target];      const els &#x3D; targets.map((item) &#x3D;&gt; getTargetElement(item));      &#x2F;&#x2F; init run      if (!hasInitRef.current) &#123;        hasInitRef.current &#x3D; true;        lastElementRef.current &#x3D; els;        lastDepsRef.current &#x3D; deps;        unLoadRef.current &#x3D; effect(); &#x2F;&#x2F; æ‰§è¡Œç»“æœ        return;      &#125;      &#x2F;&#x2F; å¦‚ä¸Šæ–‡æ³¨é‡Šï¼š @param target target should compare ref.current vs ref.current, dom vs dom, ()&#x3D;&gt;dom vs ()&#x3D;&gt;dom      &#x2F;&#x2F; å­˜åœ¨ä¸ç­‰æƒ…å†µä¼šæ‰§è¡Œèµ‹å€¼      if (        els.length !&#x3D;&#x3D; lastElementRef.current.length ||        !depsAreSame(els, lastElementRef.current) ||        !depsAreSame(deps, lastDepsRef.current)      ) &#123;        unLoadRef.current?.(); &#x2F;&#x2F; æ‰§è¡Œ        lastElementRef.current &#x3D; els;        lastDepsRef.current &#x3D; deps;        unLoadRef.current &#x3D; effect();      &#125;    &#125;);    &#x2F;&#x2F; å¸è½½    useUnmount(() &#x3D;&gt; &#123;      unLoadRef.current?.();      &#x2F;&#x2F; for react-refresh      hasInitRef.current &#x3D; false;    &#125;);  &#125;;  return useEffectWithTarget;&#125;;export default createEffectWithTarget;</code></pre><h2 id="useWhyDidYouUpdate"><a href="#useWhyDidYouUpdate" class="headerlink" title="useWhyDidYouUpdate"></a>useWhyDidYouUpdate</h2><p><a href="https://ahooks.js.org/zh-CN/hooks/use-why-did-you-update#params" target="_blank" >è§</a></p><p>åŸç†ï¼šuseEffect åœ¨ç»„ä»¶æ›´æ–°æ—¶å€™ä¼šæ‰§è¡Œï¼Œ å°†ä¹‹å‰çš„ props å­˜åœ¨ ref ä¸Šï¼Œä¹‹åä¼šå°†æ‰€æœ‰çš„ key æ¯”è¾ƒï¼Œæ‰¾åˆ°å˜æ›´çš„ key çš„ changedProps</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect, useRef &#125; from &quot;react&quot;;export type IProps &#x3D; Record&lt;string, any&gt;;export default function useWhyDidYouUpdate(  componentName: string,  props: IProps) &#123;  const prevProps &#x3D; useRef&lt;IProps&gt;(&#123;&#125;);  useEffect(() &#x3D;&gt; &#123;    if (prevProps.current) &#123;      const allKeys &#x3D; Object.keys(&#123; ...prevProps.current, ...props &#125;);      const changedProps: IProps &#x3D; &#123;&#125;;      allKeys.forEach((key) &#x3D;&gt; &#123;        if (!Object.is(prevProps.current[key], props[key])) &#123;          changedProps[key] &#x3D; &#123;            from: prevProps.current[key],            to: props[key],          &#125;;        &#125;      &#125;);      if (Object.keys(changedProps).length) &#123;        console.log(&quot;[why-did-you-update]&quot;, componentName, changedProps);      &#125;    &#125;    prevProps.current &#x3D; props;  &#125;);&#125;</code></pre><h2 id="useUrlState"><a href="#useUrlState" class="headerlink" title="useUrlState"></a>useUrlState</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemoizedFn, useUpdate &#125; from &quot;ahooks&quot;;import &#123; parse, stringify &#125; from &quot;query-string&quot;;import type &#123; ParseOptions, StringifyOptions &#125; from &quot;query-string&quot;;import &#123; useMemo, useRef &#125; from &quot;react&quot;;import type * as React from &quot;react&quot;;import * as tmp from &quot;react-router&quot;;&#x2F;&#x2F; ignore waring &#96;&quot;export &#39;useNavigate&#39; (imported as &#39;rc&#39;) was not found in &#39;react-router&#39;&#96;const rc &#x3D; tmp as any;export interface Options &#123;  navigateMode?: &quot;push&quot; | &quot;replace&quot;;  parseOptions?: ParseOptions;  stringifyOptions?: StringifyOptions;&#125;const baseParseConfig: ParseOptions &#x3D; &#123;  parseNumbers: false,  parseBooleans: false,&#125;;const baseStringifyConfig: StringifyOptions &#x3D; &#123;  skipNull: false,  skipEmptyString: false,&#125;;type UrlState &#x3D; Record&lt;string, any&gt;;const useUrlState &#x3D; &lt;S extends UrlState &#x3D; UrlState&gt;(  initialState?: S | (() &#x3D;&gt; S),  options?: Options) &#x3D;&gt; &#123;  type State &#x3D; Partial&lt;&#123; [key in keyof S]: any &#125;&gt;;  const &#123;    navigateMode &#x3D; &quot;push&quot;, &#x2F;&#x2F; çŠ¶æ€å˜æ›´æ—¶åˆ‡æ¢ history çš„æ–¹å¼    parseOptions,    stringifyOptions,  &#125; &#x3D; options || &#123;&#125;;  const mergedParseOptions &#x3D; &#123; ...baseParseConfig, ...parseOptions &#125;;  const mergedStringifyOptions &#x3D; &#123;    ...baseStringifyConfig,    ...stringifyOptions,  &#125;;  const location &#x3D; rc.useLocation();  &#x2F;&#x2F; react-router v5  const history &#x3D; rc.useHistory?.();  &#x2F;&#x2F; react-router v6  const navigate &#x3D; rc.useNavigate?.();  const update &#x3D; useUpdate();  const initialStateRef &#x3D; useRef(    typeof initialState &#x3D;&#x3D;&#x3D; &quot;function&quot;      ? (initialState as () &#x3D;&gt; S)()      : initialState || &#123;&#125;  );  &#x2F;&#x2F; è§£æå‡º query  const queryFromUrl &#x3D; useMemo(() &#x3D;&gt; &#123;    return parse(location.search, mergedParseOptions);  &#125;, [location.search]);  &#x2F;&#x2F; æ›´æ”¹åçš„ query  const targetQuery: State &#x3D; useMemo(    () &#x3D;&gt; (&#123;      ...initialStateRef.current,      ...queryFromUrl,    &#125;),    [queryFromUrl]  );  const setState &#x3D; (s: React.SetStateAction&lt;State&gt;) &#x3D;&gt; &#123;    &#x2F;&#x2F; å¦‚æœæ˜¯å‡½æ•°ï¼Œåˆ™å°†ä¸Šä¸€ä¸ªå€¼ï¼Œä½œä¸ºå‚æ•°ä¼ å…¥    const newQuery &#x3D; typeof s &#x3D;&#x3D;&#x3D; &quot;function&quot; ? s(targetQuery) : s;    &#x2F;&#x2F; 1. å¦‚æœ setState åï¼Œsearch æ²¡å˜åŒ–ï¼Œå°±éœ€è¦ update æ¥è§¦å‘ä¸€æ¬¡æ›´æ–°ã€‚æ¯”å¦‚ demo1 ç›´æ¥ç‚¹å‡» clearï¼Œå°±éœ€è¦ update æ¥è§¦å‘æ›´æ–°ã€‚    &#x2F;&#x2F; 2. update å’Œ history çš„æ›´æ–°ä¼šåˆå¹¶ï¼Œä¸ä¼šé€ æˆå¤šæ¬¡æ›´æ–°    update(); &#x2F;&#x2F; æ‹…å¿ƒä¸æ›´æ–°    if (history) &#123;      history[navigateMode](&#123;        hash: location.hash,        search:          stringify(&#123; ...queryFromUrl, ...newQuery &#125;, mergedStringifyOptions) ||          &quot;?&quot;,      &#125;);    &#125;    if (navigate) &#123;      navigate(        &#123;          hash: location.hash,          search:            stringify(              &#123; ...queryFromUrl, ...newQuery &#125;,              mergedStringifyOptions            ) || &quot;?&quot;,        &#125;,        &#123;          replace: navigateMode &#x3D;&#x3D;&#x3D; &quot;replace&quot;,        &#125;      );    &#125;  &#125;;  return [targetQuery &#x2F;**url query å¯¹è±¡ *&#x2F;, useMemoizedFn(setState)] as const;&#125;;export default useUrlState;</code></pre><h2 id="useSafeState"><a href="#useSafeState" class="headerlink" title="useSafeState"></a>useSafeState</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ç”¨æ³•ä¸ React.useState å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯åœ¨ç»„ä»¶å¸è½½åå¼‚æ­¥å›è°ƒå†…çš„ setState ä¸å†æ‰§è¡Œï¼Œé¿å…å› ç»„ä»¶å¸è½½åæ›´æ–°çŠ¶æ€è€Œå¯¼è‡´çš„å†…å­˜æ³„æ¼ã€‚</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useCallback, useState &#125; from &quot;react&quot;;import type &#123; Dispatch, SetStateAction &#125; from &quot;react&quot;;&#x2F;&#x2F; &gt; è·å–å½“å‰ç»„ä»¶æ˜¯å¦å·²ç»å¸è½½çš„ Hookã€‚import useUnmountedRef from &quot;..&#x2F;useUnmountedRef&quot;;function useSafeState&lt;S&gt;(  initialState: S | (() &#x3D;&gt; S)): [S, Dispatch&lt;SetStateAction&lt;S&gt;&gt;];function useSafeState&lt;S &#x3D; undefined&gt;(): [  S | undefined,  Dispatch&lt;SetStateAction&lt;S | undefined&gt;&gt;];function useSafeState&lt;S&gt;(initialState?: S | (() &#x3D;&gt; S)) &#123;  const unmountedRef &#x3D; useUnmountedRef();  const [state, setState] &#x3D; useState(initialState);  const setCurrentState &#x3D; useCallback((currentState) &#x3D;&gt; &#123;    &#x2F;** if component is unmounted, stop update *&#x2F;    &#x2F;&#x2F; ç»„ä»¶å¸è½½åœæ­¢æ›´æ–°    if (unmountedRef.current) return;    setState(currentState);  &#125;, []);  return [state, setCurrentState] as const;&#125;export default useSafeState;</code></pre><h2 id="useGetState"><a href="#useGetState" class="headerlink" title="useGetState"></a>useGetState</h2><p>å†…éƒ¨ä½¿ç”¨ <code>useRef</code> ç¼“å­˜äº†å€¼ï¼Œåœ¨è°ƒç”¨ <code>getState</code> æ—¶å€™ï¼Œå°† ref å€¼è¿”å›.</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import type &#123; Dispatch, SetStateAction &#125; from &quot;react&quot;;import &#123; useState, useRef, useCallback &#125; from &quot;react&quot;;type GetStateAction&lt;S&gt; &#x3D; () &#x3D;&gt; S;function useGetState&lt;S&gt;(  initialState: S | (() &#x3D;&gt; S)): [S, Dispatch&lt;SetStateAction&lt;S&gt;&gt;, GetStateAction&lt;S&gt;];function useGetState&lt;S &#x3D; undefined&gt;(): [  S | undefined,  Dispatch&lt;SetStateAction&lt;S | undefined&gt;&gt;,  GetStateAction&lt;S | undefined&gt;];function useGetState&lt;S&gt;(initialState?: S) &#123;  const [state, setState] &#x3D; useState(initialState);  const stateRef &#x3D; useRef(state);  stateRef.current &#x3D; state;  const getState &#x3D; useCallback(() &#x3D;&gt; stateRef.current, []);  return [state, setState, getState];&#125;export default useGetState;</code></pre><h2 id="useResetState"><a href="#useResetState" class="headerlink" title="useResetState"></a>useResetState</h2><p><code>initialState</code>çš„å€¼ï¼Œç”¨äºé‡ç½®</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useState &#125; from &quot;react&quot;;import type &#123; Dispatch, SetStateAction &#125; from &quot;react&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;type ResetState &#x3D; () &#x3D;&gt; void;const useResetState &#x3D; &lt;S&gt;(  initialState: S | (() &#x3D;&gt; S)): [S, Dispatch&lt;SetStateAction&lt;S&gt;&gt;, ResetState] &#x3D;&gt; &#123;  const [state, setState] &#x3D; useState(initialState);  const resetState &#x3D; useMemoizedFn(() &#x3D;&gt; &#123;    setState(initialState);  &#125;);  return [state, setState, resetState];&#125;;export default useResetState;</code></pre><h2 id="useRafState"><a href="#useRafState" class="headerlink" title="useRafState"></a>useRafState</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åªåœ¨ requestAnimationFrame callback æ—¶æ›´æ–° stateï¼Œä¸€èˆ¬ç”¨äºæ€§èƒ½ä¼˜åŒ–ã€‚</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useCallback, useRef, useState &#125; from &quot;react&quot;;import type &#123; Dispatch, SetStateAction &#125; from &quot;react&quot;;import useUnmount from &quot;..&#x2F;useUnmount&quot;;function useRafState&lt;S&gt;(  initialState: S | (() &#x3D;&gt; S)): [S, Dispatch&lt;SetStateAction&lt;S&gt;&gt;];function useRafState&lt;S &#x3D; undefined&gt;(): [  S | undefined,  Dispatch&lt;SetStateAction&lt;S | undefined&gt;&gt;];function useRafState&lt;S&gt;(initialState?: S | (() &#x3D;&gt; S)) &#123;  &#x2F;&#x2F; å…ˆå‰è°ƒç”¨window.requestAnimationFrame()æ–¹æ³•æ—¶è¿”å›çš„ ID.  const ref &#x3D; useRef(0); &#x2F;&#x2F; requestID  const [state, setState] &#x3D; useState(initialState);  const setRafState &#x3D; useCallback((value: S | ((prevState: S) &#x3D;&gt; S)) &#x3D;&gt; &#123;    &#x2F;&#x2F; cancelAnimationFrame å–æ¶ˆä¸€ä¸ªå…ˆå‰é€šè¿‡è°ƒç”¨window.requestAnimationFrame()æ–¹æ³•æ·»åŠ åˆ°è®¡åˆ’ä¸­çš„åŠ¨ç”»å¸§è¯·æ±‚ã€‚    cancelAnimationFrame(ref.current &#x2F;**requestID *&#x2F;);    ref.current &#x3D; requestAnimationFrame(() &#x3D;&gt; &#123;      setState(value);    &#125;);  &#125;, []);  &#x2F;&#x2F; å¸è½½ï¼Œå–æ¶ˆåŠ¨ç”»é•‡  useUnmount(() &#x3D;&gt; &#123;    cancelAnimationFrame(ref.current &#x2F;**requestID *&#x2F;);  &#125;);  return [state, setRafState] as const;&#125;export default useRafState;</code></pre><h2 id="usePrevious"><a href="#usePrevious" class="headerlink" title="usePrevious"></a>usePrevious</h2><p>å…ˆçŒœä¸‹ï¼Œåˆç”¨äº† ref è¿›è¡Œç¼“å­˜</p><p>æ‚„æ‚„æºç </p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useRef &#125; from &quot;react&quot;;export type ShouldUpdateFunc&lt;T&gt; &#x3D; (prev: T | undefined, next: T) &#x3D;&gt; boolean;const defaultShouldUpdate &#x3D; &lt;T&gt;(a?: T, b?: T) &#x3D;&gt; !Object.is(a, b); &#x2F;&#x2F; é»˜è®¤æ¯”è¾ƒfunction usePrevious&lt;T&gt;(  state: T,  shouldUpdate: ShouldUpdateFunc&lt;T&gt; &#x3D; defaultShouldUpdate): T | undefined &#123;  const prevRef &#x3D; useRef&lt;T&gt;(); &#x2F;&#x2F; å­˜å‰ä¸€ä¸ª  const curRef &#x3D; useRef&lt;T&gt;(); &#x2F;&#x2F; å­˜å½“å‰ï¼ŒğŸ¤”ï¼Œå­˜å½“å‰çš„ï¼Œç›¸å½“äºä¸­ä»‹ï¼Œå¦‚ï¼šæŠŠä¸¤ç“¶æ°´äº¤æ¢ï¼Œå€ŸåŠ©ç¬¬ä¸‰ä¸ªç“¶å­  if (shouldUpdate(curRef.current, state)) &#123;    &#x2F;&#x2F; ä¸ä¸€æ ·ï¼Œæ›´æ–°å€¼    prevRef.current &#x3D; curRef.current;    curRef.current &#x3D; state;  &#125;  return prevRef.current; &#x2F;&#x2F; æœ€ç»ˆè¿”å›ä¹‹å‰çš„å€¼&#125;export default usePrevious;</code></pre><h2 id="useMap"><a href="#useMap" class="headerlink" title="useMap"></a>useMap</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useState &#125; from &quot;react&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;function useMap&lt;K, T&gt;(initialValue?: Iterable&lt;readonly [K, T]&gt;) &#123;  &#x2F;&#x2F; åˆå§‹å€¼  const getInitValue &#x3D; () &#x3D;&gt; &#123;    return initialValue &#x3D;&#x3D;&#x3D; undefined ? new Map() : new Map(initialValue);  &#125;;  const [map, setMap] &#x3D; useState&lt;Map&lt;K, T&gt;&gt;(() &#x3D;&gt; getInitValue());  &#x2F;&#x2F; è®¾ç½®ï¼Œ æ–°æ—§åˆå¹¶ï¼Œæ–°çš„å±æ€§ä¼šè¦†ç›–æ—§çš„  const set &#x3D; (key: K, entry: T) &#x3D;&gt; &#123;    setMap((prev) &#x3D;&gt; &#123;      const temp &#x3D; new Map(prev); &#x2F;&#x2F; å°†ä¹‹å‰çš„å€¼æ‹·è´ï¼Œåˆ‡æ–­ temp ä¸ prevä¹‹é—´è”ç³»ï¼Ÿ      temp.set(key, entry);      return temp;    &#125;);  &#125;;  &#x2F;&#x2F; å®Œå…¨é‡æ–°èµ‹å€¼  const setAll &#x3D; (newMap: Iterable&lt;readonly [K, T]&gt;) &#x3D;&gt; &#123;    setMap(new Map(newMap));  &#125;;  &#x2F;&#x2F; åˆ é™¤æŸä¸ªkeyå¯¹åº”çš„å€¼  const remove &#x3D; (key: K) &#x3D;&gt; &#123;    setMap((prev) &#x3D;&gt; &#123;      const temp &#x3D; new Map(prev);      temp.delete(key);      return temp;    &#125;);  &#125;;  &#x2F;&#x2F; é‡ç½®ï¼Œæ¢å¤ä¸ºåˆå§‹å€¼  const reset &#x3D; () &#x3D;&gt; setMap(getInitValue());  &#x2F;&#x2F; æ ¹æ®keyè¿”å›å€¼ï¼Œ map æ˜¯useStateä¸Šçš„map  const get &#x3D; (key: K) &#x3D;&gt; map.get(key);  return [    map,    &#123;      &#x2F;&#x2F; ä¸€äº›æ–¹æ³•ï¼ŒåŒ…è£¹åï¼Œæš´éœ²å‡ºå»      set: useMemoizedFn(set),      setAll: useMemoizedFn(setAll),      remove: useMemoizedFn(remove),      reset: useMemoizedFn(reset),      get: useMemoizedFn(get),    &#125;,  ] as const;&#125;export default useMap;</code></pre><h2 id="useSet"><a href="#useSet" class="headerlink" title="useSet"></a>useSet</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useState &#125; from &quot;react&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;function useSet&lt;K&gt;(initialValue?: Iterable&lt;K&gt;) &#123;  const getInitValue &#x3D; () &#x3D;&gt; &#123;    return initialValue &#x3D;&#x3D;&#x3D; undefined ? new Set&lt;K&gt;() : new Set(initialValue);  &#125;;  const [set, setSet] &#x3D; useState&lt;Set&lt;K&gt;&gt;(() &#x3D;&gt; getInitValue());  &#x2F;&#x2F; å·²ç»æœ‰çš„ï¼Œä¸ä¼šé‡å¤æ·»åŠ ï¼Œsetå­˜å€¼ï¼Œä¿è¯å”¯ä¸€ï¼Œæ²¡å¿…è¦é‡å¤æ’å…¥  const add &#x3D; (key: K) &#x3D;&gt; &#123;    if (set.has(key)) &#123;      return;    &#125;    setSet((prevSet) &#x3D;&gt; &#123;      const temp &#x3D; new Set(prevSet);      temp.add(key);      return temp;    &#125;);  &#125;;  &#x2F;&#x2F; æ²¡æœ‰ä¸ç»§ç»­æ‰§è¡Œï¼Œæœ‰ç»§ç»­ä¹‹å‰ï¼Œå°†prevSetï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„Set,ç„¶ååˆ é™¤key,å¹¶è¿”å›æ–°çš„mapï¼Œ  const remove &#x3D; (key: K) &#x3D;&gt; &#123;    if (!set.has(key)) &#123;      return;    &#125;    setSet((prevSet) &#x3D;&gt; &#123;      const temp &#x3D; new Set(prevSet);      temp.delete(key);      return temp;    &#125;);  &#125;;  &#x2F;&#x2F; é‡ç½®åˆ°æœ€åˆå€¼  const reset &#x3D; () &#x3D;&gt; setSet(getInitValue());  return [    set,    &#123;      &#x2F;&#x2F; æ–¹æ³•ï¼Œç¼“å­˜ä¸‹      add: useMemoizedFn(add),      remove: useMemoizedFn(remove),      reset: useMemoizedFn(reset),    &#125;,  ] as const;&#125;export default useSet;</code></pre><p>useMap&#x2F;useSet è¿”å›çš„éƒ½æ˜¯æ–°çš„ Map&#x2F;Set å¯¹è±¡, æ‰€ä»¥æ¯æ¬¡å˜åŒ–éƒ½ä¼šè§¦å‘æ›´æ–°ã€‚ä¹‹å‰å¼€å‘ä¸­è¿›è¡Œçªå˜ï¼Œä¸ä¼šè§¦å‘é¡µé¢æ›´æ–°</p><h2 id="useMemoizedFn-1"><a href="#useMemoizedFn-1" class="headerlink" title="useMemoizedFn"></a>useMemoizedFn</h2><p>æŒä¹…åŒ– function çš„ Hookï¼Œç†è®ºä¸Šï¼Œå¯ä»¥ä½¿ç”¨ useMemoizedFn å®Œå…¨ä»£æ›¿ useCallbackã€‚</p><p>åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ useCallback æ¥è®°ä½ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•° deps å˜åŒ–æ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆå‡½æ•°ï¼Œå¯¼è‡´å‡½æ•°åœ°å€å˜åŒ–ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const [state, setState] &#x3D; useState(&quot;&quot;);&#x2F;&#x2F; åœ¨ state å˜åŒ–æ—¶ï¼Œfunc åœ°å€ä¼šå˜åŒ–const func &#x3D; useCallback(() &#x3D;&gt; &#123;  console.log(state);&#125;, [state]);</code></pre><p>ä½¿ç”¨ useMemoizedFnï¼Œå¯ä»¥çœç•¥ç¬¬äºŒä¸ªå‚æ•° depsï¼Œ<span style="color: red">åŒæ—¶ä¿è¯å‡½æ•°åœ°å€æ°¸è¿œä¸ä¼šå˜åŒ–</span>ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>å¦‚æœä»¥åœ°å€å˜åŒ–çš„æ›´æ–°ï¼Œä¸å¯ç”¨ <code>useMemoizedFn</code></p></div><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const [state, setState] &#x3D; useState(&quot;&quot;);&#x2F;&#x2F; func åœ°å€æ°¸è¿œä¸ä¼šå˜åŒ–const func &#x3D; useMemoizedFn(() &#x3D;&gt; &#123;  console.log(state);&#125;);</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useMemo, useRef &#125; from &quot;react&quot;;import &#123; isFunction &#125; from &quot;..&#x2F;utils&quot;;import isDev from &quot;..&#x2F;utils&#x2F;isDev&quot;;type noop &#x3D; (this: any, ...args: any[]) &#x3D;&gt; any;type PickFunction&lt;T extends noop&gt; &#x3D; (  this: ThisParameterType&lt;T&gt;,  ...args: Parameters&lt;T&gt;) &#x3D;&gt; ReturnType&lt;T&gt;;function useMemoizedFn&lt;T extends noop&gt;(fn: T) &#123;  if (isDev) &#123;    if (!isFunction(fn)) &#123;      console.error(        &#96;useMemoizedFn expected parameter is a function, got $&#123;typeof fn&#125;&#96;      );    &#125;  &#125;  &#x2F;&#x2F; ä¸‹é¢è¿™ä¸¤è¡Œä»£ç çœ‹ä¸Šå»ç¡®å®æœ‰ç‚¹å¥‡æ€ª  &#x2F;&#x2F; ä¸ºäº†è§£å†³ usePersistFnï¼ˆuseMemoizedFnï¼‰ä¸èƒ½å…¼å®¹react devtool  const fnRef &#x3D; useRef&lt;T&gt;(fn);  &#x2F;&#x2F; why not write &#96;fnRef.current &#x3D; fn&#96;?  &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;alibaba&#x2F;hooks&#x2F;issues&#x2F;728  fnRef.current &#x3D; useMemo(() &#x3D;&gt; fn, [fn]);  &#x2F;&#x2F; ç¼“å­˜å‡½æ•°åœ°å€  const memoizedFn &#x3D; useRef&lt;PickFunction&lt;T&gt;&gt;();  if (!memoizedFn.current) &#123;    memoizedFn.current &#x3D; function (this, ...args) &#123;      &#x2F;&#x2F; æ²¡æœ‰å‡½æ•°çš„æ—¶å€™ï¼Œè¿™é‡Œé‡æ–°ç”Ÿæˆäº†ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å°†æ‰§è¡Œç»“æœä½œä¸ºæ–°å‡½æ•°çš„ç»“æœ      return fnRef.current.apply(this, args); &#x2F;&#x2F; fnRef.current, ä»ç¼“å­˜é‡Œå–çš„    &#125;;  &#125;  return memoizedFn.current as T;&#125;export default useMemoizedFn;</code></pre><h2 id="useFocusWithin"><a href="#useFocusWithin" class="headerlink" title="useFocusWithin"></a>useFocusWithin</h2><p>ç›‘å¬å½“å‰ç„¦ç‚¹æ˜¯å¦åœ¨æŸä¸ªåŒºåŸŸä¹‹å†…ï¼ŒåŒ css å±æ€§ :focus-within</p><p>å¯ç”¨äºï¼š èšç„¦å‘é€è¯·æ±‚ï¼Œä»¥ä¿è¯ç”¨æˆ·è·å–æœ€æ–°æ•°æ®</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useState &#125; from &quot;react&quot;;import useEventListener from &quot;..&#x2F;useEventListener&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;export interface Options &#123;  onFocus?: (e: FocusEvent) &#x3D;&gt; void;  onBlur?: (e: FocusEvent) &#x3D;&gt; void;  onChange?: (isFocusWithin: boolean) &#x3D;&gt; void;&#125;export default function useFocusWithin(target: BasicTarget, options?: Options) &#123;  const [isFocusWithin, setIsFocusWithin] &#x3D; useState(false);  const &#123; onFocus, onBlur, onChange &#125; &#x3D; options || &#123;&#125;;  useEventListener(    &quot;focusin&quot;,    (e: FocusEvent) &#x3D;&gt; &#123;      if (!isFocusWithin) &#123;        onFocus?.(e);        onChange?.(true);        setIsFocusWithin(true); &#x2F;&#x2F; èšç„¦      &#125;    &#125;,    &#123;      target,    &#125;  );  useEventListener(    &quot;focusout&quot;,    (e: FocusEvent) &#x3D;&gt; &#123;      &#x2F;&#x2F; contains åŸç”Ÿ      if (        isFocusWithin &amp;&amp;        !(e.currentTarget as Element)?.contains?.(e.relatedTarget as Element)      ) &#123;        onBlur?.(e);        onChange?.(false);        setIsFocusWithin(false); &#x2F;&#x2F; å¤±å»ç„¦ç‚¹      &#125;    &#125;,    &#123;      target,    &#125;  );  return isFocusWithin;&#125;</code></pre><p>é—®é¢˜ï¼šæˆ‘è®°å¾—æœ‰ä¸ªé—´éš”å¤šä¹…ä¹‹åï¼Œå†æ¬¡èšç„¦æ‰å‘é€è¯·æ±‚çš„ï¼Œä¹‹åçœ‹çœ‹æ˜¯å“ªä¸ª api</p><h2 id="useTitle"><a href="#useTitle" class="headerlink" title="useTitle"></a>useTitle</h2><p>è¿™ä¸ª api åœ¨<code>nextjs</code>ä¸­æˆ–è®¸ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨ï¼Œå› ä¸º nextjs æœ‰è‡ªå·±çš„ apiï¼Œ<code>useTitle</code>æ›´æ–°åï¼Œä¼šè¢« nextjs<code>&lt;Title&gt;&lt;/Title&gt;</code>ç»™è¦†ç›–æ‰</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect, useRef &#125; from &quot;react&quot;;import useUnmount from &quot;..&#x2F;useUnmount&quot;;import isBrowser from &quot;..&#x2F;utils&#x2F;isBrowser&quot;;export interface Options &#123;  restoreOnUnmount?: boolean;&#125;const DEFAULT_OPTIONS: Options &#x3D; &#123;  restoreOnUnmount: false,&#125;;function useTitle(title: string, options: Options &#x3D; DEFAULT_OPTIONS) &#123;  const titleRef &#x3D; useRef(isBrowser ? document.title : &quot;&quot;);  &#x2F;&#x2F; é¢ï¼Œè¿™é‡Œåœ¨æœåŠ¡ç«¯å¯ä»¥æ‹¿åˆ° documentå—ï¼Ÿå¦‚æœæ‹¿ä¸åˆ°ä¼šæŠ¥é”™çš„ï¼Œæ²¡åŠ  isBrowser åˆ¤æ–­ï¼Œé‚£ä¹ˆåœ¨æœåŠ¡ç«¯å¯ä»¥æ‹¿åˆ°  useEffect(() &#x3D;&gt; &#123;    document.title &#x3D; title;  &#125;, [title]);  useUnmount(() &#x3D;&gt; &#123;    &#x2F;&#x2F; restoreOnUnmountç»„ä»¶å¸è½½æ—¶ï¼Œæ˜¯å¦æ¢å¤ä¸Šä¸€ä¸ªé¡µé¢æ ‡é¢˜    if (options.restoreOnUnmount) &#123;      &#x2F;&#x2F; å¸è½½æ¢å¤      document.title &#x3D; titleRef.current;    &#125;  &#125;);&#125;export default useTitle;</code></pre><h2 id="useFavicon"><a href="#useFavicon" class="headerlink" title="useFavicon"></a>useFavicon</h2><p>å®ç°ï¼šlink æ ‡ç­¾æ›´æ”¹&#x2F;åŠ¨æ€åˆ›å»ºæ ‡ç­¾æ”¾åˆ° head å°¾éƒ¨</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect &#125; from &quot;react&quot;;&#x2F;&#x2F; shortcut icon ç±»å‹é™åˆ¶const ImgTypeMap &#x3D; &#123;  SVG: &quot;image&#x2F;svg+xml&quot;,  ICO: &quot;image&#x2F;x-icon&quot;,  GIF: &quot;image&#x2F;gif&quot;,  PNG: &quot;image&#x2F;png&quot;,&#125;;type ImgTypes &#x3D; keyof typeof ImgTypeMap;const useFavicon &#x3D; (href: string) &#x3D;&gt; &#123;  useEffect(() &#x3D;&gt; &#123;    if (!href) return;    &#x2F;&#x2F; æˆªå–åç¼€åˆ¤æ–­æ˜¯å¦æ»¡è¶³    const cutUrl &#x3D; href.split(&quot;.&quot;);    const imgSuffix &#x3D; cutUrl[cutUrl.length - 1].toLocaleUpperCase() as ImgTypes;    &#x2F;&#x2F;å­˜åœ¨è·å–ï¼Œä¸å­˜åœ¨    const link: HTMLLinkElement &#x3D;      document.querySelector(&quot;link[rel*&#x3D;&#39;icon&#39;]&quot;) ||      document.createElement(&quot;link&quot;);    link.type &#x3D; ImgTypeMap[imgSuffix];    link.href &#x3D; href;    link.rel &#x3D; &quot;shortcut icon&quot;;    document.getElementsByTagName(&quot;head&quot;)[0].appendChild(link);  &#125;, [href]);&#125;;export default useFavicon;</code></pre><h2 id="useFullscreen"><a href="#useFullscreen" class="headerlink" title="useFullscreen"></a>useFullscreen</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useState &#125; from &quot;react&quot;;import screenfull from &quot;screenfull&quot;; &#x2F;&#x2F; @link https:&#x2F;&#x2F;github.com&#x2F;sindresorhus&#x2F;screenfull&#x2F;blob&#x2F;main&#x2F;index.jsimport useLatest from &quot;..&#x2F;useLatest&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;import useUnmount from &quot;..&#x2F;useUnmount&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;export interface Options &#123;  onExit?: () &#x3D;&gt; void;  onEnter?: () &#x3D;&gt; void;&#125;const useFullscreen &#x3D; (target: BasicTarget, options?: Options) &#x3D;&gt; &#123;  const &#123; onExit, onEnter &#125; &#x3D; options || &#123;&#125;;  &#x2F;&#x2F; é€€å‡º  const onExitRef &#x3D; useLatest(onExit);  &#x2F;&#x2F; è¿›å…¥  const onEnterRef &#x3D; useLatest(onEnter);  &#x2F;&#x2F; æ˜¯å¦å…¨å±  const [state, setState] &#x3D; useState(false);  const onChange &#x3D; () &#x3D;&gt; &#123;    if (screenfull.isEnabled) &#123;      &#x2F;&#x2F; æ”¯æŒå…¨å±      const &#123; isFullscreen &#125; &#x3D; screenfull;      if (isFullscreen) &#123;        onEnterRef.current?.();      &#125; else &#123;        screenfull.off(&quot;change&quot;, onChange);        onExitRef.current?.();      &#125;      setState(isFullscreen);    &#125;  &#125;;  const enterFullscreen &#x3D; () &#x3D;&gt; &#123;    const el &#x3D; getTargetElement(target);    if (!el) &#123;      return;    &#125;    if (screenfull.isEnabled) &#123;      &#x2F;&#x2F; æ”¯æŒå…¨å±      try &#123;        &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;sindresorhus&#x2F;screenfull&#x2F;blob&#x2F;991e917bffc818c5367186c6ec5e70ae7a37cfc5&#x2F;index.js#L80        screenfull.request(el);        screenfull.on(&quot;change&quot;, onChange);      &#125; catch (error) &#123;        console.error(error);      &#125;    &#125;  &#125;;  const exitFullscreen &#x3D; () &#x3D;&gt; &#123;    &#x2F;&#x2F; æ”¯æŒå…¨å±    if (screenfull.isEnabled) &#123;      &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;sindresorhus&#x2F;screenfull&#x2F;blob&#x2F;991e917bffc818c5367186c6ec5e70ae7a37cfc5&#x2F;index.js#L96      &#x2F;&#x2F; å¥‡æ€ªäº†ï¼Œè¿™é‡Œæ€ä¹ˆè¿”å›äº†ä¸€ä¸ªpromise      screenfull.exit();    &#125;  &#125;;  const toggleFullscreen &#x3D; () &#x3D;&gt; &#123;    if (state) &#123;      exitFullscreen();    &#125; else &#123;      enterFullscreen();    &#125;  &#125;;  useUnmount(() &#x3D;&gt; &#123;    if (screenfull.isEnabled) &#123;      &#x2F;&#x2F; æ”¯æŒå…¨å±      screenfull.off(&quot;change&quot;, onChange);    &#125;  &#125;);  return [    state,    &#123;      enterFullscreen: useMemoizedFn(enterFullscreen),      exitFullscreen: useMemoizedFn(exitFullscreen),      toggleFullscreen: useMemoizedFn(toggleFullscreen),      isEnabled: screenfull.isEnabled,    &#125;,  ] as const;&#125;;export default useFullscreen;</code></pre><h2 id="screenfull"><a href="#screenfull" class="headerlink" title="screenfull"></a>screenfull</h2><p><a href="https://github.com/sindresorhus/screenfull/blob/991e917bffc818c5367186c6ec5e70ae7a37cfc5/index.js#L50">https://github.com/sindresorhus/screenfull/blob/991e917bffc818c5367186c6ec5e70ae7a37cfc5/index.js#L50</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const nativeAPI &#x3D; (() &#x3D;&gt; &#123;  if (typeof document &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) &#123;    return false;  &#125;  const unprefixedMethods &#x3D; methodMap[0];  const returnValue &#x3D; &#123;&#125;;  for (const methodList of methodMap &#x2F;**äºŒç»´æ•°ç»„ *&#x2F;) &#123;    const exitFullscreenMethod &#x3D; methodList?.[1];    if (exitFullscreenMethod in document) &#123;      &#x2F;&#x2F; æ”¯æŒçš„æ–¹æ³•ï¼Œéƒ½ç»™æå–å‡ºæ¥ï¼Œæ”¾åˆ° nativeAPI,ä¹‹åä½¿ç”¨nativeAPIä¸Šçš„æ–¹æ³•      for (const [index, method] of methodList.entries()) &#123;        returnValue[unprefixedMethods[index]] &#x3D; method;      &#125;      return returnValue;    &#125;  &#125;  return false;&#125;)();&#x2F;&#x2F; ....let screenfull &#x3D; &#123;  &#x2F;&#x2F; eslint-disable-next-line default-param-last  request(element &#x3D; document.documentElement, options) &#123;&#125;,  &#x2F;&#x2F; é€€å‡ºå…¨å±  exit() &#123;&#125;,  &#x2F;&#x2F; å…¨å±&#x2F;éå…¨å±åˆ‡æ¢  toggle(element, options) &#123;&#125;,  &#x2F;&#x2F; æ›´æ”¹  onchange(callback) &#123;&#125;,  &#x2F;&#x2F; é”™è¯¯å¤„ç†  onerror(callback) &#123;&#125;,  &#x2F;&#x2F; äº‹ä»¶ç›‘å¬  on(event, callback) &#123;&#125;,  &#x2F;&#x2F; ç§»é™¤ç›‘å¬  off(event, callback) &#123;&#125;,  &#x2F;&#x2F; åŸç”Ÿapi  raw: nativeAPI,&#125;;&#x2F;&#x2F; æ‰©å±•ä¸‰ä¸ªæ–¹æ³•Object.defineProperties(screenfull, &#123;  isFullscreen: &#123;    get: () &#x3D;&gt; Boolean(document[nativeAPI.fullscreenElement]),  &#125;,  element: &#123;    enumerable: true,    get: () &#x3D;&gt; document[nativeAPI.fullscreenElement] ?? undefined,  &#125;,  isEnabled: &#123;    enumerable: true,    &#x2F;&#x2F; Coerce to boolean in case of old WebKit.    get: () &#x3D;&gt; Boolean(document[nativeAPI.fullscreenEnabled]),  &#125;,&#125;);&#x2F;&#x2F; nativeAPIä¸º&#123;&#125; , ä¸æ”¯æŒåŸç”Ÿ isEnabled ä¸º false, æ‰€ä»¥åœ¨ç”¨screenfullä¸Šapiæ—¶å€™éƒ½è¦å…ˆç”¨isEnabledåˆ¤æ–­ä¸‹if (!nativeAPI) &#123;  screenfull &#x3D; &#123; isEnabled: false &#125;;&#125;export default screenfull;</code></pre><h2 id="useExternal"><a href="#useExternal" class="headerlink" title="useExternal"></a>useExternal</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åŠ¨æ€æ³¨å…¥ JS æˆ– CSS èµ„æºï¼ŒuseExternal å¯ä»¥ä¿è¯èµ„æºå…¨å±€å”¯ä¸€ã€‚</p></blockquote><p>å®ç°åŸç†ï¼šé€šè¿‡ <code>useEffect</code>,deps ä¸æ”¹å˜ï¼Œé€»è¾‘ä¸ä¼šé‡å¤æ‰§è¡Œçš„ç‰¹ç‚¹</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect, useRef, useState &#125; from &quot;react&quot;;export interface Options &#123;  type?: &quot;js&quot; | &quot;css&quot;;  js?: Partial&lt;HTMLScriptElement&gt;;  css?: Partial&lt;HTMLStyleElement&gt;;&#125;&#x2F;&#x2F; &#123;[path]: count&#125;&#x2F;&#x2F; remove external when no usedconst EXTERNAL_USED_COUNT: Record&lt;string, number&gt; &#x3D; &#123;&#125;;export type Status &#x3D; &quot;unset&quot; | &quot;loading&quot; | &quot;ready&quot; | &quot;error&quot;;interface loadResult &#123;  ref: Element;  status: Status;&#125;&#x2F;&#x2F; åŠ è½½jsconst loadScript &#x3D; (path: string, props &#x3D; &#123;&#125;): loadResult &#x3D;&gt; &#123;  const script &#x3D; document.querySelector(&#96;script[src&#x3D;&quot;$&#123;path&#125;&quot;]&#96;);  if (!script) &#123;    const newScript &#x3D; document.createElement(&quot;script&quot;);    newScript.src &#x3D; path;    Object.keys(props).forEach((key) &#x3D;&gt; &#123;      newScript[key] &#x3D; props[key];    &#125;);    newScript.setAttribute(&quot;data-status&quot;, &quot;loading&quot;);    document.body.appendChild(newScript);    return &#123;      ref: newScript,      status: &quot;loading&quot;,    &#125;;  &#125;  return &#123;    ref: script,    status: (script.getAttribute(&quot;data-status&quot;) as Status) || &quot;ready&quot;,  &#125;;&#125;;&#x2F;&#x2F; åŠ è½½cssconst loadCss &#x3D; (path: string, props &#x3D; &#123;&#125;): loadResult &#x3D;&gt; &#123;  const css &#x3D; document.querySelector(&#96;link[href&#x3D;&quot;$&#123;path&#125;&quot;]&#96;);  if (!css) &#123;    const newCss &#x3D; document.createElement(&quot;link&quot;);    newCss.rel &#x3D; &quot;stylesheet&quot;;    newCss.href &#x3D; path;    Object.keys(props).forEach((key) &#x3D;&gt; &#123;      newCss[key] &#x3D; props[key];    &#125;);    &#x2F;&#x2F; IE9+    const isLegacyIECss &#x3D; &quot;hideFocus&quot; in newCss;    &#x2F;&#x2F; use preload in IE Edge (to detect load errors)    if (isLegacyIECss &amp;&amp; newCss.relList) &#123;      newCss.rel &#x3D; &quot;preload&quot;;      newCss.as &#x3D; &quot;style&quot;;    &#125;    newCss.setAttribute(&quot;data-status&quot;, &quot;loading&quot;);    document.head.appendChild(newCss);    return &#123;      ref: newCss,      status: &quot;loading&quot;,    &#125;;  &#125;  return &#123;    ref: css,    status: (css.getAttribute(&quot;data-status&quot;) as Status) || &quot;ready&quot;,  &#125;;&#125;;const useExternal &#x3D; (path?: string, options?: Options) &#x3D;&gt; &#123;  const [status, setStatus] &#x3D; useState&lt;Status&gt;(path ? &quot;loading&quot; : &quot;unset&quot;);  const ref &#x3D; useRef&lt;Element&gt;();  useEffect(() &#x3D;&gt; &#123;    if (!path) &#123;      &#x2F;&#x2F; æ²¡æœ‰èµ„æºï¼Œç›´æ¥æ‹¦æˆªæ‰      setStatus(&quot;unset&quot;);      return;    &#125;    const pathname &#x3D; path.replace(&#x2F;[|#].*$&#x2F;, &quot;&quot;);    &#x2F;&#x2F; css    if (      options?.type &#x3D;&#x3D;&#x3D; &quot;css&quot; ||      (!options?.type &amp;&amp; &#x2F;(^css!|\.css$)&#x2F;.test(pathname))    ) &#123;      const result &#x3D; loadCss(path, options?.css);      ref.current &#x3D; result.ref;      setStatus(result.status);      &#x2F;&#x2F; js    &#125; else if (      options?.type &#x3D;&#x3D;&#x3D; &quot;js&quot; ||      (!options?.type &amp;&amp; &#x2F;(^js!|\.js$)&#x2F;.test(pathname))    ) &#123;      const result &#x3D; loadScript(path, options?.js);      ref.current &#x3D; result.ref;      setStatus(result.status);    &#125; else &#123;      &#x2F;&#x2F; å…¶ä»–æƒ…å†µä¸å¤„ç†      &#x2F;&#x2F; do nothing      console.error(        &quot;Cannot infer the type of external resource, and please provide a type (&#39;js&#39; | &#39;css&#39;). &quot; +          &quot;Refer to the https:&#x2F;&#x2F;ahooks.js.org&#x2F;hooks&#x2F;dom&#x2F;use-external&#x2F;#options&quot;      );    &#125;    &#x2F;&#x2F; éjs&#x2F;cssï¼Œè¿™é‡Œä¼šé˜»æ­¢æ‰ç»§ç»­æ‰§è¡Œ    if (!ref.current) &#123;      return;    &#125;    if (EXTERNAL_USED_COUNT[path] &#x3D;&#x3D;&#x3D; undefined) &#123;      EXTERNAL_USED_COUNT[path] &#x3D; 1;    &#125; else &#123;      EXTERNAL_USED_COUNT[path] +&#x3D; 1;    &#125;    const handler &#x3D; (event: Event) &#x3D;&gt; &#123;      const targetStatus &#x3D; event.type &#x3D;&#x3D;&#x3D; &quot;load&quot; ? &quot;ready&quot; : &quot;error&quot;;      ref.current?.setAttribute(&quot;data-status&quot;, targetStatus);      setStatus(targetStatus);    &#125;;    &#x2F;&#x2F; ç›‘å¬èµ„æºåŠ è½½æƒ…å†µ    ref.current.addEventListener(&quot;load&quot;, handler);    ref.current.addEventListener(&quot;error&quot;, handler);    &#x2F;&#x2F; å¸è½½    return () &#x3D;&gt; &#123;      ref.current?.removeEventListener(&quot;load&quot;, handler);      ref.current?.removeEventListener(&quot;error&quot;, handler);      EXTERNAL_USED_COUNT[path] -&#x3D; 1;      if (EXTERNAL_USED_COUNT[path] &#x3D;&#x3D;&#x3D; 0) &#123;        ref.current?.remove(); &#x2F;&#x2F; è¿™é‡Œé€šè¿‡removeæ–¹æ³•ç§»é™¤ å¯¹åº”çš„dom      &#125;      ref.current &#x3D; undefined;    &#125;;  &#125;, [path]);  return status;&#125;;export default useExternal;</code></pre><p><code>dom.remove()</code>ç§»é™¤ dom æµ‹è¯•</p><img src="http://t-blog-images.aijs.top/img/202209011131253.gif" /><h2 id="useHover"><a href="#useHover" class="headerlink" title="useHover"></a>useHover</h2><p>ç›‘å¬ DOM å…ƒç´ æ˜¯å¦æœ‰é¼ æ ‡æ‚¬åœã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useBoolean from &quot;..&#x2F;useBoolean&quot;;import useEventListener from &quot;..&#x2F;useEventListener&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;export interface Options &#123;  onEnter?: () &#x3D;&gt; void;  onLeave?: () &#x3D;&gt; void;  onChange?: (isHovering: boolean) &#x3D;&gt; void;&#125;export default (target: BasicTarget, options?: Options): boolean &#x3D;&gt; &#123;  const &#123; onEnter, onLeave, onChange &#125; &#x3D; options || &#123;&#125;;  const [state, &#123; setTrue, setFalse &#125;] &#x3D; useBoolean(false);  &#x2F;&#x2F; ç›‘å¬é¼ æ ‡è¿›å…¥  useEventListener(    &quot;mouseenter&quot;,    () &#x3D;&gt; &#123;      onEnter?.();      setTrue();      onChange?.(true);    &#125;,    &#123;      target,    &#125;  );  &#x2F;&#x2F; ç›‘å¬é¼ æ ‡ç¦»å¼€  useEventListener(    &quot;mouseleave&quot;,    () &#x3D;&gt; &#123;      onLeave?.();      setFalse();      onChange?.(false);    &#125;,    &#123;      target,    &#125;  );  &#x2F;&#x2F; isHovering é¼ æ ‡å…ƒç´ æ˜¯å¦å¤„äº hover  return state;&#125;;</code></pre><h2 id="useInViewport"><a href="#useInViewport" class="headerlink" title="useInViewport"></a>useInViewport</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>è§‚å¯Ÿå…ƒç´ æ˜¯å¦åœ¨å¯è§åŒºåŸŸï¼Œä»¥åŠå…ƒç´ å¯è§æ¯”ä¾‹ã€‚æ›´å¤šä¿¡æ¯å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API" target="_blank" >Intersection Observer API</a>ã€‚</p></blockquote><details class="custom-details"><summary>IntersectionObserver</summary><p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Intersection Observer API æä¾›äº†ä¸€ç§å¼‚æ­¥æ£€æµ‹ç›®æ ‡å…ƒç´ ä¸ç¥–å…ˆå…ƒç´ æˆ– viewport ç›¸äº¤æƒ…å†µå˜åŒ–çš„æ–¹æ³•ã€‚</p><p>è¿‡å»ï¼Œè¦æ£€æµ‹ä¸€ä¸ªå…ƒç´ æ˜¯å¦å¯è§æˆ–è€…ä¸¤ä¸ªå…ƒç´ æ˜¯å¦ç›¸äº¤å¹¶ä¸å®¹æ˜“ï¼Œå¾ˆå¤šè§£å†³åŠæ³•ä¸å¯é æˆ–æ€§èƒ½å¾ˆå·®ã€‚ç„¶è€Œï¼Œéšç€äº’è”ç½‘çš„å‘å±•ï¼Œè¿™ç§éœ€æ±‚å´ä¸æ—¥ä¿±å¢ï¼Œæ¯”å¦‚ï¼Œä¸‹é¢è¿™äº›æƒ…å†µéƒ½éœ€è¦ç”¨åˆ°ç›¸äº¤æ£€æµ‹ï¼š</p><ul><li>å›¾ç‰‡æ‡’åŠ è½½â€”â€”å½“å›¾ç‰‡æ»šåŠ¨åˆ°å¯è§æ—¶æ‰è¿›è¡ŒåŠ è½½</li><li>å†…å®¹æ— é™æ»šåŠ¨â€”â€”ä¹Ÿå°±æ˜¯ç”¨æˆ·æ»šåŠ¨åˆ°æ¥è¿‘å†…å®¹åº•éƒ¨æ—¶ç›´æ¥åŠ è½½æ›´å¤šï¼Œè€Œæ— éœ€ç”¨æˆ·æ“ä½œç¿»é¡µï¼Œç»™ç”¨æˆ·ä¸€ç§ç½‘é¡µå¯ä»¥æ— é™æ»šåŠ¨çš„é”™è§‰</li><li>æ£€æµ‹å¹¿å‘Šçš„æ›å…‰æƒ…å†µâ€”â€”ä¸ºäº†è®¡ç®—å¹¿å‘Šæ”¶ç›Šï¼Œéœ€è¦çŸ¥é“å¹¿å‘Šå…ƒç´ çš„æ›å…‰æƒ…å†µ</li><li>åœ¨ç”¨æˆ·çœ‹è§æŸä¸ªåŒºåŸŸæ—¶æ‰§è¡Œä»»åŠ¡æˆ–æ’­æ”¾åŠ¨ç”»</li></ul></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å‡å¦‚æœ‰ä¸€ä¸ªæ— é™æ»šåŠ¨çš„ç½‘é¡µï¼Œå¼€å‘è€…ä½¿ç”¨äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“æ¥ç®¡ç†æ•´ä¸ªé¡µé¢çš„å¹¿å‘Šï¼Œåˆç”¨äº†å¦å¤–ä¸€ä¸ªåº“æ¥å®ç°æ¶ˆæ¯ç›’å­å’Œç‚¹èµï¼Œå¹¶ä¸”é¡µé¢æœ‰å¾ˆå¤šåŠ¨ç”»ï¼ˆè¯‘æ³¨ï¼šåŠ¨ç”»å¾€å¾€æ„å‘³ç€è¾ƒé«˜çš„æ€§èƒ½æ¶ˆè€—ï¼‰ã€‚ä¸¤ä¸ªåº“éƒ½æœ‰è‡ªå·±çš„ç›¸äº¤æ£€æµ‹ç¨‹åºï¼Œéƒ½è¿è¡Œåœ¨ä¸»çº¿ç¨‹é‡Œï¼Œ<span style="color: red">è€Œç½‘ç«™çš„å¼€å‘è€…å¯¹è¿™äº›åº“çš„å†…éƒ¨å®ç°çŸ¥ä¹‹ç”šå°‘ï¼Œæ‰€ä»¥å¹¶æœªæ„è¯†åˆ°æœ‰ä»€ä¹ˆé—®é¢˜</span>ã€‚ä½†å½“ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶ï¼Œè¿™äº›ç›¸äº¤æ£€æµ‹ç¨‹åºå°±ä¼šåœ¨é¡µé¢æ»šåŠ¨å›è°ƒå‡½æ•°é‡Œä¸åœè§¦å‘è°ƒç”¨ï¼Œé€ æˆæ€§èƒ½é—®é¢˜ï¼Œä½“éªŒæ•ˆæœè®©äººå¤±æœ›ã€‚</p></blockquote><p><code>Intersection observer</code> çš„æ¦‚å¿µå’Œç”¨æ³•<br><code>Intersection Observer</code> API å…è®¸ä½ é…ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ä»¥ä¸‹æƒ…å†µå‘ç”Ÿæ—¶ä¼šè¢«è°ƒç”¨</p><p>æ¯å½“ç›®æ ‡ (target) å…ƒç´ ä¸è®¾å¤‡è§†çª—æˆ–è€…å…¶ä»–æŒ‡å®šå…ƒç´ å‘ç”Ÿäº¤é›†çš„æ—¶å€™æ‰§è¡Œã€‚è®¾å¤‡è§†çª—æˆ–è€…å…¶ä»–å…ƒç´ æˆ‘ä»¬ç§°å®ƒä¸ºæ ¹å…ƒç´ æˆ–æ ¹ (root)ã€‚<br>Observer ç¬¬ä¸€æ¬¡ç›‘å¬ç›®æ ‡å…ƒç´ çš„æ—¶å€™<br>é€šå¸¸ï¼Œæ‚¨éœ€è¦å…³æ³¨æ–‡æ¡£æœ€æ¥è¿‘çš„å¯æ»šåŠ¨ç¥–å…ˆå…ƒç´ çš„äº¤é›†æ›´æ”¹ï¼Œå¦‚æœå…ƒç´ ä¸æ˜¯å¯æ»šåŠ¨å…ƒç´ çš„åä»£ï¼Œåˆ™é»˜è®¤ä¸ºè®¾å¤‡è§†çª—ã€‚å¦‚æœè¦è§‚å¯Ÿç›¸å¯¹äºæ ¹ (root) å…ƒç´ çš„äº¤é›†ï¼Œè¯·æŒ‡å®šæ ¹ (root) å…ƒç´ ä¸º nullã€‚</p><p>æ— è®ºæ‚¨æ˜¯ä½¿ç”¨è§†å£è¿˜æ˜¯å…¶ä»–å…ƒç´ ä½œä¸ºæ ¹ï¼ŒAPI éƒ½ä»¥ç›¸åŒçš„æ–¹å¼å·¥ä½œï¼Œåªè¦ç›®æ ‡å…ƒç´ çš„å¯è§æ€§å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæ‰§è¡Œæ‚¨æä¾›çš„å›è°ƒå‡½æ•°ï¼Œä»¥ä¾¿å®ƒä¸æ‰€éœ€çš„äº¤å‰ç‚¹äº¤å‰ã€‚</p><p>ç›®æ ‡ (target) å…ƒç´ ä¸æ ¹ (root) å…ƒç´ ä¹‹é—´çš„äº¤å‰åº¦æ˜¯äº¤å‰æ¯” (intersection ratio)ã€‚è¿™æ˜¯ç›®æ ‡ (target) å…ƒç´ ç›¸å¯¹äºæ ¹ (root) çš„äº¤é›†ç™¾åˆ†æ¯”çš„è¡¨ç¤ºï¼Œå®ƒçš„å–å€¼åœ¨ 0.0 å’Œ 1.0 ä¹‹é—´ã€‚</p><p>åˆ›å»ºä¸€ä¸ª <code>intersection observer</code><br>åˆ›å»ºä¸€ä¸ª IntersectionObserver å¯¹è±¡ï¼Œå¹¶ä¼ å…¥ç›¸åº”å‚æ•°å’Œå›è°ƒç”¨å‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°å°†ä¼šåœ¨ç›®æ ‡ (target) å…ƒç´ å’Œæ ¹ (root) å…ƒç´ çš„äº¤é›†å¤§å°è¶…è¿‡é˜ˆå€¼ (threshold) è§„å®šçš„å¤§å°æ—¶å€™è¢«æ‰§è¡Œã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let options &#x3D; &#123;  root: document.querySelector(&quot;#scrollArea&quot;),  rootMargin: &quot;0px&quot;,  threshold: 1.0,&#125;;let observer &#x3D; new IntersectionObserver(callback, options);</code></pre><p>é˜ˆå€¼ä¸º 1.0 æ„å‘³ç€ç›®æ ‡å…ƒç´ å®Œå…¨å‡ºç°åœ¨ root é€‰é¡¹æŒ‡å®šçš„å…ƒç´ ä¸­å¯è§æ—¶ï¼Œå›è°ƒå‡½æ•°å°†ä¼šè¢«æ‰§è¡Œã€‚</p><p><strong>Intersection observer options</strong><br>ä¼ é€’åˆ° IntersectionObserver() æ„é€ å‡½æ•°çš„ options å¯¹è±¡ï¼Œå…è®¸æ‚¨æ§åˆ¶è§‚å¯Ÿè€…çš„å›è°ƒå‡½æ•°çš„è¢«è°ƒç”¨æ—¶çš„ç¯å¢ƒã€‚å®ƒæœ‰ä»¥ä¸‹å­—æ®µï¼š</p><p><strong>root</strong><br>æŒ‡å®šæ ¹ (root) å…ƒç´ ï¼Œç”¨äºæ£€æŸ¥ç›®æ ‡çš„å¯è§æ€§ã€‚å¿…é¡»æ˜¯ç›®æ ‡å…ƒç´ çš„çˆ¶çº§å…ƒç´ ã€‚å¦‚æœæœªæŒ‡å®šæˆ–è€…ä¸º nullï¼Œåˆ™é»˜è®¤ä¸ºæµè§ˆå™¨è§†çª—ã€‚</p><p><strong>rootMargin</strong><br>æ ¹ (root) å…ƒç´ çš„å¤–è¾¹è·ã€‚ç±»ä¼¼äº CSS ä¸­çš„ margin å±æ€§ï¼Œæ¯”å¦‚ â€œ10px 20px 30px 40pxâ€ (top, right, bottom, left)ã€‚å¦‚æœæœ‰æŒ‡å®š root å‚æ•°ï¼Œåˆ™ rootMargin ä¹Ÿå¯ä»¥ä½¿ç”¨ç™¾åˆ†æ¯”æ¥å–å€¼ã€‚è¯¥å±æ€§å€¼æ˜¯ç”¨ä½œ root å…ƒç´ å’Œ target å‘ç”Ÿäº¤é›†æ—¶å€™çš„è®¡ç®—äº¤é›†çš„åŒºåŸŸèŒƒå›´ï¼Œä½¿ç”¨è¯¥å±æ€§å¯ä»¥æ§åˆ¶ root å…ƒç´ æ¯ä¸€è¾¹çš„æ”¶ç¼©æˆ–è€…æ‰©å¼ ã€‚é»˜è®¤å€¼ä¸º 0ã€‚</p><p><strong>threshold</strong><br>å¯ä»¥æ˜¯å•ä¸€çš„ number ä¹Ÿå¯ä»¥æ˜¯ number æ•°ç»„ï¼Œtarget å…ƒç´ å’Œ root å…ƒç´ ç›¸äº¤ç¨‹åº¦è¾¾åˆ°è¯¥å€¼çš„æ—¶å€™ IntersectionObserver æ³¨å†Œçš„å›è°ƒå‡½æ•°å°†ä¼šè¢«æ‰§è¡Œã€‚å¦‚æœä½ åªæ˜¯æƒ³è¦æ¢æµ‹å½“ target å…ƒç´ çš„åœ¨ root å…ƒç´ ä¸­çš„å¯è§æ€§è¶…è¿‡ 50% çš„æ—¶å€™ï¼Œä½ å¯ä»¥æŒ‡å®šè¯¥å±æ€§å€¼ä¸º 0.5ã€‚å¦‚æœä½ æƒ³è¦ target å…ƒç´ åœ¨ root å…ƒç´ çš„å¯è§ç¨‹åº¦æ¯å¤š 25% å°±æ‰§è¡Œä¸€æ¬¡å›è°ƒï¼Œé‚£ä¹ˆä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªæ•°ç»„ [0, 0.25, 0.5, 0.75, 1]ã€‚é»˜è®¤å€¼æ˜¯ 0 (æ„å‘³ç€åªè¦æœ‰ä¸€ä¸ª target åƒç´ å‡ºç°åœ¨ root å…ƒç´ ä¸­ï¼Œå›è°ƒå‡½æ•°å°†ä¼šè¢«æ‰§è¡Œ)ã€‚è¯¥å€¼ä¸º 1.0 å«ä¹‰æ˜¯å½“ target å®Œå…¨å‡ºç°åœ¨ root å…ƒç´ ä¸­æ—¶å€™ å›è°ƒæ‰ä¼šè¢«æ‰§è¡Œã€‚</p><p><strong>Targeting an element to be observed</strong><br>åˆ›å»ºä¸€ä¸ª observer åéœ€è¦ç»™å®šä¸€ä¸ªç›®æ ‡å…ƒç´ è¿›è¡Œè§‚å¯Ÿã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let target &#x3D; document.querySelector(&quot;#listItem&quot;);observer.observe(target);</code></pre><p>æ¯å½“ç›®æ ‡æ»¡è¶³è¯¥ <code>IntersectionObserver</code> æŒ‡å®šçš„ <code>threshold</code> å€¼ï¼Œå›è°ƒè¢«è°ƒç”¨ã€‚</p><p>åªè¦ç›®æ ‡æ»¡è¶³ä¸º <code>IntersectionObserver</code> æŒ‡å®šçš„é˜ˆå€¼ï¼Œå°±ä¼šè°ƒç”¨å›è°ƒã€‚å›è°ƒæ¥æ”¶ <code>IntersectionObserverEntry</code> å¯¹è±¡å’Œè§‚å¯Ÿè€…çš„åˆ—è¡¨ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let callback &#x3D; (entries, observer) &#x3D;&gt; &#123;  entries.forEach((entry) &#x3D;&gt; &#123;    &#x2F;&#x2F; Each entry describes an intersection change for one observed target element:    &#x2F;&#x2F; entry.boundingClientRect    &#x2F;&#x2F; entry.intersectionRatio    &#x2F;&#x2F; entry.intersectionRect    &#x2F;&#x2F; entry.isIntersecting    &#x2F;&#x2F; entry.rootBounds    &#x2F;&#x2F; entry.target    &#x2F;&#x2F; entry.time  &#125;);&#125;;</code></pre><p>è¯·ç•™æ„ï¼Œ<span style="color: red">ä½ æ³¨å†Œçš„å›è°ƒå‡½æ•°å°†ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­è¢«æ‰§è¡Œã€‚æ‰€ä»¥è¯¥å‡½æ•°æ‰§è¡Œé€Ÿåº¦è¦å°½å¯èƒ½çš„å¿«ã€‚å¦‚æœæœ‰ä¸€äº›è€—æ—¶çš„æ“ä½œéœ€è¦æ‰§è¡Œï¼Œå»ºè®®ä½¿ç”¨ Window.requestIdleCallback() æ–¹æ³•</span>ã€‚</p></p></details><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &quot;intersection-observer&quot;;import &#123; useState &#125; from &quot;react&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useEffectWithTarget from &quot;..&#x2F;utils&#x2F;useEffectWithTarget&quot;;export interface Options &#123;  rootMargin?: string;  threshold?: number | number[];  root?: BasicTarget&lt;Element&gt;;&#125;function useInViewport(target: BasicTarget, options?: Options) &#123;  &#x2F;&#x2F; inViewportæ˜¯å¦å¯è§  const [state, setState] &#x3D; useState&lt;boolean&gt;();  &#x2F;&#x2F; ratioå½“å‰å¯è§æ¯”ä¾‹ï¼Œåœ¨æ¯æ¬¡åˆ°è¾¾ options.threshold è®¾ç½®èŠ‚ç‚¹æ—¶æ›´æ–°  const [ratio, setRatio] &#x3D; useState&lt;number&gt;();  useEffectWithTarget(    () &#x3D;&gt; &#123;      const el &#x3D; getTargetElement(target);      if (!el) &#123;        return;      &#125;      const observer &#x3D; new IntersectionObserver(        (entries) &#x3D;&gt; &#123;          for (const entry of entries) &#123;            setRatio(entry.intersectionRatio);            setState(entry.isIntersecting);          &#125;        &#125;,        &#123;          ...options,          root: getTargetElement(options?.root),        &#125;      );      observer.observe(el);      return () &#x3D;&gt; &#123;        observer.disconnect();      &#125;;    &#125;,    [],    target  );  return [state, ratio] as const;&#125;export default useInViewport;</code></pre><h2 id="useMutationObserver"><a href="#useMutationObserver" class="headerlink" title="useMutationObserver"></a>useMutationObserver</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useDeepCompareEffectWithTarget from &quot;..&#x2F;utils&#x2F;useDeepCompareWithTarget&quot;;import useLatest from &quot;..&#x2F;useLatest&quot;;const useMutationObserver &#x3D; (  callback: MutationCallback,  target: BasicTarget,  options: MutationObserverInit &#x3D; &#123;&#125;): void &#x3D;&gt; &#123;  &#x2F;&#x2F; æ‹¿åˆ°æœ€æ–°çš„å›è°ƒå‡½æ•°ï¼ŒuseLatestå†…éƒ¨ä½¿ç”¨useRefå®ç°  const callbackRef &#x3D; useLatest(callback);  useDeepCompareEffectWithTarget(    () &#x3D;&gt; &#123;      const element &#x3D; getTargetElement(target); &#x2F;&#x2F; è¢«è§‚å¯Ÿçš„domå¯¹è±¡      if (!element) &#123;        return;      &#125;      &#x2F;&#x2F; å®ä¾‹åŒ–ä¸€ä¸ªï¼ˆçªå˜è§‚å¯Ÿè€…ï¼‰è§‚å¯Ÿå¯¹è±¡      const observer &#x3D; new MutationObserver(callbackRef.current);      &#x2F;&#x2F; å¼€å§‹è§‚å¯Ÿ      observer.observe(element, options);      &#x2F;&#x2F; å¸è½½åœæ­¢è§‚å¯Ÿ      return () &#x3D;&gt; &#123;        if (observer) &#123;          observer.disconnect();        &#125;      &#125;;    &#125;,    [options],    target  );&#125;;export default useMutationObserver;</code></pre><details class="custom-details"><summary>MutationObserver</summary><p><code>MutationObserver</code> æ¥å£æä¾›äº†ç›‘è§†å¯¹ DOM æ ‘æ‰€åšæ›´æ”¹çš„èƒ½åŠ›ã€‚å®ƒè¢«è®¾è®¡ä¸ºæ—§çš„ Mutation Events åŠŸèƒ½çš„æ›¿ä»£å“ï¼Œè¯¥åŠŸèƒ½æ˜¯ DOM3 Events è§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>æ„é€ å‡½æ•°</strong><br>MutationObserver()<br>åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ MutationObserver å®ƒä¼šåœ¨æŒ‡å®šçš„ DOM å‘ç”Ÿå˜åŒ–æ—¶è¢«è°ƒç”¨ã€‚</p><p><strong>æ–¹æ³•</strong><br>disconnect()<br>é˜»æ­¢ MutationObserver å®ä¾‹ç»§ç»­æ¥æ”¶çš„é€šçŸ¥ï¼Œç›´åˆ°å†æ¬¡è°ƒç”¨å…¶ observe() æ–¹æ³•ï¼Œè¯¥è§‚å¯Ÿè€…å¯¹è±¡åŒ…å«çš„å›è°ƒå‡½æ•°éƒ½ä¸ä¼šå†è¢«è°ƒç”¨ã€‚</p><p>observe()<br>é…ç½® MutationObserver åœ¨ DOM æ›´æ”¹åŒ¹é…ç»™å®šé€‰é¡¹æ—¶ï¼Œé€šè¿‡å…¶å›è°ƒå‡½æ•°å¼€å§‹æ¥æ”¶é€šçŸ¥ã€‚</p><p>takeRecords()<br>ä» MutationObserver çš„é€šçŸ¥é˜Ÿåˆ—ä¸­åˆ é™¤æ‰€æœ‰å¾…å¤„ç†çš„é€šçŸ¥ï¼Œå¹¶å°†å®ƒä»¬è¿”å›åˆ° MutationRecord å¯¹è±¡çš„æ–° Array ä¸­ã€‚</p><p>ç¤ºä¾‹æ”¹ç¼–è‡ª <a href="https://hacks.mozilla.org/2012/05/dom-mutationobserver-reacting-to-dom-changes-without-killing-browser-performance/" target="_blank" >è¿™ç¯‡åšå®¢</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; é€‰æ‹©éœ€è¦è§‚å¯Ÿå˜åŠ¨çš„èŠ‚ç‚¹const targetNode &#x3D; document.getElementById(&quot;some-id&quot;);&#x2F;&#x2F; è§‚å¯Ÿå™¨çš„é…ç½®ï¼ˆéœ€è¦è§‚å¯Ÿä»€ä¹ˆå˜åŠ¨ï¼‰const config &#x3D; &#123; attributes: true, childList: true, subtree: true &#125;;&#x2F;&#x2F; å½“è§‚å¯Ÿåˆ°å˜åŠ¨æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°const callback &#x3D; function (mutationsList, observer) &#123;  &#x2F;&#x2F; Use traditional &#39;for loops&#39; for IE 11  for (let mutation of mutationsList) &#123;    if (mutation.type &#x3D;&#x3D;&#x3D; &quot;childList&quot;) &#123;      console.log(&quot;A child node has been added or removed.&quot;);    &#125; else if (mutation.type &#x3D;&#x3D;&#x3D; &quot;attributes&quot;) &#123;      console.log(&quot;The &quot; + mutation.attributeName + &quot; attribute was modified.&quot;);    &#125;  &#125;&#125;;&#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹å¹¶ä¼ å…¥å›è°ƒå‡½æ•°const observer &#x3D; new MutationObserver(callback);&#x2F;&#x2F; ä»¥ä¸Šè¿°é…ç½®å¼€å§‹è§‚å¯Ÿç›®æ ‡èŠ‚ç‚¹observer.observe(targetNode, config);&#x2F;&#x2F; ä¹‹åï¼Œå¯åœæ­¢è§‚å¯Ÿobserver.disconnect();</code></pre></details><h2 id="useKeyPressã€ä¸æ˜¯å¾ˆç†è§£ã€‘"><a href="#useKeyPressã€ä¸æ˜¯å¾ˆç†è§£ã€‘" class="headerlink" title="useKeyPressã€ä¸æ˜¯å¾ˆç†è§£ã€‘"></a>useKeyPressã€ä¸æ˜¯å¾ˆç†è§£ã€‘</h2><p>ä»£ç æœ‰ç‚¹é•¿ï¼Œä¹Ÿä¸æ˜¯å¾ˆé‡è¦</p><details class="custom-details"><summary>useKeyPress æºç </summary><p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useLatest from &quot;..&#x2F;useLatest&quot;;import &#123; isFunction, isNumber, isString &#125; from &quot;..&#x2F;utils&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useDeepCompareEffectWithTarget from &quot;..&#x2F;utils&#x2F;useDeepCompareWithTarget&quot;;export type KeyPredicate &#x3D; (event: KeyboardEvent) &#x3D;&gt; boolean;export type keyType &#x3D; number | string;export type KeyFilter &#x3D;  | keyType  | keyType[]  | ((event: KeyboardEvent) &#x3D;&gt; boolean);export type EventHandler &#x3D; (event: KeyboardEvent) &#x3D;&gt; void;export type KeyEvent &#x3D; &quot;keydown&quot; | &quot;keyup&quot;;export type Target &#x3D; BasicTarget&lt;HTMLElement | Document | Window&gt;;export type Options &#x3D; &#123;  events?: KeyEvent[];  target?: Target;  exactMatch?: boolean;&#125;;&#x2F;&#x2F; é”®ç›˜äº‹ä»¶ keyCode åˆ«åconst aliasKeyCodeMap &#x3D; &#123;  &quot;0&quot;: 48,  &quot;1&quot;: 49,  &quot;2&quot;: 50,  &quot;3&quot;: 51,  &quot;4&quot;: 52,  &quot;5&quot;: 53,  &quot;6&quot;: 54,  &quot;7&quot;: 55,  &quot;8&quot;: 56,  &quot;9&quot;: 57,  backspace: 8,  tab: 9,  enter: 13,  shift: 16,  ctrl: 17,  alt: 18,  pausebreak: 19,  capslock: 20,  esc: 27,  space: 32,  pageup: 33,  pagedown: 34,  end: 35,  home: 36,  leftarrow: 37,  uparrow: 38,  rightarrow: 39,  downarrow: 40,  insert: 45,  delete: 46,  a: 65,  b: 66,  c: 67,  d: 68,  e: 69,  f: 70,  g: 71,  h: 72,  i: 73,  j: 74,  k: 75,  l: 76,  m: 77,  n: 78,  o: 79,  p: 80,  q: 81,  r: 82,  s: 83,  t: 84,  u: 85,  v: 86,  w: 87,  x: 88,  y: 89,  z: 90,  leftwindowkey: 91,  rightwindowkey: 92,  selectkey: 93,  numpad0: 96,  numpad1: 97,  numpad2: 98,  numpad3: 99,  numpad4: 100,  numpad5: 101,  numpad6: 102,  numpad7: 103,  numpad8: 104,  numpad9: 105,  multiply: 106,  add: 107,  subtract: 109,  decimalpoint: 110,  divide: 111,  f1: 112,  f2: 113,  f3: 114,  f4: 115,  f5: 116,  f6: 117,  f7: 118,  f8: 119,  f9: 120,  f10: 121,  f11: 122,  f12: 123,  numlock: 144,  scrolllock: 145,  semicolon: 186,  equalsign: 187,  comma: 188,  dash: 189,  period: 190,  forwardslash: 191,  graveaccent: 192,  openbracket: 219,  backslash: 220,  closebracket: 221,  singlequote: 222,&#125;;&#x2F;&#x2F; ä¿®é¥°é”®const modifierKey &#x3D; &#123;  ctrl: (event: KeyboardEvent) &#x3D;&gt; event.ctrlKey,  shift: (event: KeyboardEvent) &#x3D;&gt; event.shiftKey,  alt: (event: KeyboardEvent) &#x3D;&gt; event.altKey,  meta: (event: KeyboardEvent) &#x3D;&gt; event.metaKey,&#125;;&#x2F;&#x2F; æ ¹æ® event è®¡ç®—æ¿€æ´»é”®æ•°é‡function countKeyByEvent(event: KeyboardEvent) &#123;  const countOfModifier &#x3D; Object.keys(modifierKey).reduce((total, key) &#x3D;&gt; &#123;    if (modifierKey[key](event)) &#123;      return total + 1;    &#125;    return total;  &#125;, 0);  &#x2F;&#x2F; 16 17 18 91 92 æ˜¯ä¿®é¥°é”®çš„ keyCodeï¼Œå¦‚æœ keyCode æ˜¯ä¿®é¥°é”®ï¼Œé‚£ä¹ˆæ¿€æ´»æ•°é‡å°±æ˜¯ä¿®é¥°é”®çš„æ•°é‡ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆå°±éœ€è¦ +1  return [16, 17, 18, 91, 92].includes(event.keyCode)    ? countOfModifier    : countOfModifier + 1;&#125;&#x2F;** * åˆ¤æ–­æŒ‰é”®æ˜¯å¦æ¿€æ´» * @param [event: KeyboardEvent]é”®ç›˜äº‹ä»¶ * @param [keyFilter: any] å½“å‰é”® * @returns Boolean *&#x2F;function genFilterKey(  event: KeyboardEvent,  keyFilter: keyType,  exactMatch: boolean) &#123;  &#x2F;&#x2F; æµè§ˆå™¨è‡ªåŠ¨è¡¥å…¨ input çš„æ—¶å€™ï¼Œä¼šè§¦å‘ keyDownã€keyUp äº‹ä»¶ï¼Œä½†æ­¤æ—¶ event.key ç­‰ä¸ºç©º  if (!event.key) &#123;    return false;  &#125;  &#x2F;&#x2F; æ•°å­—ç±»å‹ç›´æ¥åŒ¹é…äº‹ä»¶çš„ keyCode  if (isNumber(keyFilter)) &#123;    return event.keyCode &#x3D;&#x3D;&#x3D; keyFilter;  &#125;  &#x2F;&#x2F; å­—ç¬¦ä¸²ä¾æ¬¡åˆ¤æ–­æ˜¯å¦æœ‰ç»„åˆé”®  const genArr &#x3D; keyFilter.split(&quot;.&quot;);  let genLen &#x3D; 0;  for (const key of genArr) &#123;    &#x2F;&#x2F; ç»„åˆé”®    const genModifier &#x3D; &#x2F;** ä¿®é¥°é”®*&#x2F; modifierKey[key];    &#x2F;&#x2F; keyCode åˆ«å    const aliasKeyCode &#x3D;      &#x2F;**é”®ç›˜äº‹ä»¶ keyCode åˆ«å*&#x2F; aliasKeyCodeMap[key.toLowerCase()];    if (      (genModifier &amp;&amp; genModifier(event)) ||      (aliasKeyCode &amp;&amp; aliasKeyCode &#x3D;&#x3D;&#x3D; event.keyCode)    ) &#123;      genLen++;    &#125;  &#125;  &#x2F;**   * éœ€è¦åˆ¤æ–­è§¦å‘çš„é”®ä½å’Œç›‘å¬çš„é”®ä½å®Œå…¨ä¸€è‡´ï¼Œåˆ¤æ–­æ–¹æ³•å°±æ˜¯è§¦å‘çš„é”®ä½é‡Œæœ‰ä¸”ç­‰äºç›‘å¬çš„é”®ä½   * genLen &#x3D;&#x3D;&#x3D; genArr.length èƒ½åˆ¤æ–­å‡ºæ¥è§¦å‘çš„é”®ä½é‡Œæœ‰ç›‘å¬çš„é”®ä½   * countKeyByEvent(event) &#x3D;&#x3D;&#x3D; genArr.length åˆ¤æ–­å‡ºæ¥è§¦å‘çš„é”®ä½æ•°é‡é‡Œæœ‰ä¸”ç­‰äºç›‘å¬çš„é”®ä½æ•°é‡   * ä¸»è¦ç”¨æ¥é˜²æ­¢æŒ‰ç»„åˆé”®å…¶å­é›†ä¹Ÿä¼šè§¦å‘çš„æƒ…å†µï¼Œä¾‹å¦‚ç›‘å¬ ctrl+a ä¼šè§¦å‘ç›‘å¬ ctrl å’Œ a ä¸¤ä¸ªé”®çš„äº‹ä»¶ã€‚   *&#x2F;  if (exactMatch) &#123;    return genLen &#x3D;&#x3D;&#x3D; genArr.length &amp;&amp; countKeyByEvent(event) &#x3D;&#x3D;&#x3D; genArr.length;  &#125;  return genLen &#x3D;&#x3D;&#x3D; genArr.length;&#125;&#x2F;** * é”®ç›˜è¾“å…¥é¢„å¤„ç†æ–¹æ³• * @param [keyFilter: any] å½“å‰é”® * @returns () &#x3D;&gt; Boolean *&#x2F;function genKeyFormatter(  keyFilter: KeyFilter,  exactMatch: boolean): KeyPredicate &#123;  if (isFunction(keyFilter)) &#123;    return keyFilter;  &#125;  if (isString(keyFilter) || isNumber(keyFilter)) &#123;    return (event: KeyboardEvent) &#x3D;&gt; genFilterKey(event, keyFilter, exactMatch);  &#125;  if (Array.isArray(keyFilter)) &#123;    return (event: KeyboardEvent) &#x3D;&gt;      keyFilter.some((item) &#x3D;&gt; genFilterKey(event, item, exactMatch));  &#125;  return keyFilter ? () &#x3D;&gt; true : () &#x3D;&gt; false;&#125;const defaultEvents: KeyEvent[] &#x3D; [&quot;keydown&quot;];function useKeyPress(  keyFilter: KeyFilter, &#x2F;&#x2F; æ”¯æŒ keyCodeã€åˆ«åã€ç»„åˆé”®ã€æ•°ç»„ï¼Œè‡ªå®šä¹‰å‡½æ•°  eventHandler: EventHandler, &#x2F;&#x2F; å›è°ƒå‡½æ•°  option?: Options &#x2F;&#x2F; å¯é€‰é…ç½®é¡¹) &#123;  const &#123; events &#x3D; defaultEvents, target, exactMatch &#x3D; false &#125; &#x3D; option || &#123;&#125;;  const eventHandlerRef &#x3D; useLatest(eventHandler); &#x2F;&#x2F; ç¼“å­˜äº†ä¸‹  const keyFilterRef &#x3D; useLatest(keyFilter); &#x2F;&#x2F; ç¼“å­˜äº†ä¸‹  useDeepCompareEffectWithTarget(    () &#x3D;&gt; &#123;      const el &#x3D; getTargetElement(target, window);      if (!el) &#123;        return;      &#125;      const callbackHandler &#x3D; (event: KeyboardEvent) &#x3D;&gt; &#123;        const genGuard: KeyPredicate &#x3D; genKeyFormatter(          keyFilterRef.current,          exactMatch        );        if (genGuard(event)) &#123;          &#x2F;&#x2F; æ˜¯ä¸æ˜¯åŒ¹é…åˆ°äº†ï¼ŒåŒ¹é…åˆ°äº†æ‰§è¡Œå›è°ƒ          return eventHandlerRef.current?.(event);        &#125;      &#125;;      for (const eventName of events) &#123;        el?.addEventListener?.(eventName, callbackHandler);      &#125;      return () &#x3D;&gt; &#123;        for (const eventName of events) &#123;          el?.removeEventListener?.(eventName, callbackHandler);        &#125;      &#125;;    &#125;,    [events],    target  );&#125;export default useKeyPress;</code></pre></p></details><h2 id="useDrop-amp-useDrag"><a href="#useDrop-amp-useDrag" class="headerlink" title="useDrop &amp; useDrag"></a>useDrop &amp; useDrag</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¤„ç†å…ƒç´ æ‹–æ‹½çš„ Hookã€‚</p><p>useDrop å¯ä»¥å•ç‹¬ä½¿ç”¨æ¥æ¥æ”¶æ–‡ä»¶ã€æ–‡å­—å’Œç½‘å€çš„æ‹–æ‹½ã€‚</p><p>useDrag å…è®¸ä¸€ä¸ª DOM èŠ‚ç‚¹è¢«æ‹–æ‹½ï¼Œéœ€è¦é…åˆ useDrop ä½¿ç”¨ã€‚</p><p>å‘èŠ‚ç‚¹å†…è§¦å‘ç²˜è´´åŠ¨ä½œä¹Ÿä¼šè¢«è§†ä¸ºæ‹–æ‹½ã€‚</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useLatest from &quot;..&#x2F;useLatest&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useEffectWithTarget from &quot;..&#x2F;utils&#x2F;useEffectWithTarget&quot;;export interface Options &#123;  onDragStart?: (event: React.DragEvent) &#x3D;&gt; void;  onDragEnd?: (event: React.DragEvent) &#x3D;&gt; void;&#125;const useDrag &#x3D; &lt;T&gt;(data: T, target: BasicTarget, options: Options &#x3D; &#123;&#125;) &#x3D;&gt; &#123;  const optionsRef &#x3D; useLatest(options);  useEffectWithTarget(    () &#x3D;&gt; &#123;      const targetElement &#x3D; getTargetElement(target);      &#x2F;&#x2F; ä¸å…·å¤‡å¢åŠ ç›‘å¬çš„æ–¹æ³•      if (!targetElement?.addEventListener) &#123;        return;      &#125;      const onDragStart &#x3D; (event: React.DragEvent) &#x3D;&gt; &#123;        optionsRef.current.onDragStart?.(event);        event.dataTransfer.setData(&quot;custom&quot;, JSON.stringify(data));      &#125;;      const onDragEnd &#x3D; (event: React.DragEvent) &#x3D;&gt; &#123;        optionsRef.current.onDragEnd?.(event);      &#125;;      targetElement.setAttribute(&quot;draggable&quot;, &quot;true&quot;);      &#x2F;&#x2F; ç»‘å®š      targetElement.addEventListener(&quot;dragstart&quot;, onDragStart as any);      targetElement.addEventListener(&quot;dragend&quot;, onDragEnd as any);      return () &#x3D;&gt; &#123;        &#x2F;&#x2F; è§£ç»‘å®š        targetElement.removeEventListener(&quot;dragstart&quot;, onDragStart as any);        targetElement.removeEventListener(&quot;dragend&quot;, onDragEnd as any);      &#125;;    &#125;,    [],    target  );&#125;;export default useDrag;</code></pre><p>useDrop</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useLatest from &quot;..&#x2F;useLatest&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useEffectWithTarget from &quot;..&#x2F;utils&#x2F;useEffectWithTarget&quot;;import &#123; useRef &#125; from &quot;react&quot;;export interface Options &#123;  onFiles?: (files: File[], event?: React.DragEvent) &#x3D;&gt; void;  onUri?: (url: string, event?: React.DragEvent) &#x3D;&gt; void;  onDom?: (content: any, event?: React.DragEvent) &#x3D;&gt; void;  onText?: (text: string, event?: React.ClipboardEvent) &#x3D;&gt; void;  onDragEnter?: (event?: React.DragEvent) &#x3D;&gt; void;  onDragOver?: (event?: React.DragEvent) &#x3D;&gt; void;  onDragLeave?: (event?: React.DragEvent) &#x3D;&gt; void;  onDrop?: (event?: React.DragEvent) &#x3D;&gt; void;  onPaste?: (event?: React.ClipboardEvent) &#x3D;&gt; void;&#125;const useDrop &#x3D; (target: BasicTarget, options: Options &#x3D; &#123;&#125;) &#x3D;&gt; &#123;  const optionsRef &#x3D; useLatest(options);  &#x2F;&#x2F; https:&#x2F;&#x2F;stackoverflow.com&#x2F;a&#x2F;26459269  const dragEnterTarget &#x3D; useRef&lt;any&gt;();  useEffectWithTarget(    () &#x3D;&gt; &#123;      const targetElement &#x3D; getTargetElement(target);      if (!targetElement?.addEventListener) &#123;        return;      &#125;      const onData &#x3D; (        dataTransfer: DataTransfer, &#x2F;&#x2F; æ‹–æ•°æ®        event: React.DragEvent | React.ClipboardEvent      ) &#x3D;&gt; &#123;        const uri &#x3D; dataTransfer.getData(&quot;text&#x2F;uri-list&quot;);        const dom &#x3D; dataTransfer.getData(&quot;custom&quot;);        if (dom &amp;&amp; optionsRef.current.onDom) &#123;          let data &#x3D; dom;          try &#123;            data &#x3D; JSON.parse(dom);          &#125; catch (e) &#123;            data &#x3D; dom;          &#125;          optionsRef.current.onDom(data, event as React.DragEvent);          return;        &#125;        &#x2F;&#x2F; uriæ•°æ®ç±»å‹        if (uri &amp;&amp; optionsRef.current.onUri) &#123;          optionsRef.current.onUri(uri, event as React.DragEvent);          return;        &#125;        &#x2F;&#x2F; æ–‡ä»¶æ•°æ®ç±»å‹        if (          dataTransfer.files &amp;&amp;          dataTransfer.files.length &amp;&amp;          optionsRef.current.onFiles        ) &#123;          optionsRef.current.onFiles(            Array.from(dataTransfer.files),            event as React.DragEvent          );          return;        &#125;        &#x2F;&#x2F; æ–‡æœ¬æ•°æ®ç±»å‹        if (          dataTransfer.items &amp;&amp;          dataTransfer.items.length &amp;&amp;          optionsRef.current.onText        ) &#123;          dataTransfer.items[0].getAsString((text) &#x3D;&gt; &#123;            optionsRef.current.onText!(text, event as React.ClipboardEvent);          &#125;);        &#125;      &#125;;      &#x2F;&#x2F; æ‹–æ‹½è¿›å…¥      const onDragEnter &#x3D; (event: React.DragEvent) &#x3D;&gt; &#123;        event.preventDefault();        event.stopPropagation();        dragEnterTarget.current &#x3D; event.target;        optionsRef.current.onDragEnter?.(event);      &#125;;      &#x2F;&#x2F; æ‹–æ‹½ä¸­      const onDragOver &#x3D; (event: React.DragEvent) &#x3D;&gt; &#123;        event.preventDefault();        optionsRef.current.onDragOver?.(event);      &#125;;      &#x2F;&#x2F; æ‹–æ‹½å‡ºå»      const onDragLeave &#x3D; (event: React.DragEvent) &#x3D;&gt; &#123;        if (event.target &#x3D;&#x3D;&#x3D; dragEnterTarget.current) &#123;          optionsRef.current.onDragLeave?.(event);        &#125;      &#125;;      &#x2F;&#x2F; æ”¾ä¸‹      const onDrop &#x3D; (event: React.DragEvent) &#x3D;&gt; &#123;        event.preventDefault();        onData(event.dataTransfer, event);        optionsRef.current.onDrop?.(event);      &#125;;      &#x2F;&#x2F; ç²˜è´´      const onPaste &#x3D; (event: React.ClipboardEvent) &#x3D;&gt; &#123;        onData(event.clipboardData, event);        optionsRef.current.onPaste?.(event);      &#125;;      targetElement.addEventListener(&quot;dragenter&quot;, onDragEnter as any);      targetElement.addEventListener(&quot;dragover&quot;, onDragOver as any);      targetElement.addEventListener(&quot;dragleave&quot;, onDragLeave as any);      targetElement.addEventListener(&quot;drop&quot;, onDrop as any);      targetElement.addEventListener(&quot;paste&quot;, onPaste as any);      return () &#x3D;&gt; &#123;        targetElement.removeEventListener(&quot;dragenter&quot;, onDragEnter as any);        targetElement.removeEventListener(&quot;dragover&quot;, onDragOver as any);        targetElement.removeEventListener(&quot;dragleave&quot;, onDragLeave as any);        targetElement.removeEventListener(&quot;drop&quot;, onDrop as any);        targetElement.removeEventListener(&quot;paste&quot;, onPaste as any);      &#125;;    &#125;,    [],    target  );&#125;;export default useDrop;</code></pre><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/paste_event" target="_blank" >åŸç”Ÿäº‹ä»¶</a></p><h2 id="useDocumentVisibility"><a href="#useDocumentVisibility" class="headerlink" title="useDocumentVisibility"></a>useDocumentVisibility</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useState &#125; from &quot;react&quot;;import useEventListener from &quot;..&#x2F;useEventListener&quot;;import isBrowser from &quot;..&#x2F;utils&#x2F;isBrowser&quot;;type VisibilityState &#x3D; &quot;hidden&quot; | &quot;visible&quot; | &quot;prerender&quot; | undefined;const getVisibility &#x3D; () &#x3D;&gt; &#123;  if (!isBrowser) &#123;    return &quot;visible&quot;;  &#125;  return document.visibilityState;&#125;;function useDocumentVisibility(): VisibilityState &#123;  const [documentVisibility, setDocumentVisibility] &#x3D; useState(() &#x3D;&gt;    getVisibility()  );  useEventListener(    &quot;visibilitychange&quot;,    () &#x3D;&gt; &#123;      setDocumentVisibility(getVisibility());    &#125;,    &#123;      target: () &#x3D;&gt; document,    &#125;  );  return documentVisibility;&#125;export default useDocumentVisibility;</code></pre><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/visibilityState" target="_blank" >è§</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å…¸å‹ç”¨æ³•æ˜¯é˜²æ­¢å½“é¡µé¢æ­£åœ¨æ¸²æŸ“æ—¶åŠ è½½èµ„æºï¼Œæˆ–è€…å½“é¡µé¢åœ¨èƒŒæ™¯ä¸­æˆ–çª—å£æœ€å°åŒ–æ—¶ç¦æ­¢æŸäº›æ´»åŠ¨ã€‚</p></blockquote><p>çŒœæƒ³ï¼šé¦–é¡µ<code>prerender</code>å<code>visible</code>å‰ï¼Œå¯ä»¥ä½œä¸º<code>performance</code>ä¸ŠæŠ¥ç‚¹ï¼Ÿ</p><h2 id="useResponsive"><a href="#useResponsive" class="headerlink" title="useResponsive"></a>useResponsive</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect, useState &#125; from &quot;react&quot;;import isBrowser from &quot;..&#x2F;utils&#x2F;isBrowser&quot;;type Subscriber &#x3D; () &#x3D;&gt; void;&#x2F;&#x2F; setç±»å‹ï¼Œä¿è¯å”¯ä¸€æ€§ï¼Œå› ä¸ºuseEffectå¯èƒ½å­˜åœ¨é‡å¤æ‰§è¡Œçš„æƒ…å†µconst subscribers &#x3D; new Set&lt;Subscriber&gt;();type ResponsiveConfig &#x3D; Record&lt;string, number&gt;;type ResponsiveInfo &#x3D; Record&lt;string, boolean&gt;;let info: ResponsiveInfo;let responsiveConfig: ResponsiveConfig &#x3D; &#123;  xs: 0,  sm: 576,  md: 768,  lg: 992,  xl: 1200,&#125;;&#x2F;&#x2F; å¤„ç†sizeå˜æ›´function handleResize() &#123;  &#x2F;&#x2F; è¿™é‡Œç¼“å­˜ä¸Šæ¬¡çš„info  const oldInfo &#x3D; info;  &#x2F;&#x2F; è¿™é‡Œè®¡ç®—æ–°çš„info  calculate();  &#x2F;&#x2F; å‰åå‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šå®è¡Œè®¢é˜…çš„æ–¹æ³•  if (oldInfo &#x3D;&#x3D;&#x3D; info) return;  &#x2F;&#x2F; å°†æ”¶é›†åˆ°çš„è§‚å¯Ÿè€…ç»Ÿç»Ÿæ‰§è¡Œä¸€é  for (const subscriber of subscribers) &#123;    subscriber();  &#125;&#125;&#x2F;&#x2F; é¿å…é‡å¤æ‰§è¡Œlet listening &#x3D; false;&#x2F;&#x2F; è®¡ç®—function calculate() &#123;  const width &#x3D; window.innerWidth;  const newInfo &#x3D; &#123;&#125; as ResponsiveInfo;  let shouldUpdate &#x3D; false;  for (const key of Object.keys(responsiveConfig)) &#123;    newInfo[key] &#x3D; width &gt;&#x3D; responsiveConfig[key];    if (newInfo[key] !&#x3D;&#x3D; info[key]) &#123;      shouldUpdate &#x3D; true;    &#125;  &#125;  &#x2F;&#x2F; éœ€è¦æ›´æ–°  if (shouldUpdate) &#123;    info &#x3D; newInfo;  &#125;&#125;&#x2F;&#x2F; é…ç½®å“åº”&#x2F;&#x2F; åªéœ€é…ç½®ä¸€æ¬¡ï¼Œè¯·å‹¿åœ¨ç»„ä»¶ä¸­é‡å¤è°ƒç”¨è¯¥æ–¹æ³•&#x2F;&#x2F; æ¯æ¬¡è°ƒç”¨éƒ½ä¼šé‡æ–°è®¡ç®—export function configResponsive(config: ResponsiveConfig) &#123;  responsiveConfig &#x3D; config;  if (info) calculate();&#125;export function useResponsive() &#123;  &#x2F;&#x2F; å®¢æˆ·ç«¯æ¸²æŸ“  if (isBrowser &amp;&amp; !listening) &#123;    info &#x3D; &#123;&#125;;    calculate();    window.addEventListener(&quot;resize&quot;, handleResize);    listening &#x3D; true;  &#125;  const [state, setState] &#x3D; useState&lt;ResponsiveInfo&gt;(info);  useEffect(() &#x3D;&gt; &#123;    &#x2F;&#x2F; éå®¢æˆ·ç«¯æ¸²æŸ“ï¼Œç›´æ¥æ‹¦æ‰    if (!isBrowser) return;    &#x2F;&#x2F; å®šä¹‰ä¸€ä¸ªè®¢é˜…è€…å‡½æ•°    const subscriber &#x3D; () &#x3D;&gt; &#123;      setState(info);    &#125;;    &#x2F;&#x2F; åŠ å…¥è®¢é˜…    subscribers.add(subscriber);    return () &#x3D;&gt; &#123;      subscribers.delete(subscriber);      if (subscribers.size &#x3D;&#x3D;&#x3D; 0) &#123;        window.removeEventListener(&quot;resize&quot;, handleResize);        listening &#x3D; false;      &#125;    &#125;;  &#125;, []);  return state;&#125;</code></pre><p>å°æ’æ›²ï¼šgithub octotree loading</p><pre class="line-numbers language-css" data-language="css"><code class="language-css">.octotree-show  .octotree-sidebar.octotree-github-sidebar  .octotree-spin  .octotree-spin--loader &#123;  width: 16px;  height: 16px;  border-radius: 50%;  border-width: 2px;  border-style: solid;  border-color: transparent rgb(106, 115, 125) rgb(106, 115, 125) transparent;  border-image: initial;  border-top: 2px solid transparent;  border-left: 2px solid transparent;  animation: 0.5s linear 0s infinite normal none running loading;&#125;</code></pre><h2 id="useScroll"><a href="#useScroll" class="headerlink" title="useScroll"></a>useScroll</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useRafState from &quot;..&#x2F;useRafState&quot;;import useLatest from &quot;..&#x2F;useLatest&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useEffectWithTarget from &quot;..&#x2F;utils&#x2F;useEffectWithTarget&quot;;type Position &#x3D; &#123; left: number; top: number &#125;;&#x2F;&#x2F; æˆ‘æŠŠ BasicTarget æ‹¿è¿‡æ¥æ”¾åœ¨è¿™é‡Œï¼Œä¸ä¼šæœ‰å¤ªå¤šå‰²è£‚æ„Ÿ&#x2F;&#x2F; export type BasicTarget&lt;T extends TargetType &#x3D; Element&gt; &#x3D;&#x2F;&#x2F;   | (() &#x3D;&gt; TargetValue&lt;T&gt;) &#x2F;&#x2F; å‡½æ•°&#x2F;&#x2F;   | TargetValue&lt;T&gt; &#x2F;&#x2F; ç›´æ¥dom&#x2F;&#x2F;   | MutableRefObject&lt;TargetValue&lt;T&gt;&gt;; &#x2F;&#x2F; refexport type Target &#x3D; BasicTarget&lt;Element | Document&gt;;export type ScrollListenController &#x3D; (val: Position) &#x3D;&gt; boolean;function useScroll(  target?: Target,  shouldUpdate: ScrollListenController &#x3D; () &#x3D;&gt; true): Position | undefined &#123;  const [position, setPosition] &#x3D; useRafState&lt;Position&gt;();  const shouldUpdateRef &#x3D; useLatest(shouldUpdate);  useEffectWithTarget(    () &#x3D;&gt; &#123;      const el &#x3D; getTargetElement(target, document &#x2F;**å…œåº•å€¼ *&#x2F;);      if (!el) &#123;        return;      &#125;      const updatePosition &#x3D; () &#x3D;&gt; &#123;        let newPosition: Position;        &#x2F;&#x2F; æ˜¯ä¸æ˜¯document        if (el &#x3D;&#x3D;&#x3D; document) &#123;          &#x2F;&#x2F; ï¼ŸscrollingElementå•¥ç©æ„          &#x2F;&#x2F; @link https:&#x2F;&#x2F;developer.mozilla.org&#x2F;zh-CN&#x2F;docs&#x2F;Web&#x2F;API&#x2F;Document&#x2F;scrollingElement          &#x2F;&#x2F; scrollingElement ï¼ˆ Document çš„åªè¯»å±æ€§ï¼‰è¿”å›æ»šåŠ¨æ–‡æ¡£çš„ Element å¯¹è±¡çš„å¼•ç”¨ã€‚          &#x2F;&#x2F; åœ¨æ ‡å‡†æ¨¡å¼ä¸‹ï¼Œè¿™æ˜¯æ–‡æ¡£çš„æ ¹å…ƒç´ ï¼Œ document.documentElement.          &#x2F;&#x2F; å½“åœ¨æ€ªå¼‚æ¨¡å¼ä¸‹ï¼Œ scrollingElement å±æ€§è¿”å› HTML body å…ƒç´ ï¼ˆè‹¥ä¸å­˜åœ¨è¿”å› null ï¼‰ã€‚          if (document.scrollingElement) &#123;            newPosition &#x3D; &#123;              left: document.scrollingElement.scrollLeft,              top: document.scrollingElement.scrollTop,            &#125;;          &#125; else &#123;            &#x2F;&#x2F; When in quirks mode, the scrollingElement attribute returns the HTML body element if it exists and is potentially scrollable, otherwise it returns null.            &#x2F;&#x2F; åœ¨quirksæ¨¡å¼ä¸‹ï¼ŒscrollingElementå±æ€§è¿”å›HTMLä¸»ä½“å…ƒç´ ï¼ˆå¦‚æœå®ƒå­˜åœ¨å¹¶ä¸”å¯èƒ½æ˜¯å¯æ»šåŠ¨çš„ï¼‰ï¼Œå¦åˆ™è¿”å›nullã€‚            &#x2F;&#x2F; https:&#x2F;&#x2F;developer.mozilla.org&#x2F;zh-CN&#x2F;docs&#x2F;Web&#x2F;API&#x2F;Document&#x2F;scrollingElement            &#x2F;&#x2F; https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;28633221&#x2F;document-body-scrolltop-firefox-returns-0-only-js            newPosition &#x3D; &#123;              left: Math.max(                &#x2F;&#x2F; å…¼å®¹å†™æ³•                window.pageXOffset,                document.documentElement.scrollLeft,                document.body.scrollLeft              ),              top: Math.max(                &#x2F;&#x2F; å…¼å®¹å†™æ³•                window.pageYOffset,                document.documentElement.scrollTop,                document.body.scrollTop              ),            &#125;;          &#125;        &#125; else &#123;          newPosition &#x3D; &#123;            left: (el as Element).scrollLeft,            top: (el as Element).scrollTop,          &#125;;        &#125;        &#x2F;&#x2F; é»˜è®¤ç›´æ¥è¿”å›true        if (shouldUpdateRef.current(newPosition)) &#123;          setPosition(newPosition);        &#125;      &#125;;      &#x2F;&#x2F; ç«‹å³æ‰§è¡Œä¸€æ¬¡      updatePosition();      &#x2F;&#x2F; ç›‘å¬åˆ°scrollæ‰§è¡Œ      el.addEventListener(&quot;scroll&quot;, updatePosition);      return () &#x3D;&gt; &#123;        el.removeEventListener(&quot;scroll&quot;, updatePosition);      &#125;;    &#125;,    [],    target  );  return position;&#125;export default useScroll;</code></pre><h2 id="useSize"><a href="#useSize" class="headerlink" title="useSize"></a>useSize</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; è¿™é‡Œç”¨äº†polyfillimport ResizeObserver from &quot;resize-observer-polyfill&quot;;import useRafState from &quot;..&#x2F;useRafState&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import useIsomorphicLayoutEffectWithTarget from &quot;..&#x2F;utils&#x2F;useIsomorphicLayoutEffectWithTarget&quot;;type Size &#x3D; &#123; width: number; height: number &#125;;function useSize(target: BasicTarget): Size | undefined &#123;  const [state, setState] &#x3D; useRafState&lt;Size&gt;();  useIsomorphicLayoutEffectWithTarget(    &#x2F;&#x2F; useEffectç¬¬ä¸€ä¸ªå‡½æ•°    () &#x3D;&gt; &#123;      const el &#x3D; getTargetElement(target);      if (!el) &#123;        return;      &#125;      const resizeObserver &#x3D; new ResizeObserver((entries) &#x3D;&gt; &#123;        entries.forEach((entry) &#x3D;&gt; &#123;          const &#123; clientWidth, clientHeight &#125; &#x3D; entry.target;          setState(&#123;            width: clientWidth,            height: clientHeight,          &#125;);        &#125;);      &#125;);      &#x2F;&#x2F; å¼€å§‹è§‚å¯ŸæŸä¸ªdom      resizeObserver.observe(el);      return () &#x3D;&gt; &#123;        &#x2F;&#x2F; åœæ­¢è§‚å¯Ÿdom        resizeObserver.disconnect();      &#125;;    &#125;,    &#x2F;&#x2F; useEffectçš„ä¾èµ–é¡¹    [],    target &#x2F;&#x2F; ä¹Ÿå‚ä¸ä¾èµ–é¡¹è®¡ç®— depsAreSame  );  return state;&#125;export default useSize;</code></pre><h2 id="useIsomorphicLayoutEffectWithTarget"><a href="#useIsomorphicLayoutEffectWithTarget" class="headerlink" title="useIsomorphicLayoutEffectWithTarget"></a>useIsomorphicLayoutEffectWithTarget</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import isBrowser from &quot;.&#x2F;isBrowser&quot;;import useEffectWithTarget from &quot;.&#x2F;useEffectWithTarget&quot;;import useLayoutEffectWithTarget from &quot;.&#x2F;useLayoutEffectWithTarget&quot;;&#x2F;&#x2F; å¯¹ç”¨ä¸åŒçš„æ‰§è¡Œç¯å¢ƒï¼Œè¿›è¡ŒåŒºåˆ†const useIsomorphicLayoutEffectWithTarget &#x3D; isBrowser  ? useLayoutEffectWithTarget  : useEffectWithTarget;export default useIsomorphicLayoutEffectWithTarget;</code></pre><h2 id="useReactive-ï¼ˆè¿™ä¸ªæ¯”è¾ƒç‰¹åˆ«ï¼‰"><a href="#useReactive-ï¼ˆè¿™ä¸ªæ¯”è¾ƒç‰¹åˆ«ï¼‰" class="headerlink" title="useReactive ï¼ˆè¿™ä¸ªæ¯”è¾ƒç‰¹åˆ«ï¼‰"></a>useReactive ï¼ˆè¿™ä¸ªæ¯”è¾ƒç‰¹åˆ«ï¼‰</h2><p>æä¾›ä¸€ç§æ•°æ®å“åº”å¼çš„æ“ä½œä½“éªŒï¼Œå®šä¹‰æ•°æ®çŠ¶æ€ä¸éœ€è¦å†™ useStateï¼Œç›´æ¥ä¿®æ”¹å±æ€§å³å¯åˆ·æ–°è§†å›¾ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useRef &#125; from &quot;react&quot;;import useCreation from &quot;..&#x2F;useCreation&quot;;import useUpdate from &quot;..&#x2F;useUpdate&quot;;import &#123; isObject &#125; from &quot;..&#x2F;utils&quot;;&#x2F;&#x2F; k:v åŸå¯¹è±¡:ä»£ç†è¿‡çš„å¯¹è±¡const proxyMap &#x3D; new WeakMap();&#x2F;&#x2F; k:v ä»£ç†è¿‡çš„å¯¹è±¡:åŸå¯¹è±¡const rawMap &#x3D; new WeakMap();function observer&lt;T extends Record&lt;string, any&gt;&gt;(  initialVal: T,  cb: () &#x3D;&gt; void): T &#123;  const existingProxy &#x3D; proxyMap.get(initialVal);  &#x2F;&#x2F; æ·»åŠ ç¼“å­˜ é˜²æ­¢é‡æ–°æ„å»ºproxy  &#x2F;&#x2F; å¦‚æœé‡å¤æ„å»ºï¼Œä¼šæ€æ ·ï¼Ÿ  if (existingProxy) &#123;    return existingProxy;  &#125;  &#x2F;&#x2F; é˜²æ­¢ä»£ç†å·²ç»ä»£ç†è¿‡çš„å¯¹è±¡ æµè§ˆå™¨å¥”æºƒ  &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;alibaba&#x2F;hooks&#x2F;issues&#x2F;839  if (rawMap.has(initialVal)) &#123;    return initialVal;  &#125;  const proxy &#x3D; new Proxy&lt;T&gt;(initialVal, &#123;    get(target, key, receiver) &#123;      const res &#x3D; Reflect.get(target, key, receiver);      &#x2F;&#x2F; æŠŠæ‰€æœ‰çš„åµŒå¥—å¯¹è±¡éƒ½ç»™ç›‘å¬      return isObject(res) ? observer(res, cb) : Reflect.get(target, key);    &#125;,    set(target, key, val) &#123;      const ret &#x3D; Reflect.set(target, key, val);      cb();      return ret;    &#125;,    deleteProperty(target, key) &#123;      const ret &#x3D; Reflect.deleteProperty(target, key);      cb();      return ret;    &#125;,  &#125;);  proxyMap.set(initialVal, proxy);  rawMap.set(proxy, initialVal);  return proxy;&#125;function useReactive&lt;S extends Record&lt;string, any&gt;&gt;(initialState: S): S &#123;  const update &#x3D; useUpdate();  const stateRef &#x3D; useRef&lt;S&gt;(initialState);  &#x2F;&#x2F; useCreationï¼Œéå¿…è¦ä¸æ›´æ–°  const state &#x3D; useCreation(    &#x2F;**å·¥å‚*&#x2F; () &#x3D;&gt; &#123;      return observer(        stateRef.current &#x2F;**initialVal *&#x2F;,        &#x2F;**å›è°ƒ*&#x2F; () &#x3D;&gt; &#123;          update(); &#x2F;&#x2F; åˆ·æ–°ï¼Œæˆ‘æ¯”è¾ƒå¥½å¥‡ï¼Œè¿™ä¹ˆåˆ·æ–°ï¼Œreactå‚»å‘†å‘†åˆè¦é‡æ–°è®¡ç®—ä¸€éå—        &#125;      );    &#125;,    []  );  return state;&#125;export default useReactive;</code></pre><h2 id="useCreation"><a href="#useCreation" class="headerlink" title="useCreation"></a>useCreation</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>useCreation æ˜¯ useMemo æˆ– useRef çš„æ›¿ä»£å“ã€‚</p><p>å› ä¸º useMemo ä¸èƒ½ä¿è¯è¢« memo çš„å€¼ä¸€å®šä¸ä¼šè¢«é‡è®¡ç®—ï¼Œè€Œ useCreation å¯ä»¥ä¿è¯è¿™ä¸€ç‚¹ã€‚ä»¥ä¸‹ä¸º React å®˜æ–¹æ–‡æ¡£ä¸­çš„ä»‹ç»</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import type &#123; DependencyList &#125; from &quot;react&quot;;import &#123; useRef &#125; from &quot;react&quot;;import depsAreSame from &quot;..&#x2F;utils&#x2F;depsAreSame&quot;;export default function useCreation&lt;T&gt;(factory: () &#x3D;&gt; T, deps: DependencyList) &#123;  const &#123; current &#125; &#x3D; useRef(&#123;    deps,    obj: undefined as undefined | T,    initialized: false,  &#125;);  &#x2F;&#x2F; å‘ç”Ÿå˜åŒ–æ—¶å€™ï¼Œå°±ä¼šé‡æ–°è®¡ç®—  if (current.initialized &#x3D;&#x3D;&#x3D; false || !depsAreSame(current.deps, deps)) &#123;    current.deps &#x3D; deps;    current.obj &#x3D; factory(); &#x2F;&#x2F; å·¥å‚    current.initialized &#x3D; true;  &#125;  return current.obj as T;&#125;</code></pre><h2 id="useTrackedEffect"><a href="#useTrackedEffect" class="headerlink" title="useTrackedEffect"></a>useTrackedEffect</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import type &#123; DependencyList &#125; from &quot;react&quot;;import &#123; useEffect, useRef &#125; from &quot;react&quot;;type Effect &#x3D; (  changes?: number[],  previousDeps?: DependencyList, &#x2F;&#x2F; ä¹‹å‰çš„ä¾èµ–  currentDeps?: DependencyList &#x2F;&#x2F; ä¹‹åçš„ä¾èµ–) &#x3D;&gt; void | (() &#x3D;&gt; void);const diffTwoDeps &#x3D; (deps1?: DependencyList, deps2?: DependencyList) &#x3D;&gt; &#123;  &#x2F;&#x2F;Let&#39;s do a reference equality check on 2 dependency list.  &#x2F;&#x2F;If deps1 is defined, we iterate over deps1 and do comparison on each element with equivalent element from deps2  &#x2F;&#x2F;As this func is used only in this hook, we assume 2 deps always have same length.  return deps1    ? &#x2F;&#x2F; deps1ï¼ˆç¼“å­˜ï¼‰æœ‰ï¼Œ deps2 æœ‰ åˆ™ç”¨Object.isæ¯”è¾ƒ      deps1        .map((_ele, idx) &#x3D;&gt; (!Object.is(deps1[idx], deps2?.[idx]) ? idx : -1))        .filter((ele) &#x3D;&gt; ele &gt;&#x3D; 0)    : &#x2F;&#x2F; deps1ï¼ˆç¼“å­˜ï¼‰æ²¡æœ‰ï¼Œ deps2 æœ‰ åˆ™æŠŠç¬¬äºŒä¸ªå–ä¸ªéï¼Œå¦åˆ™ï¼Œè¿”å›[]    deps2    ? deps2.map((_ele, idx) &#x3D;&gt; idx)    : [];&#125;;const useTrackedEffect &#x3D; (effect: Effect, deps?: DependencyList) &#x3D;&gt; &#123;  const previousDepsRef &#x3D; useRef&lt;DependencyList&gt;();  useEffect(() &#x3D;&gt; &#123;    const changes &#x3D; diffTwoDeps(      previousDepsRef.current &#x2F;**ä¹‹å‰çš„ä¾èµ–ç¼“å­˜äº† *&#x2F;,      deps    );    const previousDeps &#x3D; previousDepsRef.current;    previousDepsRef.current &#x3D; deps;    return effect(changes, previousDeps, deps);  &#125;, deps);&#125;;export default useTrackedEffect;</code></pre><h2 id="useVirtualList"><a href="#useVirtualList" class="headerlink" title="useVirtualList"></a>useVirtualList</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; useEffect, useMemo, useState, useRef &#125; from &quot;react&quot;;import useEventListener from &quot;..&#x2F;useEventListener&quot;;import useLatest from &quot;..&#x2F;useLatest&quot;;import useMemoizedFn from &quot;..&#x2F;useMemoizedFn&quot;;import useSize from &quot;..&#x2F;useSize&quot;;import &#123; getTargetElement &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import type &#123; BasicTarget &#125; from &quot;..&#x2F;utils&#x2F;domTarget&quot;;import &#123; isNumber &#125; from &quot;..&#x2F;utils&quot;;type ItemHeight&lt;T&gt; &#x3D; (index: number, data: T) &#x3D;&gt; number;export interface Options&lt;T&gt; &#123;  containerTarget: BasicTarget; &#x2F;&#x2F; å¤–é¢å®¹å™¨ï¼Œæ”¯æŒ DOM èŠ‚ç‚¹æˆ–è€… Ref å¯¹è±¡  wrapperTarget: BasicTarget; &#x2F;&#x2F; å†…éƒ¨å®¹å™¨ï¼Œæ”¯æŒ DOM èŠ‚ç‚¹æˆ–è€… Ref å¯¹è±¡  itemHeight: number | ItemHeight&lt;T&gt;; &#x2F;&#x2F; è¡Œé«˜åº¦ï¼Œé™æ€é«˜åº¦å¯ä»¥ç›´æ¥å†™å…¥åƒç´ å€¼ï¼ŒåŠ¨æ€é«˜åº¦å¯ä¼ å…¥å‡½æ•°ï¼Œ è¿™é‡Œçš„åŠ¨æ€æ˜¯å‡åŠ¨æ€ï¼Œå‡€éª—æˆ‘ï¼Œæ„æ€æ˜¯ä½ ç®—å¥½äº†ç»™ useVirtualList ï¼Œå°±è®¤ä¸ºä½ çš„æ˜¯åŠ¨æ€ï¼Œå¹¶é â€œå®Œå…¨è‡ªåŠ¨è®¡ç®—é«˜åº¦â€  overscan?: number; &#x2F;&#x2F; è§†åŒºä¸Šã€ä¸‹é¢å¤–å±•ç¤ºçš„ DOM èŠ‚ç‚¹æ•°é‡&#125;const useVirtualList &#x3D; &lt;T &#x3D; any&gt;(list: T[], options: Options&lt;T&gt;) &#x3D;&gt; &#123;  const &#123; containerTarget, wrapperTarget, itemHeight, overscan &#x3D; 5 &#125; &#x3D; options;  &#x2F;&#x2F; ç¼“å­˜äº†ä¸‹  const itemHeightRef &#x3D; useLatest(itemHeight);  &#x2F;&#x2F; è®¡ç®—å®¹å™¨å®½é«˜  const size &#x3D; useSize(containerTarget);  &#x2F;&#x2F; æ˜¯ä¸æ˜¯scrollToFunc è§¦å‘çš„æ»šåŠ¨  const scrollTriggerByScrollToFunc &#x3D; useRef(false);  &#x2F;&#x2F; å±•ç¤ºçš„æ•°æ®  const [targetList, setTargetList] &#x3D; useState&lt;&#123; index: number; data: T &#125;[]&gt;(    []  );  &#x2F;&#x2F; å¯è§æ•°é‡  const getVisibleCount &#x3D; (containerHeight: number, fromIndex: number) &#x3D;&gt; &#123;    if (isNumber(itemHeightRef.current)) &#123;      &#x2F;&#x2F; å®¹å™¨é«˜åº¦&#x2F;æ¯ä¸ªå…ƒç´ é«˜åº¦      return Math.ceil(        &#x2F;**å¤©èŠ±æ¿ï¼Œå‘ä¸Šå–æ•´*&#x2F; containerHeight &#x2F; itemHeightRef.current      );    &#125;    let sum &#x3D; 0;    let endIndex &#x3D; 0;    for (let i &#x3D; fromIndex; i &lt; list.length; i++) &#123;      const height &#x3D; itemHeightRef.current(i, list[i]);      sum +&#x3D; height;      endIndex &#x3D; i;      if (sum &gt;&#x3D; containerHeight) &#123;        break;      &#125;    &#125;    &#x2F;&#x2F; æœ€åä¸€ä¸ªå¯è§å…ƒç´  - å¼€å§‹å…ƒç´  &#x3D;  å¯è§å…ƒç´ æ•°é‡    return endIndex - fromIndex;  &#125;;  &#x2F;&#x2F; è·å–é—´éš”æ•°é‡  const getOffset &#x3D; (scrollTop: number) &#x3D;&gt; &#123;    if (isNumber(itemHeightRef.current)) &#123;      return Math.floor(scrollTop &#x2F; itemHeightRef.current) + 1;    &#125;    let sum &#x3D; 0;    let offset &#x3D; 0;    for (let i &#x3D; 0; i &lt; list.length; i++) &#123;      const height &#x3D; itemHeightRef.current(i, list[i]);      sum +&#x3D; height;      if (sum &gt;&#x3D; scrollTop) &#123;        offset &#x3D; i;        break;      &#125;    &#125;    return offset + 1;  &#125;;  &#x2F;&#x2F; è·å–é¡¶éƒ¨è·ç¦»  const getDistanceTop &#x3D; (index: number) &#x3D;&gt; &#123;    if (isNumber(itemHeightRef.current)) &#123;      const height &#x3D; index * itemHeightRef.current;      return height;    &#125;    const height &#x3D; list      .slice(0, index)      .reduce(        (sum, _, i) &#x3D;&gt;          sum +          (itemHeightRef.current as ItemHeight&lt;T&gt;)(            i,            list[i]          ) &#x2F;**è¿™å—æ˜¯ä¸ªå‡½æ•°ï¼Œå‚æ•°æ˜¯ i, item *&#x2F;,        0      );    return height;  &#125;;  &#x2F;&#x2F; é«˜åº¦å’Œ  const totalHeight &#x3D; useMemo(() &#x3D;&gt; &#123;    if (isNumber(itemHeightRef.current)) &#123;      return list.length * itemHeightRef.current;    &#125;    return list.reduce(      (sum, _, index) &#x3D;&gt;        sum + (itemHeightRef.current as ItemHeight&lt;T&gt;)(index, list[index]),      0    );  &#125;, [list]);  &#x2F;&#x2F;  const calculateRange &#x3D; () &#x3D;&gt; &#123;    const container &#x3D; getTargetElement(containerTarget);    const wrapper &#x3D; getTargetElement(wrapperTarget) as HTMLElement;    if (container &amp;&amp; wrapper) &#123;      const &#123; scrollTop, clientHeight &#125; &#x3D; container;      const offset &#x3D; getOffset(scrollTop);      const visibleCount &#x3D; getVisibleCount(clientHeight, offset);      const start &#x3D; Math.max(0, offset - overscan);      const end &#x3D; Math.min(list.length, offset + visibleCount + overscan);      const offsetTop &#x3D; getDistanceTop(start);      &#x2F;&#x2F; è¿™é‡Œæ˜¯è®¡ç®—å†…éƒ¨å®¹å™¨ä¸Šè¾¹è·ï¼ˆç”¨marginå’Œheightçœ‹æ¥å¯¹æœªæ¸²æŸ“çš„å…ƒç´ è¿›è¡Œå ä½ï¼‰ ä¸‹é¢æ”¾ä¸ªå›¾ï¼š      &#x2F;&#x2F; http:&#x2F;&#x2F;t-blog-images.aijs.top&#x2F;img&#x2F;202209021833942.webp      wrapper.style.height &#x3D; totalHeight - offsetTop + &quot;px&quot;;      wrapper.style.marginTop &#x3D; offsetTop + &quot;px&quot;;      &#x2F;&#x2F; å¯è§å…ƒç´       setTargetList(        list.slice(start, end).map((ele, index) &#x3D;&gt; (&#123;          data: ele,          index: index + start,        &#125;))      );    &#125;  &#125;;  useEffect(() &#x3D;&gt; &#123;    if (!size?.width || !size?.height) &#123;      return;    &#125;    calculateRange();  &#125;, [size?.width, size?.height, list]);  &#x2F;&#x2F; ç›‘å¬æ»šåŠ¨ï¼Œè¿›è¡Œä¸æ–­çš„è®¡ç®—  useEventListener(    &quot;scroll&quot;,    (e) &#x3D;&gt; &#123;      if (scrollTriggerByScrollToFunc.current) &#123;        scrollTriggerByScrollToFunc.current &#x3D; false;        return;      &#125;      e.preventDefault();      calculateRange();    &#125;,    &#123;      target: containerTarget,    &#125;  );  &#x2F;&#x2F; æ»šåŠ¨åˆ°æŸä¸ªä¸‹æ ‡  const scrollTo &#x3D; (index: number) &#x3D;&gt; &#123;    const container &#x3D; getTargetElement(containerTarget);    if (container) &#123;      scrollTriggerByScrollToFunc.current &#x3D; true;      container.scrollTop &#x3D; getDistanceTop(index);      calculateRange();    &#125;  &#125;;  return [targetList, useMemoizedFn(scrollTo)] as const;&#125;;export default useVirtualList;</code></pre><p><strong>è¿™é‡Œæ˜¯è®¡ç®—å†…éƒ¨å®¹å™¨ä¸Šè¾¹è·ï¼ˆç”¨ margin å’Œ height æ¥å¯¹æœªæ¸²æŸ“çš„å…ƒç´ è¿›è¡Œå ä½ï¼‰</strong></p><img src="http://t-blog-images.aijs.top/img/202209021833942.webp" /><h2 id="useRequest-éš¾æå“¦-æœ‰ç‚¹å¤š"><a href="#useRequest-éš¾æå“¦-æœ‰ç‚¹å¤š" class="headerlink" title="useRequest éš¾æå“¦ æœ‰ç‚¹å¤š"></a>useRequest éš¾æå“¦ æœ‰ç‚¹å¤š</h2><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>hooks è®¾è®¡ç›®æ ‡å¯¼å‘ï¼Œæ‹¿åˆ°å“ªäº›å€¼ å’Œ api</li></ul>]]></content>
      
      
      <categories>
          
          <category> æºç  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰è¿‡æœŸæœºåˆ¶çš„localStorage</title>
      <link href="//post/2022-08-24expirestorage.html"/>
      <url>//post/2022-08-24expirestorage.html</url>
      
        <content type="html"><![CDATA[<h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><p>å¯¹äºä¸€äº›æ•°æ®ä¸ç»å¸¸æ›´æ–°çš„æ•°æ®ï¼Œä¿æŒä¸€å®šæ—¶é—´çš„æ–°é²œçš„æ—¶å€™å¯ä»¥ç”¨äºç¼“å­˜</p><h2 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h2><p><a href="https://juejin.cn/post/7068533397911502879" target="_blank" >è§åŸæ–‡</a></p><p>æŠŠåŸæ–‡ä»£ç æ”¹äº†ä¸‹ï¼Œä¸»è¦å¯¹<code>JSON.parse</code>è¿›è¡Œ fixed</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Storage.prototype.setStorageWithAge &#x3D; (key, value, expires &#x3D; 60 * 1000) &#x3D;&gt; &#123;  if (isNaN(expires) || expires &lt; 1)    throw new Error(&quot;expires must be a number&quot;);  const obj &#x3D; &#123;    data: value,    &#x2F;&#x2F;å­˜å‚¨å€¼    time: Date.now(),    &#x2F;&#x2F;å­˜å€¼æ—¶é—´æˆ³    maxExpires: expires,    &#x2F;&#x2F;è¿‡æœŸæ—¶é—´  &#125;;  localStorage.setItem(key, JSON.stringify(obj));&#125;;Storage.prototype.getStorageWithAge &#x3D; (key) &#x3D;&gt; &#123;  try &#123;    const &#123; data, time, maxExpires &#125; &#x3D; JSON.parse(localStorage.getItem(key));    if (time + maxExpires &lt; Date.now()) &#123;      localStorage.removeItem(key);      return undefined;    &#125;    return data;  &#125; catch (error) &#123;    return undefined; &#x2F;&#x2F; JSON.parseè§£æundefinedæ—¶å€™ç›´æ¥è¿”å›  &#125;&#125;;&#x2F;&#x2F; æµ‹è¯•æ•°æ®localStorage.setStorageWithAge(&quot;amingxiansen&quot;, &quot;æµ‹è¯•è¿‡æœŸæ—¶é—´&quot;, 5000);localStorage.getStorageWithAge(&quot;amingxiansen&quot;);</code></pre><img src="http://t-blog-images.aijs.top/img/202208241654212.webp" /><p>æ³¨æ„ï¼šå¯¹äºä¸€äº›æ•æ„Ÿæ•°æ®ï¼Œéœ€è¦åŠ å¯†</p>]]></content>
      
      
      <categories>
          
          <category> å­˜å‚¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­˜å‚¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react hook å¦‚ä½•å¢åŠ ä¾èµ–æ›´æ–°</title>
      <link href="//post/2022-08-23react-hook.html"/>
      <url>//post/2022-08-23react-hook.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æƒ³å°†ï¼Œä¸šåŠ¡é€»è¾‘æŒ‰é’®ç»„å°è£…ä¸º hook,åœ¨ç§»åŠ¨ç«¯å’Œ pc ç«¯ä¹‹é—´è¿›è¡Œé€»è¾‘å¤ç”¨ã€‚åœ¨è¯¦æƒ…é¡µé¢ä½¿ç”¨æ—¶å€™ï¼Œå‘ç°å¹¶æ²¡æœ‰ç”Ÿæ•ˆ</p><p>åŸå› ï¼š æ— æ³•ç»™ useActionsï¼Œå¢åŠ ä¾èµ–é¡¹ï¼Œç±»ä¼¼ useEffect çš„ç¬¬äºŒå‚æ•°ä¸€æ ·ã€‚</p><p>æŸ¥è¯¢äº† ahooks çš„ hookï¼Œäº†è§£ç±»ä¼¼è§£å†³æ–¹æ¡ˆ</p><h2 id="useActions"><a href="#useActions" class="headerlink" title="useActions"></a>useActions</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; EUserType, EnumProblemStatus &#125; from &quot;@&#x2F;const&quot;;import &#123; CommonModel &#125; from &quot;@&#x2F;models&quot;;import &#123; useMemo &#125; from &quot;react&quot;;import &#123; useSelector &#125; from &quot;react-redux&quot;;export const useActions &#x3D; (detail) &#x3D;&gt; &#123;  const user &#x3D; useSelector(CommonModel.selectors.getUser);  const &#123; state: status &#125; &#x3D; detail;  const userType &#x3D; useMemo(() &#x3D;&gt; &#123;    if (detail?.creatorPerson?.personId &#x3D;&#x3D;&#x3D; user.staffId) &#123;      return EUserType.creator;    &#125;    if (detail?.solverStaffPerson?.personId &#x3D;&#x3D;&#x3D; user.staffId) &#123;      return EUserType.operator;    &#125;    if (      detail?.cooperationStaffs?.findIndex(        (item) &#x3D;&gt; item.personId &#x3D;&#x3D;&#x3D; user.staffId      ) &gt; -1    ) &#123;      return EUserType.helper;    &#125;    return EUserType.other;  &#125;, [    detail?.cooperationStaffs,    detail.creatorPerson?.personId,    detail?.solverStaffPerson?.personId,    user?.staffId,  ]);  const btnComps &#x3D; useMemo(    () &#x3D;&gt; (&#123;      &#x2F;&#x2F; edit: &#123;      &#x2F;&#x2F;   text: &#39;ç¼–è¾‘&#39;,      &#x2F;&#x2F;   key: &#39;edit&#39;,      &#x2F;&#x2F; &#125;,      start_solve: &#123;        text: &quot;å¼€å§‹å¤„ç†&quot;,        key: &quot;start_solve&quot;,        value: 2,      &#125;,      cancel: &#123;        text: &quot;æ’¤é”€&quot;,        icon: &quot;icon-huifu&quot;,        disabledMessage: &quot;éåˆ›å»ºäººä¸å¯æ’¤é”€&quot;,        key: &quot;cancel&quot;,        type: &quot;default&quot;,        confirm: true,        value: 7,        disabled: user.staffId !&#x3D;&#x3D; detail?.creatorPerson?.personId,      &#125;,      trans: &#123;        text: &quot;è½¬äº¤&quot;,        icon: &quot;icon-transfer&quot;,        key: &quot;trans&quot;,        message: &quot;è¯·é€‰æ‹©è½¬äº¤äºº&quot;,        required: true,        contact: true,        limit: 1,        allowType: [&quot;staff&quot;],        defaultValue: [],        disabledValues: [user.staffId],        value: 8,      &#125;,      finish: &#123;        text: &quot;å®Œç»“&quot;,        icon: &quot;icon-guangbo&quot;,        key: &quot;finish&quot;,        confirm: true,        value: 6,      &#125;,      cuiBan: &#123;        text: &quot;å‚¬åŠ&quot;,        key: &quot;cuiBan&quot;,        confirm: true,        value: 12,      &#125;,      solved: &#123;        text: &quot;å·²è§£å†³&quot;,        icon: &quot;icon-yiwancheng&quot;,        key: &quot;solved&quot;,        confirm: true,        value: 5,      &#125;,      changer: &#123;        text: &quot;å˜æ›´ç»åŠäºº&quot;,        key: &quot;changer&quot;,        contact: true,        limit: 1,        allowType: [&quot;staff&quot;],        defaultValue: [],        message: &quot;è¯·é€‰æ‹©è½¬å˜æ›´ç»åŠäºº&quot;,        required: true,        value: 8,        disabledValues: [user.staffId],      &#125;,      add_helper: &#123;        text: &quot;æ·»åŠ åä½œäºº&quot;,        key: &quot;add_helper&quot;,        icon: &quot;icon-teamwork&quot;,        contact: true,        allowType: [&quot;staff&quot;],        defaultValue: [],        message: &quot;è¯·é€‰æ‹©åä½œäºº&quot;,        required: true,        value: 9,      &#125;,      notify_creator: &#123;        text: &quot;æé†’ç¡®è®¤&quot;,        key: &quot;notify_creator&quot;,        icon: &quot;icon-querentixing&quot;,        confirm: true,        value: 13,      &#125;,      receiver: &#123;        text: &quot;è®¤é¢†å¤„ç†&quot;,        key: &quot;receiver&quot;,        icon: &quot;icon-receiver&quot;,        confirm: true,        value: 8,      &#125;,      exit_helper: &#123;        text: &quot;é€€å‡ºåä½œ&quot;,        key: &quot;exit_helper&quot;,        confirm: true,        value: 11,      &#125;,      join: &#123;        text: &quot;åŠ å…¥åä½œ&quot;,        confirm: true,        key: &quot;join&quot;,        value: 9,      &#125;,      continue: &#123;        text: &quot;ç»§ç»­å¤„ç†&quot;,        key: &quot;continue&quot;,        value: 2,      &#125;,      end: &#123;        text: &quot;å®Œç»“&quot;,        key: &quot;end&quot;,        confirm: true,        value: 6,      &#125;,    &#125;),    [detail.problemId]  );  const actionBtns &#x3D; useMemo(() &#x3D;&gt; &#123;    const btns &#x3D; [];    switch (status) &#123;      case EnumProblemStatus.waiting:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.cancel);            btns.push(btnComps.cuiBan);            btns.push(btnComps.changer);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.start_solve);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.processing:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.solved);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.delay:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.cancel);            btns.push(btnComps.cuiBan);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.solved);            btns.push(btnComps.continue);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.overdue:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.cancel);            btns.push(btnComps.cuiBan);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.solved);            btns.push(btnComps.continue);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.solved:        switch (userType) &#123;          case EUserType.creator:            btns.push(btnComps.end);            break;          case EUserType.operator:            btns.push(btnComps.notify_creator);            break;          default:        &#125;        break;      case EnumProblemStatus.finish:        break;      case EnumProblemStatus.cancel:        break;      default:        break;    &#125;    return btns;  &#125;, [detail.status, userType]);  return actionBtns;&#125;;</code></pre><h2 id="ahooks-ä¸­-ä¾èµ–åˆ·æ–°"><a href="#ahooks-ä¸­-ä¾èµ–åˆ·æ–°" class="headerlink" title="ahooks ä¸­ ä¾èµ–åˆ·æ–°"></a>ahooks ä¸­ ä¾èµ–åˆ·æ–°</h2><p><a href="https://ahooks.js.org/zh-CN/hooks/use-request/refresy-deps#%E4%BE%9D%E8%B5%96%E5%88%B7%E6%96%B0" target="_blank" >è§</a></p><p>useRequest æä¾›äº†ä¸€ä¸ª options.refreshDeps å‚æ•°ï¼Œå½“å®ƒçš„å€¼å˜åŒ–åï¼Œä¼šé‡æ–°è§¦å‘è¯·æ±‚ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const [userId, setUserId] &#x3D; useState(&quot;1&quot;);const &#123; data, run &#125; &#x3D; useRequest(() &#x3D;&gt; getUserSchool(userId), &#123;  refreshDeps: [userId],&#125;);</code></pre><p>ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼ŒuseRequest ä¼šåœ¨åˆå§‹åŒ–å’Œ userId å˜åŒ–æ—¶ï¼Œè§¦å‘å‡½æ•°æ‰§è¡Œã€‚</p><p>ä¸ä¸‹é¢ä»£ç å®ç°åŠŸèƒ½å®Œå…¨ä¸€è‡´</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const [userId, setUserId] &#x3D; useState(&quot;1&quot;);const &#123; data, refresh &#125; &#x3D; useRequest(() &#x3D;&gt; getUserSchool(userId));useEffect(() &#x3D;&gt; &#123;  refresh();&#125;, [userId]);</code></pre><h2 id="useRequest-æºç æ‰¾æ‰¾"><a href="#useRequest-æºç æ‰¾æ‰¾" class="headerlink" title="useRequest æºç æ‰¾æ‰¾"></a>useRequest æºç æ‰¾æ‰¾</h2><p><a href="https://github.com/alibaba/hooks/blob/93630e73f445871fb6b14fcb0bf3b9fddb1ba0aa/packages/hooks/src/useRequest/src/useRequest.ts#L24" target="_blank" > options?: Options&lt;TData, TParams&gt;,</a></p><p><a href="https://github.com/alibaba/hooks/blob/93630e73f445871fb6b14fcb0bf3b9fddb1ba0aa/packages/hooks/src/useRequest/src/types.ts#L52" target="_blank" > refreshDeps type</a></p><p><a href="https://github.com/alibaba/hooks/blob/93630e73f445871fb6b14fcb0bf3b9fddb1ba0aa/packages/hooks/src/useRequest/src/useRequestImplement.ts#L27" target="_blank" > const fetchInstance &#x3D; useCreation(() &#x3D;&gt; {</a></p><p><a href="https://github.com/alibaba/hooks/blob/93630e73f445871fb6b14fcb0bf3b9fddb1ba0aa/packages/hooks/src/useCreation/index.ts#L5" target="_blank" ><code>export default function useCreation&lt;T&gt;(factory: () =&gt; T, deps: DependencyList) &#123;</code></a></p><h2 id="useCreation"><a href="#useCreation" class="headerlink" title="useCreation"></a>useCreation</h2><p><a href="https://ahooks.js.org/zh-CN/hooks/use-creation#usecreation" target="_blank" > usecreation</a></p><img src="http://t-blog-images.aijs.top/img/202208231957375.webp" /><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function useCreation&lt;T&gt;(factory: () &#x3D;&gt; T, deps: any[]): T;</code></pre><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import React, &#123; useState &#125; from &quot;react&quot;;import &#123; useCreation &#125; from &quot;ahooks&quot;;class Foo &#123;  constructor() &#123;    this.data &#x3D; Math.random();  &#125;  data: number;&#125;export default function () &#123;  const foo &#x3D; useCreation(() &#x3D;&gt; new Foo(), []); &#x2F;&#x2F; ä¾èµ–é¡¹æ²¡å˜åŒ–ï¼Œ ä¸ä¼šé‡å¤æ‰§è¡Œ factory  const [, setFlag] &#x3D; useState(&#123;&#125;);  return (    &lt;&gt;      &lt;p&gt;&#123;foo.data&#125;&lt;&#x2F;p&gt;      &lt;button        type&#x3D;&quot;button&quot;        onClick&#x3D;&#123;() &#x3D;&gt; &#123;          setFlag(&#123;&#125;); &#x2F;&#x2F; å¯¹è±¡æ›´æ–°        &#125;&#125;      &gt;        Rerender      &lt;&#x2F;button&gt;    &lt;&#x2F;&gt;  );&#125;</code></pre><p><a href="https://github.com/alibaba/hooks/blob/93630e73f445871fb6b14fcb0bf3b9fddb1ba0aa/packages/hooks/src/useRequest/src/useRequestImplement.ts#L27" target="_blank" >è‡³æ­¤ï¼Œè¿™é‡Œçš„å®ä¾‹åŒ–ä¹Ÿå¥½ç†è§£äº†</a></p><h2 id="ä»¥ä¸Šå†…å®¹æƒ³æ­ªäº†"><a href="#ä»¥ä¸Šå†…å®¹æƒ³æ­ªäº†" class="headerlink" title="ä»¥ä¸Šå†…å®¹æƒ³æ­ªäº†"></a>ä»¥ä¸Šå†…å®¹æƒ³æ­ªäº†</h2><ul><li>ä¸­é€”è¯•ç”¨äº†useCreation, eslintä¸èƒ½å¤Ÿæç¤ºä¾èµ–é¡¹ï¼Œæ‰€ä»¥åˆå›åˆ°äº†<code>useMemo</code></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; useActionsimport &#123; EnumProblemStatus, EUserType &#125; from &quot;@&#x2F;const&quot;;import &#123; IProblemDetail &#125; from &quot;@&#x2F;services&#x2F;problems&quot;;import &#123; useMemo &#125; from &quot;react&quot;;export const useActions &#x3D; (  detail: IProblemDetail,  user: Staff,  mobile &#x3D; false) &#x3D;&gt; &#123;  const userType &#x3D; useMemo(() &#x3D;&gt; &#123;    if (detail?.creatorPerson?.personId &#x3D;&#x3D;&#x3D; user.staffId) &#123;      return EUserType.creator;    &#125;    if (detail?.solverStaffPerson?.personId &#x3D;&#x3D;&#x3D; user.staffId) &#123;      return EUserType.operator;    &#125;    if (      detail?.cooperationStaffs?.findIndex(        (item) &#x3D;&gt; item.personId &#x3D;&#x3D;&#x3D; user.staffId      ) &gt; -1    ) &#123;      return EUserType.helper;    &#125;    return EUserType.other;  &#125;, [    detail?.cooperationStaffs,    detail.creatorPerson?.personId,    detail?.solverStaffPerson?.personId,    user?.staffId,  ]);  const btnComps &#x3D; useMemo(() &#x3D;&gt; &#123;    const &#123; creatorPerson, solverStaffPerson, cooperationStaffs &#x3D; [] &#125; &#x3D; detail;    if (!creatorPerson) return;    const disabled_solverStaffPersonIds &#x3D; []      .concat(creatorPerson.personId)      .concat(solverStaffPerson.personId || []);    const disabled_cooperationStaffsIds &#x3D; []      .concat(creatorPerson.personId)      .concat(solverStaffPerson.personId || [])      .concat(cooperationStaffs.map((item) &#x3D;&gt; item.personId));    return &#123;      &#x2F;&#x2F; edit: &#123;      &#x2F;&#x2F;   title: &#39;ç¼–è¾‘&#39;,      &#x2F;&#x2F;   key: &#39;edit&#39;,      &#x2F;&#x2F; &#125;,      comment: &#123;        title: &quot;è¯„è®º&quot;,        key: &quot;comment&quot;,        icon: &quot;icon-kuaisuhuifu&quot;,        keep: true,      &#125;,      start_solve: &#123;        title: &quot;å¼€å§‹å¤„ç†&quot;,        key: &quot;start_solve&quot;,        icon: &quot;icon-kaishi&quot;,        value: 2,      &#125;,      cancel: &#123;        title: &quot;æ’¤é”€&quot;,        icon: &quot;icon-huifu&quot;,        disabledMessage: &quot;éåˆ›å»ºäººä¸å¯æ’¤é”€&quot;,        key: &quot;cancel&quot;,        type: &quot;default&quot;,        confirm: true,        value: 7,      &#125;,      trans: &#123;        title: &quot;è½¬äº¤&quot;,        icon: &quot;icon-transfer&quot;,        key: &quot;trans&quot;,        message: &quot;è¯·é€‰æ‹©è½¬äº¤äºº&quot;,        required: true,        contact: true,        limit: 1,        allowType: [&quot;staff&quot;],        defaultValue: [],        disabledValues: disabled_solverStaffPersonIds,        value: 8,      &#125;,      finish: &#123;        title: &quot;å®Œç»“&quot;,        icon: &quot;icon-guangbo&quot;,        key: &quot;finish&quot;,        confirm: true,        value: 6,      &#125;,      cuiBan: &#123;        title: &quot;å‚¬åŠ&quot;,        key: &quot;cuiBan&quot;,        icon: &quot;icon-guangbo&quot;,        confirm: true,        value: 12,      &#125;,      solved: &#123;        title: &quot;å·²è§£å†³&quot;,        icon: &quot;icon-yiwancheng&quot;,        key: &quot;solved&quot;,        confirm: true,        value: 5,      &#125;,      changer: &#123;        title: &quot;å˜æ›´ç»åŠäºº&quot;,        key: &quot;changer&quot;,        contact: true,        icon: &quot;icon-transfer&quot;,        limit: 1,        allowType: [&quot;staff&quot;],        defaultValue: [],        message: &quot;è¯·é€‰æ‹©è½¬å˜æ›´ç»åŠäºº&quot;,        required: true,        value: 8,        disabledValues: disabled_solverStaffPersonIds,      &#125;,      add_helper: &#123;        title: &quot;æ·»åŠ åä½œäºº&quot;,        key: &quot;add_helper&quot;,        icon: &quot;icon-teamwork&quot;,        contact: true,        allowType: [&quot;staff&quot;],        defaultValue: [],        message: &quot;è¯·é€‰æ‹©åä½œäºº&quot;,        required: true,        value: 9,        disabledValues: disabled_cooperationStaffsIds,      &#125;,      notify_creator: &#123;        title: &quot;æé†’ç¡®è®¤&quot;,        key: &quot;notify_creator&quot;,        icon: &quot;icon-querentixing&quot;,        confirm: true,        value: 13,      &#125;,      receiver: &#123;        title: &quot;è®¤é¢†å¤„ç†&quot;,        key: &quot;receiver&quot;,        icon: &quot;icon-receiver&quot;,        confirm: true,        value: 8,      &#125;,      exit_helper: &#123;        title: &quot;é€€å‡ºåä½œ&quot;,        key: &quot;exit_helper&quot;,        confirm: true,        icon: &quot;icon-tuichu&quot;,        value: 11,      &#125;,      join: &#123;        title: &quot;åŠ å…¥åä½œ&quot;,        confirm: true,        key: &quot;join&quot;,        icon: &quot;icon-join&quot;,        value: 9,      &#125;,      continue: &#123;        title: &quot;ç»§ç»­å¤„ç†&quot;,        key: &quot;continue&quot;,        value: 2,      &#125;,      end: &#123;        title: &quot;å®Œç»“&quot;,        key: &quot;end&quot;,        confirm: true,        icon: &quot;icon-jieshu&quot;,        value: 6,      &#125;,    &#125;;  &#125;, [detail]);  const actions &#x3D; useMemo(() &#x3D;&gt; &#123;    const btns &#x3D; [];    const solverId &#x3D; detail.solverStaffPerson?.personId;    if (!btnComps) return [];    mobile &amp;&amp; btns.push(btnComps.comment);    switch (detail.state) &#123;      case EnumProblemStatus.waiting:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.cancel);            btns.push(btnComps.cuiBan);            btns.push(btnComps.changer);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.start_solve);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.processing:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            !solverId &amp;&amp; btns.push(btnComps.changer);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.solved);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.delay:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.cancel);            btns.push(btnComps.cuiBan);            !solverId &amp;&amp; btns.push(btnComps.changer);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.solved);            btns.push(btnComps.continue);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.overdue:        switch (userType) &#123;          case EUserType.creator:            &#x2F;&#x2F; btns.push(btnComps.edit)            btns.push(btnComps.cancel);            btns.push(btnComps.cuiBan);            !solverId &amp;&amp; btns.push(btnComps.changer);            btns.push(btnComps.add_helper);            break;          case EUserType.operator:            btns.push(btnComps.trans);            btns.push(btnComps.solved);            btns.push(btnComps.continue);            btns.push(btnComps.add_helper);            break;          case EUserType.helper:            btns.push(btnComps.exit_helper);            break;          case EUserType.other:            btns.push(btnComps.receiver);            btns.push(btnComps.join);            break;          default:        &#125;        break;      case EnumProblemStatus.solved:        switch (userType) &#123;          case EUserType.creator:            btns.push(btnComps.end);            break;          case EUserType.operator:            btns.push(btnComps.notify_creator);            break;          default:        &#125;        break;      case EnumProblemStatus.finish:        break;      case EnumProblemStatus.cancel:        break;      default:        break;    &#125;    return btns;  &#125;, [    detail.solverStaffPerson?.personId,    detail.state,    btnComps,    mobile,    userType,  ]);  return actions;&#125;;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; ä½¿ç”¨const actionBtns &#x3D; useActions(detail, user);</code></pre>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tree</title>
      <link href="//post/2022-08-23tree.html"/>
      <url>//post/2022-08-23tree.html</url>
      
        <content type="html"><![CDATA[<h2 id="mysql-å­˜å‚¨çš„å‡ ç§æ–¹å¼"><a href="#mysql-å­˜å‚¨çš„å‡ ç§æ–¹å¼" class="headerlink" title="mysql å­˜å‚¨çš„å‡ ç§æ–¹å¼"></a>mysql å­˜å‚¨çš„å‡ ç§æ–¹å¼</h2><p><a href="https://www.zhihu.com/question/20417447" target="_blank" >è§</a></p><img src="http://t-blog-images.aijs.top/img/202208231531157.webp" /><p>1,4 ç”¨è¿‡ï¼Œ 2 è§è¿‡ï¼ˆå½“å‰å…¬å¸ DHR ç³»ç»Ÿç»„ç»‡æ¶æ„åœ¨ç”¨ï¼‰</p><h2 id="js-è·å–æ ‘æŸä¸ªèŠ‚ç‚¹"><a href="#js-è·å–æ ‘æŸä¸ªèŠ‚ç‚¹" class="headerlink" title="js è·å–æ ‘æŸä¸ªèŠ‚ç‚¹"></a>js è·å–æ ‘æŸä¸ªèŠ‚ç‚¹</h2><p>åœºæ™¯ï¼šç¼–è¾‘æ ‘èŠ‚ç‚¹ï¼Œåˆ·æ–°æ ‘æ•°æ®ï¼Œè¿›è¡Œç¼–è¾‘èŠ‚ç‚¹å›æ˜¾ï¼ŒæŸäº›æƒ…å†µä¸‹ï¼Œæ ‘èŠ‚ç‚¹è¢«è½¬ç§»ä»–äººï¼Œå½“å‰èŠ‚ç‚¹ä¸éœ€è¦å›æ˜¾</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * * @param &#123;è¦æŸ¥è¯¢çš„èŠ‚ç‚¹key&#125; targetValue * @param &#123;æ•°ç»„å½¢å¼ï¼Œæ ‘æ•°æ®&#125; data * @returns *&#x2F;const findTreeNodeByKey &#x3D; (  tree: TreeNode[],  targetValue: string | number,  options &#x3D; &#123;    find_field: &quot;id&quot;,    children: &quot;children&quot;,  &#125;) &#x3D;&gt; &#123;  let result &#x3D; null;  const ffindeNodeByKey &#x3D; (    data: TreeNode[],    skey: string | number,    options  ) &#x3D;&gt; &#123;    const loop &#x3D; (_data, options) &#x3D;&gt; &#123;      _data.forEach((item) &#x3D;&gt; &#123;        if (item[find_field] &#x3D;&#x3D;&#x3D; skey) &#123;          result &#x3D; item;        &#125;        if (item[options.children]) &#123;          loop(item[options.children], options);        &#125;      &#125;);    &#125;;    return loop(data, options);  &#125;;  ffindeNodeByKey(tree, targetValue, options);  return result;&#125;;</code></pre><h3 id="æµ‹è¯•æ•°æ®"><a href="#æµ‹è¯•æ•°æ®" class="headerlink" title="æµ‹è¯•æ•°æ®"></a>æµ‹è¯•æ•°æ®</h3><details class="custom-details"><summary>æµ‹è¯•æ•°æ®è¯¦æƒ…</summary><p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const data &#x3D; [  &#123;    id: 0,    parentId: null,    bizName: &quot;æ‰€æœ‰ä¸šåŠ¡&quot;,    child: [      &#123;        id: 1,        parentId: 0,        bizName: &quot;APPé¡¹ç›®ç»„1&quot;,        child: [          &#123;            id: 2,            parentId: 1,            bizName: &quot;APPé¡¹ç›®ç»„-1&quot;,          &#125;,          &#123;            id: 27,            parentId: 1,            bizName: &quot;æµ‹è¯•&quot;,          &#125;,        ],      &#125;,      &#123;        id: 3,        parentId: 0,        bizName: &quot;0-APPé¡¹ç›®ç»„&quot;,        child: [          &#123;            id: 29,            parentId: 3,            bizName: &quot;æµ‹è¯•ä¸šåŠ¡çº¿&quot;,          &#125;,          &#123;            id: 42,            parentId: 3,            bizName: &quot;æµ‹è¯•acl&quot;,          &#125;,        ],      &#125;,      &#123;        id: 5,        parentId: 0,        bizName: &quot;æµ‹è¯•çš„ä¸šåŠ¡çº¿4&quot;,        child: [          &#123;            id: 23,            parentId: 5,            bizName: &quot;ä¸šåŠ¡çº¿æµ‹è¯•&quot;,          &#125;,        ],      &#125;,      &#123;        id: 6,        parentId: 0,        bizName: &quot;æµ‹è¯•çš„ä¸šåŠ¡çº¿5&quot;,        child: [          &#123;            id: 24,            parentId: 6,            bizName: &quot;æµ‹è¯•æµ‹è¯•ä¸šåŠ¡çº¿æŠ¥é”™&quot;,          &#125;,        ],      &#125;,      &#123;        id: 8,        parentId: 0,        bizName: &quot;æµ‹è¯•çš„ä¸šåŠ¡çº¿8&quot;,        child: [          &#123;            id: 25,            parentId: 8,            bizName: &quot;å¼€å‘æµ‹è¯•çš„ä¸šåŠ¡çº¿21&quot;,          &#125;,          &#123;            id: 26,            parentId: 8,            bizName: &quot;å¼€å‘æµ‹è¯•çš„ä¸šåŠ¡çº¿22&quot;,          &#125;,        ],      &#125;,      &#123;        id: 9,        parentId: 0,        bizName: &quot;æµ‹è¯•çš„ä¸šåŠ¡çº¿9&quot;,      &#125;,    ],  &#125;,];</code></pre></p></details><h3 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">console.log(&quot;res - 2&quot;, findTreeNodeByKey(2, data));console.log(&quot;res - 1326&quot;, findTreeNodeByKey(13, data));&#x2F;&#x2F; console.log(&quot;res - 0&quot;, findTreeNodeByKey(0, data));console.log(&quot;res - 996&quot;, findTreeNodeByKey(996, data));</code></pre><h2 id="js-è·å–æŸä¸ªèŠ‚ç‚¹-å¯¹åº”çš„è·¯å¾„"><a href="#js-è·å–æŸä¸ªèŠ‚ç‚¹-å¯¹åº”çš„è·¯å¾„" class="headerlink" title="js è·å–æŸä¸ªèŠ‚ç‚¹, å¯¹åº”çš„è·¯å¾„"></a>js è·å–æŸä¸ªèŠ‚ç‚¹, å¯¹åº”çš„è·¯å¾„</h2><ul><li>è·¯å¾„ type&#x3D;path</li><li>çˆ¶èŠ‚ç‚¹ç»„ type&#x3D;item</li></ul><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * * @param &#123;æ•°ç»„ï¼šæ ‘data&#125; tree * @param &#123;ç›®æ ‡å€¼&#125; targetValue * @param &#123;é…ç½®ä¿¡æ¯&#125; options * @returns *&#x2F;function findNodePaths(tree, targetValue, options) &#123;  const defaultOptions &#x3D; &#123;    find_field: &quot;id&quot;, &#x2F;&#x2F; ä¸ targetValueåŒ¹é…çš„å­—æ®µ    path_field: &quot;id&quot;, &#x2F;&#x2F; ç”Ÿæˆè·¯å¾„çš„å­—æ®µ    separator: &quot;,&quot;, &#x2F;&#x2F; è·¯å¾„å­—æ®µåˆ†éš”ç¬¦    type: &quot;path&quot;, &#x2F;&#x2F; path &#x2F; item    children: &quot;children&quot;,  &#125;;  console.log(&#39;options&#39;,options)  options &#x3D; &#123;    ...defaultOptions,    ...options,  &#125;;  &#x2F;&#x2F; é¦–å…ˆæˆ‘ä»¬å…ˆå®šä¹‰ä¸ªæ•°ç»„ï¼Œç”¨æ¥ä¿å­˜è·¯å¾„èŠ‚ç‚¹id  let nodePathArray &#x3D; [];  &#x2F;&#x2F; (treeä¸ºç›®æ ‡æ ‘ï¼ŒtargetIdä¸ºç›®æ ‡èŠ‚ç‚¹id)  function getNodeRoute(tree, targetValue, options) &#123;    for (let index &#x3D; 0; index &lt; tree.length; index++) &#123;      if (tree[index][options.children]) &#123;        let endRecursiveLoop &#x3D; getNodeRoute(          tree[index][options.children],          targetValue,          options        );        console.log(&quot;endRecursiveLoop&quot;, endRecursiveLoop);        if (endRecursiveLoop) &#123;          if (options.type &#x3D;&#x3D;&#x3D; &quot;path&quot;) &#123;            nodePathArray.push(tree[index][options.path_field]);          &#125; else &#123;            nodePathArray.push(tree[index]);          &#125;          return true;        &#125;      &#125;      if (tree[index][options.find_field] &#x3D;&#x3D;&#x3D; targetValue) &#123;        if (options.type &#x3D;&#x3D;&#x3D; &quot;path&quot;) &#123;          nodePathArray.push(tree[index][options.path_field]);        &#125; else &#123;          nodePathArray.push(tree[index]);        &#125;        return true;      &#125;    &#125;  &#125;  &#x2F;&#x2F; è½¬åŒ–æˆæ•°ç»„  let _tree &#x3D; [];  if (Array.isArray(tree)) &#123;    _tree &#x3D; tree;  &#125; else &#123;    _tree &#x3D; [tree];  &#125;  getNodeRoute(_tree, targetValue, options);  console.log(&quot;nodePathArray&quot;, nodePathArray);  if (options.type &#x3D;&#x3D;&#x3D; &quot;path&quot;) &#123;    return nodePathArray.reverse().join(options.separator);  &#125; else &#123;    return nodePathArray.reverse();  &#125;&#125;</code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">const paths &#x3D; findNodePaths(data, 81); &#x2F;&#x2F;æŸ¥æ‰¾idä¸º112çš„èŠ‚ç‚¹è·¯å¾„console.log(paths);const pathItems &#x3D; findNodePaths(treeArray, 81, &#123; type: &quot;item&quot; &#125;); &#x2F;&#x2F;æŸ¥æ‰¾idä¸º112çš„èŠ‚ç‚¹è·¯å¾„console.log(pathItems);</code></pre>]]></content>
      
      
      <categories>
          
          <category> tree </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨ç«¯é—®é¢˜ï¼ˆå¾…è¡¥å……ï¼‰</title>
      <link href="//post/2022-08-22mb.html"/>
      <url>//post/2022-08-22mb.html</url>
      
        <content type="html"><![CDATA[<h2 id="ã€ç§»åŠ¨ç«¯ã€‘ç§»åŠ¨ç«¯ç‚¹å‡»å¯ç‚¹å‡»å…ƒç´ æ—¶ï¼Œå‡ºç°è“è‰²é»˜è®¤èƒŒæ™¯è‰²"><a href="#ã€ç§»åŠ¨ç«¯ã€‘ç§»åŠ¨ç«¯ç‚¹å‡»å¯ç‚¹å‡»å…ƒç´ æ—¶ï¼Œå‡ºç°è“è‰²é»˜è®¤èƒŒæ™¯è‰²" class="headerlink" title="ã€ç§»åŠ¨ç«¯ã€‘ç§»åŠ¨ç«¯ç‚¹å‡»å¯ç‚¹å‡»å…ƒç´ æ—¶ï¼Œå‡ºç°è“è‰²é»˜è®¤èƒŒæ™¯è‰²"></a>ã€ç§»åŠ¨ç«¯ã€‘ç§»åŠ¨ç«¯ç‚¹å‡»å¯ç‚¹å‡»å…ƒç´ æ—¶ï¼Œå‡ºç°è“è‰²é»˜è®¤èƒŒæ™¯è‰²</h2><p><a href="https://www.cnblogs.com/Mxy-cnblog/p/9856460.html" target="_blank" >è§</a></p><pre class="line-numbers language-none"><code class="language-none">webé¡µé¢æ”¾åœ¨ç§»åŠ¨ç«¯ï¼Œç‚¹å‡»button æ ‡ç­¾æˆ–è€…æ·»åŠ äº†cursor:pointer æ ·å¼çš„æ ‡ç­¾ï¼Œä¼šå‡ºç° è“è‰²èƒŒæ™¯è‰²ï¼Œ è§£å†³æ–¹æ¡ˆï¼šç»™ç›¸åº”æ ‡ç­¾ æˆ–è€…ç›´æ¥åœ¨body æ ‡ç­¾ä¸Šæ·»åŠ  æ ·å¼ï¼š&#96;&#96;&#96;css-webkit-tap-highlight-color: transparent;</code></pre><p>æˆ–è€…</p><pre class="line-numbers language-css" data-language="css"><code class="language-css">-webkit-tap-highlight-color: rgba(0, 0, 0, 0);</code></pre><h2 id="æ¨ªç«–å±æ£€æµ‹"><a href="#æ¨ªç«–å±æ£€æµ‹" class="headerlink" title="æ¨ªç«–å±æ£€æµ‹"></a>æ¨ªç«–å±æ£€æµ‹</h2><p><a href="https://www.cnblogs.com/Mxy-cnblog/p/9916605.html" target="_blank" >è§</a></p><pre class="line-numbers language-css" data-language="css"><code class="language-css">@media screen and (orientation: portrait) &#123;  &#x2F;* ç«–å± *&#x2F;&#125;@media screen and (orientation: landscape) &#123;  &#x2F;* æ¨ªå± *&#x2F;&#125;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">var d &#x3D; window.matchMedia(&quot;(orientation: portrait)&quot;);onMatchMeidaChange(d);d.addListener(onMatchMeidaChange);function onMatchMeidaChange(d) &#123;  if (d.matches) &#123;    &#x2F;&#x2F; ç«–å±  &#125; else &#123;    &#x2F;&#x2F;æ¨ªå±  &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> ç§»åŠ¨ç«¯é€‚é… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç§»åŠ¨ç«¯é€‚é… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>antd-mobile æºç </title>
      <link href="//post/2022-08-20antd.html"/>
      <url>//post/2022-08-20antd.html</url>
      
        <content type="html"><![CDATA[<h2 id="Mask-ç»„ä»¶-getContainer"><a href="#Mask-ç»„ä»¶-getContainer" class="headerlink" title="Mask ç»„ä»¶ getContainer"></a>Mask ç»„ä»¶ getContainer</h2><p><a href="https://github.com/ant-design/ant-design-mobile/blob/3d8d66b54e1ebadccfa17dc80208cceeeeac1555/src/utils/render-to-container.ts#L1" target="_blank" >è§</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; renderToContainerimport &#123; createPortal &#125; from &quot;react-dom&quot;;import &#123; ReactElement, ReactPortal &#125; from &quot;react&quot;;import &#123; resolveContainer &#125; from &quot;.&#x2F;get-container&quot;;import &#123; canUseDom &#125; from &quot;.&#x2F;can-use-dom&quot;;export type GetContainer &#x3D; HTMLElement | (() &#x3D;&gt; HTMLElement) | null;&#x2F;&#x2F; å°†èŠ‚ç‚¹æŒ‚åœ¨åˆ° getContainerexport function renderToContainer(  getContainer: GetContainer,  node: ReactElement) &#123;  if (canUseDom &amp;&amp; getContainer) &#123;    const container &#x3D; resolveContainer(getContainer);    return createPortal(node, container) as ReactPortal; &#x2F;&#x2F; React portal  &#125;  return node;&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function resolveContainer(  getContainer: HTMLElement | (() &#x3D;&gt; HTMLElement) | undefined | null) &#123;  const container &#x3D;    typeof getContainer &#x3D;&#x3D;&#x3D; &quot;function&quot; ? getContainer() : getContainer;  &#x2F;&#x2F; æŒ‰ç…§è¿™ä¸ªé»˜è®¤åº”è¯¥æŒ‚åœ¨åˆ°bodyä¸Šï¼Œæˆ‘åœ¨IOSä¸Šå‘ç°å¹¶ä¸æ˜¯è¿™æ ·ï¼Œæµè§ˆå™¨å’Œå®‰å“æ²¡é—®é¢˜  &#x2F;&#x2F; nextjs IOSæœ‰å…¼å®¹é—®é¢˜  return container || document.body;&#125;</code></pre><h2 id="renderToBody"><a href="#renderToBody" class="headerlink" title="renderToBody"></a>renderToBody</h2><p><a href="https://github.com/ant-design/ant-design-mobile/blob/3d8d66b54e1ebadccfa17dc80208cceeeeac1555/src/utils/render-to-body.ts#L1" target="_blank" >è§</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; ReactElement &#125; from &quot;react&quot;;import &#123; render, unmount as reactUnmount &#125; from &quot;.&#x2F;render&quot;;export function renderToBody(element: ReactElement) &#123;  const container &#x3D; document.createElement(&quot;div&quot;);  document.body.appendChild(container); &#x2F;&#x2F; æŒ‚åœ¨åˆ°bodyåº•éƒ¨  function unmount() &#123;    const unmountResult &#x3D; reactUnmount(container);    if (unmountResult &amp;&amp; container.parentNode) &#123;      container.parentNode.removeChild(container);    &#125;  &#125;  render(element, container);  return unmount;&#125;</code></pre><p><a href="https://github.com/ant-design/ant-design-mobile/blob/3d8d66b54e1ebadccfa17dc80208cceeeeac1555/src/utils/render.ts#L71" target="_blank" >è§ Unmount</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Render &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x2F;&#x2F; æœ‰ç‚¹æ²¡çœ‹æ‡‚&#x2F;&#x2F; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Unmount &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;function legacyUnmount(container: ContainerType) &#123;  return unmountComponentAtNode(container);&#125;async function concurrentUnmount(container: ContainerType) &#123;  &#x2F;&#x2F; Delay to unmount to avoid React 18 sync warning  return Promise.resolve().then(() &#x3D;&gt; &#123;    container[MARK]?.unmount();    delete container[MARK];  &#125;);&#125;export function unmount(container: ContainerType) &#123;  if (createRoot as unknown) &#123;    return concurrentUnmount(container);  &#125;  return legacyUnmount(container); &#x2F;&#x2F; æœåŠ¡ç«¯æ¸²æŸ“å¤„ç†&#125;</code></pre><p>renderToBody ä¸»è¦ç”¨äºï¼š <a href="https://github.com/ant-design/ant-design-mobile/search?q=renderToBody" target="_blank" >è§</a>, unmount æˆ‘çŒœåº”è¯¥æ˜¯ä¸ºäº†å…³é—­æ—¶å€™å¸è½½ç»„ä»¶</p><h2 id="å®¢æˆ·ç«¯æ¸²æŸ“åˆ¤æ–­"><a href="#å®¢æˆ·ç«¯æ¸²æŸ“åˆ¤æ–­" class="headerlink" title="å®¢æˆ·ç«¯æ¸²æŸ“åˆ¤æ–­"></a>å®¢æˆ·ç«¯æ¸²æŸ“åˆ¤æ–­</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export const canUseDom &#x3D; !!(  typeof window !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;  typeof document !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;  window.document &amp;&amp;  window.document.createElement);</code></pre><h2 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h2><p><a href="https://github.com/ant-design/ant-design-mobile/blob/3d8d66b54e1ebadccfa17dc80208cceeeeac1555/src/utils/sleep.ts#L1" target="_blank" >è§</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export const sleep &#x3D; (time: number) &#x3D;&gt;  new Promise((resolve) &#x3D;&gt; setTimeout(resolve, time))&#96;&#96;;</code></pre><h2 id="Space"><a href="#Space" class="headerlink" title="Space"></a>Space</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; mergePropsimport assignWith from &quot;lodash&#x2F;assignWith&quot;;export function mergeProps&lt;A, B&gt;(a: A, b: B): B &amp; A;export function mergeProps&lt;A, B, C&gt;(a: A, b: B, c: C): C &amp; B &amp; A;export function mergeProps(...items: any[]) &#123;  function customizer(objValue: any, srcValue: any) &#123;    return srcValue &#x3D;&#x3D;&#x3D; undefined ? objValue : srcValue;  &#125;  let ret &#x3D; &#123; ...items[0] &#125;;  for (let i &#x3D; 1; i &lt; items.length; i++) &#123;    ret &#x3D; assignWith(ret, items[i], customizer);  &#125;  return ret;&#125;</code></pre><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import React, &#123; FC &#125; from &quot;react&quot;;import classNames from &quot;classnames&quot;;import &#123; NativeProps, withNativeProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;native-props&quot;;import &#123; mergeProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;with-default-props&quot;;const classPrefix &#x3D; &#96;adm-space&#96;;export type SpaceProps &#x3D; &#123;  direction?: &quot;horizontal&quot; | &quot;vertical&quot;;  align?: &quot;start&quot; | &quot;end&quot; | &quot;center&quot; | &quot;baseline&quot;;  justify?:    | &quot;start&quot;    | &quot;end&quot;    | &quot;center&quot;    | &quot;between&quot;    | &quot;around&quot;    | &quot;evenly&quot;    | &quot;stretch&quot;;  wrap?: boolean;  block?: boolean;  onClick?: (event: React.MouseEvent&lt;HTMLDivElement, MouseEvent&gt;) &#x3D;&gt; void;  children?: React.ReactNode;&#125; &amp; NativeProps&lt;&quot;--gap&quot; | &quot;--gap-vertical&quot; | &quot;--gap-horizontal&quot;&gt;;const defaultProps &#x3D; &#123;  direction: &quot;horizontal&quot;,&#125;;export const Space: FC&lt;SpaceProps&gt; &#x3D; (p) &#x3D;&gt; &#123;  const props &#x3D; mergeProps(defaultProps, p);  const &#123; direction, onClick &#125; &#x3D; props;  return withNativeProps(    props,    &lt;div      className&#x3D;&#123;classNames(classPrefix, &#123;        [&#96;$&#123;classPrefix&#125;-wrap&#96;]: props.wrap,        [&#96;$&#123;classPrefix&#125;-block&#96;]: props.block,        [&#96;$&#123;classPrefix&#125;-$&#123;direction&#125;&#96;]: true,        [&#96;$&#123;classPrefix&#125;-align-$&#123;props.align&#125;&#96;]: !!props.align,        [&#96;$&#123;classPrefix&#125;-justify-$&#123;props.justify&#125;&#96;]: !!props.justify,      &#125;)&#125;      onClick&#x3D;&#123;onClick&#125;    &gt;      &#123;React.Children.map(props.children, (child) &#x3D;&gt; &#123;        return (          child !&#x3D;&#x3D; null &amp;&amp;          child !&#x3D;&#x3D; undefined &amp;&amp; (            &lt;div className&#x3D;&#123;&#96;$&#123;classPrefix&#125;-item&#96;&#125;&gt;&#123;child&#125;&lt;&#x2F;div&gt; &#x2F;&#x2F; è¿™é‡Œç”±ä¸‹é¢æ ·å¼ï¼Œä½¿ç”¨margin-right &#x2F; margin-bottom å®ç°é—´éš”          )        );      &#125;)&#125;    &lt;&#x2F;div&gt;  );&#125;;</code></pre><p><a href="https://github.com/ant-design/ant-design-mobile/blob/7c00eee09077d7805161b249ced34852db44c53b/src/components/space/space.less#L1" target="_blank" >è§</a></p><pre class="line-numbers language-less" data-language="less"><code class="language-less">&#x2F;&#x2F; space.less@class-prefix-space: ~&quot;adm-space&quot;;.@&#123;class-prefix-space&#125;-item &#123;  flex: none;&#125;.@&#123;class-prefix-space&#125; &#123;  display: inline-flex;  --gap: 8px;  --gap-vertical: var(--gap);  --gap-horizontal: var(--gap);  &amp;-vertical &#123;    flex-direction: column;    &gt; .@&#123;class-prefix-space&#125;-item &#123;      margin-bottom: var(--gap-vertical);      &amp;:last-child &#123;        margin-bottom: 0;      &#125;    &#125;  &#125;  &amp;-horizontal &#123;    flex-direction: row;    &gt; .@&#123;class-prefix-space&#125;-item &#123;      margin-right: var(--gap-horizontal);      &amp;:last-child &#123;        margin-right: 0;      &#125;    &#125;    &amp;.@&#123;class-prefix-space&#125;-wrap &#123;      flex-wrap: wrap;      margin-bottom: calc(var(--gap-vertical) * -1);      &gt; .@&#123;class-prefix-space&#125;-item &#123;        padding-bottom: var(--gap-vertical);      &#125;    &#125;  &#125;  &amp;.@&#123;class-prefix-space&#125;-block &#123;    display: flex;  &#125;  &amp;-align &#123;    &amp;-center &#123;      align-items: center;    &#125;    &amp;-start &#123;      align-items: flex-start;    &#125;    &amp;-end &#123;      align-items: flex-end;    &#125;    &amp;-baseline &#123;      align-items: baseline;    &#125;  &#125;  &amp;-justify &#123;    &amp;-center &#123;      justify-content: center;    &#125;    &amp;-start &#123;      justify-content: flex-start;    &#125;    &amp;-end &#123;      justify-content: flex-end;    &#125;    &amp;-between &#123;      justify-content: space-between;    &#125;    &amp;-around &#123;      justify-content: space-around;    &#125;    &amp;-evenly &#123;      justify-content: space-evenly;    &#125;    &amp;-stretch &#123;      justify-content: stretch;    &#125;  &#125;&#125;</code></pre><h2 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h2><img src="http://t-blog-images.aijs.top/img/202208211218118.png" /><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import &#123; mergeProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;with-default-props&quot;;import React, &#123; ReactNode, useState, useRef &#125; from &quot;react&quot;;import &#123; NativeProps, withNativeProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;native-props&quot;;import &#123; PictureOutline, PictureWrongOutline &#125; from &quot;antd-mobile-icons&quot;;import &#123; useInViewport &#125; from &quot;ahooks&quot;;import &#123; useInitialized &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;use-initialized&quot;;import &#123; staged &#125; from &quot;staged-components&quot;;import &#123; toCSSLength &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;to-css-length&quot;;const classPrefix &#x3D; &#96;adm-image&#96;;export type ImageProps &#x3D; &#123;  src: string;  alt?: string;  width?: number | string;  height?: number | string;  fit?: &quot;contain&quot; | &quot;cover&quot; | &quot;fill&quot; | &quot;none&quot; | &quot;scale-down&quot;;  placeholder?: ReactNode;  fallback?: ReactNode;  lazy?: boolean;  onClick?: (event: React.MouseEvent&lt;HTMLImageElement, Event&gt;) &#x3D;&gt; void;  onError?: (event: React.SyntheticEvent&lt;HTMLImageElement, Event&gt;) &#x3D;&gt; void;&#125; &amp; NativeProps&lt;&quot;--width&quot; | &quot;--height&quot;&gt; &amp;  Pick&lt;    React.ImgHTMLAttributes&lt;HTMLImageElement&gt;,    | &quot;crossOrigin&quot;    | &quot;decoding&quot;    | &quot;loading&quot;    | &quot;referrerPolicy&quot;    | &quot;sizes&quot;    | &quot;srcSet&quot;    | &quot;useMap&quot;  &gt;;const defaultProps &#x3D; &#123;  fit: &quot;fill&quot;,  placeholder: (    &lt;div className&#x3D;&#123;&#96;$&#123;classPrefix&#125;-tip&#96;&#125;&gt;      &lt;PictureOutline &#x2F;&gt;    &lt;&#x2F;div&gt;  ),  fallback: (    &lt;div className&#x3D;&#123;&#96;$&#123;classPrefix&#125;-tip&#96;&#125;&gt;      &lt;PictureWrongOutline &#x2F;&gt;    &lt;&#x2F;div&gt;  ),  lazy: false,&#125;;export const Image &#x3D; staged&lt;ImageProps&gt;((p) &#x3D;&gt; &#123;  const props &#x3D; mergeProps(defaultProps, p); &#x2F;&#x2F; å±æ€§åˆå¹¶  const [loaded, setLoaded] &#x3D; useState(false);  const [failed, setFailed] &#x3D; useState(false);  const ref &#x3D; useRef&lt;HTMLDivElement&gt;(null);  let src: string | undefined &#x3D; props.src;  let srcSet: string | undefined &#x3D; props.srcSet;  &#x2F;&#x2F; éæ‡’åŠ è½½  if (!props.lazy) &#123;    return render();  &#125;  &#x2F;&#x2F; æ‡’åŠ è½½  return () &#x3D;&gt; &#123;    const inViewport &#x3D; useInViewport(ref); &#x2F;&#x2F; å½“å‡ºç°åœ¨è§†å£ä¸­æ—¶ï¼Œå°†    const initialized &#x3D; useInitialized(inViewport); &#x2F;&#x2F; inViewportä¸ºtrueæ—¶å€™è¿›è¡Œåˆå§‹åŒ–    &#x2F;&#x2F; useInitialized æºç     &#x2F;&#x2F; import &#123; useRef &#125; from &#39;react&#39;    &#x2F;&#x2F; export function useInitialized(check?: boolean) &#123; &#x2F;&#x2F; checkä¸ºtrueçš„æ—¶å€™æ‰§è¡Œåˆå§‹åŒ–    &#x2F;&#x2F;   const initializedRef &#x3D; useRef(check)    &#x2F;&#x2F;   if (check) &#123;    &#x2F;&#x2F;     initializedRef.current &#x3D; true    &#x2F;&#x2F;   &#125;    &#x2F;&#x2F;   return !!initializedRef.current    &#x2F;&#x2F; &#125;    &#x2F;&#x2F; åˆå§‹åŒ–æ—¶å€™ï¼Œè®¾ç½®çœŸå®srcã€srcSet    src &#x3D; initialized ? props.src : undefined;    srcSet &#x3D; initialized ? props.srcSet : undefined;    return render();  &#125;;  function renderInner() &#123;    if (failed) &#123;      return props.fallback;    &#125;    return (      &lt;&gt;        &#x2F;&#x2F; æœªåŠ è½½å®Œæˆçš„æƒ…å†µï¼Œå±•ç¤ºplaceholder        &#123;!loaded &amp;&amp; props.placeholder&#125;        &lt;img          className&#x3D;&#123;&#96;$&#123;classPrefix&#125;-img&#96;&#125;          src&#x3D;&#123;src&#125;          alt&#x3D;&#123;props.alt&#125;          onClick&#x3D;&#123;props.onClick&#125;          onLoad&#x3D;&#123;() &#x3D;&gt; &#123;            setLoaded(true);          &#125;&#125;          onError&#x3D;&#123;(e) &#x3D;&gt; &#123;            setFailed(true);            props.onError?.(e);          &#125;&#125;          style&#x3D;&#123;&#123;            objectFit: props.fit,            display: loaded ? &quot;block&quot; : &quot;none&quot;,          &#125;&#125;          crossOrigin&#x3D;&#123;props.crossOrigin&#125; &#x2F;&#x2F; è·¨åŸŸ          decoding&#x3D;&#123;props.decoding&#125;          loading&#x3D;&#123;props.loading&#125;          referrerPolicy&#x3D;&#123;props.referrerPolicy&#125;          sizes&#x3D;&#123;props.sizes&#125;          srcSet&#x3D;&#123;srcSet&#125;          useMap&#x3D;&#123;props.useMap&#125; &#x2F;&#x2F; ????        &#x2F;&gt;      &lt;&#x2F;&gt;    );  &#125;  function render() &#123;    const style: ImageProps[&quot;style&quot;] &#x3D; &#123;&#125;;    if (props.width) &#123;      style[&quot;--width&quot;] &#x3D; toCSSLength(props.width);    &#125;    if (props.height) &#123;      style[&quot;--height&quot;] &#x3D; toCSSLength(props.height);    &#125;    return withNativeProps(      &#x2F;&#x2F; ç»„ä»¶å¢åŠ å±æ€§      props,      &lt;div ref&#x3D;&#123;ref&#125; className&#x3D;&#123;classPrefix&#125; style&#x3D;&#123;style&#125;&gt;        &#123;renderInner()&#125;      &lt;&#x2F;div&gt;    );  &#125;&#125;);</code></pre><p><a href="https://github.com/ant-design/ant-design-mobile/blob/7c00eee09077d7805161b249ced34852db44c53b/src/utils/native-props.ts#L10" target="_blank" >è§ withNativeProps</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; toCSSLength, åªæ˜¯ä¸ºäº†å¢åŠ  px å•ä½export function toCSSLength(val: string | number) &#123;  return typeof val &#x3D;&#x3D;&#x3D; &quot;number&quot; ? &#96;$&#123;val&#125;px&#96; : val;&#125;</code></pre><h2 id="Floating-panel"><a href="#Floating-panel" class="headerlink" title="Floating-panel"></a>Floating-panel</h2><img src="http://t-blog-images.aijs.top/img/202208211339119.png" /><p><a href="https://github.com/ant-design/ant-design-mobile/blob/7c00eee09077d7805161b249ced34852db44c53b/src/components/floating-panel/floating-panel.tsx#L118" target="_blank" >æºç </a></p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import React, &#123;  forwardRef,  ReactNode,  useImperativeHandle,  useRef,  useState,&#125; from &quot;react&quot;;import &#123; NativeProps, withNativeProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;native-props&quot;;import &#123; useDrag &#125; from &quot;@use-gesture&#x2F;react&quot;;&#x2F;&#x2F;@link: https:&#x2F;&#x2F;github.com&#x2F;pmndrs&#x2F;react-springimport &#123; useSpring, animated &#125; from &quot;@react-spring&#x2F;web&quot;;import &#123; supportsPassive &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;supports-passive&quot;;import &#123; nearest &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;nearest&quot;;export type FloatingPanelProps &#x3D; &#123;  anchors: number[];  children: ReactNode;&#125; &amp; NativeProps&lt;&quot;--border-radius&quot; | &quot;--z-index&quot;&gt;;export type FloatingPanelRef &#x3D; &#123;  setHeight: (    height: number,    options?: &#123;      immediate?: boolean;    &#125;  ) &#x3D;&gt; void;&#125;;export const FloatingPanel &#x3D; forwardRef&lt;FloatingPanelRef, FloatingPanelProps&gt;(  (props, ref) &#x3D;&gt; &#123;    const &#123; anchors &#125; &#x3D; props;    &#x2F;&#x2F;@link: https:&#x2F;&#x2F;mobile.ant.design&#x2F;zh&#x2F;components&#x2F;floating-panel#floatingpanel    &#x2F;*è¿™é‡Œå–æœ€åä¸€ä¸ªä¸ºæœ€å¤§é«˜åº¦ï¼Œ[300,50,200],å–çš„æ˜¯200,ğŸ˜“ï¼Œæ–‡æ¡£æ²¡è¯´å•Š *&#x2F;    const maxHeight &#x3D; anchors[anchors.length - 1] ?? window.innerHeight;    const possibles &#x3D; anchors.map((x) &#x3D;&gt; -x); &#x2F;&#x2F; é¡¶éƒ¨æ˜¯è´Ÿå€¼    const elementRef &#x3D; useRef&lt;HTMLDivElement&gt;(null);    const headerRef &#x3D; useRef&lt;HTMLDivElement&gt;(null);    const contentRef &#x3D; useRef&lt;HTMLDivElement&gt;(null);    const [pulling, setPulling] &#x3D; useState(false);    const pullingRef &#x3D; useRef(false);    const bounds &#x3D; &#123;      top: possibles[possibles.length - 1], &#x2F;&#x2F; é¡¶éƒ¨æ˜¯è´Ÿå€¼      bottom: possibles[0], &#x2F;&#x2F; åº•éƒ¨å–0ï¼Œ 0ä½ä¸ä¸€å®šæ˜¯æœ€å°çš„ğŸ˜“    &#125;;    const [&#123; y &#125;, api] &#x3D; useSpring(() &#x3D;&gt; (&#123;      &#x2F;&#x2F; useSpring      y: bounds.bottom,      config: &#123; tension: 300 &#125;,    &#125;));    useDrag(      (state) &#x3D;&gt; &#123;        const [, offsetY] &#x3D; state.offset;        if (state.first) &#123;          const target &#x3D; state.event.target as Element;          const header &#x3D; headerRef.current;          if (header &#x3D;&#x3D;&#x3D; target || header?.contains(target)) &#123;            pullingRef.current &#x3D; true;          &#125; else &#123;            const reachedTop &#x3D; y.goal &lt;&#x3D; bounds.top;            const content &#x3D; contentRef.current;            if (!content) return;            if (reachedTop) &#123;              if (content.scrollTop &lt;&#x3D; 0 &amp;&amp; state.direction[1] &gt; 0) &#123;                pullingRef.current &#x3D; true;              &#125;            &#125; else &#123;              pullingRef.current &#x3D; true;            &#125;          &#125;        &#125;        setPulling(pullingRef.current);        if (!pullingRef.current) return;        const &#123; event &#125; &#x3D; state;        if (event.cancelable) &#123;          event.preventDefault();        &#125;        event.stopPropagation();        let nextY &#x3D; offsetY;        if (state.last) &#123;          pullingRef.current &#x3D; false;          setPulling(false);          nextY &#x3D; nearest(possibles, offsetY);        &#125;        api.start(&#123;          y: nextY,        &#125;);      &#125;,      &#123;        axis: &quot;y&quot;,        bounds,        rubberband: true,        from: () &#x3D;&gt; [0, y.get()],        pointer: &#123; touch: true &#125;,        target: elementRef,        eventOptions: supportsPassive ? &#123; passive: false &#125; : false,      &#125;    );    useImperativeHandle(      ref,      () &#x3D;&gt; (&#123;        setHeight: (          height: number,          options?: &#123;            immediate?: boolean;          &#125;        ) &#x3D;&gt; &#123;          api.start(&#123;            y: -height,            immediate: options?.immediate,          &#125;);        &#125;,      &#125;),      [api]    );    return withNativeProps(      props,      &lt;animated.div        ref&#x3D;&#123;elementRef&#125;        className&#x3D;&quot;adm-floating-panel&quot;        style&#x3D;&#123;&#123;          height: maxHeight,          y,        &#125;&#125;      &gt;        &#x2F;&#x2F; é®ç…§ï¼Œ æ€ä¹ˆæ²¡çœ‹åˆ°æ•ˆæœå‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ        &lt;div          className&#x3D;&quot;adm-floating-panel-mask&quot;          style&#x3D;&#123;&#123;            display: pulling ? &quot;block&quot; : &quot;none&quot;,          &#125;&#125;        &#x2F;&gt;        &#x2F;&#x2F; barå†…å®¹        &lt;div className&#x3D;&quot;adm-floating-panel-header&quot; ref&#x3D;&#123;headerRef&#125;&gt;          &lt;div className&#x3D;&quot;adm-floating-panel-bar&quot; &#x2F;&gt;        &lt;&#x2F;div&gt;        &lt;div className&#x3D;&quot;adm-floating-panel-content&quot; ref&#x3D;&#123;contentRef&#125;&gt;          &#123;props.children&#125;        &lt;&#x2F;div&gt;      &lt;&#x2F;animated.div&gt;    );  &#125;);</code></pre><p><a href="https://github.com/ant-design/ant-design-mobile/blob/7c00eee09077d7805161b249ced34852db44c53b/src/components/floating-panel/floating-panel.tsx#L100" target="_blank" >useImperativeHandle</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æ­£å¸¸æƒ…å†µä¸‹ ref æ˜¯ä¸èƒ½æŒ‚åœ¨åˆ°å‡½æ•°ç»„ä»¶ä¸Šçš„ï¼Œå› ä¸ºå‡½æ•°ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œä½†æ˜¯ useImperativeHandle ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç±»ä¼¼å®ä¾‹çš„ä¸œè¥¿ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬é€šè¿‡ useImperativeHandle çš„ç¬¬ 2 ä¸ªå‚æ•°ï¼Œæ‰€è¿”å›çš„å¯¹è±¡çš„å†…å®¹æŒ‚è½½åˆ° çˆ¶ç»„ä»¶çš„ ref.current ä¸Šã€‚</p><p>forwardRef ä¼šåˆ›å»ºä¸€ä¸ª React ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶èƒ½å¤Ÿå°†å…¶æ¥å—çš„ ref å±æ€§è½¬å‘åˆ°å…¶ç»„ä»¶æ ‘ä¸‹çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­ã€‚</p><p>ä½œè€…ï¼šæœºæ™ºçš„ç‹®è€å¸ˆ<br>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/bf9f66ac3f9c">https://www.jianshu.com/p/bf9f66ac3f9c</a><br>æ¥æºï¼šç®€ä¹¦<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import React, &#123;  forwardRef,  useImperativeHandle,  useEffect,  useRef,&#125; from &quot;react&quot;;const TestRef &#x3D; forwardRef((props, ref) &#x3D;&gt; &#123;  useImperativeHandle(ref, () &#x3D;&gt; (&#123;    open() &#123;      console.log(&quot;open&quot;);    &#125;,  &#125;));&#125;);function App() &#123;  const ref &#x3D; useRef();  useEffect(() &#x3D;&gt; &#123;    ref.current.open();  &#125;, []);  return (    &lt;&gt;      &lt;div&gt;çŸ³å°é˜³&lt;&#x2F;div&gt;      &lt;TestRef ref&#x3D;&#123;ref&#125;&gt;&lt;&#x2F;TestRef&gt;    &lt;&#x2F;&gt;  );&#125;export default App;</code></pre><p>å¦ä¸€ç§å®ç°ï¼šå¯ä»¥ä½¿ç”¨ hooks æŠŠå­ç»„ä»¶æ•°æ®ç»‘å®šåˆ°ä¸€ä¸ª ref ä¸Šï¼ˆè¿™ä¸ª ref æ˜¯çˆ¶ç»„ä»¶ä¼ å…¥çš„ï¼‰å¦‚ä¸‹ï¼š</p><p><strong>å­ç»„ä»¶</strong></p><img src="http://t-blog-images.aijs.top/img/202208211349068.png" /><p><strong>çˆ¶ç»„ä»¶</strong></p><img src="http://t-blog-images.aijs.top/img/202208211351388.png" /><img src="http://t-blog-images.aijs.top/img/202208211351568.png" /><p>å¯è§ <code>useImperativeHandle</code>æ–¹å¼æ›´ä¼˜é›…</p><h2 id="tabs-ä¸-å†…å®¹è”åŠ¨"><a href="#tabs-ä¸-å†…å®¹è”åŠ¨" class="headerlink" title="tabs ä¸ å†…å®¹è”åŠ¨"></a>tabs ä¸ å†…å®¹è”åŠ¨</h2><img src="http://t-blog-images.aijs.top/img/202208211737240.gif" /><p><a href="https://mobile.ant.design/zh/components/tabs" target="_blank" >è§</a></p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import React, &#123; useEffect, useState &#125; from &quot;react&quot;;import &#123; Tabs &#125; from &quot;antd-mobile&quot;;import &#123; DemoBlock, lorem &#125; from &quot;demos&quot;;import styles from &quot;.&#x2F;demo4.less&quot;;import &#123; useThrottleFn &#125; from &quot;ahooks&quot;;const tabItems &#x3D; [  &#123; key: &quot;1&quot;, title: &quot;ç¬¬ä¸€é¡¹&quot;, text: lorem.generateParagraphs(8) &#125;,  &#123; key: &quot;2&quot;, title: &quot;ç¬¬äºŒé¡¹&quot;, text: lorem.generateParagraphs(8) &#125;,  &#123; key: &quot;3&quot;, title: &quot;ç¬¬ä¸‰é¡¹&quot;, text: lorem.generateParagraphs(8) &#125;,  &#123; key: &quot;4&quot;, title: &quot;ç¬¬å››é¡¹&quot;, text: lorem.generateParagraphs(8) &#125;,];const tabHeight &#x3D; 42;export default () &#x3D;&gt; &#123;  const [activeKey, setActiveKey] &#x3D; useState(&quot;1&quot;);  const &#123; run: handleScroll &#125; &#x3D; useThrottleFn(    () &#x3D;&gt; &#123;      let currentKey &#x3D; tabItems[0].key;      for (const item of tabItems) &#123;        const element &#x3D; document.getElementById(&#96;anchor-$&#123;item.key&#125;&#96;);        if (!element) continue;        const rect &#x3D; element.getBoundingClientRect();        if (rect.top &lt;&#x3D; tabHeight) &#123;          &#x2F;&#x2F; é€šè¿‡æ»šåŠ¨è®¾ç½®key          currentKey &#x3D; item.key;        &#125; else &#123;          break;        &#125;      &#125;      setActiveKey(currentKey);    &#125;,    &#123;      leading: true,      trailing: true,      wait: 100,    &#125;  );  useEffect(() &#x3D;&gt; &#123;    window.addEventListener(&quot;scroll&quot;, handleScroll);    return () &#x3D;&gt; &#123;      window.removeEventListener(&quot;scroll&quot;, handleScroll);    &#125;;  &#125;, []);  return (    &lt;&gt;      &lt;DemoBlock title&#x3D;&quot;ä½œä¸ºé¡µé¢æ»šåŠ¨çš„å¯¼èˆª&quot; padding&#x3D;&quot;0&quot;&gt;        &lt;div className&#x3D;&#123;styles.tabsContainer&#125;&gt;          &lt;Tabs            activeKey&#x3D;&#123;activeKey&#125; &#x2F;&#x2F; æ»šåŠ¨æ—¶å€™è®¾ç½® activeKey            onChange&#x3D;&#123;(key) &#x3D;&gt; &#123;              document.getElementById(&#96;anchor-$&#123;key&#125;&#96;)?.scrollIntoView(); &#x2F;&#x2F; æ»šåŠ¨åˆ°è§†å£              window.scrollTo(&#123;                &#x2F;&#x2F; ç‚¹å‡»æ—¶å€™æ»šåŠ¨çš„ä½ç½®                top: window.scrollY - tabHeight,              &#125;);            &#125;&#125;          &gt;            &#123;tabItems.map((item) &#x3D;&gt; (              &lt;Tabs.Tab title&#x3D;&#123;item.title&#125; key&#x3D;&#123;item.key&#125; &#x2F;&gt;            ))&#125;          &lt;&#x2F;Tabs&gt;        &lt;&#x2F;div&gt;        &lt;div className&#x3D;&#123;styles.content&#125;&gt;          &#123;tabItems.map((item) &#x3D;&gt; (            &lt;div key&#x3D;&#123;item.key&#125;&gt;              &#x2F;&#x2F; è¿™é‡Œè®¾ç½®id              &lt;h2 id&#x3D;&#123;&#96;anchor-$&#123;item.key&#125;&#96;&#125;&gt;&#123;item.title&#125;&lt;&#x2F;h2&gt;              &#123;item.text&#125;            &lt;&#x2F;div&gt;          ))&#125;        &lt;&#x2F;div&gt;      &lt;&#x2F;DemoBlock&gt;    &lt;&#x2F;&gt;  );&#125;;</code></pre><p><a href="https://github.com/ant-design/ant-design-mobile/blob/7c00eee09077d7805161b249ced34852db44c53b/src/components/tabs/index.ts#L7" target="_blank" >è§</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &quot;.&#x2F;tabs.less&quot;;import &#123; TabPane, Tabs &#125; from &quot;.&#x2F;tabs&quot;;import &#123; attachPropertiesToComponent &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;attach-properties-to-component&quot;;export type &#123; TabsProps, TabPaneProps &#125; from &quot;.&#x2F;tabs&quot;;export default attachPropertiesToComponent(Tabs, &#123;  &#x2F;&#x2F; ä¹‹åå¯ä»¥ä½¿ç”¨ Tabs.TabPaneæç¤º  TabPane,&#125;);</code></pre><h2 id="badge-çœ‹ä¸ªç®€å•çš„æ”¾æ¾ä¸‹"><a href="#badge-çœ‹ä¸ªç®€å•çš„æ”¾æ¾ä¸‹" class="headerlink" title="badge çœ‹ä¸ªç®€å•çš„æ”¾æ¾ä¸‹"></a>badge çœ‹ä¸ªç®€å•çš„æ”¾æ¾ä¸‹</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &quot;.&#x2F;badge.less&quot;;import &#123; Badge, dot &#125; from &quot;.&#x2F;badge&quot;;import &#123; attachPropertiesToComponent &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;attach-properties-to-component&quot;;export type &#123; BadgeProps &#125; from &quot;.&#x2F;badge&quot;;export default attachPropertiesToComponent(Badge, &#123;  dot, &#x2F;&#x2F; Badge å¢åŠ  dotå±æ€§&#125;);</code></pre><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import classNames from &quot;classnames&quot;;import React from &quot;react&quot;;import &#123; NativeProps, withNativeProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;native-props&quot;;import &#123; withDefaultProps &#125; from &quot;..&#x2F;..&#x2F;utils&#x2F;with-default-props&quot;;const classPrefix &#x3D; &#96;adm-badge&#96;;export const dot &#x3D; Symbol(); &#x2F;&#x2F; ????export type BadgeProps &#x3D; &#123;  content?: React.ReactNode | typeof dot;  color?: string;&#125; &amp; NativeProps&lt;&quot;--right&quot; | &quot;--top&quot;&gt;;export const Badge &#x3D; withDefaultProps(&#123;  color: &quot;#FF411C&quot;,&#125;)&lt;BadgeProps&gt;((props) &#x3D;&gt; &#123;  const &#123; content, color, children &#125; &#x3D; props;  const isDot &#x3D; content &#x3D;&#x3D;&#x3D; dot; &#x2F;&#x2F; åˆ¤æ–­æ˜¯ä¸æ˜¯ dot  const badgeCls &#x3D; classNames(classPrefix, &#123;    [&#96;$&#123;classPrefix&#125;-fixed&#96;]: !!children,    [&#96;$&#123;classPrefix&#125;-dot&#96;]: isDot,  &#125;);  &#x2F;&#x2F; æœ‰å†…å®¹ä¸æ˜¯dot æ¸²æŸ“å†…å®¹ï¼Œæ˜¯dot ä¸æ¸²æŸ“å†…å®¹  const element &#x3D; content    ? withNativeProps(        props,        &lt;div &#x2F;&#x2F; dot æ˜¯å…ƒç´ ï¼Œä¸æ˜¯ä¼ªå…ƒç´           className&#x3D;&#123;badgeCls&#125;          style&#x3D;&#123;&#123;            backgroundColor: color,          &#125;&#125;        &gt;          &#123;!isDot &amp;&amp; content&#125;        &lt;&#x2F;div&gt;      )    : null;  &#x2F;&#x2F; æœ‰å­èŠ‚ç‚¹ï¼Œ æ— å­èŠ‚ç‚¹ï¼Œç›´æ¥æ¸²æŸ“  return children ? (    &lt;div className&#x3D;&#123;&#96;$&#123;classPrefix&#125;-wrap&#96;&#125;&gt;      &#123;children&#125;      &#123;element&#125;    &lt;&#x2F;div&gt;  ) : (    element  );&#125;);</code></pre><pre class="line-numbers language-less" data-language="less"><code class="language-less">@class-prefix-badge: ~&quot;adm-badge&quot;;.@&#123;class-prefix-badge&#125;-wrap &#123;  display: inline-block;  position: relative;&#125;.@&#123;class-prefix-badge&#125; &#123;  display: inline-block;  color: #fff;  font-weight: normal;  text-align: center;  vertical-align: middle;  box-sizing: border-box;  min-width: 16px;  border-radius: 100px;  padding: 0 4px;  font-size: 9px;  line-height: 1.2;  white-space: nowrap;  --right: 0;  --top: 0;  &amp;-fixed &#123;    position: absolute;    right: var(--right);    top: var(--top);    transform: translate(50%, -50%);  &#125;  &amp;-dot &#123;    &#x2F;&#x2F;  å…ƒç´ dot    min-width: 10px;    width: 10px;    height: 10px;    border-radius: 5px;  &#125;&#125;</code></pre><h2 id="æš‚æ—¶æ”¾ä¸‹"><a href="#æš‚æ—¶æ”¾ä¸‹" class="headerlink" title="æš‚æ—¶æ”¾ä¸‹"></a>æš‚æ—¶æ”¾ä¸‹</h2><!-- <img src="http://t-blog-images.aijs.top/img/202208212104877.png" /> éœ€åˆ é™¤ -->]]></content>
      
      
      <categories>
          
          <category> æºç  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ts-å®æ“</title>
      <link href="//post/2022-08-20ts.html"/>
      <url>//post/2022-08-20ts.html</url>
      
        <content type="html"><![CDATA[<h2 id="å¯¹äºä¸èƒ½ç©·ä¸¾çš„å¤„ç†"><a href="#å¯¹äºä¸èƒ½ç©·ä¸¾çš„å¤„ç†" class="headerlink" title="å¯¹äºä¸èƒ½ç©·ä¸¾çš„å¤„ç†"></a>å¯¹äºä¸èƒ½ç©·ä¸¾çš„å¤„ç†</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Option &#123;  label: string;  value: any;&#125;interface EnumOption &#123;  &#x2F;** ä»·å€¼è§‚æˆç»© *&#x2F;  valuesGrade: Option[];  &#x2F;** ç»©æ•ˆæˆç»© *&#x2F;  perfLevel: Option[];  &#x2F;** æˆ·å£çŠ¶æ€ *&#x2F;  censusRegister: Option[];  [key: string]: Option[]; &#x2F;&#x2F; è¿™é‡Œ&#125;type OfferOption &#x3D; EnumOption;</code></pre><h2 id="è¿™ä¸ªè¿˜æ²¡æƒ³å¥½"><a href="#è¿™ä¸ªè¿˜æ²¡æƒ³å¥½" class="headerlink" title="è¿™ä¸ªè¿˜æ²¡æƒ³å¥½"></a>è¿™ä¸ªè¿˜æ²¡æƒ³å¥½</h2><img src="http://t-blog-images.aijs.top/img/202208201107064.webp" /><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface IMBOrgStaffContext &#123;  orgs: Org[];  setOrgs?: (orgs: Org[]) &#x3D;&gt; void;  staffs: Staff[];  setStaffs?: (staffs: Staff[]) &#x3D;&gt; void;  values: OrgStaff;  setValues?: (staffs: OrgStaff) &#x3D;&gt; void;&#125;</code></pre><img src="http://t-blog-images.aijs.top/img/202208201108809.webp" />]]></content>
      
      
      <categories>
          
          <category> ts </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒ…ç®¡ç†å·¥å…·-pnpm</title>
      <link href="//post/2022-08-19pnpm.html"/>
      <url>//post/2022-08-19pnpm.html</url>
      
        <content type="html"><![CDATA[<h2 id="pnpm"><a href="#pnpm" class="headerlink" title="pnpm"></a>pnpm</h2><!-- <img src="http://t-blog-images.aijs.top/img/202208182037738.png" /> TODO:del--><p><a href="https://pnpm.io/zh/pnpm-cli" target="_blank" >å®˜ç½‘</a></p><img src="http://t-blog-images.aijs.top/img/202208191037942.webp" /><h2 id="pnpm-å®‰è£…è·¯å¾„"><a href="#pnpm-å®‰è£…è·¯å¾„" class="headerlink" title="pnpm å®‰è£…è·¯å¾„"></a>pnpm å®‰è£…è·¯å¾„</h2><pre class="line-numbers language-none"><code class="language-none">ğŸ‘‘ ~ $ which pnpm&#x2F;usr&#x2F;local&#x2F;bin&#x2F;pnpmğŸ‘‘ ~ $ which pnpn: aliased to pnpm</code></pre><h2 id="ä½¿ç”¨è¾ƒçŸ­çš„åˆ«å"><a href="#ä½¿ç”¨è¾ƒçŸ­çš„åˆ«å" class="headerlink" title="ä½¿ç”¨è¾ƒçŸ­çš„åˆ«å"></a>ä½¿ç”¨è¾ƒçŸ­çš„åˆ«å</h2><p>pnpm å¯èƒ½å¾ˆéš¾è¾“å…¥ï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨è¾ƒçŸ­çš„åˆ«åï¼Œä¾‹å¦‚ pnã€‚ åªéœ€å°†ä¸‹é¢è¿™è¡Œæ”¾å…¥ <code>.bashrc</code>ã€ <code>.zshrc</code> æˆ– <code>config.fish</code> ä¸­ï¼š</p><pre class="line-numbers language-none"><code class="language-none">alias pn&#x3D;pnpm</code></pre><p>æˆ‘çš„<code>.zshrc</code>è·¯å¾„ï¼š<code>/Users/haotian/.zshrc</code></p><h2 id="å‘½ä»¤è¡Œ"><a href="#å‘½ä»¤è¡Œ" class="headerlink" title="å‘½ä»¤è¡Œ"></a>å‘½ä»¤è¡Œ</h2><p>æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…å„ä¸ª CLI å‘½ä»¤çš„æ–‡æ¡£ã€‚ ä»¥ä¸‹æ˜¯ç®€ä¾¿çš„ npm å‘½ä»¤ç­‰æ•ˆåˆ—è¡¨ï¼Œå¯å¸®åŠ©æ‚¨å…¥é—¨ï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm å‘½ä»¤ pnpm ç­‰æ•ˆnpm install pnpm installnpm i &lt;pkg&gt; [pnpm add &lt;pkg&gt;]npm run &lt;cmd&gt; [pnpm &lt;cmd&gt;]</code></pre>]]></content>
      
      
      <categories>
          
          <category> åŒ…ç®¡ç†å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒ…ç®¡ç†å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-es6+</title>
      <link href="//post/2022-08-17es.html"/>
      <url>//post/2022-08-17es.html</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://juejin.cn/post/6844903959283367950" target="_blank" >1.5ä¸‡å­—æ¦‚æ‹¬ES6å…¨éƒ¨ç‰¹æ€§(å·²æ›´æ–°ES2020)</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ä¸šå¾®ä¿¡- æˆæƒ</title>
      <link href="//post/2022-08-17wx-auth.html"/>
      <url>//post/2022-08-17wx-auth.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul><li>é¡¹ç›®ï¼šå·²ç»æœ‰ä¸€ä¸ªé¡¹ç›®äº†ï¼Œåˆæ•´ä¸€ä¸ªæ–°é¡¹ç›®å…±å­˜</li><li>åŸŸåï¼šä¸€çº§ç›¸åŒï¼ŒäºŒçº§åŸŸåä¸åŒ</li></ul><p><strong>å¾®ä¿¡æˆæƒå›è°ƒé™åˆ¶, å›è°ƒå¯ä¿¡åŸŸååªèƒ½é…ç½®ä¸€ä¸ª</strong></p><img src="http://t-blog-images.aijs.top/img/202208171607858.webp" /><h2 id="å˜æ›´åçš„æˆæƒæµç¨‹"><a href="#å˜æ›´åçš„æˆæƒæµç¨‹" class="headerlink" title="å˜æ›´åçš„æˆæƒæµç¨‹"></a>å˜æ›´åçš„æˆæƒæµç¨‹</h2><img src="http://t-blog-images.aijs.top/img/202208171604440.webp" /><p><a href="https://app.diagrams.net/?src=about#H841660202%2Fpic%2Fmain%2Ftask-report" target="_blank" >draw.io</a></p><h2 id="å¢åŠ è°ƒè¯•-å¼ºåˆ¶å†…ç½‘"><a href="#å¢åŠ è°ƒè¯•-å¼ºåˆ¶å†…ç½‘" class="headerlink" title="å¢åŠ è°ƒè¯• - å¼ºåˆ¶å†…ç½‘"></a>å¢åŠ è°ƒè¯• - å¼ºåˆ¶å†…ç½‘</h2><p>å¼ºåˆ¶ æœ¬åœ°&#x2F;æ—¥å¸¸&#x2F;é¢„å‘ç¯å¢ƒ èµ°å†…ç½‘ï¼Œæ–¹ä¾¿åœ¨ä¼ä¸šå¾®ä¿¡è¿›è¡Œé€‚é…</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Config ä¸ºnextjsï¼Œ è¿è¡Œæ—¶é…ç½®ä¿¡æ¯&#x2F;&#x2F; æ–¹ä¾¿ æ—¥å¸¸&#x2F;é¢„å‘ç¯å¢ƒ åˆ°ä¼ä¸šå¾®ä¿¡ä¸­è°ƒè¯•let forceInNetwork &#x3D; true;if (isServer &amp;&amp; Config.env &#x3D;&#x3D;&#x3D; &quot;pro&quot;) &#123;  &#x2F;&#x2F; çº¿ä¸Šç¯å¢ƒ + æœåŠ¡ç«¯æ¸²æŸ“ï¼Œä¸å¼ºåˆ¶èµ°å†…ç½‘  forceInNetwork &#x3D; false;&#125; else if (!isServer &amp;&amp; window.__NEXT_DATA__.runtimeConfig.env &#x3D;&#x3D;&#x3D; &quot;pro&quot;) &#123;  &#x2F;&#x2F; çº¿ä¸Šç¯å¢ƒ + å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œä¸å¼ºåˆ¶èµ°å†…ç½‘  forceInNetwork &#x3D; false;&#125;if (  !forceInNetwork &amp;&amp; &#x2F;&#x2F; éå¼ºåˆ¶å†…ç½‘ + å¾®ä¿¡ç¯å¢ƒï¼Œè¯·æ±‚å¤´è®¾ç½® x-ty-auth-type  getWechatUserAgent(    isServer ? ctx.req.headers[&quot;user-agent&quot;] : navigator.userAgent  )) &#123;  options.headers[&quot;x-ty-auth-type&quot;] &#x3D; &quot;wx&quot;;&#125;&#x2F;&#x2F; ....let apiUrl &#x3D; &quot;&quot;;&#x2F;&#x2F; éå¼ºåˆ¶å†…ç½‘ + æœåŠ¡ç«¯ + ä¼ä¸šå¾®ä¿¡ç¯å¢ƒï¼Œ èµ°ä¼ä¸šå¾®ä¿¡æˆæƒif (  !forceInNetwork &amp;&amp;  isServer &amp;&amp;  getWechatUserAgent(options.headers[&quot;user-agent&quot;])) &#123;  apiUrl &#x3D; Config.wechatAuthProviderOrigin;&#125; else &#123;  apiUrl &#x3D; Config.api;&#125;</code></pre><h2 id="å¢åŠ è°ƒè¯•-è®¾ç½®-cookie"><a href="#å¢åŠ è°ƒè¯•-è®¾ç½®-cookie" class="headerlink" title="å¢åŠ è°ƒè¯• - è®¾ç½® cookie"></a>å¢åŠ è°ƒè¯• - è®¾ç½® cookie</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import &#123; useRouter &#125; from &quot;@ty-fe&#x2F;next&#x2F;router&quot;;import &#123; usePersistFn &#125; from &quot;ahooks&quot;;import &#123; AutoCenter, Button, Card, Input, Space &#125; from &quot;antd-mobile&quot;;import React, &#123; useState &#125; from &quot;react&quot;;interface IProps &#123;&#125;const SetCookie: React.FC&lt;IProps&gt; &#x3D; (props) &#x3D;&gt; &#123;  const router &#x3D; useRouter();  const [cookie, setCookie] &#x3D; useState(    &quot;ss_pweTnTjCiU_1bVtt6GNbd4UT2B7nK87S8xCXE3t0xuqMqDmlu7mH7PoBQ_HwwCYA616QM_9d_2yUsduiNyRrXrXQWZG1TtD7ZNNI1k3XMBx-wsYq59DKsv3Bh6nnZ9zkG-NCHsSdxbHZZ-2bCQIZ-oZ9eGiXEIo&quot;  );  const handleSetCookie &#x3D; usePersistFn(() &#x3D;&gt; &#123;    document.cookie &#x3D; &quot;SSO_USER_TOKEN&quot; + &quot;&#x3D;&quot; + cookie;  &#125;);  const handleChange &#x3D; usePersistFn((v) &#x3D;&gt; &#123;    setCookie(v);  &#125;);  const handleGoMbHome &#x3D; usePersistFn(() &#x3D;&gt; &#123;    router.push(&quot;&#x2F;my&#x2F;mobile?activeTab&#x3D;1&quot;);  &#125;);  return (    &lt;Card&gt;      &lt;p&gt;è®¾ç½®cookie&lt;&#x2F;p&gt;      &lt;Input        style&#x3D;&#123;&#123; border: &quot;1px solid #000&quot; &#125;&#125;        value&#x3D;&#123;cookie&#125;        placeholder&#x3D;&quot;è¾“å…¥cookie&quot;        onChange&#x3D;&#123;handleChange&#125;      &#x2F;&gt;      &lt;br&gt;&lt;&#x2F;br&gt;      &lt;Space&gt;        &lt;Button color&#x3D;&quot;primary&quot; fill&#x3D;&quot;solid&quot; onClick&#x3D;&#123;handleSetCookie&#125;&gt;          è®¾ç½®cookie        &lt;&#x2F;Button&gt;        &lt;Button color&#x3D;&quot;primary&quot; fill&#x3D;&quot;solid&quot; onClick&#x3D;&#123;handleGoMbHome&#125;&gt;          ç§»åŠ¨ç«¯é¦–é¡µ        &lt;&#x2F;Button&gt;      &lt;&#x2F;Space&gt;    &lt;&#x2F;Card&gt;  );&#125;;export default SetCookie;</code></pre><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><h3 id="No-1"><a href="#No-1" class="headerlink" title="No.1"></a>No.1</h3><p>å¯¹äºæŸäº›éœ€è¦ä½¿ç”¨åˆ°å½“å‰ç”¨æˆ·æ•°æ®çš„é¡µé¢ï¼Œåœ¨ä½œä¸ºå…¥å£çš„æ—¶å€™éœ€è¦ç‰¹åˆ«æ³¨æ„</p><p><span style="color: red">ä¼šå‡ºç°æ‹¿ä¸åˆ°å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯çš„æƒ…å†µ</span></p><p><strong>è¿‡ç¨‹å¦‚ä¸‹</strong></p><ol><li>å¼€å§‹æ˜¯æ²¡æœ‰æˆæƒçš„</li><li>æˆæƒä¹‹åï¼Œé¡µé¢è¢«é‡å®šå‘å›åˆ°è¯¥é¡µé¢</li><li>ç”±äºå·²åŠ è½½äº†ï¼Œæœ‰ç¼“å­˜ï¼ŒæœåŠ¡ç«¯ä¸ä¼šå†èµ°ä¸€éï¼Œåœ¨æœåŠ¡ç«¯å¾€<code>redux</code>å¡æ•°æ®çš„æ—¶å€™ï¼Œä¸ä¼šå†æ¬¡è§¦å‘</li><li>å¦‚æœæœåŠ¡ç«¯æœ‰äº›æ¥å£è®¾è®¡çš„æ—¶å€™ä¸æ˜¯ä» cookie ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå‰ç«¯åœ¨ä¼ å½“å‰ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½<code>redux</code>ä¸­æ²¡æœ‰è¯¥ç”¨æˆ·ä¿¡æ¯</li></ol><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š åœ¨ä¸€äº›å…¥å£é¡µé¢ï¼Œ<code>redux</code> å–ä¸åˆ°ç”¨æˆ·ä¿¡æ¯æ—¶å€™ï¼Œå®¢æˆ·ç«¯æ¸²æŸ“æ—¶å€™å†æ¬¡è·å–ç”¨æˆ·ä¿¡æ¯</p><h3 id="No-2"><a href="#No-2" class="headerlink" title="No.2"></a>No.2</h3><p>éƒ¨åˆ†ä¼ä¸šå¾®ä¿¡ pc å®¢æˆ·ç«¯ä¸æ”¯æŒ<code>[].at()</code>æ–¹æ³•, é¿å…ä½¿ç”¨æ­¤ api çš„æ—¶å€™ï¼Œ polyfill æ˜¯è§£å†³ä¸äº†é—®é¢˜çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/at#%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5" target="_blank" >è§</a></p><p><a href="https://github.com/zloirock/core-js/blob/b61f3c334f7a3010f376eae4fc465e68232da102/packages/core-js/modules/es.array.at.js#L11" target="_blank" >code</a></p><img src="http://t-blog-images.aijs.top/img/202208250909849.webp" /><p><a href="https://v.aijs.top/post/2022-07-14js-arr#:~:text=Copy-,at,-at()%20%E6%96%B9%E6%B3%95%E6%8E%A5%E6%94%B6" target="_blank" >2022-07-14js-arr</a></p><p>ç»æµ‹è¯•å‘ç° polyfill æ— æ•ˆ, åº”è¯¥æ˜¯è¢«ä¼ä¸šå¾®ä¿¡é™åˆ¶äº†</p><img src="http://t-blog-images.aijs.top/img/202208250920994.webp" /><p>ä¼ä¸šå¾®ä¿¡é™åˆ¶äº†<code>Array</code>ï¼Œä¸ºä½•æœ‰çš„ä¼ä¸šå¾®ä¿¡å®¢æˆ·ç«¯å¯ä»¥ï¼Œæˆ‘çŒœæ˜¯ä¼ä¸šå¾®ä¿¡çš„ä¸€ä¸ª bug</p><img src="http://t-blog-images.aijs.top/img/202208250949357.webp" /><h3 id="No-3"><a href="#No-3" class="headerlink" title="No.3"></a>No.3</h3>]]></content>
      
      
      <categories>
          
          <category> ä¼ä¸šå¾®ä¿¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ä¸šå¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤‡ä»½æ’ä»¶æ’æŸ¥code helper</title>
      <link href="//post/2022-08-11vscode-plugins.html"/>
      <url>//post/2022-08-11vscode-plugins.html</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-none"><code class="language-none">codegen_anythingcodegen_mockcodegen_sinipetsCSS Module TypedCSS ModulesColor HighlightES7+ React&#x2F;Redux&#x2F;React-Native snippetsLeetCodeReact Native SnippetReact Native ToolsReact-Native&#x2F;React&#x2F;Redux snippets for es6&#x2F;es7XMLPaste JSON as CodeNested CommentsMaterial Icon ThemeAuto Rename Tagbackground-coverESLintImport CostBookmarksCode RunnerFavoritesgitignoreImageToTextGit GraphTodo TreeLive ServerES7+ React&#x2F;Redux&#x2F;React-Native snippetsPath IntellisenseSettings SyncSort JS object keysi18n Ally</code></pre><h2 id="Git-History"><a href="#Git-History" class="headerlink" title="Git History"></a>Git History</h2><p>æ’ä»¶å¼•èµ·å†…å­˜æ³„æ¼,å¯¼è‡´ code helper cpu è¶…è´Ÿè·è¿è¡Œ</p><h2 id="GitLens"><a href="#GitLens" class="headerlink" title="GitLens"></a>GitLens</h2><img src="http://t-blog-images.aijs.top/img/202208171557626.webp" /><h2 id="æ–°å­¦çš„å‡ ä¸ª"><a href="#æ–°å­¦çš„å‡ ä¸ª" class="headerlink" title="æ–°å­¦çš„å‡ ä¸ª"></a>æ–°å­¦çš„å‡ ä¸ª</h2><ul><li>Project Manager : è¿˜æ˜¯æ¯”è¾ƒéœ€è¦çš„ï¼Œç›®å‰ç»´æŠ¤ä¸Šä¸ªéƒ¨é—¨æ‰€æœ‰ä»»åŠ¡ï¼Œ<code>recent open</code>æ‰¾é¡¹ç›®ç¡®å®æœ‰ç‚¹å¤´å¤§</li><li>Template String Converter: å­—ç¬¦ä¸²è½¬å­—ç¬¦ä¸²æ¨¡ç‰ˆï¼Œ<span style="color: red">TODO: æºç ï¼šå¯ä»¥å­¦ä¹ ä¸‹è¿™ä¸ªé¡¹ç›®æ˜¯å¦‚ä½•å®ç°çš„</span></li><li>åˆå¹¶è¡Œ: è¿™ä¸ªæ˜¯vscodeå¿«æ·é”®ï¼Œä¸æ˜¯æ’ä»¶</li></ul>]]></content>
      
      
      <categories>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactä½¿ç”¨swiper</title>
      <link href="//post/2022-08-05swiper.html"/>
      <url>//post/2022-08-05swiper.html</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><pre class="line-numbers language-scss" data-language="scss"><code class="language-scss">.maskBody &#123;  display: flex;  align-items: center;  justify-content: center;  height: 100vh;  width: 100vw;&#125;.swiperItem &#123;  height: calc(100vh - 48px);  width: 100%;  display: flex;  align-items: center;  justify-content: center;  text-align: center;&#125;</code></pre><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&lt;Swiper activeSlideKey&#x3D;&#123;activeSlideKey&#125; &#123;...params&#125;&gt;  &#123;files.map((item) &#x3D;&gt; (    &lt;div key&#x3D;&#123;item.fileKey&#125; className&#x3D;&#123;styles.swiperItem&#125;&gt; &lt;!--ä¸å†™æ­¤å¤„,æ— æ³•æ»šåŠ¨--&gt;      &lt;ImageViewer url&#x3D;&#123;item.signaturedUrls&#125; &#x2F;&gt;    &lt;&#x2F;div&gt;  ))&#125;&lt;&#x2F;Swiper&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> swiper </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swiper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React hooksæ‰§è¡Œ</title>
      <link href="//post/2022-08-02-react-hooks.html"/>
      <url>//post/2022-08-02-react-hooks.html</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ul><li>hooksæ˜¯ä»€ä¹ˆï¼Ÿ</li><li>reactæ€ä¹ˆæ‰§è¡Œå‡½æ•°ç»„ä»¶</li><li>å‡½æ•°ç»„ä»¶çš„fiberæ˜¯ä»€ä¹ˆï¼Ÿ</li><li>ä¸ºä»€ä¹ˆsetStateå¯ä»¥è·å–æœ€æ–°çš„State</li><li>updateWorkInProgressHookå¦‚ä½•è·å–hooks</li><li>ä¼˜å…ˆçº§è·³è¿‡updateï¼Œreactä¸ºäº†é¿å…çŠ¶æ€ä¸¢å¤±åšçš„å¤„ç†</li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OAä¸šåŠ¡ç›¸å…³</title>
      <link href="//post/2022-08-01oa%E5%B7%A5%E5%85%B7.html"/>
      <url>//post/2022-08-01oa%E5%B7%A5%E5%85%B7.html</url>
      
        <content type="html"><![CDATA[<h2 id="slate"><a href="#slate" class="headerlink" title="slate"></a>slate</h2><img src="http://t-blog-images.aijs.top/img/202208011820703.webp" style="max-width: 100%; width: 600px"/><p><code>é’‰é’‰æ–‡æ¡£</code>ã€<code>BOSSç›´è˜æ–‡æ¡£</code>ã€<code>æˆ‘ä»¬å…¬å¸çš„wikiæ–‡æ¡£</code> éƒ½æ˜¯ä½¿ç”¨ slate å¼€å‘çš„</p><p><a href="https://www.zhihu.com/people/dingsuite/posts" target="_blank" >é’‰é’‰æ–‡æ¡£</a></p><h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><img src="http://t-blog-images.aijs.top/img/202208011817748.webp" style="max-width: 100%; width: 600px" /><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¸å»ºè®®ç›´æ¥ä½¿ç”¨ç™¾åº¦è„‘å›¾ä»“åº“è¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚</p><p>éœ€è¦è„‘å›¾å¯è§†åŒ–éœ€æ±‚çš„ï¼Œå¯ä»¥åŸºäº <a href="https://github.com/fex-team/kityminder-core" target="_blank" >kityminder-core</a> è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼›<br>éœ€è¦è„‘å›¾ç¼–è¾‘éœ€æ±‚çš„ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/fex-team/kityminder-editor" target="_blank" >kityminder-editor</a> è¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚</p></blockquote><h2 id="workflow"><a href="#workflow" class="headerlink" title="workflow"></a>workflow</h2><img src="http://t-blog-images.aijs.top/img/202208011824433.webp" style="max-width: 100%; width: 600px"/><p><a href="https://github.com/StavinLi/Workflow" target="_blank" >workflow é’‰é’‰å®¡æ‰¹æµç¨‹è®¾ç½®</a></p><h2 id="logicflow"><a href="#logicflow" class="headerlink" title="logicflow"></a>logicflow</h2><p><a href="http://logic-flow.org/" target="_blank" >logic-flow</a></p><div style="display: flex;justify-content: center;">  <img src="http://logic-flow.org/horizontal-logo.png" style="width: 200px"/></div><img src="https://dpubstatic.udache.com/static/dpubimg/e35cef10-bb7c-4662-a494-f5aac024c092.gif" /><h2 id="excalidraw"><a href="#excalidraw" class="headerlink" title="excalidraw"></a>excalidraw</h2><img src="http://t-blog-images.aijs.top/img/202207281742669.webp" style="max-width: 100%; width: 600px" /><p><a href="https://excalidraw.com/" target="_blank" >excalidraw</a></p><p><a href="https://github.com/excalidraw/excalidraw" target="_blank" >github</a></p><h2 id="tldraw"><a href="#tldraw" class="headerlink" title="tldraw"></a>tldraw</h2><img src="http://t-blog-images.aijs.top/img/202207281745647.webp" style="max-width: 100%; width: 600px" /><p><a href="https://github.com/tldraw/tldraw" target="_blank" >github</a></p><p><a href="https://www.tldraw.com/" target="_blank" >tldraw</a></p><h2 id="wfd"><a href="#wfd" class="headerlink" title="wfd"></a>wfd</h2><img src="http://t-blog-images.aijs.top/img/202207281755202.webp" style="max-width: 100%; width: 600px" /><p><a href="https://github.com/guozhaolong/wfd" target="_blank" >github</a></p><h2 id="butterfly"><a href="#butterfly" class="headerlink" title="butterfly"></a>butterfly</h2><p><a href="https://github.com/alibaba/butterfly" target="_blank" >butterfly</a></p><p><a href="https://butterfly-dag.gitee.io/butterfly-dag/demo/analysis" target="_blank" >å°è´è¶å®˜ç½‘</a></p><h2 id="ç»˜å›¾"><a href="#ç»˜å›¾" class="headerlink" title="ç»˜å›¾"></a>ç»˜å›¾</h2><p><a href="http://developer.le5le.com/tutorial/start.html" target="_blank" >le5le-com&#x2F;topology</a></p><p><a href="https://github.com/search?o=desc&q=uml&s=stars&type=Repositories" target="_blank" >github æœç´¢</a></p><h2 id="excel"><a href="#excel" class="headerlink" title="excel"></a>excel</h2>]]></content>
      
      
      <categories>
          
          <category> ä¸šåŠ¡ç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸šåŠ¡ç›¸å…³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-js ä½œç”¨åŸŸ</title>
      <link href="//post/2022-07-30js-scope.html"/>
      <url>//post/2022-07-30js-scope.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><img src="http://t-blog-images.aijs.top/img/ä½œç”¨åŸŸ.png" style="max-width: 100%; width: 600px" /><h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><p><strong>MDN:</strong></p><p><span style="color: red">åœ¨å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å€¼å’Œè¡¨è¾¾å¼åœ¨å…¶ä¸­ â€œå¯è§â€ æˆ–å¯è¢«è®¿é—®åˆ°çš„ä¸Šä¸‹æ–‡ã€‚</span> å¦‚æœä¸€ä¸ª<strong>å˜é‡æˆ–è€…å…¶ä»–è¡¨è¾¾å¼</strong>,ä¸ â€œåœ¨å½“å‰çš„ä½œç”¨åŸŸä¸­â€ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸å¯ç”¨çš„ã€‚</p><p>ä½œç”¨åŸŸä¹Ÿå¯ä»¥æ ¹æ®ä»£ç å±‚æ¬¡åˆ†å±‚ï¼Œä»¥ä¾¿å­ä½œç”¨åŸŸå¯ä»¥è®¿é—®çˆ¶ä½œç”¨åŸŸï¼Œé€šå¸¸æ˜¯æŒ‡æ²¿ç€é“¾å¼çš„ä½œç”¨åŸŸé“¾æŸ¥æ‰¾ï¼Œè€Œä¸èƒ½ä»çˆ¶ä½œç”¨åŸŸå¼•ç”¨å­ä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå¼•ç”¨ã€‚</p><p>ä½œç”¨åŸŸå¯ä»¥è§†ä¸ºä¸€å¥—è§„åˆ™ï¼Œè¿™å¥—è§„åˆ™ç”¨æ¥ç®¡ç† js å¼•æ“,å¦‚ä½•åœ¨å½“å‰ä½œç”¨åŸŸä»¥åŠåµŒå¥—çš„å­ä½œç”¨åŸŸï¼Œæ ¹æ®æ ‡è¯†ç¬¦åç§°è¿›è¡Œå˜é‡æŸ¥æ‰¾ã€‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åœ¨å‡½æ•°ä¹‹å¤–å£°æ˜çš„å˜é‡ï¼Œå«åš<code>å…¨å±€å˜é‡</code>ï¼Œå› ä¸ºå®ƒå¯è¢«å½“å‰æ–‡æ¡£ä¸­çš„ä»»ä½•å…¶ä»–ä»£ç æ‰€è®¿é—®ã€‚<br>åœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡ï¼Œå«åš<code>å±€éƒ¨å˜é‡</code>ï¼Œå› ä¸ºå®ƒåªèƒ½åœ¨å½“å‰å‡½æ•°çš„å†…éƒ¨è®¿é—®ã€‚<br>ECMAScript 6 ä¹‹å‰çš„ JavaScript æ²¡æœ‰ <code>è¯­å¥å—ä½œç”¨åŸŸ</code>ï¼›<br>es6 ä¹‹åï¼Œ<code>è¯­å¥å—ä¸­å£°æ˜çš„å˜é‡å°†æˆä¸ºè¯­å¥å—æ‰€åœ¨å‡½æ•°ï¼ˆæˆ–å…¨å±€ä½œç”¨åŸŸï¼‰çš„å±€éƒ¨å˜é‡</code>ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œå¦‚ä¸‹çš„ä»£ç å°†åœ¨æ§åˆ¶å°è¾“å‡º 5ï¼Œå› ä¸º x çš„ä½œç”¨åŸŸæ˜¯å£°æ˜äº† x çš„é‚£ä¸ªå‡½æ•°ï¼ˆæˆ–å…¨å±€èŒƒå›´ï¼‰ï¼Œè€Œä¸æ˜¯ if è¯­å¥å—ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (true) &#123;  var x &#x3D; 5;&#125;console.log(x); &#x2F;&#x2F; 5</code></pre><p>ä½¿ç”¨ ECMAScript 6 ä¸­çš„ let å£°æ˜ï¼Œä¸Šè¿°è¡Œä¸ºå°†å‘ç”Ÿå˜åŒ–ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (true) &#123;  let y &#x3D; 5;&#125;console.log(y); &#x2F;&#x2F; ReferenceError: y æ²¡æœ‰è¢«å£°æ˜</code></pre><h2 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h2><p>JavaScript åœ¨æ‰§â¾è¿‡ç¨‹ä¸­, ä¼šåˆ›é€ å¯æ‰§â¾ä¸Šä¸‹â½‚ï¼Œå¯æ‰§â¾ä¸Šä¸‹â½‚ä¸­çš„è¯æ³•ç¯å¢ƒä¸­å«æœ‰å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•â½¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¼•â½¤è·å–å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å˜é‡ã€å£°æ˜ç­‰ï¼Œè¿™äº›å¼•â½¤ä¸²è”èµ·æ¥â¼€ç›´æŒ‡å‘å…¨å±€çš„è¯æ³•ç¯å¢ƒï¼Œå› æ­¤å½¢æˆäº†<code>ä½œâ½¤åŸŸé“¾</code>ã€‚</p><h2 id="å—çº§ä½œç”¨åŸŸ"><a href="#å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å—çº§ä½œç”¨åŸŸ"></a>å—çº§ä½œç”¨åŸŸ</h2><p><code>å—è¯­å¥</code>ï¼ˆæˆ–å…¶ä»–è¯­è¨€çš„<code>å¤åˆè¯­å¥</code>ï¼‰ç”¨äºç»„åˆé›¶ä¸ªæˆ–å¤šä¸ªè¯­å¥ã€‚è¯¥å—ç”±ä¸€å¯¹å¤§æ‹¬å·ç•Œå®šï¼Œå¯ä»¥æ˜¯ labelled</p><p>å…¶ä»–è¯­è¨€ä¸­é€šå¸¸å°†è¯­å¥å—ç§°ä¸º<code>å¤åˆè¯­å¥</code>ã€‚å®ƒå…è®¸ä½ ä½¿ç”¨å¤šä¸ªè¯­å¥ï¼Œå…¶ä¸­ JavaScript åªéœ€è¦ä¸€ä¸ªè¯­å¥ã€‚å°†è¯­å¥ç»„åˆæˆå—æ˜¯ JavaScript ä¸­çš„å¸¸è§åšæ³•ã€‚ç›¸åçš„åšæ³•æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<code>ç©ºè¯­å¥(å³ ;)</code>ï¼Œä½ ä¸æä¾›ä»»ä½•è¯­å¥ï¼Œè™½ç„¶ä¸€ä¸ªæ˜¯å¿…éœ€çš„ã€‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><ul><li>1.é€šè¿‡ var å£°æ˜çš„å˜é‡æˆ–è€…éä¸¥æ ¼æ¨¡å¼ä¸‹ (non-strict mode) åˆ›å»ºçš„å‡½æ•°å£°æ˜æ²¡æœ‰å—çº§ä½œç”¨åŸŸ</li><li>2.ä½¿ç”¨ let å’Œ const å£°æ˜çš„å˜é‡æ˜¯æœ‰å—çº§ä½œç”¨åŸŸçš„</li><li>3.ä½¿ç”¨ let å£°æ˜çš„å˜é‡, åœ¨å—çº§ä½œç”¨åŸŸå†…, èƒ½å¼ºåˆ¶æ‰§è¡Œæ›´æ–°å˜é‡</li><li>4.ä½¿ç”¨ function å‡½æ•°å£°æ˜åŒæ ·è¢«é™åˆ¶åœ¨å£°æ˜ä»–çš„è¯­å¥å—å†…ï¼š</li></ul></blockquote><p><strong>1. é€šè¿‡ var å£°æ˜çš„å˜é‡æˆ–è€…éä¸¥æ ¼æ¨¡å¼ä¸‹ (non-strict mode) åˆ›å»ºçš„å‡½æ•°å£°æ˜æ²¡æœ‰å—çº§ä½œç”¨åŸŸã€‚</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var x &#x3D; 1;&#123;  var x &#x3D; 2;&#125;console.log(x); &#x2F;&#x2F; è¾“å‡º 2&#x2F;&#x2F; è¾“å‡ºç»“æœæ˜¯ 2ï¼Œå› ä¸ºå—ä¸­çš„ var xè¯­å¥ä¸å—å‰é¢çš„var xè¯­å¥ä½œç”¨åŸŸç›¸åŒã€‚åœ¨ C æˆ– Java ä¸­ï¼Œè¿™æ®µä»£ç ä¼šè¾“å‡º 1ã€‚</code></pre><p><strong>2. ä½¿ç”¨ let å’Œ const å£°æ˜çš„å˜é‡æ˜¯æœ‰å—çº§ä½œç”¨åŸŸçš„ã€‚</strong></p><p>äº‹ä¾‹ 1</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let x &#x3D; 1;&#123;  let x &#x3D; 2;&#125;console.log(x); &#x2F;&#x2F; è¾“å‡º 1&#x2F;&#x2F; x &#x3D; 2ä»…é™åœ¨å®šä¹‰å®ƒçš„å—ä¸­</code></pre><p>äº‹ä¾‹ 2</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const c &#x3D; 1;&#123;  const c &#x3D; 2;&#125;console.log(c); &#x2F;&#x2F; è¾“å‡º 1ï¼Œè€Œä¸”ä¸ä¼šæŠ¥é”™&#x2F;&#x2F; ä½äºå—èŒƒå›´ä¹‹å†…çš„ const c &#x3D; 2 å¹¶ä¸ä¼šæŠ›å‡ºSyntaxError: Identifier &#39;c&#39; has already been declaredè¿™æ ·çš„è¯­æ³•é”™è¯¯ï¼Œå› ä¸ºåœ¨å®ƒè‡ªå·±çš„å—ä¸­å®ƒå¯èƒ½æ˜¯å”¯ä¸€ä¸€ä¸ªè¢«å£°æ˜çš„å¸¸é‡ã€‚</code></pre><p><strong>3. ä½¿ç”¨ let å£°æ˜çš„å˜é‡, åœ¨å—çº§ä½œç”¨åŸŸå†…, èƒ½å¼ºåˆ¶æ‰§è¡Œæ›´æ–°å˜é‡</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a &#x3D; [];for (var i &#x3D; 0; i &lt; 10; i++) &#123;  a[i] &#x3D; function () &#123;    console.log(i);  &#125;;&#125;a[0](); &#x2F;&#x2F; 10a[1](); &#x2F;&#x2F; 10a[6](); &#x2F;&#x2F; 10&#x2F;********************&#x2F;var a &#x3D; [];for (let i &#x3D; 0; i &lt; 10; i++) &#123;  a[i] &#x3D; function () &#123;    console.log(i);  &#125;;&#125;a[0](); &#x2F;&#x2F; 0a[1](); &#x2F;&#x2F; 1a[6](); &#x2F;&#x2F; 6</code></pre><p><strong>4. ä½¿ç”¨ function å‡½æ•°å£°æ˜åŒæ ·è¢«é™åˆ¶åœ¨å£°æ˜ä»–çš„è¯­å¥å—å†…ï¼š</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">foo(&quot;outside&quot;); &#x2F;&#x2F; TypeError: foo is not a function&#123;  function foo(location) &#123;    console.log(&quot;foo is called &quot; + location);  &#125;  foo(&quot;inside&quot;); &#x2F;&#x2F; æ­£å¸¸å·¥ä½œå¹¶ä¸”æ‰“å° &#39;foo is called inside&#39;&#125;</code></pre><h2 id="å˜é‡å£°æ˜"><a href="#å˜é‡å£°æ˜" class="headerlink" title="å˜é‡å£°æ˜"></a>å˜é‡å£°æ˜</h2><p>JavaScript æœ‰ä¸‰ç§å£°æ˜æ–¹å¼ã€‚</p><ul><li>var å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œå¯é€‰åˆå§‹åŒ–ä¸€ä¸ªå€¼ã€‚</li><li>let å£°æ˜ä¸€ä¸ªå—ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡ï¼Œå¯é€‰åˆå§‹åŒ–ä¸€ä¸ªå€¼ã€‚</li><li>const å£°æ˜ä¸€ä¸ªå—ä½œç”¨åŸŸçš„åªè¯»å¸¸é‡ã€‚</li></ul><h2 id="å˜é‡æå‡"><a href="#å˜é‡æå‡" class="headerlink" title="å˜é‡æå‡"></a>å˜é‡æå‡</h2><p>å˜é‡æå‡: <strong>å¯ä»¥å…ˆä½¿ç”¨å˜é‡ç¨åå†å£°æ˜å˜é‡è€Œä¸ä¼šå¼•å‘å¼‚å¸¸</strong></p><p>JavaScript å˜é‡æ„Ÿè§‰ä¸Šæ˜¯è¢«â€œæå‡â€æˆ–ç§»åˆ°äº†å‡½æ•°æˆ–è¯­å¥çš„æœ€å‰é¢ã€‚</p><p>ä½†æ˜¯ï¼Œ<code>æå‡åçš„å˜é‡å°†è¿”å› undefined å€¼</code>ã€‚å› æ­¤åœ¨ä½¿ç”¨æˆ–å¼•ç”¨æŸä¸ªå˜é‡ä¹‹åè¿›è¡Œå£°æ˜å’Œåˆå§‹åŒ–æ“ä½œï¼Œè¿™ä¸ªè¢«æå‡çš„å˜é‡ä»å°†è¿”å› undefined å€¼ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * ä¾‹å­ 1 *&#x2F;console.log(x &#x3D;&#x3D;&#x3D; undefined); &#x2F;&#x2F; truevar x &#x3D; 3;&#x2F;** * ä¾‹å­ 2 *&#x2F;&#x2F;&#x2F; will return a value of undefinedvar myvar &#x3D; &quot;my value&quot;;(function () &#123;  console.log(myvar); &#x2F;&#x2F; undefined  var myvar &#x3D; &quot;local value&quot;;&#125;)();</code></pre><p>ä¸Šé¢çš„ä¾‹å­ï¼Œä¹Ÿå¯å†™ä½œï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * ä¾‹å­ 1 *&#x2F;var x;console.log(x &#x3D;&#x3D;&#x3D; undefined); &#x2F;&#x2F; truex &#x3D; 3;&#x2F;** * ä¾‹å­ 2 *&#x2F;var myvar &#x3D; &quot;my value&quot;;(function () &#123;  var myvar;  console.log(myvar); &#x2F;&#x2F; undefined  myvar &#x3D; &quot;local value&quot;;&#125;)();</code></pre><p>ç”±äºå­˜åœ¨å˜é‡æå‡ï¼Œä¸€ä¸ªå‡½æ•°ä¸­æ‰€æœ‰çš„ var è¯­å¥åº”å°½å¯èƒ½åœ°æ”¾åœ¨æ¥è¿‘å‡½æ•°é¡¶éƒ¨çš„åœ°æ–¹ã€‚è¿™ä¸ªä¹ æƒ¯å°†å¤§å¤§æå‡ä»£ç çš„æ¸…æ™°åº¦ã€‚</p><p>åœ¨ ECMAScript 6 ä¸­ï¼Œ<strong>let å’Œ const åŒæ ·ä¼šè¢«æå‡å˜é‡åˆ°ä»£ç å—çš„é¡¶éƒ¨</strong>, <strong>ä½†æ˜¯ä¸ä¼šè¢«èµ‹äºˆåˆå§‹å€¼</strong>ã€‚åœ¨å˜é‡å£°æ˜ä¹‹å‰å¼•ç”¨è¿™ä¸ªå˜é‡ï¼Œå°†æŠ›å‡ºå¼•ç”¨é”™è¯¯ï¼ˆReferenceErrorï¼‰ã€‚è¿™ä¸ªå˜é‡å°†ä»ä»£ç å—ä¸€å¼€å§‹çš„æ—¶å€™å°±å¤„åœ¨ä¸€ä¸ªâ€œæš‚æ—¶æ€§æ­»åŒºâ€ï¼Œç›´åˆ°è¿™ä¸ªå˜é‡è¢«å£°æ˜ä¸ºæ­¢ã€‚</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Grammar_and_Types#:~:text=%E5%9C%A8%20ECMAScript%206%20%E4%B8%AD%EF%BC%8Clet%E5%92%8Cconst%E5%90%8C%E6%A0%B7%E4%BC%9A%E8%A2%AB%E6%8F%90%E5%8D%87%E5%8F%98%E9%87%8F%E5%88%B0%E4%BB%A3%E7%A0%81%E5%9D%97%E7%9A%84%E9%A1%B6%E9%83%A8%E4%BD%86%E6%98%AF%E4%B8%8D%E4%BC%9A%E8%A2%AB%E8%B5%8B%E4%BA%88%E5%88%9D%E5%A7%8B%E5%80%BC%E3%80%82%E5%9C%A8%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E4%B9%8B%E5%89%8D%E5%BC%95%E7%94%A8%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F%EF%BC%8C%E5%B0%86%E6%8A%9B%E5%87%BA%E5%BC%95%E7%94%A8%E9%94%99%E8%AF%AF%EF%BC%88ReferenceError%EF%BC%89%E3%80%82%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F%E5%B0%86%E4%BB%8E%E4%BB%A3%E7%A0%81%E5%9D%97%E4%B8%80%E5%BC%80%E5%A7%8B%E7%9A%84%E6%97%B6%E5%80%99%E5%B0%B1%E5%A4%84%E5%9C%A8%E4%B8%80%E4%B8%AA%E2%80%9C%E6%9A%82%E6%97%B6%E6%80%A7%E6%AD%BB%E5%8C%BA%E2%80%9D%EF%BC%8C%E7%9B%B4%E5%88%B0%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F%E8%A2%AB%E5%A3%B0%E6%98%8E%E4%B8%BA%E6%AD%A2" target="_blank" >åŸæ–‡</a></p><p><code>æš‚æ—¶æ€§æ­»åŒº</code>ï¼šç¨‹åºæœªæ‰§è¡Œåˆ°å£°æ˜å¤„æ—¶,è®¿é—®è¯¥å˜é‡éƒ½ä¼šæŠ¥å¼•ç”¨é”™è¯¯</p><p>è¿™ä¸ªä¸æ˜¯å¤ªå¥½ç†è§£å•Šï¼š<strong>let const å˜é‡ä¼šæå‡ï¼Œä½†æ˜¯ä¸ä¼šè¿›è¡Œå˜é‡å£°æ˜ï¼Œå¦‚æœåœ¨å£°æ˜ä¹‹å‰å¼•ç”¨ï¼Œå°†æŠ›å‡ºé”™è¯¯;</strong></p><h2 id="å‡½æ•°æå‡"><a href="#å‡½æ•°æå‡" class="headerlink" title="å‡½æ•°æå‡"></a>å‡½æ•°æå‡</h2><p>å¯¹äºå‡½æ•°æ¥è¯´ï¼Œ<strong>åªæœ‰å‡½æ•°å£°æ˜ä¼šè¢«æå‡åˆ°é¡¶éƒ¨ï¼Œè€Œå‡½æ•°è¡¨è¾¾å¼ä¸ä¼šè¢«æå‡</strong>ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;* å‡½æ•°å£°æ˜ *&#x2F;foo(); &#x2F;&#x2F; &quot;bar&quot;function foo() &#123;  console.log(&quot;bar&quot;);&#125;&#x2F;* å‡½æ•°è¡¨è¾¾å¼ *&#x2F;baz(); &#x2F;&#x2F; ç±»å‹é”™è¯¯ï¼šbaz ä¸æ˜¯ä¸€ä¸ªå‡½æ•°var baz &#x3D; function () &#123;  console.log(&quot;bar2&quot;);&#125;;</code></pre><h2 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h2><p>å…¨å±€å˜é‡æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§ã€‚åœ¨ç½‘é¡µä¸­ï¼Œï¼ˆè¯‘æ³¨ï¼šç¼ºçœçš„ï¼‰å…¨å±€å¯¹è±¡æ˜¯ window ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç”¨å½¢å¦‚ window.variable çš„è¯­æ³•æ¥è®¾ç½®å’Œè®¿é—®å…¨å±€å˜é‡ã€‚</p><p>å› æ­¤ï¼Œä½ å¯ä»¥é€šè¿‡æŒ‡å®š window æˆ– frame çš„åå­—ï¼Œåœ¨å½“å‰ window æˆ– frame è®¿é—®å¦ä¸€ä¸ª window æˆ– frame ä¸­å£°æ˜çš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œåœ¨æ–‡æ¡£é‡Œå£°æ˜ä¸€ä¸ªå« phoneNumber çš„å˜é‡ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥åœ¨å­æ¡†æ¶é‡Œä½¿ç”¨ parent.phoneNumber çš„æ–¹å¼æ¥å¼•ç”¨å®ƒã€‚</p><h2 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h2><p>ä½ å¯ä»¥ç”¨å…³é”®å­— const åˆ›å»ºä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚å¸¸é‡æ ‡è¯†ç¬¦çš„å‘½åè§„åˆ™å’Œå˜é‡ç›¸åŒï¼šå¿…é¡»ä»¥å­—æ¯ã€ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰æˆ–ç¾å…ƒç¬¦å·ï¼ˆ$ï¼‰å¼€å¤´å¹¶å¯ä»¥åŒ…å«æœ‰å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ã€‚</p><p>const PI &#x3D; 3.14;</p><p>å¸¸é‡ä¸å¯ä»¥é€šè¿‡é‡æ–°èµ‹å€¼æ”¹å˜å…¶å€¼ï¼Œä¹Ÿä¸å¯ä»¥åœ¨ä»£ç è¿è¡Œæ—¶é‡æ–°å£°æ˜ã€‚å®ƒå¿…é¡»è¢«åˆå§‹åŒ–ä¸ºæŸä¸ªå€¼ã€‚</p><p>å¸¸é‡çš„ä½œç”¨åŸŸè§„åˆ™ä¸ let å—çº§ä½œç”¨åŸŸå˜é‡ç›¸åŒã€‚è‹¥çœç•¥ const å…³é”®å­—ï¼Œåˆ™è¯¥æ ‡è¯†ç¬¦å°†è¢«è§†ä¸ºå˜é‡ã€‚</p><p>åœ¨åŒä¸€ä½œç”¨åŸŸä¸­ï¼Œä¸èƒ½ä½¿ç”¨ä¸å˜é‡åæˆ–å‡½æ•°åç›¸åŒçš„åå­—æ¥å‘½åå¸¸é‡ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è¿™ä¼šé€ æˆé”™è¯¯function f() &#123;&#125;const f &#x3D; 5;&#x2F;&#x2F; è¿™ä¹Ÿä¼šé€ æˆé”™è¯¯function f() &#123;  const g &#x3D; 5;  var g;  &#x2F;&#x2F;è¯­å¥&#125;</code></pre><p>ç„¶è€Œï¼Œå¯¹è±¡å±æ€§è¢«èµ‹å€¼ä¸ºå¸¸é‡æ˜¯ä¸å—ä¿æŠ¤çš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„è¯­å¥æ‰§è¡Œæ—¶ä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const MY_OBJECT &#x3D; &#123; key: &quot;value&quot; &#125;;MY_OBJECT.key &#x3D; &quot;otherValue&quot;;</code></pre><p>åŒæ ·çš„ï¼Œæ•°ç»„çš„è¢«å®šä¹‰ä¸ºå¸¸é‡ä¹Ÿæ˜¯ä¸å—ä¿æŠ¤çš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„è¯­å¥æ‰§è¡Œæ—¶ä¹Ÿä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const MY_ARRAY &#x3D; [&quot;HTML&quot;, &quot;CSS&quot;];MY_ARRAY.push(&quot;JAVASCRIPT&quot;);console.log(MY_ARRAY); &#x2F;&#x2F;logs [&#39;HTML&#39;,&#39;CSS&#39;,&#39;JAVASCRIPT&#39;];</code></pre><h2 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h2><p><a href="http://v.aijs.top/post/2022-07-28js-closures" target="_blank" >å‰ç«¯åŸºç¡€-js é—­åŒ…</a></p><h2 id="äº‹ä¾‹"><a href="#äº‹ä¾‹" class="headerlink" title="äº‹ä¾‹"></a>äº‹ä¾‹</h2><h2 id="es6-ä¹‹å‰æ²¡æœ‰å—çº§ä½œç”¨åŸŸ"><a href="#es6-ä¹‹å‰æ²¡æœ‰å—çº§ä½œç”¨åŸŸ" class="headerlink" title="es6 ä¹‹å‰æ²¡æœ‰å—çº§ä½œç”¨åŸŸ"></a>es6 ä¹‹å‰æ²¡æœ‰å—çº§ä½œç”¨åŸŸ</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a &#x3D; 12;if (a &gt; 10) &#123;  var c &#x3D; a + 1;&#125;console.log(a, c);</code></pre><h3 id="æœ‰-var-å’Œ-æ— -var"><a href="#æœ‰-var-å’Œ-æ— -var" class="headerlink" title="æœ‰ var å’Œ æ—  var"></a>æœ‰ var å’Œ æ—  var</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">function fn() &#123;  var a &#x3D; (b &#x3D; 30);  console.log(a, b); &#x2F;&#x2F; 30,30&#125;fn();console.log(b); &#x2F;&#x2F; 30console.log(a); &#x2F;&#x2F; Uncaught ReferenceError: a is not defined&#x2F;&#x2F; è§£é‡Šï¼šåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå…è®¸ä¸ç”¨varå£°æ˜å˜é‡ï¼Œä¸ç”¨varå£°æ˜çš„å˜é‡ä¼šé»˜è®¤ä¸ºå…¨å±€å˜é‡ã€‚var a &#x3D; b &#x3D;30 ç­‰ä»·äºb &#x3D; 10;b &#x3D; 10; æ‰€ä»¥bæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œaæ˜¯ä¸ªå±€éƒ¨å˜é‡ã€‚</code></pre><h3 id="å˜é‡æå‡ï¼Œå‡½æ•°å£°æ˜æå‡"><a href="#å˜é‡æå‡ï¼Œå‡½æ•°å£°æ˜æå‡" class="headerlink" title="å˜é‡æå‡ï¼Œå‡½æ•°å£°æ˜æå‡"></a>å˜é‡æå‡ï¼Œå‡½æ•°å£°æ˜æå‡</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">fn1(); &#x2F;&#x2F; fn1fn2(); &#x2F;&#x2F;ç¬¬ä¸€æ¬¡fn2è°ƒç”¨  &#x2F;&#x2F; æŠ¥é”™function fn1() &#123;  console.log(&quot;fn1&quot;);&#125;var fn2 &#x3D; function () &#123;  console.log(&quot;fn2&quot;);&#125;;fn2(); &#x2F;&#x2F;ç¬¬äºŒæ¬¡fn2è°ƒç”¨&#x2F;&#x2F; è§£é‡Šï¼šç¬¬ä¸€ä¸ªä½ç½®è°ƒç”¨fn2æŠ¥é”™ï¼Œä»£ç ç»ˆæ­¢æ‰§è¡Œï¼›å¦‚æœå±è”½ç¬¬ä¸€ä¸ªä½ç½®è°ƒç”¨fn2ï¼Œåœ¨ç¬¬äºŒä¸ªä½ç½®è°ƒç”¨ï¼Œæ­£å¸¸è°ƒç”¨ï¼Œå¹¶è¾“å‡ºâ€œfn2â€ã€‚è¿™é‡Œè€ƒå¯Ÿçš„æ˜¯å˜é‡æå‡å’Œå‡½æ•°æå‡ã€‚ä¸Šè¿°ä»£ç ç­‰ä»‹äºï¼š</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; å‡½æ•°æå‡å’Œå˜é‡æå‡function fn1() &#123;  console.log(&quot;fn1&quot;);&#125;var fn2;fn1();fn2();fn2 &#x3D; function () &#123;  console.log(&quot;fn2&quot;);&#125;;fn2();</code></pre><h3 id="å‡½æ•°æå‡åœ¨å˜é‡ä¹‹å‰è¿›è¡Œ"><a href="#å‡½æ•°æå‡åœ¨å˜é‡ä¹‹å‰è¿›è¡Œ" class="headerlink" title="å‡½æ•°æå‡åœ¨å˜é‡ä¹‹å‰è¿›è¡Œ"></a>å‡½æ•°æå‡åœ¨å˜é‡ä¹‹å‰è¿›è¡Œ</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">console.log(a); &#x2F;&#x2F; f a() &#123;console.log(10)&#125;console.log(a()); &#x2F;&#x2F;  undefinedvar a &#x3D; 3;function a() &#123;  console.log(10); &#x2F;&#x2F;10&#125;console.log(a); &#x2F;&#x2F;3a &#x3D; 6;console.log(a()); &#x2F;&#x2F;a is not a function;</code></pre><p>å®é™…ç¼–è¯‘è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a &#x3D; funtion () &#123;  console.log(10)&#125;var a;console.log(a);    &#x2F;&#x2F; f a() &#123;console.log(10)&#125;console.log(a());  &#x2F;&#x2F;  undefineda &#x3D; 3;console.log(a)   &#x2F;&#x2F;3a &#x3D; 6;console.log(a());   &#x2F;&#x2F;a() is not a function;</code></pre><h3 id="å¾ªç¯ä¸­-IIFE-å‡½æ•°å½¢æˆçš„åŒ¿åç©ºé—´"><a href="#å¾ªç¯ä¸­-IIFE-å‡½æ•°å½¢æˆçš„åŒ¿åç©ºé—´" class="headerlink" title="å¾ªç¯ä¸­,IIFE å‡½æ•°å½¢æˆçš„åŒ¿åç©ºé—´"></a>å¾ªç¯ä¸­,IIFE å‡½æ•°å½¢æˆçš„åŒ¿åç©ºé—´</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ä»£ç 1for (var i &#x3D; 0; i &lt; 3; i++) &#123;  setTimeout(function () &#123;    console.log(i);  &#125;, i * 2000);&#125;&#x2F;&#x2F; ä»£ç 2for (var i &#x3D; 0; i &lt; 3; i++) &#123;  (function (i) &#123;    setTimeout(function () &#123;      console.log(i);    &#125;, i * 2000);  &#125;)(i);&#125;</code></pre><h3 id="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ä»£ç var a &#x3D; 10;function fn() &#123;  console.log(a);&#125;function fn2(f) &#123;  var a &#x3D; 20;  f();&#125;fn2();&#x2F;&#x2F; è§£é‡Šï¼šè€ƒå¯Ÿäº†ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾çš„ç›¸å…³çŸ¥è¯†ã€‚è®°ä½ä¸¤ç‚¹ï¼š&#x2F;&#x2F; 1ã€ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾éƒ½æ˜¯ä¸€ä¸ªé™æ€çš„æ¦‚å¿µï¼Œåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±ç¡®å®šäº†ï¼›&#x2F;&#x2F; 2ã€é€šè¿‡ä½œç”¨åŸŸé“¾æŸ¥æ‰¾éäº†çš„æ—¶å€™ï¼Œé¦–å…ˆè¦æ‰¾åˆ°å‡½æ•°æœ¬èº«çš„ä½œç”¨åŸŸï¼Œä»å®ƒæœ¬èº«çš„ä½œç”¨åŸŸå¼€å§‹æ²¿ç€ä½œç”¨åŸŸé“¾å‘å®ƒçš„ä¸Šä¸€çº§ä¾æ¬¡æŸ¥æ‰¾ã€‚</code></pre><h3 id="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾-1"><a href="#ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾-1" class="headerlink" title="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">var fn &#x3D; function () &#123;  console.log(fn);&#125;;fn();var obj &#x3D; &#123;  fn2: function () &#123;    console.log(fn2);  &#125;,&#125;;obj.fn2();&#x2F;&#x2F; è§£é‡Šï¼šè¿™é‡ŒåŒæ ·è€ƒå¯Ÿçš„æ˜¯ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾çš„çŸ¥è¯†ã€‚åŒæ—¶è¦æ³¨æ„ï¼šåœ¨objä¸­çš„console.log(fn2) å’Œ console.log(this.fn2)çš„åŒºåˆ«ã€‚</code></pre><h3 id="this-æŒ‡å‘"><a href="#this-æŒ‡å‘" class="headerlink" title="this æŒ‡å‘"></a>this æŒ‡å‘</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">var obj &#x3D; &#123;  fn2: function () &#123;    console.log(this.fn2);  &#125;,&#125;;obj.fn2(); &#x2F;&#x2F;è¾“å‡ºfn2å‡½æ•°</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/block" target="_blank" >MDN å—è¯­å¥</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/let" target="_blank" >MDN let</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/var" target="_blank" >MDN var</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/const" target="_blank" >MDN const </a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Grammar_and_Types" target="_blank" >MDN è¯­æ³•å’Œæ•°æ®ç±»å‹</a></p><p><a href="https://blog.csdn.net/jingsi1991/article/details/84770480" target="_blank" >ä½œç”¨åŸŸç›¸å…³</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-js eventloop</title>
      <link href="//post/2022-07-29js-eventloop.html"/>
      <url>//post/2022-07-29js-eventloop.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><img src="http://t-blog-images.aijs.top/img/äº‹ä»¶å¾ªç¯.png" style="max-width: 100%; width: 500px"/><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>JavaScript åœ¨è®¾è®¡ä¹‹åˆä¾¿æ˜¯å•çº¿ç¨‹ï¼Œå³æŒ‡ç¨‹åºè¿è¡Œæ—¶ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å­˜åœ¨ï¼ŒåŒä¸€æ—¶é—´åªèƒ½åšä¸€ä»¶äº‹</p><p>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Œè·Ÿ JavaScript çš„åº”ç”¨åœºæ™¯æœ‰å…³</p><p>JavaScript åˆæœŸä½œä¸ºä¸€é—¨æµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼Œé€šå¸¸ç”¨äºæ“ä½œ DOM ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›è¡Œäº†åˆ é™¤ DOM ï¼Œå¦ä¸€ä¸ªæ·»åŠ  DOMï¼Œæ­¤æ—¶æµè§ˆå™¨è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</p><p>ä¸ºäº†è§£å†³å•çº¿ç¨‹è¿è¡Œé˜»å¡é—®é¢˜ï¼ŒJavaScript ç”¨åˆ°äº†è®¡ç®—æœºç³»ç»Ÿçš„ä¸€ç§è¿è¡Œæœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶å°±å«åšäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰</p><h2 id="è¿è¡Œç¯å¢ƒ"><a href="#è¿è¡Œç¯å¢ƒ" class="headerlink" title="è¿è¡Œç¯å¢ƒ"></a>è¿è¡Œç¯å¢ƒ</h2><p>js è¿è¡Œçš„ç¯å¢ƒ,è¢«ç§°ä¸º<code>å®¿ä¸»ç¯å¢ƒ</code>ï¼Œç›®å‰æœ‰ä¸‰ç§è¿è¡Œç¯å¢ƒï¼Œ</p><ul><li>ä¸€ç§è¿è¡Œåœ¨<code>æµè§ˆå™¨(javaScript)</code></li><li>ä¸€ç§è¿è¡Œåœ¨<code>æœåŠ¡ç«¯(nodejs)</code></li><li>å¦ä¸€ç§æ˜¯è¿è¡Œåœ¨æˆ‘ä»¬çš„<code>å®¢æˆ·ç«¯(æ¯”å¦‚ Vscode å®¢æˆ·ç«¯å°±æ˜¯ä½¿ç”¨ js å†™çš„)</code></li></ul><p>å…¶ä»–çš„æ¯”å¦‚ï¼šIOS ä¸­<code>jscore</code>ï¼ŒAndroid <code>JavascriptInterace</code>, C++ <code>JSI</code></p><p><strong>å› æ­¤åªè¦ç»™ js é…å¤‡çš„ç›¸åº”çš„æ‰§è¡Œå¼•æ“ï¼Œjs å¯ä»¥è¿è¡Œåœ¨ä»»ä½•ç¯å¢ƒ</strong></p><h2 id="æµè§ˆå™¨å®¿ä¸»ç¯å¢ƒ"><a href="#æµè§ˆå™¨å®¿ä¸»ç¯å¢ƒ" class="headerlink" title="æµè§ˆå™¨å®¿ä¸»ç¯å¢ƒ"></a>æµè§ˆå™¨å®¿ä¸»ç¯å¢ƒ</h2><img src="http://t-blog-images.aijs.top/img/20220729223730.png"  style="height: 60px"/><h3 id="JS-çº¿ç¨‹"><a href="#JS-çº¿ç¨‹" class="headerlink" title="JS çº¿ç¨‹"></a>JS çº¿ç¨‹</h3><p>è´Ÿè´£æ‰§è¡Œæ‰§è¡Œæ ˆçš„æœ€é¡¶å±‚ JS ä»£ç <br>å’Œ GUI æ¸²æŸ“çº¿ç¨‹äº’æ–¥ï¼ŒJS è¿è¡Œè€—æ—¶è¿‡é•¿å°±ä¼šå¯¼è‡´é¡µé¢é˜»å¡ã€‚</p><h3 id="GUI-çº¿ç¨‹"><a href="#GUI-çº¿ç¨‹" class="headerlink" title="GUI çº¿ç¨‹"></a>GUI çº¿ç¨‹</h3><p>è´Ÿè´£æ¸²æŸ“é¡µé¢,è§£æ HTMLã€CSS æ„æˆ æ¸²æŸ“æ ‘ç­‰ï¼Œå½“é¡µé¢é‡ç»˜æˆ–è€…ç”±äºæŸç§æ“ä½œå¼•èµ·å›æµéƒ½ä¼šè°ƒèµ·è¯¥çº¿ç¨‹ã€‚<br>å’Œ JS å¼•æ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ï¼Œå½“ JS å¼•æ“çº¿ç¨‹åœ¨å·¥ä½œçš„æ—¶å€™ï¼ŒGUI æ¸²æŸ“çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼ŒGUI æ›´æ–°è¢«æ”¾å…¥åœ¨ JS ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾… JS å¼•æ“çº¿ç¨‹ç©ºé—²çš„æ—¶å€™ç»§ç»­æ‰§è¡Œã€‚</p><h3 id="äº‹ä»¶ç›‘å¬çº¿ç¨‹"><a href="#äº‹ä»¶ç›‘å¬çº¿ç¨‹" class="headerlink" title="äº‹ä»¶ç›‘å¬çº¿ç¨‹"></a>äº‹ä»¶ç›‘å¬çº¿ç¨‹</h3><p>(DOM äº‹ä»¶ï¼Œwindow çª—å£äº‹ä»¶ç­‰ç­‰)</p><p>å½“äº‹ä»¶ç¬¦åˆè§¦å‘æ¡ä»¶è¢«è§¦å‘æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šæŠŠå¯¹åº”çš„äº‹ä»¶å›è°ƒå‡½æ•°æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œç­‰å¾… JS å¼•æ“å¤„ç†ã€‚</p><h3 id="è®¡æ—¶çº¿ç¨‹"><a href="#è®¡æ—¶çº¿ç¨‹" class="headerlink" title="è®¡æ—¶çº¿ç¨‹"></a>è®¡æ—¶çº¿ç¨‹</h3><p>ï¼ˆSetTimeoutã€setInterval è®¡æ—¶å™¨ï¼‰</p><p>å¼€å¯å®šæ—¶å™¨è§¦å‘çº¿ç¨‹æ¥è®¡æ—¶å¹¶è§¦å‘è®¡æ—¶ï¼Œè®¡æ—¶å®Œæ¯•åï¼Œå°†è®¡æ—¶å™¨ç»“æŸçš„å›è°ƒå‡½æ•°æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾… JS å¼•æ“ç©ºé—²åæ‰§è¡Œï¼Œç­‰å¾… JS å¼•æ“å¤„ç†ã€‚<br>æµè§ˆå™¨å®šæ—¶è®¡æ•°å™¨å¹¶ä¸æ˜¯ç”± JS å¼•æ“è®¡æ•°çš„ï¼Œé˜»å¡ä¼šå¯¼è‡´è®¡æ—¶ä¸å‡†ç¡®ã€‚</p><h3 id="ç½‘ç»œçº¿ç¨‹"><a href="#ç½‘ç»œçº¿ç¨‹" class="headerlink" title="ç½‘ç»œçº¿ç¨‹"></a>ç½‘ç»œçº¿ç¨‹</h3><p>ï¼ˆajax ç½‘ç»œè¯·æ±‚ï¼‰</p><p>http è¯·æ±‚çš„æ—¶å€™ä¼šå¼€å¯ä¸€æ¡è¯·æ±‚çº¿ç¨‹ã€‚<br>è¯·æ±‚å®Œæˆæœ‰ç»“æœäº†ä¹‹åï¼Œå°†è¯·æ±‚çš„ http å›è°ƒå‡½æ•°æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾… JS å¼•æ“å¤„ç†ã€‚</p><h2 id="ä¸¤ä¸ªæ¦‚å¿µ"><a href="#ä¸¤ä¸ªæ¦‚å¿µ" class="headerlink" title="ä¸¤ä¸ªæ¦‚å¿µ"></a>ä¸¤ä¸ªæ¦‚å¿µ</h2><ul><li><p>æ ˆæ˜¯å…ˆè¿›åå‡º</p></li><li><p>é˜Ÿåˆ—å…ˆè¿›å…ˆå‡º</p></li></ul><h2 id="äº‹ä»¶é˜Ÿåˆ—"><a href="#äº‹ä»¶é˜Ÿåˆ—" class="headerlink" title="äº‹ä»¶é˜Ÿåˆ—"></a>äº‹ä»¶é˜Ÿåˆ—</h2><p>äº‹ä»¶é˜Ÿåˆ—åœ¨ä¸åŒçš„å®¿ä¸»ç¯å¢ƒä¸­æœ‰æ‰€å·®å¼‚ï¼Œå¤§éƒ¨åˆ†å®¿ä¸»ç¯å¢ƒä¼šå°†äº‹ä»¶é˜Ÿåˆ—è¿›è¡Œç»†åˆ†ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œäº‹ä»¶é˜Ÿåˆ—åˆ†ä¸ºä¸¤ç§ï¼š</p><p><code>å®ä»»åŠ¡ï¼ˆé˜Ÿåˆ—ï¼‰macroTack</code>ï¼šè®¡æ—¶å™¨ç»“æŸçš„å›è°ƒã€äº‹ä»¶å›è°ƒã€http å›è°ƒç­‰ç­‰ç»å¤§éƒ¨åˆ†å¼‚æ­¥å‡½æ•°è¿›å…¥å®é˜Ÿåˆ—<br><code>å¾®ä»»åŠ¡ï¼ˆé˜Ÿåˆ—ï¼‰microTack</code>ï¼š<code>MutationObserver</code>,<code>Promise äº§ç”Ÿçš„å›è°ƒ</code>è¿›å…¥å¾®é˜Ÿåˆ—</p><p>å½“æ‰§è¡Œæ ˆæ¸…ç©ºæ—¶ã€JS å¼•æ“é¦–<code>å…ˆä¼šå°†å¾®ä»»åŠ¡ä¸­çš„æ‰€æœ‰ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œç»“æŸ</code>ï¼Œå¦‚æœæ²¡æœ‰å¾®ä»»åŠ¡ï¼Œæ‰§è¡Œå®ä»»åŠ¡</p><h2 id="äº‹ä»¶å¾ªç¯-Event-Loop"><a href="#äº‹ä»¶å¾ªç¯-Event-Loop" class="headerlink" title="äº‹ä»¶å¾ªç¯(Event Loop)"></a>äº‹ä»¶å¾ªç¯(Event Loop)</h2><p>äº‹ä»¶å¾ªç¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«ç”± <code>æµè§ˆå™¨å®¿ä¸»</code>ï¼Œ<code>web api</code> ä¸ <code>äº‹ä»¶é˜Ÿåˆ—ï¼ˆä¹Ÿç§°ä»»åŠ¡é˜Ÿåˆ—ï¼‰</code>ç»„æˆ</p><h2 id="æ‰§è¡Œæ ˆ"><a href="#æ‰§è¡Œæ ˆ" class="headerlink" title="æ‰§è¡Œæ ˆ"></a>æ‰§è¡Œæ ˆ</h2><p>ç”±äº JavaScript å¼•æ“æ˜¯å•çº¿ç¨‹ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå…¶ä»–ä»»åŠ¡éƒ½å¾—æŒ‰ç…§é¡ºåºæ’é˜Ÿç­‰å¾…è¢«æ‰§è¡Œï¼Œåªæœ‰å½“å‰çš„ä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹åæ‰ä¼šå¾€ä¸‹æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå› æ­¤è¿™äº›ä»»åŠ¡è¢«æ’é˜Ÿåœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°æ–¹ã€‚è¿™ä¸ªåœ°æ–¹è¢«ç§°ä¸ºæ‰§è¡Œæ ˆ</p><p><code>æ‰§è¡Œæ ˆæ˜¯ä¸€ä¸ªåè¿›å…ˆå‡ºæ•°æ®ç»“æ„</code>ï¼Œç”¨äºå­˜æ”¾å„ç§å‡½æ•°çš„æ‰§è¡Œç¯å¢ƒï¼Œ<br>æ¯ä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¹‹å‰ï¼Œå®ƒçš„ç›¸å…³ä¿¡æ¯ä¼šåŠ å…¥åˆ°æ‰§è¡Œæ ˆï¼Œ<br>å‡½æ•°è°ƒç”¨ä¹‹å‰ï¼Œåˆ›å»ºæ‰§è¡Œç¯å¢ƒï¼Œç„¶å push åˆ°æ‰§è¡Œæ ˆï¼›<br>å‡½æ•°è°ƒç”¨ä¹‹åï¼Œé”€æ¯æ‰§è¡Œç¯å¢ƒï¼Œå¹¶ä»æ‰§è¡Œæ ˆé¡¶éƒ¨æ¨ï¼ˆpopï¼‰å‡ºå»</p><h2 id="Event-Loop-åœ¨æµè§ˆå™¨ä¸-node-ç¯å¢ƒä¸­çš„åŒºåˆ«ï¼š"><a href="#Event-Loop-åœ¨æµè§ˆå™¨ä¸-node-ç¯å¢ƒä¸­çš„åŒºåˆ«ï¼š" class="headerlink" title="Event Loop åœ¨æµè§ˆå™¨ä¸ node ç¯å¢ƒä¸­çš„åŒºåˆ«ï¼š"></a>Event Loop åœ¨æµè§ˆå™¨ä¸ node ç¯å¢ƒä¸­çš„åŒºåˆ«ï¼š</h2><p>æµè§ˆå™¨ç¯å¢ƒæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œå†å»æ£€æŸ¥å¾®ä»»åŠ¡<br>node ä¼šæ¸…ç©ºå½“å‰æ‰€å¤„é˜¶æ®µçš„é˜Ÿåˆ—ï¼Œå³æ‰§è¡Œæ‰€æœ‰ taskï¼Œå†å»æ£€æŸ¥å¾®ä»»åŠ¡</p><h2 id="æµè§ˆå™¨ç¯å¢ƒ-äº‹ä¾‹"><a href="#æµè§ˆå™¨ç¯å¢ƒ-äº‹ä¾‹" class="headerlink" title="æµè§ˆå™¨ç¯å¢ƒ äº‹ä¾‹"></a>æµè§ˆå™¨ç¯å¢ƒ äº‹ä¾‹</h2><h3 id="äº‹ä¾‹-1"><a href="#äº‹ä¾‹-1" class="headerlink" title="äº‹ä¾‹ 1"></a>äº‹ä¾‹ 1</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;script&gt;    function a() &#123;        console.log(&quot;a&quot;)        b();    &#125;    function b() &#123;        console.log(&quot;b&quot;);        c();    &#125;    function c() &#123;        console.log(&quot;c&quot;)    &#125;    console.log(&quot;global&quot;);    a();&lt;&#x2F;script&gt;</code></pre><h3 id="äº‹ä¾‹-2"><a href="#äº‹ä¾‹-2" class="headerlink" title="äº‹ä¾‹ 2"></a>äº‹ä¾‹ 2</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">console.log(1);setTimeout(() &#x3D;&gt; &#123;  console.log(2);  setTimeout(() &#x3D;&gt; &#123;    console.log(3);    setTimeout(() &#x3D;&gt; &#123;      console.log(4);    &#125;, 0);  &#125;, 0);&#125;, 0);setTimeout(() &#x3D;&gt; &#123;  console.log(5);  setTimeout(() &#x3D;&gt; &#123;    console.log(6);  &#125;, 0);&#125;, 0);console.log(&quot;ok&quot;);</code></pre><h3 id="äº‹ä¾‹-3"><a href="#äº‹ä¾‹-3" class="headerlink" title="äº‹ä¾‹ 3"></a>äº‹ä¾‹ 3</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">console.log(1);setTimeout(() &#x3D;&gt; &#123;  console.log(&quot;setTimeout&quot;);&#125;, 0);let promise &#x3D; new Promise((resolve) &#x3D;&gt; &#123;  console.log(3);  resolve();&#125;)  .then((data) &#x3D;&gt; &#123;    console.log(100);  &#125;)  .then((data) &#x3D;&gt; &#123;    console.log(200);  &#125;);console.log(2);</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zhuanlan.zhihu.com/p/41543963" target="_blank" >Event Loop è¿™ä¸ªå¾ªç¯ä½ æ™“å¾—ä¹ˆï¼Ÿ(é™„ GIF è¯¦è§£)</a></p><p><a href="https://juejin.cn/post/6844904008134426638" target="_blank" >[å›é¡¾]äº‹ä»¶å¾ªç¯æœºåˆ¶ (Event-loop)</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-js é—­åŒ…</title>
      <link href="//post/2022-07-28js-closures.html"/>
      <url>//post/2022-07-28js-closures.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><img src="http://t-blog-images.aijs.top/img/202207291656804.webp" /><h2 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h2><p>ä¸€ä¸ªå‡½æ•° å’Œ å¯¹å…¶å‘¨å›´çŠ¶æ€<code>ï¼ˆlexical environmentï¼Œè¯æ³•ç¯å¢ƒï¼‰</code>çš„å¼•ç”¨, æ†ç»‘åœ¨ä¸€èµ·ï¼ˆæˆ–è€…è¯´å‡½æ•°è¢«å¼•ç”¨åŒ…å›´ï¼‰ï¼Œè¿™æ ·çš„ç»„åˆå°±æ˜¯é—­åŒ…ï¼ˆclosureï¼‰</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé—­åŒ…è®©ä½ å¯ä»¥åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä¸­ è®¿é—®åˆ° å…¶å¤–å±‚å‡½æ•°çš„<code>ä½œç”¨åŸŸ</code>ã€‚åœ¨å½¢å¼ä¸Šä½“ç°ä¸ºå‡½æ•°åµŒå¥—ï¼Œå†…å±‚å‡½æ•°æœ‰å¤–å±‚å‡½æ•°çš„å˜é‡å¼•ç”¨ï¼Œ åœ¨ JavaScript ä¸­ï¼Œæ¯å½“åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œé—­åŒ…å°±ä¼šåœ¨å‡½æ•°åˆ›å»ºçš„åŒæ—¶è¢«åˆ›å»ºå‡ºæ¥ã€‚</p><h2 id="è¯æ³•ç¯å¢ƒ"><a href="#è¯æ³•ç¯å¢ƒ" class="headerlink" title="è¯æ³•ç¯å¢ƒ"></a>è¯æ³•ç¯å¢ƒ</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>A Lexical Environment is a specification type used to define the association of Identifiers to specific variables and functions based upon the lexical nesting structure of ECMAScript code. A Lexical Environment consists of an Environment Record and a possibly null reference to an outer Lexical Environment.<br>ç¿»è¯‘ï¼šè¯æ³•ç¯å¢ƒï¼š æ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰ç‰¹å®šå˜é‡å’Œå‡½æ•°æ ‡è¯†ç¬¦åœ¨ ECMAScript ä»£ç çš„è¯æ³•åµŒå¥—ç»“æ„ä¸Šå…³è”å…³ç³»çš„è§„èŒƒç±»å‹ã€‚ä¸€ä¸ªè¯æ³•ç¯å¢ƒç”±ä¸€ä¸ªç¯å¢ƒè®°å½•é¡¹å’Œå¯èƒ½ä¸ºç©ºçš„å¤–éƒ¨è¯æ³•ç¯å¢ƒå¼•ç”¨æ„æˆ</p></blockquote><p>è¯æ³•ç¯å¢ƒæ˜¯: ç”±å†…éƒ¨ JavaScript å¼•æ“æ„é€ ï¼Œç”¨æ¥ä¿å­˜æ ‡è¯†ç¬¦å’Œå˜é‡&#x2F;å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼ŒåŒæ—¶ï¼Œä¿å­˜äº†å¯¹çˆ¶çº§ï¼ˆè¯æ³•ç¯å¢ƒ- æ ‡è¯†ç¬¦ä¸å˜é‡æ˜ å°„ï¼‰çš„å¼•ç”¨ã€‚</p><ul><li><code>æ ‡è¯†ç¬¦</code> ï¼š æŒ‡å˜é‡æˆ–è€…å‡½æ•°çš„åç§°</li><li><code>å˜é‡</code>ï¼šå¯¹ <code>å®é™…å¯¹è±¡</code>ï¼ˆåŒ…æ‹¬å‡½æ•°ç±»å‹å¯¹è±¡ï¼‰æˆ–è€…<code>åŸå§‹å€¼</code>çš„å¼•ç”¨</li></ul><p>è¯æ³•ç¯å¢ƒç»„æˆï¼š</p><ul><li><code>ç¯å¢ƒè®°å½•</code>ï¼šå­˜å‚¨å˜é‡å’Œå‡½æ•°å£°æ˜çš„å®é™…ä½ç½®</li><li><code>å¯¹å¤–å¼•ç”¨</code>ï¼šå®é™…ä¸Šå°±æ˜¯å¯¹å¤–éƒ¨æˆ–è€…è¯´æ˜¯çˆ¶çº§è¯æ³•ç¯å¢ƒçš„å¼•ç”¨</li></ul><h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><p><strong>MDN:</strong><br>åœ¨å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å€¼å’Œè¡¨è¾¾å¼åœ¨å…¶ä¸­ â€œå¯è§â€ æˆ–å¯è¢«è®¿é—®åˆ°çš„ä¸Šä¸‹æ–‡ã€‚å¦‚æœä¸€ä¸ª<strong>å˜é‡</strong>æˆ–è€…å…¶ä»–è¡¨è¾¾å¼ä¸ â€œåœ¨å½“å‰çš„ä½œç”¨åŸŸä¸­â€ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸å¯ç”¨çš„ã€‚ä½œç”¨åŸŸä¹Ÿå¯ä»¥æ ¹æ®ä»£ç å±‚æ¬¡åˆ†å±‚ï¼Œä»¥ä¾¿å­ä½œç”¨åŸŸå¯ä»¥è®¿é—®çˆ¶ä½œç”¨åŸŸï¼Œé€šå¸¸æ˜¯æŒ‡æ²¿ç€é“¾å¼çš„ä½œç”¨åŸŸé“¾æŸ¥æ‰¾ï¼Œè€Œä¸èƒ½ä»çˆ¶ä½œç”¨åŸŸå¼•ç”¨å­ä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå¼•ç”¨ã€‚</p><p>ä½œç”¨åŸŸå¯ä»¥è§†ä¸ºä¸€å¥—è§„åˆ™ï¼Œè¿™å¥—è§„åˆ™ç”¨æ¥ç®¡ç† js å¼•æ“,å¦‚ä½•åœ¨å½“å‰ä½œç”¨åŸŸä»¥åŠåµŒå¥—çš„å­ä½œç”¨åŸŸï¼Œæ ¹æ®æ ‡è¯†ç¬¦åç§°è¿›è¡Œå˜é‡æŸ¥æ‰¾ã€‚</p><h2 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h2><p>JavaScript åœ¨æ‰§â¾è¿‡ç¨‹ä¸­, ä¼šåˆ›é€ å¯æ‰§â¾ä¸Šä¸‹â½‚ï¼Œå¯æ‰§â¾ä¸Šä¸‹â½‚ä¸­çš„è¯æ³•ç¯å¢ƒä¸­å«æœ‰å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•â½¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¼•â½¤è·å–å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å˜é‡ã€å£°æ˜ç­‰ï¼Œè¿™äº›å¼•â½¤ä¸²è”èµ·æ¥â¼€ç›´æŒ‡å‘å…¨å±€çš„è¯æ³•ç¯å¢ƒï¼Œå› æ­¤å½¢æˆäº†<code>ä½œâ½¤åŸŸé“¾</code>ã€‚</p><h2 id="å¯æ‰§è¡Œä¸Šä¸‹æ–‡"><a href="#å¯æ‰§è¡Œä¸Šä¸‹æ–‡" class="headerlink" title="å¯æ‰§è¡Œä¸Šä¸‹æ–‡"></a>å¯æ‰§è¡Œä¸Šä¸‹æ–‡</h2><p>å½“ js å¼•æ“æ‰§è¡Œåˆ°ä¸€æ®µå¯æ‰§è¡Œä»£ç æ—¶ï¼Œå°±ä¼šä¸ºä¹‹<code>åˆ›å»ºå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)</code>ã€‚<br>é‚£ä¹ˆå› æ­¤æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹åº”ä¹Ÿæœ‰ä¸‰ç§ï¼š<code>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</code>ï¼Œ<code>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡</code>ï¼Œ<code>eval æ‰§è¡Œä¸Šä¸‹æ–‡</code>ã€‚</p><h2 id="å¯æ‰§è¡Œä»£ç "><a href="#å¯æ‰§è¡Œä»£ç " class="headerlink" title="å¯æ‰§è¡Œä»£ç "></a>å¯æ‰§è¡Œä»£ç </h2><p>ECMAScript å¯æ‰§è¡Œä»£ç åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š<code>å…¨å±€ä»£ç </code>ï¼Œ<code>å‡½æ•°ä»£ç </code>ï¼Œ<code>eval ä»£ç </code>ã€‚</p><h2 id="å¯æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ"><a href="#å¯æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ" class="headerlink" title="å¯æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ"></a>å¯æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ</h2><img src="http://t-blog-images.aijs.top/img/202207291418098.webp" /><h2 id="è¯æ³•ä½œç”¨åŸŸ"><a href="#è¯æ³•ä½œç”¨åŸŸ" class="headerlink" title="è¯æ³•ä½œç”¨åŸŸ"></a>è¯æ³•ä½œç”¨åŸŸ</h2><p>åˆ†æå™¨å¦‚ä½•åœ¨å‡½æ•°åµŒå¥—çš„æƒ…å†µä¸‹è§£æå˜é‡å</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><img src="http://t-blog-images.aijs.top/img/202207291656804.webp" /><img src="http://t-blog-images.aijs.top/img/202207291703485.webp" /><h2 id="é—­åŒ…ä½œç”¨"><a href="#é—­åŒ…ä½œç”¨" class="headerlink" title="é—­åŒ…ä½œç”¨"></a>é—­åŒ…ä½œç”¨</h2><ul><li>ç”¨é—­åŒ…æ¨¡æ‹Ÿç§æœ‰æ–¹æ³•</li><li>æ•°æ®ç¼“å­˜</li></ul><h2 id="é—­åŒ…æ€§èƒ½"><a href="#é—­åŒ…æ€§èƒ½" class="headerlink" title="é—­åŒ…æ€§èƒ½"></a>é—­åŒ…æ€§èƒ½</h2><ul><li>å¦‚æœä¸æ˜¯æŸäº›ç‰¹å®šä»»åŠ¡, éœ€è¦ä½¿ç”¨é—­åŒ…ï¼Œåœ¨å…¶å®ƒå‡½æ•°ä¸­åˆ›å»ºå‡½æ•°æ˜¯ä¸æ˜æ™ºçš„ï¼Œå› ä¸ºé—­åŒ…åœ¨å¤„ç†é€Ÿåº¦å’Œå†…å­˜æ¶ˆè€—æ–¹é¢å¯¹è„šæœ¬æ€§èƒ½å…·æœ‰è´Ÿé¢å½±å“ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºæ–°çš„å¯¹è±¡æˆ–è€…ç±»æ—¶ï¼Œæ–¹æ³•é€šå¸¸åº”è¯¥å…³è”äºå¯¹è±¡çš„åŸå‹ï¼Œè€Œä¸æ˜¯å®šä¹‰åˆ°å¯¹è±¡çš„æ„é€ å™¨ä¸­ã€‚åŸå› æ˜¯è¿™å°†å¯¼è‡´æ¯æ¬¡æ„é€ å™¨è¢«è°ƒç”¨æ—¶ï¼Œæ–¹æ³•éƒ½ä¼šè¢«é‡æ–°èµ‹å€¼ä¸€æ¬¡ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸ªå¯¹è±¡çš„åˆ›å»ºï¼Œæ–¹æ³•éƒ½ä¼šè¢«é‡æ–°èµ‹å€¼ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function MyObject(name, message) &#123;  this.name &#x3D; name.toString();  this.message &#x3D; message.toString();  this.getName &#x3D; function () &#123;    return this.name;  &#125;;  this.getMessage &#x3D; function () &#123;    return this.message;  &#125;;&#125;</code></pre><p><strong>å¯æ”¹æˆå¦‚ä¸‹ä¾‹å­ï¼š</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function MyObject(name, message) &#123;  this.name &#x3D; name.toString();  this.message &#x3D; message.toString();&#125;MyObject.prototype.getName &#x3D; function () &#123;  return this.name;&#125;;MyObject.prototype.getMessage &#x3D; function () &#123;  return this.message;&#125;;</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/qq_42345237/article/details/120603881" target="_blank" >è¯æ³•ç¯å¢ƒæ˜¯ä»€ä¹ˆï¼Ÿ</a></p><p><a href="https://baijiahao.baidu.com/s?id=1729331413156806540&wfr=spider&for=pc" target="_blank" >è¯æ³•ä½œç”¨åŸŸ</a></p><p><a href="https://juejin.cn/post/7019682405896175653" target="_blank" >å¯æ‰§è¡Œä»£ç ä¸æ‰§è¡Œä¸Šä¸‹æ–‡</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Scope" target="_blank" >Scopeï¼ˆä½œç”¨åŸŸï¼‰</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-js fun</title>
      <link href="//post/2022-07-28js-fun.html"/>
      <url>//post/2022-07-28js-fun.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><img src="http://t-blog-images.aijs.top/img/202208011605439.webp" style="max-width: 100%; width: 600px" /><h2 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>arguments å¯¹è±¡ä¸æ˜¯ä¸€ä¸ª Array ã€‚å®ƒç±»ä¼¼äº Arrayï¼Œä½†é™¤äº† length å±æ€§å’Œç´¢å¼•å…ƒç´ ä¹‹å¤–æ²¡æœ‰ä»»ä½• Array å±æ€§</p></blockquote><h3 id="ä½¿ç”¨æ•°ç»„æ–¹æ³•"><a href="#ä½¿ç”¨æ•°ç»„æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ•°ç»„æ–¹æ³•"></a>ä½¿ç”¨æ•°ç»„æ–¹æ³•</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Array.prototype.slice.callfunction myConcat(separator) &#123;  var args &#x3D; Array.prototype.slice.call(arguments, 1);  return args.join(separator);&#125;</code></pre><h3 id="è½¬åŒ–æˆçœŸå®æ•°ç»„"><a href="#è½¬åŒ–æˆçœŸå®æ•°ç»„" class="headerlink" title="è½¬åŒ–æˆçœŸå®æ•°ç»„"></a>è½¬åŒ–æˆçœŸå®æ•°ç»„</h3><p>å¯ä»¥ä½¿ç”¨<code>Array.from()</code>æ–¹æ³•æˆ–<code>æ‰©å±•è¿ç®—ç¬¦</code>å°†å‚æ•°è½¬æ¢ä¸ºçœŸå®æ•°ç»„ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var args &#x3D; Array.from(arguments);var args &#x3D; [...arguments];</code></pre><h3 id="å‚æ•°å½±å“"><a href="#å‚æ•°å½±å“" class="headerlink" title="å‚æ•°å½±å“"></a>å‚æ•°å½±å“</h3><h3 id="ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ-æ— å½±å“"><a href="#ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ-æ— å½±å“" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ æ— å½±å“"></a>ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ æ— å½±å“</h3><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ<code>å‰©ä½™å‚æ•°</code>ã€<code>é»˜è®¤å‚æ•°</code>å’Œ<code>è§£æ„èµ‹å€¼å‚æ•°</code>çš„å­˜åœ¨, <strong>ä¸ä¼šæ”¹å˜ arguments å¯¹è±¡çš„è¡Œä¸º, ä¸è·Ÿè¸ª</strong>ã€‚<br><strong>ç¤ºä¾‹ 1</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&quot;use strict&quot;;function func(a) &#123;  arguments[0] &#x3D; 34;  console.log(a); &#x2F;&#x2F; 1  console.log(arguments[0]); &#x2F;&#x2F; 34&#125;func(1);</code></pre><p><strong>ç¤ºä¾‹ 2</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&quot;use strict&quot;;function func(a &#x3D; 2) &#123;  arguments[0] &#x3D; 34;  console.log(arguments[0]); &#x2F;&#x2F;34  console.log(a); &#x2F;&#x2F; 3&#125;func(3);</code></pre><h3 id="éä¸¥æ ¼æ¨¡å¼ï¼Œæ²¡æœ‰â€¦ï¼Œè·Ÿè¸ª"><a href="#éä¸¥æ ¼æ¨¡å¼ï¼Œæ²¡æœ‰â€¦ï¼Œè·Ÿè¸ª" class="headerlink" title="éä¸¥æ ¼æ¨¡å¼ï¼Œæ²¡æœ‰â€¦ï¼Œè·Ÿè¸ª"></a>éä¸¥æ ¼æ¨¡å¼ï¼Œæ²¡æœ‰â€¦ï¼Œè·Ÿè¸ª</h3><p><strong>éä¸¥æ ¼æ¨¡å¼ä¸­</strong>, å‡½æ•° <strong>æ²¡æœ‰åŒ…å«</strong> <code>å‰©ä½™å‚æ•°</code>ã€<code>é»˜è®¤å‚æ•°</code>ã€<code>è§£æ„èµ‹å€¼</code>ï¼Œ <strong>arguments å¯¹è±¡ä¸­çš„å€¼ä¼šè·Ÿè¸ªå‚æ•°çš„å€¼</strong></p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function func(a) &#123;  arguments[0] &#x3D; 99; &#x2F;&#x2F; æ›´æ–°äº† arguments[0] åŒæ ·æ›´æ–°äº† a  console.log(a); &#x2F;&#x2F; 99  console.log(arguments[0]); &#x2F;&#x2F; 9&#125;func(10);</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function func(a) &#123;  a &#x3D; 99; &#x2F;&#x2F; æ›´æ–°äº† a åŒæ ·æ›´æ–°äº† arguments[0]  console.log(a); &#x2F;&#x2F; 99  console.log(arguments[0]); &#x2F;&#x2F; 99&#125;func(10);</code></pre><h3 id="éä¸¥æ ¼æ¨¡å¼ï¼Œæœ‰â€¦ï¼Œä¸è·Ÿè¸ª"><a href="#éä¸¥æ ¼æ¨¡å¼ï¼Œæœ‰â€¦ï¼Œä¸è·Ÿè¸ª" class="headerlink" title="éä¸¥æ ¼æ¨¡å¼ï¼Œæœ‰â€¦ï¼Œä¸è·Ÿè¸ª"></a>éä¸¥æ ¼æ¨¡å¼ï¼Œæœ‰â€¦ï¼Œä¸è·Ÿè¸ª</h3><p>å½“éä¸¥æ ¼æ¨¡å¼ä¸­çš„å‡½æ•°, <strong>æœ‰åŒ…å«</strong> <code>å‰©ä½™å‚æ•°</code>ã€<code>é»˜è®¤å‚æ•°</code>ã€<code>è§£æ„èµ‹å€¼</code>ï¼Œ <strong>arguments å¯¹è±¡ä¸­çš„å€¼ä¸ä¼šè·Ÿè¸ªå‚æ•°çš„å€¼</strong></p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function func(a &#x3D; 55) &#123;  arguments[0] &#x3D; 99; &#x2F;&#x2F; updating arguments[0] does not also update a  console.log(a); &#x2F;&#x2F; 10  console.log(arguments[0]); &#x2F;&#x2F; 99&#125;func(10);</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function func(a &#x3D; 55) &#123;  a &#x3D; 99; &#x2F;&#x2F; updating a does not also update arguments[0]  console.log(a); &#x2F;&#x2F; 99  console.log(arguments[0]); &#x2F;&#x2F; 10&#125;func(10);</code></pre><p><strong>ç¤ºä¾‹ 3:</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function func(a &#x3D; 55) &#123;  console.log(a); &#x2F;&#x2F; 55  console.log(arguments[0]); &#x2F;&#x2F; undefined&#125;func();</code></pre><h2 id="use-strict"><a href="#use-strict" class="headerlink" title="use strict"></a>use strict</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><ul><li>æ¶ˆé™¤ Javascript è¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸ä¸¥è°¨ä¹‹å¤„ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸º;</li><li>æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ï¼›</li><li>æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ï¼›</li><li>ä¸ºæœªæ¥æ–°ç‰ˆæœ¬çš„ Javascript åšå¥½é“ºå«ã€‚</li></ul></blockquote><h2 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h2><p><strong>ç®­å¤´å‡½æ•°è¡¨è¾¾å¼</strong>çš„è¯­æ³•æ¯”å‡½æ•°è¡¨è¾¾å¼æ›´ç®€æ´ï¼Œå¹¶ä¸”æ²¡æœ‰è‡ªå·±çš„ <code>this</code>ï¼Œ<code>arguments</code>ï¼Œ<code>super</code>, <code>new.target</code>ã€‚ç®­å¤´å‡½æ•°è¡¨è¾¾å¼æ›´é€‚ç”¨äºé‚£äº›æœ¬æ¥éœ€è¦åŒ¿åå‡½æ•°çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒ<code>ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°</code>ã€‚<code>è§£æé¡ºåºä¹Ÿæœ‰åŒºåˆ«</code>ã€‚</p><h3 id="ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°åŒºåˆ«"><a href="#ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°åŒºåˆ«" class="headerlink" title="ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°åŒºåˆ«"></a>ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°åŒºåˆ«</h3><ul><li>è¯­æ³•æ¯”å‡½æ•°è¡¨è¾¾å¼æ›´ç®€æ´</li><li>æ²¡æœ‰è‡ªå·±çš„ <code>this</code>ï¼Œ<code>arguments</code>ï¼Œ<code>super</code>, <code>new.target</code></li><li>ä¸èƒ½ç”¨ new æ“ä½œç¬¦å·</li><li>ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°</li><li>ä¸èƒ½ç”¨ yield</li><li>æ—  prototype å±æ€§</li><li>è§£æé¡ºåºä¹Ÿæœ‰åŒºåˆ«</li></ul><h3 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; å¤šå‚æ•°(param1, param2, â€¦, paramN) &#x3D;&gt; &#123; statements &#125;(param1, param2, â€¦, paramN) &#x3D;&gt; expression&#x2F;&#x2F;ç›¸å½“äºï¼š(param1, param2, â€¦, paramN) &#x3D;&gt;&#123; return expression; &#125;&#x2F;&#x2F; å•å‚æ•°&#x2F;&#x2F; å½“åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œåœ†æ‹¬å·æ˜¯å¯é€‰çš„ï¼š(singleParam) &#x3D;&gt; &#123; statements &#125;singleParam &#x3D;&gt; &#123; statements &#125;&#x2F;&#x2F; æ— å‚æ•°&#x2F;&#x2F; æ²¡æœ‰å‚æ•°çš„å‡½æ•°åº”è¯¥å†™æˆä¸€å¯¹åœ†æ‹¬å·ã€‚() &#x3D;&gt; &#123; statements &#125;</code></pre><h3 id="é«˜çº§è¯­æ³•"><a href="#é«˜çº§è¯­æ³•" class="headerlink" title="é«˜çº§è¯­æ³•"></a>é«˜çº§è¯­æ³•</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F;åŠ æ‹¬å·çš„å‡½æ•°ä½“, è¿”å›å¯¹è±¡å­—é¢é‡è¡¨è¾¾å¼ï¼šparams &#x3D;&gt; (&#123;foo: bar&#125;) &#x2F;&#x2F; è¿”å› &#123;foo: bar&#125;ï¼Œ ä¸åŠ  () å‡½æ•°é»˜è®¤è¿”å›undefine&#x2F;&#x2F;æ”¯æŒå‰©ä½™å‚æ•°ã€é»˜è®¤å‚æ•°(param1, param2, ...rest) &#x3D;&gt; &#123; statements &#125;(param1 &#x3D; defaultValue1, param2, â€¦, paramN &#x3D; defaultValueN) &#x3D;&gt; &#123;statements &#125;&#x2F;&#x2F;åŒæ ·æ”¯æŒå‚æ•°åˆ—è¡¨è§£æ„let f &#x3D; ([a, b] &#x3D; [1, 2], &#123;x: c&#125; &#x3D; &#123;x: a + b&#125;) &#x3D;&gt; a + b + c;f();  &#x2F;&#x2F; 6</code></pre><h3 id="æ²¡æœ‰å•ç‹¬çš„-this"><a href="#æ²¡æœ‰å•ç‹¬çš„-this" class="headerlink" title="æ²¡æœ‰å•ç‹¬çš„ this"></a>æ²¡æœ‰å•ç‹¬çš„ this</h3><p>åœ¨ç®­å¤´å‡½æ•°å‡ºç°ä¹‹å‰ï¼Œæ¯ä¸€ä¸ªæ–°å‡½æ•°æ ¹æ®å®ƒæ˜¯è¢«å¦‚ä½•è°ƒç”¨çš„æ¥å®šä¹‰è¿™ä¸ªå‡½æ•°çš„ this å€¼ï¼š</p><ul><li>å¦‚æœè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œthis æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ–°çš„å¯¹è±¡</li><li>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹çš„å‡½æ•°è°ƒç”¨ä¸‹ï¼Œthis æŒ‡å‘ undefined</li><li>å¦‚æœè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œåˆ™å®ƒçš„ this æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªå¯¹è±¡</li><li>ç­‰ç­‰</li></ul><h3 id="ä¸å—é™ä¸¥æ ¼æ¨¡å¼çš„-this-è§„åˆ™"><a href="#ä¸å—é™ä¸¥æ ¼æ¨¡å¼çš„-this-è§„åˆ™" class="headerlink" title="ä¸å—é™ä¸¥æ ¼æ¨¡å¼çš„ this è§„åˆ™"></a>ä¸å—é™ä¸¥æ ¼æ¨¡å¼çš„ this è§„åˆ™</h3><p>é‰´äº this æ˜¯è¯æ³•å±‚é¢ä¸Šçš„ï¼Œä¸¥æ ¼æ¨¡å¼ä¸­ä¸ this ç›¸å…³çš„è§„åˆ™éƒ½å°†è¢«å¿½ç•¥ã€‚</p><p><span style="color: red">ç®­å¤´å‡½æ•°ä¸­ this æ˜¯è¯­æ³•å±‚é¢çš„</span></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var f &#x3D; () &#x3D;&gt; &#123;  &quot;use strict&quot;;  return this;&#125;;f() &#x3D;&#x3D;&#x3D; window; &#x2F;&#x2F; æˆ–è€… global</code></pre><h3 id="é€šè¿‡-call-æˆ–-apply-è°ƒç”¨"><a href="#é€šè¿‡-call-æˆ–-apply-è°ƒç”¨" class="headerlink" title="é€šè¿‡ call æˆ– apply è°ƒç”¨"></a>é€šè¿‡ call æˆ– apply è°ƒç”¨</h3><p>ç”±äº ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this æŒ‡é’ˆï¼Œé€šè¿‡ call() æˆ– apply() æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œåªèƒ½ä¼ é€’å‚æ•°ï¼ˆä¸èƒ½ç»‘å®š thisâ€”è¯‘è€…æ³¨ï¼‰ï¼Œä»–ä»¬çš„<strong>ç¬¬ä¸€ä¸ªå‚æ•°ä¼šè¢«å¿½ç•¥</strong>ã€‚ï¼ˆè¿™ç§ç°è±¡å¯¹äº bind æ–¹æ³•åŒæ ·æˆç«‹ â€” è¯‘è€…æ³¨ï¼‰</p><h3 id="ä¸ç»‘å®š-arguments"><a href="#ä¸ç»‘å®š-arguments" class="headerlink" title="ä¸ç»‘å®š arguments"></a>ä¸ç»‘å®š arguments</h3><p>ç®­å¤´å‡½æ•°ä¸ç»‘å®š Arguments å¯¹è±¡ã€‚</p><p><strong>å¯ä»¥ä½¿ç”¨å‰©ä½™å‚æ•°</strong></p><h3 id="ä½¿ç”¨ç®­å¤´å‡½æ•°ä½œä¸ºæ–¹æ³•"><a href="#ä½¿ç”¨ç®­å¤´å‡½æ•°ä½œä¸ºæ–¹æ³•" class="headerlink" title="ä½¿ç”¨ç®­å¤´å‡½æ•°ä½œä¸ºæ–¹æ³•"></a>ä½¿ç”¨ç®­å¤´å‡½æ•°ä½œä¸ºæ–¹æ³•</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&quot;use strict&quot;;var obj &#x3D; &#123;  i: 10,  b: () &#x3D;&gt; console.log(this.i, this), &#x2F;&#x2F; å¹¶ä¸æŒ‡å‘å¯¹è±¡  c: function () &#123;    console.log(this.i, this);  &#125;,&#125;;obj.b();&#x2F;&#x2F; undefined, Window&#123;...&#125;obj.c();&#x2F;&#x2F; 10, Object &#123;...&#125;</code></pre><h3 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty"></a>Object.defineProperty</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&quot;use strict&quot;;var obj &#x3D; &#123;  a: 10,&#125;;Object.defineProperty(obj, &quot;b&quot;, &#123;  get: () &#x3D;&gt; &#123;    console.log(this.a, typeof this.a, this);    return this.a + 10;    &#x2F;&#x2F; ä»£è¡¨å…¨å±€å¯¹è±¡ &#39;Window&#39;, å› æ­¤ &#39;this.a&#39; è¿”å› &#39;undefined&#39;  &#125;,&#125;);obj.b; &#x2F;&#x2F; undefined   &quot;undefined&quot;   Window &#123;postMessage: Æ’, blur: Æ’, focus: Æ’, close: Æ’, frames: Window, â€¦&#125;</code></pre><h3 id="ä½¿ç”¨-new-æ“ä½œç¬¦"><a href="#ä½¿ç”¨-new-æ“ä½œç¬¦" class="headerlink" title="ä½¿ç”¨ new æ“ä½œç¬¦"></a>ä½¿ç”¨ new æ“ä½œç¬¦</h3><p>ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œæ„é€ å™¨ï¼Œå’Œ new ä¸€èµ·ç”¨ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var Foo &#x3D; () &#x3D;&gt; &#123;&#125;;var foo &#x3D; new Foo(); &#x2F;&#x2F; TypeError: Foo is not a constructor</code></pre><h3 id="ä½¿ç”¨-prototype-å±æ€§"><a href="#ä½¿ç”¨-prototype-å±æ€§" class="headerlink" title="ä½¿ç”¨ prototype å±æ€§"></a>ä½¿ç”¨ prototype å±æ€§</h3><p>ç®­å¤´å‡½æ•°æ²¡æœ‰ prototype å±æ€§ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var Foo &#x3D; () &#x3D;&gt; &#123;&#125;;console.log(Foo.prototype); &#x2F;&#x2F; undefined</code></pre><h3 id="ä½¿ç”¨-yield-å…³é”®å­—"><a href="#ä½¿ç”¨-yield-å…³é”®å­—" class="headerlink" title="ä½¿ç”¨ yield å…³é”®å­—"></a>ä½¿ç”¨ yield å…³é”®å­—</h3><p>yield å…³é”®å­—é€šå¸¸ä¸èƒ½åœ¨ç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨ï¼ˆé™¤éæ˜¯åµŒå¥—åœ¨å…è®¸ä½¿ç”¨çš„å‡½æ•°å†…ï¼‰ã€‚å› æ­¤ï¼Œç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œå‡½æ•°ç”Ÿæˆå™¨ã€‚</p><h3 id="å‡½æ•°ä½“"><a href="#å‡½æ•°ä½“" class="headerlink" title="å‡½æ•°ä½“"></a>å‡½æ•°ä½“</h3><p>ç®­å¤´å‡½æ•°å¯ä»¥æœ‰ä¸€ä¸ªâ€œç®€å†™ä½“â€æˆ–å¸¸è§çš„â€œå—ä½“â€ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var func &#x3D; (x) &#x3D;&gt; x * x;&#x2F;&#x2F; ç®€å†™å‡½æ•° çœç•¥ returnvar func &#x3D; (x, y) &#x3D;&gt; &#123;  return x + y;&#125;;&#x2F;&#x2F;å¸¸è§„ç¼–å†™ æ˜ç¡®çš„è¿”å›å€¼</code></pre><h3 id="è¿”å›å¯¹è±¡å­—é¢é‡"><a href="#è¿”å›å¯¹è±¡å­—é¢é‡" class="headerlink" title="è¿”å›å¯¹è±¡å­—é¢é‡"></a>è¿”å›å¯¹è±¡å­—é¢é‡</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">var func &#x3D; () &#x3D;&gt; &#123; foo: 1 &#125;;&#x2F;&#x2F; Calling func() returns undefined!var func &#x3D; () &#x3D;&gt; &#123; foo: function() &#123;&#125; &#125;;&#x2F;&#x2F; SyntaxError: function statement requires a name</code></pre><p>èŠ±æ‹¬å·ï¼ˆ{} ï¼‰é‡Œé¢çš„ä»£ç è¢«è§£æä¸ºä¸€ç³»åˆ—è¯­å¥ï¼ˆå³ foo è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œè€Œéå¯¹è±¡å­—é¢é‡çš„ç»„æˆéƒ¨åˆ†ï¼‰ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var func &#x3D; () &#x3D;&gt; (&#123; foo: 1 &#125;);</code></pre><h3 id="æ³¨æ„æ¢è¡Œ"><a href="#æ³¨æ„æ¢è¡Œ" class="headerlink" title="æ³¨æ„æ¢è¡Œ"></a>æ³¨æ„æ¢è¡Œ</h3><p><span style="color: red">å¹¸è¿çš„æ˜¯ï¼švscode Prettier - Code formatter æ’ä»¶ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç </span></p><p><strong>ç®­å¤´å‡½æ•°åœ¨å‚æ•°å’Œç®­å¤´ä¹‹é—´ä¸èƒ½æ¢è¡Œã€‚</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var func &#x3D; ()           &#x3D;&gt; 1;&#x2F;&#x2F; SyntaxError: expected expression, got &#39;&#x3D;&gt;&#39;</code></pre><p><strong>å¯ä»¥é€šè¿‡åœ¨ â€˜&#x3D;&gt;â€™ ä¹‹åæ¢è¡Œï¼Œæˆ–è€…ç”¨ â€˜( )â€™ã€â€™{ }â€™æ¥å®ç°æ¢è¡Œï¼Œå¦‚ä¸‹ï¼š</strong></p><pre class="line-numbers language-none"><code class="language-none">var func &#x3D; (a, b, c) &#x3D;&gt;  1;var func &#x3D; (a, b, c) &#x3D;&gt; (  1);var func &#x3D; (a, b, c) &#x3D;&gt; &#123;  return 1&#125;;var func &#x3D; (  a,  b,  c) &#x3D;&gt; 1;&#x2F;&#x2F; ä¸ä¼šæœ‰è¯­æ³•é”™è¯¯</code></pre><h3 id="ä¸åŒäºæ™®é€šå‡½æ•°çš„è§£æé¡ºåº"><a href="#ä¸åŒäºæ™®é€šå‡½æ•°çš„è§£æé¡ºåº" class="headerlink" title="ä¸åŒäºæ™®é€šå‡½æ•°çš„è§£æé¡ºåº"></a>ä¸åŒäºæ™®é€šå‡½æ•°çš„è§£æé¡ºåº</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">let callback;callback &#x3D; callback || function() &#123;&#125;; &#x2F;&#x2F; okcallback &#x3D; callback || () &#x3D;&gt; &#123;&#125;;&#x2F;&#x2F; SyntaxError: invalid arrow-function argumentscallback &#x3D; callback || (() &#x3D;&gt; &#123;&#125;);    &#x2F;&#x2F; ok</code></pre><h3 id="ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨æ¡ä»¶ï¼ˆä¸‰å…ƒï¼‰è¿ç®—ç¬¦"><a href="#ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨æ¡ä»¶ï¼ˆä¸‰å…ƒï¼‰è¿ç®—ç¬¦" class="headerlink" title="ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨æ¡ä»¶ï¼ˆä¸‰å…ƒï¼‰è¿ç®—ç¬¦"></a>ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨æ¡ä»¶ï¼ˆä¸‰å…ƒï¼‰è¿ç®—ç¬¦</h3><h3 id="ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨é—­åŒ…"><a href="#ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨é—­åŒ…" class="headerlink" title="ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨é—­åŒ…"></a>ç®­å¤´å‡½æ•°å¯ä»¥ä½¿ç”¨é—­åŒ…</h3><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/arguments" target="_blank" >Web å¼€å‘æŠ€æœ¯&#x2F;JavaScript&#x2F;JavaScript å‚è€ƒ&#x2F;å‡½æ•°&#x2F;arguments å¯¹è±¡</a></p><p><a href="https://www.ruanyifeng.com/blog/2013/01/javascript_strict_mode.html" target="_blank" >Javascript ä¸¥æ ¼æ¨¡å¼è¯¦è§£</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" >Web å¼€å‘æŠ€æœ¯&#x2F;JavaScript&#x2F;JavaScript å‚è€ƒ&#x2F;å‡½æ•°&#x2F;ç®­å¤´å‡½æ•°</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-æ€§èƒ½ä¼˜åŒ–2</title>
      <link href="//post/2022-07-27%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html"/>
      <url>//post/2022-07-27%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸ºä»€ä¹ˆé€Ÿåº¦å¾ˆé‡è¦"><a href="#ä¸ºä»€ä¹ˆé€Ÿåº¦å¾ˆé‡è¦" class="headerlink" title="ä¸ºä»€ä¹ˆé€Ÿåº¦å¾ˆé‡è¦"></a>ä¸ºä»€ä¹ˆé€Ÿåº¦å¾ˆé‡è¦</h2><ul><li>ç”¨æˆ·è¦æ±‚å˜é«˜ï¼Œçˆ±æŒ‘æ¯›ç—…</li><li>æ€§èƒ½æ˜¯ç•™ä½ç”¨æˆ·çš„å…³é”®</li><li>æ€§èƒ½æ„å‘³ç€æé«˜è½¬åŒ–ç‡</li><li>æ€§èƒ½å…³ä¹ç”¨æˆ·ä½“éªŒ</li><li>æ€§èƒ½å½±å“äººä»¬</li></ul><details class="custom-details"><summary>æŸ¥çœ‹æ›´å¤š</summary><p>æ¶ˆè´¹è€…è¶Šæ¥è¶Šä¾èµ–ç§»åŠ¨è®¾å¤‡æ¥è®¿é—®æ•°å­—å†…å®¹å’ŒæœåŠ¡ï¼Œå¦‚æœæ‚¨æŸ¥çœ‹è‡ªå·±ç«™ç‚¹çš„åˆ†æï¼Œå¯èƒ½ä¼šçœ‹åˆ°è¿™ä¸ªæ•…äº‹æ­£åœ¨æ‚¨è‡ªå·±çš„æ•°æ®ä¸­ä¸Šæ¼”ã€‚æ¶ˆè´¹è€…ä¹Ÿæ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½è¦æ±‚æ›´é«˜ï¼Œ<strong>å½“ä»–ä»¬æƒè¡¡æ‚¨ç½‘ç«™ä¸Šçš„ä½“éªŒæ—¶ï¼Œä»–ä»¬ä¸ä»…ä»…å°†æ‚¨ä¸æ‚¨çš„ç«äº‰å¯¹æ‰‹è¿›è¡Œæ¯”è¾ƒï¼Œä»–ä»¬è¿˜ä¼šæ ¹æ®ä»–ä»¬æ¯å¤©ä½¿ç”¨çš„ä¸€æµæœåŠ¡å¯¹æ‚¨è¿›è¡Œè¯„çº§</strong>ã€‚</p><p><strong>æ€§èƒ½æ˜¯ç•™ä½ç”¨æˆ·çš„å…³é”®</strong></p><p>æ€§èƒ½ç›´æ¥å½±å“å…¬å¸çš„å‘½è¿. æ€§èƒ½åœ¨ä»»ä½•åœ¨çº¿ä¼ä¸šçš„æˆåŠŸä¸­éƒ½èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚é«˜æ€§èƒ½ç½‘ç«™æ¯”ä½æ€§èƒ½ç½‘ç«™æ›´èƒ½å¸å¼•å’Œç•™ä½ç”¨æˆ·ã€‚</p><p>ç ”ç©¶è¿˜è¡¨æ˜ï¼Œæ€§èƒ½ä¸ä½³ä¼šå¯¹ä¸šåŠ¡ç›®æ ‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚ä¾‹å¦‚ï¼Œ</p><ul><li><code>Pinterest</code> å°†æ„ŸçŸ¥ç­‰å¾…æ—¶é—´å‡å°‘äº† 40%ï¼Œè¿™å°†æœç´¢å¼•æ“æµé‡å’Œæ³¨å†Œé‡å¢åŠ äº† 15% ã€‚</li><li><code>COOK</code> å°†é¡µé¢å¹³å‡åŠ è½½æ—¶é—´å‡å°‘äº† 850 æ¯«ç§’ï¼Œä»è€Œå°†è½¬åŒ–æ¬¡æ•°æé«˜äº† 7%ï¼Œå°†è·³å‡ºç‡é™ä½äº† 7%ï¼Œå¹¶å°†æ¯ä¸ªä¼šè¯çš„é¡µé¢å¢åŠ äº† 10% ã€‚</li><li><code>BBC</code> å‘ç°ä»–ä»¬çš„ç½‘ç«™åŠ è½½æ—¶é—´æ¯å¢åŠ ä¸€ç§’ï¼Œä»–ä»¬å°±ä¼šå¤±å» 10% çš„ç”¨æˆ·ã€‚</li></ul><p><strong>æ€§èƒ½æ„å‘³ç€æé«˜è½¬åŒ–ç‡</strong></p><p>ç•™ä½ç”¨æˆ·å¯¹äºæé«˜è½¬åŒ–ç‡è‡³å…³é‡è¦ã€‚æ…¢é€Ÿç½‘ç«™å¯¹æ”¶å…¥æœ‰è´Ÿé¢å½±å“ï¼Œè€Œå¿«é€Ÿç½‘ç«™æ˜¾ç¤ºå¯ä»¥æé«˜è½¬åŒ–ç‡ã€‚</p><p>ä¾‹å¦‚ï¼š</p><ul><li><p>å¯¹äº <code>Mobify</code> è€Œè¨€ï¼Œä¸»é¡µåŠ è½½é€Ÿåº¦æ¯æé«˜ 100 æ¯«ç§’ï¼ŒåŸºäºä¼šè¯çš„è½¬åŒ–ç‡å°±ä¼šå¢åŠ  1.11%ï¼Œå¹³å‡å¹´æ”¶å…¥å¢åŠ è¿‘ 380,000 ç¾å…ƒã€‚æ­¤å¤–ï¼Œç»“è´¦é¡µé¢åŠ è½½é€Ÿåº¦æ¯æé«˜ 100 æ¯«ç§’ï¼ŒåŸºäºä¼šè¯çš„è½¬åŒ–ç‡å°±ä¼šå¢åŠ  1.55%ï¼Œä»è€Œä½¿å¹´å‡æ”¶å…¥å¢åŠ è¿‘ 530,000 ç¾å…ƒã€‚</p></li><li><p>å½“ <code>AutoAnything</code> å°†é¡µé¢åŠ è½½æ—¶é—´å‡å°‘ä¸€åŠæ—¶ï¼Œä»–ä»¬çš„é”€å”®é¢å¢é•¿äº† 12% åˆ° 13%ã€‚</p></li><li><p>é›¶å”®å•† <code>Furniture Village </code>å®¡æ ¸äº†ä»–ä»¬çš„ç½‘ç«™é€Ÿåº¦ï¼Œå¹¶åˆ¶å®šäº†è§£å†³ä»–ä»¬å‘ç°çš„é—®é¢˜çš„è®¡åˆ’ï¼Œå¯¼è‡´é¡µé¢åŠ è½½æ—¶é—´é™ä½äº† 20%ï¼Œè½¬åŒ–ç‡æé«˜äº† 10%ã€‚</p></li></ul><p><strong>æ€§èƒ½å…³ä¹ç”¨æˆ·ä½“éªŒ</strong></p><p>æ€§èƒ½æ˜¯è‰¯å¥½ç”¨æˆ·ä½“éªŒçš„åŸºç¡€ã€‚å½“ç½‘ç«™å‘å¸ƒå¤§é‡ä»£ç æ—¶ï¼Œæµè§ˆå™¨å¿…é¡»ä½¿ç”¨ç”¨æˆ·æ•°ä»¥ç™¾ä¸‡è®¡çš„æ•°æ®è®¡ç®—æ‰èƒ½ä¸‹è½½ä»£ç ã€‚ç§»åŠ¨è®¾å¤‡çš„ CPU èƒ½åŠ›å’Œå†…å­˜æœ‰é™ã€‚å®ƒä»¬ç»å¸¸è¢«æˆ‘ä»¬è®¤ä¸ºæ‰€è°“çš„â€œå°‘é‡â€æœªä¼˜åŒ–çš„ä»£ç æ‰€æ·¹æ²¡ã€‚è¿™ä¼šå¯¼è‡´æ€§èƒ½ä¸ä½³ï¼Œä»è€Œå¯¼è‡´æ— å“åº”ã€‚äº†è§£æˆ‘ä»¬äººç±»çš„è¡Œä¸ºåå°±ä¼šçŸ¥é“ï¼Œç”¨æˆ·åªæœ‰å¯¹ä½æ€§èƒ½çš„åº”ç”¨ç¨‹åºå¿æ— å¯å¿æ—¶æ‰ä¼šé€‰æ‹©æ”¾å¼ƒã€‚</p><p><strong>æ€§èƒ½å½±å“äººä»¬</strong></p><p>æ€§èƒ½ä¸ä½³çš„ç½‘ç«™å’Œåº”ç”¨ç¨‹åºä¹Ÿä¼šç»™ä½¿ç”¨å®ƒä»¬çš„äººä»¬å¸¦æ¥å®é™…æˆæœ¬</p><p>éšç€ç§»åŠ¨ç”¨æˆ·ç»§ç»­åœ¨å…¨çƒäº’è”ç½‘ç”¨æˆ·ä¸­å æ®æ›´å¤§æ¯”ä¾‹ï¼Œè¯·åŠ¡å¿…è®°ä½ï¼Œå…¶ä¸­è®¸å¤šç”¨æˆ·é€šè¿‡ç§»åŠ¨ LTEã€4Gã€3G ç”šè‡³ 2G ç½‘ç»œè®¿é—®äº’è”ç½‘ã€‚æ­£å¦‚ Calibre çš„ Ben Schwarz åœ¨å…³äºç°å®ä¸–ç•Œæ€§èƒ½çš„ç ”ç©¶ä¸­æŒ‡å‡ºçš„é‚£æ ·ï¼Œé¢„ä»˜è´¹æ•°æ®è®¡åˆ’çš„æˆæœ¬æ­£åœ¨ä¸‹é™ï¼Œè¿™åè¿‡æ¥åˆä½¿å¾—è¿‡å»æ— æ³•è´Ÿæ‹…çš„åœ°æ–¹å¼€å§‹æœ‰èƒ½åŠ›è®¿é—®äº’è”ç½‘ã€‚ç§»åŠ¨è®¾å¤‡å’Œäº’è”ç½‘æ¥å…¥ä¸å†æ˜¯å¥¢ä¾ˆå“ã€‚å®ƒä»¬æ˜¯æ—¥ç›Šäº’è”çš„ä¸–ç•Œä¸­å¯¼èˆªå’Œå‘æŒ¥ä½œç”¨æ‰€å¿…éœ€çš„å¸¸ç”¨å·¥å…·ã€‚</p><p>è‡³å°‘è‡ª 2011 å¹´ä»¥æ¥ï¼Œæ€»é¡µé¢å¤§å°ä¸€ç›´åœ¨ç¨³æ­¥å¢åŠ ï¼Œè€Œä¸”è¿™ç§è¶‹åŠ¿ä¼¼ä¹è¿˜åœ¨ç»§ç»­ã€‚éšç€å…¸å‹é¡µé¢å‘é€æ›´å¤šæ•°æ®ï¼Œç”¨æˆ·å¿…é¡»æ›´é¢‘ç¹åœ°è¡¥å……ä»–ä»¬çš„è®¡é‡æ•°æ®è®¡åˆ’ï¼Œè¿™ä¼šèŠ±è´¹ä»–ä»¬çš„èµ„é‡‘ã€‚</p><p>é™¤äº†ä¸ºç”¨æˆ·èŠ‚çœèµ„é‡‘å¤–ï¼Œå¿«é€Ÿå’Œè½»é‡çº§çš„ç”¨æˆ·ä½“éªŒå¯¹äºå¤„äºå±æœºä¸­çš„ç”¨æˆ·ä¹Ÿè‡³å…³é‡è¦ã€‚åŒ»é™¢ã€è¯Šæ‰€å’Œå±æœºä¸­å¿ƒç­‰å…¬å…±èµ„æºæ‹¥æœ‰åœ¨çº¿èµ„æºï¼Œå¯ä¸ºç”¨æˆ·æä¾›ä»–ä»¬åœ¨å±æœºæœŸé—´æ‰€éœ€çš„é‡è¦å’Œå…·ä½“ä¿¡æ¯ã€‚è™½ç„¶è®¾è®¡å¯¹äºåœ¨å‹åŠ›æ—¶åˆ»æœ‰æ•ˆåœ°å‘ˆç°é‡è¦ä¿¡æ¯è‡³å…³é‡è¦ï¼Œä½†ä¸èƒ½ä½ä¼°å¿«é€Ÿä¼ é€’è¿™äº›ä¿¡æ¯çš„é‡è¦æ€§ã€‚è¿™æ˜¯æˆ‘ä»¬å·¥ä½œçš„ä¸€éƒ¨åˆ†ã€‚</p></details><h2 id="æ€§èƒ½ä¼˜åŒ–åŸºç¡€"><a href="#æ€§èƒ½ä¼˜åŒ–åŸºç¡€" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–åŸºç¡€"></a>æ€§èƒ½ä¼˜åŒ–åŸºç¡€</h2><p>æœ€ä½³å®è·µï¼ˆä¸ªäººè§‰å¾—æŒ‰ç…§<code>performance</code> API æ¥èŠæ€§èƒ½ä¼˜åŒ–æ›´è´´åˆ‡ï¼‰</p><ul><li>ä»å­¦ä¹ æµè§ˆå™¨çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/Performance/Critical_rendering_path" target="_blank" ><code>å…³é”®æ¸²æŸ“è·¯å¾„(CRP- Critical rendering path)</code></a> å¼€å§‹ã€‚äº†è§£è¿™äº›ä¼šå¸®åŠ©ä½ é€šæ™“å¦‚ä½•æå‡æµè§ˆå™¨çš„æ€§èƒ½ã€‚</li><li>ä½¿ç”¨ <code>èµ„æºæç¤ºï¼ˆresource hintsï¼‰</code> ä¾‹å¦‚ ï¼ˆ<strong>é¢„è¿æ¥ã€é¢„è·å–ã€é¢„åŠ è½½</strong>ï¼‰ <code>rel=preconnect</code>, <code>rel=dns-prefetch</code>, <code>rel=prefetch</code>, and <code>rel=preload</code></li><li>å‹ç¼© <code>Js ä»£ç </code>è‡³æœ€å°ã€‚åªä¸ºå½“å‰é¡µé¢åŠ è½½éœ€è¦ä½¿ç”¨åˆ°çš„ js ä»£ç </li><li><code>CSS æ€§èƒ½å› ç´ </code></li><li>åœ¨ä½ çš„æœåŠ¡å™¨ï¼ˆæˆ–è€… CDNï¼‰ä¸Šä½¿ç”¨ <code>HTTP/2</code> åè®®</li><li>ä½¿ç”¨ <code>CDN</code> æ‰˜ç®¡é™æ€èµ„æºï¼Œè¿™æ ·å¯ä»¥æ˜¾è‘—å‡å°‘åŠ è½½æ—¶é—´</li><li>ä½¿ç”¨ <code>gzip</code>, <code>Brotli</code> æˆ–è€… <code>Zopfli</code> å‹ç¼©æ‚¨çš„èµ„æº</li><li>å›¾ç‰‡ä¼˜åŒ–ï¼ˆå¦‚æœå¯ä»¥ï¼Œå°½å¯èƒ½ä½¿ç”¨ css åŠ¨ç”»æˆ–è€… svgï¼‰</li><li>åœ¨è¶…å‡ºåº”ç”¨è§†å£èŒƒå›´çš„éƒ¨åˆ†ä½¿ç”¨æ‡’åŠ è½½ï¼Œå¦‚æœä½ è¿™ä¹ˆåšäº†ï¼Œä¸º SEO åˆ¶å®šä¸€ä¸ªåå¤‡è®¡åˆ’ï¼ˆä¾‹å¦‚ä¸º bot traffic æ¸²æŸ“æ•´ä¸ªé¡µé¢ï¼‰</li></ul><h2 id="CSS-æ€§èƒ½ä¼˜åŒ–"><a href="#CSS-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="CSS æ€§èƒ½ä¼˜åŒ–"></a>CSS æ€§èƒ½ä¼˜åŒ–</h2><ul><li><p>é˜»å¡æ¸²æŸ“ä¼˜åŒ–</p></li><li><p>åœ¨ GPU ä¸Šå‘ˆç°åŠ¨ç”»</p></li><li><p>will-change å±æ€§</p></li><li><p>font-display å±æ€§</p></li><li><p>contain å±æ€§</p></li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>é¡µé¢åœ¨æ ·å¼æ²¡æœ‰æ¸²æŸ“å®Œæ¯•çš„æƒ…å†µä¸‹è¢«ç»˜åˆ¶ï¼Œåœ¨æ ·å¼æ¸²æŸ“å®Œæ¯•ååˆè¢«åˆ·æ–°ï¼Œè¿™å¤§æ¦‚æ˜¯å¾ˆç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒ <code>FOUC - Flash Of Unstyled Content æ–‡æ¡£æ ·å¼é—ªçƒ</code>ã€‚å› æ­¤ï¼Œé™¤éæµè§ˆå™¨çŸ¥é“å½“å‰ä¸éœ€è¦ è¯¥ CSSï¼Œå¦åˆ™ è¯¥ CSS å°†é˜»æ­¢æ¸²æŸ“ã€‚æµè§ˆå™¨åªä¼šåœ¨ä¸‹è½½ CSS å’Œæ„å»º CSSOM ä¹‹åç»˜åˆ¶é¡µé¢ã€‚<strong>æµè§ˆå™¨éµå¾ªç‰¹å®šçš„æ¸²æŸ“è·¯å¾„</strong>ï¼šç»˜åˆ¶ paint ä»…åœ¨å¸ƒå±€ layout ä¹‹åè¿›è¡Œï¼Œå¸ƒå±€ layout åˆ™åœ¨åˆ›å»ºæ¸²æŸ“æ ‘ render tree ä¹‹åè¿›è¡Œï¼Œåˆ›å»ºæ¸²æŸ“æ ‘åˆ™éœ€è¦åœ¨ DOM å’Œ CSSOM æ ‘è§£æå®Œæˆåè¿›è¡Œã€‚</p></blockquote><p><strong>æµè§ˆå™¨éµå¾ªç‰¹å®šçš„æ¸²æŸ“è·¯å¾„</strong></p><ol><li>ä¸‹è½½ CSS</li><li>DOM å’Œ CSSOM æ ‘è§£æå®Œæˆ</li><li>åˆ›å»ºæ¸²æŸ“æ ‘ render tree</li><li>å¸ƒå±€ layout</li><li>ç»˜åˆ¶ paint</li></ol><p><strong>ä¼˜åŒ–æ–¹å‘</strong></p><p>ä¸ºäº†ä¼˜åŒ– CSSOM çš„æ„é€ ï¼Œ<code>è¯·åˆ é™¤ä¸å¿…è¦çš„æ ·å¼</code>ï¼Œ<code>å¯¹ CSS è¿›è¡Œæœ€å°åŒ–ï¼Œå‹ç¼©å’Œç¼“å­˜</code>ï¼Œ<code>å¹¶å°†é¡µé¢åŠ è½½æ—¶ä¸éœ€è¦çš„ CSS æ‹†åˆ†ä¸ºå…¶ä»–æ–‡ä»¶ï¼Œä»¥å‡å°‘ CSS æ¸²æŸ“é˜»å¡</code>ã€‚</p><h3 id="é˜»å¡æ¸²æŸ“ä¼˜åŒ–"><a href="#é˜»å¡æ¸²æŸ“ä¼˜åŒ–" class="headerlink" title="é˜»å¡æ¸²æŸ“ä¼˜åŒ–"></a>é˜»å¡æ¸²æŸ“ä¼˜åŒ–</h3><p>CSS å¯ä»¥ä½¿ç”¨åª’ä½“æŸ¥è¯¢å°†æ ·å¼åº”ç”¨åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ã€‚åª’ä½“æŸ¥è¯¢å¯¹äºå“åº”å¼ Web è®¾è®¡éå¸¸é‡è¦ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ã€‚æµè§ˆå™¨ä¼šé˜»å¡æ¸²æŸ“ï¼Œç›´åˆ°å®ƒè§£æå®Œå…¨éƒ¨çš„æ ·å¼ï¼Œä½†ä¸ä¼šé˜»å¡æ¸²æŸ“å®ƒè®¤ä¸ºä¸ä¼šä½¿ç”¨çš„æ ·å¼ï¼Œä¾‹å¦‚æ‰“å°æ ·å¼è¡¨ã€‚é€šè¿‡åŸºäºåª’ä½“æŸ¥è¯¢å°† CSS åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œå¯ä»¥é˜²æ­¢åœ¨ä¸‹è½½æœªä½¿ç”¨çš„ CSS æœŸé—´é˜»æ­¢æ¸²æŸ“ã€‚ä¸ºäº†åˆ›å»ºéé˜»å¡ CSS é“¾æ¥ï¼Œå°†ä¸ä¼šç«‹å³ä½¿ç”¨çš„æ ·å¼ï¼ˆä¾‹å¦‚æ‰“å°æ ·å¼ï¼‰ç§»åŠ¨åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œå°† <link> æ·»åŠ åˆ° HTML ä¸­ï¼Œå¹¶æ·»åŠ åª’ä½“æŸ¥è¯¢ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è¯´æ˜å®ƒæ˜¯æ‰“å°æ ·å¼è¡¨ã€‚</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;styles.css&quot; &#x2F;&gt;&lt;!-- blocking --&gt;&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;print.css&quot; media&#x3D;&quot;print&quot; &#x2F;&gt;&lt;!-- not blocking --&gt;&lt;link  rel&#x3D;&quot;stylesheet&quot;  href&#x3D;&quot;mobile.css&quot;  media&#x3D;&quot;screen and (max-width: 480px)&quot;&#x2F;&gt;&lt;!-- not blocking on large screens --&gt;</code></pre><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å‡è®¾æ¯ä¸ªæŒ‡å®šçš„æ ·å¼è¡¨éƒ½æ˜¯é˜»å¡æ¸²æŸ“çš„ã€‚é€šè¿‡æ·»åŠ  media å±æ€§é™„åŠ åª’ä½“æŸ¥è¯¢ï¼Œå‘Šè¯‰æµè§ˆå™¨ä½•æ—¶åº”ç”¨æ ·å¼è¡¨ã€‚<strong>å½“æµè§ˆå™¨çœ‹åˆ°ä¸€ä¸ªå®ƒçŸ¥é“åªä¼šç”¨äºç‰¹å®šåœºæ™¯çš„æ ·å¼è¡¨æ—¶ï¼Œå®ƒä»ä¼šä¸‹è½½æ ·å¼ï¼Œä½†ä¸ä¼šé˜»å¡æ¸²æŸ“</strong>ã€‚é€šè¿‡å°† CSS åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œä¸»è¦çš„ é˜»å¡æ¸²æŸ“ æ–‡ä»¶ï¼ˆæœ¬ä¾‹ä¸­ä¸º styles.cssï¼‰çš„å¤§å°å˜å¾—æ›´å°ï¼Œä»è€Œå‡å°‘äº†æ¸²æŸ“è¢«é˜»å¡çš„æ—¶é—´ã€‚</p><h3 id="åœ¨-GPU-ä¸Šå‘ˆç°åŠ¨ç”»"><a href="#åœ¨-GPU-ä¸Šå‘ˆç°åŠ¨ç”»" class="headerlink" title="åœ¨ GPU ä¸Šå‘ˆç°åŠ¨ç”»"></a>åœ¨ GPU ä¸Šå‘ˆç°åŠ¨ç”»</h3><p>æµè§ˆå™¨é’ˆå¯¹å¤„ç† CSS åŠ¨ç”»å’Œä¸ä¼šå¾ˆå¥½åœ°è§¦å‘é‡æ’ï¼ˆå› æ­¤ä¹Ÿå¯¼è‡´é‡æ–°ç»˜åˆ¶ï¼‰çš„åŠ¨ç”»å±æ€§è¿›è¡Œäº†ä¼˜åŒ–ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯ä»¥å°†è¢«åŠ¨ç”»åŒ–çš„èŠ‚ç‚¹ä»ä¸»çº¿ç¨‹ç§»åˆ° GPU ä¸Šã€‚å°†å¯¼è‡´åˆæˆçš„å±æ€§åŒ…æ‹¬ <code>3D transforms (transform: translateZ(), rotate3d()ï¼Œetc.)</code>ï¼Œ<code>animating transform</code> å’Œ <code>opacity</code>,<code> position: fixed</code>ï¼Œ<code>will-change</code>ï¼Œå’Œ <code>filter</code>ã€‚ä¸€äº›å…ƒç´ ï¼Œä¾‹å¦‚ <code>&lt;video&gt;</code>, <code>&lt;canvas&gt;</code> å’Œ <code>&lt;iframe&gt;</code>ï¼Œ<span style="color: red">ä¹Ÿä½äºå„è‡ªçš„å›¾å±‚ä¸Š</span>ã€‚ å°†å…ƒç´ æå‡ä¸ºå›¾å±‚ï¼ˆä¹Ÿç§°ä¸ºåˆæˆï¼‰æ—¶ï¼ŒåŠ¨ç”»è½¬æ¢å±æ€§å°†åœ¨ GPU ä¸­å®Œæˆï¼Œä»è€Œæ”¹å–„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šã€‚</p><p><strong>é¢ï½ï¼Œæ€ä¹ˆçœ‹åƒä¸â€œå±‚å ä¸Šä¸‹æ–‡â€æœ‰å…³å‘¢ï¼Œ 7 é˜¶å±‚å  ï¼Ÿ</strong> <a href="http://v.aijs.top/post/2022-07-17css" target="_blank" >è§</a></p><h3 id="will-change-å±æ€§"><a href="#will-change-å±æ€§" class="headerlink" title="will-change å±æ€§"></a>will-change å±æ€§</h3><p>CSS will-change å±æ€§å‘Šè¯‰æµè§ˆå™¨å…ƒç´ çš„å“ªäº›å±æ€§éœ€è¦ä¿®æ”¹ï¼Œä½¿æµè§ˆå™¨èƒ½å¤Ÿåœ¨å…ƒç´ å®é™…æ›´æ”¹ä¹‹å‰è®¾ç½®ä¼˜åŒ–ï¼Œé€šè¿‡åœ¨å®é™…æ›´æ”¹å‰æ‰§è¡Œè€—æ—¶çš„å·¥ä½œä»¥æå‡æ€§èƒ½ã€‚</p><pre class="line-numbers language-css" data-language="css"><code class="language-css">will-change: opacity, transform;</code></pre><p>ä¸â€œå±‚å ä¸Šä¸‹æ–‡â€æœ‰å…³</p><h3 id="font-display-å±æ€§"><a href="#font-display-å±æ€§" class="headerlink" title="font-display å±æ€§"></a>font-display å±æ€§</h3><p>æ ¹æ® <code>@font-face</code> è§„åˆ™ï¼Œ<code>font-display</code> å±æ€§å®šä¹‰äº†æµè§ˆå™¨å¦‚ä½•åŠ è½½å’Œæ˜¾ç¤ºå­—ä½“æ–‡ä»¶ï¼Œ<strong>å…è®¸æ–‡æœ¬åœ¨å­—ä½“åŠ è½½æˆ–åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºå›é€€å­—ä½“</strong>ã€‚å¯ä»¥é€šè¿‡ä¾é æŠ˜ä¸­æ— æ ·å¼æ–‡æœ¬é—ªç°ä½¿æ–‡æœ¬å¯è§æ›¿ä»£ç™½å±æ¥æé«˜æ€§èƒ½ã€‚</p><pre class="line-numbers language-css" data-language="css"><code class="language-css">@font-face &#123;  font-family: someFont;  src: url(&#x2F;path&#x2F;to&#x2F;fonts&#x2F;someFont.woff) format(&quot;woff&quot;);  font-weight: 400;  font-style: normal;  font-display: fallback; &#x2F;&#x2F; å›æ»š&#125;</code></pre><h3 id="contain-å±æ€§"><a href="#contain-å±æ€§" class="headerlink" title="contain å±æ€§"></a>contain å±æ€§</h3><p>CSS çš„ contain å±æ€§å…è®¸ä½œè€…æŒ‡ç¤º<code>å…ƒç´ åŠå…¶å†…å®¹å°½å¯èƒ½ç‹¬ç«‹äºæ–‡æ¡£æ ‘çš„å…¶ä½™éƒ¨åˆ†</code>ã€‚è¿™å…è®¸æµè§ˆå™¨é’ˆå¯¹ DOM çš„æœ‰é™åŒºåŸŸè€Œä¸æ˜¯æ•´ä¸ªé¡µé¢é‡æ–°è®¡ç®—å¸ƒå±€ï¼Œæ ·å¼ï¼Œç»˜ç”»ï¼Œå¤§å°æˆ–å®ƒä»¬çš„ä»»æ„ç»„åˆã€‚</p><p><strong>ä¼ªå…ƒç´ </strong></p><h2 id="æ€§èƒ½è¡¡é‡"><a href="#æ€§èƒ½è¡¡é‡" class="headerlink" title="æ€§èƒ½è¡¡é‡"></a>æ€§èƒ½è¡¡é‡</h2><p><a href="http://v.aijs.top/post/2022-05-12performance" target="_blank" >å‰ç«¯åŸºç¡€-æ€§èƒ½ä¼˜åŒ–1</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Learn/Performance/CSS" target="_blank" >ç«ç‹å®¶çš„ MDN CSS æ€§èƒ½ä¼˜åŒ–</a></p><p><a href="https://web.dev/i18n/zh/why-speed-matters/" target="_blank" >google å®¶çš„ web.dev why-speed-matters</a></p><p><a href="https://www.cnblogs.com/zhimao/p/15068536.html" target="_blank" >(åä¸‰) æ€§èƒ½ä¼˜åŒ– CRP </a></p><p><a href="https://blog.csdn.net/gongzhuxiaoxin/article/details/52454143" target="_blank" >ä»€ä¹ˆæ˜¯ FOUCï¼ˆæ— æ ·å¼å†…å®¹é—ªçƒï¼‰ï¼Ÿä½ å¦‚ä½•æ¥é¿å… FOUCï¼Ÿ</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> performance </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-http è¿æ¥ç®¡ç†</title>
      <link href="//post/2022-07-26http-connect.html"/>
      <url>//post/2022-07-26http-connect.html</url>
      
        <content type="html"><![CDATA[<h2 id="HTTP-x2F-1-x-çš„è¿æ¥ç®¡ç†"><a href="#HTTP-x2F-1-x-çš„è¿æ¥ç®¡ç†" class="headerlink" title="HTTP&#x2F;1.x çš„è¿æ¥ç®¡ç†"></a>HTTP&#x2F;1.x çš„è¿æ¥ç®¡ç†</h2><img src="http://t-blog-images.aijs.top/img/20220726221631.png" style="max-width:450px"/><h3 id="çŸ­è¿æ¥"><a href="#çŸ­è¿æ¥" class="headerlink" title="çŸ­è¿æ¥"></a>çŸ­è¿æ¥</h3><ul><li>HTTP&#x2F;1.0 é»˜è®¤æ˜¯çŸ­è¿æ¥(<code>å†·è¿æ¥</code>),æ¯ä¸€ä¸ª HTTP è¯·æ±‚éƒ½ç”±å®ƒè‡ªå·±ç‹¬ç«‹çš„è¿æ¥å®Œæˆ,</li><li>TCP åè®®æ¡æ‰‹è€—è´¹æ—¶é—´,TCP å¯ä»¥ä¿æŒæ›´å¤šçš„<code>çƒ­è¿æ¥</code>æ¥é€‚åº”è´Ÿè½½</li></ul><details class="custom-details"><summary>æŸ¥çœ‹æ›´å¤š</summary><p>HTTP æœ€æ—©æœŸçš„æ¨¡å‹ï¼Œä¹Ÿæ˜¯ HTTP&#x2F;1.0 çš„é»˜è®¤æ¨¡å‹ï¼Œæ˜¯çŸ­è¿æ¥ã€‚æ¯ä¸€ä¸ª HTTP è¯·æ±‚éƒ½ç”±å®ƒè‡ªå·±ç‹¬ç«‹çš„è¿æ¥å®Œæˆï¼›è¿™æ„å‘³ç€å‘èµ·æ¯ä¸€ä¸ª HTTP è¯·æ±‚ä¹‹å‰éƒ½ä¼šæœ‰ä¸€æ¬¡ TCP æ¡æ‰‹ï¼Œè€Œä¸”æ˜¯è¿ç»­ä¸æ–­çš„ã€‚</p><p>TCP åè®®æ¡æ‰‹æœ¬èº«å°±æ˜¯è€—è´¹æ—¶é—´çš„ï¼Œæ‰€ä»¥ TCP å¯ä»¥ä¿æŒæ›´å¤šçš„çƒ­è¿æ¥æ¥é€‚åº”è´Ÿè½½ã€‚çŸ­è¿æ¥ç ´åäº† TCP å…·å¤‡çš„èƒ½åŠ›ï¼Œæ–°çš„<code>å†·è¿æ¥</code>é™ä½äº†å…¶æ€§èƒ½ã€‚</p><p>è¿™æ˜¯ HTTP&#x2F;1.0 çš„é»˜è®¤æ¨¡å‹ (å¦‚æœæ²¡æœ‰æŒ‡å®š Connection åè®®å¤´ï¼Œæˆ–è€…æ˜¯å€¼è¢«è®¾ç½®ä¸º close)ã€‚è€Œåœ¨ HTTP&#x2F;1.1 ä¸­ï¼Œåªæœ‰å½“ Connection è¢«è®¾ç½®ä¸º close æ—¶æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ¨¡å‹ã€‚</p></details><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p><span style="color: red">é™¤éæ˜¯è¦å…¼å®¹ä¸€ä¸ªéå¸¸å¤è€çš„ï¼Œä¸æ”¯æŒé•¿è¿æ¥çš„ç³»ç»Ÿï¼Œæ²¡æœ‰ä¸€ä¸ªä»¤äººä¿¡æœçš„ç†ç”±ç»§ç»­ä½¿ç”¨è¿™ä¸ªæ¨¡å‹ã€‚</span></p></div><h3 id="é•¿è¿æ¥"><a href="#é•¿è¿æ¥" class="headerlink" title="é•¿è¿æ¥"></a>é•¿è¿æ¥</h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>è§£å†³<code>çŸ­è¿æ¥</code>çš„ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼š</p><ul><li>åˆ›å»ºæ–°è¿æ¥è€—è´¹çš„æ—¶é—´å°¤ä¸ºæ˜æ˜¾ï¼Œ</li><li>TCP è¿æ¥çš„æ€§èƒ½åªæœ‰åœ¨è¯¥è¿æ¥è¢«ä½¿ç”¨ä¸€æ®µæ—¶é—´å (<code>çƒ­è¿æ¥</code>) æ‰èƒ½å¾—åˆ°æ”¹å–„ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong></p><ul><li>ç©ºé—²çŠ¶æ€ï¼Œå®ƒè¿˜æ˜¯ä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œ</li><li>åœ¨é‡è´Ÿè½½æ—¶ï¼Œè¿˜æœ‰å¯èƒ½é­å— <code>DoS attacks</code> æ”»å‡»ã€‚</li></ul><details class="custom-details"><summary>æŸ¥çœ‹æ›´å¤š</summary><p>ä¸ºäº†ç¼“è§£è¿™äº›é—®é¢˜ï¼Œé•¿è¿æ¥ çš„æ¦‚å¿µä¾¿è¢«è®¾è®¡å‡ºæ¥äº†ï¼Œç”šè‡³åœ¨ HTTP&#x2F;1.1 ä¹‹å‰ã€‚æˆ–è€…è¿™è¢«ç§°ä¹‹ä¸ºä¸€ä¸ª keep-alive è¿æ¥ã€‚</p><p><strong>ä¼˜ç‚¹</strong></p><p>ä¸€ä¸ªé•¿è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œé‡å¤ç”¨äºå‘é€ä¸€ç³»åˆ—è¯·æ±‚ï¼ŒèŠ‚çœäº†æ–°å»º TCP è¿æ¥æ¡æ‰‹çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ TCP çš„æ€§èƒ½å¢å¼ºèƒ½åŠ›ã€‚å½“ç„¶è¿™ä¸ªè¿æ¥ä¹Ÿä¸ä¼šä¸€ç›´ä¿ç•™ç€ï¼š<span style="color: red">è¿æ¥åœ¨ç©ºé—²ä¸€æ®µæ—¶é—´åä¼šè¢«å…³é—­</span> (æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ Keep-Alive åè®®å¤´æ¥æŒ‡å®šä¸€ä¸ªæœ€å°çš„è¿æ¥ä¿æŒæ—¶é—´)ã€‚</p><p><strong>ç¼ºç‚¹</strong></p><p>é•¿è¿æ¥ä¹Ÿè¿˜æ˜¯æœ‰ç¼ºç‚¹çš„ï¼›å°±ç®—æ˜¯åœ¨ç©ºé—²çŠ¶æ€ï¼Œå®ƒè¿˜æ˜¯ä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œè€Œä¸”åœ¨é‡è´Ÿè½½æ—¶ï¼Œè¿˜æœ‰å¯èƒ½é­å— DoS attacks æ”»å‡»ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨éé•¿è¿æ¥ï¼Œå³å°½å¿«å…³é—­é‚£äº›ç©ºé—²çš„è¿æ¥ï¼Œä¹Ÿèƒ½å¯¹æ€§èƒ½æœ‰æ‰€æå‡ã€‚</p><p>HTTP&#x2F;1.0 é‡Œé»˜è®¤å¹¶ä¸ä½¿ç”¨é•¿è¿æ¥ã€‚æŠŠ Connection è®¾ç½®æˆ close ä»¥å¤–çš„å…¶å®ƒå‚æ•°éƒ½å¯ä»¥è®©å…¶ä¿æŒé•¿è¿æ¥ï¼Œé€šå¸¸ä¼šè®¾ç½®ä¸º retry-afterã€‚(TODO:æ²¡æ‡‚)</p></p></details><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>åœ¨ HTTP&#x2F;1.1 é‡Œï¼Œé»˜è®¤å°±æ˜¯é•¿è¿æ¥çš„ï¼Œåè®®å¤´éƒ½ä¸ç”¨å†å»å£°æ˜å®ƒ (ä½†æˆ‘ä»¬è¿˜æ˜¯ä¼šæŠŠå®ƒåŠ ä¸Šï¼Œä¸‡ä¸€æŸä¸ªæ—¶å€™å› ä¸ºæŸç§åŸå› è¦é€€å›åˆ° HTTP&#x2F;1.0 å‘¢)</p></div><h3 id="Http-æµæ°´çº¿"><a href="#Http-æµæ°´çº¿" class="headerlink" title="Http æµæ°´çº¿"></a>Http æµæ°´çº¿</h3><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>æµæ°´çº¿å·²ç»è¢«æ›´å¥½çš„ç®—æ³•ç»™ä»£æ›¿ï¼Œå¦‚ multiplexingï¼Œå·²ç»ç”¨åœ¨ HTTP&#x2F;2</p></div><ul><li>åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›</li><li>æ‰“åŒ…æˆæ¶ˆæ¯åŒ…æå‡æ€§èƒ½</li><li>å¹‚ç­‰è¯·æ±‚æ”¯æŒæµæ°´çº¿</li><li>æµè§ˆå™¨é»˜è®¤å…³é—­</li></ul><details class="custom-details"><summary>æŸ¥çœ‹æ›´å¤š</summary><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚æ˜¯æŒ‰é¡ºåºå‘å‡ºçš„ã€‚ä¸‹ä¸€ä¸ªè¯·æ±‚åªæœ‰åœ¨å½“å‰è¯·æ±‚æ”¶åˆ°åº”ç­”è¿‡åæ‰ä¼šè¢«å‘å‡ºã€‚ç”±äºä¼šå—åˆ°ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½çš„é™åˆ¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚</p><p><code>æµæ°´çº¿</code>æ˜¯ åœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›ã€‚è¿™æ ·å¯ä»¥é¿å…è¿æ¥å»¶è¿Ÿ ã€‚</p><p><strong>æ‰“åŒ…æˆæ¶ˆæ¯åŒ…æå‡æ€§èƒ½</strong></p><p>ç†è®ºä¸Šè®²ï¼Œæ€§èƒ½è¿˜ä¼šå› ä¸ºä¸¤ä¸ª HTTP è¯·æ±‚æœ‰å¯èƒ½è¢«æ‰“åŒ…åˆ°ä¸€ä¸ª TCP æ¶ˆæ¯åŒ…ä¸­è€Œå¾—åˆ°æå‡ã€‚å°±ç®— HTTP è¯·æ±‚ä¸æ–­çš„ç»§ç»­ï¼Œå°ºå¯¸ä¼šå¢åŠ ï¼Œä½†è®¾ç½® TCP çš„ MSS(Maximum Segment Size) é€‰é¡¹ï¼Œä»ç„¶è¶³å¤ŸåŒ…å«ä¸€ç³»åˆ—ç®€å•çš„è¯·æ±‚ã€‚</p><p><strong>å¹‚ç­‰ è¯·æ±‚æ”¯æŒæµæ°´çº¿</strong><br>å¹¶ä¸æ˜¯æ‰€æœ‰ç±»å‹çš„ HTTP è¯·æ±‚éƒ½èƒ½ç”¨åˆ°æµæ°´çº¿ï¼šåªæœ‰ <code>idempotent(å¹‚ç­‰)</code> æ–¹å¼ï¼Œæ¯”å¦‚ <code>GETã€HEADã€PUT å’Œ DELETE èƒ½å¤Ÿè¢«å®‰å…¨çš„é‡è¯•</code>ï¼š<code>å¦‚æœæœ‰æ•…éšœå‘ç”Ÿæ—¶ï¼Œæµæ°´çº¿çš„å†…å®¹è¦èƒ½è¢«è½»æ˜“çš„é‡è¯•</code>ã€‚</p><p><strong>æµè§ˆå™¨é»˜è®¤å…³é—­</strong><br>ä»Šå¤©ï¼Œæ‰€æœ‰éµå¾ª HTTP&#x2F;1.1 çš„ä»£ç†å’ŒæœåŠ¡å™¨éƒ½åº”è¯¥æ”¯æŒæµæ°´çº¿ï¼Œè™½ç„¶å®é™…æƒ…å†µä¸­è¿˜æ˜¯æœ‰å¾ˆå¤šé™åˆ¶ï¼šä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› æ˜¯ï¼Œç›®å‰æ²¡æœ‰ç°ä»£æµè§ˆå™¨é»˜è®¤å¯ç”¨è¿™ä¸ªç‰¹æ€§ã€‚</p></details><h3 id="åŸŸååˆ†ç‰‡"><a href="#åŸŸååˆ†ç‰‡" class="headerlink" title="åŸŸååˆ†ç‰‡"></a>åŸŸååˆ†ç‰‡</h3><div class="custom-quote danger"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M19.76 5.23C15.84 5.23 12 2 12 2C12 2 8.15996 5.23 4.23996 5.23C4.23996 5.23 1.86996 16.99 12 22C22.13 16.99 19.76 5.23 19.76 5.23Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 16H12"></path></svg></span><p class="custom-quote-title">WARNING</p><p>é™¤éä½ æœ‰ç´§æ€¥è€Œè¿«åˆ‡çš„éœ€æ±‚ï¼Œä¸è¦ä½¿ç”¨è¿™ä¸€è¿‡æ—¶çš„æŠ€æœ¯ï¼Œå‡çº§åˆ° HTTP&#x2F;2 å°±å¥½äº†ã€‚åœ¨ HTTP&#x2F;2 é‡Œï¼ŒåšåŸŸååˆ†ç‰‡å°±æ²¡å¿…è¦äº†ï¼šHTTP&#x2F;2 çš„è¿æ¥å¯ä»¥å¾ˆå¥½çš„å¤„ç†å¹¶å‘çš„æ— ä¼˜å…ˆçº§çš„è¯·æ±‚ã€‚åŸŸååˆ†ç‰‡ç”šè‡³ä¼šå½±å“æ€§èƒ½ã€‚å¤§å¤šæ•° HTTP&#x2F;2 çš„å®ç°è¿˜ä¼šä½¿ç”¨ä¸€ç§ç§°ä½œè¿æ¥å‡èšçš„æŠ€æœ¯å»å°è¯•åˆå¹¶è¢«åˆ†ç‰‡çš„åŸŸåã€‚</p></div><p>ä½œä¸º HTTP&#x2F;1.x çš„è¿æ¥ï¼Œè¯·æ±‚æ˜¯åºåˆ—åŒ–çš„ï¼Œå“ªæ€•æœ¬æ¥æ˜¯æ— åºçš„ï¼Œåœ¨æ²¡æœ‰è¶³å¤Ÿåºå¤§å¯ç”¨çš„å¸¦å®½æ—¶ï¼Œä¹Ÿæ— ä»ä¼˜åŒ–ã€‚ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ï¼Œæµè§ˆå™¨ä¸ºæ¯ä¸ªåŸŸåå»ºç«‹å¤šä¸ªè¿æ¥ï¼Œä»¥å®ç°å¹¶å‘è¯·æ±‚ã€‚æ›¾ç»é»˜è®¤çš„è¿æ¥æ•°é‡ä¸º 2 åˆ° 3 ä¸ªï¼Œç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„å¹¶å‘è¿æ¥æ•°å·²ç»å¢åŠ åˆ° 6 æ¡ã€‚<span style="color: red">å¦‚æœå°è¯•å¤§äºè¿™ä¸ªæ•°å­—ï¼Œå°±æœ‰è§¦å‘æœåŠ¡å™¨ DoS ä¿æŠ¤çš„é£é™©</span>ã€‚</p><p>å¦‚æœæœåŠ¡å™¨ç«¯æƒ³è¦æ›´å¿«é€Ÿçš„å“åº”ç½‘ç«™æˆ–åº”ç”¨ç¨‹åºçš„åº”ç­”ï¼Œå®ƒå¯ä»¥è¿«ä½¿å®¢æˆ·ç«¯å»ºç«‹æ›´å¤šçš„è¿æ¥ã€‚ä¾‹å¦‚ï¼Œä¸è¦åœ¨åŒä¸€ä¸ªåŸŸåä¸‹è·å–æ‰€æœ‰èµ„æºï¼Œå‡è®¾æœ‰ä¸ªåŸŸåæ˜¯ <a href="http://www.example.comï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ‹†åˆ†æˆå¥½å‡ ä¸ªåŸŸåï¼š`www1.example.com`ã€`www2.example.com`ã€`www3.example.com`ã€‚æ‰€æœ‰è¿™äº›åŸŸåéƒ½æŒ‡å‘åŒä¸€å°æœåŠ¡å™¨ï¼Œæµè§ˆå™¨ä¼šåŒæ—¶ä¸ºæ¯ä¸ªåŸŸåå»ºç«‹">www.example.comï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ‹†åˆ†æˆå¥½å‡ ä¸ªåŸŸåï¼š`www1.example.com`ã€`www2.example.com`ã€`www3.example.com`ã€‚æ‰€æœ‰è¿™äº›åŸŸåéƒ½æŒ‡å‘åŒä¸€å°æœåŠ¡å™¨ï¼Œæµè§ˆå™¨ä¼šåŒæ—¶ä¸ºæ¯ä¸ªåŸŸåå»ºç«‹</a> 6 æ¡è¿æ¥ (åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿æ¥æ•°ä¼šè¾¾åˆ° 18 æ¡)ã€‚è¿™ä¸€æŠ€æœ¯è¢«ç§°<code>ä½œåŸŸååˆ†ç‰‡</code>ã€‚</p><img src="http://t-blog-images.aijs.top/img/202207271036850.webp" /><h2 id="HTTP-x2F-2"><a href="#HTTP-x2F-2" class="headerlink" title="HTTP&#x2F;2"></a>HTTP&#x2F;2</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Evolution_of_HTTP#http2_-_%E4%B8%BA%E4%BA%86%E6%9B%B4%E4%BC%98%E5%BC%82%E7%9A%84%E8%A1%A8%E7%8E%B0" target="_blank" >è§</a></p><h3 id="äºŒè¿›åˆ¶åˆ†å¸§"><a href="#äºŒè¿›åˆ¶åˆ†å¸§" class="headerlink" title="äºŒè¿›åˆ¶åˆ†å¸§"></a>äºŒè¿›åˆ¶åˆ†å¸§</h3><p><code>å¸§</code>ï¼šHTTP&#x2F;2 æ•°æ®é€šä¿¡çš„æœ€â¼©å•ä½<br><code>æ¶ˆæ¯</code>ï¼šæŒ‡ HTTP&#x2F;2 ä¸­é€»è¾‘ä¸Šçš„ HTTP æ¶ˆæ¯ã€‚</p><p>ä¾‹å¦‚è¯·æ±‚å’Œå“åº”ç­‰ï¼Œæ¶ˆæ¯ç”±â¼€ä¸ªæˆ–å¤šä¸ªå¸§ ç»„æˆã€‚</p><p><code>æµ</code>ï¼šå­˜åœ¨äºè¿æ¥ä¸­çš„â¼€ä¸ªè™šæ‹Ÿé€šé“ã€‚æµå¯ä»¥æ‰¿è½½åŒå‘æ¶ˆæ¯ï¼Œæ¯ä¸ªæµéƒ½æœ‰â¼€ä¸ªå”¯â¼€çš„æ•´æ•° ID</p><p>HTTP&#x2F;2 é‡‡â½¤â¼†è¿›åˆ¶æ ¼å¼ä¼ è¾“æ•°æ®ï¼Œâ½½â¾® HTTP 1.x çš„â½‚æœ¬æ ¼å¼ï¼Œâ¼†è¿›åˆ¶åè®®è§£æèµ·æ¥æ›´â¾¼æ•ˆã€‚</p><h3 id="å¤´éƒ¨å‹ç¼©"><a href="#å¤´éƒ¨å‹ç¼©" class="headerlink" title="å¤´éƒ¨å‹ç¼©"></a>å¤´éƒ¨å‹ç¼©</h3><p>HTTP&#x2F;1.x ä¼šåœ¨è¯·æ±‚å’Œå“åº”ä¸­ä¸­é‡å¤åœ°æºå¸¦ä¸å¸¸æ”¹å˜çš„ã€å†—â»“çš„å¤´éƒ¨æ•°æ®ï¼Œç»™â½¹ç»œå¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ã€‚</p><p>HTTP&#x2F;2 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿â½¤â€œâ¾¸éƒ¨è¡¨â€æ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®ï¼å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚ å’Œå“åº”å‘é€ â¾¸éƒ¨è¡¨åœ¨ HTTP&#x2F;2 çš„è¿æ¥å­˜ç»­æœŸå†…å§‹ç»ˆå­˜åœ¨ï¼Œç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±åŒæ¸è¿›åœ°æ›´æ–°; æ¯ä¸ªæ–°çš„â¾¸éƒ¨é”®ï¼å€¼å¯¹è¦ä¹ˆè¢«è¿½åŠ åˆ°å½“å‰è¡¨çš„æœ«å°¾ï¼Œè¦ä¹ˆæ›¿æ¢è¡¨ä¸­ä¹‹å‰çš„å€¼ã€‚ ä½ å¯ä»¥ç†è§£ä¸ºåªå‘é€å·®å¼‚æ•°æ®ï¼Œâ½½ä¸æ˜¯å…¨éƒ¨å‘é€ï¼Œä»â½½å‡å°‘å¤´éƒ¨çš„ä¿¡æ¯é‡</p><img src="http://t-blog-images.aijs.top/img/202207271040589.webp" /><h3 id="æœåŠ¡å™¨æ¨é€"><a href="#æœåŠ¡å™¨æ¨é€" class="headerlink" title="æœåŠ¡å™¨æ¨é€"></a>æœåŠ¡å™¨æ¨é€</h3><p>æœåŠ¡ç«¯å¯ä»¥åœ¨å‘é€â»šâ¾¯ HTML æ—¶ä¸»åŠ¨æ¨é€å…¶å®ƒèµ„æºï¼Œâ½½ä¸â½¤ç­‰åˆ°æµè§ˆå™¨è§£æåˆ°ç›¸åº”ä½ç½®ï¼Œå‘èµ·è¯·æ±‚å†å“åº”ã€‚ä¾‹å¦‚æœåŠ¡ç«¯ å¯ä»¥ä¸»åŠ¨æŠŠ JS å’Œ CSS â½‚ä»¶æ¨é€ç»™å®¢æˆ·ç«¯ï¼Œâ½½ä¸éœ€è¦å®¢æˆ·ç«¯è§£æ HTML æ—¶å†å‘é€è¿™äº›è¯·æ±‚ã€‚ æœåŠ¡ç«¯å¯ä»¥ä¸»åŠ¨æ¨é€ï¼Œå®¢æˆ·ç«¯ä¹Ÿæœ‰æƒåˆ©é€‰æ‹©æ˜¯å¦æ¥æ”¶ã€‚å¦‚æœæœåŠ¡ç«¯æ¨é€çš„èµ„æºå·²ç»è¢«æµè§ˆå™¨ç¼“å­˜è¿‡ï¼Œæµè§ˆå™¨å¯ä»¥é€šè¿‡å‘ é€ RST_STREAM å¸§æ¥æ‹’æ”¶ã€‚ä¸»åŠ¨æ¨é€ä¹Ÿéµå®ˆåŒæºç­–ç•¥ï¼ŒæœåŠ¡å™¨ä¸ä¼šéšä¾¿æ¨é€ç¬¬ä¸‰â½…èµ„æºç»™å®¢æˆ·ç«¯</p><h3 id="å¤šè·¯å¤ç”¨"><a href="#å¤šè·¯å¤ç”¨" class="headerlink" title="å¤šè·¯å¤ç”¨"></a>å¤šè·¯å¤ç”¨</h3><p>HTTP 1.x ä¸­ï¼Œå¦‚æœæƒ³å¹¶å‘å¤šä¸ªè¯·æ±‚ï¼Œå¿…é¡»ä½¿â½¤å¤šä¸ª TCP é“¾æ¥ï¼Œä¸”æµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºï¼Œè¿˜ä¼šå¯¹å•ä¸ªåŸŸåæœ‰ 6-8 ä¸ªçš„ TCP é“¾æ¥è¯·æ±‚é™åˆ¶ã€‚</p><p>åŒåŸŸåä¸‹æ‰€æœ‰é€šä¿¡éƒ½åœ¨å•ä¸ªè¿æ¥ä¸Šå®Œæˆã€‚ å•ä¸ªè¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµã€‚ æ•°æ®æµä»¥æ¶ˆæ¯çš„å½¢å¼å‘é€ï¼Œâ½½æ¶ˆæ¯â¼œç”±â¼€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆï¼Œå¤šä¸ªå¸§ä¹‹é—´å¯ä»¥ä¹±åºå‘é€ï¼Œå› ä¸ºæ ¹æ®å¸§â¾¸éƒ¨çš„æµæ ‡è¯†å¯ ä»¥é‡æ–°ç»„è£…</p><h2 id="HTTP-x2F-3"><a href="#HTTP-x2F-3" class="headerlink" title="HTTP&#x2F;3"></a>HTTP&#x2F;3</h2><p><code>HTTP/3</code>æ˜¯ç¬¬ä¸‰ä¸ªä¸»è¦ç‰ˆæœ¬çš„ HTTP åè®®ã€‚ä¸å…¶å‰ä»» HTTP&#x2F;1.1 å’Œ HTTP&#x2F;2 ä¸åŒï¼Œåœ¨ HTTP&#x2F;3 ä¸­ï¼Œ<code>å°†å¼ƒç”¨TCPåè®®ï¼Œæ”¹ä¸ºä½¿ç”¨åŸºäºUDPåè®®çš„QUICåè®®å®ç°</code>ã€‚</p><p>æ­¤å˜åŒ–ä¸»è¦ä¸ºäº†è§£å†³ HTTP&#x2F;2 ä¸­å­˜åœ¨çš„<code>é˜Ÿå¤´é˜»å¡</code>é—®é¢˜ã€‚ç”±äº HTTP&#x2F;2 åœ¨å•ä¸ª TCP è¿æ¥ä¸Šä½¿ç”¨äº†<code>å¤šè·¯å¤ç”¨</code>ï¼Œå—åˆ° TCP<code>æ‹¥å¡æ§åˆ¶</code>çš„å½±å“ï¼Œå°‘é‡çš„ä¸¢åŒ…å°±å¯èƒ½å¯¼è‡´æ•´ä¸ª TCP è¿æ¥ä¸Šçš„æ‰€æœ‰æµè¢«é˜»å¡ã€‚</p><p><code>QUICï¼ˆå¿«é€ŸUDPç½‘ç»œè¿æ¥ï¼‰</code>æ˜¯ä¸€ç§å®éªŒæ€§çš„ç½‘ç»œä¼ è¾“åè®®ï¼Œç”± Google å¼€å‘ï¼Œè¯¥åè®®æ—¨åœ¨ä½¿ç½‘é¡µä¼ è¾“æ›´å¿«ã€‚åœ¨ 2018 å¹´ 10 æœˆ 28 æ—¥çš„é‚®ä»¶åˆ—è¡¨è®¨è®ºä¸­ï¼Œäº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ˆIETFï¼‰ HTTP å’Œ QUIC å·¥ä½œç»„ä¸»å¸­ Mark Nottingham æå‡ºäº†å°† HTTP-over-QUIC æ›´åä¸º HTTP&#x2F;3 çš„æ­£å¼è¯·æ±‚ï¼Œä»¥â€œæ˜ç¡®åœ°å°†å…¶æ ‡è¯†ä¸º HTTP è¯­ä¹‰çš„å¦ä¸€ä¸ªç»‘å®šâ€¦â€¦ä½¿äººä»¬ç†è§£å®ƒä¸ QUIC çš„ä¸åŒâ€ï¼Œå¹¶åœ¨æœ€ç»ˆç¡®å®šå¹¶å‘å¸ƒè‰æ¡ˆåï¼Œå°† QUIC å·¥ä½œç»„ç»§æ‰¿åˆ° HTTP å·¥ä½œç»„ã€‚ åœ¨éšåçš„å‡ å¤©è®¨è®ºä¸­ï¼ŒMark Nottingham çš„æè®®å¾—åˆ°äº† IETF æˆå‘˜çš„æ¥å—ï¼Œä»–ä»¬åœ¨ 2018 å¹´ 11 æœˆç»™å‡ºäº†å®˜æ–¹æ‰¹å‡†ï¼Œè®¤å¯ HTTP-over-QUIC æˆä¸º HTTP&#x2F;3ã€‚</p><p>2019 å¹´ 9 æœˆï¼Œ<strong>HTTP&#x2F;3 æ”¯æŒå·²æ·»åŠ åˆ° Cloudflare å’Œ Google Chromeï¼ˆCanary buildï¼‰ã€‚Firefox Nightly åœ¨ 2019 å¹´ç§‹å­£ä¹‹åæ·»åŠ æ”¯æŒ</strong>ã€‚</p><p>2022 å¹´ 6 æœˆ 6 æ—¥ï¼Œ<strong>IETF æ­£å¼æ ‡å‡†åŒ– HTTP&#x2F;3 ä¸º RFC9114</strong>ã€‚</p><h2 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h2><p>è™½ç„¶ QUIC çš„åç§°æœ€åˆæ˜¯â€œ<code>å¿«é€Ÿ UDP äº’è”ç½‘è¿æ¥</code>â€ï¼ˆFast UDP Internet Connectionï¼‰çš„é¦–å­—æ¯ç¼©å†™ï¼Œä½† IETF æŒ‡å®šçš„æ ‡å‡†ä¸­ QUIC å¹¶ä¸æ˜¯ä»»ä½•å†…å®¹çš„ç¼©å†™ã€‚QUIC æé«˜äº†ç›®å‰ä½¿ç”¨ TCP çš„é¢å‘è¿æ¥çš„ç½‘ç»œåº”ç”¨çš„æ€§èƒ½ã€‚å®ƒé€šè¿‡ä½¿ç”¨ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰åœ¨ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´åˆ›å»ºè‹¥å¹²ä¸ªå¤šè·¯è¿æ¥æ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†åœ¨ç½‘ç»œå±‚æ·˜æ±° TCPï¼Œä»¥æ»¡è¶³è®¸å¤šåº”ç”¨çš„éœ€æ±‚ï¼Œå› æ­¤è¯¥åè®®å¶å°”ä¹Ÿä¼šè·å¾— â€œTCP&#x2F;2â€çš„æ˜µç§°ã€‚</p><p>QUIC ä¸ HTTP&#x2F;2 çš„å¤šè·¯å¤ç”¨è¿æ¥ååŒå·¥ä½œï¼Œå…è®¸å¤šä¸ªæ•°æ®æµç‹¬ç«‹åˆ°è¾¾æ‰€æœ‰ç«¯ç‚¹ï¼Œå› æ­¤ä¸å—æ¶‰åŠå…¶ä»–æ•°æ®æµçš„ä¸¢åŒ…å½±å“ã€‚<br>ç›¸åï¼ŒHTTP&#x2F;2 åˆ›å»ºåœ¨ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰ä¸Šï¼Œå¦‚æœä»»ä½•ä¸€ä¸ª TCP æ•°æ®åŒ…å»¶è¿Ÿæˆ–ä¸¢å¤±ï¼Œæ‰€æœ‰å¤šè·¯æ•°æ®æµéƒ½ä¼šé­å—é˜Ÿå¤´é˜»å¡å»¶è¿Ÿã€‚</p><ul><li>QUIC çš„<code>æ¬¡è¦ç›®æ ‡åŒ…æ‹¬é™ä½è¿æ¥å’Œä¼ è¾“æ—¶å»¶ï¼Œä»¥åŠæ¯ä¸ªæ–¹å‘çš„å¸¦å®½ä¼°è®¡ä»¥é¿å…æ‹¥å¡</code>ã€‚</li><li>å°†æ‹¥å¡æ§åˆ¶ç®—æ³•ç§»åˆ°äº†ä¸¤ä¸ªç«¯ç‚¹çš„ç”¨æˆ·ç©ºé—´ï¼Œè€Œä¸æ˜¯å†…æ ¸ç©ºé—´ï¼Œæ®ç§°è¿™å°†ä½¿è¿™äº›ç®—æ³•å¾—åˆ°æ›´å¿«çš„æ”¹è¿›ã€‚</li><li>è¯¥åè®®è¿˜å¯ä»¥æ‰©å±•å‰å‘çº é”™ï¼ˆFECï¼‰ï¼Œä»¥è¿›ä¸€æ­¥æé«˜é¢„æœŸé”™è¯¯æ—¶çš„æ€§èƒ½ï¼Œè¿™è¢«è§†ä¸ºåè®®æ¼”è¿›çš„ä¸‹ä¸€æ­¥ã€‚</li></ul><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>QUIC æ—¨åœ¨æä¾›å‡ ä¹ç­‰åŒäº TCP è¿æ¥çš„<code>å¯é æ€§</code>ï¼Œä½†å»¶è¿Ÿå¤§å¤§å‡å°‘ã€‚å®ƒä¸»è¦é€šè¿‡ä¸¤ä¸ªç†è§£ HTTP æµé‡çš„è¡Œä¸ºæ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p><strong>TODOï¼šæ²¡æ‡‚</strong></p><p>ç¬¬ä¸€ä¸ªå˜åŒ–æ˜¯åœ¨è¿æ¥åˆ›å»ºæœŸé—´å¤§å¤§å‡å°‘å¼€é”€ã€‚ç”±äºå¤§å¤šæ•° HTTP è¿æ¥éƒ½éœ€è¦ TLSï¼Œå› æ­¤ QUIC ä½¿åå•†å¯†é’¥å’Œæ”¯æŒçš„åè®®æˆä¸ºåˆå§‹æ¡æ‰‹è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚ å½“å®¢æˆ·ç«¯æ‰“å¼€è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨å“åº”çš„æ•°æ®åŒ…åŒ…æ‹¬å°†æ¥çš„æ•°æ®åŒ…åŠ å¯†æ‰€éœ€çš„æ•°æ®ã€‚è¿™æ¶ˆé™¤äº† TCP ä¸Šçš„å…ˆè¿æ¥å¹¶é€šè¿‡é™„åŠ æ•°æ®åŒ…åå•†å®‰å…¨åè®®çš„éœ€è¦ã€‚å…¶ä»–åè®®å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡ŒæœåŠ¡ï¼Œå¹¶å°†å¤šä¸ªæ­¥éª¤ç»„åˆåˆ°ä¸€ä¸ªè¯·æ±‚ä¸­ã€‚ ç„¶åï¼Œè¿™äº›æ•°æ®æ—¢å¯ç”¨äºåˆå§‹è®¾ç½®ä¸­çš„åç»­è¯·æ±‚ï¼Œä¹Ÿå¯ç”¨äºæœªæ¥çš„è¯·æ±‚ã€‚</p><p><strong>QUIC æµæ˜¯å•ç‹¬æ§åˆ¶çš„</strong></p><p><code>QUIC ä½¿ç”¨ UDP åè®®ä½œä¸ºå…¶åŸºç¡€ï¼Œä¸åŒ…æ‹¬ä¸¢å¤±æ¢å¤ã€‚ç›¸åï¼Œæ¯ä¸ª QUIC æµæ˜¯å•ç‹¬æ§åˆ¶çš„ï¼Œå¹¶ä¸”åœ¨ QUIC çº§åˆ«è€Œä¸æ˜¯ UDP çº§åˆ«é‡ä¼ ä¸¢å¤±çš„æ•°æ®ã€‚è¿™æ„å‘³ç€å¦‚æœåœ¨ä¸€ä¸ªæµä¸­å‘ç”Ÿé”™è¯¯ï¼Œåè®®æ ˆä»ç„¶å¯ä»¥ç‹¬ç«‹åœ°ç»§ç»­ä¸ºå…¶ä»–æµæä¾›æœåŠ¡ã€‚</code> è¿™åœ¨æé«˜æ˜“å‡ºé”™é“¾è·¯çš„æ€§èƒ½æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ TCP åè®®é€šçŸ¥æ•°æ®åŒ…ä¸¢å¤±æˆ–æŸåä¹‹å‰å¯èƒ½ä¼šæ”¶åˆ°å¤§é‡çš„æ­£å¸¸æ•°æ®ï¼Œä½†æ˜¯åœ¨çº æ­£é”™è¯¯ä¹‹å‰å…¶ä»–çš„æ­£å¸¸è¯·æ±‚éƒ½ä¼šç­‰å¾…ç”šè‡³é‡å‘ã€‚ QUIC åœ¨ä¿®å¤å•ä¸ªæµæ—¶å¯ä»¥è‡ªç”±å¤„ç†å…¶ä»–æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿ä¸€ä¸ªè¯·æ±‚å‘ç”Ÿäº†é”™è¯¯ä¹Ÿä¸ä¼šå½±å“åˆ°å…¶ä»–çš„è¯·æ±‚ã€‚</p><p><strong>æ¯ä¸ªæ•°æ®åŒ…å•ç‹¬åŠ å¯†ã€å•ä¸ªæ¡æ‰‹è¿‡ç¨‹</strong></p><p>QUIC åŒ…æ‹¬è®¸å¤šå…¶ä»–æ›´æ™®é€šçš„æ›´æ”¹ï¼Œè¿™äº›æ›´æ”¹ä¹Ÿå¯ä»¥<code>ä¼˜åŒ–æ•´ä½“å»¶è¿Ÿ</code>å’Œ<code>ååé‡</code>ã€‚ä¾‹å¦‚ï¼Œ<code>æ¯ä¸ªæ•°æ®åŒ…æ˜¯å•ç‹¬åŠ å¯†çš„ï¼Œå› æ­¤åŠ å¯†æ•°æ®æ—¶ä¸éœ€è¦ç­‰å¾…éƒ¨åˆ†æ•°æ®åŒ…</code>ã€‚ åœ¨ TCP ä¸‹é€šå¸¸ä¸å¯èƒ½è¿™æ ·åšï¼Œå…¶ä¸­åŠ å¯†è®°å½•åœ¨å­—èŠ‚æµä¸­ï¼Œå¹¶ä¸”åè®®æ ˆä¸çŸ¥é“è¯¥æµä¸­çš„æ›´é«˜å±‚è¾¹ç•Œã€‚è¿™äº›å¯ä»¥ç”±è¿è¡Œåœ¨æ›´ä¸Šå±‚çš„åè®®è¿›è¡Œåå•†ï¼Œä½† QUIC æ—¨åœ¨é€šè¿‡<strong>å•ä¸ªæ¡æ‰‹è¿‡ç¨‹å®Œæˆ</strong>è¿™äº›ã€‚</p><p><strong>æé«˜ç½‘ç»œåˆ‡æ¢æœŸé—´çš„æ€§èƒ½</strong></p><p><code>QUIC çš„å¦ä¸€ä¸ªç›®æ ‡æ˜¯æé«˜ç½‘ç»œåˆ‡æ¢æœŸé—´çš„æ€§èƒ½ï¼Œä¾‹å¦‚å½“ç§»åŠ¨è®¾å¤‡çš„ç”¨æˆ·ä» WiFi çƒ­ç‚¹åˆ‡æ¢åˆ°ç§»åŠ¨ç½‘ç»œæ—¶å‘ç”Ÿçš„æƒ…å†µã€‚</code> å½“è¿™å‘ç”Ÿåœ¨ TCP ä¸Šæ—¶ï¼Œä¸€ä¸ªå†—é•¿çš„è¿‡ç¨‹å¼€å§‹äº†ï¼šæ¯ä¸ªç°æœ‰è¿æ¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¶…æ—¶ï¼Œç„¶åæ ¹æ®éœ€è¦é‡æ–°åˆ›å»ºã€‚æœŸé—´å­˜åœ¨è¾ƒé«˜å»¶è¿Ÿï¼Œå› ä¸ºæ–°è¿æ¥éœ€è¦ç­‰å¾…æ—§è¿æ¥è¶…æ—¶åæ‰ä¼šåˆ›å»ºã€‚ ä¸ºè§£å†³æ­¤é—®é¢˜ï¼ŒQUIC åŒ…å«ä¸€ä¸ª<code>è¿æ¥æ ‡è¯†ç¬¦</code>(æ˜¯ä¸æ˜¯ MAC åœ°å€ï¼Ÿ)ï¼Œè¯¥æ ‡è¯†ç¬¦å”¯ä¸€åœ°æ ‡è¯†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼Œè€Œæ— è®ºæº IP åœ°å€æ˜¯ä»€ä¹ˆã€‚è¿™æ ·åªéœ€å‘é€ä¸€ä¸ªåŒ…å«æ­¤ ID çš„æ•°æ®åŒ…å³å¯é‡æ–°åˆ›å»ºè¿æ¥ï¼Œå› ä¸ºå³ä½¿ç”¨æˆ·çš„ IP åœ°å€å‘ç”Ÿå˜åŒ–ï¼ŒåŸå§‹è¿æ¥ ID ä»ç„¶æœ‰æ•ˆã€‚</p><p><strong>QUIC åœ¨åº”ç”¨ç¨‹åºç©ºé—´ä¸­å®ç°ï¼Œè€Œä¸æ˜¯åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­å®ç°ï¼Œå®¹æ˜“æ‰©å±•</strong><br><code>QUIC åœ¨åº”ç”¨ç¨‹åºç©ºé—´ä¸­å®ç°ï¼Œè€Œä¸æ˜¯åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­å®ç°ã€‚å½“æ•°æ®åœ¨åº”ç”¨ç¨‹åºä¹‹é—´ç§»åŠ¨æ—¶ï¼Œè¿™é€šå¸¸ä¼šç”±äºä¸Šä¸‹æ–‡åˆ‡æ¢è€Œè°ƒç”¨é¢å¤–çš„å¼€é”€ã€‚</code> ä½†æ˜¯åœ¨ QUIC ä¸‹åè®®æ ˆæ—¨åœ¨ç”±å•ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨ QUIC åœ¨ UDP ä¸Šæ‰˜ç®¡è‡ªå·±çš„è¿æ¥ã€‚æœ€ç»ˆå·®å¼‚å¯èƒ½éå¸¸å°ï¼Œå› ä¸ºæ•´ä¸ª HTTP&#x2F;2 å †æ ˆçš„å¤§éƒ¨åˆ†å·²ç»å­˜åœ¨äºåº”ç”¨ç¨‹åºï¼ˆæˆ–æ›´å¸¸è§çš„åº“ï¼‰ä¸­ã€‚ å°†å‰©ä½™éƒ¨åˆ†æ”¾åœ¨è¿™äº›åº“ä¸­ï¼ŒåŸºæœ¬ä¸Šæ˜¯çº é”™ï¼Œå¯¹ HTTP&#x2F;2 å †æ ˆçš„å¤§å°æˆ–æ•´ä½“å¤æ‚æ€§å‡ ä¹æ²¡æœ‰å½±å“ã€‚</p><p>QUIC å…è®¸æ›´å®¹æ˜“åœ°è¿›è¡Œæœªæ¥æ›´æ”¹ï¼Œå› ä¸ºå®ƒä¸éœ€è¦æ›´æ”¹å†…æ ¸å°±å¯ä»¥è¿›è¡Œæ›´æ–°ã€‚ QUIC çš„é•¿æœŸç›®æ ‡ä¹‹ä¸€æ˜¯æ·»åŠ å‰å‘çº é”™å’Œæ”¹è¿›çš„æ‹¥å¡æ§åˆ¶ã€‚</p><p>å…³äºä» TCP è¿ç§»åˆ° UDP çš„ä¸€ä¸ªé—®é¢˜æ˜¯ TCP è¢«å¹¿æ³›é‡‡ç”¨ï¼Œå¹¶ä¸”äº’è”ç½‘åŸºç¡€è®¾æ–½ä¸­çš„è®¸å¤šä¸­é—´è®¾å¤‡è¢«è°ƒæ•´ä¸º UDP é€Ÿç‡é™åˆ¶ç”šè‡³é˜»æ­¢ UDPã€‚ Google è¿›è¡Œäº†ä¸€äº›æ¢ç´¢æ€§å®éªŒæ¥æè¿°è¿™ä¸€ç‚¹ï¼Œå‘ç°åªæœ‰å°‘æ•°è¿æ¥å­˜åœ¨æ­¤é—®é¢˜ã€‚æ‰€ä»¥ Chromium çš„ç½‘ç»œå †æ ˆåŒæ—¶æ‰“å¼€ QUIC å’Œä¼ ç»Ÿ TCP è¿æ¥ï¼Œå¹¶åœ¨ QUIC è¿æ¥å¤±è´¥æ—¶ä»¥é›¶å»¶è¿Ÿå›é€€åˆ° TCP è¿æ¥ã€‚</p><h3 id="æµé‡æ§åˆ¶"><a href="#æµé‡æ§åˆ¶" class="headerlink" title="æµé‡æ§åˆ¶"></a>æµé‡æ§åˆ¶</h3><p><span style="color: red">æ³¨æ„ï¼šæµé‡æ§åˆ¶æ˜¯ QUICK å®ç°çš„ï¼ŒUDP å¹¶æ²¡æœ‰</span></p><p>ä¸å¤§å¤šæ•°ä¼ è¾“åè®®ä¸€æ ·ï¼Œ<strong>QUIC å…·æœ‰æµé‡æ§åˆ¶ä»¥ä¿æŠ¤æ¥æ”¶ç«¯å…å—ç¼“å†²å™¨ overflow çš„å½±å“</strong>ã€‚QUIC æ˜¯åŸºäº UDP ä¼ è¾“ï¼Œè€Œ UDP æ²¡æœ‰æµé‡æ§åˆ¶ï¼Œ<code>å› æ­¤ QUIC å®ç°äº†è‡ªå·±çš„æµé‡æ§åˆ¶æœºåˆ¶</code>ã€‚ä¸ TCP ä¸åŒï¼ŒQUIC å¹¶éé€šè¿‡ ACK å›åº”ç›®å‰æ¥æ”¶åˆ°ç¬¬å‡ ç¬”èµ„æ–™ï¼Œè€Œæ˜¯é€šè¿‡ <code>control frame </code>å®ç°ç±»ä¼¼äº HTTP&#x2F;2 çš„åŸºäºä¿¡ç”¨çš„æ–¹æ¡ˆã€‚</p><h2 id="HTTP-çš„å‘å±•å†å²"><a href="#HTTP-çš„å‘å±•å†å²" class="headerlink" title="HTTP çš„å‘å±•å†å²"></a>HTTP çš„å‘å±•å†å²</h2><p>å…ˆåç»å†äº†ï¼š</p><ul><li>ä¸‡ç»´ç½‘çš„å‘æ˜</li><li>HTTP&#x2F;0.9 - å•è¡Œåè®®</li><li>HTTP&#x2F;1.0 - æ„å»ºå¯æ‰©å±•æ€§</li><li>HTTP&#x2F;1.1 - æ ‡å‡†åŒ–çš„åè®®</li><li>è¶…è¿‡ 15 å¹´çš„å‘å±•ï¼ˆrestful apiã€Server-send eventsã€WebSocketã€è·¨åŸŸèµ„æºå…±äº« CORSã€å†…å®¹å®‰å…¨ç­–ç•¥ CSPã€éšç§æ§åˆ¶ DNTã€X-Frame-Optionsï¼‰</li><li>HTTP2 - ä¸ºäº†æ›´ä¼˜å¼‚çš„è¡¨ç°</li><li>HTTP3 - å¼ƒç”¨ TCP åè®®</li></ul><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Evolution_of_HTTP" target="_blank" >è§</a></p><h2 id="X-Frame-Options"><a href="#X-Frame-Options" class="headerlink" title="X-Frame-Options"></a>X-Frame-Options</h2><p>X-Frame-Options HTTP å“åº”å¤´æ˜¯ç”¨æ¥ç»™æµè§ˆå™¨æŒ‡ç¤ºå…è®¸ä¸€ä¸ªé¡µé¢å¯å¦åœ¨ <code>&lt;frame&gt;</code>ã€<code>&lt;iframe&gt;</code>ã€<code>&lt;embed&gt;</code> æˆ–è€… <code>&lt;object&gt;</code> ä¸­å±•ç°çš„æ ‡è®°ã€‚ç«™ç‚¹å¯ä»¥é€šè¿‡ç¡®ä¿ç½‘ç«™æ²¡æœ‰è¢«åµŒå…¥åˆ°åˆ«äººçš„ç«™ç‚¹é‡Œé¢ï¼Œä»è€Œé¿å…ç‚¹å‡»åŠ«æŒæ”»å‡»ã€‚</p><pre class="line-numbers language-none"><code class="language-none">X-Frame-Options: DENYX-Frame-Options: SAMEORIGIN</code></pre><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Frame-Options" target="_blank" >è§</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Connection_management_in_HTTP_1.x" target="_blank" >MDN HTTP è¿æ¥ç®¡ç†</a></p><p><a href="https://zh.wikipedia.org/wiki/QUIC" target="_blank" >ç»´åŸºç™¾ç§‘ QUIC</a></p><p><a href="https://zh.wikipedia.org/wiki/HTTP/3" target="_blank" >ç»´åŸºç™¾ç§‘ HTTP&#x2F;3</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-http CORS</title>
      <link href="//post/2022-07-26http-CORS.html"/>
      <url>//post/2022-07-26http-CORS.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><!-- <img src="http://t-blog-images.aijs.top/img/202208011714853.webp"  style="max-width:100%;width: 400px"/> --><img src="http://t-blog-images.aijs.top/img/202208011718040.webp"  style="max-width:100%;width: 400px"/><h2 id="è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰"><a href="#è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰" class="headerlink" title="è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰"></a>è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰</h2><p>CORS ï¼ˆCross-Origin Resource Sharingï¼Œè·¨åŸŸèµ„æºå…±äº«ï¼‰æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå®ƒç”±ä¸€ç³»åˆ—ä¼ è¾“çš„ HTTP å¤´ç»„æˆï¼Œè¿™äº› HTTP å¤´å†³å®šæµè§ˆå™¨æ˜¯å¦é˜»æ­¢å‰ç«¯ JavaScript ä»£ç è·å–è·¨åŸŸè¯·æ±‚çš„å“åº”ã€‚</p><p><code>åŒæºå®‰å…¨ç­–ç•¥</code> é»˜è®¤é˜»æ­¢â€œè·¨åŸŸâ€è·å–èµ„æºã€‚ä½†æ˜¯ <code>CORS ç»™äº† web æœåŠ¡å™¨è¿™æ ·çš„æƒé™</code>ï¼Œå³æœåŠ¡å™¨å¯ä»¥é€‰æ‹©ï¼Œå…è®¸è·¨åŸŸè¯·æ±‚è®¿é—®åˆ°å®ƒä»¬çš„èµ„æºã€‚</p><p><code>è·¨æºèµ„æºå…±äº« (CORS)</code>ï¼ˆæˆ–é€šä¿—åœ°è¯‘ä¸º<code>è·¨åŸŸèµ„æºå…±äº«</code>ï¼‰æ˜¯ä¸€ç§<strong>åŸºäº HTTP å¤´çš„æœºåˆ¶</strong>ï¼Œè¯¥æœºåˆ¶é€šè¿‡å…è®¸æœåŠ¡å™¨æ ‡ç¤ºé™¤äº†å®ƒè‡ªå·±ä»¥å¤–çš„å…¶å®ƒ originï¼ˆåŸŸï¼Œåè®®å’Œç«¯å£ï¼‰ï¼Œä½¿å¾—æµè§ˆå™¨å…è®¸è¿™äº› origin è®¿é—®åŠ è½½è‡ªå·±çš„èµ„æºã€‚<strong>è·¨æºèµ„æºå…±äº«è¿˜é€šè¿‡ä¸€ç§æœºåˆ¶æ¥æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ä¼šå…è®¸è¦å‘é€çš„çœŸå®è¯·æ±‚ï¼Œè¯¥æœºåˆ¶é€šè¿‡æµè§ˆå™¨å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨æ‰˜ç®¡çš„è·¨æºèµ„æºçš„â€é¢„æ£€â€è¯·æ±‚</strong>ã€‚<strong>åœ¨é¢„æ£€ä¸­ï¼Œæµè§ˆå™¨å‘é€çš„å¤´ä¸­æ ‡ç¤ºæœ‰ HTTP æ–¹æ³•å’ŒçœŸå®è¯·æ±‚ä¸­ä¼šç”¨åˆ°çš„å¤´ã€‚</strong></p><p>å‡ºäºå®‰å…¨æ€§(<code>åº”å¯¹CSRFæ”»å‡»</code>)ï¼Œæµè§ˆå™¨<strong>é™åˆ¶</strong>è„šæœ¬å†…å‘èµ·çš„è·¨æº <code>HTTP</code> è¯·æ±‚ã€‚ ä¾‹å¦‚ï¼Œ<code>XMLHttpRequest</code> å’Œ <code>Fetch API</code> éµå¾ªåŒæºç­–ç•¥ã€‚è¿™æ„å‘³ç€ä½¿ç”¨è¿™äº› API çš„ Web åº”ç”¨ç¨‹åºåªèƒ½ä»åŠ è½½åº”ç”¨ç¨‹åºçš„åŒä¸€ä¸ªåŸŸè¯·æ±‚ HTTP èµ„æºï¼Œé™¤éå“åº”æŠ¥æ–‡åŒ…å«äº†æ­£ç¡® CORS å“åº”å¤´ã€‚</p><img src="http://t-blog-images.aijs.top/img/202207261534554.webp" style="max-width: 100%; width: 400px"/><p><code>è·¨æºåŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰æœºåˆ¶</code>, å…è®¸ Web åº”ç”¨æœåŠ¡å™¨è¿›è¡Œè·¨æºè®¿é—®æ§åˆ¶ï¼Œä»è€Œä½¿è·¨æºæ•°æ®ä¼ è¾“å¾—ä»¥å®‰å…¨è¿›è¡Œã€‚ç°ä»£æµè§ˆå™¨æ”¯æŒåœ¨ API å®¹å™¨ä¸­ï¼ˆä¾‹å¦‚ <code>XMLHttpRequest</code> æˆ– <code>Fetch</code>ï¼‰ä½¿ç”¨ CORSï¼Œä»¥é™ä½è·¨æº <code>HTTP</code> è¯·æ±‚æ‰€å¸¦æ¥çš„é£é™©ã€‚</p><h2 id="ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦-CORSï¼Ÿ"><a href="#ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦-CORSï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ CORSï¼Ÿ"></a>ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ CORSï¼Ÿ</h2><ul><li><code>HTTP</code>è¯·æ±‚</li><li><code>Webå­—ä½“</code></li><li><code>WebGL</code>è´´å›¾</li><li>ä½¿ç”¨ <code>drawImage</code> å°† Images&#x2F;video ç”»é¢ç»˜åˆ¶åˆ° <code>canvas</code>ã€‚</li><li>æ¥è‡ªå›¾åƒçš„ CSS å›¾å½¢ <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Shapes/Shapes_From_Images#cors_compatibility" target="_blank" >è§</a></li></ul><h2 id="åŠŸèƒ½æ¦‚è¿°"><a href="#åŠŸèƒ½æ¦‚è¿°" class="headerlink" title="åŠŸèƒ½æ¦‚è¿°"></a>åŠŸèƒ½æ¦‚è¿°</h2><ul><li><p>è·¨æºèµ„æºå…±äº«æ ‡å‡†æ–°å¢äº†ä¸€ç»„ <code>HTTP</code> é¦–éƒ¨å­—æ®µï¼Œå…è®¸æœåŠ¡å™¨å£°æ˜å“ªäº›æºç«™é€šè¿‡æµè§ˆå™¨æœ‰æƒé™è®¿é—®å“ªäº›èµ„æºã€‚</p></li><li><p>å¯¹é‚£äº›<code>å¯èƒ½å¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿå‰¯ä½œç”¨çš„ HTTP è¯·æ±‚æ–¹æ³•</code>ï¼ˆç‰¹åˆ«æ˜¯ <code>GET</code> ä»¥å¤–çš„ <code>HTTP</code> è¯·æ±‚ï¼Œæˆ–è€…æ­é…æŸäº› MIME ç±»å‹ çš„ <code>POST</code> è¯·æ±‚ï¼‰ï¼Œæµè§ˆå™¨å¿…é¡»é¦–å…ˆä½¿ç”¨ <code>OPTIONS</code> æ–¹æ³•å‘èµ·ä¸€ä¸ª<code>é¢„æ£€è¯·æ±‚</code>ï¼ˆpreflight requestï¼‰ï¼Œä»è€Œè·çŸ¥æœåŠ¡ç«¯æ˜¯å¦å…è®¸è¯¥è·¨æºè¯·æ±‚ã€‚æœåŠ¡å™¨ç¡®è®¤å…è®¸ä¹‹åï¼Œæ‰å‘èµ·å®é™…çš„ HTTP è¯·æ±‚ã€‚åœ¨é¢„æ£€è¯·æ±‚çš„è¿”å›ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥é€šçŸ¥å®¢æˆ·ç«¯ï¼Œ<code>æ˜¯å¦éœ€è¦æºå¸¦èº«ä»½å‡­è¯</code>ï¼ˆåŒ…æ‹¬ <code>Cookies</code> å’Œ <code>HTTP è®¤è¯</code> ç›¸å…³æ•°æ®ï¼‰ã€‚</p></li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><code>CORS</code> è¯·æ±‚å¤±è´¥ä¼šäº§ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨ï¼Œåœ¨ <code>JavaScript ä»£ç å±‚é¢æ˜¯æ— æ³•è·çŸ¥åˆ°åº•å…·ä½“æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜</code>ã€‚ä½ åªèƒ½æŸ¥çœ‹æµè§ˆå™¨çš„æ§åˆ¶å°ä»¥å¾—çŸ¥å…·ä½“æ˜¯å“ªé‡Œå‡ºç°äº†é”™è¯¯ã€‚</p></div><h2 id="HTTP-è®¿é—®æ§åˆ¶åœºæ™¯"><a href="#HTTP-è®¿é—®æ§åˆ¶åœºæ™¯" class="headerlink" title="HTTP è®¿é—®æ§åˆ¶åœºæ™¯"></a>HTTP è®¿é—®æ§åˆ¶åœºæ™¯</h2><h3 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h3><p><strong>æŸäº›è¯·æ±‚ä¸ä¼šè§¦å‘ CORS é¢„æ£€è¯·æ±‚</strong>ã€‚æœ¬æ–‡ç§°è¿™æ ·çš„è¯·æ±‚ä¸º<code>â€œç®€å•è¯·æ±‚â€</code>ï¼Œè¯·æ³¨æ„ï¼Œè¯¥æœ¯è¯­å¹¶ä¸å±äº Fetchï¼ˆå…¶ä¸­å®šä¹‰äº† CORSï¼‰è§„èŒƒã€‚è‹¥è¯·æ±‚ æ»¡è¶³æ‰€æœ‰ä¸‹è¿°æ¡ä»¶ï¼Œåˆ™è¯¥è¯·æ±‚å¯è§†ä¸ºâ€œç®€å•è¯·æ±‚â€ï¼š</p><ul><li><p>ä½¿ç”¨ä¸‹åˆ—æ–¹æ³•ä¹‹ä¸€ï¼š<code>GET</code>ã€<code>HEAD</code>ã€<code>POST</code></p><br/><br/></li><li><p>é™¤äº†è¢«ç”¨æˆ·ä»£ç†è‡ªåŠ¨è®¾ç½®çš„é¦–éƒ¨å­—æ®µï¼ˆä¾‹å¦‚ <code>Connection</code>ï¼Œ<code>User-Agent</code>ï¼‰å’Œåœ¨ <code>Fetch</code> è§„èŒƒä¸­å®šä¹‰ä¸º ç¦ç”¨é¦–éƒ¨åç§° çš„å…¶ä»–é¦–éƒ¨ï¼Œå…è®¸äººä¸ºè®¾ç½®çš„å­—æ®µä¸º <code>Fetch</code> è§„èŒƒå®šä¹‰çš„ å¯¹ <code>CORS</code> å®‰å…¨çš„é¦–éƒ¨å­—æ®µé›†åˆ</p><pre class="line-numbers language-none"><code class="language-none">AcceptAccept-LanguageContent-LanguageContent-Typeï¼ˆéœ€è¦æ³¨æ„é¢å¤–çš„é™åˆ¶ï¼‰</code></pre></li><li><p><code>Content-Type</code> çš„å€¼ä»…é™äºä¸‹åˆ—ä¸‰è€…ä¹‹ä¸€ï¼š</p><pre class="line-numbers language-none"><code class="language-none">text&#x2F;plainmultipart&#x2F;form-dataapplication&#x2F;x-www-form-urlencoded</code></pre><br/><br/></li><li><p>è¯·æ±‚ä¸­çš„ä»»æ„ <code>XMLHttpRequest</code> å¯¹è±¡å‡æ²¡æœ‰æ³¨å†Œä»»ä½•äº‹ä»¶ç›‘å¬å™¨ï¼›ï¼ˆé™¤äº†ï¼š <code>XMLHttpRequest</code> å¯¹è±¡å¯ä»¥ä½¿ç”¨ <code>XMLHttpRequest.upload</code> å±æ€§è®¿é—®)</p><br/><br/></li><li><p>è¯·æ±‚ä¸­æ²¡æœ‰ä½¿ç”¨ <code>ReadableStream</code> å¯¹è±¡</p></li></ul><p>æ¯”å¦‚è¯´ï¼Œå‡å¦‚ç«™ç‚¹ <code>https://foo.example</code> çš„ç½‘é¡µåº”ç”¨æƒ³è¦è®¿é—® <code>https://bar.other</code> çš„èµ„æºã€‚foo.example çš„ç½‘é¡µä¸­å¯èƒ½åŒ…å«ç±»ä¼¼äºä¸‹é¢çš„ JavaScript ä»£ç ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const xhr &#x3D; new XMLHttpRequest();const url &#x3D; &quot;https:&#x2F;&#x2F;bar.other&#x2F;resources&#x2F;public-data&#x2F;&quot;;xhr.open(&quot;GET&quot;, url);xhr.onreadystatechange &#x3D; someHandler;xhr.send();</code></pre><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨ <code>CORS</code> é¦–éƒ¨å­—æ®µæ¥å¤„ç†æƒé™ï¼š</p><p>ä»¥ä¸‹æ˜¯æµè§ˆå™¨å‘é€ç»™æœåŠ¡å™¨çš„è¯·æ±‚æŠ¥æ–‡ï¼š</p><pre class="line-numbers language-GET" data-language="GET"><div class="caption"><span>/resources/public-data/ HTTP/1.1</span></div><code class="language-GET">Host: bar.otherUser-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko&#x2F;20100101 Firefox&#x2F;71.0Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8Accept-Language: en-us,en;q&#x3D;0.5Accept-Encoding: gzip,deflateConnection: keep-aliveOrigin: https:&#x2F;&#x2F;foo.example</code></pre><p>è¯·æ±‚é¦–éƒ¨å­—æ®µ <code>Origin</code> è¡¨æ˜è¯¥è¯·æ±‚æ¥æºäº <code>http://foo.example</code></p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 200 OKDate: Mon, 01 Dec 2008 00:23:53 GMTServer: Apache&#x2F;2Access-Control-Allow-Origin: *Keep-Alive: timeout&#x3D;2, max&#x3D;100Connection: Keep-AliveTransfer-Encoding: chunkedContent-Type: application&#x2F;xml[XML Data]</code></pre><p>æœ¬ä¾‹ä¸­ï¼ŒæœåŠ¡ç«¯è¿”å›çš„ <code>Access-Control-Allow-Origin: * </code>è¡¨æ˜ï¼Œè¯¥èµ„æºå¯ä»¥è¢« <em>ä»»æ„</em> å¤–åŸŸè®¿é—®ã€‚</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Origin: *</code></pre><p>ä½¿ç”¨ <code>Origin</code> å’Œ <code>Access-Control-Allow-Origin</code> å°±èƒ½å®Œæˆæœ€ç®€å•çš„è®¿é—®æ§åˆ¶ã€‚å¦‚æœæœåŠ¡ç«¯ä»…å…è®¸æ¥è‡ª <a href="https://foo.example/">https://foo.example</a> çš„è®¿é—®ï¼Œè¯¥é¦–éƒ¨å­—æ®µçš„å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Origin: https:&#x2F;&#x2F;foo.example</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>å¤‡æ³¨ï¼š å½“å“åº”çš„æ˜¯é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ç«¯ å¿…é¡» æ˜ç¡® Access-Control-Allow-Origin çš„å€¼ï¼Œè€Œä¸èƒ½ä½¿ç”¨é€šé…ç¬¦â€œ*â€ã€‚ä¸è¿‡å¯ä»¥æ˜¯<code>$http_origin</code> <a href="https://blog.csdn.net/u014589884/article/details/108028681" target="_blank" >$http_XXX è¿™ä¸ªæ ¼å¼æ˜¯ nginx å–è¯·æ±‚ä¸­ header çš„ XXX çš„å€¼çš„</a></p></div><h3 id="é¢„æ£€è¯·æ±‚"><a href="#é¢„æ£€è¯·æ±‚" class="headerlink" title="é¢„æ£€è¯·æ±‚"></a>é¢„æ£€è¯·æ±‚</h3><p>ä¸å‰è¿°ç®€å•è¯·æ±‚ä¸åŒï¼Œâ€œéœ€é¢„æ£€çš„è¯·æ±‚â€è¦æ±‚å¿…é¡»é¦–å…ˆä½¿ç”¨ OPTIONS æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œä»¥è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥å®é™…è¯·æ±‚ã€‚â€é¢„æ£€è¯·æ±‚â€œçš„ä½¿ç”¨ï¼Œå¯ä»¥é¿å…è·¨åŸŸè¯·æ±‚å¯¹æœåŠ¡å™¨çš„ç”¨æˆ·æ•°æ®äº§ç”Ÿæœªé¢„æœŸçš„å½±å“ã€‚<br>å¦‚ä¸‹æ˜¯ä¸€ä¸ªéœ€è¦æ‰§è¡Œé¢„æ£€è¯·æ±‚çš„ HTTP è¯·æ±‚ï¼š<span style="color: red">é¢„æ£€æ˜¯æµè§ˆå™¨ä¸»åŠ¨å‘èµ·çš„ï¼Œç ”å‘éƒ½ä¸ç”¨åš</span></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const xhr &#x3D; new XMLHttpRequest();xhr.open(&quot;POST&quot;, &quot;https:&#x2F;&#x2F;bar.other&#x2F;resources&#x2F;post-here&#x2F;&quot;);xhr.setRequestHeader(&quot;X-PINGOTHER&quot;, &quot;pingpong&quot;);xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application&#x2F;xml&quot;);xhr.onreadystatechange &#x3D; handler;xhr.send(&quot;&lt;person&gt;&lt;name&gt;Arun&lt;&#x2F;name&gt;&lt;&#x2F;person&gt;&quot;);</code></pre><p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨ <code>POST</code> è¯·æ±‚å‘é€ä¸€ä¸ª <code>XML</code> æ–‡æ¡£ï¼Œè¯¥è¯·æ±‚åŒ…å«äº†ä¸€ä¸ª<code>è‡ªå®šä¹‰çš„è¯·æ±‚é¦–éƒ¨å­—æ®µï¼ˆX-PINGOTHER: pingpongï¼‰</code>ã€‚å¦å¤–ï¼Œè¯¥è¯·æ±‚çš„ <code>Content-Type</code> ä¸º <code>application/xml</code>ã€‚å› æ­¤ï¼Œè¯¥è¯·æ±‚éœ€è¦é¦–å…ˆå‘èµ·â€œé¢„æ£€è¯·æ±‚â€ã€‚</p><img src="http://t-blog-images.aijs.top/img/202207261604436.webp" style="max-width: 100%; width: 400px"/><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>å¤‡æ³¨ï¼š å¦‚ä¸‹æ‰€è¿°ï¼Œå®é™…çš„ POST è¯·æ±‚ä¸ä¼šæºå¸¦ Access-Control-Request-* é¦–éƒ¨ï¼Œå®ƒä»¬ä»…ç”¨äº OPTIONS è¯·æ±‚ã€‚</p></p></div><p><strong>ä¸‹é¢æ˜¯æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å®Œæ•´çš„ä¿¡æ¯äº¤äº’ã€‚é¦–æ¬¡äº¤äº’æ˜¯ é¢„æ£€è¯·æ±‚&#x2F;å“åº”ï¼š</strong></p><pre class="line-numbers language-none"><code class="language-none">OPTIONS &#x2F;doc HTTP&#x2F;1.1 # è¿™é‡ŒHost: bar.otherUser-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko&#x2F;20100101 Firefox&#x2F;71.0Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8Accept-Language: en-us,en;q&#x3D;0.5Accept-Encoding: gzip,deflateConnection: keep-aliveOrigin: https:&#x2F;&#x2F;foo.example # è¿™é‡ŒAccess-Control-Request-Method: POST # è¿™é‡ŒAccess-Control-Request-Headers: X-PINGOTHER, Content-Type # è¿™é‡ŒHTTP&#x2F;1.1 204 No ContentDate: Mon, 01 Dec 2008 01:15:39 GMTServer: Apache&#x2F;2Access-Control-Allow-Origin: https:&#x2F;&#x2F;foo.exampleAccess-Control-Allow-Methods: POST, GET, OPTIONSAccess-Control-Allow-Headers: X-PINGOTHER, Content-TypeAccess-Control-Max-Age: 86400Vary: Accept-Encoding, OriginKeep-Alive: timeout&#x3D;2, max&#x3D;100Connection: Keep-Alive</code></pre><p>æµè§ˆå™¨æ£€æµ‹åˆ°ï¼Œä» <code>JavaScript</code> ä¸­å‘èµ·çš„è¯·æ±‚éœ€è¦è¢«é¢„æ£€ã€‚ä»ä¸Šé¢çš„æŠ¥æ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œç¬¬ 1~10 è¡Œå‘é€äº†ä¸€ä¸ªä½¿ç”¨ OPTIONS æ–¹æ³• çš„â€œé¢„æ£€è¯·æ±‚â€ã€‚<strong>OPTIONS æ˜¯ HTTP&#x2F;1.1 åè®®ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œç”¨ä»¥ä»æœåŠ¡å™¨è·å–æ›´å¤šä¿¡æ¯</strong>ã€‚<strong>è¯¥æ–¹æ³•ä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“</strong>ã€‚ é¢„æ£€è¯·æ±‚ä¸­åŒæ—¶æºå¸¦äº†ä¸‹é¢ä¸¤ä¸ªé¦–éƒ¨å­—æ®µï¼š</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Request-Method: POSTAccess-Control-Request-Headers: X-PINGOTHER, Content-Type # X-PINGOTHER æ˜¯è‡ªå®šä¹‰çš„</code></pre><p>é¦–éƒ¨å­—æ®µ <code>Access-Control-Request-Method</code> å‘ŠçŸ¥æœåŠ¡å™¨ï¼Œå®é™…è¯·æ±‚å°†ä½¿ç”¨ <code>POST</code> æ–¹æ³•ã€‚<br>é¦–éƒ¨å­—æ®µ <code>Access-Control-Request-Headers</code> å‘ŠçŸ¥æœåŠ¡å™¨ï¼Œå®é™…è¯·æ±‚å°†æºå¸¦ä¸¤ä¸ªè‡ªå®šä¹‰è¯·æ±‚é¦–éƒ¨å­—æ®µï¼š<code>X-PINGOTHER</code> ä¸ <code>Content-Type</code>ã€‚æœåŠ¡å™¨æ®æ­¤å†³å®šï¼Œè¯¥å®é™…è¯·æ±‚æ˜¯å¦è¢«å…è®¸ã€‚</p><p>ç¬¬ 13-22 è¡Œä¸ºé¢„æ£€è¯·æ±‚çš„å“åº”ï¼Œè¡¨æ˜æœåŠ¡å™¨å°†æ¥å—åç»­çš„å®é™…è¯·æ±‚ã€‚é‡ç‚¹çœ‹ç¬¬ 16-19 è¡Œï¼š</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Origin: https:&#x2F;&#x2F;foo.exampleAccess-Control-Allow-Methods: POST, GET, OPTIONSAccess-Control-Allow-Headers: X-PINGOTHER, Content-TypeAccess-Control-Max-Age: 86400</code></pre><p>æœåŠ¡å™¨çš„å“åº”æºå¸¦äº† <code>Access-Control-Allow-Origin: https://foo.example</code>ï¼Œä»è€Œé™åˆ¶è¯·æ±‚çš„æºåŸŸã€‚åŒæ—¶ï¼Œæºå¸¦çš„ <code>Access-Control-Allow-Methods</code> è¡¨æ˜æœåŠ¡å™¨å…è®¸å®¢æˆ·ç«¯ä½¿ç”¨ <code>POST</code> å’Œ <code>GET</code> æ–¹æ³•å‘èµ·è¯·æ±‚ï¼ˆä¸ <code>Allow</code> å“åº”é¦–éƒ¨ç±»ä¼¼ï¼Œä½†å…¶å…·æœ‰ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ï¼‰ã€‚</p><p>é¦–éƒ¨å­—æ®µ <code>Access-Control-Allow-Headers</code> è¡¨æ˜æœåŠ¡å™¨å…è®¸è¯·æ±‚ä¸­æºå¸¦å­—æ®µ X-<code>PINGOTHER</code> ä¸<code> Content-Type</code>ã€‚ä¸ <code>Access-Control-Allow-Methods</code> ä¸€æ ·ï¼Œ<code>Access-Control-Allow-Headers</code> çš„å€¼ä¸ºé€—å·åˆ†å‰²çš„åˆ—è¡¨ã€‚</p><p>æœ€åï¼Œé¦–éƒ¨å­—æ®µ <code>Access-Control-Max-Age</code> è¡¨æ˜è¯¥å“åº”çš„æœ‰æ•ˆæ—¶é—´ä¸º <code>86400</code> ç§’ï¼Œä¹Ÿå°±æ˜¯ 24 å°æ—¶ã€‚<strong>åœ¨æœ‰æ•ˆæ—¶é—´å†…ï¼Œæµè§ˆå™¨æ— é¡»ä¸ºåŒä¸€è¯·æ±‚å†æ¬¡å‘èµ·é¢„æ£€è¯·æ±‚ã€‚</strong> <span style="color: red">è¯·æ³¨æ„ï¼Œæµè§ˆå™¨è‡ªèº«ç»´æŠ¤äº†ä¸€ä¸ª æœ€å¤§æœ‰æ•ˆæ—¶é—´ï¼Œå¦‚æœè¯¥é¦–éƒ¨å­—æ®µçš„å€¼è¶…è¿‡äº†æœ€å¤§æœ‰æ•ˆæ—¶é—´ï¼Œå°†ä¸ä¼šç”Ÿæ•ˆã€‚</span></p><h3 id="é¢„æ£€ä¼šæ‹–æ…¢é€Ÿåº¦"><a href="#é¢„æ£€ä¼šæ‹–æ…¢é€Ÿåº¦" class="headerlink" title="é¢„æ£€ä¼šæ‹–æ…¢é€Ÿåº¦"></a>é¢„æ£€ä¼šæ‹–æ…¢é€Ÿåº¦</h3><p>ç±»ä¼¼è¦å»çœ‹ç—…ï¼Œå…ˆé¢„æ£€å°ã€æŒ‚å·ã€åˆ†è¯Šã€‚ã€‚ã€‚å¯¹äºâ€œæ€¥è¯Šçš„â€å’‹æ•´ï¼Ÿ</p><p><code>Access-Control-Max-Age</code>æ•´ä¸ªä¸Šé™ï¼Œå¯¹äºä¸åŒçš„æµè§ˆå™¨ä¸Šé™è¦åŒºåˆ«å¯¹å¾…ï¼Œ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age" target="_blank" >è§</a></p><h3 id="é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚"><a href="#é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚" class="headerlink" title="é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚"></a>é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚</h3><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>å½“å‘å‡ºè·¨æºè¯·æ±‚æ—¶ï¼Œç¬¬ä¸‰æ–¹ cookie ç­–ç•¥ä»å°†é€‚ç”¨ã€‚æ— è®ºå¦‚ä½•æ”¹å˜æœ¬ç« èŠ‚ä¸­æè¿°çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„è®¾ç½®ï¼Œè¯¥ç­–ç•¥éƒ½ä¼šå¼ºåˆ¶æ‰§è¡Œ</p></div><p><code>XMLHttpRequest</code> æˆ– <code>Fetch</code> ä¸ <code>CORS</code> çš„ä¸€ä¸ªæœ‰è¶£çš„ç‰¹æ€§æ˜¯ï¼Œå¯ä»¥åŸºäº<code> HTTP cookies</code> å’Œ<code> HTTP è®¤è¯ä¿¡æ¯</code>å‘é€èº«ä»½å‡­è¯ã€‚<br>ä¸€èˆ¬è€Œè¨€ï¼Œå¯¹äºè·¨æº <code>XMLHttpRequest</code> æˆ– <code>Fetch</code> è¯·æ±‚ï¼Œæµè§ˆå™¨ <em>ä¸ä¼š</em> å‘é€èº«ä»½å‡­è¯ä¿¡æ¯ã€‚<strong>å¦‚æœè¦å‘é€å‡­è¯ä¿¡æ¯ï¼Œéœ€è¦è®¾ç½® XMLHttpRequest çš„æŸä¸ªç‰¹æ®Šæ ‡å¿—ä½ã€‚</strong></p><p>æœ¬ä¾‹ä¸­ï¼Œ<a href="https://foo.example/">https://foo.example</a> çš„æŸè„šæœ¬å‘ <a href="https://bar.other/">https://bar.other</a> å‘èµ·ä¸€ä¸ª GET è¯·æ±‚ï¼Œå¹¶è®¾ç½® Cookiesï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const invocation &#x3D; new XMLHttpRequest();const url &#x3D; &quot;https:&#x2F;&#x2F;bar.other&#x2F;resources&#x2F;credentialed-content&#x2F;&quot;;function callOtherDomain() &#123;  if (invocation) &#123;    invocation.open(&quot;GET&quot;, url, true);    invocation.withCredentials &#x3D; true; &#x2F;&#x2F; è¿™é‡Œ    invocation.onreadystatechange &#x3D; handler;    invocation.send();  &#125;&#125;</code></pre><p>ç¬¬ 7 è¡Œå°† <code>XMLHttpRequest</code> çš„ <code>withCredentials</code> æ ‡å¿—è®¾ç½®ä¸º <code>true</code>ï¼Œä»è€Œå‘æœåŠ¡å™¨å‘é€ <code>Cookies</code>ã€‚<br><strong>å› ä¸ºè¿™æ˜¯ä¸€ä¸ªç®€å• GET è¯·æ±‚ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¸ä¼šå¯¹å…¶å‘èµ·â€œé¢„æ£€è¯·æ±‚â€</strong>ã€‚ä½†æ˜¯ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯çš„å“åº”ä¸­æœªæºå¸¦ <code>Access-Control-Allow-Credentials: true</code>ï¼Œ<strong>æµè§ˆå™¨å°†ä¸ä¼šæŠŠå“åº”å†…å®¹è¿”å›ç»™è¯·æ±‚çš„å‘é€è€…</strong>ã€‚</p><img src="http://t-blog-images.aijs.top/img/202207261630388.webp" style="max-width: 100%; width: 400px"/><p>CORS é¢„æ£€è¯·æ±‚ä¸èƒ½åŒ…å«å‡­æ®ã€‚é¢„æ£€è¯·æ±‚çš„ <em>å“åº”</em> å¿…é¡»æŒ‡å®š <code>Access-Control-Allow-Credentials: true</code> æ¥è¡¨æ˜å¯ä»¥æºå¸¦å‡­æ®è¿›è¡Œå®é™…çš„è¯·æ±‚ã€‚</p><p><strong>é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ä¸é€šé…ç¬¦</strong></p><p>åœ¨å“åº”é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚æ—¶ï¼š</p><ul><li>æœåŠ¡å™¨ä¸èƒ½å°† <code>Access-Control-Allow-Origin</code> çš„å€¼è®¾ä¸ºé€šé…ç¬¦â€œ*â€ï¼Œè€Œåº”å°†å…¶è®¾ç½®ä¸ºç‰¹å®šçš„åŸŸï¼Œå¦‚ï¼š<code>Access-Control-Allow-Origin: https://example.com</code>ã€‚</li><li>æœåŠ¡å™¨ä¸èƒ½å°† <code>Access-Control-Allow-Headers</code>çš„å€¼è®¾ä¸ºé€šé…ç¬¦â€œ*â€ï¼Œè€Œåº”å°†å…¶è®¾ç½®ä¸ºé¦–éƒ¨åç§°çš„åˆ—è¡¨ï¼Œå¦‚ï¼š<code>Access-Control-Allow-Headers: X-PINGOTHER, Content-Type</code></li><li>æœåŠ¡å™¨ä¸èƒ½å°† <code>Access-Control-Allow-Methods</code> çš„å€¼è®¾ä¸ºé€šé…ç¬¦â€œ*â€ï¼Œè€Œåº”å°†å…¶è®¾ç½®ä¸ºç‰¹å®šè¯·æ±‚æ–¹æ³•åç§°çš„åˆ—è¡¨ï¼Œå¦‚ï¼š<code>Access-Control-Allow-Methods: POST, GET</code></li><li>å¯¹äºé™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ï¼ˆé€šå¸¸æ˜¯ Cookieï¼‰ï¼ŒæœåŠ¡å™¨ä¸å¾—è®¾ç½® <code>Access-Control-Allow-Origin çš„å€¼ä¸ºâ€œ*â€</code>ã€‚</li></ul><p>è¿™æ˜¯å› ä¸ºè¯·æ±‚çš„é¦–éƒ¨ä¸­æºå¸¦äº† Cookie ä¿¡æ¯ï¼Œå¦‚æœ <code>Access-Control-Allow-Origin çš„å€¼ä¸ºâ€œ*â€</code>ï¼Œè¯·æ±‚å°†ä¼šå¤±è´¥ã€‚<br>è€Œå°† <code>Access-Control-Allow-Origin</code> çš„å€¼è®¾ç½®ä¸º <code>https://example.com</code>ï¼Œåˆ™è¯·æ±‚å°†æˆåŠŸæ‰§è¡Œã€‚<br>å¦å¤–ï¼Œå“åº”é¦–éƒ¨ä¸­ä¹Ÿæºå¸¦äº† <code>Set-Cookie</code> å­—æ®µï¼Œå°è¯•å¯¹ <code>Cookie</code> è¿›è¡Œä¿®æ”¹ã€‚å¦‚æœæ“ä½œå¤±è´¥(<code>SameSite</code>é™åˆ¶)ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p><strong>ç¬¬ä¸‰æ–¹ cookies</strong></p><p>åœ¨ <code>CORS</code> å“åº”ä¸­è®¾ç½®çš„ <code>cookies</code> é€‚ç”¨ä¸€èˆ¬æ€§ç¬¬ä¸‰æ–¹ <code>cookie</code> ç­–ç•¥, <code>Cookie</code> ç­–ç•¥å— <code>SameSite</code> å±æ€§æ§åˆ¶</p><h2 id="http-å“åº”é¦–éƒ¨å­—æ®µ"><a href="#http-å“åº”é¦–éƒ¨å­—æ®µ" class="headerlink" title="http å“åº”é¦–éƒ¨å­—æ®µ"></a>http å“åº”é¦–éƒ¨å­—æ®µ</h2><ul><li><code>Access-Control-Allow-Origin: &lt;origin&gt; | *</code>, å¯¹äºä¸éœ€è¦æºå¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æŒ‡å®šè¯¥å­—æ®µçš„å€¼ä¸ºé€šé…ç¬¦</li><li><code>Access-Control-Expose-Headers</code> , è®©æœåŠ¡å™¨æŠŠå…è®¸æµè§ˆå™¨è®¿é—®çš„å¤´æ”¾å…¥ç™½åå•</li><li><code>Access-Control-Max-Age: &lt;delta-seconds&gt;</code>, æŒ‡å®šäº† preflight è¯·æ±‚çš„ç»“æœèƒ½å¤Ÿè¢«ç¼“å­˜å¤šä¹…</li><li><code>Access-Control-Allow-Credentials</code>, å®ƒæŒ‡å®šäº†å®é™…çš„è¯·æ±‚æ˜¯å¦å¯ä»¥ä½¿ç”¨ credentials</li><li><code>Access-Control-Allow-Methods: &lt;method&gt;[, &lt;method&gt;]*</code>,å…¶æŒ‡æ˜äº†å®é™…è¯·æ±‚ä¸­å…è®¸æºå¸¦çš„é¦–éƒ¨å­—æ®µ</li><li><code>Access-Control-Allow-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*</code>, å…¶æŒ‡æ˜äº†å®é™…è¯·æ±‚ä¸­å…è®¸æºå¸¦çš„é¦–éƒ¨å­—æ®µ</li></ul><details class="custom-details"><summary>æŸ¥çœ‹æ›´å¤š</summary><p>æœ¬èŠ‚åˆ—å‡ºäº†è§„èŒƒæ‰€å®šä¹‰çš„å“åº”é¦–éƒ¨å­—æ®µã€‚ä¸Šä¸€å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†è¿™äº›é¦–éƒ¨å­—æ®µåœ¨å®é™…åœºæ™¯ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p><strong>Access-Control-Allow-Origin</strong></p><p>å“åº”é¦–éƒ¨ä¸­å¯ä»¥æºå¸¦ä¸€ä¸ª Access-Control-Allow-Origin å­—æ®µï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Origin: &lt;origin&gt; | *</code></pre><p>å…¶ä¸­ï¼Œorigin å‚æ•°çš„å€¼æŒ‡å®šäº†å…è®¸è®¿é—®è¯¥èµ„æºçš„å¤–åŸŸ URIã€‚<strong>å¯¹äºä¸éœ€è¦æºå¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æŒ‡å®šè¯¥å­—æ®µçš„å€¼ä¸ºé€šé…ç¬¦</strong>ï¼Œè¡¨ç¤ºå…è®¸æ¥è‡ªæ‰€æœ‰åŸŸçš„è¯·æ±‚ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„å­—æ®µå€¼å°†å…è®¸æ¥è‡ª <a href="https://mozilla.org/">https://mozilla.org</a> çš„è¯·æ±‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Origin: https:&#x2F;&#x2F;mozilla.orgVary: Origin</code></pre><p>_å¦‚æœæœåŠ¡ç«¯æŒ‡å®šäº†å…·ä½“çš„åŸŸåè€Œéâ€œ*â€ï¼Œé‚£ä¹ˆå“åº”é¦–éƒ¨ä¸­çš„ Vary å­—æ®µçš„å€¼å¿…é¡»åŒ…å« Originã€‚è¿™å°†å‘Šè¯‰å®¢æˆ·ç«¯ï¼šæœåŠ¡å™¨å¯¹ä¸åŒçš„æºç«™è¿”å›ä¸åŒçš„å†…å®¹_ã€‚</p><p><strong>Access-Control-Expose-Headers</strong><br>è¯‘è€…æ³¨ï¼šåœ¨è·¨æºè®¿é—®æ—¶ï¼Œ<code>XMLHttpRequest</code> å¯¹è±¡çš„ <code>getResponseHeader()</code> æ–¹æ³•åªèƒ½æ‹¿åˆ°ä¸€äº›æœ€åŸºæœ¬çš„å“åº”å¤´ï¼Œ</p><ul><li><code>Cache-Control</code>ã€</li><li><code>Content-Language</code>ã€</li><li><code>Content-Type</code>ã€</li><li><code>Expires</code>ã€</li><li><code>Last-Modified</code>ã€</li><li><code>Pragma</code><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Expose-Headers" target="_blank" >è§ Access-Control-Expose-Headers</a><br>å¦‚æœè¦è®¿é—®å…¶ä»–å¤´ï¼Œåˆ™éœ€è¦æœåŠ¡å™¨è®¾ç½®æœ¬å“åº”å¤´ã€‚</li></ul><p><code>Access-Control-Expose-Headers</code> å¤´, è®©æœåŠ¡å™¨æŠŠå…è®¸æµè§ˆå™¨è®¿é—®çš„å¤´æ”¾å…¥ç™½åå•ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Expose-Headers: X-My-Custom-Header, X-Another-Custom-Header</code></pre><p><strong>è¿™æ ·æµè§ˆå™¨å°±èƒ½å¤Ÿé€šè¿‡ getResponseHeader è®¿é—® X-My-Custom-Header å’Œ X-Another-Custom-Header å“åº”å¤´äº†ã€‚</strong></p><p><strong>Access-Control-Max-Age</strong><br>Access-Control-Max-Age å¤´æŒ‡å®šäº† preflight è¯·æ±‚çš„ç»“æœèƒ½å¤Ÿè¢«ç¼“å­˜å¤šä¹…ï¼Œè¯·å‚è€ƒæœ¬æ–‡åœ¨å‰é¢æåˆ°çš„ preflight ä¾‹å­ã€‚</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Max-Age: &lt;delta-seconds&gt;</code></pre><p>delta-seconds å‚æ•°è¡¨ç¤º preflight é¢„æ£€è¯·æ±‚çš„ç»“æœåœ¨å¤šå°‘ç§’å†…æœ‰æ•ˆã€‚</p><ul><li>åœ¨ Firefox ä¸­ï¼Œä¸Šé™æ˜¯ 24 å°æ—¶ ï¼ˆå³ 86400 ç§’ï¼‰ã€‚</li><li>åœ¨ Chromium v76 ä¹‹å‰ï¼Œ ä¸Šé™æ˜¯ 10 åˆ†é’Ÿï¼ˆå³ 600 ç§’)ã€‚</li><li>ä» Chromium v76 å¼€å§‹ï¼Œä¸Šé™æ˜¯ 2 å°æ—¶ï¼ˆå³ 7200 ç§’)ã€‚</li><li>Chromium åŒæ—¶è§„å®šäº†ä¸€ä¸ªé»˜è®¤å€¼ 5 ç§’ã€‚</li><li>å¦‚æœå€¼ä¸º -1ï¼Œè¡¨ç¤ºç¦ç”¨ç¼“å­˜ï¼Œåˆ™æ¯æ¬¡è¯·æ±‚å‰éƒ½éœ€è¦ä½¿ç”¨ OPTIONS é¢„æ£€è¯·æ±‚ã€‚<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age" target="_blank" >è§ Access-Control-Max-Age</a></li></ul><p><strong>Access-Control-Allow-Credentials</strong><br>Access-Control-Allow-Credentials å¤´æŒ‡å®šäº†å½“æµè§ˆå™¨çš„ credentials è®¾ç½®ä¸º true æ—¶æ˜¯å¦å…è®¸æµè§ˆå™¨è¯»å– response çš„å†…å®¹ã€‚å½“ç”¨åœ¨å¯¹ preflight é¢„æ£€æµ‹è¯·æ±‚çš„å“åº”ä¸­æ—¶ï¼Œå®ƒæŒ‡å®šäº†å®é™…çš„è¯·æ±‚æ˜¯å¦å¯ä»¥ä½¿ç”¨ credentialsã€‚è¯·æ³¨æ„ï¼šç®€å• GET è¯·æ±‚ä¸ä¼šè¢«é¢„æ£€ï¼›å¦‚æœå¯¹æ­¤ç±»è¯·æ±‚çš„å“åº”ä¸­ä¸åŒ…å«è¯¥å­—æ®µï¼Œè¿™ä¸ªå“åº”å°†è¢«å¿½ç•¥æ‰ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¹Ÿä¸ä¼šå°†ç›¸åº”å†…å®¹è¿”å›ç»™ç½‘é¡µã€‚</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Credentials: true</code></pre><p>ä¸Šæ–‡å·²ç»è®¨è®ºäº†é™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ã€‚</p><p><strong>Access-Control-Allow-Methods</strong><br>Access-Control-Allow-Methods é¦–éƒ¨å­—æ®µç”¨äºé¢„æ£€è¯·æ±‚çš„å“åº”ã€‚å…¶æŒ‡æ˜äº†å®é™…è¯·æ±‚æ‰€å…è®¸ä½¿ç”¨çš„ HTTP æ–¹æ³•ã€‚</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Methods: &lt;method&gt;[, &lt;method&gt;]*</code></pre><p>æœ‰å…³ preflight request çš„ç¤ºä¾‹å·²åœ¨ä¸Šæ–¹ç»™å‡ºã€‚</p><p><strong>Access-Control-Allow-Headers</strong><br>Access-Control-Allow-Headers é¦–éƒ¨å­—æ®µç”¨äºé¢„æ£€è¯·æ±‚çš„å“åº”ã€‚å…¶æŒ‡æ˜äº†å®é™…è¯·æ±‚ä¸­å…è®¸æºå¸¦çš„é¦–éƒ¨å­—æ®µã€‚</p><pre class="line-numbers language-none"><code class="language-none">Access-Control-Allow-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*</code></pre></p></details><h2 id="http-è¯·æ±‚é¦–éƒ¨å­—æ®µ"><a href="#http-è¯·æ±‚é¦–éƒ¨å­—æ®µ" class="headerlink" title="http è¯·æ±‚é¦–éƒ¨å­—æ®µ"></a>http è¯·æ±‚é¦–éƒ¨å­—æ®µ</h2><p>å¯ç”¨äºå‘èµ·è·¨æºè¯·æ±‚çš„é¦–éƒ¨å­—æ®µã€‚è¯·æ³¨æ„ï¼Œè¿™äº›é¦–éƒ¨å­—æ®µ<strong>æ— é¡»æ‰‹åŠ¨è®¾ç½®</strong>ã€‚ å½“å¼€å‘è€…ä½¿ç”¨ <code>XMLHttpRequest</code> å¯¹è±¡å‘èµ·è·¨æºè¯·æ±‚æ—¶ï¼Œå®ƒä»¬å·²ç»è¢«è®¾ç½®å°±ç»ªã€‚</p><ul><li><code>Origin</code> é¦–éƒ¨å­—æ®µè¡¨æ˜é¢„æ£€è¯·æ±‚æˆ–å®é™…è¯·æ±‚çš„æºç«™</li><li><code>Access-Control-Request-Method</code> é¦–éƒ¨å­—æ®µç”¨äºé¢„æ£€è¯·æ±‚ã€‚å…¶ä½œç”¨æ˜¯ï¼Œå°†å®é™…è¯·æ±‚æ‰€ä½¿ç”¨çš„ <code>HTTP</code> æ–¹æ³•å‘Šè¯‰æœåŠ¡å™¨ã€‚</li><li><code>Access-Control-Request-Headers</code> é¦–éƒ¨å­—æ®µç”¨äºé¢„æ£€è¯·æ±‚ã€‚å…¶ä½œç”¨æ˜¯ï¼Œå°†å®é™…è¯·æ±‚æ‰€æºå¸¦çš„é¦–éƒ¨å­—æ®µå‘Šè¯‰æœåŠ¡å™¨ã€‚</li></ul><h2 id="CORS-é”™è¯¯åŠå¤„ç†"><a href="#CORS-é”™è¯¯åŠå¤„ç†" class="headerlink" title="CORS é”™è¯¯åŠå¤„ç†"></a>CORS é”™è¯¯åŠå¤„ç†</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/Errors/CORSAllowOriginNotMatchingOrigin" target="_blank" >è§</a></p><h2 id="åœ¨-nestjs-ä¸­æœ¬åœ°è°ƒè¯•"><a href="#åœ¨-nestjs-ä¸­æœ¬åœ°è°ƒè¯•" class="headerlink" title="åœ¨ nestjs ä¸­æœ¬åœ°è°ƒè¯•"></a>åœ¨ nestjs ä¸­æœ¬åœ°è°ƒè¯•</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">async function bootstrap() &#123;  const app &#x3D; await NestFactory.create&lt;NestExpressApplication&gt;(    ApplicationModule,  )  &#x2F;&#x2F; å…è®¸è·¨åŸŸ  app.enableCors(&#123;    origin: &#39;http:&#x2F;&#x2F;127.0.0.1:5501&#39;,    credentials: true,  &#125;)</code></pre><p><strong>æ­£ç¡®ç»“æœ</strong></p><img src="http://t-blog-images.aijs.top/img/202208250949357.webp" /><ul><li>å»æ‰ <code>credentials: true,</code> æµ‹è¯•</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">app.enableCors(&#123;  origin: &quot;http:&#x2F;&#x2F;127.0.0.1:5501&quot;,  &#x2F;&#x2F; credentials: true,&#125;);</code></pre><img src="http://t-blog-images.aijs.top/img/202208291423214.webp" /><ul><li>å»æ‰ <code>origin: &#39;http://127.0.0.1:5501&#39;,</code> æµ‹è¯•</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">app.enableCors(&#123;  &#x2F;&#x2F; origin: &#39;http:&#x2F;&#x2F;127.0.0.1:5501&#39;,  credentials: true,&#125;);</code></pre><img src="http://t-blog-images.aijs.top/img/202208291425435.webp" /><h2 id="é˜¿é‡Œäº‘-COS-è·¨åŸŸé…ç½®"><a href="#é˜¿é‡Œäº‘-COS-è·¨åŸŸé…ç½®" class="headerlink" title="é˜¿é‡Œäº‘ COS è·¨åŸŸé…ç½®"></a>é˜¿é‡Œäº‘ COS è·¨åŸŸé…ç½®</h2><img src="http://t-blog-images.aijs.top/img/202209021744126.webp" style="width: 500px;max-width: 100%" /><img src="http://t-blog-images.aijs.top/img/202209021746095.webp" /><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS" target="_blank" >Web å¼€å‘æŠ€æœ¯&gt;HTTP&gt;è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/Errors/CORSAllowOriginNotMatchingOrigin" target="_blank" >Web å¼€å‘æŠ€æœ¯&gt;HTTP&gt;è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰&gt;CORS errors</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React V17.0 å€™é€‰ç‰ˆæœ¬ï¼šæ— æ–°åŠŸèƒ½</title>
      <link href="//post/2022-07-25React-v17.html"/>
      <url>//post/2022-07-25React-v17.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ— æ–°ç‰¹æ€§"><a href="#æ— æ–°ç‰¹æ€§" class="headerlink" title="æ— æ–°ç‰¹æ€§"></a>æ— æ–°ç‰¹æ€§</h2><p>React 17 çš„ç‰ˆæœ¬æ˜¯éæ¯”å¯»å¸¸çš„ï¼Œå› ä¸ºå®ƒ<strong>æ²¡æœ‰æ·»åŠ ä»»ä½•é¢å‘å¼€å‘äººå‘˜çš„æ–°åŠŸèƒ½</strong>ã€‚è€Œä¸»è¦<strong>ä¾§é‡äºå‡çº§ç®€åŒ– React æœ¬èº«</strong>ã€‚</p><p>æˆ‘ä»¬æ­£åœ¨ç§¯æå¼€å‘ React çš„æ–°åŠŸèƒ½ï¼Œä½†å®ƒä»¬å¹¶ä¸å±äºæ­¤ç‰ˆæœ¬ã€‚React 17 æ˜¯æˆ‘ä»¬è¿›è¡Œæ·±åº¦æ¨å¹¿æˆ˜ç•¥çš„å…³é”®æ‰€åœ¨ã€‚</p><p>æ­¤ç‰ˆæœ¬ä¹‹æ‰€ä»¥ç‰¹æ®Šï¼Œä½ å¯ä»¥è®¤ä¸º <code>React 17 æ˜¯ â€œå«è„šçŸ³â€ ç‰ˆæœ¬</code>ï¼Œå®ƒä¼šä½¿å¾—ç”±<code>ä¸€ä¸ª React ç‰ˆæœ¬ç®¡ç†çš„ tree åµŒå…¥åˆ°å¦ä¸€ä¸ª React ç‰ˆæœ¬ç®¡ç†çš„ tree ä¸­æ—¶ä¼šæ›´åŠ å®‰å…¨</code>ã€‚</p><h2 id="é€æ­¥å‡çº§"><a href="#é€æ­¥å‡çº§" class="headerlink" title="é€æ­¥å‡çº§"></a>é€æ­¥å‡çº§</h2><p>åœ¨è¿‡å» 7 å¹´é‡Œï¼ŒReact ä¸€ç›´éµå¾ª <code>â€œall-or-nothingâ€</code> çš„å‡çº§ç­–ç•¥ã€‚ä½ å¯ä»¥ç»§ç»­ä½¿ç”¨æ—§ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥å°†æ•´ä¸ªåº”ç”¨ç¨‹åºå‡çº§è‡³æ–°ç‰ˆæœ¬ã€‚ä½†æ²¡æœ‰ä»‹äºä¸¤è€…ä¹‹é—´çš„æƒ…å†µã€‚</p><p>æ­¤æ–¹å¼æŒç»­è‡³ä»Šï¼Œä½†æ˜¯æˆ‘ä»¬é‡åˆ°äº† <code>â€œall-or-nothingâ€ </code>å‡çº§ç­–ç•¥çš„å±€é™æ€§ã€‚è®¸å¤š API çš„å˜æ›´ï¼Œä¾‹å¦‚ï¼Œå¼ƒç”¨æ—§ç‰ˆ context API æ—¶ï¼Œå¹¶ä¸èƒ½ä»¥è‡ªåŠ¨åŒ–çš„æ–¹å¼æ¥å®Œæˆã€‚è‡³ä»Šå¯èƒ½å¤§å¤šæ•°åº”ç”¨ç¨‹åºä»æœªä½¿ç”¨è¿‡å®ƒä»¬ï¼Œä½†æˆ‘ä»¬ä»ç„¶é€‰æ‹©åœ¨ React ä¸­æ”¯æŒå®ƒä»¬ã€‚<code>æˆ‘ä»¬å¿…é¡»åœ¨æ— é™æœŸæ”¯æŒè¿‡æ—¶çš„ API æˆ–é’ˆå¯¹æŸäº›åº”ç”¨ä»ä½¿ç”¨æ—§ç‰ˆæœ¬ React é—´è¿›è¡Œé€‰æ‹©ã€‚ä½†è¿™ä¸¤ä¸ªæ–¹æ¡ˆéƒ½ä¸åˆé€‚</code>ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æƒ³æä¾›å¦ä¸€ç§æ–¹æ¡ˆã€‚</p><p>React 17 å¼€å§‹æ”¯æŒé€æ­¥å‡çº§ React ç‰ˆæœ¬ã€‚å½“ä» React 15 å‡çº§è‡³ 16 æ—¶ï¼ˆæˆ–è€…ä» React 16 å‡çº§è‡³ 17 æ—¶ï¼‰ï¼Œé€šå¸¸ä¼šä¸€æ¬¡å‡çº§æ•´ä¸ªåº”ç”¨ç¨‹åºã€‚è¿™é€‚ç”¨äºå¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºã€‚ä½†æ˜¯ï¼Œå¦‚æœä»£ç åº“æ˜¯åœ¨å‡ å¹´å‰ç¼–å†™çš„ï¼Œå¹¶ä¸”å¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„ç»´æŠ¤ï¼Œé‚£ä¹ˆå‡çº§å®ƒä¼šå˜å¾—è¶Šæ¥è¶Šæœ‰æŒ‘æˆ˜æ€§ã€‚<code>å°½ç®¡å¯ä»¥åœ¨é¡µé¢ä¸Šä½¿ç”¨ä¸¤ä¸ªç‰ˆæœ¬çš„ Reactï¼Œä½†æ˜¯ç›´åˆ° React 17 ä¾æ—§æœ‰äº‹ä»¶é—®é¢˜å‡ºç°</code>ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ React 17 è§£å†³äº†è®¸å¤šè¯¸å¦‚æ­¤ç±»çš„é—®é¢˜ã€‚è¿™å°†æ„å‘³ç€å½“ React 18 æˆ–æœªæ¥ç‰ˆæœ¬é—®ä¸–æ—¶ï¼Œä½ å°†æœ‰æ›´å¤šé€‰æ‹©ã€‚é¦–é€‰è¿˜æ˜¯åƒä»¥å‰ä¸€æ ·ï¼Œä¸€æ¬¡å‡çº§æ•´ä¸ªåº”ç”¨ç¨‹åºã€‚ä½†ä½ ä¹Ÿå¯ä»¥é€‰æ‹©é€æ­¥å‡çº§ä½ çš„åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šå°†å¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºè¿ç§»è‡³ React 18ï¼Œä½†åœ¨ React 17 ä¸Šä¿ç•™ä¸€äº›å»¶è¿ŸåŠ è½½çš„å¯¹è¯æ¡†æˆ–å­è·¯ç”±ã€‚</p><p>ä½†è¿™ä¸æ„å‘³ç€ä½ å¿…é¡»é€æ­¥å‡çº§ã€‚å¯¹äºå¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œä¸€æ¬¡å…¨é‡å‡çº§ä»æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚åŠ è½½ä¸¤ä¸ª React ç‰ˆæœ¬ï¼Œå³ä½¿å…¶ä¸­ä¸€ä¸ªæ˜¯æŒ‰éœ€å»¶è¿ŸåŠ è½½çš„ï¼Œä»ç„¶ä¸å¤ªç†æƒ³ã€‚ä½†æ˜¯ï¼Œå¯¹äºæ²¡æœ‰ç§¯æç»´æŠ¤çš„å¤§å‹åº”ç”¨æ¥è¯´ï¼Œå¯ä»¥è€ƒè™‘æ­¤ç§æ–¹æ¡ˆï¼Œå¹¶ä¸” React 17 å¼€å§‹å¯ä»¥ä¿è¯è¿™äº›åº”ç”¨ç¨‹åºä¸è½ä¼ã€‚</p><p>ä¸ºäº†å®ç°é€æ­¥å‡çº§ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ React äº‹ä»¶ç³»ç»Ÿè¿›è¡Œä¸€äº›æ›´æ”¹ã€‚è€Œè¿™äº›æ›´æ”¹å¯èƒ½ä¼šå¯¹ä»£ç äº§ç”Ÿå½±å“ï¼Œè¿™ä¹Ÿæ˜¯ React 17 æˆä¸ºä¸»è¦ç‰ˆæœ¬çš„åŸå› ã€‚å®é™…ä¸Šï¼Œ10 ä¸‡ä¸ªä»¥ä¸Šçš„ç»„ä»¶ä¸­å—å½±å“çš„ç»„ä»¶ä¸è¶…è¿‡ 20 ä¸ªï¼Œå› æ­¤ï¼Œæˆ‘ä»¬<strong>å¸Œæœ›å¤§å¤šæ•°åº”ç”¨ç¨‹åºéƒ½å¯ä»¥å‡çº§åˆ° React 17ï¼Œè€Œä¸ä¼šäº§ç”Ÿå¤ªå¤šå½±å“</strong>ã€‚å¦‚æœä½ é‡åˆ°é—®é¢˜ï¼Œè¯·è”ç³»æˆ‘ä»¬ã€‚</p><h2 id="æ›´æ”¹äº‹ä»¶å§”æ‰˜"><a href="#æ›´æ”¹äº‹ä»¶å§”æ‰˜" class="headerlink" title="æ›´æ”¹äº‹ä»¶å§”æ‰˜"></a>æ›´æ”¹äº‹ä»¶å§”æ‰˜</h2><p>ä»æŠ€æœ¯ä¸Šè®²ï¼Œå§‹ç»ˆå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­åµŒå¥—ä¸åŒç‰ˆæœ¬çš„ Reactã€‚ä½†æ˜¯ï¼Œç”±äº React äº‹ä»¶ç³»ç»Ÿçš„å·¥ä½œåŸç†ï¼Œè¿™å¾ˆéš¾å®ç°ã€‚</p><p>åœ¨ React ç»„ä»¶ä¸­ï¼Œé€šå¸¸ä¼šå†…è”ç¼–å†™äº‹ä»¶å¤„ç†ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;button onClick&#x3D;&#123;handleClick&#125;&gt;</code></pre><p>ä¸æ­¤ä»£ç ç­‰æ•ˆçš„åŸç”Ÿ DOM æ“ä½œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">myButton.addEventListener(&quot;click&quot;, handleClick);</code></pre><p>ä½†æ˜¯ï¼Œå¯¹å¤§å¤šæ•°äº‹ä»¶æ¥è¯´ï¼ŒReact å®é™…ä¸Šå¹¶ä¸ä¼šå°†å®ƒä»¬é™„åŠ åˆ° DOM èŠ‚ç‚¹ä¸Šã€‚ç›¸åï¼ŒReact ä¼šç›´æ¥åœ¨ document èŠ‚ç‚¹ä¸Šä¸ºæ¯ç§äº‹ä»¶ç±»å‹é™„åŠ ä¸€ä¸ªå¤„ç†å™¨ã€‚è¿™è¢«ç§°ä¸ºäº‹ä»¶å§”æ‰˜ã€‚é™¤äº†åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸Šå…·æœ‰æ€§èƒ½ä¼˜åŠ¿å¤–ï¼Œå®ƒè¿˜ä½¿æ·»åŠ ç±»ä¼¼äº <code>replaying events</code> è¿™æ ·çš„æ–°ç‰¹æ€§å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p><p>è‡ªä»å…¶å‘å¸ƒä»¥æ¥ï¼ŒReact ä¸€ç›´è‡ªåŠ¨è¿›è¡Œäº‹ä»¶å§”æ‰˜ã€‚<code>å½“ document ä¸Šè§¦å‘ DOM äº‹ä»¶æ—¶ï¼ŒReact ä¼šæ‰¾å‡ºè°ƒç”¨çš„ç»„ä»¶ï¼Œç„¶å React äº‹ä»¶ä¼šåœ¨ç»„ä»¶ä¸­å‘ä¸Š â€œå†’æ³¡â€ã€‚ä½†å®é™…ä¸Šï¼ŒåŸç”Ÿäº‹ä»¶å·²ç»å†’æ³¡å‡ºäº† document çº§åˆ«</code>ï¼ŒReact åœ¨å…¶ä¸­å®‰è£…äº†äº‹ä»¶å¤„ç†å™¨ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™å°±æ˜¯é€æ­¥å‡çº§çš„å›°éš¾æ‰€åœ¨ã€‚</p><p><span style="color: red">å¦‚æœé¡µé¢ä¸Šæœ‰å¤šä¸ª React ç‰ˆæœ¬ï¼Œä»–ä»¬éƒ½å°†åœ¨é¡¶å±‚æ³¨å†Œäº‹ä»¶å¤„ç†å™¨ã€‚è¿™ä¼šç ´å e.stopPropagation()ï¼šå¦‚æœåµŒå¥—æ ‘ç»“æ„ä¸­é˜»æ­¢äº†äº‹ä»¶å†’æ³¡ï¼Œä½†å¤–éƒ¨æ ‘ä¾ç„¶èƒ½æ¥æ”¶åˆ°å®ƒã€‚è¿™ä¼šä½¿ä¸åŒç‰ˆæœ¬ React åµŒå¥—å˜å¾—å›°éš¾é‡é‡<span>ã€‚è¿™ç§æ‹…å¿§å¹¶ä¸æ˜¯æ²¡æœ‰æ ¹æ®çš„ â€”â€” ä¾‹å¦‚ï¼Œå››å¹´å‰ Atom ç¼–è¾‘å™¨å°±é‡åˆ°äº†ç›¸åŒçš„é—®é¢˜ã€‚</p><p>è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ”¹å˜ React åº•å±‚é™„åŠ äº‹ä»¶æ–¹å¼çš„åŸå› ã€‚</p><p><strong>åœ¨ React 17 ä¸­ï¼ŒReact å°†ä¸å†å‘ document é™„åŠ äº‹ä»¶å¤„ç†å™¨ã€‚è€Œä¼šå°†äº‹ä»¶å¤„ç†å™¨é™„åŠ åˆ°æ¸²æŸ“ React æ ‘çš„æ ¹ DOM å®¹å™¨ä¸­ï¼š</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const rootNode &#x3D; document.getElementById(&quot;root&quot;);ReactDOM.render(&lt;App &#x2F;&gt;, rootNode);</code></pre><p>åœ¨ React 16 æˆ–æ›´æ—©ç‰ˆæœ¬ä¸­ï¼ŒReact ä¼šå¯¹å¤§å¤šæ•°äº‹ä»¶æ‰§è¡Œ <code>document.addEventListener()</code>ã€‚React 17 å°†ä¼šåœ¨åº•å±‚è°ƒç”¨ <code>rootNode.addEventListener()</code>ã€‚</p><img src="https://react.docschina.org/static/bb4b10114882a50090b8ff61b3c4d0fd/1e088/react_17_delegation.png" /><p><strong>ç”±äºæ­¤æ›´æ”¹ï¼Œç°åœ¨å¯ä»¥æ›´åŠ å®‰å…¨åœ°è¿›è¡Œæ–°æ—§ç‰ˆæœ¬ React æ ‘çš„åµŒå¥—</strong>ã€‚<span style="color: red">è¯·æ³¨æ„ï¼Œè¦ä½¿å…¶æ­£å¸¸å·¥ä½œï¼Œä¸¤ä¸ªç‰ˆæœ¬éƒ½å¿…é¡»ä¸º 17 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¼ºçƒˆå»ºè®®å‡çº§åˆ° React 17 çš„æ ¹æœ¬åŸå› </span>ã€‚ä»æŸç§æ„ä¹‰ä¸Šè®²ï¼ŒReact 17 æ˜¯ä¸€ä¸ª â€œå«è„šçŸ³â€ ç‰ˆæœ¬ï¼Œä½¿é€æ­¥å‡çº§æˆä¸ºå¯èƒ½ã€‚</p><p><strong>æ­¤æ›´æ”¹è¿˜ä½¿å¾—å°† React åµŒå…¥ä½¿ç”¨å…¶ä»–æŠ€æœ¯æ„å»ºçš„åº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ å®¹æ˜“</strong>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºçš„â€œå¤–å£³â€æ˜¯ç”¨ jQuery ç¼–å†™çš„ï¼Œä½†å…¶ä¸­è¾ƒæ–°çš„ä»£ç æ˜¯ç”¨ React ç¼–å†™çš„ï¼Œåˆ™ React ä»£ç ä¸­çš„ e.stopPropagation() ä¼šé˜»æ­¢å®ƒå½±å“ jQuery çš„ä»£ç  â€”â€” è¿™ç¬¦åˆé¢„æœŸã€‚æ¢ä¸ªè§’åº¦æ¥è¯´ï¼Œå¦‚æœä½ ä¸å†å–œæ¬¢ React å¹¶æƒ³é‡å†™åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚ï¼Œç”¨ jQueryï¼‰ï¼Œåˆ™å¯ä»¥ä»å¤–å£³å¼€å§‹å°† React è½¬æ¢ä¸º jQueryï¼Œè€Œä¸ä¼šç ´åäº‹ä»¶å†’æ³¡ã€‚</p><p>ç»æ ¸å®ï¼Œå¤šå¹´æ¥åœ¨ issue è¿½è¸ªå™¨ ä¸ŠæŠ¥å‘Šçš„è®¸å¤šé—®é¢˜éƒ½å·²è¢«æ–°ç‰¹æ€§è§£å†³ï¼Œè¿™äº›é—®é¢˜å¤§å¤šéƒ½ä¸å°† React ä¸é React ä»£ç é›†æˆæœ‰å…³ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>ä½ å¯èƒ½æƒ³çŸ¥é“è¿™æ˜¯å¦ä¼šç ´åæ ¹ DOM å®¹å™¨ä¹‹å¤–çš„ Portalsã€‚ç­”æ¡ˆæ˜¯ React è¿˜ä¼šç›‘å¬ portals å®¹å™¨ä¸Šçš„äº‹ä»¶ï¼Œæ‰€ä»¥è¿™ä¸æ˜¯é—®é¢˜ã€‚</p></div><p><strong>è§£å†³éšæ‚£</strong></p><p>ä¸å…¶ä»–é‡å¤§æ›´æ”¹ä¸€æ ·ï¼Œå¯èƒ½éœ€è¦å¯¹ä»£ç è¿›è¡Œè°ƒæ•´ã€‚åœ¨ Facebookï¼Œæˆ‘ä»¬åœ¨æˆåƒä¸Šä¸‡ä¸ªæ¨¡å—ä¸­ï¼Œå¤§çº¦è°ƒæ•´äº† 10 ä¸ªæ¨¡å—ä»¥é€‚åº”æ­¤æ›´æ”¹ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ¨¡å—ä¸­ä½¿ç”¨<code> document.addEventListener(...)</code> æ‰‹åŠ¨æ·»åŠ äº† DOM ç›‘å¬ï¼Œä½ å¯èƒ½å¸Œæœ›èƒ½æ•è·åˆ°æ‰€æœ‰ React äº‹ä»¶ã€‚<span style="color: red">åœ¨ React 16 æˆ–æ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œå³ä½¿ä½ åœ¨ React äº‹ä»¶å¤„ç†å™¨ä¸­è°ƒç”¨ <code>e.stopPropagation()</code>ï¼Œä½ åˆ›å»ºçš„ DOM ç›‘å¬ä»ä¼šè§¦å‘ï¼Œè¿™æ˜¯å› ä¸ºåŸç”Ÿäº‹ä»¶å·²ç»å¤„äº document çº§åˆ«</span>ã€‚ä½¿ç”¨ React 17 å†’æ³¡å°†è¢«é˜»æ­¢ï¼ˆæŒ‰éœ€ï¼‰ï¼Œå› æ­¤ä½ çš„ document çº§åˆ«çš„äº‹ä»¶ç›‘å¬ä¸ä¼šè§¦å‘ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">document.addEventListener(&quot;click&quot;, function () &#123;  &#x2F;&#x2F; This custom handler will no longer receive clicks  &#x2F;&#x2F; from React components that called e.stopPropagation()&#125;);</code></pre><p>ä½ å¯ä»¥å°†ç›‘å¬è½¬æ¢ä¸ºä½¿ç”¨æ•è·æ¥ä¿®å¤æ­¤ç±»ä»£ç ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥å°† <code>&#123; capture: true &#125; </code>ä½œä¸º <code>document.addEventListener </code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">document.addEventListener(  &quot;click&quot;,  function () &#123;    &#x2F;&#x2F; Now this event handler uses the capture phase,    &#x2F;&#x2F; so it receives *all* click events below!  &#125;,  &#123; capture: true &#125;);</code></pre><p>è¯·æ³¨æ„ï¼Œæ­¤ç­–ç•¥åœ¨å…¨å±€ä¸Šå…·æœ‰æ›´å¥½çš„é€‚åº”æ€§ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½ä¼šä¿®å¤ä»£ç ä¸­ç°æœ‰çš„é”™è¯¯ï¼Œè¿™äº›é”™è¯¯åœ¨ React äº‹ä»¶å¤„ç†å™¨å¤–éƒ¨è°ƒç”¨ <code>e.stopPropagation()</code> å‘ç”Ÿã€‚æ¢å¥è¯è¯´ï¼Œ<strong>React 17 çš„äº‹ä»¶å†’æ³¡æ›´æ¥è¿‘å¸¸è§„ DOM</strong>ã€‚</p><h2 id="å…¶ä»–é‡å¤§æ›´æ”¹"><a href="#å…¶ä»–é‡å¤§æ›´æ”¹" class="headerlink" title="å…¶ä»–é‡å¤§æ›´æ”¹"></a>å…¶ä»–é‡å¤§æ›´æ”¹</h2><p>æˆ‘ä»¬å°† React 17 ä¸­çš„é‡å¤§æ›´æ”¹ä¿æŒåœ¨æœ€ä½æ°´å¹³ã€‚ä¾‹å¦‚ï¼Œå®ƒä¸ä¼šåˆ é™¤ä»¥å‰ç‰ˆæœ¬ä¸­å¼ƒç”¨çš„ä»»åŠ¡æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå®ƒçš„ç¡®åŒ…å«ä¸€äº›å…¶ä»–é‡å¤§æ›´æ”¹ï¼Œæ ¹æ®ç»éªŒï¼Œè¿™äº›æ›´æ”¹ä¼šç›¸å¯¹å®‰å…¨ã€‚æ€»ä½“è€Œè¨€ï¼Œç”±äºè¿™äº›å› ç´ çš„å­˜åœ¨ï¼Œåœ¨ 10 ä¸‡ä¸ªä»¥ä¸Šçš„ç»„ä»¶ä¸­å—å½±å“çš„ç»„ä»¶ä¸è¶…è¿‡ 20 ä¸ªã€‚</p><h3 id="å¯¹æ ‡æµè§ˆå™¨"><a href="#å¯¹æ ‡æµè§ˆå™¨" class="headerlink" title="å¯¹æ ‡æµè§ˆå™¨"></a>å¯¹æ ‡æµè§ˆå™¨</h3><p>æˆ‘ä»¬å¯¹äº‹ä»¶ç³»ç»Ÿè¿›è¡Œäº†ä¸€äº›è¾ƒå°çš„æ›´æ”¹ï¼š</p><ul><li><code>onScroll</code> äº‹ä»¶ä¸å†å†’æ³¡ï¼Œä»¥é˜²æ­¢å‡ºç°å¸¸è§çš„æ··æ·†ã€‚</li><li>React çš„ <code>onFocus</code> å’Œ <code>onBlur</code> äº‹ä»¶å·²åœ¨åº•å±‚åˆ‡æ¢ä¸ºåŸç”Ÿçš„ <code>focusin</code> å’Œ <code>focusout</code> äº‹ä»¶ã€‚å®ƒä»¬æ›´æ¥è¿‘ <code>React</code> ç°æœ‰è¡Œä¸ºï¼Œæœ‰æ—¶è¿˜ä¼šæä¾›é¢å¤–çš„ä¿¡æ¯ã€‚</li><li>æ•è·äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼Œ<code>onClickCapture</code>ï¼‰ç°åœ¨ä½¿ç”¨çš„æ˜¯å®é™…æµè§ˆå™¨ä¸­çš„æ•è·ç›‘å¬å™¨ã€‚</li></ul><p>è¿™äº›æ›´æ”¹ä¼šä½¿ React ä¸æµè§ˆå™¨è¡Œä¸ºæ›´æ¥è¿‘ï¼Œå¹¶æé«˜äº†äº’æ“ä½œæ€§ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼š</p><p>å°½ç®¡ React 17 åº•å±‚å·²å°† onFocus äº‹ä»¶ä» focus åˆ‡æ¢ä¸º focusinï¼Œä½†è¯·æ³¨æ„ï¼Œè¿™å¹¶æœªå½±å“å†’æ³¡è¡Œä¸ºã€‚åœ¨ React ä¸­ï¼ŒonFocus äº‹ä»¶æ€»æ˜¯å†’æ³¡çš„ï¼Œåœ¨ React 17 ä¸­ä¼šç»§ç»­ä¿æŒï¼Œå› ä¸ºé€šå¸¸å®ƒæ˜¯ä¸€ä¸ªæ›´æœ‰ç”¨çš„é»˜è®¤å€¼</p></div><h3 id="å»é™¤äº‹ä»¶æ± "><a href="#å»é™¤äº‹ä»¶æ± " class="headerlink" title="å»é™¤äº‹ä»¶æ± "></a>å»é™¤äº‹ä»¶æ± </h3><p>React 17 ä¸­ç§»é™¤äº† â€œevent poolingï¼ˆäº‹ä»¶æ± ï¼‰â€œã€‚å®ƒå¹¶ä¸ä¼šæé«˜ç°ä»£æµè§ˆå™¨çš„æ€§èƒ½ï¼Œç”šè‡³è¿˜ä¼šä½¿ç»éªŒä¸°å¯Œçš„å¼€å‘è€…ä¸€å¤´é›¾æ°´ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function handleChange(e) &#123;  setData((data) &#x3D;&gt; (&#123;    ...data,    &#x2F;&#x2F; This crashes in React 16 and earlier:    text: e.target.value,  &#125;));&#125;</code></pre><p>è¿™æ˜¯å› ä¸º React åœ¨æ—§æµè§ˆå™¨ä¸­é‡ç”¨äº†ä¸åŒäº‹ä»¶çš„äº‹ä»¶å¯¹è±¡ï¼Œä»¥æé«˜æ€§èƒ½ï¼Œå¹¶å°†æ‰€æœ‰äº‹ä»¶å­—æ®µåœ¨å®ƒä»¬ä¹‹å‰è®¾ç½®ä¸º nullã€‚åœ¨ React 16 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨è€…å¿…é¡»è°ƒç”¨ <code>e.persist()</code> æ‰èƒ½æ­£ç¡®çš„ä½¿ç”¨è¯¥äº‹ä»¶ï¼Œæˆ–è€…æ­£ç¡®è¯»å–éœ€è¦çš„å±æ€§ã€‚</p><p><strong>åœ¨ React 17 ä¸­ï¼Œæ­¤ä»£ç å¯ä»¥æŒ‰ç…§é¢„æœŸæ•ˆæœæ‰§è¡Œã€‚æ—§çš„äº‹ä»¶æ± ä¼˜åŒ–æ“ä½œå·²è¢«å®Œæˆåˆ é™¤ï¼Œå› æ­¤ï¼Œä½¿ç”¨è€…å¯ä»¥åœ¨éœ€è¦æ—¶è¯»å–äº‹ä»¶å­—æ®µã€‚</strong></p><p>è¿™æ”¹å˜äº†è¡Œä¸ºï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶æ ‡è®°ä¸ºé‡å¤§æ›´æ”¹ï¼Œä½†åœ¨å®è·µä¸­æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°å®ƒåœ¨ Facebook ä¸Šé€ æˆå½±å“ã€‚ï¼ˆç”šè‡³è¿˜ä¿®å¤äº†ä¸€äº›é”™è¯¯ï¼ï¼‰è¯·æ³¨æ„ï¼Œ<span style="color: red"><code>e.persist()</code> åœ¨ React äº‹ä»¶å¯¹è±¡ä¸­ä»ç„¶å¯ç”¨ï¼Œåªæ˜¯æ— æ•ˆæœç½¢äº†</span>ã€‚</p><h3 id="å‰¯ä½œç”¨æ¸…ç†æ—¶é—´"><a href="#å‰¯ä½œç”¨æ¸…ç†æ—¶é—´" class="headerlink" title="å‰¯ä½œç”¨æ¸…ç†æ—¶é—´"></a>å‰¯ä½œç”¨æ¸…ç†æ—¶é—´</h3><p>æˆ‘ä»¬å°†ä½¿ <code>useEffect</code> å’Œæ¸…ç†å‡½æ•°çš„æ—¶é—´ä¿æŒä¸€è‡´ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">useEffect(() &#x3D;&gt; &#123;  &#x2F;&#x2F; This is the effect itself.  return () &#x3D;&gt; &#123;    &#x2F;&#x2F; This is its cleanup.  &#125;;&#125;);</code></pre><p>å¤§å¤šæ•°å‰¯ä½œç”¨ï¼ˆ<code>effect</code>ï¼‰ä¸éœ€è¦å»¶è¿Ÿå±å¹•æ›´æ–°ï¼Œå› æ­¤ React åœ¨å±å¹•ä¸Šåæ˜ å‡ºæ›´æ–°åç«‹å³å¼‚æ­¥æ‰§è¡Œå®ƒä»¬ã€‚ï¼ˆåœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œä½ éœ€è¦ä¸€ç§å‰¯ä½œç”¨æ¥é˜»æ­¢ç»˜åˆ¶ï¼Œä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦è·å–å°ºå¯¸å’Œä½ç½®ï¼Œè¯·ä½¿ç”¨ <code>useLayoutEffect</code>ã€‚ï¼‰</p><p>ç„¶è€Œï¼Œ<span style="color: red">å½“ç»„ä»¶è¢«å¸è½½æ—¶ï¼Œå‰¯ä½œç”¨æ¸…ç†å‡½æ•°ï¼ˆç±»ä¼¼äºåœ¨ class ç»„ä»¶ä¸­åŒæ­¥è°ƒç”¨ componentWillUnmountï¼‰åŒæ­¥è¿è¡Œã€‚æˆ‘ä»¬å‘ç°ï¼Œå¯¹äºå¤§å‹åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™ä¸æ˜¯ç†æƒ³é€‰æ‹©ï¼Œå› ä¸ºåŒæ­¥ä¼šå‡ç¼“å±å¹•çš„è¿‡æ¸¡ï¼ˆä¾‹å¦‚ï¼Œåˆ‡æ¢æ ‡ç­¾ï¼‰</span>ã€‚</p><p><strong>åœ¨ React 17 ä¸­ï¼Œå‰¯ä½œç”¨æ¸…ç†å‡½æ•°æ€»ä¼šå¼‚æ­¥æ‰§è¡Œ â€”â€” å¦‚æœè¦å¸è½½ç»„ä»¶ï¼Œåˆ™æ¸…ç†ä¼šåœ¨å±å¹•æ›´æ–°åè¿è¡Œã€‚</strong></p><p>è¿™åæ˜ äº†å‰¯ä½œç”¨æœ¬èº«å¦‚ä½•æ›´ç´§å¯†åœ°è¿è¡Œã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›ä¾é åŒæ­¥æ‰§è¡Œï¼Œå¯ä»¥æ”¹ç”¨ <code>useLayoutEffect</code>ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„</p><p>ä½ å¯èƒ½æƒ³çŸ¥é“è¿™æ˜¯å¦æ„å‘³ç€ä½ ç°åœ¨å°†æ— æ³•ä¿®å¤æœ‰å…³æœªæŒ‚è½½ç»„ä»¶ä¸Šçš„ setState çš„è­¦å‘Šã€‚ä¸å¿…æ‹…å¿ƒï¼ŒReact ä¸“é—¨å¤„ç†äº†è¿™ç§æƒ…å†µï¼Œå¹¶ä¸”ä¸ä¼šåœ¨å¸è½½å’Œæ¸…ç†ä¹‹é—´çŸ­æš‚é—´éš”å†…å‘å‡º setState çš„è­¦å‘Šã€‚å› æ­¤ï¼Œå–æ¶ˆä»£ç çš„è¯·æ±‚æˆ–é—´éš”å‡ ä¹æ€»æ˜¯å¯ä»¥ä¿å­˜ä¸å˜çš„ã€‚</p></div><p><strong>æ­¤å¤–ï¼ŒReact 17 å°†<code>åœ¨è¿è¡Œä»»ä½•æ–°å‰¯ä½œç”¨ä¹‹å‰æ‰§è¡Œæ‰€æœ‰å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ï¼ˆé’ˆå¯¹æ‰€æœ‰ç»„ä»¶ï¼‰</code>ã€‚React 16 åªå¯¹ç»„ä»¶å†…çš„ effect ä¿è¯è¿™ç§é¡ºåºã€‚</strong></p><h3 id="éšæ‚£"><a href="#éšæ‚£" class="headerlink" title="éšæ‚£"></a>éšæ‚£</h3><p>å¯å¤ç”¨çš„åº“å¯èƒ½éœ€è¦å¯¹æ­¤æƒ…å†µè¿›è¡Œæ·±åº¦æµ‹è¯•ï¼Œä½†æˆ‘ä»¬åªé‡åˆ°äº†å‡ ä¸ªç»„ä»¶ä¼šå› ä¸ºè¿™æ¬¡æ”¹å˜å‡ºç°é—®é¢˜ã€‚æœ‰é—®é¢˜çš„ä»£ç çš„å…¶ä¸­ä¸€ä¸ªç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">useEffect(() &#x3D;&gt; &#123;  someRef.current.someSetupMethod();  return () &#x3D;&gt; &#123;    someRef.current.someCleanupMethod();  &#125;;&#125;);</code></pre><p>é—®é¢˜åœ¨äº someRef.current æ˜¯å¯å˜çš„ï¼Œå› æ­¤åœ¨è¿è¡Œæ¸…é™¤å‡½æ•°æ—¶ï¼Œå®ƒå¯èƒ½å·²ç»è®¾ç½®ä¸º nullã€‚è§£å†³æ–¹æ¡ˆæ˜¯åœ¨å‰¯ä½œç”¨å†…éƒ¨å­˜å‚¨ä¼šå‘ç”Ÿå˜åŒ–çš„å€¼ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">useEffect(() &#x3D;&gt; &#123;  const instance &#x3D; someRef.current;  instance.someSetupMethod();  return () &#x3D;&gt; &#123;    instance.someCleanupMethod();  &#125;;&#125;);</code></pre><p><strong>æˆ‘ä»¬ä¸å¸Œæœ›æ­¤é—®é¢˜å¯¹å¤§å®¶é€ æˆå½±å“ï¼Œæˆ‘ä»¬æä¾›äº† <code>eslint-plugin-react-hooks/exhaustive-deps</code> çš„ lint è§„åˆ™ï¼ˆ<span style="color: red">è¯·ç¡®ä¿åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å®ƒ</span>ï¼‰ä¼šå¯¹æ­¤æƒ…å†µå‘å‡ºè­¦å‘Šã€‚</strong></p><h3 id="è¿”å›ä¸€è‡´çš„-undefined-é”™è¯¯"><a href="#è¿”å›ä¸€è‡´çš„-undefined-é”™è¯¯" class="headerlink" title="è¿”å›ä¸€è‡´çš„ undefined é”™è¯¯"></a>è¿”å›ä¸€è‡´çš„ undefined é”™è¯¯</h3><p>åœ¨ React 16 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œè¿”å› undefined å§‹ç»ˆæ˜¯ä¸€ä¸ªé”™è¯¯ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function Button() &#123;  return; &#x2F;&#x2F; Error: Nothing was returned from render&#125;</code></pre><p>éƒ¨åˆ†åŸå› æ˜¯è¿™å¾ˆå®¹æ˜“æ— æ„é—´è¿”å› undefinedï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function Button() &#123;  &#x2F;&#x2F; We forgot to write return, so this component returns undefined.  &#x2F;&#x2F; React surfaces this as an error instead of ignoring it.  &lt;button &#x2F;&gt;;&#125;</code></pre><p>ä»¥å‰ï¼Œ<strong>React åªå¯¹ class å’Œå‡½æ•°ç»„ä»¶æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†å¹¶ä¸ä¼šæ£€æŸ¥ forwardRef å’Œ memo ç»„ä»¶çš„è¿”å›å€¼ã€‚è¿™æ˜¯ç”±äºç¼–ç é”™è¯¯å¯¼è‡´</strong>ã€‚</p><p>åœ¨ React 17 ä¸­ï¼Œ<strong>forwardRef å’Œ memo ç»„ä»¶çš„è¡Œä¸ºä¼šä¸å¸¸è§„å‡½æ•°ç»„ä»¶å’Œ class ç»„ä»¶ä¿æŒä¸€è‡´</strong>ã€‚åœ¨è¿”å› undefined æ—¶ä¼šæŠ¥é”™</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let Button &#x3D; forwardRef(() &#x3D;&gt; &#123;  &#x2F;&#x2F; We forgot to write return, so this component returns undefined.  &#x2F;&#x2F; React 17 surfaces this as an error instead of ignoring it.  &lt;button &#x2F;&gt;;&#125;);let Button &#x3D; memo(() &#x3D;&gt; &#123;  &#x2F;&#x2F; We forgot to write return, so this component returns undefined.  &#x2F;&#x2F; React 17 surfaces this as an error instead of ignoring it.  &lt;button &#x2F;&gt;;&#125;);</code></pre><p><strong>å¯¹äºä¸æƒ³è¿›è¡Œä»»ä½•æ¸²æŸ“çš„æƒ…å†µï¼Œè¯·è¿”å› nullã€‚</strong></p><h3 id="åŸç”Ÿç»„ä»¶æ ˆ"><a href="#åŸç”Ÿç»„ä»¶æ ˆ" class="headerlink" title="åŸç”Ÿç»„ä»¶æ ˆ"></a>åŸç”Ÿç»„ä»¶æ ˆ</h3><p>å½“ä½ åœ¨æµè§ˆå™¨ä¸­é‡åˆ°é”™è¯¯æ—¶ï¼Œæµè§ˆå™¨ä¼šä¸ºä½ æä¾›å¸¦æœ‰ JavaScript å‡½æ•°çš„åç§°åŠä½ç½®çš„è°ƒç”¨æ ˆä¿¡æ¯ã€‚ç„¶è€Œï¼ŒJavaScript è°ƒç”¨æ ˆé€šå¸¸ä¸è¶³ä»¥è¯Šæ–­é—®é¢˜ï¼Œå› ä¸º React æ ‘çš„å±‚æ¬¡ç»“æ„å¯èƒ½åŒæ ·é‡è¦ã€‚ä½ ä¸ä»…è¦çŸ¥é“å“ªä¸ª Button æŠ›å‡ºäº†é”™è¯¯ï¼Œè€Œä¸”è¿˜æƒ³çŸ¥é“ Button åœ¨ React æ ‘ä¸­çš„å“ªä¸ªä½ç½®ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå½“ä½ é‡åˆ°é”™è¯¯æ—¶ï¼Œä» React 16 å¼€å§‹ä¼šæ‰“å° â€œç»„ä»¶æ ˆâ€ ä¿¡æ¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»¬ä»ç„¶ä¸å¦‚åŸç”Ÿçš„ JavaScript è°ƒç”¨æ ˆã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒä»¬åœ¨æ§åˆ¶å°ä¸­ä¸å¯ç‚¹å‡»ï¼Œå› ä¸º React ä¸çŸ¥é“å‡½æ•°åœ¨æºä»£ç ä¸­çš„å£°æ˜ä½ç½®ã€‚æ­¤å¤–ï¼Œå®ƒä»¬åœ¨ç”Ÿäº§ä¸­å‡ ä¹æ— ç”¨ã€‚ä¸åŒäºå¸¸è§„å‹ç¼©åçš„ JavaScript è°ƒç”¨æ ˆï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡ sourcemap çš„å½¢å¼è‡ªåŠ¨æ¢å¤åˆ°åŸå§‹å‡½æ•°çš„ä½ç½®ï¼Œè€Œä½¿ç”¨ React ç»„ä»¶æ ˆï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å¿…é¡»åœ¨è°ƒç”¨æ ˆä¿¡æ¯å’Œ bundle å¤§å°é—´è¿›è¡Œé€‰æ‹©ã€‚</p><p><strong>åœ¨ React 17 ä¸­ï¼Œä½¿ç”¨äº†ä¸åŒçš„æœºåˆ¶ç”Ÿæˆç»„ä»¶è°ƒç”¨æ ˆï¼Œè¯¥æœºåˆ¶ä¼šå°†å®ƒä»¬ä¸å¸¸è§„çš„åŸç”Ÿ JavaScript è°ƒç”¨æ ˆç¼åˆåœ¨ä¸€èµ·ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è·å¾—å®Œå…¨ç¬¦å·åŒ–çš„ React ç»„ä»¶è°ƒç”¨æ ˆä¿¡æ¯ã€‚</strong></p><p>React å®ç°è¿™ä¸€ç‚¹çš„æ–¹å¼æœ‰ç‚¹éå¸¸è§„ã€‚ç›®å‰ï¼Œæµè§ˆå™¨æ— æ³•æä¾›è·å–å‡½æ•°è°ƒç”¨æ ˆæ¡†æ¶ï¼ˆæºæ–‡ä»¶å’Œä½ç½®ï¼‰çš„æ–¹æ³•ã€‚_å› æ­¤ï¼Œå½“ React æ•è·åˆ°é”™è¯¯æ—¶ï¼Œå°†é€šè¿‡ç»„ä»¶ä¸Šè¿°ç»„ä»¶å†…éƒ¨æŠ›å‡ºçš„ä¸´æ—¶é”™è¯¯ï¼ˆå¹¶æ•è·ï¼‰æ¥é‡å»ºå…¶ç»„ä»¶è°ƒç”¨æ ˆä¿¡æ¯ã€‚è¿™ä¼šå¢åŠ å´©æºƒæ—¶çš„æ€§èƒ½æŸå¤±ï¼Œä½†æ¯ä¸ªç»„ä»¶ç±»å‹åªä¼šå‘ç”Ÿä¸€æ¬¡_ã€‚</p><p>å¦‚æœä½ å¯¹æ­¤æ„Ÿå…´è¶£ï¼Œå¯ä»¥åœ¨è¿™ä¸ª PR ä¸­é˜…è¯»æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§æœºåˆ¶ä¸ä¼šå½±å“ä½ çš„ä»£ç ã€‚ä»ä½¿ç”¨è€…çš„è§’åº¦æ¥çœ‹ï¼Œæ–°åŠŸèƒ½å°±æ˜¯å¯ä»¥å•å‡»ç»„ä»¶è°ƒç”¨æ ˆï¼ˆå› ä¸ºå®ƒä»¬ä¾èµ–äºæœ¬æœºæµè§ˆå™¨è°ƒç”¨æ ˆæ¡†æ¶ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥åƒå¸¸è§„ JavaScript é”™è¯¯é‚£æ ·åœ¨ç”Ÿäº§ä¸­è¿›è¡Œè§£ç ã€‚</p><p>æ„æˆé‡å¤§å˜åŒ–çš„éƒ¨åˆ†æ˜¯ï¼Œè¦ä½¿æ­¤åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼ŒReact å°†åœ¨æ•è·é”™è¯¯ååœ¨è°ƒç”¨æ ˆä¸­é‡æ–°æ‰§è¡Œä¸Šé¢æŸäº›å‡½æ•°å’ŒæŸäº› class æ„é€ å‡½æ•°çš„éƒ¨åˆ†ã€‚ç”±äºæ¸²æŸ“å‡½æ•°å’Œ class æ„é€ å‡½æ•°ä¸åº”å…·æœ‰å‰¯ä½œç”¨ï¼ˆè¿™å¯¹äº SSR ä¹Ÿå¾ˆé‡è¦ï¼‰ï¼Œå› æ­¤è¿™ä¸ä¼šé€ æˆä»»ä½•å®é™…é—®é¢˜ã€‚</p><h3 id="ç§»é™¤ç§æœ‰å¯¼å‡º"><a href="#ç§»é™¤ç§æœ‰å¯¼å‡º" class="headerlink" title="ç§»é™¤ç§æœ‰å¯¼å‡º"></a>ç§»é™¤ç§æœ‰å¯¼å‡º</h3><p>æœ€åï¼Œå€¼å¾—æ³¨æ„çš„é‡å¤§å˜åŒ–æ—¶æˆ‘ä»¬<em>åˆ é™¤äº†ä¸€äº›ä»¥å‰æš´éœ²ç»™å…¶ä»–é¡¹ç›®çš„ React å†…éƒ¨ç»„ä»¶</em>ã€‚ç‰¹åˆ«æ˜¯ï¼ŒReact Native for Web è¿‡å»å¸¸å¸¸ä¾èµ–äºäº‹ä»¶ç³»ç»Ÿçš„æŸäº›å†…éƒ¨ç»„ä»¶ï¼Œä½†è¿™ç§ä¾èµ–å…³ç³»å¾ˆè„†å¼±ä¸”ç»å¸¸è¢«ç ´åã€‚</p><p>åœ¨ React 17 ä¸­ï¼Œè¿™äº›ç§æœ‰å¯¼å‡ºå·²è¢«ç§»é™¤ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼ŒReact Native for Web æ˜¯å”¯ä¸€ä½¿ç”¨å®ƒä»¬çš„é¡¹ç›®ï¼Œå®ƒä»¬å·²ç»å®Œæˆäº†å‘ä¸ä¾èµ–é‚£äº›ç§æœ‰å¯¼å‡ºå‡½æ•°çš„å…¶ä»–æ–¹æ³•è¿ç§»ã€‚</p><p><strong>è¿™æ„å‘³ç€æ—§ç‰ˆæœ¬çš„ React Native for Web ä¸ä¼šä¸ React 17 å…¼å®¹</strong>ï¼Œä½†æ˜¯æ–°ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨å®ƒã€‚å®é™…ä¸Šï¼Œå¹¶æ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼Œå› ä¸º React Native for Web å¿…é¡»å‘å¸ƒæ–°ç‰ˆæœ¬ä»¥é€‚åº”å…¶å†…éƒ¨ React çš„å˜åŒ–ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬åˆ é™¤äº† ReactTestUtils.SimulateNative çš„ helper æ–¹æ³•ã€‚ä»–ä»¬ä»æœªè¢«è®°å½•ï¼Œæ²¡æœ‰æŒ‰ç…§ä»–ä»¬åå­—æ‰€æš—ç¤ºçš„é‚£æ ·å»åšï¼Œä¹Ÿæ²¡æœ‰å¤„ç†æˆ‘ä»¬å¯¹äº‹ä»¶ç³»ç»Ÿæ‰€åšçš„æ›´æ”¹ã€‚å¦‚æœä½ æƒ³è¦ä¸€ç§ç®€ä¾¿çš„æ–¹å¼æ¥è§¦å‘æµ‹è¯•ä¸­åŸç”Ÿæµè§ˆå™¨çš„äº‹ä»¶ï¼Œè¯·æ”¹ç”¨ React Testing Libraryã€‚</p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React@16ã€17 æ‚è´§</title>
      <link href="//post/2022-07-23react-%E6%9D%82%E8%B4%A7.html"/>
      <url>//post/2022-07-23react-%E6%9D%82%E8%B4%A7.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ³¨æ„ç‰ˆæœ¬å“ˆ"><a href="#æ³¨æ„ç‰ˆæœ¬å“ˆ" class="headerlink" title="æ³¨æ„ç‰ˆæœ¬å“ˆ"></a>æ³¨æ„ç‰ˆæœ¬å“ˆ</h2><p><a href="https://juejin.cn/post/7034899177205137438" target="_blank" >ä»å‰æœ‰åº§å±±ä¹‹ react æºç è§£è¯»ä¹‹ ReactContext</a></p><p><a href="https://blog.csdn.net/m0_51744158/article/details/120870752" target="_blank" >React æºç è§£æâ€”â€”â€”â€”ReactContext.js,ReactLazy.js</a></p><p><a href="https://www.cnblogs.com/sunxiaopei/p/12239160.html" target="_blank" >React çš„ React.createRef()&#x2F;forwardRef()æºç è§£æ(ä¸‰)</a></p><p><a href="https://www.cnblogs.com/sunxiaopei/p/12205447.html" target="_blank" >React çš„ React.createElement æºç è§£æ(ä¸€)</a></p><p><a href="https://zhuanlan.zhihu.com/p/81947864" target="_blank" >React æºç è§£æ(ä¸‰) requestWork ä¹‹å‰çš„çš„å‡†å¤‡å·¥ä½œ</a></p><p><a href="https://wenku.baidu.com/view/4306c6f2d25abe23482fb4daa58da0116c171fe1.html" target="_blank" >react æºç è§£æ 7.Fiber æ¶æ„</a></p><h2 id="å‰åç‰ˆæœ¬å·®å¼‚"><a href="#å‰åç‰ˆæœ¬å·®å¼‚" class="headerlink" title="å‰åç‰ˆæœ¬å·®å¼‚"></a>å‰åç‰ˆæœ¬å·®å¼‚</h2><h3 id="expirationTime"><a href="#expirationTime" class="headerlink" title="expirationTime"></a>expirationTime</h3><p>expirationTime è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè€Œç°åœ¨æ˜¯ expirationTime è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜</p><h3 id="React16-ä¸-17-ç‰ˆæœ¬åˆæˆäº‹ä»¶çš„åŒºåˆ«"><a href="#React16-ä¸-17-ç‰ˆæœ¬åˆæˆäº‹ä»¶çš„åŒºåˆ«" class="headerlink" title="React16 ä¸ 17 ç‰ˆæœ¬åˆæˆäº‹ä»¶çš„åŒºåˆ«"></a>React16 ä¸ 17 ç‰ˆæœ¬åˆæˆäº‹ä»¶çš„åŒºåˆ«</h3><ul><li>react16 æ—¶äº‹ä»¶å§”æ‰˜çš„å¯¹è±¡æ˜¯ documentï¼Œreact17 æ—¶äº‹ä»¶å§”æ‰˜çš„å¯¹è±¡æ˜¯å®¹å™¨ç»„ä»¶</li><li>react16 æ—¶åŸç”Ÿäº‹ä»¶ä¸ react äº‹ä»¶æ‰§è¡Œæ—¶ï¼Œå†’æ³¡é˜¶æ®µä¸æ•è·é˜¶æ®µæ²¡æœ‰åŒºåˆ†å¼€ï¼ˆæ•è·-&gt; å†’æ³¡ -&gt; æ•è·ï¼‰ï¼›</li><li>react17 æ—¶ä¼˜åŒ–äº†åˆæˆäº‹ä»¶çš„æ‰§è¡Œï¼Œå½“ä¸åŸç”Ÿäº‹ä»¶ä¸€èµ·è°ƒç”¨æ—¶ï¼Œæ•è·é˜¶æ®µæ€»æ˜¯å…ˆäºå†’æ³¡é˜¶æ®µï¼ˆæ•è· -&gt; å†’æ³¡ï¼‰</li><li>react17 åºŸå¼ƒäº†äº‹ä»¶æ± </li></ul><!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒMonkey_Kcodeã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_47431743/article/details/122156714 --><h3 id="æ›´æ”¹äº‹ä»¶å§”æ‰˜"><a href="#æ›´æ”¹äº‹ä»¶å§”æ‰˜" class="headerlink" title="æ›´æ”¹äº‹ä»¶å§”æ‰˜"></a>æ›´æ”¹äº‹ä»¶å§”æ‰˜</h3><p>ä»æŠ€æœ¯ä¸Šè®²ï¼Œå§‹ç»ˆå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­åµŒå¥—ä¸åŒç‰ˆæœ¬çš„ Reactã€‚ä½†æ˜¯ï¼Œç”±äº React äº‹ä»¶ç³»ç»Ÿçš„å·¥ä½œåŸç†ï¼Œè¿™å¾ˆéš¾å®ç°ã€‚</p><p>è‡ªä»å…¶å‘å¸ƒä»¥æ¥ï¼ŒReact ä¸€ç›´è‡ªåŠ¨è¿›è¡Œäº‹ä»¶å§”æ‰˜ã€‚å½“ document ä¸Šè§¦å‘ DOM äº‹ä»¶æ—¶ï¼ŒReact ä¼šæ‰¾å‡ºè°ƒç”¨çš„ç»„ä»¶ï¼Œç„¶å React äº‹ä»¶ä¼šåœ¨ç»„ä»¶ä¸­å‘ä¸Š â€œå†’æ³¡â€ã€‚ä½†å®é™…ä¸Šï¼ŒåŸç”Ÿäº‹ä»¶å·²ç»å†’æ³¡å‡ºäº† document çº§åˆ«ï¼ŒReact åœ¨å…¶ä¸­å®‰è£…äº†äº‹ä»¶å¤„ç†å™¨ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™å°±æ˜¯é€æ­¥å‡çº§çš„å›°éš¾æ‰€åœ¨ã€‚</p><p><span style="color: red">å¦‚æœé¡µé¢ä¸Šæœ‰å¤šä¸ª React ç‰ˆæœ¬ï¼Œä»–ä»¬éƒ½å°†åœ¨é¡¶å±‚æ³¨å†Œäº‹ä»¶å¤„ç†å™¨ã€‚è¿™ä¼šç ´å <code>e.stopPropagation()</code>ï¼šå¦‚æœåµŒå¥—æ ‘ç»“æ„ä¸­é˜»æ­¢äº†äº‹ä»¶å†’æ³¡ï¼Œä½†å¤–éƒ¨æ ‘ä¾ç„¶èƒ½æ¥æ”¶åˆ°å®ƒã€‚è¿™ä¼šä½¿ä¸åŒç‰ˆæœ¬ React åµŒå¥—å˜å¾—å›°éš¾é‡é‡</span>ã€‚è¿™ç§æ‹…å¿§å¹¶ä¸æ˜¯æ²¡æœ‰æ ¹æ®çš„ â€”â€” ä¾‹å¦‚ï¼Œå››å¹´å‰ Atom ç¼–è¾‘å™¨å°±é‡åˆ°äº†ç›¸åŒçš„é—®é¢˜ã€‚</p><p>åŸºäºæ­¤ï¼š åœ¨ React 17 ä¸­ï¼ŒReact å°†ä¸å†å‘ document é™„åŠ äº‹ä»¶å¤„ç†å™¨ã€‚è€Œä¼šå°†äº‹ä»¶å¤„ç†å™¨é™„åŠ åˆ°æ¸²æŸ“ React æ ‘çš„æ ¹ DOM å®¹å™¨ä¸­ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const rootNode &#x3D; document.getElementById(&quot;root&quot;);ReactDOM.render(&lt;App &#x2F;&gt;, rootNode);</code></pre><p>åœ¨ React 16 æˆ–æ›´æ—©ç‰ˆæœ¬ä¸­ï¼ŒReact ä¼šå¯¹å¤§å¤šæ•°äº‹ä»¶æ‰§è¡Œ <code>document.addEventListener()</code>ã€‚React 17 å°†ä¼šåœ¨åº•å±‚è°ƒç”¨ <code>rootNode.addEventListener()</code>ã€‚</p><h3 id="Hooks-çš„å®ç°åŸç†"><a href="#Hooks-çš„å®ç°åŸç†" class="headerlink" title="Hooks çš„å®ç°åŸç†"></a>Hooks çš„å®ç°åŸç†</h3><p>React ä¼šç»´æŠ¤ä¿©ä¸ªé“¾è¡¨ï¼Œä¸€ä¸ªæ˜¯ <code>currentHook</code>ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ <code>WorkInProgressHook</code>,æ¯ä¸€ä¸ªèŠ‚ç‚¹ç±»å‹éƒ½æ˜¯ <code>Hooks</code>ï¼Œæ¯å½“ <code>hooks</code> å‡½æ•°è¢«è°ƒç”¨ï¼Œreact å°±ä¼šåˆ›å»ºä¸€ä¸ª <code>hooks</code> å¯¹è±¡ï¼Œå¹¶æŒ‚åœ¨é“¾è¡¨çš„å°¾éƒ¨ï¼Œå‡½æ•°ç»„ä»¶ä¹‹æ‰€ä»¥èƒ½åšä¸€äº›ç±»ç»„ä»¶ä¸èƒ½åšçš„äº‹å„¿ï¼Œå°±æ˜¯å› ä¸º <code>hook</code> å¯¹è±¡ï¼Œå‡½æ•°ç»„ä»¶çš„çŠ¶æ€ï¼Œè®¡ç®—å€¼ï¼Œç¼“å­˜ç­‰éƒ½æ˜¯äº¤ç»™ <code>hook</code> å»å®Œæˆçš„ï¼Œè¿™æ ·ç»„ä»¶é€šè¿‡ Fiber.memoizedState å±æ€§æŒ‡å‘ hook é“¾è¡¨çš„å¤´éƒ¨æ¥å…³è” <code>hook</code> å¯¹è±¡å’Œå½“å‰ç»„ä»¶ï¼Œè¿™æ ·å°±å‘æŒ¥äº† <code>hooks</code> çš„ä½œç”¨ã€‚æ¯æ¬¡è°ƒç”¨ hooks API çš„æ—¶å€™ï¼Œå°±ä¼šé¦–å…ˆè°ƒç”¨ <code>createWorkInProgressHook</code> å‡½æ•°ã€‚å¾—åˆ° <code>hooks</code> çš„ä¸²è”ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œä»æ ¹èŠ‚ç‚¹ <code>workInProgressHook</code> å‘ä¸‹é€šè¿‡ next è¿›è¡Œä¸²è”ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ <code>Hooks</code> ä¸èƒ½åµŒå¥—ä½¿ç”¨ï¼Œä¸èƒ½åœ¨æ¡ä»¶åˆ¤æ–­ä¸­ä½¿ç”¨ï¼Œä¸èƒ½åœ¨å¾ªç¯ä¸­ä½¿ç”¨ï¼Œå¦åˆ™é“¾å¼å°±ä¼šè¢«ç ´åã€‚</p><!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œleoxiaogeã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/github_37759996/article/details/119187241 --><h3 id="createSyntheticEvent-æºç "><a href="#createSyntheticEvent-æºç " class="headerlink" title="createSyntheticEvent æºç "></a>createSyntheticEvent æºç </h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">function createSyntheticEvent(Interface: EventInterfaceType) &#123;  function SyntheticBaseEvent(    reactName: string | null,    reactEventType: string,    targetInst: Fiber,    nativeEvent: &#123;[propName: string]: mixed&#125;,    nativeEventTarget: null | EventTarget,  ) &#123;  Object.assign(SyntheticBaseEvent.prototype, &#123;    preventDefault: function() &#123;&#125;,    stopPropagation: function() &#123;&#125;,    &#x2F;**     * We release all dispatched &#96;SyntheticEvent&#96;s after each event loop, adding     * them back into the pool. This allows a way to hold onto a reference that     * won&#39;t be added back into the pool.     *&#x2F;    &#x2F;**    *æˆ‘ä»¬åœ¨æ¯ä¸ªäº‹ä»¶å¾ªç¯åé‡Šæ”¾æ‰€æœ‰è°ƒåº¦çš„&#39;SyntheticEvent&#39;ï¼Œæ·»åŠ     *ä»–ä»¬å›åˆ°æ°´æ± é‡Œã€‚è¿™å…è®¸ä¸€ç§ä¿æŒå¼•ç”¨çš„æ–¹æ³•    *ä¸ä¼šè¢«æ·»åŠ å›æ± ä¸­ã€‚    *&#x2F;    persist: function() &#123;      &#x2F;&#x2F; Modern event system doesn&#39;t use pooling.      &#x2F;&#x2F; ç°ä»£äº‹ä»¶ç³»ç»Ÿä¸ä½¿ç”¨æ± ã€‚    &#125;,    &#x2F;**     * Checks if this event should be released back into the pool.     *     * @return &#123;boolean&#125; True if this should not be released, false otherwise.     *&#x2F;    isPersistent: functionThatReturnsTrue,  &#125;);  return SyntheticBaseEvent;&#125;</code></pre><p><code>persist</code>æ˜¯ä¸ªç©ºå‡½æ•°ï¼Œå› ä¸ºç°åœ¨çš„äº‹ä»¶ç³»ç»Ÿä¸ä½¿ç”¨<code>äº‹ä»¶æ± æœºåˆ¶</code></p><p><code>äº‹ä»¶æ± </code>å¯ä»¥å½¢è±¡åœ°ç†è§£ä¸ºæœ‰ä¸ªæ± å­é‡Œè£…æ»¡äº† SyntheticEvent å¯¹è±¡ï¼Œç¨‹åºæœ‰éœ€è¦æ—¶ä¼šä»æ± ä¸­å–å‡ºä¸€äº›ä½¿ç”¨ï¼Œä½¿ç”¨å®Œåå†æ”¾å›æ± ä¸­ã€‚</p><p><code>äº‹ä»¶æ± æœºåˆ¶</code>æ„å‘³ç€ SyntheticEvent å¯¹è±¡ä¼šè¢«ç¼“å­˜ä¸”åå¤ä½¿ç”¨ï¼Œç›®çš„æ˜¯æé«˜æ€§èƒ½ï¼Œå‡å°‘åˆ›å»ºä¸å¿…è¦çš„å¯¹è±¡ã€‚å½“ SyntheticEvent å¯¹è±¡è¢«æ”¶å›åˆ°äº‹ä»¶æ± ä¸­æ—¶ï¼Œå±æ€§ä¼šè¢«æŠ¹é™¤ã€é‡ç½®ä¸º nullã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å†™ React äº‹ä»¶å›è°ƒå‡½æ•°çš„æ—¶å€™åˆ‡è®°<code>ä¸èƒ½å°† event ç”¨äºå¼‚æ­¥æ“ä½œ</code> â€”â€” å½“å¼‚æ­¥æ“ä½œçœŸæ­£æ‰§è¡Œçš„æ—¶å€™ï¼ŒSyntheticEvent å¯¹è±¡æœ‰å¯èƒ½å·²ç»è¢«é‡ç½®äº†</p><p><strong>æœ‰äº‹ä»¶æ± çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å¤„ç†å¼‚æ­¥äº‹ä»¶</strong></p><ul><li>è§£å†³æ–¹æ¡ˆä¸€ï¼š ä½¿ç”¨ event.persist() æ–¹æ³•</li><li>è§£å†³æ–¹æ¡ˆäºŒï¼š åŠæ—¶ç¼“å­˜æ‰€éœ€çš„ event å±æ€§å€¼</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è§£å†³æ–¹æ¡ˆä¸€ï¼šhandleChange &#x3D; (event) &#x3D;&gt; &#123;  event.persist(); &#x2F;&#x2F; æŒä¹…åŒ–  this.setState((prevState) &#x3D;&gt; (&#123;    value: event.target.value,    editionCounter: prevState.editionCounter + 1,  &#125;));&#125;;&#x2F;&#x2F; è§£å†³æ–¹æ¡ˆäºŒï¼šhandleChange &#x3D; (event) &#x3D;&gt; &#123;  const value &#x3D; event.target.value; &#x2F;&#x2F; valueè¿™ä¸ªæœ¬åœ°å˜é‡å·²ç»ä¿å­˜äº†ç›®æ ‡å€¼  this.setState((prevState) &#x3D;&gt; (&#123;    value,    editionCounter: prevState.editionCounter + 1,  &#125;));&#125;;</code></pre><p><a href="https://zhuanlan.zhihu.com/p/212187297" target="_blank" >è§</a></p><p><strong>ç§»é™¤ç‰ˆæœ¬</strong><br>åœ¨ 17.0.0 (October 20, 2020)ï¼ŒReact DOMï¼ŒRemove event pooling. (@trueadm in #18969)</p><p><strong>ç§»é™¤åŸå› </strong></p><p><a href="https://blog.saeloun.com/2021/04/06/react-17-removes-event-pooling-in-modern-system.html#event-pooling" target="_blank" >è§ Event Pooling</a></p><ul><li>è™½ç„¶å»ºç«‹äº‹ä»¶æ± æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œä½†åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¹¶æ²¡æœ‰æé«˜æ€§èƒ½ã€‚</li><li>äº‹ä»¶æ± ä¹Ÿè®©å¼€å‘äººå‘˜æ„Ÿåˆ°å›°æƒ‘ã€‚ä¾‹å¦‚ï¼Œæ— æ³•è®¿é—®<code>eventx.target</code>ã€‚è®¾ç½®çŠ¶æ€æ›´æ–°ç¨‹åºä¸­çš„ç›®æ ‡ã€‚</li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>With React 16 and earlier, we have to call event.persist() to properly use the event, or read the property we need.</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js">handleChange(event) &#123;  console.log(event.target.value);  event.persist();  this.setState(() &#x3D;&gt; (&#123;    text: event.target.value  &#125;));&#125;</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>In React 17, the same code works as expected allowing us to fetch event.target.value without calling event.persist().<br>The old event pooling optimization has been fully removed, so we can read the event fields whenever we need them.</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js">export class App extends React.Component &#123;  constructor() &#123;    super();    this.state &#x3D; &#123; text: &quot;&quot; &#125;;    this.handleChange &#x3D; this.handleChange.bind(this);  &#125;  handleChange(event) &#123;    console.log(event.target.value);    this.setState(() &#x3D;&gt; (&#123;      text: event.target.value,    &#125;));  &#125;  render() &#123;    return (      &lt;div&gt;        &lt;span&gt;Text: &lt;&#x2F;span&gt;        &lt;input onChange&#x3D;&#123;this.handleChange&#125; value&#x3D;&#123;this.state.text&#125; &#x2F;&gt;      &lt;&#x2F;div&gt;    );  &#125;&#125;</code></pre><h3 id="ä¸ºä»€ä¹ˆåŸç”Ÿäº‹ä»¶çš„-stopPropagation-å¯ä»¥é˜»æ­¢åˆæˆäº‹ä»¶çš„ä¼ é€’ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåŸç”Ÿäº‹ä»¶çš„-stopPropagation-å¯ä»¥é˜»æ­¢åˆæˆäº‹ä»¶çš„ä¼ é€’ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåŸç”Ÿäº‹ä»¶çš„ stopPropagation å¯ä»¥é˜»æ­¢åˆæˆäº‹ä»¶çš„ä¼ é€’ï¼Ÿ"></a>ä¸ºä»€ä¹ˆåŸç”Ÿäº‹ä»¶çš„ stopPropagation å¯ä»¥é˜»æ­¢åˆæˆäº‹ä»¶çš„ä¼ é€’ï¼Ÿ</h3><p>å› ä¸ºåˆæˆäº‹ä»¶æ˜¯åœ¨åŸç”Ÿäº‹ä»¶è§¦å‘ä¹‹åæ‰å¼€å§‹æ”¶é›†å¹¶è§¦å‘çš„ï¼Œæ‰€ä»¥å½“åŸç”Ÿäº‹ä»¶è°ƒç”¨ stopPropagation é˜»æ­¢ä¼ é€’åï¼Œæ ¹æœ¬åˆ°ä¸åˆ° root èŠ‚ç‚¹ï¼Œè§¦å‘ä¸äº† React ç»‘å®šçš„å¤„ç†å‡½æ•°ï¼Œè‡ªç„¶åˆæˆäº‹ä»¶ä¹Ÿä¸ä¼šè§¦å‘ï¼Œæ‰€ä»¥åŸç”Ÿäº‹ä»¶ä¸æ˜¯é˜»æ­¢äº†åˆæˆäº‹ä»¶çš„ä¼ é€’ï¼Œè€Œæ˜¯é˜»æ­¢äº† React ä¸­ç»‘å®šçš„äº‹ä»¶å‡½æ•°çš„æ‰§è¡Œã€‚</p><h3 id="react-åŸºç¡€çŸ¥è¯†æ€»ç»“"><a href="#react-åŸºç¡€çŸ¥è¯†æ€»ç»“" class="headerlink" title="react åŸºç¡€çŸ¥è¯†æ€»ç»“"></a>react åŸºç¡€çŸ¥è¯†æ€»ç»“</h3><p><a href="http://www.zzvips.com/article/230111.html" target="_blank" >è§</a></p><h2 id="React17-æºç "><a href="#React17-æºç " class="headerlink" title="React17 æºç "></a>React17 æºç </h2><p><a href="https://www.zhihu.com/column/c_1203007131219533824" target="_blank" >è§</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://www.zzvips.com/article/230111.html" target="_blank" >react åŸºç¡€çŸ¥è¯†æ€»ç»“</a></p><p><a href="http://www.zzvips.com/article/227118.html" target="_blank" >React äº‹ä»¶æœºåˆ¶æºç è§£æ 17.0.1</a></p><p><a href="https://react.docschina.org/blog/2020/08/10/react-v17-rc.html#changes-to-event-delegation" target="_blank" >æ›´æ”¹äº‹ä»¶å§”æ‰˜</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React@16.5.0 diffing algorithm</title>
      <link href="//post/2022-07-22react-diffing.html"/>
      <url>//post/2022-07-22react-diffing.html</url>
      
        <content type="html"><![CDATA[<h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>React provides a declarative API so that you donâ€™t have to worry about exactly what changes on every update. This makes writing applications a lot easier, but it might not be obvious how this is implemented within React. This article explains the choices we made in Reactâ€™s â€œdiffingâ€ algorithm so that component updates are predictable while being fast enough for high-performance apps.</p></blockquote><p>å—¯ï¼Œè¿™é‡Œä½¿ç”¨äº†è‹±æ–‡åŸæ–‡ï¼Œæˆ‘è§‰å¾—ä¸­æ–‡ç‰ˆæœ¬ï¼Œç¿»è¯‘çš„ä¸å¤Ÿå‡†ç¡®</p><p>æ’‡å¼€ä¸­æ–‡ç‰ˆå®˜æ–¹ä¸è°ˆï¼Œè¯‘æ–‡å¦‚ä¸‹ï¼š</p><p>React æä¾›äº†å“åº”å¼ API,æ‰€ä»¥ä½ ä¸ç”¨æ‹…å¿ƒæ¯æ¬¡æ›´æ–°éƒ½ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚è¿™ä½¿å¾—å¼€å‘åº”ç”¨æ›´ç‚¹å•ï¼Œä½†åœ¨ React ä¸­å¦‚ä½•å®ç°è¿™ä¸€ç‚¹å¯èƒ½å¹¶ä¸æ˜æ˜¾ã€‚è¿™ç¯‡æ–‡ç« è§£é‡Šäº†æˆ‘ä»¬åœ¨ React çš„ diffing ç®—æ³•çš„é€‰æ‹©ï¼Œå› æ­¤ï¼Œç»„ä»¶æ›´æ–°æ˜¯å¯é¢„æµ‹çš„ï¼ŒåŒæ—¶å¯¹é«˜æ€§èƒ½åº”ç”¨ç¨‹åºæ¥è¯´è¶³å¤Ÿå¿«ã€‚</p><h2 id="è®¾è®¡åŠ¨æœº"><a href="#è®¾è®¡åŠ¨æœº" class="headerlink" title="è®¾è®¡åŠ¨æœº"></a>è®¾è®¡åŠ¨æœº</h2><p>åœ¨æŸä¸€æ—¶é—´èŠ‚ç‚¹è°ƒç”¨ React çš„ render() æ–¹æ³•ï¼Œä¼šåˆ›å»ºä¸€æ£µç”± React å…ƒç´ ç»„æˆçš„æ ‘ã€‚</p><p>åœ¨ä¸‹ä¸€æ¬¡ state æˆ– props æ›´æ–°æ—¶ï¼Œç›¸åŒçš„ render() æ–¹æ³•ä¼šè¿”å›ä¸€æ£µä¸åŒçš„æ ‘ã€‚</p><p>React éœ€è¦åŸºäºè¿™ä¸¤æ£µæ ‘ä¹‹é—´çš„å·®åˆ«æ¥åˆ¤æ–­å¦‚ä½•é«˜æ•ˆçš„æ›´æ–° UIï¼Œä»¥ä¿è¯å½“å‰ UI ä¸æœ€æ–°çš„æ ‘ä¿æŒåŒæ­¥ã€‚</p><p>æ­¤ç®—æ³•æœ‰ä¸€äº›é€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œå³ç”Ÿæˆå°†ä¸€æ£µæ ‘è½¬æ¢æˆå¦ä¸€æ£µæ ‘çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚ç„¶è€Œï¼Œå³ä½¿ä½¿ç”¨æœ€ä¼˜çš„ç®—æ³•ï¼Œè¯¥ç®—æ³•çš„å¤æ‚ç¨‹åº¦ä»ä¸º O(n 3 )ï¼Œå…¶ä¸­ n æ˜¯æ ‘ä¸­å…ƒç´ çš„æ•°é‡ã€‚</p><p>å¦‚æœåœ¨ React ä¸­ä½¿ç”¨è¯¥ç®—æ³•ï¼Œé‚£ä¹ˆå±•ç¤º 1000 ä¸ªå…ƒç´ åˆ™éœ€è¦ 10 äº¿æ¬¡çš„æ¯”è¾ƒã€‚è¿™ä¸ªå¼€é”€å®åœ¨æ˜¯å¤ªè¿‡é«˜æ˜‚ã€‚äºæ˜¯ React åœ¨ä»¥ä¸‹ä¸¤ä¸ªå‡è®¾çš„åŸºç¡€ä¹‹ä¸Šæå‡ºäº†ä¸€å¥— O(n) çš„ <code>å¯å‘å¼ç®—æ³•</code>ï¼š</p><ul><li><code>ä¸¤ä¸ªä¸åŒç±»å‹çš„å…ƒç´ ä¼šäº§ç”Ÿå‡ºä¸åŒçš„æ ‘ï¼›</code></li><li><code>å¼€å‘è€…å¯ä»¥ä½¿ç”¨ key å±æ€§æ ‡è¯†å“ªäº›å­å…ƒç´ åœ¨ä¸åŒçš„æ¸²æŸ“ä¸­å¯èƒ½æ˜¯ä¸å˜çš„ã€‚</code></li></ul><p>åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å‘ç°ä»¥ä¸Šå‡è®¾åœ¨å‡ ä¹æ‰€æœ‰å®ç”¨çš„åœºæ™¯ä¸‹éƒ½æˆç«‹ã€‚</p><details class="custom-details"><summary>å¯å‘å¼ç®—æ³•å®šä¹‰</summary><p><a href="https://baike.baidu.com/item/%E5%90%AF%E5%8F%91%E5%BC%8F%E7%AE%97%E6%B3%95/938987" target="_blank" ><code>å¯å‘å¼ç®—æ³•</code></a>ï¼ˆheuristic algorithm)æ˜¯ç›¸å¯¹äºæœ€ä¼˜åŒ–ç®—æ³•æå‡ºçš„ã€‚ä¸€ä¸ªé—®é¢˜çš„æœ€ä¼˜ç®—æ³•æ±‚å¾—è¯¥é—®é¢˜æ¯ä¸ªå®ä¾‹çš„æœ€ä¼˜è§£ã€‚å¯å‘å¼ç®—æ³•å¯ä»¥è¿™æ ·å®šä¹‰ï¼šä¸€ä¸ªåŸºäºç›´è§‚æˆ–ç»éªŒæ„é€ çš„ç®—æ³•ï¼Œåœ¨å¯æ¥å—çš„èŠ±è´¹ï¼ˆæŒ‡è®¡ç®—æ—¶é—´å’Œç©ºé—´ï¼‰ä¸‹ç»™å‡ºå¾…è§£å†³ç»„åˆä¼˜åŒ–é—®é¢˜æ¯ä¸€ä¸ªå®ä¾‹çš„ä¸€ä¸ªå¯è¡Œè§£ï¼Œè¯¥å¯è¡Œè§£ä¸æœ€ä¼˜è§£çš„åç¦»ç¨‹åº¦ä¸€èˆ¬ä¸èƒ½è¢«é¢„è®¡</p></details><h2 id="Diffing-ç®—æ³•"><a href="#Diffing-ç®—æ³•" class="headerlink" title="Diffing ç®—æ³•"></a>Diffing ç®—æ³•</h2><p>å½“å¯¹æ¯”ä¸¤æ£µæ ‘æ—¶ï¼ŒReact é¦–å…ˆæ¯”è¾ƒä¸¤æ£µæ ‘çš„æ ¹èŠ‚ç‚¹ã€‚ä¸åŒç±»å‹çš„æ ¹èŠ‚ç‚¹å…ƒç´ ä¼šæœ‰ä¸åŒçš„å½¢æ€ã€‚</p><h3 id="å¯¹æ¯”ä¸åŒç±»å‹çš„å…ƒç´ "><a href="#å¯¹æ¯”ä¸åŒç±»å‹çš„å…ƒç´ " class="headerlink" title="å¯¹æ¯”ä¸åŒç±»å‹çš„å…ƒç´ "></a>å¯¹æ¯”ä¸åŒç±»å‹çš„å…ƒç´ </h3><p>å½“æ ¹èŠ‚ç‚¹ä¸ºä¸åŒç±»å‹çš„å…ƒç´ æ—¶ï¼ŒReact ä¼šæ‹†å¸åŸæœ‰çš„æ ‘å¹¶ä¸”å»ºç«‹èµ·æ–°çš„æ ‘</p><ul><li><p>å½“å¸è½½ä¸€æ£µæ ‘æ—¶ï¼Œå¯¹åº”çš„ DOM èŠ‚ç‚¹ä¹Ÿä¼šè¢«é”€æ¯ã€‚ç»„ä»¶å®ä¾‹å°†æ‰§è¡Œ <code>componentWillUnmount()</code> æ–¹æ³•ã€‚</p></li><li><p>å½“å»ºç«‹ä¸€æ£µæ–°çš„æ ‘æ—¶ï¼Œå¯¹åº”çš„ DOM èŠ‚ç‚¹ä¼šè¢«åˆ›å»ºä»¥åŠæ’å…¥åˆ° DOM ä¸­ã€‚ç»„ä»¶å®ä¾‹å°†æ‰§è¡Œ <code>UNSAFE_componentWillMount()</code> æ–¹æ³•ï¼Œç´§æ¥ç€ <code>componentDidMount()</code> æ–¹æ³•ã€‚</p></li></ul><p>æ‰€æœ‰ä¸ä¹‹å‰çš„æ ‘ç›¸å…³è”çš„ state ä¹Ÿä¼šè¢«é”€æ¯ã€‚</p><p>åœ¨æ ¹èŠ‚ç‚¹ä»¥ä¸‹çš„ç»„ä»¶ä¹Ÿä¼šè¢«å¸è½½ï¼Œå®ƒä»¬çš„çŠ¶æ€ä¼šè¢«é”€æ¯ã€‚æ¯”å¦‚ï¼Œå½“æ¯”å¯¹ä»¥ä¸‹æ›´å˜æ—¶ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;div&gt;  &lt;Counter &#x2F;&gt;&lt;&#x2F;div&gt;&lt;span&gt;  &lt;Counter &#x2F;&gt;&lt;&#x2F;span&gt;</code></pre><p>React ä¼šé”€æ¯ Counter ç»„ä»¶å¹¶ä¸”é‡æ–°è£…è½½ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚</p><h3 id="å¯¹æ¯”åŒä¸€ç±»å‹çš„å…ƒç´ "><a href="#å¯¹æ¯”åŒä¸€ç±»å‹çš„å…ƒç´ " class="headerlink" title="å¯¹æ¯”åŒä¸€ç±»å‹çš„å…ƒç´ "></a>å¯¹æ¯”åŒä¸€ç±»å‹çš„å…ƒç´ </h3><p>å½“å¯¹æ¯”ä¸¤ä¸ªç›¸åŒç±»å‹çš„ React å…ƒç´ æ—¶ï¼ŒReact ä¼šä¿ç•™ DOM èŠ‚ç‚¹ï¼Œä»…æ¯”å¯¹åŠæ›´æ–°æœ‰æ”¹å˜çš„å±æ€§ã€‚æ¯”å¦‚ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;div className&#x3D;&quot;before&quot; title&#x3D;&quot;stuff&quot; &#x2F;&gt;&lt;div className&#x3D;&quot;after&quot; title&#x3D;&quot;stuff&quot; &#x2F;&gt;</code></pre><p>é€šè¿‡å¯¹æ¯”è¿™ä¸¤ä¸ªå…ƒç´ ï¼ŒReact çŸ¥é“åªéœ€è¦ä¿®æ”¹ DOM å…ƒç´ ä¸Šçš„ <code>className</code> å±æ€§ã€‚</p><br/><br/><p>å½“æ›´æ–° <code>style</code> å±æ€§æ—¶ï¼ŒReact ä»…æ›´æ–°æœ‰æ‰€æ›´å˜çš„å±æ€§ã€‚æ¯”å¦‚ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;div style&#x3D;&#123;&#123;color: &#39;red&#39;, fontWeight: &#39;bold&#39;&#125;&#125; &#x2F;&gt;&lt;div style&#x3D;&#123;&#123;color: &#39;green&#39;, fontWeight: &#39;bold&#39;&#125;&#125; &#x2F;&gt;</code></pre><p>é€šè¿‡å¯¹æ¯”è¿™ä¸¤ä¸ªå…ƒç´ ï¼ŒReact çŸ¥é“åªéœ€è¦ä¿®æ”¹ DOM å…ƒç´ ä¸Šçš„ <code>color</code> æ ·å¼ï¼Œæ— éœ€ä¿®æ”¹ <code>fontWeight</code>ã€‚</p><p>åœ¨å¤„ç†å®Œå½“å‰èŠ‚ç‚¹ä¹‹åï¼ŒReact ç»§ç»­å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’ã€‚</p><h3 id="å¯¹æ¯”åŒç±»å‹çš„ç»„ä»¶å…ƒç´ "><a href="#å¯¹æ¯”åŒç±»å‹çš„ç»„ä»¶å…ƒç´ " class="headerlink" title="å¯¹æ¯”åŒç±»å‹çš„ç»„ä»¶å…ƒç´ "></a>å¯¹æ¯”åŒç±»å‹çš„ç»„ä»¶å…ƒç´ </h3><p>å½“ä¸€ä¸ªç»„ä»¶æ›´æ–°æ—¶ï¼Œ<code>ç»„ä»¶å®ä¾‹ä¼šä¿æŒä¸å˜</code>ï¼Œå› æ­¤å¯ä»¥åœ¨ä¸åŒçš„æ¸²æŸ“æ—¶ä¿æŒ state ä¸€è‡´ã€‚React å°†æ›´æ–°è¯¥ç»„ä»¶å®ä¾‹çš„ props ä»¥ä¿è¯ä¸æœ€æ–°çš„å…ƒç´ ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”è°ƒç”¨è¯¥å®ä¾‹çš„ <code>UNSAFE_componentWillReceiveProps()</code>ã€<code>UNSAFE_componentWillUpdate()</code> ä»¥åŠ <code>componentDidUpdate()</code>æ–¹æ³•ã€‚</p><p>ä¸‹ä¸€æ­¥ï¼Œè°ƒç”¨ render() æ–¹æ³•ï¼Œ<strong>diff ç®—æ³•å°†åœ¨ä¹‹å‰çš„ç»“æœä»¥åŠæ–°çš„ç»“æœä¸­è¿›è¡Œé€’å½’</strong>ã€‚</p><h3 id="å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’"><a href="#å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’" class="headerlink" title="å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’"></a>å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“é€’å½’ DOM èŠ‚ç‚¹çš„å­å…ƒç´ æ—¶ï¼ŒReact ä¼šåŒæ—¶éå†ä¸¤ä¸ªå­å…ƒç´ çš„åˆ—è¡¨ï¼›å½“äº§ç”Ÿå·®å¼‚æ—¶ï¼Œç”Ÿæˆä¸€ä¸ª <code>mutation</code>å˜åŒ–ã€‚</p><p><code>åœ¨å­å…ƒç´ åˆ—è¡¨æœ«å°¾æ–°å¢å…ƒç´ æ—¶ï¼Œæ›´æ–°å¼€é”€æ¯”è¾ƒå°</code>ã€‚æ¯”å¦‚ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;ul&gt;  &lt;li&gt;first&lt;&#x2F;li&gt;  &lt;li&gt;second&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;&lt;ul&gt;  &lt;li&gt;first&lt;&#x2F;li&gt;  &lt;li&gt;second&lt;&#x2F;li&gt;  &lt;li&gt;third&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;</code></pre><p>React ä¼šå…ˆåŒ¹é…ä¸¤ä¸ª <li>first</li> å¯¹åº”çš„æ ‘ï¼Œç„¶ååŒ¹é…ç¬¬äºŒä¸ªå…ƒç´  <li>second</li> å¯¹åº”çš„æ ‘ï¼Œæœ€åæ’å…¥ç¬¬ä¸‰ä¸ªå…ƒç´ çš„ <li>third</li> æ ‘ã€‚</p><p>å¦‚æœåªæ˜¯ç®€å•çš„å°†æ–°å¢å…ƒç´ æ’å…¥åˆ°è¡¨å¤´ï¼Œé‚£ä¹ˆæ›´æ–°å¼€é”€ä¼šæ¯”è¾ƒå¤§ã€‚æ¯”å¦‚ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;ul&gt;  &lt;li&gt;Duke&lt;&#x2F;li&gt;  &lt;li&gt;Villanova&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;&lt;ul&gt;  &lt;li&gt;Connecticut&lt;&#x2F;li&gt;  &lt;li&gt;Duke&lt;&#x2F;li&gt;  &lt;li&gt;Villanova&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;</code></pre><p>React å¹¶ä¸ä¼šæ„è¯†åˆ°åº”è¯¥ä¿ç•™ <code>&lt;li&gt;Duke&lt;/li&gt;</code> å’Œ <code>&lt;li&gt;Villanova&lt;/li&gt;</code>ï¼Œè€Œæ˜¯ä¼šé‡å»ºæ¯ä¸€ä¸ªå­å…ƒç´ ã€‚è¿™ç§æƒ…å†µä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ã€‚</p><h3 id="Keys"><a href="#Keys" class="headerlink" title="Keys"></a>Keys</h3><p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒReact å¼•å…¥äº† key å±æ€§ã€‚å½“å­å…ƒç´ æ‹¥æœ‰ key æ—¶ï¼ŒReact ä½¿ç”¨ key æ¥åŒ¹é…åŸæœ‰æ ‘ä¸Šçš„å­å…ƒç´ ä»¥åŠæœ€æ–°æ ‘ä¸Šçš„å­å…ƒç´ ã€‚ä»¥ä¸‹ç¤ºä¾‹åœ¨æ–°å¢ key ä¹‹åï¼Œä½¿å¾—æ ‘çš„è½¬æ¢æ•ˆç‡å¾—ä»¥æé«˜ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;ul&gt;  &lt;li key&#x3D;&quot;2015&quot;&gt;Duke&lt;&#x2F;li&gt;  &lt;li key&#x3D;&quot;2016&quot;&gt;Villanova&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;&lt;ul&gt;  &lt;li key&#x3D;&quot;2014&quot;&gt;Connecticut&lt;&#x2F;li&gt;  &lt;li key&#x3D;&quot;2015&quot;&gt;Duke&lt;&#x2F;li&gt;  &lt;li key&#x3D;&quot;2016&quot;&gt;Villanova&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;</code></pre><p>ç°åœ¨ React çŸ¥é“åªæœ‰å¸¦ç€ <code>&#39;2014&#39;</code> key çš„å…ƒç´ æ˜¯æ–°å…ƒç´ ï¼Œå¸¦ç€ <code>&#39;2015&#39;</code> ä»¥åŠ <code>&#39;2016&#39;</code> key çš„å…ƒç´ ä»…ä»…ç§»åŠ¨äº†ã€‚</p><p>å®é™…å¼€å‘ä¸­ï¼Œç¼–å†™ä¸€ä¸ª key å¹¶ä¸å›°éš¾ã€‚ä½ è¦å±•ç°çš„å…ƒç´ å¯èƒ½å·²ç»æœ‰äº†ä¸€ä¸ªå”¯ä¸€ IDï¼Œäºæ˜¯ key å¯ä»¥ç›´æ¥ä»ä½ çš„æ•°æ®ä¸­æå–ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;li key&#x3D;&#123;item.id&#125;&gt;&#123;item.name&#125;&lt;&#x2F;li&gt;</code></pre><p>å½“ä»¥ä¸Šæƒ…å†µä¸æˆç«‹æ—¶ï¼Œä½ å¯ä»¥æ–°å¢ä¸€ä¸ª ID å­—æ®µåˆ°ä½ çš„æ¨¡å‹ä¸­ï¼Œæˆ–è€…åˆ©ç”¨ä¸€éƒ¨åˆ†å†…å®¹ä½œä¸ºå“ˆå¸Œå€¼æ¥ç”Ÿæˆä¸€ä¸ª keyã€‚<strong>è¿™ä¸ª key ä¸éœ€è¦å…¨å±€å”¯ä¸€ï¼Œä½†åœ¨åˆ—è¡¨ä¸­éœ€è¦ä¿æŒå”¯ä¸€</strong>ã€‚</p><p>æœ€åï¼Œ_ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä½œä¸º keyã€‚è¿™ä¸ªç­–ç•¥åœ¨å…ƒç´ ä¸è¿›è¡Œé‡æ–°æ’åºæ—¶æ¯”è¾ƒåˆé€‚ï¼Œå¦‚æœæœ‰é¡ºåºä¿®æ”¹ï¼Œdiff å°±ä¼šå˜æ…¢_ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><strong>å½“åŸºäºä¸‹æ ‡çš„ç»„ä»¶è¿›è¡Œé‡æ–°æ’åºæ—¶ï¼Œç»„ä»¶ state å¯èƒ½ä¼šé‡åˆ°ä¸€äº›é—®é¢˜</strong>ã€‚ç”±äºç»„ä»¶å®ä¾‹æ˜¯åŸºäºå®ƒä»¬çš„ key æ¥å†³å®šæ˜¯å¦æ›´æ–°ä»¥åŠå¤ç”¨ï¼Œ<code>å¦‚æœ key æ˜¯ä¸€ä¸ªä¸‹æ ‡ï¼Œé‚£ä¹ˆä¿®æ”¹é¡ºåºæ—¶ä¼šä¿®æ”¹å½“å‰çš„ keyï¼Œå¯¼è‡´</code><small style="color: red;">éå—æ§ç»„ä»¶çš„ stateï¼ˆæ¯”å¦‚è¾“å…¥æ¡†ï¼‰</small><code>å¯èƒ½ç›¸äº’ç¯¡æ”¹ï¼Œä¼šå‡ºç°æ— æ³•é¢„æœŸçš„å˜åŠ¨</code>ã€‚</p></p></div><p>åœ¨ Codepen æœ‰ä¸¤ä¸ªä¾‹å­ï¼Œåˆ†åˆ«ä¸º <a href="https://zh-hans.reactjs.org/redirect-to-codepen/reconciliation/index-used-as-key" target="_blank" >å±•ç¤ºä½¿ç”¨ä¸‹æ ‡ä½œä¸º key æ—¶å¯¼è‡´çš„é—®é¢˜</a>ï¼Œä»¥åŠ <a href="https://zh-hans.reactjs.org/redirect-to-codepen/reconciliation/no-index-used-as-key" target="_blank" >ä¸ä½¿ç”¨ä¸‹æ ‡ä½œä¸º key çš„ä¾‹å­çš„ç‰ˆæœ¬ï¼Œä¿®å¤äº†é‡æ–°æ’åˆ—ï¼Œæ’åºï¼Œä»¥åŠåœ¨åˆ—è¡¨å¤´æ’å…¥çš„é—®é¢˜</a>ã€‚</p><p><strong>ä¿®å¤å‰</strong></p><img src="http://t-blog-images.aijs.top/img/Kapture 2022-07-22 at 09.23.57.gif" style="max-width: 100%; width: 400px" /><p><strong>ä¿®å¤å</strong></p><img src="http://t-blog-images.aijs.top/img/Kapture 2022-07-22 at 09.29.46.gif" style="max-width: 100%; width: 400px" /><h2 id="æƒè¡¡"><a href="#æƒè¡¡" class="headerlink" title="æƒè¡¡"></a>æƒè¡¡</h2><p>è¯·è°¨è®°åè°ƒç®—æ³•æ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚ã€‚</p><p>React å¯ä»¥åœ¨æ¯ä¸ª action ä¹‹åå¯¹æ•´ä¸ªåº”ç”¨è¿›è¡Œé‡æ–°æ¸²æŸ“ï¼Œå¾—åˆ°çš„æœ€ç»ˆç»“æœä¹Ÿä¼šæ˜¯ä¸€æ ·çš„ã€‚åœ¨æ­¤æƒ…å¢ƒä¸‹ï¼Œé‡æ–°æ¸²æŸ“è¡¨ç¤ºåœ¨æ‰€æœ‰ç»„ä»¶å†…è°ƒç”¨ render æ–¹æ³•ï¼Œè¿™ä¸ä»£è¡¨ React ä¼šå¸è½½æˆ–è£…è½½å®ƒä»¬ã€‚React åªä¼šåŸºäºä»¥ä¸Šæåˆ°çš„è§„åˆ™æ¥å†³å®šå¦‚ä½•è¿›è¡Œå·®å¼‚çš„åˆå¹¶ã€‚</p><p>æˆ‘ä»¬å®šæœŸä¼˜åŒ–å¯å‘å¼ç®—æ³•ï¼Œè®©å¸¸è§ç”¨ä¾‹æ›´é«˜æ•ˆåœ°æ‰§è¡Œã€‚<strong>åœ¨å½“å‰çš„å®ç°ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€æ£µå­æ ‘èƒ½åœ¨å…¶å…„å¼Ÿä¹‹é—´ç§»åŠ¨ï¼Œä½†ä¸èƒ½ç§»åŠ¨åˆ°å…¶ä»–ä½ç½®ã€‚</strong>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç®—æ³•ä¼šé‡æ–°æ¸²æŸ“æ•´æ£µå­æ ‘ã€‚</p><p>ç”±äº React ä¾èµ–å¯å‘å¼ç®—æ³•ï¼Œå› æ­¤å½“ä»¥ä¸‹å‡è®¾æ²¡æœ‰å¾—åˆ°æ»¡è¶³ï¼Œæ€§èƒ½ä¼šæœ‰æ‰€æŸè€—ã€‚</p><ul><li>è¯¥ç®—æ³•ä¸ä¼šå°è¯•åŒ¹é…ä¸åŒç»„ä»¶ç±»å‹çš„å­æ ‘ã€‚<strong>å¦‚æœä½ å‘ç°ä½ åœ¨ä¸¤ç§ä¸åŒç±»å‹çš„ç»„ä»¶ä¸­åˆ‡æ¢ï¼Œä½†è¾“å‡ºéå¸¸ç›¸ä¼¼çš„å†…å®¹ï¼Œå»ºè®®æŠŠå®ƒä»¬æ”¹æˆåŒä¸€ç±»å‹</strong>ã€‚åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰é‡åˆ°è¿™ç±»é—®é¢˜ã€‚<br/><br/></li><li>Key åº”è¯¥å…·æœ‰ç¨³å®šï¼Œå¯é¢„æµ‹ï¼Œä»¥åŠåˆ—è¡¨å†…å”¯ä¸€çš„ç‰¹è´¨ã€‚ä¸ç¨³å®šçš„ keyï¼ˆæ¯”å¦‚é€šè¿‡ Math.random() ç”Ÿæˆçš„ï¼‰ä¼šå¯¼è‡´è®¸å¤šç»„ä»¶å®ä¾‹å’Œ DOM èŠ‚ç‚¹è¢«ä¸å¿…è¦åœ°é‡æ–°åˆ›å»ºï¼Œ<strong>è¿™å¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™å’Œå­ç»„ä»¶ä¸­çš„çŠ¶æ€ä¸¢å¤±ã€‚</strong></li></ul><h2 id="diffing-algorithm"><a href="#diffing-algorithm" class="headerlink" title="diffing algorithm"></a>diffing algorithm</h2><p><a href="https://react.iamkasong.com/diff/prepare.html#diff%E7%9A%84%E7%93%B6%E9%A2%88%E4%BB%A5%E5%8F%8Areact%E5%A6%82%E4%BD%95%E5%BA%94%E5%AF%B9" target="_blank" >è§</a></p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼šReact æŠ€æœ¯æ­ç§˜è®²çš„å†…å®¹å¹¶ä¸ä¸€å®šæ˜¯å…¨é¢ä¸”æ­£ç¡®çš„ï¼Œå¯èƒ½ä½ åœ¨è¯»çš„æºç ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œä½†å¯å€Ÿé‰´</p></div><h2 id="reconcileChildFibers"><a href="#reconcileChildFibers" class="headerlink" title="reconcileChildFibers"></a>reconcileChildFibers</h2><img src="http://t-blog-images.aijs.top/img/begin-diff.png" /><p>è¯»æºç ä¸­â€¦</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zh-hans.reactjs.org/docs/reconciliation.html#the-diffing-algorithm" target="_blank" >reconciliation</a></p><p><a href="https://blog.csdn.net/weixin_47431743/article/details/121589419" target="_blank" >ä»£ç è°ƒè¯•</a></p><p><a href="https://www.jianshu.com/p/c87cc324756f" target="_blank" >æ¢ç´¢ React æºç ï¼šReconciler</a></p>]]></content>
      
      
      <categories>
          
          <category> React@16.5.0 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React@16.5.0 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React@16.5.0 PureComponent</title>
      <link href="//post/2022-07-21react-PureComponent.html"/>
      <url>//post/2022-07-21react-PureComponent.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸²ä¸²"><a href="#ä¸²ä¸²" class="headerlink" title="ä¸²ä¸²"></a>ä¸²ä¸²</h2><img src="http://t-blog-images.aijs.top/img/pureComponent1.webp" /><p>PureComponent ç»§æ‰¿ Component,æ·»åŠ  isPureReactComponent æ ‡è®°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ComponentDummy æ˜¯å…¸å‹çš„ JavaScript åŸå‹æ¨¡æ‹Ÿç»§æ‰¿çš„åšæ³•ï¼Œfunction ComponentDummy() &#123;&#125;ComponentDummy.prototype &#x3D; Component.prototype;&#x2F;** * Convenience component with default shallow equality check for sCU. * å…·æœ‰sCUé»˜è®¤æµ…ç›¸ç­‰æ£€æŸ¥çš„ä¾¿åˆ©ç»„ä»¶ã€‚ *&#x2F;function PureComponent(props, context, updater) &#123;  this.props &#x3D; props;  this.context &#x3D; context;  &#x2F;&#x2F; If a component has string refs, we will assign a different object later.  &#x2F;&#x2F; å¦‚æœç»„ä»¶å…·æœ‰å­—ç¬¦ä¸²å¼•ç”¨ï¼Œæˆ‘ä»¬å°†ç¨åæŒ‡å®šå…¶ä»–å¯¹è±¡ã€‚  this.refs &#x3D; emptyObject;  this.updater &#x3D; updater || ReactNoopUpdateQueue;&#125;const pureComponentPrototype &#x3D; (PureComponent.prototype &#x3D; new ComponentDummy());pureComponentPrototype.constructor &#x3D; PureComponent;&#x2F;&#x2F; Avoid an extra prototype jump for these methods.  é¿å…è¿™äº›æ–¹æ³•çš„é¢å¤–åŸå‹è·³è½¬ã€‚&#x2F;&#x2F; ä¸ºäº†é¿å…åŸå‹é“¾æ‹‰é•¿å¯¼è‡´æ–¹æ³•æŸ¥æ‰¾çš„æ€§èƒ½å¼€é”€ï¼Œè¿˜ç”¨ Object.assign æŠŠæ–¹æ³•ä» ReactComponent æ‹·è´è¿‡æ¥äº†Object.assign(pureComponentPrototype, Component.prototype);pureComponentPrototype.isPureReactComponent &#x3D; true; &#x2F;&#x2F; checkShouldComponentUpdateä¸­æœ‰æµ…æ¯”è¾ƒ&#96;shallowEqual&#96;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; packages&#x2F;react&#x2F;src&#x2F;ReactBaseClasses.js&#x2F;&#x2F; PureComponent-&gt;ç»§æ‰¿Component, æ·»åŠ  isPureReactComponent &#x3D; true&#x2F;&#x2F; packages&#x2F;react-reconciler&#x2F;src&#x2F;ReactFiberClassComponent.js&#x2F;&#x2F; checkShouldComponentUpdate-&gt;&#x2F;&#x2F; shallowEqual</code></pre><h2 id="checkShouldComponentUpdate"><a href="#checkShouldComponentUpdate" class="headerlink" title="checkShouldComponentUpdate"></a>checkShouldComponentUpdate</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function checkShouldComponentUpdate(  workInProgress,  ctor,  oldProps,  newProps,  oldState,  newState,  nextLegacyContext) &#123;  const instance &#x3D; workInProgress.stateNode;  &#x2F;&#x2F; å®ä¾‹ä¸Šæœ‰shouldComponentUpdateï¼Œèµ°å®ä¾‹çš„åˆ¤æ–­  if (typeof instance.shouldComponentUpdate &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;    startPhaseTimer(workInProgress, &quot;shouldComponentUpdate&quot;);    const shouldUpdate &#x3D; instance.shouldComponentUpdate(      newProps,      newState,      nextLegacyContext    );    stopPhaseTimer();    if (__DEV__) &#123;      warningWithoutStack(        shouldUpdate !&#x3D;&#x3D; undefined,        &quot;%s.shouldComponentUpdate(): Returned undefined instead of a &quot; +          &quot;boolean value. Make sure to return true or false.&quot;,        getComponentName(ctor) || &quot;Component&quot;      );    &#125;    return shouldUpdate; &#x2F;&#x2F; è¿”å›äº†  &#125;  &#x2F;&#x2F; å®ä¾‹æ²¡æœ‰çœ‹çœ‹ç»„ä»¶æ˜¯ä¸æ˜¯PureComponent,å¦‚æœæ˜¯è¿›è¡Œæµ…æ¯”è¾ƒ  &#x2F;&#x2F; æµ…æ¯”è¾ƒ  if (ctor.prototype &amp;&amp; ctor.prototype.isPureReactComponent) &#123;    return (      !shallowEqual(oldProps, newProps) || !shallowEqual(oldState, newState)    );  &#125;  return true;&#125;</code></pre><h2 id="shallowEqual"><a href="#shallowEqual" class="headerlink" title="shallowEqual"></a>shallowEqual</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function shallowEqual(objA: mixed, objB: mixed): boolean &#123;  if (is(objA, objB)) &#123;    return true;  &#125;  if (    typeof objA !&#x3D;&#x3D; &quot;object&quot; ||    objA &#x3D;&#x3D;&#x3D; null ||    typeof objB !&#x3D;&#x3D; &quot;object&quot; ||    objB &#x3D;&#x3D;&#x3D; null  ) &#123;    return false;  &#125;  const keysA &#x3D; Object.keys(objA);  const keysB &#x3D; Object.keys(objB);  if (keysA.length !&#x3D;&#x3D; keysB.length) &#123;    return false;  &#125;  &#x2F;&#x2F; Test for A&#39;s keys different from B.  &#x2F;&#x2F; åªæ˜¯å¯¹é”®å¯¹åº”çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä»MDN Object.is Apiäº†è§£åˆ° éƒ½æ˜¯ç›¸åŒå¯¹è±¡ï¼ˆæ„å‘³ç€éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„å€¼å¼•ç”¨ï¼‰  &#x2F;&#x2F; å¦‚æœè¿™é‡Œè¿›è¡Œé€’å½’å¤„ç†ï¼Œå°±å˜æˆäº†deepCompare  for (let i &#x3D; 0; i &lt; keysA.length; i++) &#123;    if (      !hasOwnProperty.call(objB, keysA[i]) ||      !is(objA[keysA[i]], objB[keysA[i]])    ) &#123;      return false;    &#125;  &#125;  return true;&#125;</code></pre><h2 id="is"><a href="#is" class="headerlink" title="is"></a>is</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * inlined Object.is polyfill to avoid requiring consumers ship their own * https:&#x2F;&#x2F;developer.mozilla.org&#x2F;en-US&#x2F;docs&#x2F;Web&#x2F;JavaScript&#x2F;Reference&#x2F;Global_Objects&#x2F;Object&#x2F;is *&#x2F;function is(x, y) &#123;  &#x2F;&#x2F; SameValue algorithm  if (x &#x3D;&#x3D;&#x3D; y) &#123;    &#x2F;&#x2F; Steps 1-5, 7-10    &#x2F;&#x2F; Steps 6.b-6.e: +0 !&#x3D; -0    &#x2F;&#x2F; Added the nonzero y check to make Flow happy, but it is redundant    return x !&#x3D;&#x3D; 0 || y !&#x3D;&#x3D; 0 || 1 &#x2F; x &#x3D;&#x3D;&#x3D; 1 &#x2F; y;  &#125; else &#123;    &#x2F;&#x2F; Step 6.a: NaN &#x3D;&#x3D; NaN    return x !&#x3D;&#x3D; x &amp;&amp; y !&#x3D;&#x3D; y;  &#125;&#125;</code></pre><h2 id="end-and-start"><a href="#end-and-start" class="headerlink" title="end and start"></a>end and start</h2><p>å…¶å®ä¸Šåˆ°è¿™ä¸ªåœ°æ–¹ï¼ŒPureComponent å°±èŠå®Œäº†</p><h2 id="ä¸-beginWork-ä¸²ä¸²"><a href="#ä¸-beginWork-ä¸²ä¸²" class="headerlink" title="ä¸ beginWork ä¸²ä¸²"></a>ä¸ beginWork ä¸²ä¸²</h2><img src="http://t-blog-images.aijs.top/img/pureComponent.webp" /><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; beginWork-&gt;&#x2F;&#x2F; updateClassComponent(åˆ°è¿™é‡Œå°±ä¸@link: http:&#x2F;&#x2F;v.aijs.top&#x2F;posts&#x2F;2022-07-21react-createElement ä¸²èµ·æ¥äº†)-&gt;&#x2F;&#x2F; resumeMountClassInstance-&gt; | updateClassInstance-&gt;&#x2F;&#x2F; checkShouldComponentUpdate-&gt;&#x2F;&#x2F; shallowEqual</code></pre><h2 id="resumeMountClassInstance"><a href="#resumeMountClassInstance" class="headerlink" title="resumeMountClassInstance"></a>resumeMountClassInstance</h2><p>å¦‚æœå·²ç»åˆ›å»ºå®ä¾‹ï¼Œåˆ™é‡ç”¨å®ä¾‹</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function resumeMountClassInstance(  workInProgress: Fiber,  ctor: any,  newProps: any,  renderExpirationTime: ExpirationTime): boolean &#123;  &#x2F;&#x2F; æ˜¯å¦åº”è¯¥æ›´æ–°ï¼Œä¸¤ç§æƒ…å†µï¼šforceUpdate æˆ–è€… checkShouldComponentUpdate è¿”å›true  const shouldUpdate &#x3D;    checkHasForceUpdateAfterProcessing() ||    checkShouldComponentUpdate(      workInProgress,      ctor,      oldProps,      newProps,      oldState,      newState,      nextLegacyContext    );  if (shouldUpdate) &#123;    &#x2F;&#x2F; In order to support react-lifecycles-compat polyfilled components,    &#x2F;&#x2F; Unsafe lifecycles should not be invoked for components using the new APIs.    if (      !hasNewLifecycles &amp;&amp;      (typeof instance.UNSAFE_componentWillMount &#x3D;&#x3D;&#x3D; &quot;function&quot; ||        typeof instance.componentWillMount &#x3D;&#x3D;&#x3D; &quot;function&quot;)    ) &#123;      startPhaseTimer(workInProgress, &quot;componentWillMount&quot;);      if (typeof instance.componentWillMount &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;        instance.componentWillMount();      &#125;      if (typeof instance.UNSAFE_componentWillMount &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;        instance.UNSAFE_componentWillMount();      &#125;      stopPhaseTimer();    &#125;    &#x2F;&#x2F; è¿™é‡Œè¿›è¡Œæ ‡è®°äº†    if (typeof instance.componentDidMount &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;      workInProgress.effectTag |&#x3D; Update;    &#125;  &#125; else &#123;  &#125;  &#x2F;&#x2F; Update the existing instance&#39;s state, props, and context pointers even  &#x2F;&#x2F; if shouldComponentUpdate returns false.  instance.props &#x3D; newProps;  instance.state &#x3D; newState;  instance.context &#x3D; nextLegacyContext;  return shouldUpdate;&#125;</code></pre><h2 id="startPhaseTimer"><a href="#startPhaseTimer" class="headerlink" title="startPhaseTimer"></a>startPhaseTimer</h2><p><code>packages/react-reconciler/src/ReactDebugFiberPerf.js</code>æ–‡ä»¶ä¸­ï¼Œæ€§èƒ½æµ‹é‡ç›¸å…³ï¼Œä¸ç”¨å…³å¿ƒ</p><h2 id="updateClassComponent"><a href="#updateClassComponent" class="headerlink" title="updateClassComponent"></a>updateClassComponent</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function updateClassComponent(  current: Fiber | null,  workInProgress: Fiber,  Component: any,  nextProps,  renderExpirationTime: ExpirationTime) &#123;  let shouldUpdate;  if (current &#x3D;&#x3D;&#x3D; null) &#123;    &#x2F;&#x2F;  å¦‚æœè¿˜æ²¡åˆ›å»ºå®ä¾‹ï¼Œåˆå§‹åŒ–    if (workInProgress.stateNode &#x3D;&#x3D;&#x3D; null) &#123;    &#125; else &#123;      &#x2F;&#x2F;  å¦‚æœå·²ç»åˆ›å»ºå®ä¾‹ï¼Œåˆ™é‡ç”¨å®ä¾‹      &#x2F;&#x2F; In a resume, we&#39;ll already have an instance we can reuse.      shouldUpdate &#x3D; resumeMountClassInstance(        workInProgress,        Component,        nextProps,        renderExpirationTime      );    &#125;  &#125; else &#123;    &#x2F;&#x2F; æ›´æ–°ç±»å®ä¾‹    shouldUpdate &#x3D; updateClassInstance(      current,      workInProgress,      Component,      nextProps,      renderExpirationTime,    );  &#125;  return finishClassComponent(    &#x2F;&#x2F; è°ƒç”¨ç»„ä»¶å®ä¾‹çš„renderå‡½æ•°è·å–éœ€æ¸²æŸ“çš„å­å…ƒç´ ï¼Œå¹¶æŠŠå­å…ƒç´ è¿›è¡Œå¤„ç†ä¸ºFiberç±»å‹ï¼Œå¤„ç†stateå’Œpropsï¼š    current,    workInProgress,    Component,    shouldUpdate,    hasContext,    renderExpirationTime  );&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> React@16.5.0 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React@16.5.0 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React@16.5.0 unsafe_</title>
      <link href="//post/2022-07-21react-unsafe.html"/>
      <url>//post/2022-07-21react-unsafe.html</url>
      
        <content type="html"><![CDATA[<h2 id="æˆ‘æ•´ç†è¿™ç¯‡æ–‡ç« çš„ç›®çš„"><a href="#æˆ‘æ•´ç†è¿™ç¯‡æ–‡ç« çš„ç›®çš„" class="headerlink" title="æˆ‘æ•´ç†è¿™ç¯‡æ–‡ç« çš„ç›®çš„"></a>æˆ‘æ•´ç†è¿™ç¯‡æ–‡ç« çš„ç›®çš„</h2><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘åœ¨å­¦æŠ€æœ¯æ—¶å€™æ›´å¤šå…³æ³¨çš„æ˜¯<code>æ•™ç¨‹</code>å’Œ<code>æ–‡æ¡£</code>,åŸå› æœ‰ä¸‰ï¼šæ—¶é—´ç´§ã€ä»»åŠ¡é‡ã€æ–°æŠ€æœ¯å¾ˆå¤š</p><p>æœ€è¿‘æ‰‹å¤´æ— äº‹ï¼Œåˆšå¥½æœæºç æœåˆ°äº†ï¼Œå¸Œæœ›é—²æš‡ä¹‹ä½™ï¼Œä½ ä¹Ÿèƒ½äº†è§£ React å˜æ›´è¿‡ç¨‹ï¼ŒåŠ æ·± React çš„ç†è§£</p><h2 id="è¿‡æ—¶çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¾€å¾€ä¼šå¸¦æ¥ä¸å®‰å…¨çš„ç¼–ç å®è·µ"><a href="#è¿‡æ—¶çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¾€å¾€ä¼šå¸¦æ¥ä¸å®‰å…¨çš„ç¼–ç å®è·µ" class="headerlink" title="è¿‡æ—¶çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¾€å¾€ä¼šå¸¦æ¥ä¸å®‰å…¨çš„ç¼–ç å®è·µ"></a>è¿‡æ—¶çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¾€å¾€ä¼šå¸¦æ¥ä¸å®‰å…¨çš„ç¼–ç å®è·µ</h2><ul><li>componentWillMount</li><li>componentWillReceiveProps</li><li>componentWillUpdate</li></ul><p>è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ç»å¸¸è¢«<code>è¯¯è§£å’Œæ»¥ç”¨</code>ï¼›æ­¤å¤–ï¼ŒReact å›¢é˜Ÿé¢„è®¡åˆ°ï¼Œåœ¨å¼‚æ­¥æ¸²æŸ“ä¸­ï¼Œå®ƒä»¬æ½œåœ¨çš„<code>è¯¯ç”¨é—®é¢˜å¯èƒ½æ›´å¤§</code>ã€‚æ‰€ä»¥åœ¨ March 27, 2018 æå‡º</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æˆ‘ä»¬å°†åœ¨å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­ä¸ºè¿™äº›ç”Ÿå‘½å‘¨æœŸæ·»åŠ  <code>UNSAFE_</code> å‰ç¼€ã€‚ï¼ˆè¿™é‡Œçš„ â€œunsafeâ€ <code>ä¸æ˜¯æŒ‡å®‰å…¨æ€§</code>ï¼Œ<code>è€Œæ˜¯è¡¨ç¤ºä½¿ç”¨è¿™äº›ç”Ÿå‘½å‘¨æœŸçš„ä»£ç åœ¨ React çš„æœªæ¥ç‰ˆæœ¬ä¸­æ›´æœ‰å¯èƒ½å‡ºç° bug</code>ï¼Œ<code>å°¤å…¶æ˜¯åœ¨å¯ç”¨å¼‚æ­¥æ¸²æŸ“ä¹‹å</code>ã€‚ï¼‰</p></blockquote><h2 id="éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶"><a href="#éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶"></a>éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶</h2><p>React <a href="https://semver.org/lang/zh-CN/" target="_blank" >éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶</a>ï¼Œå› æ­¤è¿™ç§å˜åŒ–å°†æ˜¯é€æ­¥çš„ã€‚æˆ‘ä»¬ç›®å‰çš„è®¡åˆ’æ˜¯ï¼š</p><ul><li>16.3ï¼šä¸ºä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸå¼•å…¥åˆ«åï¼Œ<code>UNSAFE_componentWillMount``ã€UNSAFE_componentWillReceiveProps</code> å’Œ <code>UNSAFE_componentWillUpdate</code>ã€‚ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚ï¼‰<br>æœªæ¥</li><li>16.x ç‰ˆæœ¬ï¼šä¸º <code>componentWillMount``ã€componentWillReceiveProps</code> å’Œ <code>componentWillUpdate</code> å¯ç”¨åºŸå¼ƒå‘Šè­¦ã€‚ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å°†åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­å·¥ä½œï¼Œä½†æ˜¯æ—§çš„åç§°åœ¨å¼€å‘æ¨¡å¼ä¸‹ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šã€‚ï¼‰</li><li>17.0ï¼šåˆ é™¤ <code>componentWillMount</code>ã€<code>componentWillReceiveProps</code> å’Œ <code>componentWillUpdate</code>ã€‚ï¼ˆåœ¨æ­¤ç‰ˆæœ¬ä¹‹åï¼Œåªæœ‰æ–°çš„ â€œUNSAFE_â€ ç”Ÿå‘½å‘¨æœŸåç§°å¯ä»¥ä½¿ç”¨ã€‚ï¼‰</li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼Œå¦‚æœä½ æ˜¯ React åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œåˆ™æ— éœ€å¯¹è¿™äº›è¿‡æ—¶çš„æ–¹æ³•æ‰§è¡Œä»»ä½•æ“ä½œã€‚å³å°†å‘å¸ƒçš„ 16.3 ç‰ˆæœ¬çš„ä¸»è¦ç›®çš„æ˜¯ä½¿å¼€æºé¡¹ç›®ç»´æŠ¤äººå‘˜èƒ½å¤Ÿåœ¨ä»»ä½•åºŸå¼ƒè­¦å‘Šä¹‹å‰æ›´æ–°ä»–ä»¬çš„åº“ã€‚åœ¨æœªæ¥çš„ 16.x ç‰ˆæœ¬å‘å¸ƒä¹‹å‰ï¼Œä¸ä¼šå¯ç”¨è¿™äº›è­¦å‘Šã€‚</p></div><h2 id="è¿ç§»è¿‡æ—¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#è¿ç§»è¿‡æ—¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="è¿ç§»è¿‡æ—¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>è¿ç§»è¿‡æ—¶çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œä¸‹é¢æ˜¯å…³äº 16.3 ç‰ˆæœ¬è®¡åˆ’çš„ç”Ÿå‘½å‘¨æœŸå˜æ›´çš„å¿«é€Ÿæ¦‚è¿°ï¼š</p><ul><li>æ·»åŠ ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸåˆ«åï¼š<code>UNSAFE_componentWillMount</code>ã€<code>UNSAFE_componentWillReceiveProps</code> å’Œ <code>UNSAFE_componentWillUpdate</code>ã€‚ï¼ˆå°†åŒæ—¶æ”¯æŒæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°åˆ«åã€‚ï¼‰</li><li>å¼•å…¥ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸï¼Œé™æ€çš„ <code>getDerivedStateFromProps</code> å’Œ <code>getSnapshotBeforeUpdate</code>ã€‚</li></ul><h2 id="getDerivedStateFromProps"><a href="#getDerivedStateFromProps" class="headerlink" title="getDerivedStateFromProps"></a>getDerivedStateFromProps</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">class Example extends React.Component &#123;  static getDerivedStateFromProps(props, state) &#123;    &#x2F;&#x2F; ...  &#125;&#125;</code></pre><p>æ–°çš„é™æ€ <code>getDerivedStateFromProps</code> ç”Ÿå‘½å‘¨æœŸæ–¹æ³•<code>åœ¨ç»„ä»¶å®ä¾‹åŒ–ä¹‹åä»¥åŠé‡æ–°æ¸²æŸ“ä¹‹å‰è°ƒç”¨</code>ã€‚å®ƒå¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡æ¥æ›´æ–° stateï¼Œæˆ–è€…<code>è¿”å› null æ¥è¡¨ç¤ºæ–°çš„ props ä¸éœ€è¦ä»»ä½• state çš„æ›´æ–°</code>ã€‚</p><p>ä¸ <code>componentDidUpdate</code> ä¸€èµ·ï¼Œè¿™ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸæ¶µç›–è¿‡æ—¶çš„ <code>componentWillReceiveProps</code> çš„æ‰€æœ‰ç”¨ä¾‹ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼š</p><p>æ—§çš„ componentWillReceiveProps å’Œæ–°çš„ getDerivedStateFromProps æ–¹æ³•éƒ½ä¼šå¢åŠ ç»„ä»¶çš„å¤æ‚æ€§ã€‚è¿™ç»å¸¸ä¼šå¯¼è‡´ bugã€‚è€ƒè™‘ä½¿ç”¨ <a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html" target="_blank" >æ´¾ç”Ÿ state çš„ç®€å•æ›¿ä»£æ–¹æ³•</a> è®©ç»„ä»¶å¯é¢„æµ‹ä¸”å¯ç»´æŠ¤ã€‚</p></div><h2 id="getSnapshotBeforeUpdate"><a href="#getSnapshotBeforeUpdate" class="headerlink" title="getSnapshotBeforeUpdate"></a>getSnapshotBeforeUpdate</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">class Example extends React.Component &#123;  getSnapshotBeforeUpdate(prevProps, prevState) &#123;    &#x2F;&#x2F; ...  &#125;&#125;</code></pre><p>æ–°çš„ <code>getSnapshotBeforeUpdate</code> ç”Ÿå‘½å‘¨æœŸæ–¹æ³•<code>åœ¨æ›´æ–°ä¹‹å‰ï¼ˆå¦‚ï¼šæ›´æ–° DOM ä¹‹å‰ï¼‰è¢«è°ƒç”¨</code>ã€‚<strong>æ­¤ç”Ÿå‘½å‘¨æœŸçš„è¿”å›å€¼å°†ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™ componentDidUpdate</strong>ã€‚ï¼ˆé€šå¸¸ä¸éœ€è¦ï¼Œä½†åœ¨é‡æ–°æ¸²æŸ“è¿‡ç¨‹ä¸­æ‰‹åŠ¨ä¿ç•™æ»šåŠ¨ä½ç½®ç­‰æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚ï¼‰</p><p>ä¸ <code>componentDidUpdate</code> ä¸€èµ·ï¼Œè¿™ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸæ¶µç›–è¿‡æ—¶çš„ <code>componentWillUpdate</code> çš„æ‰€æœ‰ç”¨ä¾‹ã€‚</p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><h3 id="åˆå§‹åŒ–-state"><a href="#åˆå§‹åŒ–-state" class="headerlink" title="åˆå§‹åŒ– state"></a>åˆå§‹åŒ– state</h3><p>è¿™ä¸ªä¾‹å­æ˜¾ç¤ºäº†ç»„ä»¶åœ¨ componentWillMount ä¸­è°ƒç”¨ setStateï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;&#125;;  componentWillMount() &#123;    this.setState(&#123;      currentColor: this.props.defaultColor,      palette: &quot;rgb&quot;,    &#125;);  &#125;&#125;</code></pre><p>å¯¹äºè¿™ç§ç±»å‹çš„ç»„ä»¶ï¼Œæœ€ç®€å•çš„é‡æ„æ˜¯å°† state çš„åˆå§‹åŒ–ï¼Œç§»åˆ°æ„é€ å‡½æ•°æˆ–å±æ€§çš„åˆå§‹åŒ–å™¨å†…ï¼Œ</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    currentColor: this.props.defaultColor,    palette: &quot;rgb&quot;,  &#125;;&#125;</code></pre><h3 id="è·å–å¤–éƒ¨æ•°æ®"><a href="#è·å–å¤–éƒ¨æ•°æ®" class="headerlink" title="è·å–å¤–éƒ¨æ•°æ®"></a>è·å–å¤–éƒ¨æ•°æ®</h3><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ componentWillMount è·å–å¤–éƒ¨æ•°æ®çš„ç»„ä»¶çš„ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    externalData: null,  &#125;;  componentWillMount() &#123;    this._asyncRequest &#x3D; loadMyAsyncData().then((externalData) &#x3D;&gt; &#123;      this._asyncRequest &#x3D; null;      this.setState(&#123; externalData &#125;);    &#125;);  &#125;  componentWillUnmount() &#123;    if (this._asyncRequest) &#123;      this._asyncRequest.cancel();    &#125;  &#125;  render() &#123;    if (this.state.externalData &#x3D;&#x3D;&#x3D; null) &#123;      &#x2F;&#x2F; æ¸²æŸ“åŠ è½½çŠ¶æ€ ...    &#125; else &#123;      &#x2F;&#x2F; æ¸²æŸ“çœŸå® UI ...    &#125;  &#125;&#125;</code></pre><p>ä¸Šè¿°ä»£ç å¯¹äºæœåŠ¡å™¨æ¸²æŸ“ï¼ˆä¸ä½¿ç”¨å¤–éƒ¨æ•°æ®ï¼‰å’Œå³å°†æ¨å‡ºçš„å¼‚æ­¥æ¸²æŸ“æ¨¡å¼ï¼ˆå¯èƒ½å¤šæ¬¡å¯åŠ¨è¯·æ±‚ï¼‰éƒ½å­˜åœ¨é—®é¢˜ã€‚</p><p>å¤§å¤šæ•°ç”¨ä¾‹æ¨èçš„å‡çº§æ–¹å¼æ˜¯å°†æ•°æ®è·å–ç§»åˆ° componentDidMountï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    externalData: null,  &#125;;  componentDidMount() &#123;    this._asyncRequest &#x3D; loadMyAsyncData().then((externalData) &#x3D;&gt; &#123;      this._asyncRequest &#x3D; null;      this.setState(&#123; externalData &#125;);    &#125;);  &#125;  componentWillUnmount() &#123;    if (this._asyncRequest) &#123;      this._asyncRequest.cancel();    &#125;  &#125;  render() &#123;    if (this.state.externalData &#x3D;&#x3D;&#x3D; null) &#123;      &#x2F;&#x2F; æ¸²æŸ“åŠ è½½çŠ¶æ€ ...    &#125; else &#123;      &#x2F;&#x2F; æ¸²æŸ“çœŸå® UI ...    &#125;  &#125;&#125;</code></pre><h3 id="è¯¯è§£-1"><a href="#è¯¯è§£-1" class="headerlink" title="è¯¯è§£ 1"></a>è¯¯è§£ 1</h3><p>æœ‰ä¸€ä¸ªå¸¸è§çš„è¯¯è§£æ˜¯ï¼Œåœ¨ <code>componentWillMount</code> ä¸­è·å–æ•°æ®å¯ä»¥é¿å…ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸ºç©ºçš„çŠ¶æ€ã€‚å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸º React æ€»æ˜¯åœ¨ <code>componentWillMount</code> ä¹‹åç«‹å³æ‰§è¡Œ <code>render</code>ã€‚å¦‚æœåœ¨ <code>componentWillMount</code> è§¦å‘æ—¶æ•°æ®ä¸å¯ç”¨ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡ <code>render</code> ä»ç„¶ä¼šæ˜¾ç¤ºåŠ è½½çš„çŠ¶æ€ï¼Œè€Œä¸ç®¡ä½ åœ¨å“ªé‡Œåˆå§‹åŒ–è·å–æ•°æ®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå°†è·å–æ•°æ®ç§»åˆ° <code>componentDidMount</code> æ²¡æœ‰æ˜æ˜¾æ•ˆæœçš„åŸå› ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„</p><p>ä¸€äº›é«˜çº§ç”¨ä¾‹ï¼ˆå¦‚ï¼š<code>Relay</code> åº“ï¼‰å¯èƒ½å°è¯•æå‰è·å–å¼‚æ­¥æ•°æ®ã€‚è¿™é‡Œæä¾›äº†ä¸€ä¸ªå¦‚ä½•å®ç°çš„ç¤ºä¾‹ã€‚</p><p>ä»é•¿è¿œæ¥çœ‹ï¼Œåœ¨ React ç»„ä»¶ä¸­è·å–æ•°æ®çš„æ ‡å‡†æ–¹æ³•åº”è¯¥åŸºäº â€œ<code>suspense</code>â€ API åœ¨å†°å²› JSConf æå‡ºã€‚æ— è®ºæ˜¯ç®€å•çš„æ•°æ®è·å–è§£å†³æ–¹æ¡ˆï¼Œè¿˜æ˜¯åƒ <code>Apollo</code> å’Œ <code>Relay</code> è¿™æ ·çš„åº“ï¼Œéƒ½å¯ä»¥åœ¨å†…éƒ¨ä½¿ç”¨å®ƒã€‚å®ƒæ¯”ä¸Šé¢çš„ä»»ä½•ä¸€ä¸ªè§£å†³æ–¹æ¡ˆéƒ½è¦ç®€æ´ï¼Œä½†æ˜¯ä¸ä¼šåœ¨ 16.3 ç‰ˆæœ¬å‘å¸ƒä¹‹å‰å®Œæˆã€‚</p><p>å½“æ”¯æŒæœåŠ¡å™¨æ¸²æŸ“æ—¶ï¼Œéœ€è¦åŒæ­¥è·å–æ•°æ®â€”â€”<code>componentWillMount</code> ç»å¸¸ç”¨äºæ­¤ç›®çš„ï¼Œä¹Ÿå¯ä»¥ç”¨æ„é€ å‡½æ•°æ›¿ä»£ã€‚å³å°†æ¨å‡ºçš„ suspense API å°†ä½¿å¼‚æ­¥æ•°æ®è·å–å¯¹äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ¸²æŸ“éƒ½æ˜¯å®Œå…¨æœ‰å¯èƒ½çš„ã€‚</p></div><h3 id="æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆæˆ–è®¢é˜…ï¼‰"><a href="#æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆæˆ–è®¢é˜…ï¼‰" class="headerlink" title="æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆæˆ–è®¢é˜…ï¼‰"></a>æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆæˆ–è®¢é˜…ï¼‰</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œåœ¨ç»„ä»¶æŒ‚è½½æ—¶è®¢é˜…äº†å¤–éƒ¨äº‹ä»¶ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  componentWillMount() &#123;    this.setState(&#123;      subscribedValue: this.props.dataSource.value,    &#125;);    &#x2F;&#x2F; è¿™æ˜¯ä¸å®‰å…¨çš„ï¼Œå®ƒä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼    this.props.dataSource.subscribe(this.handleSubscriptionChange);  &#125;  componentWillUnmount() &#123;    this.props.dataSource.unsubscribe(this.handleSubscriptionChange);  &#125;  handleSubscriptionChange &#x3D; (dataSource) &#x3D;&gt; &#123;    this.setState(&#123;      subscribedValue: dataSource.value,    &#125;);  &#125;;&#125;</code></pre><p>é—æ†¾çš„æ˜¯ï¼Œè¿™å¯èƒ½å¯¼è‡´æœåŠ¡å™¨æ¸²æŸ“ï¼ˆæ°¸è¿œä¸ä¼šè°ƒç”¨ <code>componentWillUnmount</code>ï¼‰å’Œå¼‚æ­¥æ¸²æŸ“ï¼ˆåœ¨æ¸²æŸ“å®Œæˆä¹‹å‰å¯èƒ½è¢«ä¸­æ–­ï¼Œå¯¼è‡´ä¸è°ƒç”¨ <code>componentWillUnmount</code>ï¼‰çš„<code>å†…å­˜æ³„æ¼</code>ã€‚</p><h3 id="è¯¯è§£-2"><a href="#è¯¯è§£-2" class="headerlink" title="è¯¯è§£ 2"></a>è¯¯è§£ 2</h3><p>äººä»¬é€šå¸¸è®¤ä¸º <code>componentWillMount</code> å’Œ <code>componentWillUnmount</code> æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œä½†è¿™å¹¶ä¸èƒ½ä¿è¯ã€‚åªæœ‰è°ƒç”¨äº† <code>componentDidMount</code> ä¹‹åï¼ŒReact æ‰èƒ½ä¿è¯ç¨åè°ƒç”¨ <code>componentWillUnmount</code> è¿›è¡Œæ¸…ç†ã€‚</p><p>å› æ­¤ï¼Œæ·»åŠ ç›‘å¬å™¨&#x2F;è®¢é˜…çš„æ¨èæ–¹æ³•æ˜¯ä½¿ç”¨ <code>componentDidMount</code> ç”Ÿå‘½å‘¨æœŸï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    subscribedValue: this.props.dataSource.value,  &#125;;  componentDidMount() &#123;    &#x2F;&#x2F; äº‹ä»¶ç›‘å¬å™¨åªæœ‰åœ¨æŒ‚è½½åæ·»åŠ æ‰æ˜¯å®‰å…¨çš„ï¼Œ    &#x2F;&#x2F; å› æ­¤ï¼Œå¦‚æœæŒ‚è½½ä¸­æ–­æˆ–é”™è¯¯ï¼Œå®ƒä»¬ä¸ä¼šæ³„æ¼ã€‚    this.props.dataSource.subscribe(this.handleSubscriptionChange);    &#x2F;&#x2F; å¤–éƒ¨å€¼å¯èƒ½åœ¨æ¸²æŸ“å’ŒæŒ‚è½½æœŸé—´æ”¹å˜ï¼Œ    &#x2F;&#x2F; åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¤„ç†è¿™ç§æƒ…å†µå¾ˆé‡è¦ã€‚    if (this.state.subscribedValue !&#x3D;&#x3D; this.props.dataSource.value) &#123;      this.setState(&#123;        subscribedValue: this.props.dataSource.value,      &#125;);    &#125;  &#125;  componentWillUnmount() &#123;    this.props.dataSource.unsubscribe(this.handleSubscriptionChange);  &#125;  handleSubscriptionChange &#x3D; (dataSource) &#x3D;&gt; &#123;    this.setState(&#123;      subscribedValue: dataSource.value,    &#125;);  &#125;;&#125;</code></pre><p>æœ‰æ—¶ï¼Œæ›´æ–°è®¢é˜…æ¥å“åº”å±æ€§å˜æ›´éå¸¸é‡è¦ã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨åƒ <code>Redux</code> æˆ– <code>MobX</code> è¿™æ ·çš„åº“ï¼Œ<code>åº“çš„å®¹å™¨ç»„ä»¶åº”è¯¥ä¸ºä½ å¤„ç†äº†è¿™ä¸ªé—®é¢˜</code>ã€‚å¯¹äºåº”ç”¨ç¨‹åºä½œè€…ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå°å‹åº“ï¼Œ<code>create-subscription</code>ï¼Œæ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å°†å®ƒä¸ React 16.3 ä¸€èµ·å‘å¸ƒã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>create-subscription</code> æ¥ä¼ é€’è®¢é˜…çš„å€¼ï¼Œè€Œä¸æ˜¯åƒä¸Šé¢ç¤ºä¾‹é‚£æ ·ä¼ é€’ä¸€ä¸ªå¯è®¢é˜…çš„ dataSource propï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; createSubscription &#125; from &quot;create-subscription&quot;;const Subscription &#x3D; createSubscription(&#123;  getCurrentValue(sourceProp) &#123;    &#x2F;&#x2F; è¿”å›è®¢é˜…çš„å½“å‰å€¼ï¼ˆsourcePropï¼‰ã€‚    return sourceProp.value;  &#125;,  subscribe(sourceProp, callback) &#123;    function handleSubscriptionChange() &#123;      callback(sourceProp.value);    &#125;    &#x2F;&#x2F; è®¢é˜…ï¼ˆä¾‹å¦‚ï¼šå‘è®¢é˜…ï¼ˆsourcePropï¼‰æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ã€‚    &#x2F;&#x2F; æ¯å½“è®¢é˜…å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒç”¨å›è°ƒå‡½æ•°ï¼ˆæ–°å€¼ï¼‰ã€‚    sourceProp.subscribe(handleSubscriptionChange);    &#x2F;&#x2F; è¿”å›å–æ¶ˆè®¢é˜…æ–¹æ³•ã€‚    return function unsubscribe() &#123;      sourceProp.unsubscribe(handleSubscriptionChange);    &#125;;  &#125;,&#125;);&#x2F;&#x2F; æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ é€’è®¢é˜…çš„å€¼ï¼Œ&#x2F;&#x2F; è€Œä¸æ˜¯å°†å¯è®¢é˜…çš„æºä¼ é€’ç»™æˆ‘ä»¬çš„ ExampleComponentï¼š&lt;Subscription source&#x3D;&#123;dataSource&#125;&gt;  &#123;(value) &#x3D;&gt; &lt;ExampleComponent subscribedValue&#x3D;&#123;value&#125; &#x2F;&gt;&#125;&lt;&#x2F;Subscription&gt;;</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼š</p><p>åƒ <code>Relay/Apollo</code> è¿™æ ·çš„åº“ï¼Œå†…éƒ¨åº”è¯¥ä½¿ç”¨äº†ä¸ <code>create-subscription</code> ç›¸åŒçš„æŠ€æœ¯ï¼Œç”¨æœ€é€‚åˆä»–ä»¬åº“ä½¿ç”¨çš„æ–¹å¼æ‰‹åŠ¨ç®¡ç†è®¢é˜…ï¼ˆå‚è€ƒè¿™é‡Œï¼‰ã€‚</p></div><h3 id="åŸºäº-props-æ›´æ–°-state"><a href="#åŸºäº-props-æ›´æ–°-state" class="headerlink" title="åŸºäº props æ›´æ–° state"></a>åŸºäº props æ›´æ–° state</h3><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼š</p><p>æ—§çš„ <code>componentWillReceiveProps</code> å’Œæ–°çš„ <code>getDerivedStateFromProps</code> æ–¹æ³•éƒ½ä¼šç»™ç»„ä»¶å¢åŠ æ˜æ˜¾çš„å¤æ‚æ€§ã€‚è¿™é€šå¸¸ä¼šå¯¼è‡´ <code>bug</code>ã€‚è€ƒè™‘ æ´¾ç”Ÿ state çš„ç®€å•æ›¿ä»£æ–¹æ³• ä½¿ç»„ä»¶å¯é¢„æµ‹ä¸”å¯ç»´æŠ¤ã€‚</div><p>è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œç»„ä»¶ä½¿ç”¨è¿‡æ—¶çš„ <code>componentWillReceiveProps</code> ç”Ÿå‘½å‘¨æœŸåŸºäºæ–°çš„ <code>props</code> æ›´æ–° <code>state</code>ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    isScrollingDown: false,  &#125;;  componentWillReceiveProps(nextProps) &#123;    if (this.props.currentRow !&#x3D;&#x3D; nextProps.currentRow) &#123;      this.setState(&#123;        isScrollingDown: nextProps.currentRow &gt; this.props.currentRow,      &#125;);    &#125;  &#125;&#125;</code></pre><p>å°½ç®¡ä¸Šé¢çš„ä»£ç æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ <code>componentWillReceiveProps</code> ç”Ÿå‘½å‘¨æœŸç»å¸¸è¢«è¯¯ç”¨ï¼Œä¼šäº§ç”Ÿé—®é¢˜ã€‚å› æ­¤ï¼Œè¯¥æ–¹æ³•å°†è¢«åºŸå¼ƒã€‚</p><p>ä» 16.3 ç‰ˆæœ¬å¼€å§‹ï¼Œå½“ <code>props</code> å˜åŒ–æ—¶ï¼Œå»ºè®®ä½¿ç”¨æ–°çš„ <code>static getDerivedStateFromProps</code> ç”Ÿå‘½å‘¨æœŸæ›´æ–° <code>state</code>ã€‚åˆ›å»ºç»„ä»¶ä»¥åŠæ¯æ¬¡ç»„ä»¶ç”±äº <code>props</code> æˆ– <code>state</code> çš„æ”¹å˜è€Œé‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šè°ƒç”¨è¯¥ç”Ÿå‘½å‘¨æœŸï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  &#x2F;&#x2F; åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ– stateï¼Œ  &#x2F;&#x2F; æˆ–è€…ä½¿ç”¨å±æ€§åˆå§‹åŒ–å™¨ã€‚  state &#x3D; &#123;    isScrollingDown: false,    lastRow: null,  &#125;;  static getDerivedStateFromProps(props, state) &#123;    if (props.currentRow !&#x3D;&#x3D; state.lastRow) &#123;      return &#123;        isScrollingDown: props.currentRow &gt; state.lastRow,        lastRow: props.currentRow,      &#125;;    &#125;    &#x2F;&#x2F; è¿”å› null è¡¨ç¤ºæ— éœ€æ›´æ–° stateã€‚    return null;  &#125;&#125;</code></pre><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ° <code>props.currentRow</code> åœ¨ state ä¸­çš„é•œåƒï¼ˆ<code>state.lastRow</code>ï¼‰ã€‚è¿™ä½¿å¾— <code>getDerivedStateFromProps</code> èƒ½å¤Ÿåƒåœ¨ <code>componentWillReceiveProps</code> ä¸­ç›¸åŒçš„æ–¹å¼è®¿é—®ä¸Šä¸€ä¸ª <code>props</code> çš„å€¼ã€‚</p><p>ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸å°†ä¸Šä¸€ä¸ª <code>props</code> ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>getDerivedStateFromProps</code>ã€‚æˆ‘ä»¬åœ¨è®¾è®¡ API æ—¶è€ƒè™‘è¿‡è¿™ä¸ªæ–¹æ¡ˆï¼Œä½†æœ€ç»ˆå†³å®šä¸é‡‡ç”¨å®ƒï¼ŒåŸå› æœ‰ä¸¤ä¸ªï¼š</p><ul><li><p><code>prevProps</code> å‚æ•°åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>getDerivedStateFromProps</code>ï¼ˆå®ä¾‹åŒ–ä¹‹åï¼‰æ—¶ä¸º <code>null</code>ï¼Œéœ€è¦åœ¨æ¯æ¬¡è®¿é—® <code>prevProps</code> æ—¶æ·»åŠ  <code>if-not-null</code> æ£€æŸ¥ã€‚</p></li><li><p>åœ¨ <code>React</code> çš„æœªæ¥ç‰ˆæœ¬ä¸­ï¼Œä¸ä¼ é€’ä¸Šä¸€ä¸ª <code>props</code> ç»™è¿™ä¸ªæ–¹æ³•æ˜¯ä¸ºäº†é‡Šæ”¾å†…å­˜ã€‚ï¼ˆå¦‚æœ <code>React</code> æ— éœ€ä¼ é€’ä¸Šä¸€ä¸ª <code>props</code> ç»™ç”Ÿå‘½å‘¨æœŸï¼Œé‚£ä¹ˆå®ƒå°±æ— éœ€ä¿å­˜ä¸Šä¸€ä¸ª <code>props</code> å¯¹è±¡åœ¨å†…å­˜ä¸­ã€‚ï¼‰</p></li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><p>æ³¨æ„</p><p>å¦‚æœä½ æ­£åœ¨ç¼–å†™å…±äº«ç»„ä»¶ï¼Œ<code>react-lifecycles-compat</code> polyfill å¯ä»¥åœ¨æ—§ç‰ˆæœ¬çš„ React é‡Œé¢ä½¿ç”¨æ–°çš„ <code>getDerivedStateFromProps</code> ç”Ÿå‘½å‘¨æœŸã€‚åœ¨ä¸‹é¢äº†è§£æ›´å¤šå¦‚ä½•ä½¿ç”¨ã€‚</p></p></div><h3 id="è°ƒç”¨å¤–éƒ¨å›è°ƒ"><a href="#è°ƒç”¨å¤–éƒ¨å›è°ƒ" class="headerlink" title="è°ƒç”¨å¤–éƒ¨å›è°ƒ"></a>è°ƒç”¨å¤–éƒ¨å›è°ƒ</h3><p>è°ƒç”¨å¤–éƒ¨å›è°ƒ<br>ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶çš„ç¤ºä¾‹ï¼Œå®ƒåœ¨å†…éƒ¨ state å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨äº†å¤–éƒ¨å‡½æ•°ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  componentWillUpdate(nextProps, nextState) &#123;    if (this.state.someStatefulValue !&#x3D;&#x3D; nextState.someStatefulValue) &#123;      nextProps.onChange(nextState.someStatefulValue);    &#125;  &#125;&#125;</code></pre><h3 id="è¯¯è§£-3"><a href="#è¯¯è§£-3" class="headerlink" title="è¯¯è§£ 3"></a>è¯¯è§£ 3</h3><p>æœ‰æ—¶äººä»¬ä½¿ç”¨ <code>componentWillUpdate</code> æ˜¯å‡ºäºä¸€ç§é”™è¯¯çš„æ‹…å¿ƒï¼Œå³å½“ <code>componentDidUpdate</code> è§¦å‘æ—¶ï¼Œæ›´æ–°å…¶ä»–ç»„ä»¶çš„ <code>state</code> å·²ç»â€å¤ªæ™šâ€äº†ã€‚äº‹å®å¹¶éå¦‚æ­¤ã€‚React å¯ç¡®ä¿åœ¨ç”¨æˆ·çœ‹åˆ°æ›´æ–°çš„ UI ä¹‹å‰ï¼Œåˆ·æ–°åœ¨ <code>componentDidMount</code> å’Œ <code>componentDidUpdate</code> æœŸé—´å‘ç”Ÿçš„ä»»ä½• <code>setState</code> è°ƒç”¨ã€‚é€šå¸¸ï¼Œæœ€å¥½é¿å…è¿™æ ·çš„çº§è”æ›´æ–°ï¼Œ<em>ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›æ›´æ–°æ˜¯å¿…éœ€çš„ï¼ˆä¾‹å¦‚ï¼šå¦‚æœä½ éœ€è¦åœ¨æµ‹é‡æ¸²æŸ“çš„ DOM å…ƒç´ åï¼Œå®šä½å·¥å…·çš„æç¤ºï¼‰ã€‚</em></p><p>ä¸ç®¡æ€æ ·ï¼Œåœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ä½¿ç”¨ <code>componentWillUpdate</code> éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸º<code>å¤–éƒ¨å›è°ƒå¯èƒ½ä¼šåœ¨ä¸€æ¬¡æ›´æ–°ä¸­è¢«å¤šæ¬¡è°ƒç”¨</code>ã€‚ç›¸åï¼Œåº”è¯¥ä½¿ç”¨ <code>componentDidUpdate</code> ç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºå®ƒä¿è¯æ¯æ¬¡æ›´æ–°åªè°ƒç”¨ä¸€æ¬¡ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  componentDidUpdate(prevProps, prevState) &#123;    if (this.state.someStatefulValue !&#x3D;&#x3D; prevState.someStatefulValue) &#123;      this.props.onChange(this.state.someStatefulValue);    &#125;  &#125;&#125;</code></pre><h3 id="props-æ›´æ–°çš„å‰¯ä½œç”¨"><a href="#props-æ›´æ–°çš„å‰¯ä½œç”¨" class="headerlink" title="props æ›´æ–°çš„å‰¯ä½œç”¨"></a>props æ›´æ–°çš„å‰¯ä½œç”¨</h3><p>ç±»ä¼¼äºä¸Šé¢çš„ä¾‹å­ï¼Œæœ‰æ—¶å€™ç»„ä»¶åœ¨ <code>props</code> å‘ç”Ÿå˜åŒ–æ—¶ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  componentWillReceiveProps(nextProps) &#123;    if (this.props.isVisible !&#x3D;&#x3D; nextProps.isVisible) &#123;      logVisibleChange(nextProps.isVisible);    &#125;  &#125;&#125;</code></pre><p>ä¸ <code>componentWillUpdate</code> ç±»ä¼¼ï¼Œ<code>componentWillReceiveProps</code> å¯èƒ½åœ¨ä¸€æ¬¡æ›´æ–°ä¸­è¢«å¤šæ¬¡è°ƒç”¨ã€‚<strong>å› æ­¤ï¼Œé¿å…åœ¨æ­¤æ–¹æ³•ä¸­äº§ç”Ÿå‰¯ä½œç”¨éå¸¸é‡è¦</strong>ã€‚ç›¸åï¼Œåº”è¯¥ä½¿ç”¨ <code>componentDidUpdate</code>ï¼Œå› ä¸ºå®ƒä¿è¯æ¯æ¬¡æ›´æ–°åªè°ƒç”¨ä¸€æ¬¡ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  componentDidUpdate(prevProps, prevState) &#123;    if (this.props.isVisible !&#x3D;&#x3D; prevProps.isVisible) &#123;      logVisibleChange(this.props.isVisible);    &#125;  &#125;&#125;</code></pre><h3 id="props-æ›´æ–°æ—¶è·å–å¤–éƒ¨æ•°æ®"><a href="#props-æ›´æ–°æ—¶è·å–å¤–éƒ¨æ•°æ®" class="headerlink" title="props æ›´æ–°æ—¶è·å–å¤–éƒ¨æ•°æ®"></a>props æ›´æ–°æ—¶è·å–å¤–éƒ¨æ•°æ®</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶çš„ç¤ºä¾‹ï¼Œå®ƒæ ¹æ® props çš„å€¼è·å–å¤–éƒ¨æ•°æ®ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Beforeclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    externalData: null,  &#125;;  componentDidMount() &#123;    this._loadAsyncData(this.props.id);  &#125;  componentWillReceiveProps(nextProps) &#123;    if (nextProps.id !&#x3D;&#x3D; this.props.id) &#123;      this.setState(&#123; externalData: null &#125;);      this._loadAsyncData(nextProps.id);    &#125;  &#125;  componentWillUnmount() &#123;    if (this._asyncRequest) &#123;      this._asyncRequest.cancel();    &#125;  &#125;  render() &#123;    if (this.state.externalData &#x3D;&#x3D;&#x3D; null) &#123;      &#x2F;&#x2F; æ¸²æŸ“åŠ è½½çŠ¶æ€ ...    &#125; else &#123;      &#x2F;&#x2F; æ¸²æŸ“çœŸå® UI ...    &#125;  &#125;  _loadAsyncData(id) &#123;    this._asyncRequest &#x3D; loadMyAsyncData(id).then((externalData) &#x3D;&gt; &#123;      this._asyncRequest &#x3D; null;      this.setState(&#123; externalData &#125;);    &#125;);  &#125;&#125;</code></pre><p>æ­¤ç»„ä»¶çš„æ¨èå‡çº§è·¯å¾„æ˜¯å°†æ•°æ®æ›´æ–°ç§»åŠ¨åˆ° <code>componentDidUpdate</code>ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨æ–°çš„ <code>getDerivedStateFromProps</code> ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨æ¸²æŸ“æ–°çš„ props ä¹‹å‰æ¸…é™¤æ—§æ•°æ®ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Afterclass ExampleComponent extends React.Component &#123;  state &#x3D; &#123;    externalData: null,  &#125;;  static getDerivedStateFromProps(props, state) &#123;    &#x2F;&#x2F; ä¿å­˜ prevId åœ¨ state ä¸­ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨ props å˜åŒ–æ—¶è¿›è¡Œå¯¹æ¯”ã€‚    &#x2F;&#x2F; æ¸…é™¤ä¹‹å‰åŠ è½½çš„æ•°æ®ï¼ˆè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šæ¸²æŸ“æ—§çš„å†…å®¹ï¼‰ã€‚    if (props.id !&#x3D;&#x3D; state.prevId) &#123;      return &#123;        externalData: null,        prevId: props.id,      &#125;;    &#125;    &#x2F;&#x2F; æ— éœ€æ›´æ–° state    return null;  &#125;  componentDidMount() &#123;    this._loadAsyncData(this.props.id);  &#125;  componentDidUpdate(prevProps, prevState) &#123;    if (this.state.externalData &#x3D;&#x3D;&#x3D; null) &#123;      this._loadAsyncData(this.props.id);    &#125;  &#125;  componentWillUnmount() &#123;    if (this._asyncRequest) &#123;      this._asyncRequest.cancel();    &#125;  &#125;  render() &#123;    if (this.state.externalData &#x3D;&#x3D;&#x3D; null) &#123;      &#x2F;&#x2F; æ¸²æŸ“åŠ è½½çŠ¶æ€ ...    &#125; else &#123;      &#x2F;&#x2F; æ¸²æŸ“çœŸå® UI ...    &#125;  &#125;  _loadAsyncData(id) &#123;    this._asyncRequest &#x3D; loadMyAsyncData(id).then((externalData) &#x3D;&gt; &#123;      this._asyncRequest &#x3D; null;      this.setState(&#123; externalData &#125;);    &#125;);  &#125;&#125;</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„</p><p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨æ”¯æŒå–æ¶ˆçš„ HTTP åº“ï¼Œä¾‹å¦‚ axios é‚£ä¹ˆåœ¨å¸è½½æ—¶å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚éå¸¸ç®€å•ã€‚å¯¹äºåŸç”Ÿçš„ Promiseï¼Œ<a href="https://gist.github.com/bvaughn/982ab689a41097237f6e9860db7ca8d6" target="_blank" >ä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼æ­¤å¤„æ‰€ç¤ºçš„æ–¹æ³•</a>ã€‚</p></div><h3 id="æ›´æ–°å‰è¯»å–-DOM-å±æ€§"><a href="#æ›´æ–°å‰è¯»å–-DOM-å±æ€§" class="headerlink" title="æ›´æ–°å‰è¯»å– DOM å±æ€§"></a>æ›´æ–°å‰è¯»å– DOM å±æ€§</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶çš„ç¤ºä¾‹ï¼Œè¯¥ç»„ä»¶åœ¨æ›´æ–°ä¹‹å‰ä» DOM ä¸­è¯»å–å±æ€§ï¼Œä»¥ä¾¿åœ¨åˆ—è¡¨ä¸­ä¿æŒæ»šåŠ¨çš„ä½ç½®</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">class ScrollingList extends React.Component &#123;  listRef &#x3D; null;  previousScrollOffset &#x3D; null;  componentWillUpdate(nextProps, nextState) &#123;    &#x2F;&#x2F; æˆ‘ä»¬æ­£åœ¨å‘åˆ—è¡¨ä¸­æ·»åŠ æ–°é¡¹å—ï¼Ÿ    &#x2F;&#x2F; æ•è·æ»šåŠ¨ä½ç½®ï¼Œä»¥ä¾¿æˆ‘ä»¬ç¨åå¯ä»¥è°ƒæ•´æ»šåŠ¨ä½ç½®ã€‚    if (this.props.list.length &lt; nextProps.list.length) &#123;      this.previousScrollOffset &#x3D;        this.listRef.scrollHeight - this.listRef.scrollTop;    &#125;  &#125;  componentDidUpdate(prevProps, prevState) &#123;    &#x2F;&#x2F; å¦‚æœæˆ‘ä»¬åˆšåˆšæ·»åŠ äº†æ–°é¡¹ï¼Œå¹¶ä¸”è®¾ç½®äº† previousScrollOffsetã€‚    &#x2F;&#x2F; è°ƒæ•´æ»šåŠ¨ä½ç½®ï¼Œä»¥ä¾¿è¿™äº›æ–°é¡¹ä¸ä¼šæŠŠæ—§é¡¹æŒ¤å‡ºè§†å›¾ã€‚    if (this.previousScrollOffset !&#x3D;&#x3D; null) &#123;      this.listRef.scrollTop &#x3D;        this.listRef.scrollHeight - this.previousScrollOffset;      this.previousScrollOffset &#x3D; null;    &#125;  &#125;  render() &#123;    return &lt;div ref&#x3D;&#123;this.setListRef&#125;&gt;&#123;&#x2F;* ...å†…å®¹... *&#x2F;&#125;&lt;&#x2F;div&gt;;  &#125;  setListRef &#x3D; (ref) &#x3D;&gt; &#123;    this.listRef &#x3D; ref;  &#125;;&#125;</code></pre><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>componentWillUpdate</code> ç”¨äºè¯»å– DOM å±æ€§ã€‚ä½†æ˜¯ï¼Œå¯¹äºå¼‚æ­¥æ¸²æŸ“ï¼Œâ€œæ¸²æŸ“â€é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ <code>componentWillUpdate</code> å’Œ <code>render</code>ï¼‰å’Œâ€æäº¤â€é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ <code>componentDidUpdate</code>ï¼‰ä¹‹é—´å¯èƒ½å­˜åœ¨å»¶è¿Ÿã€‚å¦‚æœç”¨æˆ·åœ¨è¿™æ®µæ—¶é—´å†…è°ƒæ•´çª—å£å¤§å°ï¼Œé‚£ä¹ˆä» <code>componentWillUpdate</code> è¯»å–çš„ <code>scrollHeight</code> å€¼å°†è¿‡æ—¶ã€‚</p><p>è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ–°çš„â€œæäº¤â€é˜¶æ®µç”Ÿå‘½å‘¨æœŸ <code>getSnapshotBeforeUpdate</code>ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å‘ç”Ÿå˜åŒ– <em>å‰ç«‹å³</em> è¢«è°ƒç”¨ï¼ˆä¾‹å¦‚åœ¨æ›´æ–° DOM ä¹‹å‰ï¼‰ã€‚å®ƒå¯ä»¥è¿”å›ä¸€ä¸ª React çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>componentDidUpdate</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨å‘ç”Ÿå˜åŒ– <em>åç«‹å³</em> è¢«è°ƒç”¨ã€‚</p><p>è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥åƒè¿™æ ·ä¸€èµ·ä½¿ç”¨ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">class ScrollingList extends React.Component &#123;  listRef &#x3D; null;  getSnapshotBeforeUpdate(prevProps, prevState) &#123;    &#x2F;&#x2F; æˆ‘ä»¬æ­£åœ¨å‘åˆ—è¡¨ä¸­æ·»åŠ æ–°é¡¹å—ï¼Ÿ    &#x2F;&#x2F; æ•è·æ»šåŠ¨ä½ç½®ï¼Œä»¥ä¾¿æˆ‘ä»¬ç¨åå¯ä»¥è°ƒæ•´æ»šåŠ¨ä½ç½®ã€‚    if (prevProps.list.length &lt; this.props.list.length) &#123;      return this.listRef.scrollHeight - this.listRef.scrollTop;    &#125;    return null;  &#125;  componentDidUpdate(prevProps, prevState, snapshot) &#123;    &#x2F;&#x2F; å¦‚æœæˆ‘ä»¬åˆšåˆšæ·»åŠ äº†æ–°é¡¹ï¼Œå¹¶ä¸”æœ‰äº†å¿«ç…§å€¼ã€‚    &#x2F;&#x2F; è°ƒæ•´æ»šåŠ¨ä½ç½®ï¼Œä»¥ä¾¿è¿™äº›æ–°é¡¹ä¸ä¼šæŠŠæ—§é¡¹æŒ¤å‡ºè§†å›¾ã€‚    &#x2F;&#x2F; ï¼ˆæ­¤å¤„çš„å¿«ç…§æ˜¯ä» getSnapshotBeforeUpdate è¿”å›çš„å€¼ï¼‰    if (snapshot !&#x3D;&#x3D; null) &#123;      this.listRef.scrollTop &#x3D; this.listRef.scrollHeight - snapshot;    &#125;  &#125;  render() &#123;    return &lt;div ref&#x3D;&#123;this.setListRef&#125;&gt;&#123;&#x2F;* ...å†…å®¹... *&#x2F;&#125;&lt;&#x2F;div&gt;;  &#125;  setListRef &#x3D; (ref) &#x3D;&gt; &#123;    this.listRef &#x3D; ref;  &#125;;&#125;</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„</p><p>å¦‚æœä½ æ­£åœ¨ç¼–å†™å…±äº«ç»„ä»¶ï¼Œé‚£ä¹ˆ react-lifecycles-compat polyfill å¯ä»¥ä½¿æ–°çš„ getSnapshotBeforeUpdate ç”Ÿå‘½å‘¨æœŸä¸æ—§ç‰ˆæœ¬çš„ React ä¸€èµ·ä½¿ç”¨ã€‚åœ¨ä¸‹é¢äº†è§£æ›´å¤šå¦‚ä½•ä½¿ç”¨ã€‚</p></div><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¯¯è§£ã€æ»¥ç”¨ã€å¼‚æ­¥ä¸­è€ API å¤šæ¬¡è°ƒç”¨</p><ul><li><p>è¯¯è§£ <code>componentWillMount</code> ä¸­åˆå§‹åŒ– state</p><br/><br/></li><li><p>è¯¯è§£ <code>componentWillMount</code> ä¸­è·å–æ•°æ®ï¼Œåœ¨ <code>componentWillMount</code> ä¹‹åç«‹å³æ‰§è¡Œ <code>render</code>ã€‚å¦‚æœåœ¨ <code>componentWillMount</code> è§¦å‘æ—¶æ•°æ®ä¸å¯ç”¨ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡ <code>render</code> ä»ç„¶ä¼šæ˜¾ç¤ºåŠ è½½çš„çŠ¶æ€ï¼Œè€Œä¸ç®¡ä½ åœ¨å“ªé‡Œåˆå§‹åŒ–è·å–æ•°æ®</p><br/><br/></li><li><p>è¯¯è§£ <code>componentWillMount</code> ä¸­è®¢é˜…ï¼Œåœ¨æœåŠ¡ç«¯ä¸ä¼šè°ƒç”¨<code>componentWillUnMount</code>,å¯¼è‡´å†…å­˜æ³„æ¼,</p><br/><br/></li><li><p>ä½¿ç”¨ <code>componentWillUpdate</code> æ˜¯å‡ºäºä¸€ç§é”™è¯¯çš„æ‹…å¿ƒï¼Œå³å½“ <code>componentDidUpdate</code> è§¦å‘æ—¶ï¼Œæ›´æ–°å…¶ä»–ç»„ä»¶çš„ <code>state</code> å·²ç»â€å¤ªæ™šâ€äº†ã€‚äº‹å®å¹¶éå¦‚æ­¤ã€‚React å¯ç¡®ä¿åœ¨ç”¨æˆ·çœ‹åˆ°æ›´æ–°çš„ UI ä¹‹å‰ï¼Œåˆ·æ–°åœ¨ <code>componentDidMount</code> å’Œ <code>componentDidUpdate</code> æœŸé—´å‘ç”Ÿçš„ä»»ä½• <code>setState</code> è°ƒç”¨ã€‚é€šå¸¸ï¼Œæœ€å¥½é¿å…è¿™æ ·çš„çº§è”æ›´æ–°ï¼Œ<em>ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›æ›´æ–°æ˜¯å¿…éœ€çš„ï¼ˆä¾‹å¦‚ï¼šå¦‚æœä½ éœ€è¦åœ¨æµ‹é‡æ¸²æŸ“çš„ DOM å…ƒç´ åï¼Œå®šä½å·¥å…·çš„æç¤ºï¼‰ã€‚</em> <strong>å¼‚æ­¥ä¸­ï¼Œå¤šæ¬¡è°ƒç”¨</strong></p><br/><br/></li><li><p><code>componentWillReceiveProps</code> å¯èƒ½åœ¨ä¸€æ¬¡æ›´æ–°ä¸­è¢«å¤šæ¬¡è°ƒç”¨ã€‚<strong>å› æ­¤ï¼Œé¿å…åœ¨æ­¤æ–¹æ³•ä¸­äº§ç”Ÿå‰¯ä½œç”¨éå¸¸é‡è¦</strong></p></li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zh-hans.reactjs.org/blog/2018/03/27/update-on-async-rendering.html" target="_blank" >å¼‚æ­¥æ¸²æŸ“ä¹‹æ›´æ–°</a></p>]]></content>
      
      
      <categories>
          
          <category> React@16.5.0 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React@16.5.0 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React@16.5.0 createElement</title>
      <link href="//post/2022-07-21react-createElement.html"/>
      <url>//post/2022-07-21react-createElement.html</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®å¼€å‘æ—¶å€™ä¹¦å†™ä»£ç "><a href="#é¡¹ç›®å¼€å‘æ—¶å€™ä¹¦å†™ä»£ç " class="headerlink" title="é¡¹ç›®å¼€å‘æ—¶å€™ä¹¦å†™ä»£ç "></a>é¡¹ç›®å¼€å‘æ—¶å€™ä¹¦å†™ä»£ç </h2><p><strong>æŸä¸ªé¡µé¢æˆ–è€…æ˜¯ç»„ä»¶</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F;  class ReactComponent extends React.Component &#123;&#x2F;&#x2F;      render() &#123;&#x2F;&#x2F;          return &lt;p className&#x3D;&quot;class&quot;&gt;Hello React&lt;&#x2F;p&gt;;&#x2F;&#x2F;      &#125;&#x2F;&#x2F;  &#125;&#x2F;&#x2F;  ä»¥ä¸Šä»£ç ä¼šç¼–è¯‘ä¸ºï¼šclass ReactComponent extends React.Component &#123;  render() &#123;    React.createElement(&quot;p&quot;, &#123; className: &quot;class&quot; &#125;, &quot;Hello React&quot;); &#x2F;&#x2F; ä¹‹å‰çœ‹åˆ°èœœå£³ä»£ç æ˜¯è¿™ä¸ªæ ·å­ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯ç ”å‘æ‰‹å†™çš„å‘¢  &#125;&#125;&#x2F;&#x2F;  &lt;ReactComponent someProp&#x3D;&quot;prop&quot; &#x2F;&gt;React.createElement(ReactComponent, &#123; someProp: &quot;prop&quot; &#125;, null);</code></pre><p>ä»¥ä¸Šä»£ç  api åœ¨<code>packages/react/src/React.js</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const React &#x3D; &#123;  createElement: createElement, &#x2F;&#x2F; packages&#x2F;react&#x2F;src&#x2F;ReactElement.js  createElement -&gt; ReactElement  version: ReactVersion,&#125;;export default React;</code></pre><h2 id="React-æ˜¯å¦‚ä½•å°†è™šæ‹Ÿ-DOM-è½¬æ¢ä¸ºçœŸå®-DOM"><a href="#React-æ˜¯å¦‚ä½•å°†è™šæ‹Ÿ-DOM-è½¬æ¢ä¸ºçœŸå®-DOM" class="headerlink" title="React æ˜¯å¦‚ä½•å°†è™šæ‹Ÿ DOM è½¬æ¢ä¸ºçœŸå® DOM"></a>React æ˜¯å¦‚ä½•å°†è™šæ‹Ÿ DOM è½¬æ¢ä¸ºçœŸå® DOM</h2><ol><li>é¦–å…ˆæˆ‘ä»¬è¦é€šè¿‡ <code>React.createElement</code> å‡½æ•°æ¥å°†æˆ‘ä»¬å®šä¹‰å¥½çš„ç»„ä»¶è¿›è¡Œè½¬æ¢ä¸º React å…ƒç´ </li><li>å°†åˆ›å»ºå¥½çš„ <code>React</code> å…ƒç´ é€šè¿‡è°ƒç”¨ <code>ReactDom.render</code> æ¥è¿›è¡Œæ¸²æŸ“</li><li><code>ReactDom.render</code> è°ƒç”¨åå…ˆåˆ›å»ºæ ¹å¯¹è±¡ <code>root</code>ï¼Œç„¶åè°ƒç”¨ <code>root.render</code></li><li>ç„¶åç»è¿‡è‹¥å¹²å‡½æ•°è°ƒç”¨ï¼Œæ¥åˆ° <code>workLoop</code> å‡½æ•°ï¼Œå®ƒå°†éå†è™šæ‹Ÿ DOM æ ‘ï¼Œå°†ä¸‹ä¸€ä¸ªéœ€è¦å¤„ç†çš„è™šæ‹Ÿ DOM ä¼ ç»™ <code>performUnitOfWork</code>ï¼Œ<code>performUnitOfWork</code> å†å°†è™šæ‹Ÿ DOM ä¼ ç»™ <code>beginWork</code> åï¼Œ<code>beginWork</code>æ ¹æ®è™šæ‹Ÿ DOM çš„ç±»å‹ä¸åŒè¿›è¡Œç›¸åº”å¤„ç†ï¼Œå¹¶å¯¹å­èŠ‚ç‚¹è¿›è¡Œå¤„ç†ä¸º <code>Fiber</code> ç±»å‹ï¼Œä¸º <code>Fiber</code> ç±»å‹è™šæ‹Ÿ DOM , æ·»åŠ çˆ¶èŠ‚ç‚¹ã€å…„å¼ŸèŠ‚ç‚¹ç­‰ç»†èŠ‚ï¼Œä»¥æ–¹ä¾¿éå†æ ‘ã€‚</li><li><code>beginWork</code> å¤„ç†å®Œåè¿”å›éœ€è¦å¤„ç†çš„å­å…ƒç´ å†ç»§ç»­å¤„ç†ï¼Œç›´åˆ°æ²¡æœ‰å­å…ƒç´ ï¼ˆå³è¿”å› nullï¼‰ï¼Œæ­¤æ—¶ <code>performUnitOfWork</code> è°ƒç”¨ <code>completeUnitOfWork</code> å¤„ç†è¿™é¢—<code>è™šæ‹Ÿ DOM å­æ ‘</code>ï¼Œå°†å…¶è½¬<code>æ¢ä¸ºçœŸå® DOM</code>ã€‚</li><li>æœ€åæ‰€æœ‰çš„<code>è™šæ‹Ÿ DOM</code> éƒ½å°†è½¬ä¸º<code>çœŸå® DOM</code>ã€‚</li></ol><h2 id="å‡½æ•°è°ƒç”¨è¿‡ç¨‹"><a href="#å‡½æ•°è°ƒç”¨è¿‡ç¨‹" class="headerlink" title="å‡½æ•°è°ƒç”¨è¿‡ç¨‹"></a>å‡½æ•°è°ƒç”¨è¿‡ç¨‹</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">root.render(children, callback) -&gt;DOMRenderer.updateContainer(children, root, null, work._onCommit) -&gt;updateContainerAtExpirationTime(    element,    container,    parentComponent,    expirationTime,    callback,) -&gt;scheduleRootUpdate(current, element, expirationTime, callback) -&gt;scheduleWork(current, expirationTime) -&gt;requestWork(root, rootExpirationTime) -&gt;performWorkOnRoot(root, Sync, false) -&gt;renderRoot(root, false) -&gt;workLoop(isYieldy) -&gt;performUnitOfWork(nextUnitOfWork: Fiber) &#x3D;&gt; Fiber | null -&gt;beginWork(current, workInProgress, nextRenderExpirationTime)</code></pre><p><strong>ä½¿ç”¨ ReactDom æ¸²æŸ“åˆ° é¡µé¢ä¸Š</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">ReactDom.render(React.createElement(App), document.getElementById(&quot;root&quot;));</code></pre><h2 id="æˆ‘è‰¹ï¼Œæœ‰ç‚¹æ‡µï½"><a href="#æˆ‘è‰¹ï¼Œæœ‰ç‚¹æ‡µï½" class="headerlink" title="æˆ‘è‰¹ï¼Œæœ‰ç‚¹æ‡µï½"></a>æˆ‘è‰¹ï¼Œæœ‰ç‚¹æ‡µï½</h2><p>å¾…è¡¥ï¼Œå…ˆå†™ä¸ªå…¶ä»–çš„å‹å‹æƒŠ</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/weixin_34221276/article/details/88770678" target="_blank" >React æºç é˜…è¯»ï¼šè™šæ‹Ÿ DOM çš„åˆå§‹åŒ–</a></p><p><a href="https://www.cnblogs.com/JhoneLee/p/9481321.html" target="_blank" >React 16 æºç çå‡ æŠŠè§£è¯» ã€ä¸€ã€‘ ä»jsxåˆ°ä¸€ä¸ªreact è™šæ‹Ÿdomå¯¹è±¡</a></p><p><a href="https://www.cnblogs.com/JhoneLee/p/9482911.html" target="_blank" >React 16 æºç çå‡ æŠŠè§£è¯» ã€äºŒã€‘ reactç»„ä»¶çš„è§£æè¿‡ç¨‹</a></p><p><a href="https://www.cnblogs.com/JhoneLee/p/9481618.html" target="_blank" >React 16 æºç çå‡ æŠŠè§£è¯» ã€ä¸‰ ç‚¹ ä¸€ã€‘ æŠŠreactç»„ä»¶å¯¹è±¡å¼„åˆ°domä¸­å»(çŸ›å¤´æŒ‡å‘fiberï¼Œfiberä¸è§£è¯»è¿™ä¸ªè¿‡ç¨‹ä¹Ÿä¸çŸ¥é“) </a></p><p><a href="https://www.cnblogs.com/JhoneLee/p/9493776.html" target="_blank" >React 16 æºç çå‡ æŠŠè§£è¯» ã€ä¸‰ ç‚¹ äºŒã€‘ reactä¸­çš„fiberRoot</a></p>]]></content>
      
      
      <categories>
          
          <category> React@16.5.0 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React@16.5.0 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React@16.5.0 syntheticEvent</title>
      <link href="//post/2022-07-20react-syntheticEvent.html"/>
      <url>//post/2022-07-20react-syntheticEvent.html</url>
      
        <content type="html"><![CDATA[<h2 id="æœ¬æ–‡è¯´æ˜"><a href="#æœ¬æ–‡è¯´æ˜" class="headerlink" title="æœ¬æ–‡è¯´æ˜"></a>æœ¬æ–‡è¯´æ˜</h2><p>æœ¬æ–‡ä¸»è¦å†…å®¹æ˜¯ <a href="https://github.com/facebook/react/tree/v16.5.0" target="_blank" >React v16.5.0</a>, éƒ¨åˆ†å†…å®¹ä¼šæ¶‰åŠåˆ° React v17+, React v17+åˆæˆäº‹ä»¶ä¸ React16 æœ‰å¾ˆå¤§å·®å¼‚</p><h2 id="React-å’Œäº‹ä»¶ç³»ç»Ÿæ¦‚è¿°"><a href="#React-å’Œäº‹ä»¶ç³»ç»Ÿæ¦‚è¿°" class="headerlink" title="React å’Œäº‹ä»¶ç³»ç»Ÿæ¦‚è¿°"></a>React å’Œäº‹ä»¶ç³»ç»Ÿæ¦‚è¿°</h2><p><a href="https://github.com/facebook/react/blob/71c0e05ba79e2e12556980ffbab264b41fdc19cd/packages/react-dom/src/events/ReactBrowserEventEmitter.js#L52" target="_blank" >è§</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * * +------------+    . * |    DOM     |    . * +------------+    . *       |           . *       v           . * +------------+    . * | ReactEvent |    . * |  Listener  |    . * +------------+    .                         +-----------+ *       |           .               +--------+|SimpleEvent| *       |           .               |         |Plugin     | * +-----|------+    .               v         +-----------+ * |     |      |    .    +--------------+                    +------------+ * |     +-----------.---&gt;|EventPluginHub|                    |    Event   | * |            |    .    |              |     +-----------+  | Propagators| * | ReactEvent |    .    |              |     |TapEvent   |  |------------| * |  Emitter   |    .    |              |&lt;---+|Plugin     |  |other plugin| * |            |    .    |              |     +-----------+  |  utilities | * |     +-----------.---&gt;|              |                    +------------+ * |     |      |    .    +--------------+ * +-----|------+    .                ^        +-----------+ *       |           .                |        |Enter&#x2F;Leave| *       +           .                +-------+|Plugin     | * +-------------+   .                         +-----------+ * | application |   . * |-------------|   . * |             |   . * |             |   . * +-------------+   . *                   . *    React Core     .  General Purpose Event Plugin System *&#x2F;</code></pre><h2 id="ä¸ºä»€ä¹ˆ-React-éœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-React-éœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ React éœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿ"></a>ä¸ºä»€ä¹ˆ React éœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿ</h2><img src="http://t-blog-images.aijs.top/img/20220720095157.webp" style="max-width: 100%; width: 600px" /><p>è¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯ä¸ºäº†<code>æ€§èƒ½</code>å’Œ<code>å¤ç”¨</code>ä¸¤ä¸ªæ–¹é¢æ¥è€ƒè™‘ã€‚</p><h3 id="é¦–å…ˆå¯¹äºæ€§èƒ½æ¥è¯´"><a href="#é¦–å…ˆå¯¹äºæ€§èƒ½æ¥è¯´" class="headerlink" title="é¦–å…ˆå¯¹äºæ€§èƒ½æ¥è¯´"></a>é¦–å…ˆå¯¹äº<code>æ€§èƒ½</code>æ¥è¯´</h3><p>React ä½œä¸ºä¸€å¥— View å±‚é¢çš„æ¡†æ¶ï¼Œé€šè¿‡æ¸²æŸ“å¾—åˆ° vDOMï¼Œå†ç”± diff ç®—æ³•å†³å®š DOM æ ‘é‚£äº›ç»“ç‚¹éœ€è¦æ–°å¢ã€æ›¿æ¢æˆ–ä¿®æ”¹ï¼Œå‡å¦‚ç›´æ¥åœ¨ DOM ç»“ç‚¹æ’å…¥åŸç”Ÿäº‹ä»¶ç›‘å¬ï¼Œåˆ™ä¼šå¯¼è‡´é¢‘ç¹çš„è°ƒç”¨ addEventListener å’Œ removeEventListenerï¼Œé€ æˆæ€§èƒ½çš„æµªè´¹ã€‚æ‰€ä»¥ React é‡‡ç”¨äº†äº‹ä»¶ä»£ç†çš„æ–¹æ³•ï¼Œå¯¹äºå¤§éƒ¨åˆ†äº‹ä»¶ 1 è€Œè¨€éƒ½åœ¨ document ä¸Šåšç›‘å¬ï¼Œç„¶å<code>æ ¹æ®Eventä¸­çš„targetæ¥åˆ¤æ–­äº‹ä»¶è§¦å‘çš„ç»“ç‚¹</code>ã€‚</p><p>å…¶æ¬¡ React åˆæˆçš„ SyntheticEvent é‡‡ç”¨äº†<code>æ± çš„æ€æƒ³</code>ï¼Œä»è€Œè¾¾åˆ°èŠ‚çº¦å†…å­˜ï¼Œé¿å…é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯äº‹ä»¶å¯¹è±¡çš„ç›®çš„ã€‚è¿™ä¹Ÿæ˜¯<code>â€œå¦‚æœæˆ‘ä»¬éœ€è¦å¼‚æ­¥ä½¿ç”¨ä¸€ä¸ª syntheticEventï¼Œéœ€è¦æ‰§è¡Œ event.persist()æ‰èƒ½é˜²æ­¢äº‹ä»¶å¯¹è±¡è¢«é‡Šæ”¾â€</code>çš„åŸå› ã€‚</p><p>æœ€ååœ¨ React æºç ä¸­éšå¤„å¯è§ <code>batch åšæ‰¹é‡æ›´æ–°</code>ï¼ŒåŸºæœ¬ä¸Šå‡¡æ˜¯å¯ä»¥æ‰¹é‡å¤„ç†çš„äº‹æƒ…ï¼ˆæœ€æ™®éçš„ setStateï¼‰React éƒ½ä¼šå°†ä¸­é—´è¿‡ç¨‹ä¿å­˜èµ·æ¥ï¼Œç•™åˆ°æœ€åé¢ flushï¼ˆæ¸²æŸ“ï¼Œå¹¶æœ€ç»ˆæäº¤åˆ° DOM æ ‘ä¸Šï¼‰æ‰ã€‚å°±å¦‚<code>æµè§ˆå™¨å¯¹ DOM æ ‘è¿›è¡Œ Styleï¼ŒLayoutï¼ŒPaint ä¸€æ ·ï¼Œéƒ½ä¸ä¼šåœ¨æ“ä½œ ele.style.color=&#39;red&#39;;ä¹‹åé©¬ä¸Šæ‰§è¡Œï¼Œåªä¼šå°†è¿™äº›æ“ä½œæ‰“åŒ…èµ·æ¥å¹¶æœ€ç»ˆåœ¨éœ€è¦æ¸²æŸ“çš„æ—¶å€™å†åšæ¸²æŸ“,</code>ã€‚<a href="https://v.aijs.top/post/2022-07-17css" target="_blank" >é˜Ÿåˆ—æœºåˆ¶æ¥æ‰¹é‡æ›´æ–°å¸ƒå±€ (1000ms&#x2F;60 &#x3D; 16.6ms è¿›è¡Œä¸€æ¬¡æ¸²æŸ“)</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">ele.style.color &#x3D; &quot;red&quot;;ele.style.color &#x3D; &quot;blue&quot;;ele.style.color &#x3D; &quot;red&quot;;&#x2F;&#x2F; æµè§ˆå™¨åªä¼šæ¸²æŸ“ä¸€æ¬¡;</code></pre><h3 id="è€Œå¯¹äºå¤ç”¨æ¥è¯´"><a href="#è€Œå¯¹äºå¤ç”¨æ¥è¯´" class="headerlink" title="è€Œå¯¹äºå¤ç”¨æ¥è¯´"></a>è€Œå¯¹äºå¤ç”¨æ¥è¯´</h3><p>React çœ‹åˆ°åœ¨ä¸åŒçš„æµè§ˆå™¨å’Œå¹³å°ä¸Šï¼Œç”¨æˆ·ç•Œé¢ä¸Šçš„äº‹ä»¶å…¶å®éå¸¸ç›¸ä¼¼ï¼Œä¾‹å¦‚æ™®é€šçš„ clickï¼Œchange ç­‰ç­‰ã€‚React å¸Œæœ›é€šè¿‡å°è£…ä¸€å±‚äº‹ä»¶ç³»ç»Ÿï¼Œå°†ä¸åŒå¹³å°çš„åŸç”Ÿäº‹ä»¶éƒ½å°è£…æˆ <code>SyntheticEvent</code>ã€‚</p><ul><li><p>ä½¿å¾—<code>ä¸åŒå¹³å°åªéœ€è¦é€šè¿‡åŠ å…¥EventEmitterä»¥åŠå¯¹åº”çš„Rendererå°±èƒ½ä½¿ç”¨ç›¸åŒçš„ä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿ</code>ï¼ŒWEB å¹³å°ä¸ŠåŠ å…¥ <code>ReactBrowserEventEmitter</code>ï¼ŒNative ä¸ŠåŠ å…¥ <code>ReactNativeEventEmitter</code>ã€‚å¦‚ä¸‹å›¾ï¼Œå¯¹äºä¸åŒå¹³å°ï¼ŒReact åªéœ€è¦æ›¿æ¢æ‰å·¦è¾¹éƒ¨åˆ†ï¼Œè€Œå³è¾¹ EventPluginHub éƒ¨åˆ†å¯ä»¥ä¿æŒå¤ç”¨ã€‚</p></li><li><p>è€Œ<code>å¯¹äºä¸åŒçš„æµè§ˆå™¨è€Œè¨€ï¼ŒReactå¸®æˆ‘ä»¬ç»Ÿä¸€äº†äº‹ä»¶ï¼Œåšäº†æµè§ˆå™¨çš„å…¼å®¹</code>ï¼Œä¾‹å¦‚å¯¹äº transitionEnd,webkitTransitionEnd,MozTransitionEnd å’Œ oTransitionEnd, React éƒ½ä¼šé›†åˆæˆ topAnimationEndï¼Œæ‰€ä»¥æˆ‘ä»¬åªç”¨å¤„ç†è¿™ä¸€ä¸ªæ ‡å‡†çš„äº‹ä»¶å³å¯ã€‚</p></li></ul><img src="http://t-blog-images.aijs.top/img/20220720100225.webp" /><h2 id="React-çš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿ"><a href="#React-çš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿ" class="headerlink" title="React çš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿ"></a>React çš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿ</h2><h3 id="äº‹ä»¶ç»‘å®š"><a href="#äº‹ä»¶ç»‘å®š" class="headerlink" title="äº‹ä»¶ç»‘å®š"></a>äº‹ä»¶ç»‘å®š</h3><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬åœ¨ JSX ä¸­å†™çš„ onClickhandler æ˜¯æ€ä¹ˆè¢«è®°å½•åˆ° DOM ç»“ç‚¹ä¸Šï¼Œå¹¶ä¸”åœ¨ document ä¸Šåšç›‘å¬çš„ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720100423.webp" /><p>React å¯¹äºå¤§éƒ¨åˆ†äº‹ä»¶çš„ç»‘å®šéƒ½æ˜¯ä½¿ç”¨<code>trapBubbledEvent</code>å’Œ<code>trapCapturedEvent</code>è¿™ä¸¤ä¸ªå‡½æ•°æ¥æ³¨å†Œçš„ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬æ‰§è¡Œäº† render æˆ–è€… setState ä¹‹åï¼ŒReact çš„ <code>Fiber</code> è°ƒåº¦ç³»ç»Ÿï¼Œ<span style="text-decoration: underline">ä¼šåœ¨æœ€å commit åˆ° DOM æ ‘ä¹‹å‰, æ‰§è¡Œ<code>trapBubbledEvent</code>æˆ–<code>trapCapturedEvent</code>ï¼Œåœ¨<code>document</code>èŠ‚ç‚¹ä¸Šç»‘å®šå›è°ƒ</span>ï¼ˆé€šè¿‡æ‰§è¡Œ<code>addEventListener</code>åœ¨ document ç»“ç‚¹ä¸Šç»‘å®šå¯¹åº”çš„<code>dispatch</code>å‡½æ•°,ä½œä¸ºå›è°ƒè´Ÿè´£ç›‘å¬ç±»å‹ä¸º<code>topLevelType</code>çš„äº‹ä»¶ï¼‰ã€‚</p><p>è¿™é‡Œé¢çš„ <code>dispatchInteractiveEvent</code> å’Œ <code>dispatchEvent</code> ä¸¤ä¸ªå›è°ƒå‡½æ•°çš„åŒºåˆ«ä¸ºï¼ŒReact16 å¼€å§‹æ¢æ‰äº†åŸæœ¬ <code>Stack Reconciliation</code> æˆ <code>Fiber</code> å¸Œæœ›å®ç°å¼‚æ­¥æ¸²æŸ“ï¼ˆReact16 ä»æœªé»˜è®¤æ‰“å¼€ï¼Œä»éœ€ä½¿ç”¨ <code>unstable_</code>å¼€å¤´çš„ apiï¼Œæ­¤ç‰¹æ€§ä¸ä¾‹å­ 2 æœ‰å…³ï¼Œå°†åœ¨æ–‡ç« æœ€åé…å›¾è§£é‡Šï¼‰ï¼Œæ‰€ä»¥å¼‚æ­¥æ¸²æŸ“çš„æƒ…å†µä¸‹å‡å¦‚æˆ‘ç‚¹äº†ä¸¤æ¬¡æŒ‰é’®ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡æŒ‰é’®å“åº”çš„æ—¶å€™ï¼Œå¯èƒ½ç¬¬ä¸€æ¬¡æŒ‰é’®çš„ handlerA ä¸­è°ƒç”¨çš„ <code>setState</code> è¿˜æœªæœ€ç»ˆè¢« commit åˆ° DOM æ ‘ä¸Šï¼Œè¿™æ—¶éœ€è¦æŠŠç¬¬ä¸€æ¬¡æŒ‰é’®çš„ç»“æœå…ˆç»™ flush æ‰å¹¶ commit åˆ° DOM æ ‘ï¼Œæ‰èƒ½å¤Ÿä¿æŒä¸€è‡´æ€§ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ° <code>dispatchInteractiveEvent</code>ã€‚å¯ä»¥ç†è§£æˆ <code>dispatchInteractiveEvent</code> åœ¨æ‰§è¡Œå‰éƒ½ä¼šç¡®ä¿ä¹‹å‰æ‰€æœ‰æ“ä½œéƒ½å·²æœ€æ€» commit åˆ° DOM æ ‘ï¼Œå†å¼€å§‹è‡ªå·±çš„æµç¨‹ï¼Œå¹¶æœ€ç»ˆè§¦å‘ dispatchEventã€‚ä½†ç”±äº React16 ä»æ˜¯åŒæ­¥æ¸²æŸ“çš„ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ç›®å‰çš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼ŒReact17 é»˜è®¤æ‰“å¼€çš„å¼‚æ­¥æ¸²æŸ“åŠŸèƒ½ã€‚</p><p>åˆ°ç°åœ¨æˆ‘ä»¬å·²ç»åœ¨ document ç»“ç‚¹ä¸Šç›‘å¬äº†äº‹ä»¶äº†ï¼Œç°åœ¨éœ€è¦æ¥çœ‹å¦‚ä½•å°†æˆ‘ä»¬åœ¨ jsx ä¸­å†™çš„ handler å­˜èµ·æ¥å¯¹åº”åˆ°ç›¸åº”çš„ç»“ç‚¹ä¸Šã€‚</p><p>åœ¨æˆ‘ä»¬æ¯æ¬¡æ–°å»ºæˆ–è€…æ›´æ–°ç»“ç‚¹æ—¶ï¼ŒReact ä¼šè°ƒç”¨ <code>createInstance</code> æˆ–è€… <code>commitUpdate</code> è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œè€Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šæœ€ç»ˆè°ƒç”¨ <code>updateFiberProps</code> è¿™ä¸ªå‡½æ•°ï¼Œå°† props ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ onClickï¼ŒonChange ç­‰ handler ç»™å­˜åˆ° DOM ç»“ç‚¹ä¸Šã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æˆ‘ä»¬å·²ç»åœ¨ document ä¸Šç›‘å¬äº†äº‹ä»¶ï¼Œå¹¶ä¸”å°† handler å­˜åœ¨å¯¹åº” DOM ç»“ç‚¹ã€‚æ¥ä¸‹æ¥éœ€è¦çœ‹ React æ€ä¹ˆç›‘å¬å¹¶å¤„ç†æµè§ˆå™¨çš„åŸç”Ÿäº‹ä»¶ï¼Œæœ€ç»ˆè§¦å‘å¯¹åº”çš„ handler äº†ã€‚</p><h3 id="äº‹ä»¶è§¦å‘"><a href="#äº‹ä»¶è§¦å‘" class="headerlink" title="äº‹ä»¶è§¦å‘"></a>äº‹ä»¶è§¦å‘</h3><p>åŠ¨ç”»è§åŸæ–‡ <a href="https://www.lzane.com/tech/react-event-system-and-source-code/#%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91" target="_blank" >Hype åŠ¨ç”»</a></p><p>åŠ¨ç”»åº”è¯¥æ˜¯ä½¿ç”¨ <a href="https://www.hypeapp.cn/" target="_blank" >Hype å·¥å…·</a> åˆ¶ä½œçš„</p><p>ä»¥ç®€å•çš„ <code>click</code> äº‹ä»¶ä¸ºä¾‹ï¼Œé€šè¿‡äº‹ä»¶ç»‘å®šæˆ‘ä»¬å·²ç»åœ¨ <code>document</code> ä¸Šç›‘å¬äº† <code>click</code> äº‹ä»¶ï¼Œå½“æˆ‘ä»¬çœŸæ­£ç‚¹å‡»äº†è¿™ä¸ªæŒ‰é’®çš„æ—¶å€™ï¼ŒåŸç”Ÿçš„äº‹ä»¶æ˜¯å¦‚ä½•è¿›å…¥ React çš„ç®¡è¾–èŒƒå›´çš„ï¼Ÿå¦‚ä½•åˆæˆ <code>SyntheticEvent</code> ä»¥åŠå¦‚ä½•æ¨¡æ‹Ÿæ•è·å’Œå†’æ³¡çš„ï¼Ÿä»¥åŠæœ€åæˆ‘ä»¬åœ¨ jsx ä¸­å†™çš„ <code>onClickhandler</code> æ˜¯å¦‚ä½•è¢«æœ€ç»ˆè§¦å‘çš„ï¼Ÿå¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹äº‹ä»¶è§¦å‘é˜¶æ®µã€‚</p><p>å¤§æ¦‚ç”¨ä¸‹å›¾è¿™ç§æ–¹å¼æ¥è§£æä»£ç ï¼Œå·¦è¾¹æ˜¯æˆ‘ç‚¹å‡»ä¸€ä¸ªç»‘å®šäº† <code>handleClick</code> çš„æŒ‰é’®åçš„ js è°ƒç”¨æ ˆï¼Œå³è¾¹æ˜¯æ¯ä¸€æ­¥çš„ä»£ç ï¼Œå‡å·²åˆ é™¤éƒ¨åˆ†ä¸å½±å“ç†è§£çš„ä»£ç ã€‚å¸Œæœ›é€šè¿‡è¿™ç§æ–¹å¼èƒ½ä½¿å¤§å®¶æ›´æ˜“ç†è§£ React çš„äº‹ä»¶è§¦å‘æœºåˆ¶ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720101536.webp" /><p>å½“æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ˜¯ï¼Œclick äº‹ä»¶å°†ä¼šæœ€ç»ˆå†’æ³¡è‡³ documentï¼Œå¹¶è§¦å‘æˆ‘ä»¬ç›‘å¬åœ¨ document ä¸Šçš„ <code>handler dispatchEvent</code>ï¼Œæ¥ç€è§¦å‘ <code>batchedUpdates</code>ã€‚<code>batchedUpdates</code> è¿™ä¸ªæ ¼å¼çš„ä»£ç åœ¨ React çš„æºç é‡Œé¢ä¼šé¢‘ç¹çš„å‡ºç°ï¼ŒåŸºæœ¬ä¸Š React å°†æ‰€æœ‰èƒ½å¤Ÿæ‰¹é‡å¤„ç†çš„äº‹æƒ…éƒ½ä¼šå…ˆæ”¶é›†èµ·æ¥ï¼Œå†ä¸€æ¬¡æ€§å¤„ç†ã€‚</p><p>å¯ä»¥çœ‹åˆ°é»˜è®¤çš„ <code>isBatching</code> æ˜¯ false çš„ï¼Œå½“è°ƒç”¨äº†ä¸€æ¬¡ <code>batchedUpdates</code>ï¼Œ<code>isBatching</code> çš„å€¼å°†ä¼šå˜æˆ trueï¼Œæ­¤æ—¶å¦‚æœåœ¨æ¥ä¸‹æ¥çš„è°ƒç”¨ä¸­æœ‰æ‰§è¡Œ <code>batchedUpdates</code> çš„è¯ï¼Œå°±ä¼šç›´æ¥æ‰§è¡Œ <code>handleTopLevel</code>,æ­¤æ—¶çš„ <code>setState</code> ç­‰ä¸ä¼šè¢«æ›´æ–°åˆ° DOM ä¸Šã€‚ç›´åˆ°è°ƒç”¨æ ˆé‡æ–°å›åˆ°ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>batchedUpdates</code> çš„æ—¶å€™ï¼Œæ‰ä¼šå°†æ‰€æœ‰ç»“æœä¸€èµ· <code>flush</code> æ‰ï¼ˆæ›´æ–°åˆ° DOM ä¸Šï¼‰ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720101657.webp" /><p><strong>è°ƒç”¨æ ˆä¸­çš„ BatchedUpdates$1 æ˜¯ä»€ä¹ˆï¼Ÿæˆ–è€…æµè§ˆå™¨çš„ renderer å’Œ Native çš„ renderer æ˜¯å¦‚æœæŒ‚åœ¨åˆ° React çš„äº‹ä»¶ç³»ç»Ÿä¸Šçš„?</strong></p><p>å…¶å® React äº‹ä»¶ç³»ç»Ÿé‡Œé¢æä¾›äº†ä¸€ä¸ªå‡½æ•° <code>setBatchingImplementation</code>ï¼Œç”¨æ¥åŠ¨æ€æŒ‚è½½ä¸åŒå¹³å°çš„ rendererï¼Œè¿™ä¸ªä¹Ÿä½“ç°äº† React äº‹ä»¶ç³»ç»Ÿçš„å¤ç”¨ã€‚ï¼ˆå¦‚å›¾å³è¾¹æ‰€ç¤ºï¼Œåœ¨ <code>DOM Renderer</code> é‡Œé¢å’Œ <code>Native Renderer</code> é‡Œé¢åˆ†åˆ«è°ƒç”¨è¿™ä¸ªå‡½æ•°åŠ¨æ€æ³¨å…¥ç›¸åº”çš„å®ç°ï¼‰</p><p>è¿™é‡Œçš„ <code>interactiveUpdates äº¤äº’å¼æ›´æ–°æ˜¯ç”¨æˆ·äº¤äº’çš„ç»“æœ</code> å’Œ <code>batchedUpdates</code> çš„åŒºåˆ«åœ¨ä¸Šæ–‡å·²ç»è§£é‡Šè¿‡ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720102322.webp" /><p><code>handleTopLevel</code> ä¼šè°ƒç”¨ <code>runExtractedEventsInBatch()</code>ï¼Œè¿™æ˜¯ React äº‹ä»¶å¤„ç†æœ€é‡è¦çš„å‡½æ•°ã€‚å¦‚ä¸Šé¢åŠ¨ç”»æˆ‘ä»¬çœ‹åˆ°çš„ï¼Œåœ¨ EventEmitter é‡Œé¢åšçš„äº‹ï¼Œå…¶å®ä¸»è¦å°±æ˜¯è¿™ä¸ªå‡½æ•°çš„ä¸¤æ­¥ã€‚</p><ul><li>ç¬¬ä¸€æ­¥æ˜¯æ ¹æ®åŸç”Ÿäº‹ä»¶åˆæˆä¸ºåˆæˆäº‹ä»¶ï¼Œå¹¶ä¸”åœ¨ vDOM ä¸Šæ¨¡æ‹Ÿæ•è·å†’æ³¡ï¼Œæ”¶é›†æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„äº‹ä»¶å›è°ƒæ„æˆå›è°ƒæ•°ç»„ã€‚</li><li>ç¬¬äºŒæ­¥æ˜¯éå†å›è°ƒæ•°ç»„ï¼Œè§¦å‘å›è°ƒå‡½æ•°ã€‚</li></ul><img src="http://t-blog-images.aijs.top/img/20220720102726.webp" /><p>é¦–å…ˆè°ƒç”¨ <code>extractEvents</code>ï¼Œä¼ å…¥åŸç”Ÿäº‹ä»¶ eï¼ŒReact äº‹ä»¶ç³»ç»Ÿæ ¹æ®å¯èƒ½çš„äº‹ä»¶æ’ä»¶åˆæˆåˆæˆäº‹ä»¶ <code>Synthetic e</code>ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è°ƒç”¨äº† <code>EventConstructor.getPooled()</code>ï¼Œä»äº‹ä»¶æ± ä¸­å»å–ä¸€ä¸ªåˆæˆäº‹ä»¶å¯¹è±¡ï¼Œå¦‚æœäº‹ä»¶æ± ä¸ºç©ºï¼Œåˆ™æ–°åˆ›å»ºä¸€ä¸ªåˆæˆäº‹ä»¶å¯¹è±¡ï¼Œè¿™ä½“ç°äº† React ä¸ºäº†æ€§èƒ½å®ç°äº†æ± çš„æ€æƒ³ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720102846.webp" /><p>ç„¶åä¼ å…¥ <code>Propagator</code>ï¼Œåœ¨ vDOM ä¸Šæ¨¡æ‹Ÿæ•è·å’Œå†’æ³¡ï¼Œå¹¶æ”¶é›†æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„äº‹ä»¶å›è°ƒå’Œå¯¹åº”çš„ç»“ç‚¹ã€‚<code>traverseTwoPhase</code> æ¨¡æ‹Ÿäº†æ•è·å’Œå†’æ³¡çš„ä¸¤ä¸ªé˜¶æ®µï¼Œè¿™é‡Œå®ç°å¾ˆå·§å¦™ï¼Œç®€å•è€Œè¨€å°±æ˜¯<code>æ­£å‘å’Œåå‘éå†äº†ä¸€ä¸‹æ•°ç»„</code>ã€‚æ¥ç€å¯¹æ¯ä¸€ä¸ªç»“ç‚¹ï¼Œè°ƒç”¨ listenerAtPhase å–å‡ºäº‹ä»¶ç»‘å®šæ—¶æŒ‚è½½åœ¨ç»“ç‚¹ä¸Šçš„å›è°ƒå‡½æ•°ï¼ŒæŠŠå®ƒåŠ å…¥å›è°ƒæ•°ç»„ä¸­ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720103038.webp" /><p>æ¥ç€<code>executeDispatchesAndRelease</code>éå†æ‰€æœ‰åˆæˆäº‹ä»¶ã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ°å½“ä¸€ä¸ªäº‹ä»¶å¤„ç†å®Œçš„æ—¶å€™ï¼ŒReact ä¼šè°ƒç”¨ <code>event.isPersistent()</code>æ¥æŸ¥çœ‹è¿™ä¸ªåˆæˆäº‹ä»¶æ˜¯å¦éœ€è¦è¢«æŒä¹…åŒ–ï¼Œå¦‚æœä¸éœ€è¦å°±ä¼šé‡Šæ”¾è¿™ä¸ªåˆæˆäº‹ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬éœ€è¦å¼‚æ­¥è¯»å–æ“ä½œä¸€ä¸ªåˆæˆäº‹ä»¶çš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œ <code>event.persist()</code>ï¼Œä¸ç„¶ React å°±æ˜¯åœ¨è¿™é‡Œé‡Šæ”¾æ‰è¿™ä¸ªäº‹ä»¶ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720103344.webp" /><p>æœ€å<code>executeDispatchesInOrder</code>è¿™é‡Œå°±æ˜¯å›è°ƒå‡½æ•°è¢«çœŸæ­£è§¦å‘çš„æ—¶å€™äº†ï¼Œå–å‡ºå›è°ƒæ•°ç»„ <code>event._dispatchListeners</code>ï¼Œéå†è§¦å‘å›è°ƒå‡½æ•°ã€‚å¹¶é€šè¿‡ <code>event.isPropagationStopped()</code>è¿™ä¸€æ­¥æ¥æ¨¡æ‹Ÿåœæ­¢å†’æ³¡ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒReact åœ¨æ”¶é›†å›è°ƒæ•°ç»„çš„æ—¶å€™å¹¶ä¸ä¼šå»ç®¡æˆ‘ä»¬æ˜¯å¦è°ƒç”¨äº† <code>stopPropagation</code>ï¼Œè€Œæ˜¯ä¼šåœ¨è§¦å‘çš„é˜¶æ®µæ‰ä¼šå»æ£€æŸ¥æ˜¯å¦éœ€è¦åœæ­¢å†’æ³¡ã€‚</p><p>è‡³æ­¤ï¼Œä¸€ä¸ªäº‹ä»¶å›è°ƒå‡½æ•°å°±è¢«è§¦å‘äº†ï¼Œé‡Œé¢å¦‚æœæ‰§è¡Œäº† setState ç­‰å°±ä¼šç­‰åˆ°è°ƒç”¨æ ˆå¼¹å›åˆ°æœ€ä½éƒ¨çš„ interactiveUpdate ä¸­çš„è¢«æœ€ç»ˆ flush æ‰ï¼Œæ„é€  vDOMï¼Œå’Œå¥½ï¼Œå¹¶æœ€ç»ˆè¢« commit åˆ° DOM ä¸Šã€‚</p><p>è¿™å°±æ˜¯äº‹ä»¶è§¦å‘çš„æ•´ä¸ªè¿‡ç¨‹äº†ï¼Œå¯ä»¥å›å»å†çœ‹ä¸€ä¸‹ <a href="https://www.lzane.com/tech/react-event-system-and-source-code/#%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91" target="_blank" >åŠ¨ç”»</a>ï¼Œç›¸ä¿¡ä½ ä¼šæ›´åŠ ç†è§£è¿™ä¸ªè¿‡ç¨‹çš„ã€‚</p><h2 id="åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æœ‰æ€æ ·çš„æ‰§è¡Œé¡ºåºï¼Ÿ"><a href="#åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æœ‰æ€æ ·çš„æ‰§è¡Œé¡ºåºï¼Ÿ" class="headerlink" title="åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æœ‰æ€æ ·çš„æ‰§è¡Œé¡ºåºï¼Ÿ"></a>åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æœ‰æ€æ ·çš„æ‰§è¡Œé¡ºåºï¼Ÿ</h2><p><strong>åŸç”Ÿäº‹ä»¶</strong></p><img src="http://t-blog-images.aijs.top/img/20220720105851.webp" style="max-width: 100%; width: 600px" /><p><strong>åŸç”Ÿ+åˆæˆäº‹ä»¶</strong></p><ul><li><p>åœ¨ V17 ç‰ˆæœ¬å‰ï¼Œ<code>åŸç”Ÿäº‹ä»¶çš„æ‰§è¡Œæ—¶æœºæ˜¯æ’æ—©äºåˆæˆäº‹ä»¶çš„æ‰§è¡Œæ—¶æœºçš„</code>ã€‚</p></li><li><p>V17 ç‰ˆæœ¬åï¼Œ<code>åˆæˆäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶çš„æ‰§è¡Œé¡ºåºä¸å†’æ³¡/æ•è·æ¨¡å¼ç›¸å…³</code>ï¼Œ</p><ul><li><code>æ•è·æ¨¡å¼ï¼Œåˆæˆäº‹ä»¶æ—©äºåŸç”Ÿäº‹ä»¶</code>ï¼Œ</li><li><code>å†’æ³¡æ¨¡å¼ï¼ŒåŸç”Ÿäº‹ä»¶æ—©äºåˆæˆäº‹ä»¶</code>ã€‚</li></ul></li></ul><img src="http://t-blog-images.aijs.top/img/20220720105608.webp" style="max-width: 100%; width: 600px"/><a href="https://www.jianshu.com/p/a68219093f88?u_atoken=96c66af6-4b4a-4701-a859-9a64483aaf89&u_asession=01viVXNjWZraXNpt12w6P6wnowBQUY7pona1ulf4v0L73wrchou90FiDGe5jR2qHfDX0KNBwm7Lovlpxjd_P_q4JsKWYrT3W_NKPr8w6oU7K8qavJ7EhmnVdJXQEmE6OtSPpcarp92QKzyJKyYjREPlmBkFo3NEHBv0PZUm6pbxQU&u_asig=05CjAbRIhQ-YGOcSOjfs7WtQu4QiGw5txoYvhryOA5fFYlLiTzNiJXY_hpLV7WJGud4m5iROx4wQ0h3ZgRAXTxp-H_GUJK2jgttmFqvD-hHIPJWVv2NwOqKBXAP-u08vsfCUr3lwfKUBWx5D2_14AeRY0il1Ll8VBsxPq6mesMKSv9JS7q8ZD7Xtz2Ly-b0kmuyAKRFSVJkkdwVUnyHAIJzbzCM-4012j1JNGnXBVIbaIllXASt-Dgl7eSMGAtA78aWPRPQyB_SKrj-61LB_f61u3h9VXwMyh6PgyDIVSG1W8MY0PcDXuTpF4MGYSjFBSfODK7bhW2M-c7MIitG1svzaDy9TZTqvO1bRJoi-cZx4Wss1heq_Xsfq5Pn8i8a2-MmWspDxyAEEo4kbsryBKb9Q&u_aref=0RPjny1vlRI4nr3ZC63TqSOZUa0%3D#:~:text=%E5%9B%9B%E3%80%81-,React%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E4%B8%8E%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F,-%E5%9C%A8%20React%20%E4%B8%AD" target="_blank" >React åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æ‰§è¡Œé¡ºåº</a><p><a href="https://juejin.cn/post/7005129812981317668#:~:text=%E9%87%8C%E9%9D%A2%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82-,%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E5%92%8C%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F,-%E8%BF%99%E9%87%8C%E6%9C%89%E4%B8%AA" target="_blank" >åˆæˆäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶çš„æ‰§è¡Œé¡ºåº</a></p><h2 id="ä¾‹å­-1"><a href="#ä¾‹å­-1" class="headerlink" title="ä¾‹å­ 1"></a>ä¾‹å­ 1</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">class App extends React.Component &#123;  innerClick &#x3D; (e) &#x3D;&gt; &#123;    console.log(&quot;A: react inner click.&quot;);    &#x2F;&#x2F; e.stopPropagation();  &#125;;  outerClick &#x3D; () &#x3D;&gt; &#123;    console.log(&quot;B: react outer click.&quot;);  &#125;;  componentDidMount() &#123;    document      .getElementById(&quot;outer&quot;)      .addEventListener(&quot;click&quot;, () &#x3D;&gt; console.log(&quot;C: native outer click&quot;));    window.addEventListener(&quot;click&quot;, () &#x3D;&gt;      console.log(&quot;D: native window click&quot;)    );  &#125;  render() &#123;    return (      &lt;div id&#x3D;&quot;outer&quot; onClick&#x3D;&#123;this.outerClick&#125;&gt;        &lt;button id&#x3D;&quot;inner&quot; onClick&#x3D;&#123;this.innerClick&#125;&gt;          BUTTON        &lt;&#x2F;button&gt;      &lt;&#x2F;div&gt;    );  &#125;&#125;</code></pre><p>ç›¸ä¿¡çœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œå¦‚æœä½ å·²ç»å¯¹ React äº‹ä»¶ç³»ç»Ÿæœ‰æ‰€ç†è§£ï¼Œè¿™é“é¢˜åº”è¯¥æ˜¯ä¸éš¾äº†ã€‚</p><ul><li><p>å› ä¸º React äº‹ä»¶ç›‘å¬æ˜¯æŒ‚è½½åœ¨ document ä¸Šçš„ï¼Œæ‰€ä»¥åŸç”Ÿç³»ç»Ÿåœ¨#outer ä¸Šç›‘å¬çš„å›è°ƒ C ä¼šæœ€å…ˆè¢«è¾“å‡ºï¼›æ¥ç€åŸç”Ÿäº‹ä»¶å†’æ³¡è‡³ <code>document</code> è¿›å…¥ React äº‹ä»¶ç³»ç»Ÿï¼ŒReact äº‹ä»¶ç³»ç»Ÿæ¨¡æ‹Ÿæ•è·å†’æ³¡è¾“å‡º A å’Œ Bï¼›æœ€å React äº‹ä»¶ç³»ç»Ÿæ‰§è¡Œå®Œæ¯•å›åˆ°æµè§ˆå™¨ç»§ç»­å†’æ³¡åˆ° windowï¼Œè¾“å‡º Dã€‚</p></li><li><p>æµè§ˆå™¨åœ¨#outer ä¸Šç›‘å¬åŸç”Ÿäº‹ä»¶çš„å›è°ƒ C ä¼šæœ€å…ˆè¢«æ‰§è¡Œï¼›æ¥ç€åŸç”Ÿäº‹ä»¶å†’æ³¡è‡³ document è¿›å…¥ React äº‹ä»¶ç³»ç»Ÿï¼Œè¾“å‡º Aï¼Œåœ¨ React äº‹ä»¶å¤„ç†ä¸­#inner è°ƒç”¨äº† stopPropagationï¼Œäº‹ä»¶è¢«åœæ­¢å†’æ³¡ã€‚</p></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; 1. ä¸é˜»æ­¢åˆæˆäº‹ä»¶å†’æ³¡&#x2F;&#x2F;     C: native outer click&#x2F;&#x2F;     A: react inner click.&#x2F;&#x2F;     B: react outer click.&#x2F;&#x2F;     D: native window click&#x2F;&#x2F; 2. é˜»æ­¢åˆæˆäº‹ä»¶å†’æ³¡&#x2F;&#x2F;     C: native outer click&#x2F;&#x2F;     A: react inner click.</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>æ‰€ä»¥ï¼Œæœ€å¥½ä¸è¦æ··ç”¨ React äº‹ä»¶ç³»ç»Ÿå’ŒåŸç”Ÿäº‹ä»¶ç³»ç»Ÿï¼Œå¦‚æœæ··ç”¨äº†ï¼Œè¯·ä¿è¯ä½ æ¸…æ¥šçŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p></div><h2 id="ä¾‹å­-2"><a href="#ä¾‹å­-2" class="headerlink" title="ä¾‹å­ 2"></a>ä¾‹å­ 2</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">import React from &quot;react&quot;;import ReactDOM from &quot;react-dom&quot;;class App extends React.Component &#123;  constructor(props) &#123;    super(props);    this.state &#x3D; &#123;      editable: false,    &#125;;  &#125;  handleClick &#x3D; () &#x3D;&gt; &#123;    console.log(&quot;edit button click!!&quot;);    this.setState(&#123; editable: true &#125;);  &#125;;  handleSubmit &#x3D; (e) &#x3D;&gt; &#123;    console.log(&quot;submit event!!&quot;);    e.preventDefault();  &#125;;  render() &#123;    return (      &lt;form onSubmit&#x3D;&#123;this.handleSubmit&#125;&gt;        &#123;this.state.editable ? (          &lt;button type&#x3D;&quot;submit&quot;&gt;submit&lt;&#x2F;button&gt;        ) : (          &lt;button type&#x3D;&quot;button&quot; onClick&#x3D;&#123;this.handleClick&#125;&gt;            edit          &lt;&#x2F;button&gt;        )&#125;      &lt;&#x2F;form&gt;    );  &#125;&#125;const rootElement &#x3D; document.getElementById(&quot;root&quot;);ReactDOM.render(&lt;App &#x2F;&gt;, rootElement);</code></pre><p>é¦–å…ˆæˆ‘ä»¬ç‚¹å‡» edit æŒ‰é’®æµè§ˆå™¨è§¦å‘ä¸€ä¸ª click äº‹ä»¶ï¼Œå†’æ³¡è‡³ document è¿›å…¥ React äº‹ä»¶ç³»ç»Ÿï¼ŒReact æ‰§è¡Œå›è°ƒè°ƒç”¨ setStateï¼Œæ­¤æ—¶ React äº‹ä»¶ç³»ç»Ÿå¯¹äº‹ä»¶çš„å¤„ç†æ‰§è¡Œå®Œæ¯•ã€‚ç”±äºç›®å‰ React æ˜¯åŒæ­¥æ¸²æŸ“çš„ï¼Œæ‰€ä»¥æ¥ç€ React æ‰§è¡Œ <code>performSyncWork</code> å°†è¯¥ <code>button æ”¹æˆ type=&quot;submit&quot;</code>ï¼Œç”±äº<code>åŒä¸ªä½ç½®çš„ç»“ç‚¹å¹¶ä¸” tag éƒ½ä¸º button</code>ï¼Œ<code>æ‰€ä»¥ React å¤ç”¨äº†è¿™ä¸ª button ç»“ç‚¹ 2</code>ï¼Œå¹¶æ›´æ–°åˆ° DOM ä¸Šã€‚æ­¤æ—¶æµè§ˆå™¨å¯¹ click äº‹ä»¶æ‰§è¡Œç»§ç»­ï¼Œå…¶å‘ç°è¯¥ç»“ç‚¹çš„ type&#x3D;â€submitâ€ï¼Œåˆ™è§¦å‘ submit äº‹ä»¶ã€‚</p><p><strong>è§£å†³çš„åŠæ³•å°±æœ‰å¾ˆå¤šç§äº†</strong>ï¼Œç»™ button åŠ ä¸Š keyï¼›ä¸¤ä¸ªæŒ‰é’®åˆ†å¼€å†™ï¼Œä¸è¦ç”¨ä¸‰å…ƒç­‰éƒ½å¯ä»¥è§£å†³é—®é¢˜ã€‚</p><h2 id="e-stopPropagation-å¦‚ä½•é˜»æ­¢åˆæˆäº‹ä»¶å†’æ³¡ï¼Ÿ"><a href="#e-stopPropagation-å¦‚ä½•é˜»æ­¢åˆæˆäº‹ä»¶å†’æ³¡ï¼Ÿ" class="headerlink" title="e.stopPropagation() å¦‚ä½•é˜»æ­¢åˆæˆäº‹ä»¶å†’æ³¡ï¼Ÿ"></a>e.stopPropagation() å¦‚ä½•é˜»æ­¢åˆæˆäº‹ä»¶å†’æ³¡ï¼Ÿ</h2><p><code>executeDispatchesInOrder</code>è¿™é‡Œå°±æ˜¯å›è°ƒå‡½æ•°è¢«çœŸæ­£è§¦å‘çš„æ—¶å€™äº†ï¼Œå–å‡ºå›è°ƒæ•°ç»„ <code>event._dispatchListeners</code>ï¼Œéå†è§¦å‘å›è°ƒå‡½æ•°ã€‚å¹¶é€šè¿‡ <code>event.isPropagationStopped()</code>è¿™ä¸€æ­¥æ¥æ¨¡æ‹Ÿåœæ­¢å†’æ³¡ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒReact åœ¨æ”¶é›†å›è°ƒæ•°ç»„çš„æ—¶å€™å¹¶ä¸ä¼šå»ç®¡æˆ‘ä»¬æ˜¯å¦è°ƒç”¨äº† <code>stopPropagation</code>ï¼Œè€Œæ˜¯ä¼šåœ¨è§¦å‘çš„é˜¶æ®µæ‰ä¼šå»æ£€æŸ¥æ˜¯å¦éœ€è¦åœæ­¢å†’æ³¡ã€‚</p><h2 id="åŒçº§åˆ«çš„ä¸¤ä¸ªæŒ‰é’®ï¼Œä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œä¼šå‡ºé—®é¢˜ï¼Ÿ"><a href="#åŒçº§åˆ«çš„ä¸¤ä¸ªæŒ‰é’®ï¼Œä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œä¼šå‡ºé—®é¢˜ï¼Ÿ" class="headerlink" title="åŒçº§åˆ«çš„ä¸¤ä¸ªæŒ‰é’®ï¼Œä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œä¼šå‡ºé—®é¢˜ï¼Ÿ"></a>åŒçº§åˆ«çš„ä¸¤ä¸ªæŒ‰é’®ï¼Œä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œä¼šå‡ºé—®é¢˜ï¼Ÿ</h2><p>æ¸²æŸ“åæŒ‰é’®çš„äº‹ä»¶æ˜¯å¦ä¼šè§¦å‘</p><p><strong>React16 ä¾‹å­ 2 ä¸€å®šè§¦å‘ <code>submit</code>, åŸå› ï¼šåŒæ­¥æ›´æ–°</strong></p><img src="http://t-blog-images.aijs.top/img/20220720104906.webp" style="max-width: 100%; width: 600px"/><p><strong>React17+ ä¾‹å­ 2 ä¸ä¸€å®šè§¦å‘ <code>submit</code> åŸå› ï¼šå¼‚æ­¥æ›´æ–°</strong></p><img src="http://t-blog-images.aijs.top/img/20220720104951.webp" style="max-width: 100%; width: 600px"/><h2 id="React-æç¤º-event-persist-ï¼Œä¸ºä»€ä¹ˆä¼šæç¤ºï¼Ÿ"><a href="#React-æç¤º-event-persist-ï¼Œä¸ºä»€ä¹ˆä¼šæç¤ºï¼Ÿ" class="headerlink" title="React æç¤º event.persist() ï¼Œä¸ºä»€ä¹ˆä¼šæç¤ºï¼Ÿ"></a>React æç¤º event.persist() ï¼Œä¸ºä»€ä¹ˆä¼šæç¤ºï¼Ÿ</h2><p>React åœ¨<code>executeDispatchesAndRelease</code>éå†æ‰€æœ‰åˆæˆäº‹ä»¶ï¼Œä¼šè°ƒç”¨ <code>event.isPersistent()</code>æ¥æŸ¥çœ‹è¿™ä¸ªåˆæˆäº‹ä»¶æ˜¯å¦éœ€è¦è¢«æŒä¹…åŒ–ï¼Œå¦‚æœä¸éœ€è¦å°±ä¼šé‡Šæ”¾è¿™ä¸ªåˆæˆäº‹ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬éœ€è¦å¼‚æ­¥è¯»å–æ“ä½œä¸€ä¸ªåˆæˆäº‹ä»¶çš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œ <code>event.persist()</code>ï¼Œä¸ç„¶ React å°±æ˜¯åœ¨è¿™é‡Œé‡Šæ”¾æ‰è¿™ä¸ªäº‹ä»¶ã€‚</p><h2 id="setState-æœ‰æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼ŒsetState-ç›¸å¯¹äºæµè§ˆå™¨è€Œè¨€æ˜¯åŒæ­¥çš„ï¼Œå¦‚ä½•ç†è§£ï¼Ÿ"><a href="#setState-æœ‰æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼ŒsetState-ç›¸å¯¹äºæµè§ˆå™¨è€Œè¨€æ˜¯åŒæ­¥çš„ï¼Œå¦‚ä½•ç†è§£ï¼Ÿ" class="headerlink" title="setState æœ‰æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼ŒsetState ç›¸å¯¹äºæµè§ˆå™¨è€Œè¨€æ˜¯åŒæ­¥çš„ï¼Œå¦‚ä½•ç†è§£ï¼Ÿ"></a>setState æœ‰æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼ŒsetState ç›¸å¯¹äºæµè§ˆå™¨è€Œè¨€æ˜¯åŒæ­¥çš„ï¼Œå¦‚ä½•ç†è§£ï¼Ÿ</h2><p><code>setState</code> åœ¨ç”Ÿå‘½å‘¨æœŸä»¥åŠäº‹ä»¶å›è°ƒä¸­æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¼šæ”¶é›†èµ·æ¥æ‰¹é‡å¤„ç†ã€‚åœ¨å…¶å®ƒæƒ…å†µä¸‹å¦‚ <code>promise</code>ï¼Œ<code>setTimeout</code> ä¸­éƒ½æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨ä¸€æ¬¡ setState å°±ä¼š render ä¸€æ¬¡å¹¶æ›´æ–°åˆ° DOM ä¸Šé¢</p><p>ä¸”åœ¨ JS è°ƒç”¨æ ˆè¢«å¼¹ç©ºæ—¶å€™ï¼Œå¿…å®šæ˜¯å·²ç»å°†ç»“æœæ›´æ–°åˆ° DOM ä¸Šé¢äº†ï¼ˆåŒæ­¥æ¸²æŸ“ï¼‰ã€‚è¿™ä¹Ÿå°±æ˜¯ setState ç›¸å¯¹äºæµè§ˆå™¨æ˜¯åŒæ­¥çš„å«ä¹‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p><img src="http://t-blog-images.aijs.top/img/20220720104906.webp" style="max-width: 100%; width: 600px"/><p>å¼‚æ­¥æ¸²æŸ“çš„æµç¨‹å›¾å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ€è¿‘ä¸€æ¬¡æ€è€ƒè¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œå‘ç°å¦‚æœç°åœ¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„è¯ï¼Œé‚£æˆ‘ä»¬çš„ä¾‹å­äºŒå°†å˜æˆå¶ç°çš„å‘ ğŸ˜‚ï¼Œå› ä¸ºå¦‚æœ setState çš„ç»“æœè¿˜æ²¡è¢«æ›´æ–°åˆ° DOM ä¸Šï¼Œæµè§ˆå™¨å°±ä¸ä¼šè§¦å‘ submit äº‹ä»¶ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720104951.webp" style="max-width: 100%; width: 600px"/><h2 id="å¼‚æ­¥æ¸²æŸ“ä½¿ç”¨ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸä¼šæœ‰æ€æ ·çš„ç°è±¡ï¼Ÿ"><a href="#å¼‚æ­¥æ¸²æŸ“ä½¿ç”¨ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸä¼šæœ‰æ€æ ·çš„ç°è±¡ï¼Ÿ" class="headerlink" title="å¼‚æ­¥æ¸²æŸ“ä½¿ç”¨ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸä¼šæœ‰æ€æ ·çš„ç°è±¡ï¼Ÿ"></a>å¼‚æ­¥æ¸²æŸ“ä½¿ç”¨ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸä¼šæœ‰æ€æ ·çš„ç°è±¡ï¼Ÿ</h2><p>ä¾‹å­ 2 å˜æˆå¶ç°</p><h2 id="ä¹‹å‰å°†äº‹ä»¶ç›‘å¬æŒ‚è½½åˆ°-document-ä¸Šï¼Œç°åœ¨ä¸ºä½•æŒ‚è½½åˆ°-root-ä¸Šï¼Ÿ"><a href="#ä¹‹å‰å°†äº‹ä»¶ç›‘å¬æŒ‚è½½åˆ°-document-ä¸Šï¼Œç°åœ¨ä¸ºä½•æŒ‚è½½åˆ°-root-ä¸Šï¼Ÿ" class="headerlink" title="ä¹‹å‰å°†äº‹ä»¶ç›‘å¬æŒ‚è½½åˆ° document ä¸Šï¼Œç°åœ¨ä¸ºä½•æŒ‚è½½åˆ° root ä¸Šï¼Ÿ"></a>ä¹‹å‰å°†äº‹ä»¶ç›‘å¬æŒ‚è½½åˆ° document ä¸Šï¼Œç°åœ¨ä¸ºä½•æŒ‚è½½åˆ° root ä¸Šï¼Ÿ</h2><p>å½“åŒä¸ªé¡¹ç›®é‡Œï¼Œ<code>æœ‰å¤šä¸ª React æ ¹èŠ‚ç‚¹æ—¶</code>ï¼ˆä¹Ÿå¯èƒ½æ˜¯ React å¤šç‰ˆæœ¬å…±å­˜ï¼‰ï¼Œé¿å…å¯èƒ½çš„ä¸€äº›æ“ä½œï¼ˆå¦‚é˜»æ­¢å†’æ³¡ï¼‰ä¼šå½±å“åˆ°å…¶ä»– React èŠ‚ç‚¹çš„æ­£å¸¸å·¥ä½œã€‚</p><img src="http://t-blog-images.aijs.top/img/20220720110733.webp" style="max-width: 700px"  /><p><a href="https://github.com/facebook/react/releases/tag/v17.0.0" target="_blank" >Delegate events to roots instead of document</a></p><p><a href="https://www.bigbinary.com/blog/react-17-delegates-events-to-root-instead-of-document" target="_blank" >React 17 delegates events to root instead of document</a></p><p>ä¸ºäº†æ¼”ç¤ºå…¶ä¸­ä¸€ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬ä»¥ select ä¸‹æ‹‰åˆ—è¡¨ä¸ºä¾‹ã€‚</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;!--Div&#39;s change event contains stopPropagation()--&gt;&lt;div id&#x3D;&quot;main&quot;&gt;  &lt;!--Div where react component will be rendered --&gt;  &lt;div id&#x3D;&quot;react-root&quot;&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">class CountryDropDown extends React.Component &#123;  state &#x3D; &#123;    country: &#39;&#39;,  &#125;  const handleChange &#x3D; e &#x3D;&gt; &#123;    this.setState(&#123; country: e.target.value &#125;);  &#125;  render() &#123;    return (      &lt;table class&#x3D;&quot;table table-striped table-condensed&quot;&gt;        &lt;thead&gt;          &lt;tr&gt;            &lt;th&gt;Country&lt;&#x2F;th&gt;            &lt;th&gt;Selected country&lt;&#x2F;th&gt;          &lt;&#x2F;tr&gt;        &lt;&#x2F;thead&gt;        &lt;tbody&gt;          &lt;tr&gt;            &lt;td&gt;              &lt;select value&#x3D;&#123;this.state.country&#125;                onChange&#x3D;&#123;this.handleChange&#125;              &gt;                &lt;option value&#x3D;&quot;&quot;&gt;--Select--&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;India&quot;&gt;India&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;US&quot;&gt;US&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;Dubai&quot;&gt;Dubai&lt;&#x2F;option&gt;              &lt;&#x2F;select&gt;            &lt;&#x2F;td&gt;            &lt;td&gt;              &#123;this.state.country&#125;            &lt;&#x2F;td&gt;          &lt;&#x2F;tr&gt;        &lt;&#x2F;tbody&gt;      &lt;&#x2F;table&gt;    );  &#125;&#125;ReactDOM.render(&lt;CountryDropDown &#x2F;&gt;, document.getElementById(&#39;react-root&#39;));</code></pre><p>ç»™<code>main-div</code>å¢åŠ ä¸€ä¸ªé˜»æ­¢å†’æ³¡çš„äº‹ä»¶</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">document.getElementById(&quot;main&quot;).addEventListener(  &quot;change&quot;,  function (e) &#123;    e.stopPropagation();  &#125;,  false);</code></pre><p>é™„åŠ åˆ°æ–‡æ¡£èŠ‚ç‚¹çš„ onChange ä¸‹æ‹‰äº‹ä»¶å‡ºç°æ„å¤–è¡Œä¸ºï¼ŒåŸå› æ˜¯ï¼šåŒ…å« e.stopPropagationï¼ˆï¼‰çš„ä¸» div çš„ change äº‹ä»¶é˜»æ­¢äº†ä¸‹æ‹‰çš„ onChange äº‹ä»¶ã€‚</p><h2 id="åˆæˆäº‹ä»¶çš„å†’æ³¡æ•è·æœºåˆ¶å¦‚ä½•å®ç°ï¼Ÿ"><a href="#åˆæˆäº‹ä»¶çš„å†’æ³¡æ•è·æœºåˆ¶å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="åˆæˆäº‹ä»¶çš„å†’æ³¡æ•è·æœºåˆ¶å¦‚ä½•å®ç°ï¼Ÿ"></a>åˆæˆäº‹ä»¶çš„å†’æ³¡æ•è·æœºåˆ¶å¦‚ä½•å®ç°ï¼Ÿ</h2><p><code>traverseTwoPhase</code> æ¨¡æ‹Ÿäº†æ•è·å’Œå†’æ³¡çš„ä¸¤ä¸ªé˜¶æ®µï¼Œè¿™é‡Œå®ç°å¾ˆå·§å¦™ï¼Œç®€å•è€Œè¨€å°±æ˜¯<code>æ­£å‘å’Œåå‘éå†äº†ä¸€ä¸‹æ•°ç»„</code></p><h2 id="åˆæˆäº‹ä»¶æºç å‡½æ•°è°ƒç”¨å…³ç³»å›¾"><a href="#åˆæˆäº‹ä»¶æºç å‡½æ•°è°ƒç”¨å…³ç³»å›¾" class="headerlink" title="åˆæˆäº‹ä»¶æºç å‡½æ•°è°ƒç”¨å…³ç³»å›¾"></a>åˆæˆäº‹ä»¶æºç å‡½æ•°è°ƒç”¨å…³ç³»å›¾</h2><img src="http://t-blog-images.aijs.top/img/SyntheticEvent-ç¬¬ 2 é¡µ.drawio.webp" /><h2 id="v17-0-1"><a href="#v17-0-1" class="headerlink" title="v17.0.1"></a>v17.0.1</h2><p>React ä¸­äº‹ä»¶åˆ†ä¸º<code>å§”æ‰˜äº‹ä»¶ï¼ˆDelegatedEventï¼‰</code>å’Œ<code>ä¸éœ€è¦å§”æ‰˜äº‹ä»¶ï¼ˆNonDelegatedEventï¼‰</code>ï¼Œ</p><ul><li>å§”æ‰˜äº‹ä»¶åœ¨ fiberRoot åˆ›å»ºçš„æ—¶å€™ï¼Œ<code>å°±ä¼šåœ¨ root èŠ‚ç‚¹çš„ DOM å…ƒç´ ä¸Šç»‘å®šå‡ ä¹æ‰€æœ‰äº‹ä»¶çš„å¤„ç†å‡½æ•°</code>ï¼Œ</li><li>è€Œä¸éœ€è¦å§”æ‰˜äº‹ä»¶åª<code>ä¼šå°†å¤„ç†å‡½æ•°ç»‘å®šåœ¨ DOM å…ƒç´ æœ¬èº«</code>ã€‚</li></ul><p>åŒæ—¶ï¼ŒReact å°†äº‹ä»¶åˆ†ä¸º 3 ç§ç±»å‹â€”â€”discreteEvent(ç¦»æ•£äº‹ä»¶ï¼Œå¯¹åº”<code>discreteEventPairsForSimpleEventPlugin</code>)ã€userBlockingEvent(ç”¨æˆ·é˜»æ­¢äº‹ä»¶ï¼Œå¯¹åº”<code>userBlockingPairsForSimpleEventPlugin</code>)ã€continuousEvent(è¿ç»­äº‹ä»¶ï¼Œå¯¹åº”<code>continuousPairsForSimpleEventPlugin</code>)ï¼Œå®ƒä»¬æ‹¥æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œåœ¨ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°æ—¶ä¼šä½¿ç”¨ä¸åŒçš„å›è°ƒå‡½æ•°ã€‚</p><p>React äº‹ä»¶å»ºç«‹åœ¨åŸç”ŸåŸºç¡€ä¸Šï¼Œæ¨¡æ‹Ÿäº†ä¸€å¥—å†’æ³¡å’Œæ•è·çš„äº‹ä»¶æœºåˆ¶ï¼Œå½“æŸä¸€ä¸ª DOM å…ƒç´ è§¦å‘äº‹ä»¶åï¼Œä¼šå†’æ³¡åˆ° React ç»‘å®šåœ¨ root èŠ‚ç‚¹çš„å¤„ç†å‡½æ•°ï¼Œé€šè¿‡ target è·å–è§¦å‘äº‹ä»¶çš„ DOM å¯¹è±¡å’Œå¯¹åº”çš„ Fiber èŠ‚ç‚¹ï¼Œç”±è¯¥ Fiber èŠ‚ç‚¹å‘ä¸Šå±‚çˆ¶çº§éå†ï¼Œæ”¶é›†ä¸€æ¡äº‹ä»¶é˜Ÿåˆ—ï¼Œå†éå†è¯¥é˜Ÿåˆ—è§¦å‘é˜Ÿåˆ—ä¸­æ¯ä¸ª Fiber å¯¹è±¡å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ­£å‘éå†æ¨¡æ‹Ÿå†’æ³¡ï¼Œåå‘éå†æ¨¡æ‹Ÿæ•è·ï¼Œæ‰€ä»¥åˆæˆäº‹ä»¶çš„è§¦å‘æ—¶æœºæ˜¯åœ¨åŸç”Ÿäº‹ä»¶ä¹‹åçš„ã€‚</p><p>Fiber å¯¹è±¡å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ä¾æ—§æ˜¯å‚¨å­˜åœ¨ props é‡Œçš„ï¼Œæ”¶é›†åªæ˜¯ä» props é‡Œå–å‡ºæ¥ï¼Œå®ƒå¹¶æ²¡æœ‰ç»‘å®šåˆ°ä»»ä½•å…ƒç´ ä¸Šã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">createRootImpl(å§”æ‰˜äº‹ä»¶ç»‘å®š)-&gt;listenToAllSupportedEvents(ç›‘å¬æ‰€æœ‰æ”¯æŒçš„äº‹ä»¶)-&gt;listenToNativeEvent(å†’æ³¡,æ•è·)-&gt;getEventListenerSet,getListenerSetKey,addTrappedEventListenerï¼ˆå‡½æ•°ä¼šé€šè¿‡äº‹ä»¶åå–å¾—å¯¹åº”ä¼˜å…ˆçº§çš„listenerå‡½æ•°ï¼Œå†äº¤ç”±ä¸‹å±‚å‡½æ•°å¤„ç†äº‹ä»¶ç»‘å®šï¼‰-&gt;createEventListenerWrapperWithPriority(æ ¹æ®ä¼˜å…ˆçº§å–å¾—å¯¹åº”listener)-&gt;dispatchDiscreteEvent,dispatchUserBlockingUpdate,dispatchEvent(è§¦å‘äº‹ä»¶)-&gt;attemptToDispatchEvent(è§¦å‘äº‹ä»¶)-&gt;.....ç•¥.....-&gt;dispatchEventsForPlugins(å‡½æ•°é‡Œä¼šæ”¶é›†è§¦å‘äº‹ä»¶å¼€å§‹å„å±‚çº§çš„èŠ‚ç‚¹å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å®é™…ä¼ å…¥JSXä¸­çš„å‡½æ•°ï¼Œå¹¶ä¸”æ‰§è¡Œå®ƒä»¬)-&gt;extractEvents(é’ˆå¯¹ä¸åŒç±»å‹çš„äº‹ä»¶åˆ›å»ºå¯¹åº”çš„åˆæˆäº‹ä»¶ï¼Œå¹¶ä¸”å°†å„å±‚çº§èŠ‚ç‚¹çš„listeneræ”¶é›†èµ·æ¥ï¼Œç”¨æ¥æ¨¡æ‹Ÿå†’æ³¡æˆ–è€…æ•è·)-&gt;accumulateSinglePhaseListeners(å‡½æ•°é‡Œå°±æ˜¯åœ¨å‘ä¸Šå±‚éå†æ¥æ”¶é›†ä¸€ä¸ªåˆ—è¡¨åé¢ä¼šç”¨æ¥æ¨¡æ‹Ÿå†’æ³¡)-&gt;processDispatchQueue(éå†dispatchQueue,åœ¨processDispatchQueueItemsInOrderå‡½æ•°é‡Œéå†æ‰§è¡Œ)-&gt;processDispatchQueueItemsInOrder(æ ¹æ®åˆ¤æ–­æ¥æ­£å‘ã€åå‘çš„éå†æ¥æ¨¡æ‹Ÿå†’æ³¡å’Œæ•è·)-&gt;executeDispatch(ä¼šæ‰§è¡Œlistener)-&gt;</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.lzane.com/tech/react-event-system-and-source-code/" target="_blank" >åŠ¨ç”»æµ…æ REACT äº‹ä»¶ç³»ç»Ÿå’Œæºç </a></p><p><a href="https://zhuanlan.zhihu.com/p/56531645" target="_blank" >å°å‰ç«¯è¯»æºç  - React16.7.0(åˆæˆäº‹ä»¶)</a></p><p><a href="https://blog.csdn.net/weixin_34352005/article/details/85995026" target="_blank" >React16 çš„ interactiveUpdates</a></p><p><a src="https://blog.51cto.com/u_15127691/4626192" >React 17 All In One </a></p><p><a href="https://segmentfault.com/a/1190000039108951" target="_blank" >æ·±å…¥ React åˆæˆäº‹ä»¶æœºåˆ¶åŸç†</a></p><p><a href="https://juejin.cn/post/7005129812981317668" target="_blank" >React åˆæˆäº‹ä»¶è¯¦è§£</a></p><p><a href="https://www.bigbinary.com/blog/react-17-delegates-events-to-root-instead-of-document" target="_blank" >React 17 delegates events to root instead of document</a></p><p><a href="http://www.zzvips.com/article/227118.html" target="_blank" >React äº‹ä»¶æœºåˆ¶æºç è§£æ 17.0.1</a></p><p><a href="https://zhuanlan.zhihu.com/p/166625150" target="_blank" >React äº‹ä»¶ | 4. React äº‹ä»¶ç›‘å¬</a></p><p><a href="https://juejin.cn/post/6863266370411298823#heading-0" target="_blank" >Reactæºç è§£æ-äº‹ä»¶ç³»ç»Ÿ</a></p>]]></content>
      
      
      <categories>
          
          <category> React@16.5.0 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React@16.5.0 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-native æ¶æ„å˜æ›´</title>
      <link href="//post/2022-07-19rn-%E6%9E%B6%E6%9E%84%E5%8F%98%E6%9B%B4.html"/>
      <url>//post/2022-07-19rn-%E6%9E%B6%E6%9E%84%E5%8F%98%E6%9B%B4.html</url>
      
        <content type="html"><![CDATA[<h2 id="Fabric-æ¸²æŸ“å™¨"><a href="#Fabric-æ¸²æŸ“å™¨" class="headerlink" title="Fabric æ¸²æŸ“å™¨"></a>Fabric æ¸²æŸ“å™¨</h2><p><a href="https://www.react-native.cn/docs/fabric-renderer" target="_blank" >Fabric æ¸²æŸ“å™¨</a></p><p>ä¸€å¼€å§‹ç›´æ¥çœ‹ react-native å®˜ç½‘ï¼Œå¯¹äº Fabric æ¸²æŸ“å™¨çš„ä»‹ç»çœ‹çš„æˆ‘ä¸€è„¸æ‡µé€¼ï¼Œåœ¨ Google æ‰’æ‹‰ä¸‹ï¼Œå‘ç°äº† 2018 å¹´çš„ä¸€ä¸ªææ¡ˆã€‚</p><p>æˆ‘è§‰å¾—ä»è¿‡å»æ¥çœ‹æ›´ç¬¦åˆäº‹ç‰©çš„å‘å±•è§„å¾‹ã€‚ç›´æ¥æ‹¿åˆ°ç»“æœå€’ç€çœ‹ï¼Œä¸æ˜¯å¾ˆå¥½ç†è§£ã€‚</p><h3 id="è¿™ä¹ˆæœæœåˆ°çš„"><a href="#è¿™ä¹ˆæœæœåˆ°çš„" class="headerlink" title="è¿™ä¹ˆæœæœåˆ°çš„"></a>è¿™ä¹ˆæœæœåˆ°çš„</h3><img src="http://t-blog-images.aijs.top/img/20220719151559.webp" style="max-width: 100%; width: 800px" /><h3 id="2018-å¹´ææ¡ˆ"><a href="#2018-å¹´ææ¡ˆ" class="headerlink" title="2018 å¹´ææ¡ˆ"></a>2018 å¹´ææ¡ˆ</h3><p><a href="https://github.com/react-native-community/discussions-and-proposals/issues/4#:~:text=dedicated%20issue)-,TL%3BDR,-From%20%40axe%2Dfb" target="_blank" >React Native Fabric (UI-Layer Re-architecture) #4</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>In the current architecture, all UI operations (like creating native views, managing children, etc). are handled by a native module called UIManagerModule. The React Reconciller sends UI commands over the bridge, which are eventually handled by this module and delegated to UIImplementation. This in turn creates shadow nodes that represent the layout tree and are passed to Yoga to determine the relative co-ordinates based on the Flex box styles that are passed in from JS.</p><p>In the new system, the UI operations are directly exposed to JavaScript as functions using the JSI interface described above. The new UI manager can then create ComponentDescriptors and the Shadow Nodes for specific view types (like Text, View or Images), and then communicate with Java&#x2F;ObjC to draw platform specific UI.</p></blockquote><p>å¤§æ¦‚æ„æ€æ˜¯ï¼šå›åˆ° 2018 å¹´ 7 æœˆ 31 æ—¥ å¹´ï¼Œå½“æ—¶çš„ fabricï¼Œåœ¨ react-native-community ä¸­è¿˜åªæ˜¯ä¸ªè®¨è®ºå’Œææ¡ˆï¼Œ</p><p><strong>ç«™åœ¨ 2018 å¹´ 7 æœˆ 31 æ—¥è¿™ä¸ªæ—¶é—´ç‚¹,çœ‹å¾…è¿™ä¸ªææ¡ˆï¼š</strong></p><p>åœ¨å½“å‰æ¶æ„ä¸­ï¼Œæ‰€æœ‰çš„ UI æ“ä½œï¼ˆåƒåˆ›å»ºåŸç”Ÿè§†å›¾ï¼Œç®¡ç†å­ç»„ä»¶ï¼‰ï¼Œè¢«ä¸€ä¸ªå«ä½œ<code>UIManagerModule</code>åŸç”Ÿæ¨¡å—æ‰€å¤„ç†ï¼ŒReact åè°ƒå™¨é€šè¿‡ç½‘æ¡¥å‘é€ UI å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤æœ€ç»ˆç”±è¯¥æ¨¡å—å¤„ç†å¹¶å§”æ‰˜ç»™ UIImplementationã€‚è¿™åè¿‡æ¥ä¼šåˆ›å»ºè¡¨ç¤ºå¸ƒå±€æ ‘çš„é˜´å½±èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ Yogaï¼Œä»¥æ ¹æ®ä» JS ä¼ é€’çš„ Flex box æ ·å¼ç¡®å®šç›¸å¯¹åæ ‡ã€‚</p><p>åœ¨æ–°ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ç•Œé¢æ“ä½œä½œä¸ºå‡½æ•°ä½¿ç”¨ä¸Šè¿° JSI æ¥å£ç›´æ¥æš´éœ²ç»™ JavaScriptã€‚ç„¶åï¼Œæ–°çš„ UI ç®¡ç†å™¨å¯ä»¥ä¸ºç‰¹å®šçš„è§†å›¾ç±»å‹ï¼ˆå¦‚æ–‡æœ¬ã€è§†å›¾æˆ–å›¾åƒï¼‰åˆ›å»ºç»„ä»¶æè¿°ç¬¦å’Œé˜´å½±èŠ‚ç‚¹ï¼Œç„¶åä¸ Java&#x2F;ObjC é€šä¿¡ä»¥ç»˜åˆ¶ç‰¹å®šäºå¹³å°çš„ UI</p><h3 id="å¦‚ä»Šçš„æ–‡æ¡£"><a href="#å¦‚ä»Šçš„æ–‡æ¡£" class="headerlink" title="å¦‚ä»Šçš„æ–‡æ¡£"></a>å¦‚ä»Šçš„æ–‡æ¡£</h3><h3 id="æœ¯è¯­è¡¨"><a href="#æœ¯è¯­è¡¨" class="headerlink" title="æœ¯è¯­è¡¨"></a>æœ¯è¯­è¡¨</h3><p><a href="https://www.react-native.cn/architecture/glossary" target="_blank" >æœ¯è¯­è¡¨</a></p><p><strong>å®¿ä¸»å¹³å°ï¼ˆHost platformï¼‰</strong></p><p>React Native åµŒå…¥çš„å¹³å°ï¼Œæ¯”å¦‚ Androidã€iOSã€Windowsã€macOSã€‚</p><p><strong>å®¿ä¸»è§†å›¾æ ‘ï¼ˆHost View Treeï¼‰</strong></p><ul><li><p><code>å®¿ä¸»è§†å›¾æ ‘</code>å°±æ˜¯ä¸€ç³»åˆ—çš„å®¿ä¸»è§†å›¾ã€‚å®¿ä¸»å¹³å°æœ‰ Android å¹³å°ã€iOS å¹³å°ç­‰ç­‰ã€‚åœ¨ Android ä¸Šï¼Œ</p></li><li><p><code>å®¿ä¸»è§†å›¾</code>å°±æ˜¯ android.view.ViewGroup å®ä¾‹ã€ android.widget.TextView å®ä¾‹ç­‰ç­‰ã€‚</p></li><li><p>å®¿ä¸»è§†å›¾å°±åƒç§¯æœ¨ä¸€æ ·åœ°æ„æˆäº†å®¿ä¸»è§†å›¾æ ‘ã€‚</p></li><li><p><code>æ¯ä¸ªå®¿ä¸»è§†å›¾çš„å¤§å°å’Œåæ ‡ä½ç½®</code>åŸºäºçš„æ˜¯ LayoutMetricsï¼Œè€Œ LayoutMetrics æ˜¯é€šè¿‡å¸ƒå±€å¼•æ“ Yoga è®¡ç®—å‡ºæ¥çš„ã€‚</p></li><li><p><code>å®¿ä¸»è§†å›¾çš„æ ·å¼å’Œå†…å®¹ä¿¡æ¯</code>ï¼Œæ˜¯ä» React å½±å­æ ‘ä¸­å¾—åˆ°çš„ã€‚</p></li></ul><p><strong>JavaScript Interfaces (JSI)</strong><br>ä¸€ä¸ªè½»é‡çº§çš„ APIï¼Œç»™åœ¨ C++ åº”ç”¨ä¸­åµŒå…¥çš„ JavaScript å¼•æ“ç”¨çš„ã€‚Fabric ä½¿ç”¨å®ƒåœ¨ Fabric çš„ C++ æ ¸å¿ƒå’Œ React ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</p><p><strong>Java Native Interface (JNI)</strong><br>Java Native Interface (JNI)ï¼šä¸€ä¸ªç”¨äºåœ¨ Java ä¸­å†™ åŸç”Ÿ(è¯‘æ³¨ï¼šæŒ‡è°ƒç”¨ C++) æ–¹æ³•çš„ APIã€‚ä½œç”¨æ˜¯å®ç° Fabric çš„ C++ æ ¸å¿ƒå’Œ Android çš„é€šä¿¡ã€‚</p><p><code>æ€ä¹ˆæ²¡æœ‰æIOSçš„ObjC ? ObjCå¯ä»¥ç›´æ¥è°ƒç”¨C++ ?</code></p><p><strong>React ç»„ä»¶ï¼ˆReact Componentï¼‰</strong><br>React ç»„ä»¶å°±æ˜¯ JavaScript å‡½æ•°æˆ–è€…ç±»ï¼Œæè¿°å¦‚ä½•åˆ›å»º React å…ƒç´ ã€‚è¿™ç¯‡åšæ–‡ä¸­æœ‰æ›´å¤šä»‹ç»ã€‚</p><p><strong>React å¤åˆç»„ä»¶ï¼ˆReact Composite Componentsï¼‰</strong><br>React ç»„ä»¶çš„ render æ–¹æ³•ä¸­ï¼ŒåŒ…æ‹¬å…¶ä»– React å¤åˆç»„ä»¶å’Œ React å®¿ä¸»ç»„ä»¶ã€‚</p><p><strong>React å®¿ä¸»ç»„ä»¶ï¼ˆReact Host Components or Host Componentsï¼‰</strong><br>React ç»„ä»¶çš„è§†å›¾æ˜¯é€šè¿‡å®¿ä¸»è§†å›¾ï¼Œæ¯”å¦‚ <View>ã€<Text>ï¼Œå®ç°çš„ã€‚åœ¨ Web ä¸­ï¼ŒReactDOM çš„å®¿ä¸»ç»„ä»¶å°±æ˜¯ <p>æ ‡ç­¾ã€<div>æ ‡ç­¾ä»£è¡¨çš„ç»„ä»¶ã€‚</p><p><strong>React å…ƒç´ æ ‘ï¼ˆReact Element Treesï¼‰</strong><br>React å…ƒç´ æ ‘æ˜¯é€šè¿‡ JavaScript ä¸­çš„ React åˆ›å»ºçš„ï¼Œè¯¥æ ‘ç”±ä¸€ç³»ç±» React å…ƒç´ ç»„æˆã€‚ä¸€ä¸ª React å…ƒç´ å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ï¼Œå®ƒæè¿°äº†åº”è¯¥åœ¨å±å¹•ä¸­å±•ç¤ºä»€ä¹ˆã€‚ä¸€ä¸ªå…ƒç´ åŒ…æ‹¬å±æ€§ propsã€æ ·å¼ stylesã€å­å…ƒç´  childrenã€‚React å…ƒç´ åˆ†ä¸ºä¸¤ç±»ï¼šReact å¤åˆç»„ä»¶å®ä¾‹ï¼ˆReact Composite Componentsï¼‰å’Œ React å®¿ä¸»ç»„ä»¶ï¼ˆReact Host Componentsï¼‰å®ä¾‹ï¼Œå¹¶ä¸”å®ƒåªå­˜åœ¨äº JavaScript ä¸­ã€‚</p><p><strong>React å½±å­æ ‘ï¼ˆReact Shadow Tree and React Shadow Node)</strong><br>React å½±å­æ ‘æ˜¯é€šè¿‡ Fabric æ¸²æŸ“å™¨åˆ›å»ºçš„ï¼Œæ ‘ç”±ä¸€ç³»åˆ— React å½±å­èŠ‚ç‚¹ç»„æˆã€‚ä¸€ä¸ª React å½±å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨ä¸€ä¸ªå·²ç»æŒ‚è½½çš„ React å®¿ä¸»ç»„ä»¶ï¼Œå…¶åŒ…å«çš„å±æ€§ props æ¥è‡ª JavaScriptã€‚å®ƒä¹ŸåŒ…æ‹¬å¸ƒå±€ä¿¡æ¯ï¼Œæ¯”å¦‚åæ ‡ç³» xã€yï¼Œå®½é«˜ widthã€heightã€‚åœ¨æ–°æ¸²æŸ“å™¨ Fabric ä¸­ï¼ŒReact å½±å­èŠ‚ç‚¹å¯¹è±¡åªå­˜åœ¨äº C++ ä¸­ã€‚è€Œåœ¨è€æ¶æ„ä¸­ï¼Œå®ƒå­˜åœ¨äºæ‰‹æœºè¿è¡Œæ—¶çš„å †æ ˆä¸­ï¼Œæ¯”å¦‚ Android çš„ JVMã€‚</p><p><code>Fabric æ¸²æŸ“å™¨ï¼ˆFabric Rendererï¼‰</code>ï¼šReact Native æ‰§è¡Œçš„ React æ¡†æ¶ä»£ç ï¼Œå’Œ React åœ¨ Web ä¸­æ‰§è¡Œä»£ç æ˜¯åŒä¸€ä»½ã€‚ä½†æ˜¯ï¼ŒReact Native æ¸²æŸ“çš„æ˜¯é€šç”¨å¹³å°è§†å›¾ï¼ˆå®¿ä¸»è§†å›¾ï¼‰è€Œä¸æ˜¯ DOM èŠ‚ç‚¹ï¼ˆå¯ä»¥è®¤ä¸º DOM æ˜¯ Web çš„å®¿ä¸»è§†å›¾ï¼‰ã€‚</p><p>Fabric æ¸²æŸ“å™¨ä½¿å¾—æ¸²æŸ“å®¿ä¸»è§†å›¾å˜å¾—å¯è¡Œã€‚<br>Fabric è®© React ä¸å„ä¸ªå¹³å°ç›´æ¥é€šä¿¡å¹¶ç®¡ç†å…¶å®¿ä¸»è§†å›¾å®ä¾‹ã€‚<br>Fabric æ¸²æŸ“å™¨å­˜åœ¨äº JavaScript ä¸­ï¼Œå¹¶ä¸”å®ƒè°ƒç”¨çš„æ˜¯ç”± C++ ä»£ç æš´éœ²çš„æ¥å£ã€‚<a href="https://www.react-native.cn/architecture/fabric-renderer" target="_blank" >åœ¨è¿™ç¯‡æ–‡ç« ä¸­æœ‰æ›´å¤šå…³äº React æ¸²æŸ“å™¨çš„ä¿¡æ¯ã€‚</a></p><h3 id="React-æºç ç›®å½•"><a href="#React-æºç ç›®å½•" class="headerlink" title="React æºç ç›®å½•"></a>React æºç ç›®å½•</h3><p>Renderer ç›¸å…³çš„æ–‡ä»¶å¤¹<br>å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶å¤¹ä¸ºå¯¹åº”çš„ Renderer</p><ul><li>react-art</li><li>react-dom # æ³¨æ„è¿™åŒæ—¶æ˜¯ DOM å’Œ SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰çš„å…¥å£</li><li>react-native-renderer</li><li>react-noop-renderer # ç”¨äº debug fiberï¼ˆåé¢ä¼šä»‹ç» fiberï¼‰</li><li>react-test-renderer</li></ul><p>react-dom ä¸ react-native-renderer å±äºåŒä¸€çº§åˆ«,<code>Fabric</code> å–ä»£äº† <code>react-native-renderer</code>, å¯ä»¥ç†è§£ä¸º<code>Fabric</code>æ˜¯ <code>react-dom</code>çº§åˆ«çš„æ¸²æŸ“å™¨</p><p><a href="https://github.com/facebook/react-native/blob/089c9a5c9c9a60b6bbff6dda0c9eefa9d501a092/Libraries/ReactNative/renderApplication.js#L72" target="_blank" >æºç </a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Libaries&#x2F;ReactNative&#x2F;renderApplication.jsif (fabric) &#123;  require(&quot;..&#x2F;Renderer&#x2F;shims&#x2F;ReactFabric&quot;).render(    renderable,    rootTag,    null,    useConcurrentRoot  );&#125; else &#123;  require(&quot;..&#x2F;Renderer&#x2F;shims&#x2F;ReactNative&quot;).render(renderable, rootTag);&#125;</code></pre><h3 id="è®¾è®¡çš„åˆå¿ "><a href="#è®¾è®¡çš„åˆå¿ " class="headerlink" title="è®¾è®¡çš„åˆå¿ "></a>è®¾è®¡çš„åˆå¿ </h3><p>å¼€å‘æ–°çš„æ¸²æŸ“æ¶æ„çš„åˆè¡·æ˜¯ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œè€Œè¿™ç§æ–°ä½“éªŒæ˜¯åœ¨è€æ¶æ„ä¸Šæ˜¯ä¸å¯èƒ½å®ç°çš„</p><p><strong>æå‡äº’æ“æ€§</strong></p><ul><li>ä¸ºäº†<code>æå‡å®¿ä¸»è§†å›¾ï¼ˆhost viewsï¼‰å’Œ React è§†å›¾ï¼ˆReact viewsï¼‰çš„äº’æ“ä½œæ€§</code>ï¼Œæ¸²æŸ“å™¨å¿…é¡»æœ‰èƒ½åŠ›åŒæ­¥åœ°æµ‹é‡å’Œæ¸²æŸ“ React ç•Œé¢ã€‚åœ¨è€æ¶æ„ä¸­ï¼ŒReact Native å¸ƒå±€æ˜¯å¼‚æ­¥çš„ï¼Œè¿™å¯¼è‡´åœ¨å®¿ä¸»è§†å›¾ä¸­æ¸²æŸ“åµŒå¥—çš„ React Native è§†å›¾ï¼Œä¼šæœ‰å¸ƒå±€â€œæŠ–åŠ¨â€çš„é—®é¢˜ã€‚</li></ul><p><strong>ä½¿ç”¨ React æ–°ç‰¹æ€§</strong></p><ul><li><p>å€ŸåŠ©å¤šä¼˜å…ˆçº§å’ŒåŒæ­¥äº‹ä»¶çš„èƒ½åŠ›ï¼Œæ¸²æŸ“å™¨å¯ä»¥æé«˜ç”¨æˆ·äº¤äº’çš„ä¼˜å…ˆçº§ï¼Œæ¥ç¡®ä¿ä»–ä»¬çš„æ“ä½œå¾—åˆ°åŠæ—¶çš„å¤„ç†(React schedule è°ƒåº¦ï¼Œlan æ¨¡å‹)</p></li><li><p>React Suspense çš„é›†æˆï¼Œå…è®¸ä½ åœ¨ React ä¸­æ›´ç¬¦åˆç›´è§‰åœ°å†™è¯·æ±‚æ•°æ®ä»£ç ã€‚</p></li><li><p>å…è®¸ä½ åœ¨ React Native ä½¿ç”¨ React Concurrent æ¨¡å¼ å¯ä¸­æ–­æ¸²æŸ“åŠŸèƒ½ã€‚ <a href="https://zhuanlan.zhihu.com/p/60307571#:~:text=%E6%96%B9%E5%BC%8F%E8%BF%9B%E8%A1%8C%E5%8C%BA%E5%88%86%E3%80%82-,Concurrent%20%E7%A9%B6%E7%AB%9F%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F,-Concurrent%20%E5%B9%B6%E4%B8%8D%E6%98%AF" target="_blank" >Concurrent ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</a> å¼‚æ­¥å¯ä¸­æ–­</p></li><li><p>æ›´å®¹æ˜“å®ç° React Native çš„æœåŠ¡ç«¯æ¸²æŸ“ã€‚ï¼Ÿæ‰“ä¸ªé—®å·ï¼Œæ˜¯ä¸æ˜¯ RN ä»£ç å¯ä»¥éƒ¨ç½²åœ¨äº‘ç«¯ï¼Ÿè¿›è¡Œ SSR?</p></li></ul><h3 id="è®¾è®¡çš„æ”¶ç›Š"><a href="#è®¾è®¡çš„æ”¶ç›Š" class="headerlink" title="è®¾è®¡çš„æ”¶ç›Š"></a>è®¾è®¡çš„æ”¶ç›Š</h3><ul><li><code>ç±»å‹å®‰å…¨</code>ï¼šä»£ç ç”Ÿæˆå·¥å…·ï¼ˆcode generationï¼‰ç¡®ä¿äº† JS å’Œå®¿ä¸»å¹³å°ä¸¤æ–¹é¢çš„ç±»å‹å®‰å…¨ã€‚ä»£ç ç”Ÿæˆå·¥å…·ä½¿ç”¨ JavaScript ç»„ä»¶å£°æ˜ä½œä¸ºå”¯ä¸€äº‹å®æºï¼Œç”Ÿæˆ C++ ç»“æ„ä½“æ¥æŒæœ‰ props å±æ€§ã€‚ä¸ä¼šå› ä¸º JavaScript å’Œå®¿ä¸»ç»„ä»¶ props å±æ€§ä¸åŒ¹é…è€Œå‡ºç°æ„å»ºé”™è¯¯ã€‚</li><li><code>å…±äº« C++ core</code>ï¼šæ¸²æŸ“å™¨æ˜¯ç”¨ C++ å®ç°çš„ï¼Œå…¶æ ¸å¿ƒ core åœ¨å¹³å°ä¹‹é—´æ˜¯å…±äº«çš„ã€‚è¿™å¢åŠ äº†ä¸€è‡´æ€§å¹¶ä¸”ä½¿å¾—æ–°çš„å¹³å°èƒ½å¤Ÿæ›´å®¹æ˜“é‡‡ç”¨ React Nativeã€‚ï¼ˆè¯‘æ³¨ï¼šä¾‹å¦‚ VR æ–°å¹³å°ï¼‰</li><li><code>æ›´å¥½çš„å®¿ä¸»å¹³å°äº’æ“ä½œæ€§</code>ï¼šå½“å®¿ä¸»ç»„ä»¶é›†æˆåˆ° React Native æ—¶ï¼ŒåŒæ­¥å’Œçº¿ç¨‹å®‰å…¨çš„å¸ƒå±€è®¡ç®—æå‡äº†ç”¨æˆ·ä½“éªŒï¼ˆè¯‘æ³¨ï¼šæ²¡æœ‰å¼‚æ­¥çš„æŠ–åŠ¨ï¼‰ã€‚è¿™æ„å‘³ç€é‚£äº›éœ€è¦åŒæ­¥ API çš„å®¿ä¸»å¹³å°åº“ï¼Œå˜å¾—æ›´å®¹æ˜“é›†æˆäº†ã€‚</li><li><code>æ€§èƒ½æå‡</code>ï¼šæ–°çš„æ¸²æŸ“ç³»ç»Ÿçš„å®ç°æ˜¯è·¨å¹³å°çš„ï¼Œæ¯ä¸ªå¹³å°éƒ½ä»é‚£äº›åŸæœ¬åªåœ¨æŸä¸ªç‰¹å®šå¹³å°çš„å®ç°çš„æ€§èƒ½ä¼˜åŒ–ä¸­ï¼Œå¾—åˆ°äº†æ”¶ç›Šã€‚æ¯”å¦‚æ‹å¹³è§†å›¾å±‚çº§ï¼ŒåŸæœ¬åªæ˜¯ Android ä¸Šçš„æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œç°åœ¨ Android å’Œ iOS éƒ½ç›´æ¥æœ‰äº†ã€‚</li><li><code>ä¸€è‡´æ€§</code>ï¼šæ–°çš„æ¸²æŸ“ç³»ç»Ÿçš„å®ç°æ˜¯è·¨å¹³å°çš„ï¼Œä¸åŒå¹³å°ä¹‹é—´æ›´å®¹æ˜“ä¿æŒä¸€è‡´ã€‚</li><li><code>æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦</code>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå®¿ä¸»ç»„ä»¶çš„åˆå§‹åŒ–æ˜¯æ‡’æ‰§è¡Œçš„ã€‚ï¼Ÿä»¥å‰ä¸æ˜¯</li><li><code>JS å’Œå®¿ä¸»å¹³å°ä¹‹é—´çš„æ•°æ®åºåˆ—åŒ–æ›´å°‘</code>ï¼šReact ä½¿ç”¨åºåˆ—åŒ– JSON åœ¨ JavaScript å’Œå®¿ä¸»å¹³å°ä¹‹é—´ä¼ é€’æ•°æ®ã€‚æ–°çš„æ¸²æŸ“å™¨ç”¨ JSIï¼ˆJavaScript Interfaceï¼‰ç›´æ¥è·å– JavaScript æ•°æ®ã€‚</li></ul><h3 id="é—®é¢˜æ¥äº†"><a href="#é—®é¢˜æ¥äº†" class="headerlink" title="é—®é¢˜æ¥äº†"></a>é—®é¢˜æ¥äº†</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ä»¥å‰ jsx -&gt; åŸç”Ÿ&#x2F;&#x2F; ç°åœ¨ jsx -&gt; JSI C++ -&gt; åŸç”Ÿ</code></pre><p>å¤šäº†ä¸€å±‚ï¼Œç«Ÿç„¶ä¸æ…¢åå¿«? æˆ‘çŒœåº”è¯¥åœ¨ <code>JSI C++ -&gt; åŸç”Ÿ</code></p><p><a href="https://www.react-native.cn/architecture/xplat-implementation#:~:text=%E4%BD%BF%E7%94%A8%20C%2B%2B%20%E4%BD%9C%E4%B8%BA%E6%A0%B8%E5%BF%83%E6%B8%B2%E6%9F%93%E7%B3%BB%E7%BB%9F%E6%9C%89%E5%87%A0%E4%B8%AA%E6%9C%89%E7%82%B9" target="_blank" >è·¨å¹³å°å®ç°ä¸­æœ‰å¯¹æ­¤è¯´æ˜</a></p><p>åœ¨ä¸Šä¸€ä»£ React Native æ¸²æŸ“å™¨ä¸­ï¼ŒReact å½±å­æ ‘ã€å¸ƒå±€é€»è¾‘ã€è§†å›¾æ‹å¹³ç®—æ³•æ˜¯åœ¨å„ä¸ªå¹³å°å•ç‹¬å®ç°çš„ã€‚å½“å‰çš„æ¸²æŸ“å™¨çš„è®¾è®¡ä¸Šé‡‡ç”¨çš„æ˜¯è·¨å¹³å°çš„è§£å†³æ–¹æ¡ˆï¼Œå…±äº«äº†æ ¸å¿ƒçš„ C++ å®ç°ã€‚</p><p>ä½¿ç”¨ C++ ä½œä¸ºæ ¸å¿ƒæ¸²æŸ“ç³»ç»Ÿæœ‰å‡ ä¸ªä¼˜ç‚¹</p><ul><li>å•ä¸€å®ç°é™ä½äº†å¼€å‘å’Œç»´æŠ¤æˆæœ¬</li><li>å®ƒæå‡äº†åˆ›å»º React å½±å­æ ‘çš„æ€§èƒ½</li><li>åœ¨ Android ä¸Šï¼Œä¹Ÿå› ä¸ºä¸å†ä½¿ç”¨ JNI for Yogaï¼Œé™ä½äº† Yoga æ¸²æŸ“å¼•æ“çš„å¼€é”€ï¼Œå¸ƒå±€è®¡ç®—çš„æ€§èƒ½ä¹Ÿæœ‰æ‰€æå‡</li><li>æ¯ä¸ª React å½±å­èŠ‚ç‚¹åœ¨ C++ ä¸­å ç”¨çš„å†…å­˜ï¼Œæ¯”åœ¨ Kotlin æˆ– Swift ä¸­å ç”¨çš„è¦å°ã€‚</li><li>å¼ºåˆ¶ä¸å¯å˜çš„ C++ ç‰¹æ€§ï¼Œæ¥ç¡®ä¿å¹¶å‘è®¿é—®æ—¶å…±äº«èµ„æºå³ä¾¿ä¸åŠ é”ä¿æŠ¤ï¼Œä¹Ÿä¸ä¼šæœ‰é—®é¢˜ã€‚</li></ul><p>åœ¨ Android ç«¯è¿˜æœ‰ä¸¤ç§ä¾‹å¤–ï¼Œæ¸²æŸ“å™¨ä¾ç„¶ä¼šæœ‰ JNI çš„å¼€é”€ï¼š</p><ul><li>å¤æ‚è§†å›¾ï¼Œæ¯”å¦‚ Textã€TextInput ç­‰ï¼Œä¾ç„¶ä¼šä½¿ç”¨ JNI æ¥ä¼ è¾“å±æ€§ propsã€‚</li><li>åœ¨æŒ‚è½½é˜¶æ®µä¾ç„¶ä¼šä½¿ç”¨ JNI æ¥å‘é€å˜æ›´æ“ä½œã€‚</li></ul><p>React Native å›¢é˜Ÿåœ¨æ¢ç´¢ä½¿ç”¨ ByteBuffer åºåˆ—åŒ–æ•°æ®è¿™ç§æ–°çš„æœºåˆ¶ï¼Œæ¥æ›¿æ¢ ReadableMapï¼Œå‡å°‘ JNI çš„å¼€é”€ã€‚ç›®æ ‡æ˜¯å°† JNI çš„å¼€é”€å‡å°‘ 35~50%ã€‚</p><h3 id="fabric-æä¾›äº†-C-ä¸ä¸¤è¾¹é€šä¿¡çš„-API"><a href="#fabric-æä¾›äº†-C-ä¸ä¸¤è¾¹é€šä¿¡çš„-API" class="headerlink" title="fabric æä¾›äº† C++ ä¸ä¸¤è¾¹é€šä¿¡çš„ API"></a>fabric æä¾›äº† C++ ä¸ä¸¤è¾¹é€šä¿¡çš„ API</h3><img src="https://www.react-native.cn/assets/images/xplat-implementation-diagram-7611cf9dfb6d15667365630147d83ca5.png" /><ul><li>(i) ä¸ React é€šä¿¡</li><li>(ii) ä¸å®¿ä¸»å¹³å°é€šä¿¡</li></ul><p>å…³äº (i) React ä¸æ¸²æŸ“å™¨çš„é€šä¿¡ï¼ŒåŒ…æ‹¬<code>æ¸²æŸ“ï¼ˆrenderï¼‰ React æ ‘</code>å’Œ<code>ç›‘å¬äº‹ä»¶ï¼ˆeventï¼‰</code>ï¼Œæ¯”å¦‚ <code>onLayout</code>ã€<code>onKeyPress</code>ã€<code>touch</code> ç­‰ã€‚</p><p>å…³äº (ii) React Native æ¸²æŸ“å™¨ä¸å®¿ä¸»å¹³å°çš„é€šä¿¡ï¼ŒåŒ…æ‹¬<code>åœ¨å±å¹•ä¸ŠæŒ‚è½½ï¼ˆmountï¼‰å®¿ä¸»è§†å›¾</code>ï¼ŒåŒ…æ‹¬ <code>create</code>ã€<code>insert</code>ã€<code>update</code>ã€<code>delete</code> å®¿ä¸»è§†å›¾ï¼Œå’Œ<code>ç›‘å¬ç”¨æˆ·åœ¨å®¿ä¸»å¹³å°äº§ç”Ÿçš„äº‹ä»¶</code>ã€‚</p><h2 id="è§†å›¾æ‹å¹³"><a href="#è§†å›¾æ‹å¹³" class="headerlink" title="è§†å›¾æ‹å¹³"></a>è§†å›¾æ‹å¹³</h2><p>è§†å›¾æ‹å¹³ï¼ˆView Flatteningï¼‰æ˜¯ React Native æ¸²æŸ“å™¨é¿å…å¸ƒå±€åµŒå¥—å¤ªæ·±çš„ä¼˜åŒ–æ‰‹æ®µ</p><p>React API åœ¨è®¾è®¡ä¸Šå¸Œæœ›é€šè¿‡ç»„åˆçš„æ–¹å¼ï¼Œ<code>å®ç°ç»„ä»¶å£°æ˜å’Œé‡ç”¨</code>ï¼Œè¿™ä¸ºæ›´ç®€å•çš„å¼€å‘æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„æ¨¡å‹ã€‚ä½†æ˜¯åœ¨å®ç°ä¸­ï¼ŒAPI çš„è¿™äº›ç‰¹æ€§ä¼šå¯¼è‡´ä¸€äº› React å…ƒç´ ä¼šåµŒå¥—åœ°å¾ˆæ·±ï¼Œè€Œå…¶ä¸­å¤§éƒ¨åˆ† React å…ƒç´ èŠ‚ç‚¹åªä¼šå½±å“è§†å›¾å¸ƒå±€ï¼Œå¹¶ä¸ä¼šåœ¨å±å¹•ä¸­æ¸²æŸ“ä»»ä½•å†…å®¹ã€‚è¿™å°±æ˜¯æ‰€è°“çš„â€œåªå‚ä¸å¸ƒå±€â€ç±»å‹èŠ‚ç‚¹ã€‚</p><p>ä»æ¦‚å¿µä¸Šè®²ï¼ŒReact å…ƒç´ æ ‘çš„èŠ‚ç‚¹æ•°é‡å’Œå±å¹•ä¸Šçš„è§†å›¾æ•°é‡åº”è¯¥æ˜¯ 1:1 çš„å…³ç³»ã€‚ä½†æ˜¯ï¼Œæ¸²æŸ“ä¸€ä¸ªå¾ˆæ·±çš„â€œåªå‚ä¸å¸ƒå±€â€çš„ React å…ƒç´ ä¼šå¯¼è‡´æ€§èƒ½å˜æ…¢ã€‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¤§æ¦‚æ„æ€ï¼šå› ä¸º React ç»„åˆè®¾è®¡å®ç°ç»„ä»¶å¤ç”¨ã€‚ ç»„ä»¶å¤ç”¨åµŒå¥—å¤šäº†ï¼Œä¼šå‡ºç°å¾ˆå¤šæ— å†…å®¹çš„å¸ƒå±€èŠ‚ç‚¹ï¼Œè¿™äº›å¸ƒå±€èŠ‚ç‚¹æ²¡å•¥ç”¨ï¼Œå¤šä¸ªè¿ç»­åµŒå¥—çš„èŠ‚ç‚¹ï¼Œåœ¨ fabric ä¸­è¢«ä¸€å·´æŒæ‹æ­»æ‰“æˆä¸€ä¸ªè‚‰é¥¼ï¼Œå—¯ï½</p></blockquote><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>ä¸¾ä¸ªå¾ˆå¸¸è§çš„ä¾‹å­ï¼Œä¾‹å­ä¸­â€œåªå‚ä¸å¸ƒå±€â€è§†å›¾å¯¼è‡´äº†æ€§èƒ½æŸè€—ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ è¦æ¸²æŸ“ä¸€ä¸ªæ ‡é¢˜ã€‚ä½ æœ‰ä¸€ä¸ªåº”ç”¨ï¼Œåº”ç”¨ä¸­æ‹¥æœ‰å¤–è¾¹è· ContainerComponent çš„å®¹å™¨ç»„ä»¶ï¼Œå®¹å™¨ç»„ä»¶çš„å­ç»„ä»¶æ˜¯ TitleComponent æ ‡é¢˜ç»„ä»¶ï¼Œæ ‡é¢˜ç»„ä»¶åŒ…æ‹¬ä¸€ä¸ªå›¾ç‰‡å’Œä¸€è¡Œæ–‡å­—ã€‚React ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx">function MyComponent() &#123;  return (    &lt;View&gt;                          &#x2F;&#x2F; ReactAppComponent      &lt;View style&#x3D;&#123;&#123;margin: 10&#125;&#125; &#x2F;&gt; &#x2F;&#x2F; ContainerComponent        &lt;View style&#x3D;&#123;&#123;margin: 10&#125;&#125;&gt; &#x2F;&#x2F; TitleComponent          &lt;Image &#123;...&#125; &#x2F;&gt;          &lt;Text &#123;...&#125;&gt;This is a title&lt;&#x2F;Text&gt;        &lt;&#x2F;View&gt;      &lt;&#x2F;View&gt;    &lt;&#x2F;View&gt;  );&#125;</code></pre><h3 id="æ‹å¹³å‰"><a href="#æ‹å¹³å‰" class="headerlink" title="æ‹å¹³å‰"></a>æ‹å¹³å‰</h3><p>React Native åœ¨æ¸²æŸ“æ—¶ï¼Œä¼šç”Ÿæˆä»¥ä¸‹ä¸‰æ£µæ ‘ï¼š</p><img src="https://www.react-native.cn/assets/images/diagram-one-3f2f9d7a2fa9d97b6b86fa3bd9b886d1.png" /><p>ä¸ºäº†æå‡ React å…ƒç´ æ ‘ä¸­â€œåªå‚ä¸å¸ƒå±€â€ç±»å‹çš„æ€§èƒ½ï¼Œæ¸²æŸ“å™¨å®ç°äº†ä¸€ç§è§†å›¾æ‹å¹³çš„æœºåˆ¶æ¥åˆå¹¶æˆ–æ‹å¹³è¿™ç±»èŠ‚ç‚¹ï¼Œå‡å°‘å±å¹•ä¸­å®¿ä¸»è§†å›¾çš„å±‚çº§æ·±åº¦ã€‚è¯¥ç®—æ³•è€ƒè™‘åˆ°äº†å¦‚ä¸‹å±æ€§ï¼Œæ¯”å¦‚ margin, padding, backgroundColor, opacity ç­‰ç­‰ã€‚</p><p><code>è§†å›¾æ‹å¹³ç®—æ³•</code>æ˜¯æ¸²<code>æŸ“å™¨çš„å¯¹æ¯”ï¼ˆdiffingï¼‰é˜¶æ®µçš„ä¸€éƒ¨åˆ†</code>ï¼Œè¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯æˆ‘ä»¬<code>ä¸éœ€è¦é¢å¤–çš„ CPU è€—æ—¶</code>(ä¸éœ€è¦å†éå†äº†ï¼Œä½†æ˜¯ç»å¯¹æ˜¯æœ‰ CPU æŸè€—çš„)ï¼Œæ¥<code>æ‹å¹³ React å…ƒç´ æ ‘ä¸­â€œåªå‚ä¸å¸ƒå±€â€çš„è§†å›¾</code>ã€‚æ­¤å¤–ï¼Œä½œä¸º C++ æ ¸å¿ƒçš„ä¸€éƒ¨åˆ†ï¼Œ<code>è§†å›¾æ‹å¹³ç®—æ³•é»˜è®¤æ˜¯å…¨å¹³å°å…±ç”¨çš„</code>ã€‚</p><p>åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œè§†å›¾ 2 å’Œè§†å›¾ 3 ä¼šä½œä¸ºâ€œå¯¹æ¯”ç®—æ³•â€ï¼ˆdiffing algorithmï¼‰çš„ä¸€éƒ¨åˆ†è¢«æ‹å¹³ï¼Œè€Œå®ƒä»¬çš„æ ·å¼ç»“æœä¼šè¢«åˆå¹¶åˆ°è§†å›¾ 1 ä¸­ã€‚</p><img src="https://www.react-native.cn/assets/images/diagram-two-b87959980d29e4a303465a3d0ac82c73.png" /><p>è™½ç„¶ï¼Œè¿™ç§<code>ä¼˜åŒ–è®©æ¸²æŸ“å™¨å°‘åˆ›å»ºå’Œæ¸²æŸ“ä¸¤ä¸ªå®¿ä¸»è§†å›¾</code>ï¼Œä½†<code>ä»ç”¨æˆ·çš„è§’åº¦çœ‹å±å¹•å†…å®¹æ²¡æœ‰ä»»ä½•åŒºåˆ«</code>ã€‚</p><h3 id="æ‹å¹³"><a href="#æ‹å¹³" class="headerlink" title="æ‹å¹³"></a>æ‹å¹³</h3><h3 id="æ‹å¹³å"><a href="#æ‹å¹³å" class="headerlink" title="æ‹å¹³å"></a>æ‹å¹³å</h3><h2 id="çº¿ç¨‹æ¨¡å‹"><a href="#çº¿ç¨‹æ¨¡å‹" class="headerlink" title="çº¿ç¨‹æ¨¡å‹"></a>çº¿ç¨‹æ¨¡å‹</h2><p>React Native æ¸²æŸ“å™¨åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´åˆ†é… <a href="https://www.react-native.cn/architecture/render-pipeline" target="_blank" >æ¸²æŸ“æµæ°´çº¿ï¼ˆrender pipelineï¼‰ä»»åŠ¡</a>ã€‚<br>æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šç»™çº¿ç¨‹æ¨¡å‹ä¸‹å®šä¹‰ï¼Œå¹¶æä¾›ä¸€äº›ç¤ºä¾‹æ¥è¯´æ˜æ¸²æŸ“æµæ°´çº¿çš„çº¿ç¨‹ç”¨æ³•ã€‚</p><p>React Native æ¸²æŸ“å™¨æ˜¯<code>çº¿ç¨‹å®‰å…¨</code>çš„ã€‚</p><p>ä»æ›´é«˜çš„è§†è§’çœ‹ï¼Œåœ¨æ¡†æ¶å†…éƒ¨çº¿ç¨‹å®‰å…¨æ˜¯<code>é€šè¿‡ä¸å¯å˜çš„æ•°æ®ç»“æœä¿éšœ</code>çš„ï¼Œå…¶ä½¿ç”¨çš„æ˜¯ C++ çš„ const correctness ç‰¹æ€§ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨æ¸²æŸ“å™¨ä¸­ React çš„<code>æ¯æ¬¡æ›´æ–°éƒ½ä¼šé‡æ–°åˆ›å»ºæˆ–å¤åˆ¶æ–°å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ›´æ–°åŸæœ‰çš„æ•°æ®ç»“æ„</code>ã€‚è¿™æ˜¯æ¡†æ¶æŠŠçº¿ç¨‹å®‰å…¨å’ŒåŒæ­¥ API æš´éœ²ç»™ React çš„å‰æã€‚</p><p>æ¸²æŸ“å™¨ä½¿ç”¨ä¸‰ä¸ªä¸åŒçš„çº¿ç¨‹ï¼š</p><ul><li>UI çº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰ï¼šå”¯ä¸€å¯ä»¥æ“ä½œå®¿ä¸»è§†å›¾çš„çº¿ç¨‹ã€‚</li><li>JavaScript çº¿ç¨‹ï¼šè¿™æ˜¯æ‰§è¡Œ React æ¸²æŸ“é˜¶æ®µçš„åœ°æ–¹ã€‚</li><li>åå°çº¿ç¨‹ï¼šä¸“é—¨ç”¨äºå¸ƒå±€çš„çº¿ç¨‹ã€‚</li></ul><h2 id="æ¸²æŸ“åœºæ™¯"><a href="#æ¸²æŸ“åœºæ™¯" class="headerlink" title="æ¸²æŸ“åœºæ™¯"></a>æ¸²æŸ“åœºæ™¯</h2><h3 id="åœ¨åå°çº¿ç¨‹ä¸­æ¸²æŸ“"><a href="#åœ¨åå°çº¿ç¨‹ä¸­æ¸²æŸ“" class="headerlink" title="åœ¨åå°çº¿ç¨‹ä¸­æ¸²æŸ“"></a>åœ¨åå°çº¿ç¨‹ä¸­æ¸²æŸ“</h3><p>è¿™æ˜¯æœ€å¸¸è§çš„åœºæ™¯ï¼Œå¤§å¤šæ•°çš„æ¸²æŸ“æµæ°´çº¿å‘ç”Ÿåœ¨ JavaScript çº¿ç¨‹å’Œåå°çº¿ç¨‹ã€‚</p><img src="http://t-blog-images.aijs.top/img/case-1.webp" /><h3 id="åœ¨ä¸»çº¿ç¨‹ä¸­æ¸²æŸ“"><a href="#åœ¨ä¸»çº¿ç¨‹ä¸­æ¸²æŸ“" class="headerlink" title="åœ¨ä¸»çº¿ç¨‹ä¸­æ¸²æŸ“"></a>åœ¨ä¸»çº¿ç¨‹ä¸­æ¸²æŸ“</h3><p>å½“ UI çº¿ç¨‹ä¸Šæœ‰é«˜ä¼˜å…ˆçº§äº‹ä»¶æ—¶ï¼Œæ¸²æŸ“å™¨èƒ½å¤Ÿåœ¨ UI çº¿ç¨‹ä¸ŠåŒæ­¥æ‰§è¡Œæ‰€æœ‰æ¸²æŸ“æµæ°´çº¿ã€‚</p><img src="http://t-blog-images.aijs.top/img/case-2.webp" /><h3 id="é»˜è®¤æˆ–è¿ç»­äº‹ä»¶ä¸­æ–­"><a href="#é»˜è®¤æˆ–è¿ç»­äº‹ä»¶ä¸­æ–­" class="headerlink" title="é»˜è®¤æˆ–è¿ç»­äº‹ä»¶ä¸­æ–­"></a>é»˜è®¤æˆ–è¿ç»­äº‹ä»¶ä¸­æ–­</h3><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼ŒUI çº¿ç¨‹çš„ä½ä¼˜å…ˆçº§äº‹ä»¶ä¸­æ–­äº†æ¸²æŸ“æ­¥éª¤ã€‚React å’Œ React Native æ¸²æŸ“å™¨èƒ½å¤Ÿä¸­æ–­æ¸²æŸ“æ­¥éª¤ï¼Œå¹¶æŠŠå®ƒçš„çŠ¶æ€å’Œä¸€ä¸ªåœ¨ UI çº¿ç¨‹æ‰§è¡Œçš„ä½ä¼˜å…ˆçº§äº‹ä»¶åˆå¹¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­æ¸²æŸ“è¿‡ç¨‹ä¼šç»§ç»­åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p><img src="http://t-blog-images.aijs.top/img/case-3.webp" /><h3 id="ä¸ç›¸å¹²çš„äº‹ä»¶ä¸­æ–­"><a href="#ä¸ç›¸å¹²çš„äº‹ä»¶ä¸­æ–­" class="headerlink" title="ä¸ç›¸å¹²çš„äº‹ä»¶ä¸­æ–­"></a>ä¸ç›¸å¹²çš„äº‹ä»¶ä¸­æ–­</h3><p>æ¸²æŸ“æ­¥éª¤æ˜¯å¯ä¸­æ–­çš„ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œ <code>UI çº¿ç¨‹çš„é«˜ä¼˜å…ˆçº§äº‹ä»¶ä¸­æ–­äº†æ¸²æŸ“æ­¥éª¤</code>ã€‚React å’Œæ¸²æŸ“å™¨æ˜¯èƒ½å¤Ÿæ‰“æ–­æ¸²æŸ“æ­¥éª¤çš„ï¼Œå¹¶æŠŠå®ƒçš„çŠ¶æ€å’Œ UI çº¿ç¨‹æ‰§è¡Œçš„é«˜ä¼˜å…ˆçº§äº‹ä»¶åˆå¹¶ã€‚åœ¨ UI çº¿ç¨‹æ¸²æŸ“æ­¥éª¤æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚</p><img src="http://t-blog-images.aijs.top/img/case-4.webp" /><h3 id="æ¥è‡ª-JavaScript-çº¿ç¨‹çš„åå°çº¿ç¨‹æ‰¹é‡æ›´æ–°"><a href="#æ¥è‡ª-JavaScript-çº¿ç¨‹çš„åå°çº¿ç¨‹æ‰¹é‡æ›´æ–°" class="headerlink" title="æ¥è‡ª JavaScript çº¿ç¨‹çš„åå°çº¿ç¨‹æ‰¹é‡æ›´æ–°"></a>æ¥è‡ª JavaScript çº¿ç¨‹çš„åå°çº¿ç¨‹æ‰¹é‡æ›´æ–°</h3><p>åœ¨åå°çº¿ç¨‹å°†æ›´æ–°åˆ†æ´¾ç»™ UI çº¿ç¨‹ä¹‹å‰ï¼Œå®ƒä¼šæ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„æ›´æ–°æ¥è‡ª JavaScriptã€‚ è¿™æ ·ï¼Œå½“æ¸²æŸ“å™¨çŸ¥é“æ–°çš„çŠ¶æ€è¦åˆ°æ¥æ—¶ï¼Œå®ƒå°±ä¸ä¼šç›´æ¥æ¸²æŸ“æ—§çš„çŠ¶æ€ã€‚</p><img src="http://t-blog-images.aijs.top/img/case-5.webp" /><h3 id="C-çŠ¶æ€æ›´æ–°"><a href="#C-çŠ¶æ€æ›´æ–°" class="headerlink" title="C++ çŠ¶æ€æ›´æ–°"></a>C++ çŠ¶æ€æ›´æ–°</h3><p>æ›´æ–°æ¥è‡ª UI çº¿ç¨‹ï¼Œå¹¶ä¼šè·³è¿‡æ¸²æŸ“æ­¥éª¤ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ React Native æ¸²æŸ“å™¨çŠ¶æ€æ›´æ–°ã€‚</p><img src="http://t-blog-images.aijs.top/img/case-6.webp" /><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://github.com/react-native-community/discussions-and-proposals/issues/4" target="_blank" >React Native Fabric (UI-Layer Re-architecture) #4</a></p><p><a href="https://www.react-native.cn/docs/fabric-renderer" target="_blank" >Fabric æ¸²æŸ“å™¨</a></p><p><a href="https://juejin.cn/post/7099885746697273357" target="_blank" >React Native æ¶æ„è§£æ - ä¸€å¼ å›¾äº†è§£ Fabric</a></p><p><a href="https://react.iamkasong.com/preparation/file.html#packages%E7%9B%AE%E5%BD%95" target="_blank" >React æŠ€æœ¯æ­ç§˜</a></p>]]></content>
      
      
      <categories>
          
          <category> react-native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-è®¾è®¡æ¨¡å¼</title>
      <link href="//post/2022-07-18%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html"/>
      <url>//post/2022-07-18%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html</url>
      
        <content type="html"><![CDATA[<h2 id="SOLID-è®¾è®¡åŸåˆ™"><a href="#SOLID-è®¾è®¡åŸåˆ™" class="headerlink" title="SOLID è®¾è®¡åŸåˆ™"></a>SOLID è®¾è®¡åŸåˆ™</h2><p><strong>S: Single Responsibility Principle</strong> å•ä¸€èŒè´£åŸåˆ™</p><p>ä¸€ä¸ªç¨‹åºåªåšä¸€ä»¶äº‹</p><p><strong>O: OpenClosed Principle</strong> å¼€æ”¾&#x2F;å°é—­åŸåˆ™</p><p>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</p><p><strong>L:</strong> é‡Œæ°æ›¿æ¢åŸåˆ™</p><p>å­ç±»èƒ½è¦†ç›–çˆ¶ç±»ï¼Œçˆ¶ç±»èƒ½å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¹Ÿèƒ½å‡ºç°</p><p><strong>I: interface Segregation Principle</strong> æ¥å£éš”ç¦»åŸåˆ™</p><p>ä¿æŒæ¥å£çš„å•ä¸€ç‹¬ç«‹ï¼Œé¿å…å‡ºç°â€œèƒ–æ¥å£â€ã€‚è¿™ç‚¹ç›®å‰åœ¨ TS ä¸­è¿ç”¨åˆ°</p><p><strong>D: Dependency Inversion Principle</strong> ä¾èµ–å€’è½¬åŸåˆ™</p><p>é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“ã€‚ä½¿ç”¨æ–¹åªä¸“æ³¨æ¥å£è€Œä¸ç”¨å…³æ³¨å…·ä½“ç±»çš„å®ç°ã€‚ä¿—ç§°â€œé¸­å­ç±»å‹â€</p><h2 id="å¸¸è§çš„è®¾è®¡æ¨¡å¼"><a href="#å¸¸è§çš„è®¾è®¡æ¨¡å¼" class="headerlink" title="å¸¸è§çš„è®¾è®¡æ¨¡å¼"></a>å¸¸è§çš„è®¾è®¡æ¨¡å¼</h2><ul><li>åˆ›å»ºå‹ï¼š<code>å•ä¾‹æ¨¡å¼</code>ã€<code>å·¥å‚æ¨¡å¼</code>ã€<code>åŸå‹æ¨¡å¼</code></li><li>ç»“æ„å‹ï¼š<code>è£…é¥°å™¨æ¨¡å¼</code>ã€<code>ä»£ç†æ¨¡å¼</code></li><li>è¡Œä¸ºå‹ï¼š<code>ç­–ç•¥æ¨¡å¼</code>ã€<code>æ¨¡å—æ–¹æ³•æ¨¡å¼</code>ã€<code>å‘å¸ƒè®¢é˜…æ¨¡å¼</code>ã€‚</li></ul><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><p>å•ä¾‹æ¨¡å¼çš„æ€è·¯æ˜¯ï¼šä¿è¯ä¸€ä¸ªç±»åªèƒ½è¢«å®ä¾‹ä¸€æ¬¡ï¼Œæ¯æ¬¡è·å–çš„æ—¶å€™ï¼Œå¦‚æœè¯¥ç±»å·²ç»åˆ›å»ºè¿‡å®ä¾‹åˆ™ç›´æ¥è¿”å›è¯¥å®ä¾‹ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªå®ä¾‹ä¿å­˜å¹¶è¿”å›ã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜çš„å¼€é”€ã€‚</li><li>é¿å…äº†å¯¹èµ„æºå¤šé‡çš„å ç”¨ã€‚</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>è¿åäº†å•ä¸€èŒè´£ï¼Œä¸€ä¸ªç±»åº”è¯¥åªå…³å¿ƒå†…éƒ¨é€»è¾‘ï¼Œè€Œä¸ç”¨å»å…³å¿ƒå¤–éƒ¨çš„å®ç°</p><h2 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h2><p>å·¥å‚æ¨¡å¼æ˜¯<code>ç”¨æ¥åˆ›å»ºå¯¹è±¡</code>çš„ä¸€ç§æœ€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œä¸æš´éœ²åˆ›å»ºå¯¹è±¡çš„å…·ä½“é€»è¾‘ï¼Œè€Œæ˜¯å°†å°†é€»è¾‘å°è£…åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªå·¥å‚</p><p>å…¶å°±åƒå·¥å‚ä¸€æ ·é‡å¤çš„<code>äº§ç”Ÿç±»ä¼¼çš„äº§å“</code>ï¼Œå·¥å‚æ¨¡å¼åªéœ€è¦æˆ‘ä»¬ä¼ å…¥æ­£ç¡®çš„å‚æ•°ï¼Œå°±èƒ½ç”Ÿäº§ç±»ä¼¼çš„äº§å“</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>ç¼–ç¨‹ä¸­ï¼Œåœ¨ä¸€ä¸ª A ç±»ä¸­é€šè¿‡ new çš„æ–¹å¼å®ä¾‹åŒ–äº†ç±» Bï¼Œé‚£ä¹ˆ A ç±»å’Œ B ç±»ä¹‹é—´å°±å­˜åœ¨å…³è”(è€¦åˆ)</p><p>åæœŸå› ä¸ºéœ€è¦ä¿®æ”¹äº† B ç±»çš„ä»£ç å’Œä½¿ç”¨æ–¹å¼ï¼Œæ¯”å¦‚æ„é€ å‡½æ•°ä¸­ä¼ å…¥å‚æ•°ï¼Œé‚£ä¹ˆ A ç±»ä¹Ÿè¦è·Ÿç€ä¿®æ”¹ï¼Œä¸€ä¸ªç±»çš„ä¾èµ–å¯èƒ½å½±å“ä¸å¤§ï¼Œä½†è‹¥æœ‰å¤šä¸ªç±»ä¾èµ–äº† B ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªå·¥ä½œé‡å°†ä¼šç›¸å½“çš„å¤§ï¼Œå®¹æ˜“å‡ºç°ä¿®æ”¹é”™è¯¯ï¼Œä¹Ÿä¼šäº§ç”Ÿå¾ˆå¤šçš„é‡å¤ä»£ç ï¼Œè¿™æ— ç–‘æ˜¯ä»¶éå¸¸ç—›è‹¦çš„äº‹;</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦å°†åˆ›å»ºå®ä¾‹çš„å·¥ä½œä»è°ƒç”¨æ–¹(A ç±»)ä¸­åˆ†ç¦»ï¼Œä¸è°ƒç”¨æ–¹ã€Œè§£è€¦ã€ï¼Œä¹Ÿå°±æ˜¯<code>ä½¿ç”¨å·¥å‚æ–¹æ³•åˆ›å»ºå®ä¾‹çš„å·¥ä½œå°è£…èµ·æ¥(ã€Œå‡å°‘ä»£ç é‡å¤ã€)</code>ï¼Œç”±å·¥å‚ç®¡ç†å¯¹è±¡çš„åˆ›å»ºé€»è¾‘ï¼Œ<code>è°ƒç”¨æ–¹ä¸éœ€è¦çŸ¥é“å…·ä½“çš„åˆ›å»ºè¿‡ç¨‹ï¼Œåªç®¡ä½¿ç”¨</code>ï¼Œã€Œè€Œé™ä½è°ƒç”¨è€…å› ä¸ºåˆ›å»ºé€»è¾‘å¯¼è‡´çš„é”™è¯¯ã€;</p><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>è°ƒç”¨è€…åˆ›å»ºå¯¹è±¡æ—¶åªè¦çŸ¥é“å…¶åç§°å³å¯</li><li>æ‰©å±•æ€§é«˜ï¼Œå¦‚æœè¦æ–°å¢ä¸€ä¸ªäº§å“ï¼Œç›´æ¥æ‰©å±•ä¸€ä¸ªå·¥å‚ç±»å³å¯ã€‚</li><li>éšè—äº§å“çš„å…·ä½“å®ç°ï¼Œåªå…³å¿ƒäº§å“çš„æ¥å£ã€‚</li></ul><h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>æ¯æ¬¡å¢åŠ ä¸€ä¸ªäº§å“æ—¶ï¼Œéƒ½éœ€è¦å¢åŠ ä¸€ä¸ªå…·ä½“ç±»ï¼Œè¿™æ— å½¢å¢åŠ äº†ç³»ç»Ÿå†…å­˜çš„å‹åŠ›å’Œç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œä¹Ÿå¢åŠ äº†å…·ä½“ç±»çš„ä¾èµ–</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å·¥å‚æ¨¡å¼<code>æ ¹æ®æŠ½è±¡ç¨‹åº¦</code>çš„ä¸åŒå¯ä»¥åˆ†ä¸ºï¼š</p><ul><li><code>ç®€å•å·¥å‚æ¨¡å¼</code>(Simple Factory)</li><li><code>å·¥å‚æ–¹æ³•æ¨¡å¼</code>(Factory Method)</li><li><code>æŠ½è±¡å·¥å‚æ¨¡å¼</code>(Abstract Factory)</li></ul><h3 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h3><p>ç®€å•å·¥å‚æ¨¡å¼ä¹Ÿå«é™æ€å·¥å‚æ¨¡å¼ï¼Œ<code>ç”¨ä¸€ä¸ªå·¥å‚å¯¹è±¡åˆ›å»ºåŒä¸€ç±»å¯¹è±¡ç±»çš„å®ä¾‹</code></p><p>å‡è®¾æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªå…¬å¸å²—ä½åŠå…¶å·¥ä½œå†…å®¹çš„å½•å…¥ä¿¡æ¯ï¼Œä¸åŒå²—ä½çš„å·¥ä½œå†…å®¹ä¸ä¸€è‡´</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function Factory(career) &#123;  function User(career, work) &#123;    this.career &#x3D; career;    this.work &#x3D; work;  &#125;  let work;  switch (career) &#123;    case &quot;coder&quot;:      work &#x3D; [&quot;å†™ä»£ç &quot;, &quot;ä¿®Bug&quot;];      return new User(career, work);      break;    case &quot;hr&quot;:      work &#x3D; [&quot;æ‹›è˜&quot;, &quot;å‘˜å·¥ä¿¡æ¯ç®¡ç†&quot;];      return new User(career, work);      break;    case &quot;driver&quot;:      work &#x3D; [&quot;å¼€è½¦&quot;];      return new User(career, work);      break;    case &quot;boss&quot;:      work &#x3D; [&quot;å–èŒ¶&quot;, &quot;å¼€ä¼š&quot;, &quot;å®¡æ‰¹æ–‡ä»¶&quot;];      return new User(career, work);      break;  &#125;&#125;let coder &#x3D; new Factory(&quot;coder&quot;);console.log(coder);let boss &#x3D; new Factory(&quot;boss&quot;);console.log(boss);</code></pre><h3 id="ç®€å•å·¥å‚æ–¹æ³•"><a href="#ç®€å•å·¥å‚æ–¹æ³•" class="headerlink" title="ç®€å•å·¥å‚æ–¹æ³•"></a>ç®€å•å·¥å‚æ–¹æ³•</h3><p>å·¥å‚æ–¹æ³•æ¨¡å¼è·Ÿç®€å•å·¥å‚æ¨¡å¼å·®ä¸å¤šï¼Œä½†æ˜¯<code>æŠŠå…·ä½“çš„äº§å“æ”¾åˆ°äº†å·¥å‚å‡½æ•°çš„ prototype ä¸­</code></p><p>è¿™æ ·ä¸€æ¥ï¼Œæ‰©å±•äº§å“ç§ç±»å°±ä¸å¿…ä¿®æ”¹å·¥å‚å‡½æ•°äº†ï¼Œå˜æˆæŠ½è±¡ç±»ï¼Œä¹Ÿå¯ä»¥éšæ—¶é‡å†™æŸç§å…·ä½“çš„äº§å“</p><p>ä¹Ÿå°±æ˜¯ç›¸å½“äºå·¥å‚æ€»éƒ¨ä¸ç”Ÿäº§äº§å“äº†ï¼Œäº¤ç»™ä¸‹è¾–åˆ†å·¥å‚è¿›è¡Œç”Ÿäº§;ä½†æ˜¯è¿›å…¥å·¥å‚ä¹‹å‰ï¼Œéœ€è¦æœ‰ä¸ªåˆ¤æ–­æ¥éªŒè¯ä½ è¦ç”Ÿäº§çš„ä¸œè¥¿æ˜¯å¦æ˜¯å±äºæˆ‘ä»¬å·¥å‚æ‰€ç”Ÿäº§èŒƒå›´ï¼Œå¦‚æœæ˜¯ï¼Œå°±ä¸¢ç»™ä¸‹è¾–å·¥å‚æ¥è¿›è¡Œç”Ÿäº§</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; å·¥å‚æ–¹æ³•function Factory(career) &#123;  if (this instanceof Factory) &#123;    return new this[career]();  &#125; else &#123;    return new Factory(career);  &#125;&#125;&#x2F;&#x2F; å·¥å‚æ–¹æ³•å‡½æ•°çš„åŸå‹ä¸­è®¾ç½®æ‰€æœ‰å¯¹è±¡çš„æ„é€ å‡½æ•°Factory.prototype &#x3D; &#123;  coder: function () &#123;    this.careerName &#x3D; &quot;ç¨‹åºå‘˜&quot;;    this.work &#x3D; [&quot;å†™ä»£ç &quot;, &quot;ä¿®Bug&quot;];  &#125;,  hr: function () &#123;    this.careerName &#x3D; &quot;HR&quot;;    this.work &#x3D; [&quot;æ‹›è˜&quot;, &quot;å‘˜å·¥ä¿¡æ¯ç®¡ç†&quot;];  &#125;,  driver: function () &#123;    this.careerName &#x3D; &quot;å¸æœº&quot;;    this.work &#x3D; [&quot;å¼€è½¦&quot;];  &#125;,  boss: function () &#123;    this.careerName &#x3D; &quot;è€æ¿&quot;;    this.work &#x3D; [&quot;å–èŒ¶&quot;, &quot;å¼€ä¼š&quot;, &quot;å®¡æ‰¹æ–‡ä»¶&quot;];  &#125;,&#125;;let coder &#x3D; new Factory(&quot;coder&quot;);console.log(coder);let hr &#x3D; new Factory(&quot;hr&quot;);console.log(hr);</code></pre><h3 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h3><p>ä¸Šè¿°<code>ç®€å•å·¥å‚æ¨¡å¼</code>å’Œ<code>å·¥å‚æ–¹æ³•æ¨¡å¼</code>éƒ½<code>æ˜¯ç›´æ¥ç”Ÿæˆå®ä¾‹</code>ï¼Œä½†æ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼ä¸åŒï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¹¶ä¸ç›´æ¥ç”Ÿæˆå®ä¾‹ï¼Œ è€Œæ˜¯ç”¨äºå¯¹äº§å“ç±»ç°‡çš„åˆ›å»º</p><p>é€šä¿—ç‚¹æ¥è®²å°±æ˜¯ï¼š<code>ç®€å•å·¥å‚å’Œå·¥å‚æ–¹æ³•æ¨¡å¼çš„å·¥ä½œæ˜¯ç”Ÿäº§äº§å“ï¼Œé‚£ä¹ˆæŠ½è±¡å·¥å‚æ¨¡å¼çš„å·¥ä½œå°±æ˜¯ç”Ÿäº§å·¥å‚çš„</code></p><p>ç”±äº JavaScript ä¸­å¹¶æ²¡æœ‰æŠ½è±¡ç±»çš„æ¦‚å¿µï¼Œåªèƒ½æ¨¡æ‹Ÿï¼Œå¯ä»¥åˆ†æˆå››éƒ¨åˆ†ï¼š</p><ul><li>ç”¨äºåˆ›å»ºæŠ½è±¡ç±»çš„å‡½æ•°</li><li>æŠ½è±¡ç±»</li><li>å…·ä½“ç±»</li><li>å®ä¾‹åŒ–å…·ä½“ç±»</li></ul><p>ä¸Šé¢çš„ä¾‹å­ä¸­æœ‰ coderã€hrã€bossã€driver å››ç§å²—ä½ï¼Œå…¶ä¸­ coder å¯èƒ½ä½¿ç”¨ä¸åŒçš„å¼€å‘è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œæ¯”å¦‚ JavaScriptã€Java ç­‰ç­‰ã€‚é‚£ä¹ˆè¿™ä¸¤ç§è¯­è¨€å°±æ˜¯å¯¹åº”çš„ç±»ç°‡</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function CareerAbstractUserFactory(type) &#123;  switch (type) &#123;    case &quot;coder&quot;:      return UserOfCoder;    case &quot;hr&quot;:      return UserOfHR;    case &quot;driver&quot;:      return UserOfDriver;    case &quot;boss&quot;:      return UserOfBoss;    default:      throw new Error(&quot;å‚æ•°é”™è¯¯, å¯é€‰å‚æ•°:coderã€hrã€driverã€boss&quot;);  &#125;&#125;</code></pre><p>ä¸Šé¢ä»£ç ä¸­ CareerAbstractFactory å°±æ˜¯ä¸€ä¸ªæŠ½è±¡å·¥å‚æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨å‚æ•°ä¸­ä¼ é€’å­ç±»å’Œçˆ¶ç±»ï¼Œåœ¨æ–¹æ³•ä½“å†…éƒ¨å®ç°äº†å­ç±»å¯¹çˆ¶ç±»çš„ç»§æ‰¿</p><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>å·¥å‚æ¨¡å¼é€‚ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœä½ ä¸æƒ³è®©æŸä¸ªå­ç³»ç»Ÿä¸è¾ƒå¤§çš„é‚£ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆå¼ºè€¦åˆï¼Œè€Œæ˜¯æƒ³è¿è¡Œæ—¶ä»è®¸å¤šå­ç³»ç»Ÿä¸­è¿›è¡ŒæŒ‘é€‰çš„è¯ï¼Œé‚£ä¹ˆå·¥å‚æ¨¡å¼æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹© <code>flutteræ¥å£è¿”å›jsonæ•°æ®è½¬åŒ–æˆå®ä¾‹</code></li><li>å°† new æ“ä½œç®€å•å°è£…ï¼Œ<code>é‡åˆ° new çš„æ—¶å€™å°±åº”è¯¥è€ƒè™‘æ˜¯å¦ç”¨å·¥å‚æ¨¡å¼</code>;</li><li><code>éœ€è¦ä¾èµ–å…·ä½“ç¯å¢ƒåˆ›å»ºä¸åŒå®ä¾‹ï¼Œè¿™äº›å®ä¾‹éƒ½æœ‰ç›¸åŒçš„è¡Œä¸º,è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼</code>ï¼Œç®€åŒ–å®ç°çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘æ¯ç§å¯¹è±¡æ‰€éœ€çš„ä»£ç é‡ï¼Œæœ‰åˆ©äºæ¶ˆé™¤å¯¹è±¡é—´çš„è€¦åˆï¼Œæä¾›æ›´å¤§çš„çµæ´»æ€§</li></ul><p><a href="https://developer.51cto.com/article/688576.html" target="_blank" >è¯´è¯´ä½ å¯¹å·¥å‚æ¨¡å¼çš„ç†è§£ï¼Ÿåº”ç”¨åœºæ™¯ï¼Ÿ</a><br><a href="https://juejin.cn/post/6844903653774458888#heading-3" target="_blank" >JavaScript è®¾è®¡æ¨¡å¼ä¸å®è·µâ€“å·¥å‚æ¨¡å¼</a></p><h2 id="åŸå‹æ¨¡å¼"><a href="#åŸå‹æ¨¡å¼" class="headerlink" title="åŸå‹æ¨¡å¼"></a>åŸå‹æ¨¡å¼</h2><p>åŸå‹æ¨¡å¼æ˜¯æŒ‡åŸå‹å®ä¾‹æŒ‡å‘åˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œé€šè¿‡æ‹·è´è¿™äº›åŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œè¯´ç™½äº†å°±æ˜¯å…‹éš†è‡ªå·±ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p><h3 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>ä¸å†ä¾èµ–æ„é€ å‡½æ•°æˆ–è€…ç±»åˆ›å»ºå¯¹è±¡ï¼Œå¯ä»¥å°†è¿™ä¸ªå¯¹è±¡ä½œä¸ºä¸€ä¸ªæ¨¡æ¿ç”Ÿæˆæ›´å¤šçš„æ–°å¯¹è±¡ã€‚</p><h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å¯¹äºåŒ…å«å¼•ç”¨ç±»å‹å€¼çš„å±æ€§æ¥è¯´ï¼Œæ‰€æœ‰å®ä¾‹åœ¨é»˜è®¤çš„æƒ…å†µä¸‹éƒ½ä¼šå–å¾—ç›¸åŒçš„å±æ€§å€¼ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Object.createconst user &#x3D; &#123;  name: &quot;å°æ˜&quot;,  age: &quot;30&quot;,  getInfo() &#123;    console.log(&#96;å§“åï¼š$&#123;this.name&#125;ï¼Œå¹´é¾„ï¼š$&#123;this.age&#125;&#96;);  &#125;,&#125;;const xiaozhang &#x3D; Object.create(user);xiaozhang.name &#x3D; &quot;å°å¼ &quot;;xiaozhang.age &#x3D; 18;xiaozhang.getInfo(); &#x2F;&#x2F; å§“åï¼šå°å¼ ï¼Œå¹´é¾„ï¼š18user.getInfo(); &#x2F;&#x2F; å§“åï¼šå°æ˜ï¼Œå¹´é¾„ï¼š30</code></pre><h2 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h2><h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><p>HTML å…ƒ ç´ äº‹ä»¶ä»£ç†</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;ul id&#x3D;&quot;ul&quot;&gt;  &lt;li&gt;1&lt;&#x2F;li&gt;  &lt;li&gt;2&lt;&#x2F;li&gt;  &lt;li&gt;3&lt;&#x2F;li&gt;&lt;&#x2F;ul&gt;&lt;script&gt;  let ul &#x3D; document.querySelector(&#39;#ul&#39;);  ul.addEventListener(&#39;click&#39;, event &#x3D;&gt; &#123;    console.log(event.target);  &#125;);&lt;&#x2F;script&gt;</code></pre><h3 id="ä¼˜ç‚¹-3"><a href="#ä¼˜ç‚¹-3" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ä»£ç†æ¨¡å¼èƒ½å°†ä»£ç†å¯¹è±¡ä¸è¢«è°ƒç”¨å¯¹è±¡åˆ†ç¦»ï¼Œ<code>é™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦</code>ã€‚</li><li>ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨ï¼Œè¿™æ ·å¯ä»¥<code>èµ·åˆ°ä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨</code></li><li>ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›é€šè¿‡ä¿®æ”¹ä»£ç†å¯¹è±¡å°±å¯ä»¥äº†ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ï¼›</li></ul><h3 id="ç¼ºç‚¹-3"><a href="#ç¼ºç‚¹-3" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å¤„ç†è¯·æ±‚é€Ÿåº¦å¯èƒ½æœ‰å·®åˆ«ï¼Œéç›´æ¥è®¿é—®å­˜åœ¨å¼€é”€</p><p>ä½œè€…ï¼šå››å¶èˆŸ<br>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/19a8c1d76257">https://www.jianshu.com/p/19a8c1d76257</a><br>æ¥æºï¼šç®€ä¹¦<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><h2 id="å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆeventbusï¼‰"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆeventbusï¼‰" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆeventbusï¼‰"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆeventbusï¼‰</h2><h2 id="æ¨¡å—æ–¹æ³•æ¨¡å¼"><a href="#æ¨¡å—æ–¹æ³•æ¨¡å¼" class="headerlink" title="æ¨¡å—æ–¹æ³•æ¨¡å¼"></a>æ¨¡å—æ–¹æ³•æ¨¡å¼</h2><p>æ¨¡å—æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§åŸºäºç»§æ‰¿çš„è®¾è®¡æ¨¡å¼ï¼Œ</p><p>åœ¨ javascript ä¸­æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„ç»§æ‰¿ï¼Œæ‰€æœ‰ç»§æ‰¿éƒ½æ¥è‡ªåŸå‹(prototype)ä¸Šçš„ç»§æ‰¿ï¼Œ<br>éšç€ ES6 çš„ class åˆ°æ¥ï¼Œå®ç°äº†ç»§æ‰¿çš„â€œæ¦‚å¿µâ€ï¼Œè®©æˆ‘ä»¬å¯ä»¥ä»¥ä¸€ç§å¾ˆæ–¹ä¾¿ç®€æ´çš„æ–¹å¼ç»§æ‰¿ï¼Œä½†å…¶æœ¬è´¨ä¸Šè¿˜æ˜¯åŸå‹ç»§æ‰¿ã€‚</p><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œ<code>ç¬¬ä¸€éƒ¨åˆ†æ˜¯æŠ½è±¡çˆ¶ç±»</code>ï¼Œ<code>ç¬¬äºŒéƒ¨åˆ†æ˜¯å…·ä½“çš„å®ç°å­ç±»</code>ã€‚</p><ul><li><code>æŠ½è±¡çˆ¶ç±»</code>ä¸»è¦å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼Œä»¥åŠå®ç°äº†ä¸€äº›å…¬å…±çš„æ–¹æ³•å’Œå…¶ä»–æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚</li><li><code>å­ç±»</code>é€šè¿‡ç»§æ‰¿çˆ¶ç±»ï¼Œç»§æ‰¿äº†çˆ¶ç±»çš„ç®—æ³•æ¡†æ¶ï¼Œå¹¶è¿›è¡Œé‡å†™ã€‚</li></ul><h3 id="ä¼˜ç‚¹-4"><a href="#ä¼˜ç‚¹-4" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>æä¾›å…¬å…±çš„ä»£ç ä¾¿äºç»´æŠ¤ã€‚è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå…·ä½“ç”±å­ç±»æ¥å®ç°ã€‚</p><h3 id="ç¼ºç‚¹-4"><a href="#ç¼ºç‚¹-4" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å…¶æ¯ä¸€ä¸ªå…·ä½“å®ç°éƒ½éœ€è¦ç»§æ‰¿çš„å­ç±»æ¥å®ç°ï¼Œè¿™æ— ç–‘å¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œä½¿å¾—ç³»ç»Ÿåºå¤§ã€‚</p><h2 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h2><h2 id="è£…é¥°å™¨æ¨¡å¼"><a href="#è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="è£…é¥°å™¨æ¨¡å¼"></a>è£…é¥°å™¨æ¨¡å¼</h2><p><a href="https://www.bilibili.com/video/BV1WK411G7QH?spm_id_from=333.337.search-card.all.click">https://www.bilibili.com/video/BV1WK411G7QH?spm_id_from=333.337.search-card.all.click</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jianshu.com/p/19a8c1d76257" target="_blank" >å‰ç«¯å¸¸è§çš„ 9 ç§è®¾è®¡æ¨¡å¼</a></p><p><a href="https://juejin.cn/post/7072175210874535967" target="_blank" >javascript çš„ 23 ç§è®¾è®¡æ¨¡å¼</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-CSS3</title>
      <link href="//post/2022-07-17css.html"/>
      <url>//post/2022-07-17css.html</url>
      
        <content type="html"><![CDATA[<h2 id="CSS-é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·çš„"><a href="#CSS-é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·çš„" class="headerlink" title="CSS é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·çš„"></a>CSS é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·çš„</h2><p>CSS é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯ï¼š<span style="color: red">ï¼ˆæ ‡ç­¾é€‰æ‹©å™¨ &lt; ç±»é€‰æ‹©å™¨ &lt; ID é€‰æ‹©å™¨ï¼‰</span> <code>&lt; å†…è” &lt; !important &lt; ç‰¹æ®Šæƒ…å†µ </code></p><p>åˆ°å…·ä½“çš„è®¡ç®—å±‚â¾¯ï¼Œä¼˜å…ˆçº§æ˜¯ç”± A ã€Bã€Cã€D çš„å€¼æ¥å†³å®šçš„ï¼Œå…¶ä¸­å®ƒä»¬çš„å€¼è®¡ç®—è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>A çš„å€¼ç­‰äº 1 çš„å‰ææ˜¯å­˜åœ¨å†…è”æ ·å¼, å¦åˆ™ A &#x3D; 0;</li><li>B çš„å€¼ç­‰äº ID é€‰æ‹©å™¨ å‡ºç°çš„æ¬¡æ•°;</li><li>C çš„å€¼ç­‰äº ç±»é€‰æ‹©å™¨ å’Œ å±æ€§é€‰æ‹©å™¨ å’Œ ä¼ªç±» å‡ºç°çš„æ€»æ¬¡æ•°;</li><li>D çš„å€¼ç­‰äº æ ‡ç­¾é€‰æ‹©å™¨ å’Œ ä¼ªå…ƒç´  å‡ºç°çš„æ€»æ¬¡æ•° ã€‚</li></ul><p>å°±â½å¦‚ä¸‹â¾¯çš„é€‰æ‹©å™¨ï¼Œå®ƒä¸å­˜åœ¨å†…è”æ ·å¼ï¼Œæ‰€ä»¥ A&#x3D;0,ä¸å­˜åœ¨ id é€‰æ‹©å™¨ B&#x3D;0,å­˜åœ¨â¼€ä¸ªç±»é€‰æ‹©å™¨ C&#x3D;1,å­˜åœ¨ä¸‰ä¸ªæ ‡ç­¾é€‰æ‹©å™¨ D&#x3D;3ï¼Œé‚£ä¹ˆæœ€ç»ˆè®¡ç®—ç»“æœä¸º:</p><pre class="line-numbers language-CSS" data-language="CSS"><code class="language-CSS">ul ol li .red &#123; ... &#125; &#x2F;* &#123;0, 0, 1 ,3&#125; *&#x2F;</code></pre><p>æŒ‰ç…§è¿™ä¸ªç»“ç®—â½…å¼ï¼Œä¸‹â¾¯çš„è®¡ç®—ç»“æœä¸º:</p><pre class="line-numbers language-CSS" data-language="CSS"><code class="language-CSS">#red &#123; &#125; &#x2F;* &#123;0, 1, 0, 0&#125; *&#x2F;</code></pre><p>â½è¾ƒä¼˜å…ˆçº§çš„â½…å¼æ˜¯ä» A åˆ° D å»â½è¾ƒå€¼çš„â¼¤â¼©ï¼ŒAã€Bã€Cã€D æƒé‡ä»å·¦åˆ°å³ï¼Œä¾æ¬¡å‡â¼©ã€‚åˆ¤æ–­ä¼˜å…ˆçº§æ—¶ï¼Œä»å·¦åˆ°å³ï¼Œâ¼€â¼€â½è¾ƒï¼Œ<code>ç›´åˆ°â½è¾ƒå‡ºæœ€â¼¤å€¼ï¼Œå³å¯åœâ½Œ</code>ã€‚</p><p>â½å¦‚ç¬¬â¼†ä¸ªä¾‹â¼¦çš„ B ä¸ç¬¬â¼€ä¸ªä¾‹â¼¦çš„ B ç›¸â½ï¼Œ1&gt;0,<code>æ¥ä¸‹æ¥å°±ä¸éœ€è¦â½è¾ƒäº†ï¼Œç¬¬â¼†ä¸ªé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ›´â¾¼</code>ã€‚</p><h2 id="æ¯”-importantæ›´é«˜çš„ä¼˜å…ˆçº§"><a href="#æ¯”-importantæ›´é«˜çš„ä¼˜å…ˆçº§" class="headerlink" title="æ¯”!importantæ›´é«˜çš„ä¼˜å…ˆçº§"></a>æ¯”<code>!important</code>æ›´é«˜çš„ä¼˜å…ˆçº§</h2><p>ä»ä¸‰ä¸ªæ–¹é¢æ¥è¯´ï¼š <span style="color: red">H5 æ ‡ç­¾ã€CSS3 æ ·å¼ã€åª’ä½“æŸ¥è¯¢ã€æ–‡ä»¶å…³ç³»</span></p><ul><li><code>picture source</code></li><li><code>image srcset</code></li><li><code>max-widthã€min-width</code></li><li><code>mediaåª’ä½“æŸ¥è¯¢</code></li><li><code>åŒæ˜¯!importantï¼Œå†…éƒ¨æ–‡ä»¶ä¼˜å…ˆäºå¤–éƒ¨æ–‡ä»¶</code></li><li><code>åŒæ˜¯!importantï¼Œlink ä¼˜å…ˆäº@import</code></li><li>antd <code>:global</code> æ ·å¼è¦†ç›–</li></ul><h2 id="link-å’Œ-import-çš„åŒºåˆ«"><a href="#link-å’Œ-import-çš„åŒºåˆ«" class="headerlink" title="link å’Œ@import çš„åŒºåˆ«"></a>link å’Œ@import çš„åŒºåˆ«</h2><ul><li>link å±äº <code>XHTML æ ‡ç­¾</code>ï¼Œâ½½@import æ˜¯ <code>CSS æä¾›çš„</code>ã€‚</li><li>â»šâ¾¯è¢«åŠ è½½æ—¶ï¼Œ<code>link ä¼šåŒæ—¶è¢«åŠ è½½</code>ï¼Œâ½½@import å¼•â½¤çš„ CSS ä¼š<code>ç­‰åˆ°â»šâ¾¯è¢«åŠ è½½å®Œå†åŠ è½½</code>ã€‚</li><li>import åªåœ¨ IE 5 ä»¥ä¸Šæ‰èƒ½è¯†åˆ«ï¼Œâ½½ link æ˜¯ XHTML æ ‡ç­¾ï¼Œâ½†<code>å…¼å®¹é—®é¢˜</code>ã€‚</li><li>link â½…å¼çš„æ ·å¼<code>æƒé‡</code>â¾¼äº@import çš„æƒé‡ã€‚</li><li>ä½¿â½¤ dom æ§åˆ¶æ ·å¼æ—¶çš„å·®åˆ«ã€‚å½“ä½¿â½¤ <code>javascript æ§åˆ¶ dom å»æ”¹å˜æ ·å¼</code>çš„æ—¶å€™ï¼Œåªèƒ½ä½¿â½¤ link æ ‡ç­¾ï¼Œå› ä¸º@import ä¸æ˜¯ dom å¯ä»¥æ§åˆ¶çš„ã€‚</li></ul><h2 id="CSS-éšè—â»šâ¾¯å…ƒç´ "><a href="#CSS-éšè—â»šâ¾¯å…ƒç´ " class="headerlink" title="CSS éšè—â»šâ¾¯å…ƒç´ "></a>CSS éšè—â»šâ¾¯å…ƒç´ </h2><ul><li><code>opacity:0 </code>ï¼šæœ¬è´¨ä¸Šæ˜¯å°†å…ƒç´ çš„é€æ˜åº¦å°†ä¸º 0ï¼Œå°±çœ‹èµ·æ¥éšè—äº†ï¼Œä½†æ˜¯ä¾ç„¶<code>å æ®ç©ºé—´å¯äº¤äº’</code></li><li><code>visibility:hidden</code> : ä¸ä¸Šâ¼€ä¸ªâ½…æ³•ç±»ä¼¼çš„æ•ˆæœï¼Œ<code>å æ®ç©ºé—´ä¸å¯äº¤äº’</code></li><li><code>overflow:hidden</code> : è¿™ä¸ªåªéšè—å…ƒç´ æº¢å‡ºçš„éƒ¨åˆ†ï¼Œ<code>å æ®ç©ºé—´ä¸å¯äº¤äº’</code></li><li><code>display:none</code> : è¿™ä¸ªæ˜¯å½»åº•éšè—äº†å…ƒç´ ï¼Œå…ƒç´ ä»â½‚æ¡£æµä¸­æ¶ˆå¤±ï¼Œ<code>ä¸å æ®ç©ºé—´ä¸äº¤äº’</code></li><li><code>z-index:-9999</code> : åŸç†æ˜¯å°†å±‚çº§æ”¾åˆ°åº•éƒ¨ï¼Œè¿™æ ·å°±è¢«è¦†ç›–äº†ï¼Œ<code>ä¸å æ®ç©ºé—´ä¸äº¤äº’</code></li><li><code>transform: scale(0,0) </code>: å¹³â¾¯å˜æ¢ï¼Œå°†å…ƒç´ ç¼©æ”¾ä¸º 0ï¼Œ<code>å æ®ç©ºé—´ä¸å¯äº¤äº’</code></li><li><code>transform: </code>: ç§»å‡ºå¯è§†åŒºåŸŸ<code>å æ®ç©ºé—´ä¸å¯äº¤äº’</code></li></ul><h2 id="em-px-rem-åŒºåˆ«"><a href="#em-px-rem-åŒºåˆ«" class="headerlink" title="em\px\rem åŒºåˆ«"></a>em\px\rem åŒºåˆ«</h2><ul><li><code>px</code>ï¼šç»å¯¹å•ä½ï¼Œâ»šâ¾¯æŒ‰ç²¾ç¡®åƒç´ å±•ç¤ºã€‚</li><li><code>em</code>ï¼šç›¸å¯¹å•ä½ï¼ŒåŸºå‡†ç‚¹ä¸ºâ½—èŠ‚ç‚¹å­—ä½“çš„â¼¤â¼©ï¼Œå¦‚æœâ¾ƒèº«å®šä¹‰äº† font-size æŒ‰â¾ƒèº«æ¥è®¡ç®—ï¼ˆæµè§ˆå™¨é»˜è®¤å­—ä½“æ˜¯ 16pxï¼‰ï¼Œæ•´ä¸ªâ»šâ¾¯å†… 1em ä¸æ˜¯â¼€ä¸ªå›ºå®šçš„å€¼ã€‚</li><li><code>rem</code>ï¼šç›¸å¯¹å•ä½ï¼Œå¯ç†è§£ä¸ºâ€root emâ€, ç›¸å¯¹æ ¹èŠ‚ç‚¹ html çš„å­—ä½“â¼¤â¼©æ¥è®¡ç®—ï¼ŒCSS3 æ–°åŠ å±æ€§ï¼Œchrome&#x2F;firefox&#x2F;IE9+â½€ æŒ</li></ul><h2 id="å—çº§å…ƒç´ â½”å¹³å±…ä¸­çš„â½…æ³•"><a href="#å—çº§å…ƒç´ â½”å¹³å±…ä¸­çš„â½…æ³•" class="headerlink" title="å—çº§å…ƒç´ â½”å¹³å±…ä¸­çš„â½…æ³•"></a>å—çº§å…ƒç´ â½”å¹³å±…ä¸­çš„â½…æ³•</h2><p>å¦‚æœä½¿â½¤ Hack çš„è¯ï¼Œâ½”å¹³å±…ä¸­çš„â½…æ³•â¾®å¸¸å¤šï¼Œä¸»æµçš„ï¼Œå¥‡è‘©çš„â»…æ‹“å±•é˜…è¯»</p><ul><li><code>margin:0 auto </code>â½…æ³•</li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;style&gt;  .center &#123;    height: 200px;    width: 200px;    margin: 0 auto;    border: 1px solid red;  &#125;&lt;&#x2F;style&gt;&lt;div class&#x3D;&quot;center&quot;&gt;â½”å¹³å±…ä¸­&lt;&#x2F;div&gt;</code></pre><ul><li><code>flex</code> å¸ƒå±€ï¼Œâ½¬å‰ä¸»æµâ½…æ³•</li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;style&gt;  .center&#123; display:flex; justify-content:center; 9 &#125;&lt;&#x2F;style&gt;&lt;div class&#x3D;&quot;center&quot;&gt;  &lt;div class&#x3D;&quot;flex-div&quot;&gt;1&lt;&#x2F;div&gt;  &lt;div class&#x3D;&quot;flex-div&quot;&gt;2&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;</code></pre><ul><li><code>table</code> â½…æ³• <code>æ ‡ç­¾æ‰“å°æ—¶å€™é‡åˆ°</code></li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;style&gt;  .center &#123;    display: table;    margin: 0 auto;    border: 1px solid red;  &#125;&lt;&#x2F;style&gt;&lt;div class&#x3D;&quot;center&quot;&gt;â½”å¹³å±…ä¸­&lt;&#x2F;div&gt;</code></pre><p>è¿˜æœ‰â¼€äº›é€šè¿‡ <code>position+(margin|transform)</code>ç­‰â½…æ³•çš„ä¸â¼€æ ·åˆ—ä¸¾äº†ï¼Œâ¾®é‡ç‚¹æ²¡å¿…è¦</p><h2 id="CSS-5-ç§å®šä½â½…å¼"><a href="#CSS-5-ç§å®šä½â½…å¼" class="headerlink" title="CSS 5 ç§å®šä½â½…å¼"></a>CSS 5 ç§å®šä½â½…å¼</h2><ul><li><code>static</code>: <code>æ­£å¸¸â½‚æ¡£æµå®šä½</code>ï¼Œæ­¤æ—¶ top, right, bottom, left å’Œ z-index <code>å±æ€§â½†æ•ˆ</code>ï¼Œ<code>å—çº§å…ƒç´ ï¼šä»ä¸Šå¾€ä¸‹çºµå‘æ’å¸ƒ</code>ï¼Œ<code>â¾çº§å…ƒç´ :ä»å·¦å‘å³æ’åˆ—</code>ã€‚</li><li><code>relative</code>ï¼š<code>ç›¸å¯¹å®šä½</code>ï¼Œæ­¤æ—¶çš„ã€ç›¸å¯¹ã€æ˜¯<code>ç›¸å¯¹äºæ­£å¸¸â½‚æ¡£æµçš„ä½ç½®</code>ã€‚</li><li><code>absolute</code>ï¼š<code>ç›¸å¯¹äºæœ€è¿‘çš„â¾® static å®šä½ç¥–å…ˆå…ƒç´ çš„åç§»</code>ï¼Œâ½å¦‚â¼€ä¸ªç»å¯¹å®šä½å…ƒç´ å®ƒçš„â½—çº§ã€å’Œç¥– â½—çº§å…ƒç´ éƒ½ä¸º relativeï¼Œå®ƒä¼šç›¸å¯¹ä»–çš„â½—çº§â½½äº§â½£åç§»ã€‚</li><li><code>fixed</code>ï¼šæŒ‡å®šå…ƒç´ <code>ç›¸å¯¹äºå±å¹•è§†â¼ï¼ˆviewportï¼‰çš„ä½ç½®</code>ã€‚å…ƒç´ çš„ä½ç½®åœ¨å±å¹•æ»šåŠ¨æ—¶ä¸ä¼šæ”¹å˜ï¼Œâ½å¦‚é‚£ ç§å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®â¼€èˆ¬éƒ½æ˜¯â½¤æ­¤å®šä½â½…å¼ã€‚</li><li><code>sticky</code>ï¼š<code>ç²˜æ€§å®šä½</code>ï¼Œç‰¹æ€§<code>è¿‘ä¼¼äº relative å’Œ fixed çš„åˆä½“</code>ï¼Œå…¶åœ¨å®é™…åº”â½¤ä¸­çš„è¿‘ä¼¼æ•ˆæœå°±æ˜¯ IOS é€šè®¯å½•æ»šåŠ¨çš„æ—¶å€™çš„ ã€é¡¶å±è‚¡ã€ã€‚</li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>éœ€è¦æ³¨æ„ BFC çš„å½±å“ï¼Œ<a href="https://blog.csdn.net/kaosini/article/details/118760075" target="_blank" >position:fixed æ²¡æœ‰ç›¸å¯¹æµè§ˆå™¨çª—å£å®šä½çš„åŸå›  transform å†²çª</a>,<code>æ³¨ï¼šåœ¨è™šæ‹Ÿåˆ—è¡¨æ—¶å€™ä¼šé‡åˆ°</code></p></div><h2 id="å±‚å ä¸Šä¸‹æ–‡"><a href="#å±‚å ä¸Šä¸‹æ–‡" class="headerlink" title="å±‚å ä¸Šä¸‹æ–‡"></a>å±‚å ä¸Šä¸‹æ–‡</h2><p><strong>æ˜¯ä»€ä¹ˆ</strong></p><p>å±‚å ä¸Šä¸‹â½‚æ˜¯ HTML å…ƒç´ çš„ä¸‰ç»´æ¦‚å¿µï¼Œè¿™äº› HTML å…ƒç´ åœ¨â¼€æ¡å‡æƒ³çš„ç›¸å¯¹äºâ¾¯å‘ï¼ˆç”µè„‘å±å¹•çš„ï¼‰è§†çª—æˆ–è€…â½¹â»šçš„â½¤æˆ·çš„ z è½´ä¸Šå»¶ä¼¸ï¼ŒHTML å…ƒç´ ä¾æ®å…¶â¾ƒèº«å±æ€§æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºå â½¤å±‚å ä¸Šä¸‹â½‚çš„ç©ºé—´ã€‚</p><p><code>å¯ä»¥ç†è§£ä¸º JS ä¸­çš„ä½œç”¨åŸŸï¼Œä¸€ä¸ªé¡µé¢ä¸­å¾€å¾€ä¸ä»…ä»…åªæœ‰ä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡</code></p><h3 id="å¦‚ä½•äº§â½£ï¼Ÿ"><a href="#å¦‚ä½•äº§â½£ï¼Ÿ" class="headerlink" title="å¦‚ä½•äº§â½£ï¼Ÿ"></a>å¦‚ä½•äº§â½£ï¼Ÿ</h3><p>è§¦å‘ä»¥ä¸‹æ¡ä»¶åˆ™ä¼šäº§â½£å±‚å ä¸Šä¸‹â½‚ï¼š</p><p><strong>é»˜è®¤åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡</strong></p><ul><li>æ ¹å…ƒç´  (HTML)</li></ul><p><strong>éœ€è¦é…åˆ z-index è§¦å‘åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡</strong></p><ul><li><code>z-index + position</code>å€¼ä¸ä¸º â€œautoâ€çš„ ç»å¯¹&#x2F;ç›¸å¯¹å®šä½</li><li><code>z-index + flex</code> â¼€ä¸ª z-index å€¼ä¸ä¸º â€œautoâ€çš„ flex é¡¹â½¬ (flex item)ï¼Œå³ï¼šâ½—å…ƒç´  display: flex|inline-flex</li></ul><p><strong>ä¸éœ€è¦é…åˆ z-index è§¦å‘åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡</strong></p><ul><li>opacity å±æ€§å€¼â¼©äº 1 çš„å…ƒç´ ï¼ˆå‚è€ƒ the specification for opacityï¼‰</li><li>å…ƒç´ çš„ä»¥ä¸‹å±æ€§çš„å€¼ä¸æ˜¯ noneï¼š<ul><li>transform</li><li>filter æ»¤é•œ</li><li>perspective 3D å…ƒç´ è·è§†å›¾çš„è·ç¦»,ä»¥åƒç´ è®¡</li><li>clip-path è£å‰ªå›¾ç‰‡</li><li>mask &#x2F; mask-image &#x2F; mask-border</li></ul></li><li>isolation å±æ€§è¢«è®¾ç½®ä¸º â€œisolateâ€çš„å…ƒç´  ä½¿ç”¨ isolation:isolate è¿›è¡Œé˜»æ–­ï¼Œå½¢æˆä¸€ä¸ªæ··åˆç»„ã€‚ç»„ä»¥å¤–çš„å…¶ä»–å…ƒç´ ä¸ä¼šå‘ç”Ÿå±‚å ã€‚<a href="https://www.zhangxinxu.com/wordpress/2016/01/understand-css3-isolation-isolate/" target="_blank" >æ·±å…¥ç ”ç©¶-webkit-overflow-scrolling:touch åŠ ios æ»šåŠ¨ </a></li><li>åœ¨ will-change ä¸­æŒ‡å®šäº†ä»»æ„ CSS å±æ€§ï¼Œå³ä¾¿ä½ æ²¡æœ‰ç›´æ¥æŒ‡å®šè¿™äº›å±æ€§çš„å€¼ï¼ˆå‚è€ƒ è¿™ç¯‡â½‚ç« ï¼‰</li><li>-webkit-overflow-scrolling å±æ€§è¢«è®¾ç½® â€œtouchâ€çš„å…ƒç´  (ä½¿ç”¨æ»šåŠ¨å›å¼¹æ•ˆæœ), <code>åœ¨ iOS 13 ä¹‹åï¼Œä¸éœ€è¦</code> <a href="https://www.cnblogs.com/xiahj/p/8036419.html#1--webkit-overflow-scrollingtouch%E6%98%AF%E4%BB%80%E4%B9%88" target="_blank" >è§</a></li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><code>åˆ›å»ºäº†å±‚å ä¸Šä¸‹æ–‡çš„å…ƒç´ åªå½±å“å…¶å­å­™ä»£å…ƒç´ </code>ï¼Œ<code>å®ƒè‡ªèº«çš„å±‚å æ°´å¹³æ˜¯ç”±å®ƒçš„çˆ¶å±‚å ä¸Šä¸‹æ–‡æ‰€å†³å®šçš„</code></p></blockquote><p>å½“ä¸¤ä¸ªå…ƒç´ <code>å±‚å æ°´å¹³ç›¸åŒ</code>çš„æ—¶å€™ï¼Œè¿™æ—¶å€™å°±è¦éµå¾ªä¸‹é¢ä¸¤ä¸ªå‡†åˆ™ï¼š</p><ul><li>åæ¥å±…ä¸ŠåŸåˆ™</li><li>è° z-index å¤§ï¼Œè°åœ¨ä¸Šçš„å‡†åˆ™</li></ul><h3 id="å¦‚ä½•ç†è§£-z-indexï¼Ÿ"><a href="#å¦‚ä½•ç†è§£-z-indexï¼Ÿ" class="headerlink" title="å¦‚ä½•ç†è§£ z-indexï¼Ÿ"></a>å¦‚ä½•ç†è§£ z-indexï¼Ÿ</h3><p>CSS ä¸­çš„ z-index å±æ€§æ§åˆ¶é‡å å…ƒç´ çš„å‚ç›´å åŠ é¡ºåºï¼Œé»˜è®¤å…ƒç´ çš„ z-index ä¸º 0ï¼Œå¯ä»¥ä¿®æ”¹ z-index æ¥æ§åˆ¶å…ƒç´ çš„å›¾å±‚ ä½ç½®ï¼Œâ½½ä¸” <code>z-index åªèƒ½å½±å“è®¾ç½®äº† position å€¼çš„å…ƒç´ </code>ã€‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>è¿™ä¸ªå±æ€§æ˜¯ä¸ªâ€œæ‹¼çˆ¹â€çš„å±æ€§ã€‚(å¦‚æœçˆ¶å…ƒç´ å±‚çº§ä½ï¼Œé‚£ä¹ˆå­å…ƒç´ å†æ€ä¹ˆåŠªåŠ›éƒ½æ²¡æœ‰ç”¨ <a href="https://blog.csdn.net/ccq2y/article/details/82143283" target="_blank" >è§</a></p></blockquote><h3 id="7-é˜¶å±‚å "><a href="#7-é˜¶å±‚å " class="headerlink" title="7 é˜¶å±‚å "></a>7 é˜¶å±‚å </h3><!-- <img src="http://t-blog-images.aijs.top/img/20220717205730.png" /> --><img src="http://t-blog-images.aijs.top/img/20220717215517.png" /><p>ä¸Šå›¾ä»åº•åˆ°ä¸Šï¼š</p><pre class="line-numbers language-none"><code class="language-none">èƒŒæ™¯ ---------&gt; å¸ƒå±€ç›¸å…³ -------&gt; å†…å®¹ç›¸å…³ ---------------------------------&gt;      |                                   |                    ï½œz-indexè´Ÿå€¼                            z-index0&#x2F;ä¸ä¾èµ–z-index   z-indexæ­£å€¼</code></pre><ul><li>å¦‚æœå…ƒç´ çš„å±‚å çº§åˆ«ä¸€æ ·ï¼Œæ²¡æœ‰åˆ«çš„å› ç´ å¹²æ‰°ï¼Œåˆ™éµå¾ªåæ¥è€…å±…ä¸ŠåŸåˆ™ã€‚<a href="https://zhuanlan.zhihu.com/p/115951908" target="_blank" >è§</a></li></ul><p><a href="https://blog.csdn.net/weixin_30607659/article/details/101594118" target="_blank" >CSS 7 é˜¶å±‚å æ°´å¹³</a></p><h3 id="å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ª-DOM-å…ƒç´ çš„æ˜¾ç¤ºé¡ºåºå‘¢"><a href="#å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ª-DOM-å…ƒç´ çš„æ˜¾ç¤ºé¡ºåºå‘¢" class="headerlink" title="å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ª DOM å…ƒç´ çš„æ˜¾ç¤ºé¡ºåºå‘¢"></a>å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ª DOM å…ƒç´ çš„æ˜¾ç¤ºé¡ºåºå‘¢</h3><!-- - 1ã€åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼Œå±‚å çº§åˆ«å¤§çš„å…ƒç´ åœ¨ä¸Š- 2ã€åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼Œå±‚å çº§åˆ«ç›¸åŒï¼Œåæ¥å±…ä¸Š- 3ã€ä¸åŒçš„å±‚å ä¸Šä¸‹æ–‡ï¼Œç”±çˆ¶çº§å…ƒç´ å±‚å ä¸Šä¸‹æ–‡å†³å®š --><ul><li>å¦‚æœæ˜¯<code>åœ¨ä¸åŒçš„å±‚å ä¸Šä¸‹æ–‡ä¸­</code>ï¼Œå…ˆæ‰¾åˆ°å…±åŒçš„ç¥–å…ˆå±‚å ä¸Šä¸‹æ–‡ï¼Œç„¶åæ¯”è¾ƒå…±åŒå±‚å ä¸Šä¸‹æ–‡ä¸‹, è¿™ä¸ªä¸¤ä¸ªå…ƒç´ æ‰€åœ¨çš„å±€éƒ¨å±‚å ä¸Šä¸‹æ–‡çš„å±‚å æ°´å¹³ã€‚</li><li>å¦‚æœæ˜¯<code>åœ¨ç›¸åŒçš„å±‚å ä¸Šä¸‹æ–‡</code>ï¼ŒæŒ‰ç…§å±‚å æ°´å¹³çš„è§„åˆ™æ¥æ˜¾ç¤ºå…ƒç´ ; å±‚å çº§åˆ«ç›¸åŒï¼Œåæ¥å±…ä¸Š</li></ul><h3 id="ä¸ºä»€ä¹ˆ-inlin-block-å’Œ-inline-çš„å±‚å é¡ºåºæ¯”æµ®åŠ¨å…ƒç´ å’Œå—çº§å…ƒç´ éƒ½é«˜ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-inlin-block-å’Œ-inline-çš„å±‚å é¡ºåºæ¯”æµ®åŠ¨å…ƒç´ å’Œå—çº§å…ƒç´ éƒ½é«˜ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ inlin-block å’Œ inline çš„å±‚å é¡ºåºæ¯”æµ®åŠ¨å…ƒç´ å’Œå—çº§å…ƒç´ éƒ½é«˜ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ inlin-block å’Œ inline çš„å±‚å é¡ºåºæ¯”æµ®åŠ¨å…ƒç´ å’Œå—çº§å…ƒç´ éƒ½é«˜ï¼Ÿ</h3><p>å› ä¸º float å’Œå—çº§å…ƒç´ ä¸€èˆ¬éƒ½ä½œå¸ƒå±€ï¼Œå†…è”å…ƒç´ éƒ½æ˜¯å†…å®¹ã€‚è€Œä¸€ä¸ªç½‘é¡µä¸­æœ€é‡è¦çš„å°±æ˜¯å†…å®¹ï¼Œæ‰€ä»¥ä¸€å®šè¦è®©å†…å®¹çš„å±‚å é¡ºåºç›¸å½“é«˜ï¼Œè¿™æ ·å¯ä»¥åœ¨å‘ç”Ÿå±‚å æ—¶ï¼Œé‡è¦çš„å›¾ç‰‡ã€æ–‡å­—å†…å®¹å¯ä»¥ä¼˜å…ˆæš´éœ²åœ¨å±å¹•ä¸Šã€‚</p><p><a href="https://segmentfault.com/a/1190000021602879?sort=newest" target="_blank" >é‡å­¦å‰ç«¯ä¹‹ CSS(ä¸‰)BFC ä¸å±‚å ä¸Šä¸‹æ–‡</a></p><h2 id="å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡"><a href="#å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡" class="headerlink" title="å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡"></a>å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡</h2><h3 id="BFC-æ˜¯ä»€ä¹ˆ"><a href="#BFC-æ˜¯ä»€ä¹ˆ" class="headerlink" title="BFC æ˜¯ä»€ä¹ˆ?"></a>BFC æ˜¯ä»€ä¹ˆ?</h3><p>ä¹¦â¾¯è§£é‡Šï¼šBFC(Block Formatting Context)è¿™â¼ä¸ªè‹±â½‚æ‹†è§£</p><ul><li><p><code>Box</code>: CSS å¸ƒå±€çš„åŸºæœ¬å•ä½ï¼ŒBox æ˜¯ CSS å¸ƒå±€çš„å¯¹è±¡å’ŒåŸºæœ¬å•ä½ï¼Œ ç›´è§‚ç‚¹æ¥è¯´ï¼Œå°±æ˜¯â¼€ä¸ªâ»šâ¾¯æ˜¯ç”±å¾ˆå¤šä¸ª Box ç»„æˆçš„ï¼Œå®é™…å°±æ˜¯ä¸Šä¸ªé—®é¢˜è¯´çš„ç›’æ¨¡å‹</p></li><li><p><code>Formatting context</code>ï¼šå—çº§ä¸Šä¸‹â½‚æ ¼å¼åŒ–ï¼Œå®ƒæ˜¯â»šâ¾¯ä¸­çš„â¼€å—æ¸²æŸ“åŒºåŸŸï¼Œå¹¶ä¸”æœ‰â¼€å¥—æ¸²æŸ“è§„åˆ™ï¼Œå®ƒå†³å®šäº†å…¶â¼¦å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œâ½¤</p><p><code>ç®€â½½â¾”ä¹‹ï¼Œå®ƒæ˜¯â¼€å—ç‹¬â½´çš„åŒºåŸŸï¼Œè®©å¤„äº BFC å†…éƒ¨çš„å…ƒç´ ä¸å¤–éƒ¨çš„å…ƒç´ äº’ç›¸éš”ç¦»</code></p></li></ul><h3 id="å¦‚ä½•å½¢æˆ"><a href="#å¦‚ä½•å½¢æˆ" class="headerlink" title="å¦‚ä½•å½¢æˆ?"></a>å¦‚ä½•å½¢æˆ?</h3><p>BFC è§¦å‘æ¡ä»¶:</p><ul><li><code>æ ¹å…ƒç´ </code>ï¼Œå³ HTML å…ƒç´ </li><li><code>float</code> ä¸ä¸º none</li><li><code>display</code> çš„å€¼ä¸º inline-blockã€table-cellã€table-caption(è¡¨æ ¼æ ‡é¢˜)</li><li><code>position</code>: fixed&#x2F;absolute</li><li><code>overflow</code> ä¸ä¸º visible</li></ul><h3 id="BFC-ç‰¹ç‚¹"><a href="#BFC-ç‰¹ç‚¹" class="headerlink" title="BFC ç‰¹ç‚¹"></a>BFC ç‰¹ç‚¹</h3><p><a href="https://www.shuzhiduo.com/A/qVdeBaYAzP/#:~:text=auto%E3%80%81hidden%E3%80%81scroll-,BFC%E7%9A%84%E7%89%B9%E7%82%B9,-1%E3%80%81%E5%9C%A8%E4%B8%80%E4%B8%AA" target="_blank" >BFC çš„ç‰¹ç‚¹</a></p><ul><li>1ã€åœ¨ä¸€ä¸ª BFC å†…éƒ¨ï¼Œ<code>ç›’å­ä¼šåœ¨å‚ç›´æ–¹å‘ä¸Šæ’åˆ—</code></li><li>2ã€åœ¨ä¸€ä¸ª BFC å†…éƒ¨ï¼Œ<code>ç›¸é‚»çš„ margin-bottom å’Œ margin-top å åŠ </code></li><li>3ã€åœ¨ä¸€ä¸ª BFC å†…éƒ¨ï¼Œ<code>æ¯ä¸ªå…ƒç´ å·¦è¾¹ç´§è´´ç€åŒ…å«ç›’å­çš„å·¦è¾¹</code></li><li>4ã€åœ¨ä¸€ä¸ª BFC å†…éƒ¨ï¼Œ<code>å¦‚æœæœ‰ä¸€ä¸ªå†…éƒ¨å…ƒç´ æ˜¯ä¸€ä¸ªæ–°çš„ BFCï¼Œåˆ™æ–° BFC åŒºåŸŸä¸ä¼šä¸ float å…ƒç´ çš„åŒºåŸŸé‡å </code></li><li>5ã€è®¡ç®—ä¸€ä¸ª BFC é«˜åº¦æ—¶ï¼Œ<code>å†…éƒ¨æµ®åŠ¨å…ƒç´ çš„é«˜åº¦ä¹Ÿä¼šå‚ä¸è®¡ç®—</code></li></ul><h3 id="ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>é˜²â½Œ <code>marginé‡å </code></li><li>ä¸¤æ å¸ƒå±€ï¼Œé˜²â½Œ<code>â½‚å­—ç¯ç»•</code>ç­‰</li><li>é˜²â½Œ<code>å…ƒç´ å¡Œé™·</code></li></ul><h2 id="ç›’æ¨¡å‹"><a href="#ç›’æ¨¡å‹" class="headerlink" title="ç›’æ¨¡å‹"></a>ç›’æ¨¡å‹</h2><p>ç›’æ¨¡å‹ç”± contentï¼ˆå†…å®¹ï¼‰ã€paddingï¼ˆå†…è¾¹è·ï¼‰ã€borderï¼ˆè¾¹æ¡†ï¼‰ã€marginï¼ˆå¤–è¾¹è·ï¼‰ç»„æˆã€‚</p><h3 id="æ ‡å‡†ç›’æ¨¡å‹-x2F-æ€ªå¼‚ç›’æ¨¡å‹"><a href="#æ ‡å‡†ç›’æ¨¡å‹-x2F-æ€ªå¼‚ç›’æ¨¡å‹" class="headerlink" title="æ ‡å‡†ç›’æ¨¡å‹&#x2F;æ€ªå¼‚ç›’æ¨¡å‹"></a>æ ‡å‡†ç›’æ¨¡å‹&#x2F;æ€ªå¼‚ç›’æ¨¡å‹</h3><p>åœ¨ W3C æ ‡å‡†ä¸‹ï¼Œæˆ‘ä»¬å®šä¹‰å…ƒç´ çš„ width å€¼å³ä¸ºç›’æ¨¡å‹ä¸­çš„ content çš„å®½åº¦å€¼ï¼Œheight å€¼å³ä¸ºç›’æ¨¡å‹ä¸­çš„ content çš„â¾¼åº¦å€¼ã€‚ å› æ­¤ï¼Œ</p><p><strong>æ ‡å‡†ç›’æ¨¡å‹ä¸‹ï¼š</strong></p><p><code>å…ƒç´ çš„å®½åº¦ = margin-left + border-left + padding-left + width + padding-right + border-right + margin-right</code></p><img src="http://t-blog-images.aijs.top/img/20220718000736.png" /><p><strong>IE æ€ªå¼‚ç›’æ¨¡å‹</strong></p><p>ï¼ˆIE8 ä»¥ä¸‹ï¼‰width çš„å®½åº¦å¹¶ä¸æ˜¯ content çš„å®½åº¦ï¼Œâ½½æ˜¯</p><p><code>å…ƒç´ çš„å®½åº¦ = margin-left + width + margin-right</code></p><p>å¯¹äº width,</p><p><code>width = border-left + padding-left + content çš„å®½åº¦å€¼ + padding-right + border-right</code>ï¼Œheight åŒç†ã€‚</p><img src="http://t-blog-images.aijs.top/img/20220718000754.png" /><p><code>ç°ä»£æµè§ˆå™¨é»˜è®¤ä½¿â½¤ W3C çš„æ ‡å‡†ç›’æ¨¡å‹</code>ï¼Œåœ¨ä¸å°‘æƒ…å†µä¸‹æ€ªå¼‚ç›’æ¨¡å‹æ›´å¥½â½¤ï¼Œäºæ˜¯ W3C åœ¨ css3 ä¸­åŠ â¼Š <code>box-sizing</code> ã€‚</p><p><code>box-sizing: content-box</code> &#x2F;&#x2F; æ ‡å‡†ç›’æ¨¡å‹<br><code>box-sizing: border-box</code> &#x2F;&#x2F; æ€ªå¼‚ç›’æ¨¡å‹<br><code>box-sizing: padding-box</code> &#x2F;&#x2F; â½•ç‹çš„ç§æœ‰æ¨¡å‹ï¼Œæ²¡â¼ˆâ½¤</p><h2 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h2><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªï¼Œä¸¤ä¸ªæˆ–ä¸‰ä¸ªå€¼æ¥æŒ‡å®š flex å±æ€§ã€‚</p><h3 id="none"><a href="#none" class="headerlink" title="none"></a>none</h3><p>å…ƒç´ ä¼šæ ¹æ®è‡ªèº«å®½é«˜æ¥è®¾ç½®å°ºå¯¸ã€‚å®ƒæ˜¯å®Œå…¨éå¼¹æ€§çš„ï¼š<span style="color: red">æ—¢ä¸ä¼šç¼©çŸ­ï¼Œä¹Ÿä¸ä¼šä¼¸é•¿</span> æ¥é€‚åº” flex å®¹å™¨ã€‚ç›¸å½“äºå°†å±æ€§è®¾ç½®ä¸º<code>&quot;flex: 0 0 auto&quot;</code>ã€‚</p>  <br/>  <br/><h3 id="initial"><a href="#initial" class="headerlink" title="initial"></a>initial</h3><p>å…ƒç´ ä¼šæ ¹æ®è‡ªèº«å®½é«˜è®¾ç½®å°ºå¯¸ã€‚å®ƒ <span style="color: red">ä¼šç¼©çŸ­è‡ªèº«ä»¥é€‚åº” flex å®¹å™¨ï¼Œä½†ä¸ä¼šä¼¸é•¿å¹¶å¸æ”¶ </span> flex å®¹å™¨ä¸­çš„é¢å¤–è‡ªç”±ç©ºé—´æ¥é€‚åº” flex å®¹å™¨ ã€‚ç›¸å½“äºå°†å±æ€§è®¾ç½®ä¸º<code>&quot;flex: 0 1 auto&quot;</code>ã€‚<br><br/><br><br/></p><h3 id="auto"><a href="#auto" class="headerlink" title="auto"></a>auto</h3><p>å…ƒç´ ä¼šæ ¹æ®è‡ªèº«çš„å®½åº¦ä¸é«˜åº¦æ¥ç¡®å®šå°ºå¯¸ï¼Œä½†æ˜¯ <span style="color: red">ä¼šä¼¸é•¿å¹¶å¸æ”¶ flex å®¹å™¨ä¸­é¢å¤–çš„è‡ªç”±ç©ºé—´ï¼Œä¹Ÿä¼šç¼©çŸ­è‡ªèº«æ¥é€‚åº”</span> flex å®¹å™¨ã€‚è¿™ç›¸å½“äºå°†å±æ€§è®¾ç½®ä¸º <code>&quot;flex: 1 1 auto&quot;</code>.</p><h3 id="å•å€¼è¯­æ³•"><a href="#å•å€¼è¯­æ³•" class="headerlink" title="å•å€¼è¯­æ³•:"></a>å•å€¼è¯­æ³•:</h3><p>å€¼å¿…é¡»ä¸ºä»¥ä¸‹å…¶ä¸­ä¹‹ä¸€:</p><ul><li>ä¸€ä¸ªæ— å•ä½æ•°(<code>&lt;number&gt;</code>): å®ƒä¼šè¢«å½“ä½œ flex:<code>&lt;number&gt;</code> 1 0; è§£é‡Šï¼š<code>&lt;flex-shrink&gt;</code>çš„å€¼è¢«å‡å®šä¸º 1ï¼Œç„¶å<code>&lt;flex-basis&gt;</code> çš„å€¼è¢«å‡å®šä¸º 0ã€‚</li><li>ä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦(width)å€¼: å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-basis&gt;</code>çš„å€¼ã€‚</li><li>å…³é”®å­— noneï¼Œauto æˆ– initial.</li></ul><h3 id="åŒå€¼è¯­æ³•"><a href="#åŒå€¼è¯­æ³•" class="headerlink" title="åŒå€¼è¯­æ³•:"></a>åŒå€¼è¯­æ³•:</h3><p>ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-grow&gt;</code> çš„å€¼ã€‚ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä»¥ä¸‹ä¹‹ä¸€ï¼š</p><ul><li>æ— å•ä½æ•°ï¼šå®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-shrink&gt;</code> çš„å€¼ã€‚</li><li>æœ‰æ•ˆçš„å®½åº¦å€¼: å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-basis&gt;</code> çš„å€¼ã€‚</li></ul><h3 id="ä¸‰å€¼è¯­æ³•"><a href="#ä¸‰å€¼è¯­æ³•" class="headerlink" title="ä¸‰å€¼è¯­æ³•:"></a>ä¸‰å€¼è¯­æ³•:</h3><ul><li>ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-grow&gt;</code> çš„å€¼ã€‚</li><li>ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-shrink&gt;</code> çš„å€¼ã€‚</li><li>ç¬¬ä¸‰ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼ï¼Œ å¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-basis&gt;</code> çš„å€¼ã€‚</li></ul><p><a href="http://v.aijs.top/post/2022-05-23width0" target="_blank" >è§</a></p><h2 id="åª’ä½“æŸ¥è¯¢"><a href="#åª’ä½“æŸ¥è¯¢" class="headerlink" title="åª’ä½“æŸ¥è¯¢"></a>åª’ä½“æŸ¥è¯¢</h2><p><a href="https://www.cnblogs.com/xiaohuochai/p/5848612.html" target="_blank" >æ·±å…¥ç†è§£ CSS Media åª’ä½“æŸ¥è¯¢</a></p><h3 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h3><p>åª’ä½“æŸ¥è¯¢åŒ…å«â¼€ä¸ªå¯é€‰çš„åª’ä½“ç±»å‹å’Œï¼Œæ»¡â¾œ CSS3 è§„èŒƒçš„æ¡ä»¶ä¸‹ï¼ŒåŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ï¼Œè¿™äº›è¡¨è¾¾å¼æè¿°äº†åª’ä½“ç‰¹å¾ï¼Œæœ€ç»ˆä¼šè¢«è§£æä¸º true æˆ– falseã€‚å¦‚æœåª’ä½“æŸ¥è¯¢ä¸­æŒ‡å®šçš„åª’ä½“ç±»å‹åŒ¹é…å±•ç¤ºâ½‚æ¡£æ‰€ä½¿â½¤çš„è®¾å¤‡ç±»å‹ï¼Œå¹¶ä¸”æ‰€æœ‰çš„è¡¨è¾¾å¼ çš„å€¼éƒ½æ˜¯ trueï¼Œé‚£ä¹ˆè¯¥åª’ä½“æŸ¥è¯¢çš„ç»“æœä¸º true.é‚£ä¹ˆåª’ä½“æŸ¥è¯¢å†…çš„æ ·å¼å°†ä¼šâ½£æ•ˆã€‚<br>åª’ä½“æŸ¥è¯¢ï¼Œç”¨äº<code>å“åº”é€‚é…</code>ã€‚</p><h3 id="å¦‚ä½•ä½¿â½¤ï¼Ÿ"><a href="#å¦‚ä½•ä½¿â½¤ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä½¿â½¤ï¼Ÿ"></a>å¦‚ä½•ä½¿â½¤ï¼Ÿ</h3><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>åª’ä½“å±æ€§å¿…é¡»ç”¨æ‹¬å·()åŒ…èµ·æ¥ï¼Œå¦åˆ™æ— æ•ˆ</p></div><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;!-- linkå…ƒç´ ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ --&gt;&lt;link rel&#x3D;&quot;stylesheet&quot; media&#x3D;&quot;(max-width: 800px)&quot; href&#x3D;&quot;example.css&quot; &#x2F;&gt;&lt;!-- æ ·å¼è¡¨ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ --&gt;&lt;style&gt;  @media (max-width: 600px) &#123;    .facet_sidebar &#123;      display: none;    &#125;  &#125;&lt;&#x2F;style&gt;</code></pre><h3 id="å¸¸è§åª’ä½“å±æ€§"><a href="#å¸¸è§åª’ä½“å±æ€§" class="headerlink" title="å¸¸è§åª’ä½“å±æ€§"></a>å¸¸è§åª’ä½“å±æ€§</h3><ul><li><p>è®¾å¤‡å®½é«˜æ¯”ï¼ˆdevice-aspect-ratioï¼‰</p></li><li><p>è®¾å¤‡é«˜åº¦ï¼ˆdevice-heightï¼‰</p></li><li><p>è®¾å¤‡å®½åº¦ï¼ˆdevice-widthï¼‰</p></li><li><p>æ–¹å‘ï¼ˆorientationï¼‰å€¼ï¼šlandscape(æ¨ªå±) | portrait(ç«–å±)</p></li><li><p>åˆ†è¾¨ç‡ï¼ˆresolutionï¼‰åƒç´ å¯†åº¦</p></li></ul><h3 id="print-x2F-screen"><a href="#print-x2F-screen" class="headerlink" title="print&#x2F;screen"></a>print&#x2F;screen</h3><p>ä¸ç”¨æ‹¬å·</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;style.css&quot; media&#x3D;&quot;print&quot; &#x2F;&gt;&lt;style&gt;  @media print &#123;  &#125;&lt;&#x2F;style&gt;</code></pre><h3 id="é€»è¾‘æ“ä½œç¬¦"><a href="#é€»è¾‘æ“ä½œç¬¦" class="headerlink" title="é€»è¾‘æ“ä½œç¬¦"></a>é€»è¾‘æ“ä½œç¬¦</h3><p>æ“ä½œç¬¦ notã€andã€only å’Œé€—å·(,)å¯ä»¥ç”¨æ¥æ„å»ºå¤æ‚çš„åª’ä½“æŸ¥è¯¢</p><h3 id="ç›¸å¯¹å•ä½"><a href="#ç›¸å¯¹å•ä½" class="headerlink" title="ç›¸å¯¹å•ä½"></a>ç›¸å¯¹å•ä½</h3><p>å¦‚æœåª’ä½“æŸ¥è¯¢@media ä½¿ç”¨çš„æ˜¯ç›¸å¯¹å•ä½ï¼Œ<span style="color: red">å¦‚ remï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå‘éœ€è¦ç€é‡å¼ºè°ƒä¸€ä¸‹</span></p><p><span style="color: red">ä¸€èˆ¬è€Œè¨€ï¼Œrem æ˜¯ç›¸å¯¹äº HTML çš„å­—ä½“å¤§å°çš„ã€‚ä½†æ˜¯ï¼Œç”±äºåª’ä½“æŸ¥è¯¢çš„çº§åˆ«éå¸¸é«˜ï¼Œå®ƒå¹¶ä¸æ˜¯ HTML çš„å­å…ƒç´ ï¼Œä¸æ˜¯ç›¸å¯¹äº HTMLï¼Œè€Œæ˜¯ç›¸å¯¹äºæµè§ˆå™¨çš„ï¼Œè€Œæµè§ˆå™¨çš„é»˜è®¤å­—ä½“å¤§å°æ˜¯ 16px</span></p><p>å¦‚æœ HTML è®¾ç½®å­—ä½“å¤§å°ä¸º 12pxï¼Œè®¾ç½®å¦‚ä¸‹åª’ä½“æŸ¥è¯¢</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">media&#x3D;&quot;only screen and (max-width:1rem)&quot;</code></pre><p>å®é™…ä¸Šï¼Œmax-width ç­‰äº 16pxï¼Œè€Œä¸æ˜¯ 12px</p><p>è€Œæ­£æ˜¯<code>ç”±äºåª’ä½“æŸ¥è¯¢æ˜¯ç›¸å¯¹äºæµè§ˆå™¨çš„</code>ï¼Œ æ‰€ä»¥ä½¿ç”¨ rem å°±æ²¡æœ‰å¿…è¦ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ em æ¥æ›¿ä»£</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">media&#x3D;&quot;only screen and (max-width:1em)&quot;</code></pre><h2 id="å›æµå’Œé‡ç»˜"><a href="#å›æµå’Œé‡ç»˜" class="headerlink" title="å›æµå’Œé‡ç»˜"></a>å›æµå’Œé‡ç»˜</h2><h3 id="æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶"><a href="#æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶"></a>æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶</h3><p><span style="color: red">æµè§ˆå™¨é‡‡ç”¨æµå¼å¸ƒå±€</span><br>æµè§ˆå™¨ä¼šæŠŠ HTML è§£ææˆ DOMï¼ŒæŠŠ CSS è§£ææˆ CSSOMï¼ŒDOM å’Œ CSSOM åˆå¹¶å°±å½¢æˆæ¸²æŸ“æ ‘<br>æœ‰äº†æ¸²æŸ“æ ‘ï¼Œæˆ‘ä»¬å°±çŸ¥é“æ‰€æœ‰èŠ‚ç‚¹çš„æ ·å¼ï¼Œç„¶åè®¡ç®—ä»–ä»¬åœ¨é¡µé¢ä¸Šçš„å¤§å°å’Œä½ç½®ï¼ŒæŠŠå®ƒä»¬ç»˜åˆ¶åˆ°é¡µé¢ä¸Š</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æ³¨æ„ï¼šæµè§ˆå™¨é‡‡ç”¨æµå¼å¸ƒå±€ï¼Œå¯¹æ¸²æŸ“æ ‘çš„è®¡ç®—åªéœ€è¦éå†ä¸€æ¬¡å°±èƒ½å®Œæˆï¼Œ<span style="color: red">ä½† table å¸ƒå±€é™¤å¤–ï¼Œä»–éœ€è¦èŠ±è´¹ 3 å€çš„æ—¶é—´</span> ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½é‡é¿å…ä½¿ç”¨ table å¸ƒå±€</p></blockquote><h3 id="å›æµ"><a href="#å›æµ" class="headerlink" title="å›æµ"></a>å›æµ</h3><ul><li><code>å½±å“éƒ¨åˆ†æˆ–å…¨éƒ¨é¡µé¢çš„å¸ƒå±€æ—¶ï¼Œä¼šè¿›è¡Œå›æµ</code>ï¼Œå›æµçš„ä»£ä»·æ¯”é‡ç»˜é«˜</li><li><code>å›æµä¸€å®šä¼šå¼•èµ·é‡ç»˜ï¼Œä½†é‡ç»˜ä¸ä¸€å®šä¼šå¼•èµ·å›æµ</code></li></ul><h3 id="é‡ç»˜"><a href="#é‡ç»˜" class="headerlink" title="é‡ç»˜"></a>é‡ç»˜</h3><p>å…ƒç´ æ ·å¼å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯<code>ä¸å½±å“é¡µé¢æ•´ä¸ªå¸ƒå±€çš„æƒ…å†µä¸‹ä¼šè¿›è¡Œé‡ç»˜</code>ï¼Œå¦‚ outlineã€visibilityã€colorã€background-color ç­‰</p><h3 id="æµè§ˆå™¨ä¼˜åŒ–"><a href="#æµè§ˆå™¨ä¼˜åŒ–" class="headerlink" title="æµè§ˆå™¨ä¼˜åŒ–"></a>æµè§ˆå™¨ä¼˜åŒ–</h3><p>æµè§ˆå™¨æ˜¯<code>é€šè¿‡é˜Ÿåˆ—æœºåˆ¶æ¥æ‰¹é‡æ›´æ–°å¸ƒå±€</code>ï¼Œæµè§ˆå™¨åˆ·æ–°é¢‘ç‡ä¸ºï¼ˆ60 å¸§&#x2F;sï¼‰,æ¯åˆ·æ–°ä¸€æ¬¡éœ€è¦ 16.6msï¼Œä¹Ÿå°±æ˜¯è¯´ 16.6ms æµè§ˆå™¨ä¼šæ¸…ç©ºé˜Ÿåˆ—ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬è·å–å¸ƒå±€ä¿¡æ¯çš„æ—¶å€™ï¼Œæœ‰ä¸€äº›å±æ€§æˆ–æ–¹æ³•ä¼šå¼ºåˆ¶æµè§ˆå™¨åˆ·æ–°ï¼Œè§¦å‘é‡ç»˜å’Œå›æµå¹¶ä¸”æ¸…ç©ºé˜Ÿåˆ—ï¼Œæ¯”å¦‚ï¼š</p><ul><li>offset ç³»åˆ—ï¼š<code>offsetTop</code>ã€<code>offsetLeft</code>ã€<code>offsetWidth</code>ã€<code>offsetHeight</code> <a href="https://www.jb51.net/article/219621.htm" target="_blank" >è·ç¦»å…ƒç´ æœ€è¿‘çš„ä¸€ä¸ªå…·æœ‰å®šä½çš„ç¥–å®—å…ƒç´ ï¼ˆrelativeï¼Œabsoluteï¼Œfixedï¼‰ï¼Œè‹¥ç¥–å®—éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼ŒoffsetParent ä¸º body</a></li><li>scroll ç³»åˆ—ï¼š <code>scrollTop</code>ã€<code>scrollLeft</code>ã€<code>scrollWidth</code>ã€<code>scrollHeight</code> <a href="https://blog.csdn.net/muxi229/article/details/106849535" target="_blank" >æ–¹æ³•è¿”å›æˆ–è®¾ç½®åŒ¹é…å…ƒç´ çš„æ»šåŠ¨æ¡çš„åç§»ä½ç½®</a></li><li>client ç³»åˆ—ï¼š<code>clientTop</code>ã€<code>clientLeft</code>ã€<code>clientWidth</code>ã€<code>clientHeight</code> clientTopã€clientLeft è·å–çš„æ˜¯ä¸Šè¾¹æ¡†ã€å·¦è¾¹æ¡†çš„å®½åº¦ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/clientLeft" target="_blank" >è§ MDN</a></li><li><code>width</code>ã€<code>height</code></li><li><code>getComputedStyle()</code> ç”¨äºè·å–æŒ‡å®šå…ƒç´ çš„ CSS æ ·å¼</li><li><code>getBoundingClientRect()</code> ç”¨äºè·å–æŸä¸ªå…ƒç´ ç›¸å¯¹äºè§†çª—çš„ä½ç½®é›†åˆã€‚é›†åˆä¸­æœ‰ top, right, bottom, left ç­‰å±æ€§ã€‚</li></ul><p>å¼ºåˆ¶è§¦å‘æµè§ˆå™¨åˆ·æ–°,æ‰€ä»¥æˆ‘ä»¬è¦å°½é‡å°‘ä½¿ç”¨ä»¥ä¸Šå±æ€§å’Œæ–¹æ³•</p><h3 id="å‡å°‘é‡ç»˜å’Œå›æµ"><a href="#å‡å°‘é‡ç»˜å’Œå›æµ" class="headerlink" title="å‡å°‘é‡ç»˜å’Œå›æµ"></a>å‡å°‘é‡ç»˜å’Œå›æµ</h3><ul><li><code>æ›¿ä»£æ–¹æ¡ˆ</code><br>ä½¿ç”¨ transform ä»£æ›¿ top<br>ä½¿ç”¨ visibility(åªè§¦å‘é‡ç»˜)ä»£æ›¿ display(è§¦å‘å›æµ)</li><li><code>åµŒå¥—å±‚çº§</code><br>å°½å¯èƒ½åœ¨ DOM æ ‘çš„æœ«ç«¯æ”¹å˜æ ·å¼ç±» classï¼Œå½±å“å°½é‡å°‘çš„èŠ‚ç‚¹<br>css é€‰æ‹©å™¨å°½é‡ä¸è¦åµŒå¥—è¿‡æ·±ï¼Œä»å³å¾€å·¦åŒ¹é…</li><li><code>åŠ¨ç”»</code><br>åŠ¨ç”»æ•ˆæœæœ€å¥½æ·»åŠ åˆ° <code>positionï¼šabsolute æˆ– fixed çš„å…ƒç´ ä¸Šï¼Œä¸å½±å“å…¶ä»–å…ƒç´ </code>ï¼Œåªå¼•å‘é‡ç»˜ï¼Œä¸å¼•å‘å›æµï¼Œæ§åˆ¶åŠ¨ç”»çš„é€Ÿåº¦å¯ä»¥ä½¿ç”¨ <code>requestAnimationFrame()</code></li><li><code>css è¡¨è¾¾å¼</code><br>é¿å…ä½¿ç”¨ css è¡¨è¾¾å¼ï¼Œcalc()ä¼šå¼•å‘å›æµ</li><li><code>è®¾ä¸ºå›¾å±‚</code><br>å°†é¢‘ç¹é‡ç»˜æˆ–å›æµçš„èŠ‚ç‚¹è®¾ç½®ä¸ºå›¾å±‚ï¼Œå¦‚ï¼šwill-changeï¼Œvideoï¼Œiframeï¼Œcavasï¼Œé˜²æ­¢å½±å“åˆ«çš„èŠ‚ç‚¹</li><li><code>CSS3 ç¡¬ä»¶åŠ é€Ÿ</code>ï¼Œtransformï¼Œopacity ç­‰ä¸ä¼šå¼•èµ·å›æµé‡ç»˜</li><li>æ‰¹é‡æ“ä½œä½¿ç”¨ documentFragment,æ‰¹é‡æ›´æ–°ï¼Œè™šæ‹Ÿ dom</li></ul><p><a href="https://www.jianshu.com/p/bf5c498107e2" target="_blank" >å‚è€ƒé“¾æ¥</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.zhangxinxu.com/wordpress/2016/01/understand-css3-isolation-isolate/" target="_blank" >æ·±å…¥ç ”ç©¶-webkit-overflow-scrolling:touch åŠ ios æ»šåŠ¨ </a></p><p><a href="https://blog.csdn.net/weixin_30607659/article/details/101594118" target="_blank" >CSS 7 é˜¶å±‚å æ°´å¹³</a></p><p><a href="https://www.shuzhiduo.com/A/qVdeBaYAzP/#:~:text=auto%E3%80%81hidden%E3%80%81scroll-,BFC%E7%9A%84%E7%89%B9%E7%82%B9,-1%E3%80%81%E5%9C%A8%E4%B8%80%E4%B8%AA" target="_blank" >BFC çš„ç‰¹ç‚¹</a></p><p><a href="https://www.cnblogs.com/xiaohuochai/p/5848612.html" target="_blank" >æ·±å…¥ç†è§£ CSS Media åª’ä½“æŸ¥è¯¢</a></p><p><a href="http://v.aijs.top/post/2022-05-23width0" target="_blank" >flex width:0</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-html</title>
      <link href="//post/2022-07-17html.html"/>
      <url>//post/2022-07-17html.html</url>
      
        <content type="html"><![CDATA[<h2 id="doctype-çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#doctype-çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="doctype çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ"></a>doctype çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><code>DOCTYPE</code> æ˜¯ html5 æ ‡å‡†â½¹â»šå£°æ˜ï¼Œä¸”å¿…é¡»å£°æ˜åœ¨ HTML â½‚æ¡£çš„ç¬¬â¼€â¾ã€‚</p><p><code>æ¥å‘ŠçŸ¥æµè§ˆå™¨çš„è§£æå™¨â½¤ä»€ä¹ˆâ½‚æ¡£æ ‡å‡†è§£æè¿™ä¸ªâ½‚æ¡£</code>ï¼Œä¸åŒçš„æ¸²æŸ“æ¨¡å¼ä¼šå½±å“åˆ°æµè§ˆå™¨å¯¹äº CSS ä»£ç ç”šâ¾„ JavaScript è„šæœ¬çš„è§£æ</p><p><strong>â½‚æ¡£è§£æç±»å‹æœ‰ï¼š</strong></p><ul><li>BackCompatï¼š<code>æ€ªå¼‚æ¨¡å¼</code>ï¼Œæµè§ˆå™¨ä½¿â½¤â¾ƒâ¼°çš„æ€ªå¼‚æ¨¡å¼è§£ææ¸²æŸ“â»šâ¾¯ã€‚ï¼ˆå¦‚æœæ²¡æœ‰å£°æ˜ DOCTYPEï¼Œé»˜è®¤å°±æ˜¯è¿™ä¸ª æ¨¡å¼ï¼‰</li><li>CSS1Compatï¼š<code>æ ‡å‡†æ¨¡å¼</code>ï¼Œæµè§ˆå™¨ä½¿â½¤ W3C çš„æ ‡å‡†è§£ææ¸²æŸ“â»šâ¾¯ã€‚</li></ul><h2 id="è¿™ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è¿™ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è¿™ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è¿™ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li><code>æ ‡å‡†æ¨¡å¼(standards mode)</code>ï¼šâ»šâ¾¯æŒ‰ç…§ HTML ä¸ CSS çš„å®šä¹‰æ¸²æŸ“</li><li><code>æ€ªå¼‚æ¨¡å¼(quirks mode)æ¨¡å¼</code>ï¼š ä¼šæ¨¡æ‹Ÿæ›´æ—§çš„æµè§ˆå™¨çš„â¾ä¸º</li><li><code>è¿‘ä¹æ ‡å‡†(almost standards)æ¨¡å¼</code>ï¼š ä¼šå®æ–½äº†â¼€ç§è¡¨å•å…ƒæ ¼å°ºâ¼¨çš„æ€ªå¼‚â¾ä¸ºï¼ˆä¸ IE7 ä¹‹å‰çš„å•å…ƒæ ¼å¸ƒå±€â½…å¼â¼€è‡´ï¼‰ï¼Œ é™¤æ­¤ä¹‹å¤–ç¬¦åˆæ ‡å‡†å®šä¹‰</li></ul><h2 id="HTMLã€XHTMLã€XML-æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#HTMLã€XHTMLã€XML-æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="HTMLã€XHTMLã€XML æœ‰ä»€ä¹ˆåŒºåˆ«"></a>HTMLã€XHTMLã€XML æœ‰ä»€ä¹ˆåŒºåˆ«</h2><ul><li><code>HTML(è¶…â½‚æœ¬æ ‡è®°è¯­â¾”)</code>: åœ¨ <code>html4.0 </code>ä¹‹å‰ HTML å…ˆæœ‰å®ç°å†æœ‰æ ‡å‡†ï¼Œå¯¼è‡´ HTML â¾®å¸¸æ··ä¹±å’Œæ¾æ•£</li><li><code>XML(å¯æ‰©å±•æ ‡è®°è¯­â¾”)</code>: ä¸»è¦<code>â½¤äºå­˜å‚¨æ•°æ®å’Œç»“æ„</code>ï¼Œå¯æ‰©å±•ï¼Œâ¼¤å®¶ç†Ÿæ‚‰çš„ JSON ä¹Ÿæ˜¯ç›¸ä¼¼çš„ä½œâ½¤ï¼Œä½†æ˜¯æ›´åŠ è½»é‡â¾¼ æ•ˆï¼Œæ‰€ä»¥ XML ç°åœ¨å¸‚åœºè¶Šæ¥è¶Šâ¼©äº†</li><li><code>XHTML(å¯æ‰©å±•è¶…â½‚æœ¬æ ‡è®°è¯­â¾”)</code>: åŸºäºä¸Šâ¾¯ä¸¤è€…â½½æ¥ï¼ŒW3C ä¸ºäº†è§£å†³ HTML æ··ä¹±é—®é¢˜â½½â½£ï¼Œå¹¶<code>åŸºäºæ­¤è¯â½£äº† HTML5</code>ï¼Œå¼€å¤´åŠ â¼Š <code>&lt;!DOCTYPE html&gt;</code> çš„åšæ³•å› æ­¤â½½æ¥ï¼Œå¦‚æœä¸åŠ å°±æ˜¯å…¼å®¹æ··ä¹±çš„ HTMLï¼ŒåŠ äº†å°±æ˜¯æ ‡å‡†æ¨¡å¼ã€‚</li></ul><h2 id="ä»€ä¹ˆæ˜¯-data-å±æ€§ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-data-å±æ€§ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ data-å±æ€§ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ data-å±æ€§ï¼Ÿ</h2><p>HTML çš„æ•°æ®å±æ€§ï¼Œâ½¤äºå°†æ•°æ®å‚¨å­˜äºæ ‡å‡†çš„ HTML å…ƒç´ ä¸­ä½œä¸ºé¢å¤–ä¿¡æ¯,<code>å¯ä»¥é€šè¿‡ js è®¿é—®å¹¶æ“ä½œå®ƒï¼Œæ¥è¾¾åˆ°æ“ä½œæ•°æ®çš„â½¬çš„</code>ã€‚</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;article  id&#x3D;&quot;electriccars&quot;  data-columns&#x3D;&quot;3&quot;  data-index-number&#x3D;&quot;12314&quot;  data-parent&#x3D;&quot;cars&quot;&gt;  ...&lt;&#x2F;article&gt;</code></pre><h2 id="ä½ å¯¹-HTML-è¯­ä¹‰åŒ–çš„ç†è§£ï¼Ÿ"><a href="#ä½ å¯¹-HTML-è¯­ä¹‰åŒ–çš„ç†è§£ï¼Ÿ" class="headerlink" title="ä½ å¯¹ HTML è¯­ä¹‰åŒ–çš„ç†è§£ï¼Ÿ"></a>ä½ å¯¹ HTML è¯­ä¹‰åŒ–çš„ç†è§£ï¼Ÿ</h2><p>è¯­ä¹‰åŒ–æ˜¯æŒ‡ä½¿â½¤æ°å½“è¯­ä¹‰çš„ html æ ‡ç­¾ï¼Œè®©â»šâ¾¯å…·æœ‰è‰¯å¥½çš„ç»“æ„ä¸å«ä¹‰ï¼Œâ½å¦‚ <code>&lt;p&gt;</code> æ ‡ç­¾å°±ä»£è¡¨æ®µè½ï¼Œ <code>&lt;article&gt;</code> ä»£è¡¨æ­£â½‚ å†…å®¹ç­‰ç­‰ã€‚ è¯­ä¹‰åŒ–çš„å¥½å¤„ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š</p><ul><li>å¼€å‘è€…å‹å¥½ï¼šä½¿â½¤è¯­ä¹‰ç±»æ ‡ç­¾å¢å¼ºäº†å¯è¯»æ€§ï¼Œå¼€å‘è€…ä¹Ÿèƒ½å¤Ÿæ¸…æ™°åœ°çœ‹å‡ºâ½¹â»šçš„ç»“æ„ï¼Œä¹Ÿæ›´ä¸ºä¾¿äºå›¢é˜Ÿçš„å¼€å‘å’Œç»´æŠ¤</li><li>æœºå™¨å‹å¥½ï¼šå¸¦æœ‰è¯­ä¹‰çš„â½‚å­—è¡¨ç°â¼’ä¸°å¯Œï¼Œ<code>æ›´é€‚åˆæœç´¢å¼•æ“çš„çˆ¬â¾çˆ¬å–æœ‰æ•ˆä¿¡æ¯</code>ï¼Œè¯­ä¹‰ç±»è¿˜å¯ä»¥<code>â½€æŒè¯»å±è½¯ä»¶</code>ï¼Œæ ¹æ® â½‚ç« å¯ä»¥â¾ƒåŠ¨â½£æˆâ½¬å½• è¿™å¯¹äºç®€ä¹¦ã€çŸ¥ä¹è¿™ç§å¯Œâ½‚æœ¬ç±»çš„åº”â½¤å¾ˆé‡è¦ï¼Œè¯­ä¹‰åŒ–å¯¹äºå…¶â½¹ç«™çš„å†…å®¹ä¼ æ’­æœ‰å¾ˆâ¼¤çš„å¸®åŠ©</li></ul><h2 id="æœ‰å“ªäº›å¸¸â½¤çš„-meta-æ ‡ç­¾ï¼Ÿ"><a href="#æœ‰å“ªäº›å¸¸â½¤çš„-meta-æ ‡ç­¾ï¼Ÿ" class="headerlink" title="æœ‰å“ªäº›å¸¸â½¤çš„ meta æ ‡ç­¾ï¼Ÿ"></a>æœ‰å“ªäº›å¸¸â½¤çš„ meta æ ‡ç­¾ï¼Ÿ</h2><p>meta æ ‡ç­¾ç”±<code>name</code>å’Œ<code>content</code>ä¸¤ä¸ªå±æ€§æ¥å®šä¹‰ï¼Œæ¥æè¿°â¼€ä¸ª HTML â½¹â»šâ½‚æ¡£çš„å±æ€§ï¼Œä¾‹å¦‚<code>ä½œè€…</code>ã€<code>â½‡æœŸå’Œæ—¶é—´</code>ã€<code>â½¹â»šæè¿°</code>ã€ <code>å…³é”®è¯</code>ã€<code>â»šâ¾¯åˆ·æ–°</code>ç­‰ï¼Œé™¤äº†â¼€äº› http æ ‡å‡†è§„å®šäº†â¼€äº› name ä½œä¸ºâ¼¤å®¶ä½¿â½¤çš„å…±è¯†ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥â¾ƒå®šä¹‰ nameã€‚</p><p><code>charset</code>ï¼Œâ½¤äºæè¿° HTML â½‚æ¡£çš„ç¼–ç å½¢å¼ <code>&lt;meta charset=&quot;UTF-8&quot; &gt;</code></p><p><code>http-equiv</code><span style="color: red">ï¼ˆhttp ç­‰æ•ˆï¼‰</span>ï¼Œé¡¾åæ€ä¹‰ï¼Œç›¸å½“äº http çš„â½‚ä»¶å¤´ä½œâ½¤,â½å¦‚ä¸‹â¾¯çš„ä»£ç å°±å¯ä»¥è®¾ç½® http çš„ç¼“å­˜è¿‡æœŸâ½‡æœŸ HTML</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;meta http-equiv&#x3D;&quot;expires&quot; content&#x3D;&quot;Wed, 20 Jun 2019 22:33:00 GMT&quot; &#x2F;&gt;</code></pre><p><code>viewport</code>ï¼Œç§»åŠ¨å‰ç«¯æœ€ç†Ÿæ‚‰ä¸è¿‡ï¼ŒWeb å¼€å‘â¼ˆå‘˜å¯ä»¥æ§åˆ¶è§†â¼çš„â¼¤â¼©å’Œâ½ä¾‹</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;meta  name&#x3D;&quot;viewport&quot;  content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1, maximum-scale&#x3D;1, minimum-scale&#x3D;1 &quot;&#x2F;&gt;</code></pre><p><code>apple-mobile-web-app-status-bar-style</code>,å¼€å‘è¿‡ PWA åº”â½¤çš„å¼€å‘è€…åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œä¸ºäº†â¾ƒå®šä¹‰è¯„ä¼°â¼¯å…·æ çš„é¢œâ¾Šã€‚</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;meta  name&#x3D;&quot;apple-mobile-web-app-status-bar-style&quot;  content&#x3D;&quot;black-translucent&quot;&#x2F;&gt;</code></pre><p><code>iphoneXé€‚é…çš„ viewport-fit=cover</code></p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width...... viewport-fit&#x3D;cover&quot; &#x2F;&gt;&lt;style&gt;  @supports (bottom: env(safe-area-inset-bottom)) &#123;    body,    .footerï¼ˆåº•éƒ¨æ ï¼‰ &#123;      padding-bottom: constant(safe-area-inset-bottom);      padding-bottom: env(safe-area-inset-bottom);    &#125;  &#125;&lt;&#x2F;style&gt;</code></pre><h2 id="src-å’Œ-href-çš„åŒºåˆ«ï¼Ÿ"><a href="#src-å’Œ-href-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="src å’Œ href çš„åŒºåˆ«ï¼Ÿ"></a>src å’Œ href çš„åŒºåˆ«ï¼Ÿ</h2><p><code>src æ˜¯æŒ‡å‘å¤–éƒ¨èµ„æºçš„ä½ç½®</code>ï¼ŒæŒ‡å‘çš„å†…å®¹ä¼šåµŒâ¼Šåˆ°â½‚æ¡£ä¸­å½“å‰æ ‡ç­¾æ‰€åœ¨çš„ä½ç½®ï¼Œåœ¨è¯·æ±‚ src èµ„æºæ—¶ä¼šå°†å…¶æŒ‡å‘çš„èµ„æºä¸‹è½½å¹¶åº”â½¤åˆ°â½‚æ¡£å†…ï¼Œå¦‚ js è„šæœ¬ï¼Œimg å›¾â½šå’Œ frame ç­‰å…ƒç´ ã€‚<code>å½“æµè§ˆå™¨è§£æåˆ°è¯¥å…ƒç´ æ—¶ï¼Œä¼šæš‚åœå…¶ä»–èµ„æºçš„ä¸‹è½½å’Œå¤„ç†</code>ï¼ŒæŒ‡å¯¼å°†è¯¥èµ„æºåŠ è½½ã€ç¼–è¯‘ã€æ‰§â¾å®Œæ¯•ï¼Œæ‰€ä»¥â¼€èˆ¬ js è„šæœ¬ä¼šæ”¾åœ¨åº•éƒ¨â½½ä¸æ˜¯å¤´éƒ¨ã€‚</p><p><code>href æ˜¯æŒ‡å‘â½¹ç»œèµ„æºæ‰€åœ¨ä½ç½®ï¼ˆçš„è¶…é“¾æ¥ï¼‰</code>ï¼Œâ½¤æ¥å»ºâ½´å’Œå½“å‰å…ƒç´ æˆ–â½‚æ¡£ä¹‹é—´çš„è¿æ¥ï¼Œå½“æµè§ˆå™¨è¯†åˆ«åˆ°å®ƒä»–æŒ‡å‘çš„ â½‚ä»¶æ—¶ï¼Œå°±ä¼š<code>å¹¶â¾ä¸‹è½½èµ„æº</code>ï¼Œ<code>ä¸ä¼šåœâ½Œå¯¹å½“å‰â½‚æ¡£çš„å¤„ç†</code>ã€‚</p><h2 id="çŸ¥é“-img-çš„-srcset-çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#çŸ¥é“-img-çš„-srcset-çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="çŸ¥é“ img çš„ srcset çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ"></a>çŸ¥é“ img çš„ srcset çš„ä½œâ½¤æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å¯ä»¥è®¾è®¡å“åº”å¼å›¾â½šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿â½¤ä¸¤ä¸ªæ–°çš„å±æ€§ srcset å’Œ sizes æ¥æä¾›æ›´å¤šé¢å¤–çš„èµ„æºå›¾åƒå’Œæç¤ºï¼Œå¸®åŠ©æµè§ˆå™¨é€‰æ‹© æ­£ç¡®çš„â¼€ä¸ªèµ„æºã€‚</p><p><code>srcset</code> å®šä¹‰äº†æˆ‘ä»¬å…è®¸æµè§ˆå™¨é€‰æ‹©çš„å›¾åƒé›†ï¼Œä»¥åŠæ¯ä¸ªå›¾åƒçš„â¼¤â¼©ã€‚</p><p><code>sizes</code> å®šä¹‰äº†â¼€ç»„åª’ä½“æ¡ä»¶ï¼ˆä¾‹å¦‚å±å¹•å®½åº¦ï¼‰å¹¶ä¸”æŒ‡æ˜å½“æŸäº›åª’ä½“æ¡ä»¶ä¸ºçœŸæ—¶ï¼Œä»€ä¹ˆæ ·çš„å›¾â½šå°ºâ¼¨æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p><p>æ‰€ä»¥ï¼Œæœ‰äº†è¿™äº›å±æ€§ï¼Œæµè§ˆå™¨ä¼šï¼š æŸ¥çœ‹è®¾å¤‡å®½åº¦ æ£€æŸ¥ sizes åˆ—è¡¨ä¸­å“ªä¸ªåª’ä½“æ¡ä»¶æ˜¯ç¬¬â¼€ä¸ªä¸ºçœŸ æŸ¥çœ‹ç»™äºˆè¯¥åª’ä½“æŸ¥è¯¢çš„æ§½â¼¤â¼© åŠ è½½ srcset åˆ—è¡¨ä¸­å¼•â½¤çš„æœ€æ¥è¿‘æ‰€é€‰çš„æ§½â¼¤â¼©çš„å›¾åƒ</p><p><code>&lt;picture&gt; </code>å…ƒç´ é€šè¿‡åŒ…å«é›¶æˆ–å¤šä¸ª<code>&lt;source&gt;</code>å…ƒç´ å’Œâ¼€ä¸ª <code>&lt;img&gt; </code>å…ƒç´ æ¥ä¸ºä¸åŒçš„æ˜¾ç¤º&#x2F;è®¾å¤‡åœºæ™¯æä¾›å›¾åƒç‰ˆæœ¬ã€‚æµè§ˆå™¨ä¼šé€‰æ‹©æœ€åŒ¹é…çš„â¼¦ <code>&lt;source&gt; </code>å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…çš„ï¼Œå°±é€‰æ‹© <code>&lt;img&gt;</code> å…ƒç´ çš„ src å±æ€§ä¸­çš„ URLã€‚ç„¶åï¼Œæ‰€é€‰å›¾åƒå‘ˆç° åœ¨<code> &lt;img&gt;</code> å…ƒç´ å æ®çš„ç©ºé—´ä¸­</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;picture&gt;  &lt;source    srcset&#x3D;&quot;&#x2F;media&#x2F;examples&#x2F;surfer-240-200.jpg&quot;    media&#x3D;&quot;(min-width: 800px)&quot;  &#x2F;&gt;  &lt;img src&#x3D;&quot;&#x2F;media&#x2F;examples&#x2F;painted-hand-298-332.jpg&quot; &#x2F;&gt;&lt;&#x2F;picture&gt;</code></pre><h2 id="script-æ ‡ç­¾ä¸­-defer-å’Œ-async-çš„åŒºåˆ«ï¼Ÿ"><a href="#script-æ ‡ç­¾ä¸­-defer-å’Œ-async-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="script æ ‡ç­¾ä¸­ defer å’Œ async çš„åŒºåˆ«ï¼Ÿ"></a>script æ ‡ç­¾ä¸­ defer å’Œ async çš„åŒºåˆ«ï¼Ÿ</h2><ul><li>deferï¼šæµè§ˆå™¨æŒ‡ç¤ºè„šæœ¬åœ¨â½‚æ¡£è¢«è§£æåæ‰§â¾ï¼Œscript è¢«<code>å¼‚æ­¥åŠ è½½</code>åå¹¶<code>ä¸ä¼šâ½´åˆ»æ‰§â¾</code>ï¼Œâ½½æ˜¯<code>ç­‰å¾…â½‚æ¡£è¢«è§£æå®Œæ¯•åæ‰§â¾</code>ã€‚</li><li>asyncï¼š<code>å¼‚æ­¥åŠ è½½</code>è„šæœ¬ï¼ŒåŒºåˆ«æ˜¯<code>è„šæœ¬åŠ è½½å®Œæ¯•åâ½´å³æ‰§â¾</code>ï¼Œè¿™å¯¼è‡´ async å±æ€§ä¸‹çš„è„šæœ¬æ˜¯ä¹±åºçš„ï¼Œå¯¹äº script æœ‰å…ˆåä¾èµ–å…³ç³»çš„æƒ…å†µï¼Œå¹¶ä¸é€‚â½¤ã€‚</li></ul><img src="http://t-blog-images.aijs.top/img/20220717111316.png" style="max-width: 100%; width: 400px" /><h2 id="æœ‰â¼ç§å‰ç«¯å‚¨å­˜çš„â½…å¼ï¼Ÿ"><a href="#æœ‰â¼ç§å‰ç«¯å‚¨å­˜çš„â½…å¼ï¼Ÿ" class="headerlink" title="æœ‰â¼ç§å‰ç«¯å‚¨å­˜çš„â½…å¼ï¼Ÿ"></a>æœ‰â¼ç§å‰ç«¯å‚¨å­˜çš„â½…å¼ï¼Ÿ</h2><p><code>cookies</code>ã€<code>localstorage</code>ã€<code>sessionstorage</code>ã€<code>Web SQL</code>ã€<code>IndexedDB</code> è¿™äº›â½…å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li><p><code>cookies</code>ï¼š<br>ä¼˜ç‚¹: æ˜¯å…¼å®¹æ€§å¥½ï¼Œè¯·æ±‚å¤´â¾ƒå¸¦ cookie â½…ä¾¿ï¼Œ<br>ç¼ºç‚¹: æ˜¯â¼¤â¼©åªæœ‰ 4kï¼Œ â¾ƒåŠ¨è¯·æ±‚å¤´åŠ â¼Š cookie æµªè´¹æµé‡ï¼Œæ¯ä¸ª domain é™åˆ¶ 20 ä¸ª cookie</p></li><li><p><code>localStorage</code>ï¼šHTML5 åŠ â¼Šçš„ä»¥é”®å€¼å¯¹(Key-Value)ä¸ºæ ‡å‡†çš„â½…å¼ï¼Œä¼˜ç‚¹æ˜¯æ“ä½œâ½…ä¾¿ï¼Œæ°¸ä¹…æ€§å‚¨å­˜ï¼ˆé™¤â¾®â¼¿åŠ¨åˆ  é™¤ï¼‰ï¼Œâ¼¤â¼©ä¸º 5Mï¼Œå…¼å®¹ IE8+</p></li><li><p><code>sessionStorage</code>ï¼šä¸ localStorage åŸºæœ¬ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯ sessionStorage å½“â»šâ¾¯å…³é—­åä¼šè¢«æ¸…ç†ï¼Œâ½½ä¸”ä¸ cookieã€ localStorage ä¸åŒï¼Œä»–ä¸èƒ½åœ¨æ‰€æœ‰åŒæºçª—â¼ä¸­å…±äº«ï¼Œæ˜¯ä¼šè¯çº§åˆ«çš„å‚¨å­˜â½…å¼</p></li><li><p><code>Web SQL</code>ï¼š2010 å¹´è¢« W3C åºŸå¼ƒçš„æœ¬åœ°æ•°æ®åº“æ•°æ®å­˜å‚¨â½…æ¡ˆï¼Œä½†æ˜¯ä¸»æµæµè§ˆå™¨ï¼ˆâ½•ç‹é™¤å¤–ï¼‰éƒ½å·²ç»æœ‰äº†ç›¸å…³çš„å® ç°ï¼Œweb sql ç±»ä¼¼äº SQLiteï¼Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„å…³ç³»å‹æ•°æ®åº“ï¼Œâ½¤ sql è¿›â¾æ“ä½œï¼Œå½“æˆ‘ä»¬â½¤ JavaScript æ—¶è¦è¿›â¾è½¬æ¢ï¼Œ è¾ƒä¸ºç¹çã€‚</p></li><li><p><code>IndexedDB</code>ï¼š æ˜¯è¢«æ­£å¼çº³â¼Š HTML5 æ ‡å‡†çš„æ•°æ®åº“å‚¨å­˜â½…æ¡ˆï¼Œå®ƒæ˜¯ NoSQL æ•°æ®åº“ï¼Œâ½¤é”®å€¼å¯¹è¿›â¾å‚¨å­˜ï¼Œå¯ä»¥è¿›â¾å¿« é€Ÿè¯»å–æ“ä½œï¼Œâ¾®å¸¸é€‚åˆ web åœºæ™¯ï¼ŒåŒæ—¶â½¤ JavaScript è¿›â¾æ“ä½œä¼šâ¾®å¸¸â½…ä¾¿ã€‚</p></li></ul><h2 id="ä¸¤ä¸ª-Tab-é¡µé¢çš„é€šä¿¡æ–¹å¼"><a href="#ä¸¤ä¸ª-Tab-é¡µé¢çš„é€šä¿¡æ–¹å¼" class="headerlink" title="ä¸¤ä¸ª Tab é¡µé¢çš„é€šä¿¡æ–¹å¼"></a>ä¸¤ä¸ª Tab é¡µé¢çš„é€šä¿¡æ–¹å¼</h2><p><a href="https://juejin.cn/post/6844903811232825357#heading-4" target="_blank" >å‰ç«¯è·¨é¡µé¢é€šä¿¡</a></p><p>Tab é—´é€šä¿¡å­˜åœ¨ä¸åŒçš„åœºæ™¯ï¼š</p><h3 id="éåŒæºç½‘ç«™"><a href="#éåŒæºç½‘ç«™" class="headerlink" title="éåŒæºç½‘ç«™"></a>éåŒæºç½‘ç«™</h3><ol><li>socket åˆ©ç”¨æœåŠ¡å™¨ä½œä¸ºä¸­ä»‹(<code>éåŒæº</code>) <code>ååŒç¼–è¾‘</code></li><li>ç‚¹å¯¹ç‚¹é€šä¿¡ window.postMessge(<code>éåŒæº</code>)</li><li>iframe ä½œä¸ºåª’ä»‹</li></ol><h3 id="åŒæºç½‘ç«™"><a href="#åŒæºç½‘ç«™" class="headerlink" title="åŒæºç½‘ç«™"></a>åŒæºç½‘ç«™</h3><p><strong>æœåŠ¡å™¨</strong></p><ol start="3"><li>å¹¿æ’­é€šä¿¡ BroadCast Channelã€Service Workerã€LocalStorage</li><li>è½®è¯¢é€šä¿¡ IndexedDBã€cookie</li></ol><p><strong>å¤šçº¿ç¨‹</strong></p><p><code>Service Worker</code>ï¼šService Worker æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨åå°çš„ Workerï¼Œå¤šé¡µé¢é—´å¯ä»¥å…±äº« Workerï¼Œä½¿ç”¨ Worker å……å½“æ¶ˆæ¯è½¬å‘ä¸­å¿ƒï¼Œå®ç°å¤šé¡µé¢é—´çš„é€šä¿¡</p><p><strong>onstorage</strong></p><p><code>localstorage</code> ç›‘å¬å¯¹æ–¹æ•°æ®å˜åŒ–æ—¶ï¼Œä½¿ç”¨ localstorage æ˜¯æ¯”è¾ƒå¥½çš„æ–¹å¼ <code>Window.onstorage</code></p><!-- **url ä¼ å‚æ•°** --><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jianshu.com/p/d9ca9f85d06e" target="_blank" >ç§»åŠ¨ç«¯ H5 é€‚é… iphoneX åº•éƒ¨æ ï¼Œcss å¿«é€Ÿè§£å†³æ–¹æ¡ˆ</a></p><p><a href="https://www.w3.org/TR/css-round-display-1/#descdef-viewport-viewport-fit" target="_blank" >www.w3.org</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/@viewport" target="_blank" >@viewport å·²åºŸå¼ƒ</a></p><p><a href="https://blog.csdn.net/swl979623074/article/details/120338707" target="_blank" >onstorage</a></p><p><a href="https://blog.csdn.net/weixin_44733660/article/details/124122112" target="_blank" >onstorage</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-http</title>
      <link href="//post/2022-07-16http.html"/>
      <url>//post/2022-07-16http.html</url>
      
        <content type="html"><![CDATA[<h2 id="HTTP-â½…æ³•"><a href="#HTTP-â½…æ³•" class="headerlink" title="HTTP â½…æ³•"></a>HTTP â½…æ³•</h2><p><code>HTTP1.0</code> å®šä¹‰äº†ä¸‰ç§è¯·æ±‚â½…æ³•ï¼š <code>GET</code>, <code>POST</code> å’Œ <code>HEAD</code> â½…æ³•<br><code>HTTP1.1</code> æ–°å¢äº†äº”ç§è¯·æ±‚â½…æ³•ï¼š<code>OPTIONS</code>, <code>PUT</code>, <code>DELETE</code>, <code>TRACE</code> å’Œ <code>CONNECT</code></p><h2 id="HTTP-â½…æ³•çš„ç†è®ºä½œâ½¤"><a href="#HTTP-â½…æ³•çš„ç†è®ºä½œâ½¤" class="headerlink" title="HTTP â½…æ³•çš„ç†è®ºä½œâ½¤"></a>HTTP â½…æ³•çš„ç†è®ºä½œâ½¤</h2><ul><li><code>GET</code>: é€šå¸¸â½¤äºè¯·æ±‚æœåŠ¡å™¨å‘é€æŸäº›èµ„æº</li><li><code>HEAD</code>: è¯·æ±‚èµ„æºçš„å¤´éƒ¨ä¿¡æ¯, <code>ä½¿â½¤åœºæ™¯</code>æ˜¯<code>åœ¨ä¸‹è½½â¼€ä¸ªâ¼¤â½‚ä»¶å‰å…ˆè·å–å…¶â¼¤â¼©å†å†³å®šæ˜¯å¦è¦ä¸‹è½½, ä»¥æ­¤å¯ä»¥èŠ‚çº¦å¸¦å®½èµ„æº</code></li><li><code>OPTIONS</code>: â½¤äºè·å–â½¬çš„èµ„æºæ‰€â½€æŒçš„é€šä¿¡é€‰é¡¹ <span style="color: red">ï¼ˆåœ¨ CORS ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ OPTIONS æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œä»¥æ£€æµ‹å®é™…è¯·æ±‚æ˜¯å¦å¯ä»¥è¢«æœåŠ¡å™¨æ‰€æ¥å—ã€‚æµè§ˆå™¨è‡ªåŠ¨å‘èµ·ï¼‰</span></li><li><code>POST</code>: å‘é€æ•°æ®ç»™æœåŠ¡å™¨</li><li><code>PUT</code>: â½¤äºæ–°å¢èµ„æºæˆ–è€…ä½¿â½¤è¯·æ±‚ä¸­çš„æœ‰æ•ˆè´Ÿè½½æ›¿æ¢â½¬æ ‡èµ„æºçš„è¡¨ç°å½¢å¼</li><li><code>DELETE</code>: â½¤äºåˆ é™¤æŒ‡å®šçš„èµ„æº</li><li><code>PATCH</code>: â½¤äºå¯¹èµ„æºè¿›â¾éƒ¨åˆ†ä¿®æ”¹</li><li><code>CONNECT</code>: HTTP&#x2F;1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“â½…å¼çš„ä»£ç†æœåŠ¡å™¨</li><li><code>TRACE</code>: å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦â½¤äºæµ‹è¯•æˆ–è¯Šæ–­</li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><p>ç†è®ºä¸Šæ˜¯è¿™ä¹ˆå›äº‹ï¼Œå¯æœ‰äº›ç ”å‘å¹¶ä¸ä¸€å®šè¿™ä¹ˆæ“ä½œ</p></p></div><h2 id="GET-å’Œ-POST-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#GET-å’Œ-POST-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="GET å’Œ POST æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>GET å’Œ POST æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><ul><li><code>æ•°æ®ä¼ è¾“â½…å¼ä¸åŒ</code>ï¼šGET è¯·æ±‚é€šè¿‡ URL ä¼ è¾“æ•°æ®ï¼Œâ½½ POST çš„æ•°æ®é€šè¿‡è¯·æ±‚ä½“ä¼ è¾“ã€‚</li><li><code>å®‰å…¨æ€§ä¸åŒ</code>ï¼šPOST çš„æ•°æ®å› ä¸ºåœ¨è¯·æ±‚ä¸»ä½“å†…ï¼Œæ‰€ä»¥æœ‰â¼€å®šçš„å®‰å…¨æ€§ä¿è¯ï¼Œâ½½ GET çš„æ•°æ®åœ¨ URL ä¸­ï¼Œé€šè¿‡å†å²è®°å½•ï¼Œç¼“å­˜å¾ˆå®¹æ˜“æŸ¥åˆ°æ•°æ®ä¿¡æ¯ã€‚</li><li><code>æ•°æ®ç±»å‹ä¸åŒ</code>ï¼šGET åªå…è®¸ ASCII å­—ç¬¦ï¼Œâ½½ POST â½†é™åˆ¶ GET â½†å®³ï¼š åˆ·æ–°ã€åé€€ç­‰æµè§ˆå™¨æ“ä½œ GET è¯·æ±‚æ˜¯â½†å®³çš„ï¼ŒPOST å¯èƒ½é‡å¤æäº¤è¡¨å•</li><li><code>ç‰¹æ€§ä¸åŒ</code>ï¼šGET æ˜¯å®‰å…¨ï¼ˆè¿™â¾¥çš„å®‰å…¨æ˜¯æŒ‡åªè¯»ç‰¹æ€§ï¼Œå°±æ˜¯ä½¿â½¤è¿™ä¸ªâ½…æ³•ä¸ä¼šå¼•èµ·æœåŠ¡å™¨çŠ¶æ€å˜åŒ–ï¼‰ä¸”å¹‚ç­‰ï¼ˆå¹‚ç­‰çš„ æ¦‚å¿µæ˜¯æŒ‡åŒâ¼€ä¸ªè¯·æ±‚â½…æ³•æ‰§â¾å¤šæ¬¡å’Œä»…æ‰§â¾â¼€æ¬¡çš„æ•ˆæœå®Œå…¨ç›¸åŒï¼‰ï¼Œâ½½ POST æ˜¯â¾®å®‰å…¨â¾®å¹‚ç­‰</li></ul><h2 id="PUT-å’Œ-POST-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#PUT-å’Œ-POST-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="PUT å’Œ POST æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>PUT å’Œ POST æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><ul><li><p>PUT â½…æ³•æ˜¯<code>å¹‚ç­‰</code>çš„ï¼šè¿ç»­è°ƒâ½¤â¼€æ¬¡æˆ–è€…å¤šæ¬¡çš„æ•ˆæœç›¸åŒï¼ˆâ½†å‰¯ä½œâ½¤ï¼‰ï¼Œâ½½ POST â½…æ³•æ˜¯â¾®å¹‚ ç­‰çš„ã€‚</p></li><li><p>PUT çš„ <code>URI æŒ‡å‘æ˜¯å…·ä½“å•â¼€èµ„æº</code>ï¼Œâ½½ POST å¯ä»¥æŒ‡å‘èµ„æºé›†åˆã€‚</p></li></ul><p>ä¸¾ä¸ªä¾‹â¼¦ï¼Œæˆ‘ä»¬åœ¨å¼€å‘â¼€ä¸ªåšå®¢ç³»ç»Ÿï¼Œå½“æˆ‘ä»¬è¦åˆ›å»ºâ¼€ç¯‡â½‚ç« çš„æ—¶å€™å¾€å¾€â½¤</p><ul><li><p>POST <a href="https://www.jianshu.com/articles">https://www.jianshu.com/articles</a> ï¼Œ è¿™ä¸ªè¯·æ±‚çš„è¯­ä¹‰æ˜¯ï¼Œåœ¨ articles çš„èµ„æºé›†åˆä¸‹åˆ›å»ºâ¼€ç¯‡æ–°çš„â½‚ç« ï¼Œå¦‚æœæˆ‘ä»¬å¤šæ¬¡æäº¤è¿™ä¸ªè¯·æ±‚ä¼šåˆ›å»ºå¤šä¸ªâ½‚ç« ï¼Œè¿™æ˜¯â¾®å¹‚ ç­‰çš„ã€‚</p><br/><br/></li><li><p>PUT <a href="https://www.jianshu.com/articles/1">https://www.jianshu.com/articles/1</a> çš„è¯­ä¹‰æ˜¯æ›´æ–°å¯¹åº”â½‚ç« ä¸‹çš„èµ„æºï¼ˆâ½å¦‚ä¿®æ”¹ä½œè€…åç§°ç­‰ï¼‰ï¼Œè¿™ä¸ª URI æŒ‡å‘çš„å°±æ˜¯å•â¼€èµ„æºï¼Œâ½½ä¸”æ˜¯å¹‚ç­‰çš„ï¼Œâ½å¦‚ä½ æŠŠã€åˆ˜åã€ä¿®æ”¹æˆã€åˆ˜å¾·åã€ï¼Œæäº¤å¤šå°‘æ¬¡éƒ½æ˜¯ä¿®æ”¹æˆã€åˆ˜å¾·åã€</p></li></ul><h2 id="PUT-å’Œ-PATCH-çš„åŒºåˆ«ï¼Ÿ"><a href="#PUT-å’Œ-PATCH-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="PUT å’Œ PATCH çš„åŒºåˆ«ï¼Ÿ"></a>PUT å’Œ PATCH çš„åŒºåˆ«ï¼Ÿ</h2><p><code>PUT</code> å’Œ <code>PATCH</code> éƒ½æ˜¯æ›´æ–°èµ„æºï¼Œâ½½ <code>PATCH</code> â½¤æ¥å¯¹å·²çŸ¥èµ„æºè¿›â¾å±€éƒ¨æ›´æ–°ã€‚<code>PATCH</code>å¯ä»¥ç†è§£ä¸ºæ‰“è¡¥ä¸<br>â½å¦‚æˆ‘ä»¬æœ‰â¼€ç¯‡â½‚ç« çš„åœ°å€ <a href="https://www.jianshu.com/articles/1">https://www.jianshu.com/articles/1</a> ,è¿™ç¯‡â½‚ç« çš„å¯ä»¥è¡¨ç¤ºä¸º:</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">article &#x3D; &#123;  author: &quot;dxy&quot;,  creationDate: &quot;2019-6-12&quot;,  content: &quot;æˆ‘å†™â½‚ç« åƒåˆ˜å¾·å&quot;,  id: 1,&#125;;</code></pre><p>å½“æˆ‘ä»¬è¦ä¿®æ”¹â½‚ç« çš„ä½œè€…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘é€</p><p><code>PUT https://www.jianshu.com/articles/1</code> ï¼Œæ•°æ®æ˜¯:</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123;  author:&#39;åˆ˜å¾·å&#39;,  creationDate: &#39;2019-6-12&#39;,  content: &#39;æˆ‘å†™â½‚ç« åƒåˆ˜å¾·å&#39;,  id: 1&#125;</code></pre><p>è¿™ç§ç›´æ¥è¦†ç›–èµ„æºçš„ä¿®æ”¹â½…å¼åº”è¯¥â½¤ putï¼Œä½†æ˜¯ä½ è§‰å¾—æ¯æ¬¡éƒ½å¸¦æœ‰è¿™ä¹ˆå¤šâ½†â½¤çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥å‘é€</p><p><code>PATCH https://www.jianshu.com/articles/1</code> ï¼Œè¿™ä¸ªæ—¶å€™åªéœ€è¦:</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123; author:&#39;åˆ˜å¾·å&#39;, &#125;</code></pre><h2 id="HTTP-çš„çŠ¶æ€ç æœ‰å“ªäº›ï¼Ÿ"><a href="#HTTP-çš„çŠ¶æ€ç æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="HTTP çš„çŠ¶æ€ç æœ‰å“ªäº›ï¼Ÿ"></a>HTTP çš„çŠ¶æ€ç æœ‰å“ªäº›ï¼Ÿ</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/100" target="_blank" >Web å¼€å‘æŠ€æœ¯&gt;HTTP&gt;HTTP å“åº”çŠ¶æ€ç </a></p><ul><li><code>100 Continue</code>,ä¿¡æ¯å‹çŠ¶æ€å“åº”ç è¡¨ç¤ºç›®å‰ä¸ºæ­¢ä¸€åˆ‡æ­£å¸¸ï¼Œå®¢æˆ·ç«¯åº”è¯¥ç»§ç»­è¯·æ±‚ï¼Œå¦‚æœå·²å®Œæˆè¯·æ±‚åˆ™å¿½ç•¥</li><li><code>101 SwitchingProtocols</code>ï¼Œè¡¨ç¤ºåˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®(<code>h5çš„websocketä½¿ç”¨æ—¶ï¼Œä¼šå‡ºç°101çŠ¶æ€ç </code>)</li><li><code>103 Early Hints</code>,ä¿¡æ¯çŠ¶æ€å“åº”ç ï¼Œä¸€èˆ¬å’Œ Link headerï¼ˆé¦–éƒ¨ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œæ¥å…è®¸ç”¨æˆ·åœ¨æœåŠ¡å™¨è¿˜åœ¨å‡†å¤‡å“åº”æ•°æ®çš„æ—¶å€™é¢„åŠ è½½ä¸€äº›èµ„æºã€‚</li></ul><p><strong>2XX æˆåŠŸ</strong></p><ul><li><code>200 OK</code>ï¼Œè¡¨ç¤ºä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯è¢«æ­£ç¡®å¤„ç†</li><li><code>201 Created</code> è¯·æ±‚å·²ç»è¢«å®ç°ï¼Œâ½½ä¸”æœ‰â¼€ä¸ªæ–°çš„èµ„æºå·²ç»ä¾æ®è¯·æ±‚çš„éœ€è¦â½½å»ºâ½´</li><li><code>202 Accepted</code> è¯·æ±‚å·²æ¥å—ï¼Œä½†æ˜¯è¿˜æ²¡æ‰§â¾ï¼Œä¸ä¿è¯å®Œæˆè¯·æ±‚</li><li><code>204 No content</code>ï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥â½‚ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ† å®¢æˆ·ç«¯ä¸åšæ›´æ”¹(<code>æµè§ˆå™¨ä¸ä¼šåˆ·æ–°é¡µé¢ï¼Œä¹Ÿä¸ä¼šå¯¼å‘åˆ«çš„é¡µé¢ã€‚å¯¹å®¢æˆ·ç«¯è¯´å¥½äº†ï¼Œä½ åˆ«ç®¡äº†</code>)</li><li><code>206 Partial Content</code>ï¼Œè¿›â¾èŒƒå›´è¯·æ±‚ <span style="color: red">B ç«™è§†é¢‘æ’­æ”¾æ—¶å€™ä¼šå‘èµ·è¯·æ±‚</span></li></ul><p><strong>3XX é‡å®šå‘</strong></p><ul><li><code>301 moved permanently</code>ï¼Œæ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºå·²è¢«åˆ†é…äº†æ–°çš„ URL</li><li><code>302 found</code>ï¼Œä¸´æ—¶æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºä¸´æ—¶è¢«åˆ†é…äº†æ–°çš„ URL</li><li><code>303 see other</code>ï¼Œè¡¨ç¤ºèµ„æºå­˜åœ¨ç€å¦â¼€ä¸ª URLï¼Œåº”ä½¿â½¤ GET â½…æ³•ä¸â¾¹è·å–èµ„æº</li><li><code>304 not modified</code>ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å…è®¸è®¿é—®èµ„æºï¼Œä½†å› å‘â½£è¯·æ±‚æœªæ»¡â¾œæ¡ä»¶çš„æƒ…å†µ</li><li><code>307 temporary redirect</code>ï¼Œä¸´æ—¶é‡å®šå‘ï¼Œå’Œ 302 å«ä¹‰ç›¸åŒ</li></ul><p><strong>4XX å®¢æˆ·ç«¯é”™è¯¯</strong></p><ul><li><code>400 bad request</code>ï¼Œè¯·æ±‚æŠ¥â½‚å­˜åœ¨è¯­æ³•é”™è¯¯</li><li><code>401 unauthorized</code>ï¼Œè¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯çš„è®¤è¯ä¿¡æ¯</li><li><code>403 forbidden</code>ï¼Œè¡¨ç¤ºå¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»</li><li><code>404 not found</code>ï¼Œè¡¨ç¤ºåœ¨æœåŠ¡å™¨ä¸Šæ²¡æœ‰æ‰¾åˆ°è¯·æ±‚çš„èµ„æº</li><li><code>408 Request timeout</code>, å®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶</li><li><code>409 Confict</code>, è¯·æ±‚çš„èµ„æºå¯èƒ½å¼•èµ·å†²çª</li></ul><p><strong>5XX æœåŠ¡å™¨é”™è¯¯</strong></p><ul><li><code>500 internal sever error</code>ï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§â¾è¯·æ±‚æ—¶å‘â½£äº†é”™è¯¯</li><li><code>501 Not Implemented</code> è¯·æ±‚è¶…å‡ºæœåŠ¡å™¨èƒ½â¼’èŒƒå›´ï¼Œä¾‹å¦‚æœåŠ¡å™¨ä¸â½€æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½ï¼Œæˆ–è€…è¯·æ±‚æ˜¯æœåŠ¡å™¨ä¸â½€æŒçš„æŸä¸ªâ½…æ³•</li><li><code>502 Bad Gateway</code> ç½‘å…³é”™è¯¯</li><li><code>503 service unavailable</code>ï¼Œè¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼Œâ½†æ³•å¤„ç†è¯·æ±‚</li><li><code>504 Gateway timeout</code> ç½‘å…³è¶…æ—¶</li><li><code>505 http version not supported</code> æœåŠ¡å™¨ä¸â½€æŒï¼Œæˆ–è€…æ‹’ç»â½€æŒåœ¨è¯·æ±‚ä¸­ä½¿â½¤çš„ HTTP ç‰ˆæœ¬</li></ul><p>åå°ä¸€ä¸ªæœåŠ¡å™¨æŒ‚äº†ï¼Œé‡å¯åæ­£å¸¸<br><img src="http://t-blog-images.aijs.top/img/20220718135425.webp" /></p><h2 id="302-307-303-çš„åŒºåˆ«ï¼Ÿ"><a href="#302-307-303-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="302,307,303 çš„åŒºåˆ«ï¼Ÿ"></a>302,307,303 çš„åŒºåˆ«ï¼Ÿ</h2><ul><li><code>302</code> æ˜¯ http1.0 çš„åè®®çŠ¶æ€ç ï¼Œåœ¨<code>http1.1ç‰ˆæœ¬</code>çš„æ—¶å€™ä¸ºäº†ç»†åŒ–<code>302</code>çŠ¶æ€ç â¼œå‡ºæ¥äº†ä¸¤ä¸ª<code>303</code>å’Œ<code>307</code>ã€‚</li><li><code>303</code> æ˜ç¡®è¡¨ç¤ºå®¢æˆ·ç«¯åº”å½“<code>é‡‡â½¤getâ½…æ³•è·å–èµ„æº</code>ï¼Œ<code>ä¼šæŠŠPOSTè¯·æ±‚å˜ä¸ºGETè¯·æ±‚è¿›â¾é‡å®šå‘</code>ã€‚</li><li><code>307</code> ä¼šéµç…§æµè§ˆå™¨æ ‡å‡†ï¼Œ ä¸ä¼šä» post å˜ä¸º getã€‚</li></ul><p><span style="color: red">è¯¦ç»†å†…å®¹è§ä¸‹æ–‡ï¼ŒHTTP çŠ¶æ€ç ç›®å½•</span></p><h2 id="API-ç½‘å…³æ˜¯ä»€ä¹ˆ"><a href="#API-ç½‘å…³æ˜¯ä»€ä¹ˆ" class="headerlink" title="API ç½‘å…³æ˜¯ä»€ä¹ˆ"></a>API ç½‘å…³æ˜¯ä»€ä¹ˆ</h2><p><a href="https://www.cnblogs.com/konglxblog/p/15170636.html" target="_blank" ><code>API ç½‘å…³</code></a>æ˜¯ä»‹äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œæ‰€æœ‰çš„å¤–éƒ¨è¯·æ±‚éƒ½ä¼šå…ˆç»è¿‡ API ç½‘å…³è¿™ä¸€å±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒAPI çš„å®ç°æ–¹é¢æ›´å¤šçš„è€ƒè™‘ä¸šåŠ¡é€»è¾‘ï¼Œè€Œå®‰å…¨ã€æ€§èƒ½ã€ç›‘æ§å¯ä»¥äº¤ç”± API ç½‘å…³æ¥åšï¼Œè¿™æ ·æ—¢æé«˜ä¸šåŠ¡çµæ´»æ€§åˆä¸ç¼ºå®‰å…¨æ€§</p><p><a href="https://github.com/Kong/kong" target="_blank" >Kong ç½‘å…³</a></p><h2 id="HTTP-çš„-keep-alive-æ˜¯â¼²ä»€ä¹ˆçš„ï¼Ÿ"><a href="#HTTP-çš„-keep-alive-æ˜¯â¼²ä»€ä¹ˆçš„ï¼Ÿ" class="headerlink" title="HTTP çš„ keep-alive æ˜¯â¼²ä»€ä¹ˆçš„ï¼Ÿ"></a>HTTP çš„ keep-alive æ˜¯â¼²ä»€ä¹ˆçš„ï¼Ÿ</h2><p>åœ¨æ—©æœŸçš„ HTTP&#x2F;1.0 ä¸­ï¼Œæ¯æ¬¡ http è¯·æ±‚éƒ½è¦åˆ›å»ºâ¼€ä¸ªè¿æ¥ï¼Œâ½½åˆ›å»ºè¿æ¥çš„è¿‡ç¨‹éœ€è¦æ¶ˆè€—èµ„æºå’Œæ—¶é—´ï¼Œ<code>ä¸ºäº†å‡å°‘èµ„æºæ¶ˆè€—ï¼Œ ç¼©çŸ­å“åº”æ—¶é—´ï¼Œå°±éœ€è¦é‡â½¤è¿æ¥</code>ã€‚<br>åœ¨åæ¥çš„ HTTP&#x2F;1.0 ä¸­ä»¥åŠ HTTP&#x2F;1.1 ä¸­ï¼Œå¼•â¼Šäº†é‡â½¤è¿æ¥çš„æœºåˆ¶ï¼Œå°±æ˜¯åœ¨ <code>http è¯·æ±‚å¤´ä¸­</code>åŠ â¼Š <code>Connection: keep-alive</code> æ¥å‘Šè¯‰å¯¹â½…è¿™ä¸ªè¯·æ±‚å“åº”å®Œæˆåä¸è¦å…³é—­ï¼Œä¸‹â¼€æ¬¡å’±ä»¬è¿˜â½¤è¿™ä¸ªè¯·æ±‚ç»§ç»­äº¤æµã€‚</p><p>HTTP&#x2F;1.0 å¦‚æœæƒ³è¦ä¿æŒâ»“è¿æ¥ï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŠ ä¸Š <code>Connection: keep-alive</code>ã€‚</p><h2 id="keep-alive-çš„ä¼˜ç‚¹ï¼š"><a href="#keep-alive-çš„ä¼˜ç‚¹ï¼š" class="headerlink" title="keep-alive çš„ä¼˜ç‚¹ï¼š"></a>keep-alive çš„ä¼˜ç‚¹ï¼š</h2><ul><li>è¾ƒå°‘çš„ CPU å’Œå†…å­˜çš„ä½¿â½¤ï¼ˆç”±äºåŒæ—¶æ‰“å¼€çš„è¿æ¥çš„å‡å°‘äº†ï¼‰</li><li>é™ä½æ‹¥å¡æ§åˆ¶ ï¼ˆTCP è¿æ¥å‡å°‘äº†ï¼‰</li><li>å‡å°‘äº†åç»­è¯·æ±‚çš„å»¶è¿Ÿï¼ˆâ½†éœ€å†è¿›â¾æ¡â¼¿ï¼‰</li><li>æŠ¥å‘Šé”™è¯¯â½†éœ€å…³é—­ TCP è¿</li><li>å…è®¸è¯·æ±‚å’Œåº”ç­”çš„ HTTP <code>ç®¡çº¿åŒ–</code>(å°†å¤šä¸ª HTTP è¯·æ±‚ï¼ˆrequestï¼‰æ•´æ‰¹æäº¤çš„æŠ€æœ¯ï¼Œè€Œåœ¨å‘é€è¿‡ç¨‹ä¸­ä¸éœ€å…ˆç­‰å¾…ä¼ºæœç«¯çš„å›åº”)</li></ul><h2 id="ä¸ºä»€ä¹ˆæœ‰äº†-HTTP-ä¸ºä»€ä¹ˆè¿˜è¦-HTTPSï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæœ‰äº†-HTTP-ä¸ºä»€ä¹ˆè¿˜è¦-HTTPSï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰äº† HTTP ä¸ºä»€ä¹ˆè¿˜è¦ HTTPSï¼Ÿ"></a>ä¸ºä»€ä¹ˆæœ‰äº† HTTP ä¸ºä»€ä¹ˆè¿˜è¦ HTTPSï¼Ÿ</h2><p>https æ˜¯å®‰å…¨ç‰ˆçš„ httpï¼Œå› ä¸º http åè®®çš„æ•°æ®éƒ½æ˜¯æ˜â½‚è¿›â¾ä¼ è¾“çš„ï¼Œæ‰€ä»¥å¯¹äºâ¼€äº›æ•æ„Ÿä¿¡æ¯çš„ä¼ è¾“å°±å¾ˆä¸å®‰å…¨ï¼ŒHTTPS å°± æ˜¯ä¸ºäº†è§£å†³ HTTP çš„ä¸å®‰å…¨â½½â½£çš„ã€‚</p><h2 id="HTTPS-æ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ"><a href="#HTTPS-æ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ" class="headerlink" title="HTTPS æ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ"></a>HTTPS æ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ</h2><p>è¿‡ç¨‹â½è¾ƒå¤æ‚: <code>å¯¹ç§°åŠ å¯†</code>ã€<code>éå¯¹ç§°åŠ å¯†</code>ã€<code>ä¸­é—´äºº</code>ã€<code>CAè¯ä¹¦</code>ã€<code>æ•°å­—ç­¾å</code></p><h3 id="å¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†</h3><p>å³é€šä¿¡çš„åŒâ½…éƒ½ä½¿â½¤åŒâ¼€ä¸ªç§˜é’¥è¿›â¾åŠ è§£å¯†ï¼Œâ½å¦‚ç‰¹åŠ¡æ¥å¤´çš„æš—å·ï¼Œå°±å±äºå¯¹ç§°åŠ å¯† å¯¹ç§°åŠ å¯†è™½ç„¶å¾ˆç®€å•æ€§èƒ½ä¹Ÿå¥½ï¼Œä½†æ˜¯â½†æ³•è§£å†³â¾¸æ¬¡æŠŠç§˜é’¥å‘ç»™å¯¹â½…çš„é—®é¢˜ï¼Œå¾ˆå®¹æ˜“è¢«â¿Šå®¢æ‹¦æˆªç§˜é’¥ã€‚</p><h3 id="â¾®å¯¹ç§°åŠ å¯†"><a href="#â¾®å¯¹ç§°åŠ å¯†" class="headerlink" title="â¾®å¯¹ç§°åŠ å¯†"></a>â¾®å¯¹ç§°åŠ å¯†</h3><ol><li>ç§é’¥ + å…¬é’¥&#x3D; å¯†é’¥å¯¹</li><li>å³â½¤ç§é’¥åŠ å¯†çš„æ•°æ®,åªæœ‰å¯¹åº”çš„å…¬é’¥æ‰èƒ½è§£å¯†,â½¤å…¬é’¥åŠ å¯†çš„æ•°æ®,åªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†</li><li>å› ä¸ºé€šä¿¡åŒâ½…çš„â¼¿â¾¥éƒ½æœ‰â¼€å¥—â¾ƒâ¼°çš„å¯†é’¥å¯¹,é€šä¿¡ä¹‹å‰åŒâ½…ä¼šå…ˆæŠŠâ¾ƒâ¼°çš„å…¬é’¥éƒ½å…ˆå‘ç»™å¯¹â½…</li><li>ç„¶åå¯¹â½…å†æ‹¿ç€è¿™ä¸ªå…¬é’¥æ¥åŠ å¯†æ•°æ®å“åº”ç»™å¯¹â½…,ç­‰åˆ°åˆ°äº†å¯¹â½…é‚£â¾¥,å¯¹â½…å†â½¤â¾ƒâ¼°çš„ç§é’¥è¿›â¾è§£å¯†</li></ol><p>â¾®å¯¹ç§°åŠ å¯†è™½ç„¶å®‰å…¨æ€§æ›´â¾¼ï¼Œä½†æ˜¯å¸¦æ¥çš„é—®é¢˜å°±æ˜¯é€Ÿåº¦å¾ˆæ…¢ï¼Œå½±å“æ€§èƒ½ã€‚</p><p>è§£å†³â½…æ¡ˆï¼š</p><p>é‚£ä¹ˆç»“åˆä¸¤ç§åŠ å¯†â½…å¼ï¼Œå°†<code>å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿â½¤â¾®å¯¹ç§°åŠ å¯†çš„å…¬é’¥è¿›â¾åŠ å¯†ï¼Œç„¶åå‘é€å‡ºå»</code>ï¼Œ<code>æ¥æ”¶â½…ä½¿â½¤ç§é’¥è¿›â¾è§£å¯† å¾—åˆ°å¯¹ç§°åŠ å¯†çš„å¯†é’¥</code>ï¼Œç„¶ååŒâ½…å¯ä»¥ä½¿â½¤å¯¹ç§°åŠ å¯†æ¥è¿›â¾æ²Ÿé€šã€‚</p><h3 id="ä¸­é—´â¼ˆ"><a href="#ä¸­é—´â¼ˆ" class="headerlink" title="ä¸­é—´â¼ˆ"></a>ä¸­é—´â¼ˆ</h3><p>æ­¤æ—¶â¼œå¸¦æ¥â¼€ä¸ªé—®é¢˜ï¼Œ<code>ä¸­é—´â¼ˆ</code>é—®é¢˜ï¼š</p><p>å¦‚æœæ­¤æ—¶åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å­˜åœ¨â¼€ä¸ªä¸­é—´â¼ˆ,è¿™ä¸ªä¸­é—´â¼ˆåªéœ€è¦æŠŠåŸæœ¬åŒâ½…é€šä¿¡äº’å‘çš„å…¬é’¥,æ¢æˆâ¾ƒâ¼°çš„å…¬é’¥,è¿™æ ·ä¸­é—´â¼ˆå°±å¯ä»¥è½»æ¾è§£å¯†é€šä¿¡åŒâ½…æ‰€å‘é€çš„æ‰€æœ‰æ•°æ®ã€‚(<code>å·æ¢</code>)</p><h3 id="CA-è¯ä¹¦"><a href="#CA-è¯ä¹¦" class="headerlink" title="CA è¯ä¹¦"></a>CA è¯ä¹¦</h3><p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™éœ€è¦â¼€ä¸ªå®‰å…¨çš„ç¬¬ä¸‰â½…é¢å‘è¯ä¹¦ï¼ˆCAï¼‰ï¼Œè¯æ˜èº«ä»½çš„èº«ä»½ï¼Œé˜²â½Œè¢«ä¸­é—´â¼ˆæ”»å‡»ã€‚</p><p>è¯ä¹¦ä¸­åŒ…æ‹¬ï¼š<code>ç­¾å‘è€…</code>ã€<code>è¯ä¹¦â½¤é€”</code>ã€<code>ä½¿â½¤è€…å…¬é’¥</code>ã€<code>ä½¿â½¤è€…ç§é’¥</code>ã€<code>ä½¿â½¤è€…çš„ HASH ç®—æ³•</code>ã€<code>è¯ä¹¦åˆ°æœŸæ—¶é—´</code>ç­‰</p><p>ç±»ä¼¼ä¸€ä¸ªé©¾é©¶è¯ï¼š<code>ç­¾å‘æœºæ„</code>ã€<code>é©¾é©¶è½¦è¾†å‹å·</code>ã€<code>ä½¿ç”¨è€…ä¿¡æ¯</code>ã€<code>è¯ä»¶æœ‰æ•ˆæœŸ</code></p><h3 id="è¯ä¹¦ç¯¡æ”¹"><a href="#è¯ä¹¦ç¯¡æ”¹" class="headerlink" title="è¯ä¹¦ç¯¡æ”¹"></a>è¯ä¹¦ç¯¡æ”¹</h3><p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œå¦‚æœä¸­é—´â¼ˆç¯¡æ”¹äº†è¯ä¹¦ï¼Œé‚£ä¹ˆèº«ä»½è¯æ˜æ˜¯ä¸æ˜¯å°±â½†æ•ˆäº†ï¼Ÿè¿™ä¸ªè¯æ˜å°±â½©ä¹°äº†ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦â¼€ä¸ªæ–°çš„æŠ€æœ¯ï¼Œ<code>æ•°å­—ç­¾å</code>ã€‚</p><h3 id="æ•°å­—ç­¾å"><a href="#æ•°å­—ç­¾å" class="headerlink" title="æ•°å­—ç­¾å"></a>æ•°å­—ç­¾å</h3><p>æ•°å­—ç­¾å: å°±æ˜¯â½¤ CA â¾ƒå¸¦çš„ HASH ç®—æ³•å¯¹è¯ä¹¦çš„å†…å®¹è¿›â¾ HASH å¾—åˆ°â¼€ä¸ªæ‘˜è¦ï¼Œå†â½¤ CA çš„ç§é’¥åŠ å¯†ï¼Œæœ€ç»ˆç»„æˆæ•°å­—ç­¾åã€‚å½“åˆ«â¼ˆæŠŠä»–çš„è¯ä¹¦å‘è¿‡æ¥çš„æ—¶å€™,æˆ‘å†â½¤åŒæ ·çš„ Hash ç®—æ³•,å†æ¬¡â½£æˆæ¶ˆæ¯æ‘˜è¦ï¼Œç„¶åâ½¤ CA çš„å…¬é’¥å¯¹æ•°å­—ç­¾åè§£å¯†,å¾—åˆ° CA åˆ›å»ºçš„æ¶ˆæ¯æ‘˜è¦,ä¸¤è€…â¼€â½,å°±çŸ¥é“ä¸­é—´æœ‰æ²¡æœ‰è¢«â¼ˆç¯¡æ”¹äº†ã€‚ è¿™ä¸ªæ—¶å€™å°±èƒ½æœ€â¼¤ç¨‹åº¦ä¿è¯é€šä¿¡çš„å®‰å…¨äº†ã€‚</p><h2 id="HTTP2-ç‰¹ç‚¹ï¼Ÿ"><a href="#HTTP2-ç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="HTTP2 ç‰¹ç‚¹ï¼Ÿ"></a>HTTP2 ç‰¹ç‚¹ï¼Ÿ</h2><ul><li><code>äºŒè¿›åˆ¶åˆ†å¸§</code></li><li><code>å¤´éƒ¨å‹ç¼©</code></li><li><code>æœåŠ¡ç«¯æ¨é€</code></li><li><code>å¤šè·¯å¤ç”¨</code></li></ul><details class="custom-details"><summary>ç‚¹å‡»æŸ¥çœ‹æ›´å¤š</summary><p><strong>â¼†è¿›åˆ¶åˆ†å¸§</strong></p><ul><li><code>å¸§</code>ï¼šHTTP&#x2F;2 æ•°æ®é€šä¿¡çš„æœ€â¼©å•ä½</li><li><code>æ¶ˆæ¯</code>ï¼šæŒ‡ HTTP&#x2F;2 ä¸­é€»è¾‘ä¸Šçš„ HTTP æ¶ˆæ¯ã€‚ä¾‹å¦‚è¯·æ±‚å’Œå“åº”ç­‰ï¼Œæ¶ˆæ¯ç”±â¼€ä¸ªæˆ–å¤šä¸ªå¸§ ç»„æˆã€‚</li><li><code>æµ</code>ï¼šå­˜åœ¨äºè¿æ¥ä¸­çš„â¼€ä¸ªè™šæ‹Ÿé€šé“ã€‚æµå¯ä»¥æ‰¿è½½åŒå‘æ¶ˆæ¯ï¼Œæ¯ä¸ªæµéƒ½æœ‰â¼€ä¸ªå”¯â¼€çš„æ•´æ•° ID HTTP&#x2F;2 é‡‡â½¤â¼†è¿›åˆ¶æ ¼å¼ä¼ è¾“æ•°æ®ï¼Œâ½½â¾® HTTP 1.x çš„â½‚æœ¬æ ¼å¼ï¼Œ<code>â¼†è¿›åˆ¶åè®®è§£æèµ·æ¥æ›´â¾¼æ•ˆ</code>ã€‚</li></ul><p><strong>å¤´éƒ¨å‹ç¼©</strong></p><p>HTTP&#x2F;1.x ä¼šåœ¨è¯·æ±‚å’Œå“åº”ä¸­ä¸­é‡å¤åœ°æºå¸¦ä¸å¸¸æ”¹å˜çš„ã€å†—â»“çš„å¤´éƒ¨æ•°æ®ï¼Œç»™â½¹ç»œå¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ã€‚ HTTP&#x2F;2 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿â½¤â€œâ¾¸éƒ¨è¡¨â€æ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®ï¼å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚ å’Œå“åº”å‘é€ â¾¸éƒ¨è¡¨åœ¨ HTTP&#x2F;2 çš„è¿æ¥å­˜ç»­æœŸå†…å§‹ç»ˆå­˜åœ¨ï¼Œç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±åŒæ¸è¿›åœ°æ›´æ–°; æ¯ä¸ªæ–°çš„â¾¸éƒ¨é”®ï¼å€¼å¯¹è¦ä¹ˆè¢«è¿½åŠ åˆ°å½“å‰è¡¨çš„æœ«å°¾ï¼Œè¦ä¹ˆæ›¿æ¢è¡¨ä¸­ä¹‹å‰çš„å€¼ã€‚ ä½ å¯ä»¥ç†è§£ä¸ºåªå‘é€å·®å¼‚æ•°æ®ï¼Œâ½½ä¸æ˜¯å…¨éƒ¨å‘é€ï¼Œä»â½½å‡å°‘å¤´éƒ¨çš„ä¿¡æ¯é‡</p><p><strong>æœåŠ¡å™¨æ¨é€</strong></p><p>æœåŠ¡ç«¯å¯ä»¥åœ¨å‘é€â»šâ¾¯ HTML æ—¶ä¸»åŠ¨æ¨é€å…¶å®ƒèµ„æºï¼Œâ½½ä¸â½¤ç­‰åˆ°æµè§ˆå™¨è§£æåˆ°ç›¸åº”ä½ç½®ï¼Œå‘èµ·è¯·æ±‚å†å“åº”ã€‚</p><p>åœºæ™¯:</p><p>ä¾‹å¦‚æœåŠ¡ç«¯ å¯ä»¥ä¸»åŠ¨æŠŠ JS å’Œ CSS â½‚ä»¶æ¨é€ç»™å®¢æˆ·ç«¯ï¼Œâ½½ä¸éœ€è¦å®¢æˆ·ç«¯è§£æ HTML æ—¶å†å‘é€è¿™äº›è¯·æ±‚ã€‚ æœåŠ¡ç«¯å¯ä»¥ä¸»åŠ¨æ¨é€ï¼Œå®¢æˆ·ç«¯ä¹Ÿæœ‰æƒåˆ©é€‰æ‹©æ˜¯å¦æ¥æ”¶ã€‚å¦‚æœæœåŠ¡ç«¯æ¨é€çš„èµ„æºå·²ç»è¢«æµè§ˆå™¨ç¼“å­˜è¿‡ï¼Œæµè§ˆå™¨å¯ä»¥é€šè¿‡å‘ é€ <code>RST_STREAM</code> å¸§æ¥æ‹’æ”¶ã€‚<code>ä¸»åŠ¨æ¨é€ä¹Ÿéµå®ˆåŒæºç­–ç•¥ï¼ŒæœåŠ¡å™¨ä¸ä¼šéšä¾¿æ¨é€ç¬¬ä¸‰â½…èµ„æºç»™å®¢æˆ·ç«¯</code>ã€‚</p><p><strong>å¤šè·¯å¤â½¤</strong></p><p>HTTP 1.x ä¸­ï¼Œå¦‚æœæƒ³å¹¶å‘å¤šä¸ªè¯·æ±‚ï¼Œå¿…é¡»ä½¿â½¤å¤šä¸ª TCP é“¾æ¥ï¼Œä¸”æµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºï¼Œè¿˜ä¼šå¯¹å•ä¸ªåŸŸåæœ‰ <code>6-8</code> ä¸ªçš„ TCP é“¾æ¥è¯·æ±‚é™åˆ¶ã€‚<br>HTTP2 ä¸­ï¼š <code>åŒåŸŸåä¸‹æ‰€æœ‰é€šä¿¡éƒ½åœ¨å•ä¸ªè¿æ¥ä¸Šå®Œæˆ</code>ã€‚ <code>å•ä¸ªè¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµ</code>ã€‚ æ•°æ®æµä»¥æ¶ˆæ¯çš„å½¢å¼å‘é€ï¼Œâ½½æ¶ˆæ¯â¼œç”±â¼€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆï¼Œå¤šä¸ªå¸§ä¹‹é—´å¯ä»¥ä¹±åºå‘é€ï¼Œå› ä¸ºæ ¹æ®å¸§â¾¸éƒ¨çš„æµæ ‡è¯†å¯ä»¥é‡æ–°ç»„è£…</p><img src="http://t-blog-images.aijs.top/img/20220716210046.png" /></details><h2 id="HTTP3-ç‰¹ç‚¹ï¼Ÿ"><a href="#HTTP3-ç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="HTTP3 ç‰¹ç‚¹ï¼Ÿ"></a>HTTP3 ç‰¹ç‚¹ï¼Ÿ</h2><ul><li><code>é˜Ÿå¤´é˜»å¡</code>ï¼š æœ‰åºå­—èŠ‚æµå¼•å‡ºçš„<code>é˜Ÿå¤´é˜»å¡</code>ï¼ˆHead-of-line blockingï¼‰ï¼Œä½¿å¾— HTTP2 çš„å¤šè·¯å¤ç”¨èƒ½åŠ›å¤§æ‰“æŠ˜æ‰£ï¼›</li><li><code>æ¡æ‰‹å»¶è¿Ÿ</code>ï¼š<code>TCP ä¸ TLS å åŠ äº†æ¡æ‰‹æ—¶å»¶</code>ï¼Œå»ºé“¾æ—¶é•¿è¿˜æœ‰ 1 å€çš„ä¸‹é™ç©ºé—´ï¼›</li><li><code>ç§»åŠ¨æˆæœ¬é«˜</code>ï¼šåŸºäº TCP å››å…ƒç»„ç¡®å®šä¸€ä¸ªè¿æ¥ï¼Œè¿™ç§è¯ç”Ÿäºæœ‰çº¿ç½‘ç»œçš„è®¾è®¡ï¼Œ<code>å¹¶ä¸é€‚åˆç§»åŠ¨çŠ¶æ€ä¸‹çš„æ— çº¿ç½‘ç»œ</code>ï¼Œè¿™æ„å‘³ç€ IP åœ°å€çš„é¢‘ç¹å˜åŠ¨ä¼šå¯¼è‡´ TCP è¿æ¥ã€TLS ä¼šè¯åå¤æ¡æ‰‹ï¼Œæˆæœ¬é«˜æ˜‚ã€‚</li></ul><h2 id="HTTP3-åè®®è§£å†³äº†è¿™äº›é—®é¢˜ï¼š"><a href="#HTTP3-åè®®è§£å†³äº†è¿™äº›é—®é¢˜ï¼š" class="headerlink" title="HTTP3 åè®®è§£å†³äº†è¿™äº›é—®é¢˜ï¼š"></a>HTTP3 åè®®è§£å†³äº†è¿™äº›é—®é¢˜ï¼š</h2><ul><li><code>é˜Ÿå¤´é˜»å¡</code>ï¼šHTTP3 åŸºäº UDP åè®®é‡æ–°å®šä¹‰äº†è¿æ¥ï¼Œåœ¨ QUIC å±‚å®ç°äº†æ— åºã€å¹¶å‘å­—èŠ‚æµçš„ä¼ è¾“ï¼Œè§£å†³äº†<code>é˜Ÿå¤´é˜»å¡é—®é¢˜</code>ï¼ˆåŒ…æ‹¬åŸºäº QPACK è§£å†³äº†åŠ¨æ€è¡¨çš„é˜Ÿå¤´é˜»å¡ï¼‰ï¼›</li><li><code>æ¡æ‰‹å»¶è¿Ÿ</code>ï¼šHTTP3 é‡æ–°å®šä¹‰äº† TLS åè®®åŠ å¯† QUIC å¤´éƒ¨çš„æ–¹å¼ï¼Œ<code>æ—¢æé«˜äº†ç½‘ç»œæ”»å‡»æˆæœ¬ï¼Œåˆé™ä½äº†å»ºç«‹è¿æ¥çš„é€Ÿåº¦</code>ï¼ˆä»…éœ€ 1 ä¸ª RTT å°±å¯ä»¥åŒæ—¶å®Œæˆå»ºé“¾ä¸å¯†é’¥åå•†ï¼‰ï¼›</li><li><code>ç§»åŠ¨æˆæœ¬é«˜</code>ï¼š HTTP3 å°† Packetã€QUIC Frameã€HTTP3 Frame åˆ†ç¦»ï¼Œå®ç°äº†è¿æ¥è¿ç§»åŠŸèƒ½ï¼Œ<code>é™ä½äº† 5G ç¯å¢ƒä¸‹é«˜é€Ÿç§»åŠ¨è®¾å¤‡çš„è¿æ¥ç»´æŠ¤æˆæœ¬</code>ã€‚</li></ul><h2 id="HTTP-çš„ç¼“å­˜çš„è¿‡ç¨‹"><a href="#HTTP-çš„ç¼“å­˜çš„è¿‡ç¨‹" class="headerlink" title="HTTP çš„ç¼“å­˜çš„è¿‡ç¨‹"></a>HTTP çš„ç¼“å­˜çš„è¿‡ç¨‹</h2><p>é€šå¸¸æƒ…å†µä¸‹çš„æ­¥éª¤æ˜¯:</p><ol><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè¯·æ±‚èµ„æº</li><li>æœåŠ¡å™¨è¿”å›èµ„æºï¼Œå¹¶é€šè¿‡å“åº”å¤´å†³å®šç¼“å­˜ç­–ç•¥</li><li>å®¢æˆ·ç«¯æ ¹æ®å“åº”å¤´çš„ç­–ç•¥å†³å®šæ˜¯å¦ç¼“å­˜èµ„æºï¼ˆè¿™â¾¥å‡è®¾æ˜¯ï¼‰ï¼Œå¹¶å°†å“åº”å¤´ä¸èµ„æºç¼“å­˜ä¸‹æ¥</li><li>åœ¨å®¢æˆ·ç«¯å†æ¬¡è¯·æ±‚ä¸”å‘½ä¸­èµ„æºçš„æ—¶å€™ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å»æ£€æŸ¥ä¸Šæ¬¡ç¼“å­˜çš„ç¼“å­˜ç­–ç•¥ï¼Œæ ¹æ®ç­–ç•¥çš„ä¸åŒã€æ˜¯å¦è¿‡æœŸç­‰åˆ¤æ–­ æ˜¯ç›´æ¥è¯»å–æœ¬åœ°ç¼“å­˜è¿˜æ˜¯ä¸æœåŠ¡å™¨åå•†ç¼“å­˜</li></ol><h2 id="å¼ºç¼“å­˜-x2F-åå•†ç¼“å­˜"><a href="#å¼ºç¼“å­˜-x2F-åå•†ç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜&#x2F;åå•†ç¼“å­˜"></a>å¼ºç¼“å­˜&#x2F;åå•†ç¼“å­˜</h2><h3 id="å¼ºç¼“å­˜"><a href="#å¼ºç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h3><p>å¼ºç¼“å­˜ç¦»ä¸å¼€ä¸¤ä¸ªå“åº”å¤´ <code>Expires</code> ä¸ <code>Cache-Control</code></p><p><strong>Expiresï¼š</strong></p><p>Expires æ˜¯ http1.0 æå‡ºçš„â¼€ä¸ªè¡¨ç¤ºèµ„æºè¿‡æœŸæ—¶é—´çš„ headerï¼Œ<code>å®ƒæè¿°çš„æ˜¯â¼€ä¸ªç»å¯¹æ—¶é—´</code>ï¼Œç”±æœåŠ¡å™¨è¿”å›ï¼Œ Expires å—é™äºæœ¬åœ°æ—¶é—´ï¼Œå¦‚æœä¿®æ”¹äº†æœ¬åœ°æ—¶é—´ï¼Œå¯èƒ½ä¼šé€ æˆç¼“å­˜å¤±æ•ˆ</p><p>Expires:<code>Wed, 11 May 2018 07:20:00 GMT</code> GMT æ—¶é—´æˆ³</p><p><strong>Cache-Control:</strong></p><p>Cache-Control å‡ºç°äº HTTP &#x2F; 1.1ï¼Œä¼˜å…ˆçº§â¾¼äº Expires ,<code>è¡¨ç¤ºçš„æ˜¯ç›¸å¯¹æ—¶é—´</code></p><p>Cache-Control: <code>max-age=315360000</code></p><p>â½¬å‰ä¸»æµçš„åšæ³•ä½¿â½¤ Cache-Control æ§åˆ¶ç¼“å­˜ï¼Œé™¤äº† max-age æ§åˆ¶è¿‡æœŸæ—¶é—´å¤–ï¼Œè¿˜æœ‰ï¼š</p><p>Cache-Control: <code>public </code>å¯ä»¥è¢«æ‰€æœ‰â½¤æˆ·ç¼“å­˜ï¼Œ<code>å…è®¸ç»ˆç«¯å’Œ CDN ç­‰ä¸­é—´ä»£ç†æœåŠ¡å™¨</code><br>Cache-Control: <code>private</code> åªèƒ½è¢«ç»ˆç«¯æµè§ˆå™¨ç¼“å­˜ï¼Œ<code>ä¸å…è®¸ä¸­ç»§ç¼“å­˜æœåŠ¡å™¨è¿›â¾ç¼“å­˜</code><br>Cache-Control: <code>no-cache</code>,<code>å…ˆç¼“å­˜æœ¬åœ°,è¦éªŒè¯</code>ï¼Œä½†æ˜¯åœ¨å‘½ä¸­ç¼“å­˜ä¹‹åå¿…é¡»ä¸æœåŠ¡å™¨éªŒè¯ç¼“å­˜çš„æ–°é²œåº¦æ‰èƒ½ä½¿â½¤<br>Cache-Control: <code>no-store</code>ï¼Œ<code>ä¸ä¼šäº§â½£ä»»ä½•ç¼“å­˜</code></p><p>åœ¨ç¼“å­˜æœ‰æ•ˆæœŸå†…å‘½ä¸­ç¼“å­˜ï¼Œæµè§ˆå™¨ä¼šç›´æ¥è¯»å–æœ¬åœ°çš„ç¼“å­˜èµ„æºï¼Œå½“ç¼“å­˜è¿‡æœŸä¹‹åä¼šä¸æœåŠ¡å™¨è¿›â¾åå•†ã€‚</p><p>æœåŠ¡å™¨åˆ¤æ–­ç¼“å­˜æ˜¯å¦æ˜¯æ–°é²œçš„â½…æ³•å°±æ˜¯ä¾é  HTTP çš„å¦å¤–ä¸¤ç»„ä¿¡æ¯</p><h2 id="Last-Modified-x2F-If-Modified-Since"><a href="#Last-Modified-x2F-If-Modified-Since" class="headerlink" title="Last-Modified&#x2F;If-Modified-Since"></a>Last-Modified&#x2F;If-Modified-Since</h2><p>å®¢æˆ·ç«¯â¾¸æ¬¡è¯·æ±‚èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨ä¼šæŠŠèµ„æºçš„æœ€æ–°ä¿®æ”¹æ—¶é—´</p><p><code>Last-Modified:Thu, 19 Feb 2019 08:20:55 GMT</code> é€šè¿‡å“åº”éƒ¨â¾¸å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå½“å†æ¬¡å‘é€è¯·æ±‚æ˜¯ï¼Œå®¢æˆ·ç«¯å°†æœåŠ¡å™¨è¿”å›çš„ä¿®æ”¹æ—¶é—´æ”¾åœ¨è¯·æ±‚å¤´</p><p><code>If-Modified-Since:Thu, 19 Feb 2019 08:20:55 GMT</code> å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†è·ŸæœåŠ¡å™¨ä¸Šçš„å¯¹åº”èµ„æºè¿›â¾â½å¯¹ï¼Œ</p><p>å¦‚æœæœåŠ¡å™¨çš„èµ„æºæ›´æ–°ï¼Œé‚£ä¹ˆè¿”å›æœ€æ–°çš„èµ„æºï¼Œæ­¤æ—¶çŠ¶æ€ç  200ï¼Œ<br>å½“æœåŠ¡å™¨èµ„æºè·Ÿå®¢æˆ·ç«¯çš„è¯·æ±‚çš„éƒ¨â¾¸æ—¶é—´â¼€è‡´ï¼Œè¯æ˜å®¢æˆ·ç«¯çš„èµ„æºæ˜¯æœ€æ–°çš„ï¼Œè¿”å› 304 çŠ¶æ€ç ï¼Œ è¡¨ç¤ºå®¢æˆ·ç«¯ç›´æ¥â½¤ç¼“å­˜å³å¯ã€‚</p><h2 id="ETag-x2F-If-None-Match"><a href="#ETag-x2F-If-None-Match" class="headerlink" title="ETag&#x2F;If-None-Match"></a>ETag&#x2F;If-None-Match</h2><p>ETag çš„æµç¨‹è·Ÿ Last-Modified æ˜¯ç±»ä¼¼çš„ï¼ŒåŒºåˆ«å°±åœ¨äº ETag æ˜¯<code>æ ¹æ®èµ„æºå†…å®¹è¿›â¾ hashï¼Œâ½£æˆâ¼€ä¸ªä¿¡æ¯æ‘˜è¦</code>ï¼Œåªè¦èµ„æºå†…å®¹æœ‰å˜åŒ–ï¼Œè¿™ä¸ªæ‘˜è¦å°±ä¼šå‘â½£å·¨å˜ï¼Œé€šè¿‡è¿™ä¸ªæ‘˜è¦ä¿¡æ¯â½å¯¹ï¼Œå³å¯ç¡®å®šå®¢æˆ·ç«¯çš„ç¼“å­˜èµ„æºæ˜¯å¦ä¸ºæœ€æ–°ï¼Œ<code>â½ Last-Modified çš„ç²¾ç¡®åº¦è¦æ›´â¾¼</code>ã€‚ å“åº”å¤´</p><img src="http://t-blog-images.aijs.top/img/20220716205210.png" /><p>æ•´ä½“çš„ç¼“å­˜æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><img src="http://t-blog-images.aijs.top/img/20220716205325.png" /><h2 id="HTTP-çŠ¶æ€ç ç›®å½•"><a href="#HTTP-çŠ¶æ€ç ç›®å½•" class="headerlink" title="HTTP çŠ¶æ€ç ç›®å½•"></a>HTTP çŠ¶æ€ç ç›®å½•</h2><ul><li><p>1xx æ¶ˆæ¯</p></li><li><p>2xx æˆåŠŸ</p></li><li><p>3xx é‡å®šå‘</p></li><li><p>4xx å®¢æˆ·ç«¯é”™è¯¯</p></li><li><p>5xx æœåŠ¡ç«¯é”™è¯¯</p></li></ul><h3 id="100-Continue"><a href="#100-Continue" class="headerlink" title="100 Continue"></a>100 Continue</h3><p>å“åº”çŠ¶æ€ç <code>100 Continue ä¿¡æ¯å‹çŠ¶æ€å“åº”ç </code>è¡¨ç¤ºï¼šç›®å‰ä¸ºæ­¢ä¸€åˆ‡æ­£å¸¸ï¼Œå®¢æˆ·ç«¯åº”è¯¥ç»§ç»­è¯·æ±‚ï¼Œå¦‚æœå·²å®Œæˆè¯·æ±‚åˆ™å¿½ç•¥ã€‚</p><p><span style="color: red">ä¸ºäº†è®©æœåŠ¡å™¨æ£€æŸ¥è¯·æ±‚çš„é¦–éƒ¨ï¼Œå®¢æˆ·ç«¯å¿…é¡»åœ¨å‘é€è¯·æ±‚å®ä½“å‰ï¼Œåœ¨åˆå§‹åŒ–è¯·æ±‚ä¸­å‘é€ Expect: 100-continue é¦–éƒ¨å¹¶æ¥æ”¶ 100 Continue å“åº”çŠ¶æ€ç ã€‚</span></p><h3 id="101-Switching-Protocol"><a href="#101-Switching-Protocol" class="headerlink" title="101 Switching Protocol"></a>101 Switching Protocol</h3><p>å“åº”çŠ¶æ€ç <code>101 Switching Protocolï¼ˆåè®®åˆ‡æ¢ï¼‰</code>çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨åº”å®¢æˆ·ç«¯å‡çº§åè®®çš„è¯·æ±‚ï¼ˆUpgrade (en-US)è¯·æ±‚å¤´ï¼‰æ­£åœ¨åˆ‡æ¢åè®®ã€‚</p><p>æœåŠ¡å™¨ä¼šå‘é€ä¸€ä¸ª Upgrade (en-US)å“åº”å¤´æ¥è¡¨æ˜å…¶æ­£åœ¨åˆ‡æ¢è¿‡å»çš„åè®®ã€‚</p><p>è¯¥è¿‡ç¨‹åœ¨åè®®å‡çº§æœºåˆ¶ï¼ˆProtocol upgrade mechanismï¼‰ä¸­è¯¦ç»†æè¿°ã€‚</p><p>åœ¨ä½¿ç”¨ WebSockets æ—¶ä¼šç”¨åˆ°åè®®åˆ‡æ¢ã€‚</p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 101 Switching ProtocolsUpgrade: websocketConnection: Upgrade</code></pre><h3 id="102-Processing"><a href="#102-Processing" class="headerlink" title="102 Processing"></a>102 Processing</h3><p>è¯·æ±‚å¯èƒ½åŒ…å«è®¸å¤šæ¶‰åŠæ–‡ä»¶æ“ä½œçš„å­è¯·æ±‚ï¼Œéœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆè¯·æ±‚ã€‚è¯¥ä»£ç è¡¨ç¤ºæœåŠ¡å™¨å·²ç»æ”¶åˆ°å¹¶æ­£åœ¨å¤„ç†è¯·æ±‚ï¼Œä½†æ— å“åº”å¯ç”¨ã€‚è¿™æ ·å¯<code>ä»¥é˜²æ­¢å®¢æˆ·ç«¯è¶…æ—¶</code>ï¼Œå¹¶å‡è®¾è¯·æ±‚ä¸¢å¤±ã€‚</p><h3 id="103-Early-Hints"><a href="#103-Early-Hints" class="headerlink" title="103 Early Hints"></a>103 Early Hints</h3><p>å“åº”çŠ¶æ€ç  <code>103 Early Hints ä¿¡æ¯çŠ¶æ€</code>å“åº”ç ï¼Œä¸€èˆ¬å’Œ <code>Link headerï¼ˆé¦–éƒ¨ï¼‰</code>ä¸€èµ·ä½¿ç”¨ï¼Œ<span style="color: red">æ¥å…è®¸ç”¨æˆ·åœ¨æœåŠ¡å™¨è¿˜åœ¨å‡†å¤‡å“åº”æ•°æ®çš„æ—¶å€™é¢„åŠ è½½ä¸€äº›èµ„æº</span></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>HTTP å®ä½“æŠ¥å¤´ Link æä¾›äº†åºåˆ—åŒ– HTTP å¤´éƒ¨é“¾æ¥çš„æ–¹æ³•ã€‚å®ƒåœ¨è¯­ä¹‰ä¸Šä¸ HTML å…ƒç´  <link> ç›¸ç­‰</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; link å¤´éƒ¨åŒ…å«ä»¥ ; åˆ†éš”çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¸ HTML å…ƒç´  &lt;link&gt; çš„å±æ€§ä¸€è‡´ã€‚&#x2F;&#x2F; URI å¿…é¡»è¦ç”¨ &lt; å’Œ &gt; æ¥å…³é—­ï¼š&#x2F;&#x2F; Link: &lt;https:&#x2F;&#x2F;example.com&gt;; rel&#x3D;&quot;preload&quot;</code></pre><h3 id="200-OK"><a href="#200-OK" class="headerlink" title="200 OK"></a>200 OK</h3><p>å“åº”çŠ¶æ€ç  <code>200 OK</code> è¡¨æ˜è¯·æ±‚å·²ç»æˆåŠŸã€‚é»˜è®¤æƒ…å†µä¸‹çŠ¶æ€ç ä¸º 200 çš„å“åº”å¯ä»¥è¢«ç¼“å­˜ã€‚</p><p><span style="color: red">ä¸åŒè¯·æ±‚æ–¹å¼å¯¹äºè¯·æ±‚æˆåŠŸçš„æ„ä¹‰å¦‚ä¸‹ï¼š</span></p><ul><li><code>HEAD:</code> å“åº”çš„æ¶ˆæ¯ä½“ä¸ºå¤´éƒ¨ä¿¡æ¯ã€‚</li><li><code>GET:</code> å·²ç»å–å¾—èµ„æºï¼Œå¹¶å°†èµ„æºæ·»åŠ åˆ°å“åº”çš„æ¶ˆæ¯ä½“ä¸­ã€‚</li><li><code>POST:</code> å“åº”çš„æ¶ˆæ¯ä½“ä¸­åŒ…å«æ­¤æ¬¡è¯·æ±‚çš„ç»“æœã€‚</li><li><code>TRACE:</code> <span style="color: red">å“åº”çš„æ¶ˆæ¯ä½“ä¸­åŒ…å«æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚ä¿¡æ¯</span>ã€‚</li><li><code>PUT</code> å’Œ <code>DELETE</code> çš„è¯·æ±‚æˆåŠŸé€šå¸¸å¹¶ä¸æ˜¯å“åº”<code>200 OK</code>çš„çŠ¶æ€ç , è€Œæ˜¯ <code>204 No Content</code> è¡¨ç¤ºæ— å†…å®¹ï¼ˆæˆ–è€… <code>201 Created</code>è¡¨ç¤ºä¸€ä¸ªèµ„æºé¦–æ¬¡è¢«åˆ›å»ºæˆåŠŸï¼‰ã€‚</li></ul><img src="https://img0.baidu.com/it/u=2485422989,671633180&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"  style="width: 200px"/><h3 id="201-Created"><a href="#201-Created" class="headerlink" title="201 Created"></a>201 Created</h3><p>å“åº”çŠ¶æ€ç <code>201 Created</code> æ˜¯ä¸€ä¸ªä»£è¡¨æˆåŠŸçš„åº”ç­”çŠ¶æ€ç ï¼Œ<strong>è¡¨ç¤ºè¯·æ±‚å·²ç»è¢«æˆåŠŸå¤„ç†ï¼Œå¹¶ä¸”åˆ›å»ºäº†æ–°çš„èµ„æº</strong>ã€‚<br>æ–°çš„èµ„æºåœ¨åº”ç­”è¿”å›ä¹‹å‰å·²ç»è¢«åˆ›å»ºã€‚åŒæ—¶æ–°å¢çš„èµ„æºä¼šåœ¨åº”ç­”æ¶ˆæ¯ä½“ä¸­è¿”å›ï¼Œå…¶åœ°å€æˆ–è€…æ˜¯åŸå§‹è¯·æ±‚çš„è·¯å¾„ï¼Œæˆ–è€…æ˜¯ Location é¦–éƒ¨çš„å€¼ã€‚(TODOï¼šååŠå¥æ²¡ææ‡‚)</p><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><p>è¿™ä¸ªçŠ¶æ€ç çš„å¸¸è§„ä½¿ç”¨åœºæ™¯æ˜¯ä½œä¸º POST è¯·æ±‚çš„è¿”å›å€¼</p><h3 id="202-Accepted"><a href="#202-Accepted" class="headerlink" title="202 Accepted"></a>202 Accepted</h3><p>å“åº”çŠ¶æ€ç <code>202 Accepted è¡¨ç¤ºæœåŠ¡å™¨ç«¯å·²ç»æ”¶åˆ°è¯·æ±‚æ¶ˆæ¯ï¼Œä½†æ˜¯å°šæœªè¿›è¡Œå¤„ç†ã€‚</code></p><p>ä½†æ˜¯å¯¹äºè¯·æ±‚çš„å¤„ç†ç¡®å®æ— ä¿è¯çš„ï¼Œå³ç¨åæ— æ³•é€šè¿‡ HTTP åè®®ç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚æ¥å‘ŠçŸ¥å…¶è¯·æ±‚çš„å¤„ç†ç»“æœã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><p>è¿™ä¸ªçŠ¶æ€ç è¢«è®¾è®¡ <strong>ç”¨æ¥å°†è¯·æ±‚äº¤ç”±å¦å¤–ä¸€ä¸ªè¿›ç¨‹æˆ–è€…æœåŠ¡å™¨æ¥è¿›è¡Œå¤„ç†ï¼Œæˆ–è€…æ˜¯å¯¹è¯·æ±‚è¿›è¡Œæ‰¹å¤„ç†çš„æƒ…å½¢ã€‚</strong></p><h3 id="203-Non-Authoritative-Information"><a href="#203-Non-Authoritative-Information" class="headerlink" title="203 Non-Authoritative Information"></a>203 Non-Authoritative Information</h3><p>å“åº”çŠ¶æ€ç  <code>203 Non-Authoritative Information</code> è¡¨ç¤ºè¯·æ±‚å·²ç»æˆåŠŸè¢«å“åº”ï¼Œä½†æ˜¯è·å¾—çš„è´Ÿè½½ä¸æºå¤´æœåŠ¡å™¨çš„çŠ¶æ€ç ä¸º<code>200 (OK)</code>çš„å“åº”ç›¸æ¯”ï¼Œ<strong>ç»è¿‡äº†æ‹¥æœ‰è½¬æ¢åŠŸèƒ½çš„ <code>proxy</code>ï¼ˆä»£ç†æœåŠ¡å™¨ï¼‰çš„ä¿®æ”¹</strong>ã€‚</p><p><strong>TODO:ä¸æ‡‚</strong><br>å“åº”çŠ¶æ€ç <code> 203 çŠ¶æ€ç </code>æœ‰ç‚¹ç±»ä¼¼äº Warning é¦–éƒ¨çš„<code> 214ï¼ˆTransformation Appliedï¼‰</code>è­¦å‘Šç ï¼Œåè€…çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥åº”ç”¨äºä»»ä½•çŠ¶æ€ç çš„å“åº”ä¹‹ä¸­ã€‚</p><h3 id="204-No-Content"><a href="#204-No-Content" class="headerlink" title="204 No Content"></a>204 No Content</h3><p>å“åº”çŠ¶æ€ç <code>204 No Content</code> æˆåŠŸçŠ¶æ€å“åº”ç ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚å·²ç»æˆåŠŸäº†ï¼Œä½†æ˜¯<strong>å®¢æˆ·ç«¯å®¢æˆ·ä¸éœ€è¦ç¦»å¼€å½“å‰é¡µé¢</strong>ã€‚é»˜è®¤æƒ…å†µä¸‹ <code>204</code> å“åº”æ˜¯å¯ç¼“å­˜çš„ã€‚ä¸€ä¸ª ETag æ ‡å¤´åŒ…å«åœ¨æ­¤ç±»å“åº”ä¸­ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><p>ä½¿ç”¨æƒ¯ä¾‹æ˜¯: åœ¨<code> PUT è¯·æ±‚</code>ä¸­è¿›è¡Œèµ„æºæ›´æ–°ï¼Œä½†æ˜¯</p><ul><li>ä¸éœ€è¦æ”¹å˜å½“å‰å±•ç¤ºç»™ç”¨æˆ·çš„é¡µé¢ï¼Œé‚£ä¹ˆè¿”å› <code>204 No Content</code>ã€‚</li><li>å¦‚æœåˆ›å»ºäº†èµ„æºï¼Œåˆ™è¿”å›<code> 201 Created</code> ã€‚</li><li>å¦‚æœåº”å°†é¡µé¢æ›´æ”¹ä¸ºæ–°æ›´æ–°çš„é¡µé¢ï¼Œåˆ™åº”æ”¹ç”¨ 200 ã€‚</li></ul><h3 id="205-Reset-Content"><a href="#205-Reset-Content" class="headerlink" title="205 Reset Content"></a>205 Reset Content</h3><p>å“åº”çŠ¶æ€ç <code>205 Reset Content</code> ç”¨æ¥é€šçŸ¥å®¢æˆ·ç«¯é‡ç½®æ–‡æ¡£è§†å›¾ï¼Œæ¯”å¦‚<code>æ¸…ç©ºè¡¨å•å†…å®¹</code>ã€<code>é‡ç½® canvas çŠ¶æ€</code>æˆ–è€…<code>åˆ·æ–°ç”¨æˆ·ç•Œé¢</code>ã€‚</p><h3 id="206-Partial-Content"><a href="#206-Partial-Content" class="headerlink" title="206 Partial Content"></a>206 Partial Content</h3><p>å“åº”çŠ¶æ€ç <code>206 Partial Content</code>æˆåŠŸçŠ¶æ€å“åº”ä»£ç è¡¨ç¤ºè¯·æ±‚å·²æˆåŠŸï¼Œå¹¶ä¸”ä¸»ä½“åŒ…å«æ‰€è¯·æ±‚çš„æ•°æ®åŒºé—´ï¼Œè¯¥æ•°æ®åŒºé—´æ˜¯åœ¨è¯·æ±‚çš„ <code>Range</code> é¦–éƒ¨æŒ‡å®šçš„ã€‚</p><ul><li>å¦‚æœåªåŒ…å«ä¸€ä¸ªæ•°æ®åŒºé—´ï¼Œé‚£ä¹ˆæ•´ä¸ªå“åº”çš„ <code>Content-Type</code> é¦–éƒ¨çš„å€¼ä¸ºæ‰€è¯·æ±‚çš„æ–‡ä»¶çš„ç±»å‹ï¼ŒåŒæ—¶åŒ…å« <code>Content-Range</code> é¦–éƒ¨ã€‚</li><li>å¦‚æœåŒ…å«å¤šä¸ªæ•°æ®åŒºé—´ï¼Œé‚£ä¹ˆæ•´ä¸ªå“åº”çš„ <code>Content-Type</code> é¦–éƒ¨çš„å€¼ä¸º <code>multipart/byteranges</code> ï¼Œå…¶ä¸­ä¸€ä¸ªç‰‡æ®µå¯¹åº”ä¸€ä¸ªæ•°æ®åŒºé—´ï¼Œå¹¶æä¾› <code>Content-Range</code> å’Œ <code>Content-Type</code> æè¿°ä¿¡æ¯ã€‚</li></ul><p><strong>åªåŒ…å«ä¸€ä¸ªæ•°æ®åŒºé—´çš„å“åº”ï¼š</strong></p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 206 Partial ContentDate: Wed, 15 Nov 2015 06:25:24 GMTLast-Modified: Wed, 15 Nov 2015 04:58:08 GMT# è¿™é‡ŒContent-Range: bytes 21010-47021&#x2F;47022Content-Length: 26012Content-Type: image&#x2F;gif... 26012 bytes of partial image data ...</code></pre><p><strong>åŒ…å«å¤šä¸ªæ•°æ®åŒºé—´çš„å“åº”ï¼š</strong></p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 206 Partial ContentDate: Wed, 15 Nov 2015 06:25:24 GMTLast-Modified: Wed, 15 Nov 2015 04:58:08 GMTContent-Length: 1741Content-Type: multipart&#x2F;byteranges; boundary&#x3D;String_separator--String_separatorContent-Type: application&#x2F;pdf # è¿™é‡ŒContent-Range: bytes 234-639&#x2F;8000 # è¿™é‡Œ...the first range...--String_separatorContent-Type: application&#x2F;pdf # è¿™é‡ŒContent-Range: bytes 4590-7999&#x2F;8000 # è¿™é‡Œ...the second range--String_separator--</code></pre><h3 id="300-Multiple-Choices"><a href="#300-Multiple-Choices" class="headerlink" title="300 Multiple Choices"></a>300 Multiple Choices</h3><p>å“åº”çŠ¶æ€ç <code>300 Multiple Choices</code> æ˜¯ä¸€ä¸ªç”¨æ¥è¡¨ç¤ºé‡å®šå‘çš„å“åº”çŠ¶æ€ç ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚æ‹¥æœ‰å¤šç§å¯èƒ½çš„å“åº”ã€‚ç”¨æˆ·ä»£ç†æˆ–è€…ç”¨æˆ·è‡ªèº«åº”è¯¥ä»ä¸­é€‰æ‹©ä¸€ä¸ªã€‚ç”±äºæ²¡æœ‰å¦‚ä½•è¿›è¡Œé€‰æ‹©çš„æ ‡å‡†æ–¹æ³•ï¼Œè¿™ä¸ªçŠ¶æ€ç æå°‘ä½¿ç”¨ã€‚</p><p>å‡å¦‚æœåŠ¡å™¨å¯ä»¥æä¾›ä¸€ä¸ªä¼˜å…ˆé€‰æ‹©ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ç”Ÿæˆä¸€ä¸ª <code>Location</code> é¦–éƒ¨ã€‚</p><h3 id="301-Moved-Permanently"><a href="#301-Moved-Permanently" class="headerlink" title="301 Moved Permanently"></a>301 Moved Permanently</h3><p>å“åº”çŠ¶æ€ç <code>301 æ°¸ä¹…é‡å®šå‘ </code>è¯´æ˜è¯·æ±‚çš„èµ„æºå·²ç»è¢«ç§»åŠ¨åˆ°äº†ç”± <code>Location</code> å¤´éƒ¨æŒ‡å®šçš„ <code>url</code> ä¸Šï¼Œæ˜¯å›ºå®šçš„ä¸ä¼šå†æ”¹å˜ã€‚</p><p><span style="color: red">æœç´¢å¼•æ“ä¼šæ ¹æ®è¯¥å“åº”ä¿®æ­£ã€‚</span></p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>å°½ç®¡æ ‡å‡†è¦æ±‚æµè§ˆå™¨åœ¨æ”¶åˆ°è¯¥å“åº”å¹¶è¿›è¡Œé‡å®šå‘æ—¶, ä¸åº”è¯¥ä¿®æ”¹<code>http method</code> å’Œ <code>body</code>ï¼Œä½†æ˜¯æœ‰ä¸€äº›æµè§ˆå™¨å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚æ‰€ä»¥æœ€å¥½æ˜¯åœ¨åº”å¯¹ <code>GET</code> æˆ– <code>HEAD</code> æ–¹æ³•æ—¶ä½¿ç”¨ <code>301</code>ï¼Œå…¶ä»–æƒ…å†µä½¿ç”¨ <code>308</code> æ¥æ›¿ä»£ <code>301</code>ã€‚</p></div><h3 id="302-Found"><a href="#302-Found" class="headerlink" title="302 Found"></a>302 Found</h3><p>å“åº”çŠ¶æ€ç <code>302 Found é‡å®šå‘çŠ¶æ€ç </code>,è¡¨æ˜è¯·æ±‚çš„èµ„æºè¢«æš‚æ—¶çš„ç§»åŠ¨åˆ°äº†ç”±è¯¥ <code>HTTP</code> å“åº”çš„å“åº”å¤´ <code>Location</code> æŒ‡å®šçš„ <code>URL</code> ä¸Šã€‚æµè§ˆå™¨ä¼šé‡å®šå‘åˆ°è¿™ä¸ª <code>URL</code>ï¼Œä½†æ˜¯æœç´¢å¼•æ“ä¸ä¼šå¯¹è¯¥èµ„æºçš„é“¾æ¥è¿›è¡Œæ›´æ–° (In SEO-speak, it is said that the link-juice is not sent to the new URL)ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>å³ä½¿è§„èŒƒè¦æ±‚æµè§ˆå™¨åœ¨é‡å®šå‘æ—¶ä¿è¯è¯·æ±‚æ–¹æ³•å’Œè¯·æ±‚ä¸»ä½“ä¸å˜ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç”¨æˆ·ä»£ç†éƒ½ä¼šéµå¾ªè¿™ä¸€ç‚¹ï¼Œä½ ä¾ç„¶å¯ä»¥çœ‹åˆ°æœ‰ç¼ºé™·çš„è½¯ä»¶çš„å­˜åœ¨ã€‚</p><p>æ‰€ä»¥æ¨èä»…åœ¨å“åº” <code>GET</code> æˆ– <code>HEAD</code> æ–¹æ³•æ—¶é‡‡ç”¨ <code>302</code> çŠ¶æ€ç ï¼Œ<br>è€Œåœ¨å…¶ä»–æ—¶å€™ä½¿ç”¨ <code>307 Temporary Redirect</code> æ¥æ›¿ä»£ï¼Œ<span style="color: red">å› ä¸ºåœ¨è¿™äº›åœºæ™¯ä¸‹æ–¹æ³•å˜æ¢æ˜¯æ˜ç¡®ç¦æ­¢çš„</span>ã€‚</p></div><p>åœ¨ç¡®å®éœ€è¦å°†é‡å®šå‘è¯·æ±‚çš„æ–¹æ³•è½¬æ¢ä¸º GET çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>303 See Other</code>ã€‚</p><p><strong>ä¾‹å¦‚:</strong></p><p>åœ¨ä½¿ç”¨ PUT æ–¹æ³•è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ“ä½œæ—¶ï¼Œéœ€è¦è¿”å›ç¡®è®¤ä¿¡æ¯ï¼ˆä¾‹å¦‚â€œä½ å·²ç»æˆåŠŸä¸Šä¼ äº† xyzâ€ï¼‰è€Œä¸æ˜¯ä¸Šä¼ çš„èµ„æºæœ¬èº«ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªçŠ¶æ€ç ã€‚</p><h3 id="303-See-Other"><a href="#303-See-Other" class="headerlink" title="303 See Other"></a>303 See Other</h3><p>å“åº”çŠ¶æ€ç <code>303 See Other é‡å®šå‘çŠ¶æ€ç </code>ï¼Œ<code>é€šå¸¸ä½œä¸º PUT æˆ– POST æ“ä½œçš„è¿”å›ç»“æœ</code>ï¼Œå®ƒè¡¨ç¤ºé‡å®šå‘é“¾æ¥æŒ‡å‘çš„ä¸æ˜¯æ–°ä¸Šä¼ çš„èµ„æºï¼Œè€Œæ˜¯å¦å¤–ä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚æ¶ˆæ¯ç¡®è®¤é¡µé¢æˆ–ä¸Šä¼ è¿›åº¦é¡µé¢ã€‚è€Œè¯·æ±‚é‡å®šå‘é¡µé¢çš„æ–¹æ³•è¦æ€»æ˜¯ä½¿ç”¨ GET</p><h3 id="304-Not-Modified"><a href="#304-Not-Modified" class="headerlink" title="304 Not Modified"></a>304 Not Modified</h3><p>å“åº”çŠ¶æ€ç <code>304 æœªæ”¹å˜è¯´æ˜æ— éœ€å†æ¬¡ä¼ è¾“è¯·æ±‚çš„å†…å®¹</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„å†…å®¹ã€‚è¿™é€šå¸¸æ˜¯åœ¨ä¸€äº›å®‰å…¨çš„æ–¹æ³•ï¼ˆsafeï¼‰ï¼Œä¾‹å¦‚ GET æˆ– HEAD æˆ–åœ¨è¯·æ±‚ä¸­é™„å¸¦äº†å¤´éƒ¨ä¿¡æ¯ï¼š <code>If-None-Match</code> æˆ– <code>If-Modified-Since</code>ã€‚</p><p>å¦‚æœæ˜¯ <code>200 OK</code> ï¼Œå“åº”ä¼šå¸¦æœ‰å¤´éƒ¨<code> Cache-Control</code>, <code>Content-Location</code>, <code>Date</code>, <code>ETag</code>, <code>Expires</code>ï¼Œå’Œ <code>Vary</code>.</p><h3 id="305-Use-Proxy"><a href="#305-Use-Proxy" class="headerlink" title="305 Use Proxy"></a>305 Use Proxy</h3><p>è¢«è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡æŒ‡å®šçš„ä»£ç†æ‰èƒ½è¢«è®¿é—®</p><h3 id="306-Switch-Proxy-åºŸå¼ƒ"><a href="#306-Switch-Proxy-åºŸå¼ƒ" class="headerlink" title="306 Switch Proxy åºŸå¼ƒ"></a>306 Switch Proxy åºŸå¼ƒ</h3><p>306 çŠ¶æ€ç å·²ç»ä¸å†è¢«ä½¿ç”¨ã€‚æœ€åˆæ˜¯æŒ‡â€œåç»­è¯·æ±‚åº”ä½¿ç”¨æŒ‡å®šçš„ä»£ç†â€</p><h3 id="307-Temporary-Redirect"><a href="#307-Temporary-Redirect" class="headerlink" title="307 Temporary Redirect"></a>307 Temporary Redirect</h3><p>å“åº”çŠ¶æ€ç <code>307 Temporary Redirectï¼Œä¸´æ—¶é‡å®šå‘å“åº”çŠ¶æ€ç </code>ï¼Œè¡¨ç¤ºè¯·æ±‚çš„èµ„æºæš‚æ—¶åœ°è¢«ç§»åŠ¨åˆ°äº†å“åº”çš„ Location é¦–éƒ¨æ‰€æŒ‡å‘çš„ URL ä¸Šã€‚</p><p>åŸå§‹è¯·æ±‚ä¸­çš„è¯·æ±‚æ–¹æ³•å’Œæ¶ˆæ¯ä¸»ä½“ä¼šåœ¨é‡å®šå‘è¯·æ±‚ä¸­è¢«é‡ç”¨ã€‚åœ¨ç¡®å®éœ€è¦å°†é‡å®šå‘è¯·æ±‚çš„æ–¹æ³•è½¬æ¢ä¸º <code>GET</code> çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>303 See Other</code> çŠ¶æ€ç ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨ PUT æ–¹æ³•è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ“ä½œæ—¶ï¼Œå¦‚æœéœ€è¦è¿”å›ä¸€æ¡ç¡®è®¤ä¿¡æ¯ï¼ˆä¾‹å¦‚â€œä½ å·²ç»æˆåŠŸä¸Šä¼ äº† XYZâ€ï¼‰ï¼Œè€Œä¸æ˜¯è¿”å›ä¸Šä¼ çš„èµ„æºæœ¬èº«ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªçŠ¶æ€ç ã€‚</p><h3 id="307-302-çš„åŒºåˆ«"><a href="#307-302-çš„åŒºåˆ«" class="headerlink" title="307,302 çš„åŒºåˆ«"></a>307,302 çš„åŒºåˆ«</h3><p><span style="color: red">å½“å‘é€é‡å®šå‘è¯·æ±‚çš„æ—¶å€™ï¼Œ307 çŠ¶æ€ç å¯ä»¥ç¡®ä¿è¯·æ±‚æ–¹æ³•å’Œæ¶ˆæ¯ä¸»ä½“ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚</span></p><ul><li>å¦‚æœä½¿ç”¨ 302 å“åº”çŠ¶æ€ç ï¼Œä¸€äº›æ—§å®¢æˆ·ç«¯ä¼šé”™è¯¯åœ°å°†è¯·æ±‚æ–¹æ³•è½¬æ¢ä¸º GETï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ Web ä¸­ï¼Œå¦‚æœä½¿ç”¨äº† GET ä»¥å¤–çš„è¯·æ±‚æ–¹æ³•ï¼Œä¸”è¿”å›äº† 302 çŠ¶æ€ç ï¼Œåˆ™é‡å®šå‘åçš„è¯·æ±‚æ–¹æ³•æ˜¯ä¸å¯é¢„æµ‹çš„ï¼›<br/><br/></li><li>ä½†å¦‚æœä½¿ç”¨ 307 çŠ¶æ€ç ï¼Œä¹‹åçš„è¯·æ±‚æ–¹æ³•å°±æ˜¯å¯é¢„æµ‹çš„ã€‚å¯¹äº GET è¯·æ±‚æ¥è¯´ï¼Œä¸¤ç§æƒ…å†µæ²¡æœ‰åŒºåˆ«ã€‚</li></ul><h3 id="308-Permanent-Redirect"><a href="#308-Permanent-Redirect" class="headerlink" title="308 Permanent Redirect"></a>308 Permanent Redirect</h3><p>åœ¨ HTTP åè®®ä¸­ï¼Œ <code>308 Permanent Redirectï¼ˆæ°¸ä¹…é‡å®šå‘ï¼‰</code>æ˜¯è¡¨ç¤ºé‡å®šå‘çš„å“åº”çŠ¶æ€ç ï¼Œè¯´æ˜è¯·æ±‚çš„èµ„æºå·²ç»è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°äº†ç”± Location é¦–éƒ¨æŒ‡å®šçš„ URL ä¸Šã€‚æµè§ˆå™¨ä¼šè¿›è¡Œé‡å®šå‘ï¼ŒåŒæ—¶æœç´¢å¼•æ“ä¹Ÿä¼šæ›´æ–°å…¶é“¾æ¥ï¼ˆç”¨ SEO çš„è¡Œè¯æ¥è¯´ï¼Œæ„æ€æ˜¯â€œé“¾æ¥æ±â€ï¼ˆlink juiceï¼‰è¢«ä¼ é€’åˆ°äº†æ–°çš„ URLï¼‰ã€‚</p><p>åœ¨é‡å®šå‘è¿‡ç¨‹ä¸­ï¼Œ<code>è¯·æ±‚æ–¹æ³•å’Œæ¶ˆæ¯ä¸»ä½“ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œç„¶è€Œåœ¨è¿”å› 301 çŠ¶æ€ç çš„æƒ…å†µä¸‹ï¼Œè¯·æ±‚æ–¹æ³•æœ‰æ—¶å€™ä¼šè¢«å®¢æˆ·ç«¯é”™è¯¯åœ°ä¿®æ”¹ä¸º GET æ–¹æ³•</code>ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>ä¸€äº› Web åº”ç”¨å¯èƒ½ä¼šå°† <code>308 Permanent Redirect</code> ä»¥ä¸€ç§éæ ‡å‡†çš„æ–¹å¼ä½¿ç”¨ä»¥åŠç”¨ä½œå…¶ä»–ç”¨é€”ã€‚ä¾‹å¦‚ï¼ŒGoogle Drive ä¼šä½¿ç”¨ 308 Resume Incomplete çŠ¶æ€ç æ¥å‘ŠçŸ¥å®¢æˆ·ç«¯æ–‡ä»¶ä¸Šä¼ ç»ˆæ­¢ä¸”ä¸å®Œæ•´</div><h3 id="301-302-303-307-308-åŒºåˆ«"><a href="#301-302-303-307-308-åŒºåˆ«" class="headerlink" title="301,302,303,307,308 åŒºåˆ«"></a>301,302,303,307,308 åŒºåˆ«</h3><p><code>301,308 æ°¸ä¹…é‡å®šå‘</code>(æœ‰å…¼å®¹é—®é¢˜)</p><ul><li>è¯·æ±‚æ–¹æ³•å’Œæ¶ˆæ¯ä¸»ä½“ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œç„¶è€Œåœ¨è¿”å›<code> 301 çŠ¶æ€ç </code>çš„æƒ…å†µä¸‹ï¼Œ<code>è¯·æ±‚æ–¹æ³•æœ‰æ—¶å€™ä¼šè¢«å®¢æˆ·ç«¯é”™è¯¯åœ°ä¿®æ”¹ä¸º GET æ–¹æ³•</code></li><li>Google Drive ä¼šä½¿ç”¨ <code>308 Resume Incomplete</code> çŠ¶æ€ç æ¥å‘ŠçŸ¥å®¢æˆ·ç«¯æ–‡ä»¶ä¸Šä¼ ç»ˆæ­¢ä¸”ä¸å®Œæ•´</li></ul><p><code>302,303,307 ä¸´æ—¶é‡å®šå‘</code>,</p><ul><li>å¯¹åº” GET æ–¹æ³•ï¼Œ302 å’Œ 307 æ²¡æœ‰åŒºåˆ«ï¼Œ</li><li>å¯¹äº HEADï¼Œ302 ä¸ä¼šæ”¹å˜,307 ä¼šå˜</li><li>å…¶ä»–è¯·æ±‚æ–¹æ³•ï¼Œ302 ä¼šæ”¹æˆ GET è¯·æ±‚ï¼Œ303 è¡¨ç¤ºéƒ½è¦å˜æˆ GETï¼Œ307 ä¿æŒè¯·æ±‚æ–¹æ³•ä¸å˜</li></ul><p><strong>å˜ GET</strong>: <code>302(ä¿ç•™GET,HEAD) &lt; 307(ä¿ç•™HEAD) &lt; 303(å…¨éƒ¨)</code></p><h3 id="400-Bad-Request"><a href="#400-Bad-Request" class="headerlink" title="400 Bad Request"></a>400 Bad Request</h3><p>å“åº”çŠ¶æ€ç <code>400 Bad Request </code>å“åº”çŠ¶æ€ç è¡¨ç¤º: <code>ç”±äºè¯­æ³•æ— æ•ˆï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£è¯¥è¯·æ±‚</code>ã€‚ å®¢æˆ·ç«¯ä¸åº”è¯¥åœ¨æœªç»ä¿®æ”¹çš„æƒ…å†µä¸‹é‡å¤æ­¤è¯·æ±‚ã€‚</p><h3 id="401-Unauthorized"><a href="#401-Unauthorized" class="headerlink" title="401 Unauthorized"></a>401 Unauthorized</h3><p>å“åº”çŠ¶æ€ç  <code>401 Unauthorized</code> ä»£è¡¨å®¢æˆ·ç«¯é”™è¯¯ï¼ŒæŒ‡çš„æ˜¯: <code>ç”±äºç¼ºä¹ç›®æ ‡èµ„æºè¦æ±‚çš„èº«ä»½éªŒè¯å‡­è¯ï¼Œå‘é€çš„è¯·æ±‚æœªå¾—åˆ°æ»¡è¶³</code>ã€‚</p><p>è¿™ä¸ªçŠ¶æ€ç ä¼šä¸ WWW-Authenticate é¦–éƒ¨ä¸€èµ·å‘é€ï¼Œå…¶ä¸­åŒ…å«æœ‰å¦‚ä½•è¿›è¡ŒéªŒè¯çš„ä¿¡æ¯ã€‚</p><p>è¿™ä¸ªçŠ¶æ€ç±»ä¼¼äº 403ï¼Œ ä½†æ˜¯åœ¨è¯¥æƒ…å†µä¸‹ï¼Œä¾ç„¶å¯ä»¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p><p><strong>å“åº”æ ·ä¾‹</strong></p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 401 UnauthorizedDate: Wed, 21 Oct 2015 07:28:00 GMTWWW-Authenticate: Basic realm&#x3D;&quot;Access to staging site&quot;</code></pre><h3 id="402-Payment-Required"><a href="#402-Payment-Required" class="headerlink" title="402 Payment Required"></a>402 Payment Required</h3><p>å“åº”çŠ¶æ€ç  <code>402 Payment Required</code> æ˜¯ä¸€ä¸ªè¢«ä¿ç•™ä½¿ç”¨çš„éæ ‡å‡†å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€å“åº”ç ã€‚</p><p>æœ‰æ—¶ï¼Œ è¿™ä¸ªçŠ¶æ€ç è¡¨æ˜ç›´åˆ°å®¢æˆ·ç«¯ä»˜è´¹ä¹‹åè¯·æ±‚æ‰ä¼šè¢«å¤„ç†ã€‚<strong>402 çŠ¶æ€ç è¢«åˆ›å»ºæœ€åˆç›®çš„æ˜¯ç”¨äºæ•°å­—ç°é‡‘æˆ–å¾®å‹æ”¯ä»˜ç³»ç»Ÿï¼Œ è¡¨æ˜å®¢æˆ·ç«¯è¯·æ±‚çš„å†…å®¹åªæœ‰ä»˜è´¹ä¹‹åæ‰èƒ½è·å–</strong>ã€‚ç›®å‰è¿˜ä¸å­˜åœ¨æ ‡å‡†çš„ä½¿ç”¨çº¦å®šï¼Œä¸åŒçš„å®ä½“å¯ä»¥åœ¨ä¸åŒçš„ç¯å¢ƒä¸‹ä½¿ç”¨ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>Experimental: è¿™æ˜¯ä¸€ä¸ªå®éªŒä¸­çš„åŠŸèƒ½<br>æ­¤åŠŸèƒ½æŸäº›æµè§ˆå™¨å°šåœ¨å¼€å‘ä¸­ï¼Œè¯·å‚è€ƒæµè§ˆå™¨å…¼å®¹æ€§è¡¨æ ¼ä»¥å¾—åˆ°åœ¨ä¸åŒæµè§ˆå™¨ä¸­é€‚åˆä½¿ç”¨çš„å‰ç¼€ã€‚ç”±äºè¯¥åŠŸèƒ½å¯¹åº”çš„æ ‡å‡†æ–‡æ¡£å¯èƒ½è¢«é‡æ–°ä¿®è®¢ï¼Œæ‰€ä»¥åœ¨æœªæ¥ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­è¯¥åŠŸèƒ½çš„è¯­æ³•å’Œè¡Œä¸ºå¯èƒ½éšä¹‹æ”¹å˜ã€‚</p></div><p><strong>å“åº”æ ·ä¾‹</strong></p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 402 Payment RequiredDate: Wed, 21 Oct 2015 07:28:00 GMT</code></pre><h3 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h3><p>å“åº”çŠ¶æ€ç <code>403 Forbidden</code>ï¼ŒæŒ‡çš„æ˜¯: <span style="color: red">æœåŠ¡å™¨ç«¯æœ‰èƒ½åŠ›å¤„ç†è¯¥è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æˆæƒè®¿é—®</span>ã€‚</p><p>è¿™ä¸ªçŠ¶æ€ç±»ä¼¼äº <code>401</code>ï¼Œä½†è¿›å…¥ <code>403</code>çŠ¶æ€å, å³ä½¿é‡æ–°éªŒè¯ä¹Ÿä¸ä¼šæ”¹å˜è¯¥çŠ¶æ€ã€‚è¯¥è®¿é—®æ˜¯é•¿æœŸç¦æ­¢çš„ï¼Œå¹¶ä¸”ä¸åº”ç”¨é€»è¾‘å¯†åˆ‡ç›¸å…³ï¼ˆä¾‹å¦‚æ²¡æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®è¯¥èµ„æºï¼‰ã€‚</p><h3 id="404-Not-Found"><a href="#404-Not-Found" class="headerlink" title="404 Not Found"></a>404 Not Found</h3><p>å“åº”çŠ¶æ€ç  <code>404 Not Found</code> æŒ‡çš„æ˜¯: æœåŠ¡å™¨æ— æ³•æ‰¾åˆ°æ‰€è¯·æ±‚çš„èµ„æºã€‚è¿”å›è¯¥å“åº”çš„é“¾æ¥é€šå¸¸ç§°ä¸º<code>åé“¾ï¼ˆbroken linkï¼‰</code>æˆ–<code>æ­»é“¾ï¼ˆdead linkï¼‰</code>ï¼Œå®ƒä»¬ä¼š<code>å¯¼å‘é“¾æ¥å‡ºé”™å¤„ç†ï¼ˆlink rotï¼‰</code>é¡µé¢ã€‚</p><p><span style="color: red">404 çŠ¶æ€ç å¹¶ä¸èƒ½è¯´æ˜è¯·æ±‚çš„èµ„æºæ˜¯ä¸´æ—¶è¿˜æ˜¯æ°¸ä¹…ä¸¢å¤±ã€‚å¦‚æœæœåŠ¡å™¨çŸ¥é“è¯¥èµ„æºæ˜¯æ°¸ä¹…ä¸¢å¤±ï¼Œé‚£ä¹ˆåº”è¯¥è¿”å› 410ï¼ˆGoneï¼‰è€Œä¸æ˜¯ 404 ã€‚</span></p><h3 id="405-Method-Not-Allowed"><a href="#405-Method-Not-Allowed" class="headerlink" title="405 Method Not Allowed"></a>405 Method Not Allowed</h3><p>å“åº”çŠ¶æ€ç  <code>405 Method Not Allowed</code> è¡¨æ˜æœåŠ¡å™¨ç¦æ­¢äº†ä½¿ç”¨å½“å‰ HTTP æ–¹æ³•çš„è¯·æ±‚ã€‚</p><p><strong>äº‹ä¾‹</strong></p><p>restful é£æ ¼ API,ä½¿ç”¨ä¸­ä¼šå‡ºç° <a href="https://blog.csdn.net/qq_42704130/article/details/125417805" target="_blank" >è§</a></p><h3 id="406-Not-Acceptable"><a href="#406-Not-Acceptable" class="headerlink" title="406 Not Acceptable"></a>406 Not Acceptable</h3><p>å“åº”çŠ¶æ€ç  <code>406 Not Acceptable</code>è¡¨ç¤º: å®¢æˆ·ç«¯é”™è¯¯ï¼ŒæŒ‡ä»£æœåŠ¡å™¨ç«¯æ— æ³•æä¾›ä¸ <code>Accept-Charset</code> ä»¥åŠ <code>Accept-Language</code> æ¶ˆæ¯å¤´æŒ‡å®šçš„å€¼ç›¸åŒ¹é…çš„å“åº”ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œ_è¿™ä¸ªé”™è¯¯çŠ¶æ€ç æå°‘ä½¿ç”¨_ï¼šä¸æ˜¯ç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªæ™¦æ¶©éš¾æ‡‚ï¼ˆä¸”éš¾ä»¥æ›´æ­£ï¼‰çš„é”™è¯¯çŠ¶æ€ç ï¼Œè€Œæ˜¯å°†ç›¸å…³çš„æ¶ˆæ¯å¤´å¿½ç•¥ï¼ŒåŒæ—¶ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªçœ‹å¾—è§æ‘¸å¾—ç€çš„é¡µé¢ã€‚è¿™ç§åšæ³•åŸºäºè¿™æ ·ä¸€ä¸ªå‡è®¾ï¼šå³ä¾¿æ˜¯ä¸èƒ½è¾¾åˆ°ç”¨æˆ·ååˆ†æ»¡æ„ï¼Œä¹Ÿå¼ºäºè¿”å›é”™è¯¯çŠ¶æ€ç ã€‚</p><p>å¦‚æœæœåŠ¡å™¨è¿”å›äº†è¿™ä¸ªé”™è¯¯çŠ¶æ€ç ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä½“ä¸­åº”è¯¥åŒ…å«æ‰€èƒ½æä¾›çš„èµ„æºè¡¨ç°å½¢å¼çš„åˆ—è¡¨ï¼Œå…è®¸ç”¨æˆ·æ‰‹åŠ¨è¿›è¡Œé€‰æ‹©ã€‚</p><h3 id="407-Proxy-Authentication-Required"><a href="#407-Proxy-Authentication-Required" class="headerlink" title="407 Proxy Authentication Required"></a>407 Proxy Authentication Required</h3><p>å“åº”çŠ¶æ€ç  <code>407 Proxy Authentication Required</code> ä»£è¡¨å®¢æˆ·ç«¯é”™è¯¯ï¼ŒæŒ‡çš„æ˜¯: ç”±äºç¼ºä¹ä½äºæµè§ˆå™¨ä¸å¯ä»¥è®¿é—®æ‰€è¯·æ±‚èµ„æºçš„æœåŠ¡å™¨ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ï¼ˆproxy server ï¼‰è¦æ±‚çš„èº«ä»½éªŒè¯å‡­è¯ï¼Œå‘é€çš„è¯·æ±‚å°šæœªå¾—åˆ°æ»¡è¶³ã€‚</p><p>è¿™ä¸ªçŠ¶æ€ç ä¼šä¸ <code>Proxy-Authenticate</code> é¦–éƒ¨ä¸€èµ·å‘é€ï¼Œå…¶ä¸­åŒ…å«æœ‰å¦‚ä½•è¿›è¡ŒéªŒè¯çš„ä¿¡æ¯ã€‚</p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 407 Proxy Authentication RequiredDate: Wed, 21 Oct 2015 07:28:00 GMTProxy-Authenticate: Basic realm&#x3D;&quot;Access to internal site&quot;</code></pre><h3 id="408-Request-Timeout"><a href="#408-Request-Timeout" class="headerlink" title="408 Request Timeout"></a>408 Request Timeout</h3><p>å“åº”çŠ¶æ€ç  <code>408 Request Timeout</code> è¡¨ç¤º: æœåŠ¡å™¨æƒ³è¦å°†æ²¡æœ‰åœ¨ä½¿ç”¨çš„è¿æ¥å…³é—­ã€‚ä¸€äº›æœåŠ¡å™¨ä¼šåœ¨ç©ºé—²è¿æ¥ä¸Šå‘é€æ­¤ä¿¡æ¯ï¼Œå³ä¾¿æ˜¯åœ¨å®¢æˆ·ç«¯æ²¡æœ‰å‘é€ä»»ä½•è¯·æ±‚çš„æƒ…å†µä¸‹ã€‚</p><p>æœåŠ¡å™¨åº”è¯¥åœ¨æ­¤ç±»å“åº”ä¸­å°† Connection é¦–éƒ¨çš„å€¼è®¾ç½®ä¸º â€œcloseâ€ï¼Œå› ä¸º <code>408 æ„å‘³ç€æœåŠ¡å™¨å·²ç»å†³å®šå°†è¿æ¥å…³é—­ï¼Œè€Œä¸æ˜¯ç»§ç»­ç­‰å¾…</code>ã€‚</p><p>è¿™ç±»å“åº”å‡ºç°çš„æ¯”è¾ƒé¢‘ç¹ï¼Œæºäºä¸€äº›æµè§ˆå™¨â€”â€”ä¾‹å¦‚ Chrome, Firefox 27+, æˆ–è€… IE9 ç­‰â€”â€”<code>ä½¿ç”¨ HTTP åè®®ä¸­çš„é¢„è¿æ¥æœºåˆ¶æ¥åŠ é€Ÿä¸Šç½‘ä½“éªŒ</code>ã€‚<span style="color: red">åŒæ—¶åº”è¯¥æ³¨æ„åˆ°ï¼ŒæŸäº›æœåŠ¡å™¨ä¼šç›´æ¥å…³é—­è¿æ¥ï¼Œè€Œä¸å‘é€æ­¤ç±»æ¶ˆæ¯ã€‚</span></p><h3 id="409-Conflict"><a href="#409-Conflict" class="headerlink" title="409 Conflict"></a>409 Conflict</h3><p>å“åº”çŠ¶æ€ç  <code>409 Conflict</code>è¡¨ç¤º: è¯·æ±‚ä¸æœåŠ¡å™¨ç«¯ç›®æ ‡èµ„æºçš„å½“å‰çŠ¶æ€ç›¸å†²çªã€‚</p><p>å†²çªæœ€æœ‰å¯èƒ½å‘ç”Ÿåœ¨å¯¹ <code>PUT</code> è¯·æ±‚çš„å“åº”ä¸­ã€‚ä¾‹å¦‚ï¼Œ<strong>å½“ä¸Šä¼ æ–‡ä»¶çš„ç‰ˆæœ¬æ¯”æœåŠ¡å™¨ä¸Šå·²å­˜åœ¨çš„è¦æ—§</strong>ï¼Œä»è€Œå¯¼è‡´ç‰ˆæœ¬å†²çªçš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½æ”¶åˆ°çŠ¶æ€ç ä¸º <code>409 çš„å“åº”</code>ã€‚</p><h3 id="410-Gone"><a href="#410-Gone" class="headerlink" title="410 Gone"></a>410 Gone</h3><p>å“åº”çŠ¶æ€ç  <code>410 Gone</code> è¯´æ˜è¯·æ±‚çš„ç›®æ ‡èµ„æºåœ¨åŸæœåŠ¡å™¨ä¸Šä¸å­˜åœ¨äº†ï¼Œå¹¶ä¸”<code>æ˜¯æ°¸ä¹…æ€§çš„ä¸¢å¤±</code>ã€‚å¦‚æœä¸æ¸…æ¥šæ˜¯å¦ä¸ºæ°¸ä¹…æˆ–ä¸´æ—¶çš„ä¸¢å¤±ï¼Œåº”è¯¥ä½¿ç”¨ 404</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>410 å“åº”é»˜è®¤ä¼šè¢«ç¼“å­˜</p></div><h3 id="411-Length-Required"><a href="#411-Length-Required" class="headerlink" title="411 Length Required"></a>411 Length Required</h3><p>å“åº”çŠ¶æ€ç  <code>411 Length Required</code> å±äºå®¢æˆ·ç«¯é”™è¯¯ï¼Œè¡¨ç¤º: ç”±äºç¼ºå°‘ç¡®å®šçš„ Content-Length é¦–éƒ¨å­—æ®µï¼ŒæœåŠ¡å™¨æ‹’ç»å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p><p>æ³¨æ„ï¼ŒæŒ‰ç…§è§„èŒƒï¼Œ<strong>å½“ä½¿ç”¨åˆ†å—æ¨¡å¼ä¼ è¾“æ•°æ®çš„æ—¶å€™</strong>ï¼Œ <code>Content-Length</code> é¦–éƒ¨æ˜¯ä¸å­˜åœ¨çš„ï¼Œä½†æ˜¯<strong>éœ€è¦åœ¨æ¯ä¸€ä¸ªåˆ†å—çš„å¼€å§‹æ·»åŠ è¯¥åˆ†å—çš„é•¿åº¦</strong>ï¼Œç”¨åå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºã€‚å‚è§ Transfer-Encoding è·å–æ›´å¤šç»†èŠ‚ä¿¡æ¯ã€‚</p><h3 id="412-Precondition-Failed"><a href="#412-Precondition-Failed" class="headerlink" title="412 Precondition Failed"></a>412 Precondition Failed</h3><p>å“åº”çŠ¶æ€ç  <code>412 Precondition Failedï¼ˆå…ˆå†³æ¡ä»¶å¤±è´¥ï¼‰</code>, è¿™é€šå¸¸å‘ç”Ÿäº: é‡‡ç”¨é™¤ GET å’Œ HEAD ä¹‹å¤–çš„æ–¹æ³•è¿›è¡Œæ¡ä»¶è¯·æ±‚æ—¶ï¼Œç”±é¦–éƒ¨å­—æ®µ <code>If-Unmodified-Since</code> æˆ– <code>If-None-Match</code> è§„å®šçš„å…ˆå†³æ¡ä»¶ä¸æˆç«‹çš„æƒ…å†µä¸‹ã€‚è¿™æ—¶å€™ï¼Œè¯·æ±‚çš„æ“ä½œâ€”â€”é€šå¸¸æ˜¯ä¸Šä¼ æˆ–ä¿®æ”¹æ–‡ä»¶â€”â€”æ— æ³•æ‰§è¡Œï¼Œä»è€Œè¿”å›è¯¥é”™è¯¯çŠ¶æ€ç ã€‚</p><h3 id="413-Payload-Too-Large"><a href="#413-Payload-Too-Large" class="headerlink" title="413 Payload Too Large"></a>413 Payload Too Large</h3><p>å“åº”çŠ¶æ€ç  <code>413 Payload Too Large</code> è¡¨ç¤º: <code>è¯·æ±‚ä¸»ä½“çš„å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨çš„èƒ½åŠ›å¤„ç†</code>ï¼Œ<strong>base64 ç¼–ç ä¼šå¢å¤§æ•°æ®ä½“ç§¯</strong>ã€‚</p><p>å¦‚æœâ€œè¶…å‡ºé™åº¦â€æ˜¯æš‚æ—¶æ€§çš„ï¼ŒæœåŠ¡å™¨åº”è¯¥è¿”å› Retry-After é¦–éƒ¨å­—æ®µï¼Œè¯´æ˜è¿™æ˜¯æš‚æ—¶æ€§çš„ï¼Œä»¥åŠå®¢æˆ·ç«¯å¯ä»¥åœ¨ä»€ä¹ˆæ—¶é—´ï¼ˆafter what timeï¼‰åé‡è¯•ã€‚</p><h3 id="414-URI-Too-Long"><a href="#414-URI-Too-Long" class="headerlink" title="414 URI Too Long"></a>414 URI Too Long</h3><p>å“åº”çŠ¶æ€ç  <code>414 URI Too Long</code> è¡¨ç¤ºå®¢æˆ·ç«¯æ‰€è¯·æ±‚çš„ URI è¶…è¿‡äº†æœåŠ¡å™¨å…è®¸çš„èŒƒå›´ã€‚</p><p>ä»¥ä¸‹æ˜¯é€ æˆè¿™ç§ç½•è§æƒ…å†µçš„å‡ ç§å¯èƒ½åŸå› ï¼š</p><ul><li>å½“å®¢æˆ·ç«¯è¯¯å°† POST è¯·æ±‚å½“ä½œ GET è¯·æ±‚æ—¶ï¼Œä¼šå¸¦æœ‰ä¸€ä¸ªè¾ƒé•¿çš„æŸ¥è¯¢å­—ç¬¦ä¸² (query)ï¼›</li><li>å½“å®¢æˆ·ç«¯å •å…¥é‡å®šå‘å¾ªç¯é»‘æ´æ—¶ï¼Œä¾‹å¦‚ï¼ŒæŒ‡å‘è‡ªèº«åç¼€çš„é‡å®šå‘ URI å‰ç¼€ (a redirected URI prefix that points to a suffix of itself)ï¼›</li><li>å½“å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨è¿›è¡Œæ”»å‡»ï¼Œè¯•å›¾å¯»æ‰¾æ½œåœ¨çš„æ¼æ´æ—¶ã€‚ï¼ˆ<code>åå°„å‹XSSæ”»å‡»</code>ï¼‰</li></ul><h3 id="415-Unsupported-Media-Type"><a href="#415-Unsupported-Media-Type" class="headerlink" title="415 Unsupported Media Type"></a>415 Unsupported Media Type</h3><p>å“åº”çŠ¶æ€ç  <code>415 Unsupported Media Type</code> è¡¨ç¤º: æœåŠ¡å™¨ç”±äºä¸æ”¯æŒå…¶æœ‰æ•ˆè½½è·çš„æ ¼å¼ï¼Œä»è€Œæ‹’ç»æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p><p>æ ¼å¼é—®é¢˜çš„å‡ºç°æœ‰å¯èƒ½æºäºå®¢æˆ·ç«¯åœ¨ <code>Content-Type</code> æˆ– <code>Content-Encoding</code> é¦–éƒ¨ä¸­æŒ‡å®šçš„æ ¼å¼ï¼Œä¹Ÿå¯èƒ½æºäºç›´æ¥å¯¹è´Ÿè½½æ•°æ®è¿›è¡Œæ£€æµ‹çš„ç»“æœ</p><h3 id="416-Range-Not-Satisfiable"><a href="#416-Range-Not-Satisfiable" class="headerlink" title="416 Range Not Satisfiable"></a>416 Range Not Satisfiable</h3><p>å“åº”çŠ¶æ€ç <code>416 Range Not Satisfiable </code>é”™è¯¯çŠ¶æ€ç æ„å‘³ç€: <strong>æœåŠ¡å™¨æ— æ³•å¤„ç†æ‰€è¯·æ±‚çš„æ•°æ®åŒºé—´</strong>ã€‚æœ€å¸¸è§çš„æƒ…å†µæ˜¯æ‰€è¯·æ±‚çš„æ•°æ®åŒºé—´ä¸åœ¨æ–‡ä»¶èŒƒå›´ä¹‹å†…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒRange é¦–éƒ¨çš„å€¼ï¼Œè™½ç„¶ä»è¯­æ³•ä¸Šæ¥è¯´æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯ä»è¯­ä¹‰ä¸Šæ¥è¯´å´æ²¡æœ‰æ„ä¹‰ã€‚</p><p>416 å“åº”æŠ¥æ–‡åŒ…å«ä¸€ä¸ª Content-Range é¦–éƒ¨ï¼Œæç¤ºæ— æ³•æ»¡è¶³çš„æ•°æ®åŒºé—´ï¼ˆç”¨æ˜Ÿå· _ è¡¨ç¤ºï¼‰ï¼Œåé¢ç´§è·Ÿç€ä¸€ä¸ªâ€œ&#x2F;â€ï¼Œå†åé¢æ˜¯å½“å‰èµ„æºçš„é•¿åº¦ã€‚ä¾‹å¦‚ï¼š<code>Content-Range: */12777</code></p><p>é‡åˆ°è¿™ä¸€é”™è¯¯çŠ¶æ€ç æ—¶ï¼Œæµè§ˆå™¨ä¸€èˆ¬æœ‰ä¸¤ç§ç­–ç•¥ï¼š<code>è¦ä¹ˆç»ˆæ­¢æ“ä½œ</code>ï¼ˆä¾‹å¦‚ï¼Œä¸€é¡¹ä¸­æ–­çš„ä¸‹è½½æ“ä½œè¢«è®¤ä¸ºæ˜¯ä¸å¯æ¢å¤çš„ï¼‰ï¼Œ<code>è¦ä¹ˆå†æ¬¡è¯·æ±‚æ•´ä¸ªæ–‡ä»¶</code>ã€‚</p><h3 id="417-Expectation-Failed"><a href="#417-Expectation-Failed" class="headerlink" title="417 Expectation Failed"></a>417 Expectation Failed</h3><p>å“åº”çŠ¶æ€ç  <code>417 Expectation Failed</code> çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯é”™è¯¯ï¼Œæ„å‘³ç€: <strong>æœåŠ¡å™¨æ— æ³•æ»¡è¶³ Expect è¯·æ±‚æ¶ˆæ¯å¤´ä¸­çš„æœŸæœ›æ¡ä»¶</strong>ã€‚</p><p>å‚è€ƒ Expect æ¶ˆæ¯å¤´è·å¾—æ›´å¤šçš„ç›¸å…³ç»†èŠ‚ä¿¡æ¯</p><p><a href="https://www.jianshu.com/p/7cb1a7bf0f5d" target="_blank" >ç¤ºä¾‹</a></p><h3 id="418-Iâ€™m-a-teapot"><a href="#418-Iâ€™m-a-teapot" class="headerlink" title="418 Iâ€™m a teapot"></a>418 Iâ€™m a teapot</h3><p>å“åº”çŠ¶æ€ç  <code>418 I&#39;m a teapot</code> å®¢æˆ·ç«¯é”™è¯¯å“åº”ä»£ç è¡¨ç¤º: æœåŠ¡å™¨æ‹’ç»å†²æ³¡å’–å•¡ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ªèŒ¶å£¶ã€‚</p><p>è¯¥é”™è¯¯æ˜¯è¶…æ–‡æœ¬å’–å•¡å£¶æ§åˆ¶åè®®çš„å‚è€ƒï¼Œå’Œ 1998 å¹´æ„šäººèŠ‚çš„ç©ç¬‘ã€‚ç”¨ä½œå½©è›‹</p><pre class="line-numbers language-none"><code class="language-none">å‡ºè‡ªRFC 2324 Hyper Text Coffee Pot Control Protocol (HTCPCP&#x2F;1.0)æ–‡æ¡£æ–‡æ¡£ä¸­å®šä¹‰çš„ä¸€ç§è¿”å›å€¼ï¼Œåè®®å®šä¹‰â€œå¦‚æœæƒ³ç”¨èŒ¶å£¶åˆ¶ä½œå’–å•¡ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ç 418 I&#39;m tea potâ€2014å¹´4.1å‘å¸ƒçš„æ¶æRFC 7168æ˜¯æ­¤åè®®çš„æ‰©å±•ï¼Œæ­£å¼æ”¯æŒèŒ¶å£¶ä½œè€…ï¼šchanyié“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;cdefc3afd7eaæ¥æºï¼šç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</code></pre><p>RFCï¼ˆrequest for commitsï¼‰ å¾æ±‚æ„è§ä¿®è®¢ä¹¦</p><p>æ˜¯ä¸€ä¸ªäº’è”ç½‘æŠ€æœ¯æ ‡å‡†æ–‡æ¡£</p><h3 id="422-Unprocessable-Entity"><a href="#422-Unprocessable-Entity" class="headerlink" title="422 Unprocessable Entity"></a>422 Unprocessable Entity</h3><p>å“åº”çŠ¶æ€ç  <code>422 çŠ¶æ€ç </code>è¡¨ç¤º: æœåŠ¡å™¨ç†è§£è¯·æ±‚å®ä½“çš„å†…å®¹ç±»å‹ï¼Œå¹¶ä¸”<code>è¯·æ±‚å®ä½“çš„è¯­æ³•æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯æœåŠ¡å™¨æ— æ³•å¤„ç†æ‰€åŒ…å«çš„æŒ‡ä»¤</code>ã€‚</p><p>ä¾‹å­ï¼š<a href="https://blog.csdn.net/weixin_30314631/article/details/97219640" target="_blank" >è§</a></p><pre class="line-numbers language-none"><code class="language-none">HttpRequestä¸­æ‰€å¸¦cookieå’ŒæœåŠ¡å™¨ç«¯æ¥æ”¶çš„ cookieåç§°ä¸ä¸€è‡´ ï¼Œå¯¼è‡´è¿”å›422é”™è¯¯ä»£ç ã€‚</code></pre><h3 id="423-Locked"><a href="#423-Locked" class="headerlink" title="423 Locked"></a>423 Locked</h3><p>å½“å‰èµ„æºè¢«é”å®šã€‚ï¼ˆRFC 4918 WebDAVï¼‰,ç½‘ä¸ŠæŸ¥åˆ°æ›´å¤šæ˜¯å’Œ SVN ç›¸å…³</p><h3 id="424-Failed-Dependency"><a href="#424-Failed-Dependency" class="headerlink" title="424 Failed Dependency"></a>424 Failed Dependency</h3><p>ç”±äºä¹‹å‰çš„æŸä¸ªè¯·æ±‚å‘ç”Ÿçš„é”™è¯¯ï¼Œå¯¼è‡´å½“å‰è¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚ PROPPATCHã€‚ï¼ˆRFC 4918 WebDAVï¼‰</p><h3 id="425-Too-Early"><a href="#425-Too-Early" class="headerlink" title="425 Too Early"></a>425 Too Early</h3><p>æœåŠ¡å™¨æ‹’ç»å¤„ç†åœ¨ Early Data ä¸­çš„è¯·æ±‚ï¼Œä»¥è§„é¿å¯èƒ½çš„é‡æ”¾æ”»å‡», <a href="https://zh.wikipedia.org/zh-cn/%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB" target="_blank" >é‡æ”¾æ”»å‡»- ä¸­é—´äººæ”»å‡»çš„ä¸€ç§</a></p><p>æ˜¯ä¸€ç§æ¶æ„æˆ–æ¬ºè¯ˆçš„é‡å¤æˆ–å»¶è¿Ÿæœ‰æ•ˆæ•°æ®çš„ç½‘ç»œæ”»å‡»å½¢å¼</p><h3 id="426-Upgrade-Required"><a href="#426-Upgrade-Required" class="headerlink" title="426 Upgrade Required"></a>426 Upgrade Required</h3><p><code>426 Upgrade Required</code> è¡¨ç¤º: æœåŠ¡å™¨æ‹’ç»å¤„ç†å®¢æˆ·ç«¯ä½¿ç”¨å½“å‰åè®®å‘é€çš„è¯·æ±‚ï¼Œä½†æ˜¯å¯ä»¥æ¥å—å…¶ä½¿ç”¨å‡çº§åçš„åè®®å‘é€çš„è¯·æ±‚ã€‚</p><p>æœåŠ¡å™¨ä¼šåœ¨å“åº”ä¸­ä½¿ç”¨ <code>Upgrade (en-US) </code>é¦–éƒ¨æ¥æŒ‡å®šè¦æ±‚çš„åè®®ã€‚</p><h3 id="428-Precondition-Required"><a href="#428-Precondition-Required" class="headerlink" title="428 Precondition Required"></a>428 Precondition Required</h3><p>å“åº”çŠ¶æ€ç  <code>428 Precondition Required</code> è¡¨ç¤º: æœåŠ¡å™¨ç«¯è¦æ±‚å‘é€æ¡ä»¶è¯·æ±‚ã€‚</p><p>ä¸€èˆ¬çš„ï¼Œè¿™ç§æƒ…å†µæ„å‘³ç€å¿…è¦çš„æ¡ä»¶é¦–éƒ¨â€”â€”å¦‚<code>If-Match</code> â€”â€”çš„ç¼ºå¤±ã€‚</p><p>å½“ä¸€ä¸ªæ¡ä»¶é¦–éƒ¨çš„å€¼ä¸èƒ½åŒ¹é…æœåŠ¡å™¨ç«¯çš„çŠ¶æ€çš„æ—¶å€™ï¼Œåº”ç­”çš„çŠ¶æ€ç åº”è¯¥æ˜¯ <code>412 Precondition Failed</code>ï¼Œå‰ç½®æ¡ä»¶éªŒè¯å¤±è´¥ã€‚</p><h3 id="412-ä¸-428-åŒºåˆ«"><a href="#412-ä¸-428-åŒºåˆ«" class="headerlink" title="412 ä¸ 428 åŒºåˆ«"></a>412 ä¸ 428 åŒºåˆ«</h3><ul><li><code>412</code> <code>ä¸€ä¸ªæ¡ä»¶é¦–éƒ¨çš„å€¼</code>ä¸èƒ½åŒ¹é…æœåŠ¡å™¨ç«¯çš„çŠ¶æ€çš„æ—¶å€™ï¼Œåº”ç­”çš„çŠ¶æ€ç åº”è¯¥æ˜¯ <code>412 Precondition Failed</code>ï¼Œå‰ç½®æ¡ä»¶éªŒè¯å¤±è´¥ã€‚</li><li><code>428</code> <code>å¿…è¦çš„æ¡ä»¶é¦–éƒ¨çš„ç¼ºå¤±</code>â€”â€”å¦‚<code>If-Match</code></li></ul><h3 id="429-Too-Many-Requests"><a href="#429-Too-Many-Requests" class="headerlink" title="429 Too Many Requests"></a>429 Too Many Requests</h3><p>å“åº”çŠ¶æ€ç  <code>429 Too Many Requests</code> è¡¨ç¤ºåœ¨ä¸€å®šçš„æ—¶é—´å†…ç”¨æˆ·å‘é€äº†å¤ªå¤šçš„è¯·æ±‚ï¼Œå³<code>è¶…å‡ºäº†â€œé¢‘æ¬¡é™åˆ¶â€</code>ã€‚</p><p>åœ¨å“åº”ä¸­ï¼Œå¯ä»¥æä¾›ä¸€ä¸ª <code>Retry-After</code> é¦–éƒ¨æ¥æç¤ºç”¨æˆ·éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ä¹‹åå†å‘é€æ–°çš„è¯·æ±‚ã€‚</p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 429 Too Many RequestsContent-Type: text&#x2F;htmlRetry-After: 3600</code></pre><h3 id="431-Request-Header-Fields-Too-Large"><a href="#431-Request-Header-Fields-Too-Large" class="headerlink" title="431 Request Header Fields Too Large"></a>431 Request Header Fields Too Large</h3><p>æœåŠ¡å™¨ä¸æ„¿å¤„ç†è¯·æ±‚ï¼Œå› ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå¤´å­—æ®µè¿‡å¤§</p><p><strong>åˆšæ•´ç†å®Œï¼Œå°±æ”¶åˆ°åé¦ˆäº†ï¼Œè¿™ä¹Ÿå¤ªç¥å¥‡äº†å§</strong></p><img src="http://t-blog-images.aijs.top/img/202207261508843.webp" /><br/><br/><img src="http://t-blog-images.aijs.top/img/202207261521540.webp" /><h3 id="440-Login-Time-out"><a href="#440-Login-Time-out" class="headerlink" title="440 Login Time-out"></a>440 Login Time-out</h3><p>å®¢æˆ·ç«¯ session è¶…æ—¶å¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç™»å½•ã€‚</p><h3 id="451-Unavailable-For-Legal-Reasons"><a href="#451-Unavailable-For-Legal-Reasons" class="headerlink" title="451 Unavailable For Legal Reasons"></a>451 Unavailable For Legal Reasons</h3><p>è¯¥è®¿é—®ï¼Œå› æ³•å¾‹çš„è¦æ±‚è€Œè¢«æ‹’ç»</p><h3 id="500-Internal-Server-Error"><a href="#500-Internal-Server-Error" class="headerlink" title="500 Internal Server Error"></a>500 Internal Server Error</h3><p><code>500 Internal Server Error</code> æ˜¯è¡¨ç¤ºæœåŠ¡å™¨ç«¯é”™è¯¯çš„å“åº”çŠ¶æ€ç ï¼Œæ„å‘³ç€æ‰€è¯·æ±‚çš„æœåŠ¡å™¨é‡åˆ°æ„å¤–çš„æƒ…å†µå¹¶é˜»æ­¢å…¶æ‰§è¡Œè¯·æ±‚ã€‚</p><p>è¿™ä¸ªé”™è¯¯ä»£ç æ˜¯ä¸€ä¸ªé€šç”¨çš„â€œä¸‡èƒ½â€å“åº”ä»£ç ã€‚æœ‰æ—¶å€™ï¼Œå¯¹äºç±»ä¼¼äº 500 è¿™æ ·çš„é”™è¯¯ï¼ŒæœåŠ¡å™¨ç®¡ç†å‘˜ä¼šæ›´åŠ è¯¦ç»†åœ°è®°å½•ç›¸å…³çš„è¯·æ±‚ä¿¡æ¯æ¥é˜²æ­¢ä»¥ååŒæ ·é”™è¯¯çš„å‡ºç°ã€‚</p><h3 id="501-Not-Implemented"><a href="#501-Not-Implemented" class="headerlink" title="501 Not Implemented"></a>501 Not Implemented</h3><p>å“åº”çŠ¶æ€ç  <code>501 Not Implemented </code>æœåŠ¡å™¨é”™è¯¯å“åº”ç è¡¨ç¤º: è¯·æ±‚çš„æ–¹æ³•ä¸è¢«æœåŠ¡å™¨æ”¯æŒï¼Œå› æ­¤æ— æ³•è¢«å¤„ç†ã€‚æœåŠ¡å™¨å¿…é¡»æ”¯æŒçš„æ–¹æ³•ï¼ˆå³ä¸ä¼šè¿”å›è¿™ä¸ªçŠ¶æ€ç çš„æ–¹æ³•ï¼‰åªæœ‰ GET å’Œ HEADã€‚</p><p>è¯·æ³¨æ„ï¼Œä½ æ— æ³•ä¿®å¤ 501 é”™è¯¯ï¼Œéœ€è¦è¢«è®¿é—®çš„ web æœåŠ¡å™¨å»ä¿®å¤è¯¥é—®é¢˜ã€‚</p><h3 id="502-Bad-Gateway"><a href="#502-Bad-Gateway" class="headerlink" title="502 Bad Gateway"></a>502 Bad Gateway</h3><p>å“åº”çŠ¶æ€ç  <code>502 Bad Gateway</code> æ˜¯ä¸€ç§ HTTP åè®®çš„æœåŠ¡ç«¯é”™è¯¯çŠ¶æ€ä»£ç ï¼Œå®ƒè¡¨ç¤ºä½œä¸ºç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨ä¸­æ¥æ”¶åˆ°çš„å“åº”æ˜¯æ— æ•ˆçš„ã€‚</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>å¤‡æ³¨ï¼š ç½‘å…³åœ¨è®¡ç®—æœºç½‘ç»œä½“ç³»ä¸­å¯ä»¥æŒ‡ä»£ä¸åŒçš„è®¾å¤‡ï¼Œ502 é”™è¯¯é€šå¸¸ä¸æ˜¯å®¢æˆ·ç«¯èƒ½å¤Ÿä¿®å¤çš„ï¼Œè€Œæ˜¯éœ€è¦ç”±é€”ç»çš„ Web æœåŠ¡å™¨æˆ–è€…ä»£ç†æœåŠ¡å™¨å¯¹å…¶è¿›è¡Œä¿®å¤ã€‚</p></div><p>ä¸€èˆ¬ä¼šæœ‰ <code>é“¾è·¯è¿½è¸ª</code>, é€šè¿‡<code>trackId</code>å¯ä»¥æŸ¥è¯¢åˆ°ä»€ä¹ˆåœ°æ–¹å‡ºçš„é—®é¢˜</p><h3 id="503-Service-Unavailable"><a href="#503-Service-Unavailable" class="headerlink" title="503 Service Unavailable"></a>503 Service Unavailable</h3><p>å“åº”çŠ¶æ€ç <code>503 Service Unavailable</code> æ˜¯ä¸€ç§ HTTP åè®®çš„æœåŠ¡å™¨ç«¯é”™è¯¯çŠ¶æ€ä»£ç ï¼Œå®ƒè¡¨ç¤ºæœåŠ¡å™¨å°šæœªå¤„äºå¯ä»¥æ¥å—è¯·æ±‚çš„çŠ¶æ€ã€‚</p><p>é€šå¸¸é€ æˆè¿™ç§æƒ…å†µçš„åŸå› æ˜¯: ç”±äºæœåŠ¡å™¨åœæœºç»´æŠ¤æˆ–è€…å·²è¶…è½½ã€‚æ³¨æ„åœ¨å‘é€è¯¥å“åº”çš„æ—¶å€™ï¼Œåº”è¯¥åŒæ—¶å‘é€ä¸€ä¸ªå¯¹ç”¨æˆ·å‹å¥½çš„é¡µé¢æ¥è§£é‡Šé—®é¢˜å‘ç”Ÿçš„åŸå› ã€‚è¯¥ç§å“åº”åº”è¯¥ç”¨äºä¸´æ—¶çŠ¶å†µä¸‹ï¼Œä¸ä¹‹åŒæ—¶ï¼Œåœ¨å¯è¡Œçš„æƒ…å†µä¸‹ï¼Œåº”è¯¥åœ¨ <code>Retry-After</code> é¦–éƒ¨å­—æ®µä¸­åŒ…å«æœåŠ¡æ¢å¤çš„é¢„æœŸæ—¶é—´ã€‚</p><p>ç¼“å­˜ç›¸å…³çš„é¦–éƒ¨åœ¨ä¸è¯¥å“åº”ä¸€åŒå‘é€æ—¶åº”è¯¥å°å¿ƒä½¿ç”¨ï¼Œ<code>å› ä¸º 503 çŠ¶æ€ç é€šå¸¸åº”ç”¨äºä¸´æ—¶çŠ¶å†µä¸‹ï¼Œè€Œæ­¤ç±»å“åº”ä¸€èˆ¬ä¸åº”è¯¥è¿›è¡Œç¼“å­˜</code>ã€‚</p><h3 id="504-Gateway-Timeout"><a href="#504-Gateway-Timeout" class="headerlink" title="504 Gateway Timeout"></a>504 Gateway Timeout</h3><p>å“åº”çŠ¶æ€ç <code>504 Gateway Timeout</code> æ˜¯ä¸€ç§ HTTP åè®®çš„æœåŠ¡å™¨ç«¯é”™è¯¯çŠ¶æ€ä»£ç ï¼Œè¡¨ç¤º: <strong><code>æ‰®æ¼”ç½‘å…³</code>æˆ–è€…<code>ä»£ç†çš„æœåŠ¡å™¨</code>æ— æ³•åœ¨è§„å®šçš„æ—¶é—´å†…è·å¾—æƒ³è¦çš„å“åº”</strong>ã€‚</p><p>Gatewayï¼ˆç½‘å…³ï¼‰åœ¨è®¡ç®—æœºç½‘ç»œä½“ç³»ä¸­å¯ä»¥æŒ‡ä»£ä¸åŒçš„è®¾å¤‡ï¼Œ504 é”™è¯¯é€šå¸¸ä¸æ˜¯åœ¨å®¢æˆ·ç«¯å¯ä»¥ä¿®å¤çš„ï¼Œè€Œæ˜¯éœ€è¦ç”±é€”å¾„çš„ Web æœåŠ¡å™¨æˆ–è€…ä»£ç†æœåŠ¡å™¨å¯¹å…¶è¿›è¡Œä¿®å¤ã€‚</p><h3 id="505-HTTP-Version-Not-Supported"><a href="#505-HTTP-Version-Not-Supported" class="headerlink" title="505 HTTP Version Not Supported"></a>505 HTTP Version Not Supported</h3><p>å“åº”çŠ¶æ€ç <code>505 HTTP Version Not Supported </code>æ˜¯ä¸€ç§ HTTP åè®®çš„æœåŠ¡å™¨ç«¯é”™è¯¯çŠ¶æ€ä»£ç ï¼Œè¡¨ç¤º: <strong>æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚æ‰€ä½¿ç”¨çš„ HTTP ç‰ˆæœ¬</strong>ã€‚</p><h3 id="506-Variant-Also-Negotiates"><a href="#506-Variant-Also-Negotiates" class="headerlink" title="506 Variant Also Negotiates"></a>506 Variant Also Negotiates</h3><p>506 ç è¡¨ç¤º: <strong>å†…éƒ¨æœåŠ¡å™¨é…ç½®é”™è¯¯</strong>ï¼Œå…¶ä¸­æ‰€é€‰å˜é‡&#x2F;å˜å…ƒè‡ªèº«è¢«é…ç½®ä¸ºå‚ä¸å†…å®¹åå•†ï¼Œå› æ­¤å¹¶ä¸æ˜¯åˆé€‚çš„åå•†ç«¯ç‚¹ã€‚</p><h3 id="507-Insufficient-Storage"><a href="#507-Insufficient-Storage" class="headerlink" title="507 Insufficient Storage"></a>507 Insufficient Storage</h3><p>å“åº”çŠ¶æ€ç  <code>507 Insufficient Storage</code> å“åº”çŠ¶æ€ç  å¯ä»¥åœ¨ WebDAV åè®®ï¼ˆåŸºäº web çš„åˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æ§åˆ¶ï¼Œå‚è§ RFC 4918ï¼‰ä¸­ç»™å‡ºã€‚</p><p><strong>507 ç è¡¨ç¤ºæœåŠ¡å™¨ä¸èƒ½å­˜å‚¨ç›¸å…³å†…å®¹</strong>ã€‚å‡†ç¡®åœ°è¯´ï¼Œä¸€ä¸ªæ–¹æ³•å¯èƒ½æ²¡æœ‰è¢«æ‰§è¡Œï¼Œå› ä¸ºæœåŠ¡å™¨ä¸èƒ½å­˜å‚¨å…¶è¡¨è¾¾å½¢å¼ï¼Œè¿™é‡Œçš„è¡¨è¾¾å½¢å¼æŒ‡ï¼šæ–¹æ³•æ‰€é™„å¸¦çš„æ•°æ®ï¼Œè€Œä¸”å…¶è¯·æ±‚å¿…éœ€å·²ç»å‘é€æˆåŠŸã€‚</p><h3 id="508-Loop-Detected"><a href="#508-Loop-Detected" class="headerlink" title="508 Loop Detected"></a>508 Loop Detected</h3><p>å“åº”çŠ¶æ€ç  <code>508 Loop Detected</code> çŠ¶æ€ç å¯ä»¥åœ¨ WebDAV åè®®ï¼ˆåŸºäº Web çš„åˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æ§åˆ¶ï¼‰ä¸­ç»™å‡ºã€‚</p><p><strong>508 ç è¡¨ç¤ºæœåŠ¡å™¨ä¸­æ–­ä¸€ä¸ªæ“ä½œï¼Œå› ä¸ºå®ƒåœ¨å¤„ç†å…·æœ‰â€œDepth: infinityâ€çš„è¯·æ±‚æ—¶é‡åˆ°äº†ä¸€ä¸ªæ— é™å¾ªç¯ã€‚508 ç è¡¨ç¤ºæ•´ä¸ªæ“ä½œå¤±è´¥</strong>ã€‚</p><h3 id="510-Not-Extended"><a href="#510-Not-Extended" class="headerlink" title="510 Not Extended"></a>510 Not Extended</h3><p>å“åº”çŠ¶æ€ç  <code>510 Not Extended</code> å“åº”çŠ¶æ€ç åœ¨ HTTP æ‰©å±•æ¡†æ¶åè®®ï¼ˆå‚è§ RFC 2774ï¼‰ä¸­å‘é€ã€‚</p><p>åœ¨ HTTP æ‰©å±•æ¡†æ¶åè®®ä¸­ ï¼Œ<strong>ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥å‘é€ä¸€ä¸ªåŒ…å«æ‰©å±•å£°æ˜çš„è¯·æ±‚ï¼Œè¯¥å£°æ˜æè¿°äº†è¦ä½¿ç”¨çš„æ‰©å±•</strong>ã€‚<strong>å¦‚æœæœåŠ¡å™¨æ¥æ”¶åˆ°è¿™æ ·çš„è¯·æ±‚ï¼Œä½†æ˜¯è¯·æ±‚ä¸æ”¯æŒä»»ä½•æ‰€æè¿°çš„æ‰©å±•</strong>ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ä½¿ç”¨ 510 çŠ¶æ€ç è¿›è¡Œå“åº”ã€‚</p><h3 id="511-Network-Authentication-Required"><a href="#511-Network-Authentication-Required" class="headerlink" title="511 Network Authentication Required"></a>511 Network Authentication Required</h3><p>å“åº”çŠ¶æ€ç <code>511 Network Authentication Required</code> è¡¨ç¤ºå®¢æˆ·ç«¯éœ€è¦é€šè¿‡éªŒè¯æ‰èƒ½ä½¿ç”¨è¯¥ç½‘ç»œã€‚</p><p>è¯¥çŠ¶æ€ç ä¸æ˜¯ç”±æºå¤´æœåŠ¡å™¨ç”Ÿæˆçš„ï¼Œè€Œæ˜¯ç”±æ§åˆ¶ç½‘ç»œè®¿é—®çš„æ‹¦æˆªä»£ç†æœåŠ¡å™¨ç”Ÿæˆçš„ã€‚</p><p><strong>ç½‘ç»œè¿è¥å•†ä»¬æœ‰æ—¶å€™ä¼šåœ¨å‡†è®¸ä½¿ç”¨ç½‘ç»œä¹‹å‰è¦æ±‚ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€æ¥å—æŸäº›æ¡æ¬¾ï¼Œæˆ–è€…è¿›è¡Œå…¶ä»–å½¢å¼çš„ä¸ç”¨æˆ·ä¹‹é—´çš„äº’åŠ¨ï¼ˆä¾‹å¦‚åœ¨ç½‘ç»œå’–å•¡å…æˆ–è€…æœºåœºï¼‰</strong>ã€‚ä»–ä»¬é€šå¸¸ç”¨ç”¨æˆ·è®¾å¤‡çš„ <code>MAC åœ°å€</code>æ¥è¿›è¡Œè¯†åˆ«ã€‚</p><h3 id="600-ï¼ˆç»´åŸºç™¾ç§‘æŸ¥ä¸åˆ°ï¼‰"><a href="#600-ï¼ˆç»´åŸºç™¾ç§‘æŸ¥ä¸åˆ°ï¼‰" class="headerlink" title="600 ï¼ˆç»´åŸºç™¾ç§‘æŸ¥ä¸åˆ°ï¼‰"></a>600 ï¼ˆç»´åŸºç™¾ç§‘æŸ¥ä¸åˆ°ï¼‰</h3><p>æºç«™æ²¡æœ‰è¿”å›å“åº”å¤´éƒ¨ï¼Œåªè¿”å›å®ä½“å†…å®¹</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zhuanlan.zhihu.com/p/431672713" target="_blank" >æ·±å…¥å‰–æ HTTP3 åè®®</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/100" target="_blank" >Web å¼€å‘æŠ€æœ¯&gt;HTTP&gt;HTTP å“åº”çŠ¶æ€ç </a></p><p><a href="https://www.wbolt.com/http-error-431.html" target="_blank" >HTTP Error 431ï¼šä¿®å¤è¯·æ±‚æ ‡å¤´å­—æ®µå¤ªå¤§çš„ 3 ç§æ–¹æ³•</a></p><p><a href="https://blog.csdn.net/qq_37450814/article/details/114672359" target="_blank" >HTTP çŠ¶æ€ç å«ä¹‰</a></p><p><a href="https://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81" target="_blank" >ç»´åŸºç™¾ç§‘ HTTP çŠ¶æ€ç </a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-TCP</title>
      <link href="//post/2022-07-15TCP.html"/>
      <url>//post/2022-07-15TCP.html</url>
      
        <content type="html"><![CDATA[<h2 id="TCP-çš„ç‰¹æ€§"><a href="#TCP-çš„ç‰¹æ€§" class="headerlink" title="TCP çš„ç‰¹æ€§"></a>TCP çš„ç‰¹æ€§</h2><ul><li>TCP æä¾›â¼€ç§<code>â¾¯å‘è¿æ¥çš„</code>ã€<code> å¯é çš„</code>ã€<code>å­—èŠ‚æµ </code>æœåŠ¡</li><li>åœ¨â¼€ä¸ª TCP è¿æ¥ä¸­ï¼Œ<code>ä»…åŒâ½…è¿›â¾å½¼æ­¤é€šä¿¡</code>ã€‚â¼´æ’­å’Œå¤šæ’­ä¸èƒ½â½¤äº TCP</li><li>TCP ä½¿â½¤<code>æ ¡éªŒ</code>ã€<code>ç¡®è®¤</code>å’Œ<code>é‡ä¼ æœºåˆ¶</code>æ¥ä¿è¯å¯é ä¼ è¾“</li><li>TCP ç»™<code>æ•°æ®åˆ†èŠ‚è¿›â¾æ’åº</code>ï¼Œå¹¶ä½¿â½¤ç´¯ç§¯ç¡®è®¤ä¿è¯æ•°æ®çš„é¡ºåºä¸å˜å’Œâ¾®é‡å¤</li><li>TCP ä½¿â½¤<code>æ»‘åŠ¨çª—â¼æœºåˆ¶</code>æ¥å®ç°æµé‡æ§åˆ¶ï¼Œé€šè¿‡åŠ¨æ€æ”¹å˜çª—â¼çš„â¼¤â¼©è¿›â¾æ‹¥å¡æ§åˆ¶</li></ul><h2 id="TCP-UDP-çš„åŒºåˆ«"><a href="#TCP-UDP-çš„åŒºåˆ«" class="headerlink" title="TCP\UDP çš„åŒºåˆ«"></a>TCP\UDP çš„åŒºåˆ«</h2><ul><li>TCP æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„å•æ’­åè®®,åœ¨ TCP ä¸­,å¹¶ä¸å­˜åœ¨å¤šæ’­ã€å¹¿æ’­çš„è¿™ç§è¡Œä¸º,å› ä¸º TCP æŠ¥æ–‡æ®µä¸­èƒ½æ˜ç¡®å‘é€æ–¹å’Œæ¥å—æ–¹çš„ IP åœ°å€ã€‚</li><li>UDP æ˜¯æ— è¿æ¥çš„ å› ä¸ºä½¿ç”¨ UDP åè®®çš„å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´ä¸å¿…å­˜åœ¨ä»»ä½•é•¿æœŸçš„å…³ç³»ã€‚å®ƒä»¬æ²¡æœ‰å»ºç«‹è¿æ¥è¿‡ç¨‹,æ•´ä¸ªæ¶ˆæ¯ä¼ è¾“è¿‡ç¨‹ç®€å•æ¥è¯´å°±æ˜¯<code>å‘é€å³ç»“æŸ</code></li></ul><table><thead><tr><th align="left"><small>åè®®</small></th><th align="left"><small>è¿æ¥æ€§</small></th><th align="left"><small>åŒâ¼¯æ€§</small></th><th align="left"><small>å¯é æ€§</small></th><th align="left"><small>æœ‰åºæ€§</small></th><th align="left"><small>æœ‰ç•Œæ€§</small></th><th align="left"><small>æ‹¥å¡æ§åˆ¶</small></th><th align="left"><small>ä¼ è¾“é€Ÿåº¦</small></th><th align="left"><small>é‡çº§</small></th><th align="left"><small>å¤´éƒ¨â¼¤â¼©</small></th></tr></thead><tbody><tr><td align="left"><small>TCP</small></td><td align="left"><small>â¾¯å‘è¿æ¥</small></td><td align="left"><small>å…¨åŒâ¼¯(1:1)</small></td><td align="left"><small>å¯é (é‡ä¼ æœº åˆ¶)</small></td><td align="left"><small>æœ‰åº</br>(é€šè¿‡ SYN æ’ åº)</small></td><td align="left"><small>â½†,</br> æœ‰ç²˜åŒ…æƒ…å†µ</small></td><td align="left"><small>æœ‰</small></td><td align="left"><small>æ…¢</small></td><td align="left"><small>ä½</small></td><td align="left"><small>20~60 å­—èŠ‚</small></td></tr><tr><td align="left"><small>UDP</small></td><td align="left"><small>â½†è¿æ¥</small></td><td align="left"><small>n:m</small></td><td align="left"><small>ä¸å¯é </br>(ä¸¢åŒ…å æ•°æ®ä¸¢ å¤±)</small></td><td align="left"><small>â½†åº</small></td><td align="left"><small>æœ‰</br> â½†ç²˜åŒ…</small></td><td align="left"><small>â½†</small></td><td align="left"><small>å¿«</small></td><td align="left"><small>â¾¼</small></td><td align="left"><small>8 å­—èŠ‚</small></td></tr></tbody></table><p><code>æ„ä¹‰ä¸åŒ</code>ï¼šTCP: <code>TransmissionControlProtocol</code>,ä¼ è¾“æ§åˆ¶åè®®ï¼ŒUDP: <code>UserDatagramProtocol</code>,ç”¨æˆ·æ•°æ®æŠ¥åè®®</p><p><strong>å¯é ã€åŒå·¥ã€è¿æ¥</strong></p><p><code>å¯é æ€§</code>ï¼šTCP å¯é ï¼Œæœ‰é‡ä¼ æœºåˆ¶ï¼ŒUDP ä¸å¯é ï¼Œä¸¢äº†å°±ä¸¢äº†<br><code>åŒâ¼¯æ€§</code>ï¼šTCP å…¨åŒå·¥ï¼ˆ1:1ï¼‰ï¼ŒUDP(n:m)<br><code>è¿æ¥æ€§</code>ï¼šTCP é¢å‘è¿æ¥ï¼ŒUDP æ— é“¾æ¥</p><p><strong>æœ‰åºã€æœ‰ç•Œã€æœ‰æ§åˆ¶</strong></p><p><code>æœ‰åºæ€§</code>ï¼šTCP æœ‰åºï¼Œé€šè¿‡ SYN æ’åºï¼ŒUDP æ— åº<br><code>æœ‰ç•Œæ€§</code>ï¼šTCP æ— ç•Œï¼Œæœ‰ç²˜åŒ…æƒ…å†µï¼ŒUDP æœ‰æ¶ˆæ¯è¾¹ç•Œï¼Œæ— ç²˜åŒ…<br><code>æœ‰æ§åˆ¶</code>ï¼šTCP æœ‰æ‹¥å¡æ§åˆ¶ï¼ŒUDP æ²¡æœ‰æ‹¥å¡æ§åˆ¶</p><p><strong>æœ‰å†…å®¹ï¼Œä¹Ÿè¦æœ‰é€Ÿåº¦</strong></p><p><code>å¤´â¼¤</code>ï¼šTCP å¤´éƒ¨å¤§å° 20-60 å­—èŠ‚ï¼ŒUDP å¤´éƒ¨å¤§å° 8 ä¸ªå­—èŠ‚<br><code>é‡å°</code>ï¼šTCP ä¼ è¾“é‡çº§ä½äº UDP<br><code>ä¼ çš„æ…¢</code>ï¼šTCP ç›¸å¯¹äº UDP è€Œè¨€è¦æ…¢</p><h2 id="å¦‚ä½•ç†è§£-UDP-çš„â€œæ— è¿æ¥â€ç‰¹æ€§ï¼Ÿ"><a href="#å¦‚ä½•ç†è§£-UDP-çš„â€œæ— è¿æ¥â€ç‰¹æ€§ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç†è§£ UDP çš„â€œæ— è¿æ¥â€ç‰¹æ€§ï¼Ÿ"></a>å¦‚ä½•ç†è§£ UDP çš„â€œæ— è¿æ¥â€ç‰¹æ€§ï¼Ÿ</h2><p><a href="https://www.dandelioncloud.cn/article/details/1505563355480944641" target="_blank" >å¦‚ä½•ç†è§£UDPçš„â€œæ— è¿æ¥â€ç‰¹æ€§ï¼Ÿ</a></p><h2 id="TCP-ç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†"><a href="#TCP-ç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†" class="headerlink" title="TCP ç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†?"></a>TCP ç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†?</h2><h3 id="ä¸ºä»€ä¹ˆ"><a href="#ä¸ºä»€ä¹ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h3><p>âœ¨ é»˜è®¤æƒ…å†µä¸‹, TCP è¿æ¥ä¼š<code>å¯â½¤å»¶è¿Ÿä¼ é€ç®—æ³•</code> (Nagle ç®—æ³•), åœ¨æ•°æ®å‘é€ä¹‹å‰ç¼“å­˜ä»–ä»¬. å¦‚æœçŸ­æ—¶é—´æœ‰<code>å¤šä¸ªæ•°æ®</code>å‘é€, ä¼šç¼“å†²åˆ°â¼€èµ·ä½œâ¼€æ¬¡å‘é€ (ç¼“å†²â¼¤â¼©â»… socket.bufferSize ), <code>è¿™æ ·å¯ä»¥å‡å°‘ IO æ¶ˆè€—æâ¾¼æ€§èƒ½</code>.</p><p>å¦‚æœæ˜¯ä¼ è¾“â½‚ä»¶çš„è¯, é‚£ä¹ˆæ ¹æœ¬ä¸â½¤å¤„ç†ç²˜åŒ…çš„é—®é¢˜, æ¥â¼€ä¸ªåŒ…æ‹¼â¼€ä¸ªåŒ…å°±å¥½äº†.</p><p>ä½†æ˜¯å¦‚æœæ˜¯å¤šæ¡æ¶ˆæ¯, æˆ–è€…æ˜¯åˆ«çš„â½¤é€”çš„æ•°æ®é‚£ä¹ˆå°±éœ€è¦å¤„ç†ç²˜åŒ….</p><h3 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h3><p>å¯ä»¥å‚â»…â½¹ä¸Šæµä¼ â½è¾ƒâ¼´çš„â¼€ä¸ªä¾‹â¼¦, è¿ç»­è°ƒâ½¤ä¸¤æ¬¡ send åˆ†åˆ«å‘é€ä¸¤æ®µæ•°æ® data1 å’Œ data2, åœ¨æ¥æ”¶ç«¯æœ‰ä»¥ä¸‹â¼ç§å¸¸â»…çš„æƒ…å†µ:</p><p>A. å…ˆæ¥æ”¶åˆ° data1, ç„¶åæ¥æ”¶åˆ° data2 .<br>B. å…ˆæ¥æ”¶åˆ° <code>data1 çš„éƒ¨åˆ†æ•°æ®</code>, ç„¶åæ¥æ”¶åˆ° <code>data1 ä½™ä¸‹çš„éƒ¨åˆ†</code>ä»¥åŠ <code>data2 çš„å…¨éƒ¨</code>.<br>C. å…ˆæ¥æ”¶åˆ°äº† <code>data1 çš„å…¨éƒ¨æ•°æ®</code>å’Œ <code>data2 çš„éƒ¨åˆ†æ•°æ®</code>, ç„¶åæ¥æ”¶åˆ°äº† <code>data2 çš„ä½™ä¸‹çš„æ•°æ®</code>.<br>D. â¼€æ¬¡æ€§æ¥æ”¶åˆ°äº† data1 å’Œ data2 çš„å…¨éƒ¨æ•°æ®.</p><p><code>å…¶ä¸­çš„ BCD å°±æ˜¯æˆ‘ä»¬å¸¸â»…çš„ç²˜åŒ…çš„æƒ…å†µ</code>.</p><h3 id="å¯¹äºå¤„ç†ç²˜åŒ…çš„é—®é¢˜-å¸¸â»…çš„è§£å†³â½…æ¡ˆæœ‰"><a href="#å¯¹äºå¤„ç†ç²˜åŒ…çš„é—®é¢˜-å¸¸â»…çš„è§£å†³â½…æ¡ˆæœ‰" class="headerlink" title="å¯¹äºå¤„ç†ç²˜åŒ…çš„é—®é¢˜, å¸¸â»…çš„è§£å†³â½…æ¡ˆæœ‰:"></a>å¯¹äºå¤„ç†ç²˜åŒ…çš„é—®é¢˜, å¸¸â»…çš„è§£å†³â½…æ¡ˆæœ‰:</h3><ol><li>å¤šæ¬¡å‘é€ä¹‹å‰é—´éš”â¼€ä¸ªç­‰å¾…æ—¶é—´ ï¼ˆ<code>åœºæ™¯ï¼šäº¤äº’é¢‘ç‡ä½çš„åœºæ™¯</code>ï¼‰</li><li>å…³é—­ Nagle ç®—æ³• ï¼ˆ<code>åœºæ™¯ï¼šæ•°æ®è¾ƒå¤§ï¼Œé¢‘ç‡ä¸æ˜¯ç‰¹åˆ«é«˜çš„åœºæ™¯</code>ï¼‰</li><li>è¿›â¾å°åŒ…&#x2F;æ‹†åŒ…ï¼ˆ<code>åœºæ™¯ï¼šå‘é€ç‰¹å¾æ•°æ®ï¼Œæ”¶åˆ°åæŒ‰ç‰¹å¾æ•°æ®è¿›è¡Œåˆ†å‰²</code>ï¼‰</li></ol><h2 id="ä¸ºä»€ä¹ˆ-udp-ä¸ä¼šç²˜åŒ…ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-udp-ä¸ä¼šç²˜åŒ…ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ udp ä¸ä¼šç²˜åŒ…ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ udp ä¸ä¼šç²˜åŒ…ï¼Ÿ</h2><ol><li>TCP åè®®æ˜¯â¾¯å‘æµçš„åè®®ï¼ŒUDP æ˜¯â¾¯å‘æ¶ˆæ¯çš„åè®® UDP æ®µéƒ½æ˜¯â¼€æ¡æ¶ˆæ¯ï¼Œåº”â½¤ç¨‹åºå¿…é¡»<code>ä»¥æ¶ˆæ¯ä¸ºå•ä½æå–æ•°æ®</code>ï¼Œä¸èƒ½â¼€æ¬¡æå–ä»»æ„å­—èŠ‚çš„æ•°æ®</li><li>UDP<code>å…·æœ‰ä¿æŠ¤æ¶ˆæ¯è¾¹ç•Œ</code>ï¼Œåœ¨æ¯ä¸ª UDP åŒ…ä¸­å°±æœ‰äº†æ¶ˆæ¯å¤´ï¼ˆæ¶ˆæ¯æ¥æºåœ°å€ï¼Œç«¯â¼ç­‰ä¿¡æ¯ï¼‰ï¼Œè¿™æ ·å¯¹äºæ¥æ”¶ç«¯æ¥è¯´å°±å®¹æ˜“ è¿›â¾åŒºåˆ†å¤„ç†äº†ã€‚</li><li>ä¼ è¾“åè®®<code>æŠŠæ•°æ®å½“ä½œâ¼€æ¡ç‹¬â½´çš„æ¶ˆæ¯åœ¨â½¹ä¸Šä¼ è¾“ï¼Œæ¥æ”¶ç«¯åªèƒ½æ¥æ”¶ç‹¬â½´çš„æ¶ˆæ¯</code>ã€‚æ¥æ”¶ç«¯â¼€æ¬¡åªèƒ½æ¥æ”¶å‘é€ç«¯å‘å‡ºçš„â¼€ä¸ªæ•°æ®åŒ…,å¦‚æœâ¼€æ¬¡æ¥å—æ•°æ®çš„â¼¤â¼©â¼©äºå‘é€ç«¯â¼€æ¬¡å‘é€çš„æ•°æ®â¼¤â¼©ï¼Œå°±ä¼šä¸¢å¤±â¼€éƒ¨åˆ†æ•°æ®ï¼Œå³ä½¿ä¸¢å¤±ï¼Œæ¥å—ç«¯ä¹Ÿä¸ä¼šåˆ†ä¸¤æ¬¡å»æ¥æ”¶</li></ol><h2 id="TCP-ä¸‰æ¬¡æ¡æ‰‹"><a href="#TCP-ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="TCP ä¸‰æ¬¡æ¡æ‰‹"></a>TCP ä¸‰æ¬¡æ¡æ‰‹</h2><p>æ‰€è°“ä¸‰æ¬¡æ¡â¼¿(Three-way Handshake)ï¼Œæ˜¯æŒ‡å»ºâ½´â¼€ä¸ª TCP è¿æ¥æ—¶ï¼Œ<code>éœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ€»å…±å‘é€3ä¸ªåŒ…</code>ã€‚</p><p>ä¸‰æ¬¡æ¡â¼¿çš„â½¬çš„æ˜¯è¿æ¥æœåŠ¡å™¨æŒ‡å®šç«¯â¼ï¼Œå»ºâ½´ TCP è¿æ¥ï¼Œå¹¶åŒæ­¥è¿æ¥åŒâ½…çš„åºåˆ—å·å’Œç¡®è®¤å·ï¼Œäº¤æ¢ TCP çª—â¼â¼¤â¼©ä¿¡æ¯ã€‚</p><ul><li>å®¢æˆ·ç«¯ï¼š<code>SYNæ ‡å¿—+åºåˆ—å·</code>,è¿›å…¥<code>SYN_SEND</code>çŠ¶æ€</li><li>æœåŠ¡ç«¯ï¼š<code>SYNæ ‡å¿—+åºåˆ—å·+ç¡®è®¤æ ‡è¯†+ç¡®è®¤åºåˆ—å·</code>, è¿›å…¥<code>SYN_RCVD</code>çŠ¶æ€</li><li>å®¢æˆ·ç«¯ï¼š<code>ç¡®è®¤åº”ç­”+ç¡®è®¤åºåˆ—å·</code>ï¼Œè¿›å…¥<code>ESTABLISHED</code>çŠ¶æ€</li></ul><details class="custom-details"><summary>ç‚¹å‡»æŸ¥çœ‹æ›´å¤š</summary><p><p>åœ¨ socket ç¼–ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯æ‰§â¾ connect() æ—¶ã€‚å°†è§¦å‘ä¸‰æ¬¡æ¡â¼¿ã€‚</p><ul><li><p><code>ç¬¬â¼€æ¬¡æ¡â¼¿(SYN=1, seq=x)</code>: å®¢æˆ·ç«¯å‘é€â¼€ä¸ª TCP çš„ SYN æ ‡å¿—ä½ç½® 1 çš„åŒ…ï¼ŒæŒ‡æ˜å®¢æˆ·ç«¯æ‰“ç®—è¿æ¥çš„æœåŠ¡å™¨çš„ç«¯â¼ï¼Œä»¥åŠåˆå§‹åºå· X,ä¿å­˜åœ¨åŒ…å¤´ çš„åºåˆ—å·(Sequence Number)å­—æ®µâ¾¥ã€‚ å‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯è¿›â¼Š SYN_SEND çŠ¶æ€ã€‚ <code>SYNæ ‡å¿—+åºåˆ—å·+SYN_SEND</code></p></li><li><p><code>ç¬¬â¼†æ¬¡æ¡â¼¿(SYN=1, ACK=1, seq=y, ACKnum=x+1)</code>: æœåŠ¡å™¨å‘å›ç¡®è®¤åŒ…(ACK)åº”ç­”ã€‚å³ SYN æ ‡å¿—ä½å’Œ ACK æ ‡å¿—ä½å‡ä¸º 1ã€‚æœåŠ¡å™¨ç«¯é€‰æ‹©â¾ƒâ¼° ISN åºåˆ—å·ï¼Œæ”¾åˆ° Seq åŸŸ â¾¥ï¼ŒåŒæ—¶å°†ç¡®è®¤åºå·(Acknowledgement Number)è®¾ç½®ä¸ºå®¢æˆ·çš„ ISN åŠ  1ï¼Œå³ X+1ã€‚ å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›â¼Š SYN_RCVD çŠ¶æ€ã€‚</p></li><li><p><code>ç¬¬ä¸‰æ¬¡æ¡â¼¿(ACK=1ï¼ŒACKnum=y+1) å®¢æˆ·ç«¯å†æ¬¡å‘é€ç¡®è®¤åŒ…(ACK)ï¼ŒSYN æ ‡å¿—ä½ä¸º 0ï¼ŒACK æ ‡å¿—ä½ä¸º 1ï¼Œå¹¶ä¸”æŠŠæœåŠ¡å™¨å‘æ¥ ACK çš„åºå·å­—æ®µ+1ï¼Œæ”¾åœ¨ç¡® å®šå­—æ®µä¸­å‘é€ç»™å¯¹â½…</code>ï¼Œå¹¶ä¸”åœ¨æ•°æ®æ®µæ”¾å†™ ISN çš„+1 å‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯è¿›â¼Š ESTABLISHED çŠ¶æ€ï¼Œå½“æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¿™ä¸ªåŒ…æ—¶ï¼Œä¹Ÿè¿›â¼Š ESTABLISHED çŠ¶æ€ï¼ŒTCP æ¡â¼¿ ç»“æŸã€‚ ä¸‰æ¬¡æ¡â¼¿çš„è¿‡ç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p></li></ul><img src="http://t-blog-images.aijs.top/img/20220715170016.webp" /></p></details><h2 id="TCP-å››æ¬¡æ¡æ‰‹"><a href="#TCP-å››æ¬¡æ¡æ‰‹" class="headerlink" title="TCP å››æ¬¡æ¡æ‰‹"></a>TCP å››æ¬¡æ¡æ‰‹</h2><p>âœ¨ TCP çš„è¿æ¥çš„æ‹†é™¤éœ€è¦å‘é€å››ä¸ªåŒ…ï¼Œå› æ­¤ç§°ä¸ºå››æ¬¡æŒ¥â¼¿(Four-way handshake)ï¼Œä¹Ÿå«åšæ”¹è¿›çš„ä¸‰æ¬¡æ¡â¼¿ã€‚<code>å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å‡å¯ä¸»åŠ¨å‘èµ·æŒ¥â¼¿åŠ¨ä½œ</code>ï¼Œåœ¨ socket ç¼–ç¨‹ä¸­ï¼Œä»»ä½•â¼€â½…æ‰§â¾ close() æ“ä½œå³å¯äº§â½£æŒ¥â¼¿æ“ä½œã€‚</p><ul><li>å®¢æˆ·ç«¯ï¼š<code>ç»“æŸæ ‡è¯†+åºåˆ—å·</code>,è¿›â¼Š <code>FIN_WAIT_1</code> çŠ¶æ€</li><li>æœåŠ¡ç«¯ï¼š<code>ç¡®è®¤æ ‡è¯†+ç¡®è®¤åº”ç­”åºå·</code>,è¿›â¼Š <code>FIN_WAIT_1</code> çŠ¶æ€</li><li>æœåŠ¡ç«¯ï¼š<code>ç»“æŸæ ‡è¯†+åºåˆ—å·</code>,è¿›â¼Š <code>FIN_WAIT_2</code> çŠ¶æ€</li><li>å®¢æˆ·ç«¯ï¼š<code>ç¡®è®¤æ ‡è¯†+ç¡®è®¤åº”ç­”åºå·</code>,è¿›â¼Š <code>TIME_WAIT</code> çŠ¶æ€</li><li>å ç»­ï¼šæœåŠ¡ç«¯ï¼šè¿›â¼Š <code>CLOSED</code> çŠ¶æ€ï¼Œå®¢æˆ·ç«¯ï¼š<code>ä¸¤ä¸ªæœ€â¼¤æ®µâ½£å‘½å‘¨æœŸ</code>, è¿›â¼Š <code>CLOSED</code> çŠ¶æ€</li></ul><details class="custom-details"><summary>ç‚¹å‡»æŸ¥çœ‹æ›´å¤š</summary><ul><li><p><code>ç¬¬â¼€æ¬¡æŒ¥â¼¿(FIN=1ï¼Œseq=x)</code> å‡è®¾å®¢æˆ·ç«¯æƒ³è¦å…³é—­è¿æ¥ï¼Œå®¢æˆ·ç«¯å‘é€â¼€ä¸ª FIN æ ‡å¿—ä½ç½®ä¸º 1 çš„åŒ…ï¼Œè¡¨ç¤ºâ¾ƒâ¼°å·²ç»æ²¡æœ‰æ•°æ®å¯ä»¥å‘é€äº†ï¼Œä½†æ˜¯ä»ç„¶ å¯ä»¥æ¥å—æ•°æ®ã€‚ å‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯è¿›â¼Š FIN_WAIT_1 çŠ¶æ€ã€‚</p></li><li><p><code>ç¬¬â¼†æ¬¡æŒ¥â¼¿(ACK=1ï¼ŒACKnum=x+1)</code> æœåŠ¡å™¨ç«¯ç¡®è®¤å®¢æˆ·ç«¯çš„ FIN åŒ…ï¼Œå‘é€â¼€ä¸ªç¡®è®¤åŒ…ï¼Œè¡¨æ˜â¾ƒâ¼°æ¥å—åˆ°äº†å®¢æˆ·ç«¯å…³é—­è¿æ¥çš„è¯·æ±‚ï¼Œä½†è¿˜æ²¡æœ‰å‡†å¤‡å¥½å…³é—­ è¿æ¥ã€‚ å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›â¼Š CLOSE_WAIT çŠ¶æ€ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿™ä¸ªç¡®è®¤åŒ…ä¹‹åï¼Œè¿›â¼Š FIN_WAIT_2 çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ å™¨ç«¯å…³é—­è¿æ¥ã€‚</p></li><li><p><code>ç¬¬ä¸‰æ¬¡æŒ¥â¼¿(FIN=1ï¼Œseq=y)</code> æœåŠ¡å™¨ç«¯å‡†å¤‡å¥½å…³é—­è¿æ¥æ—¶ï¼Œå‘å®¢æˆ·ç«¯å‘é€ç»“æŸè¿æ¥è¯·æ±‚ï¼ŒFIN ç½®ä¸º 1ã€‚ TCP â¾¯è¯•é¢˜ 54 å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›â¼Š LAST_ACK çŠ¶æ€ï¼Œç­‰å¾…æ¥â¾ƒå®¢æˆ·ç«¯çš„æœ€åâ¼€ä¸ª ACKã€‚</p></li><li><p><code>ç¬¬å››æ¬¡æŒ¥â¼¿(ACK=1ï¼ŒACKnum=y+1)</code> å®¢æˆ·ç«¯æ¥æ”¶åˆ°æ¥â¾ƒæœåŠ¡å™¨ç«¯çš„å…³é—­è¯·æ±‚ï¼Œå‘é€â¼€ä¸ªç¡®è®¤åŒ…ï¼Œå¹¶è¿›â¼Š TIME_WAIT çŠ¶æ€ï¼Œç­‰å¾…å¯èƒ½å‡ºç°çš„è¦æ±‚é‡ä¼ çš„ ACK åŒ…ã€‚ æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¿™ä¸ªç¡®è®¤åŒ…ä¹‹åï¼Œå…³é—­è¿æ¥ï¼Œè¿›â¼Š CLOSED çŠ¶æ€ã€‚</p></li><li><p>å®¢æˆ·ç«¯ç­‰å¾…äº†æŸä¸ªå›ºå®šæ—¶é—´ï¼ˆä¸¤ä¸ªæœ€â¼¤æ®µâ½£å‘½å‘¨æœŸï¼Œ2MSLï¼Œ2 Maximum Segment Lifetimeï¼‰ä¹‹åï¼Œæ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ ACK ï¼Œè®¤ä¸ºæœåŠ¡å™¨ç«¯å·²ç»æ­£å¸¸å…³é—­è¿æ¥ï¼Œäºæ˜¯â¾ƒâ¼°ä¹Ÿå…³é—­è¿æ¥ï¼Œè¿›â¼Š CLOSED çŠ¶æ€ã€‚ å››æ¬¡æŒ¥â¼¿çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p></li></ul><img src="http://t-blog-images.aijs.top/img/20220715170027.webp" /></details><h2 id="è¯·æ±‚è¿æ¥æ˜¯ä¸‰æ¬¡ï¼Œæ–­å¼€è¿æ¥æ˜¯å››æ¬¡"><a href="#è¯·æ±‚è¿æ¥æ˜¯ä¸‰æ¬¡ï¼Œæ–­å¼€è¿æ¥æ˜¯å››æ¬¡" class="headerlink" title="è¯·æ±‚è¿æ¥æ˜¯ä¸‰æ¬¡ï¼Œæ–­å¼€è¿æ¥æ˜¯å››æ¬¡"></a>è¯·æ±‚è¿æ¥æ˜¯ä¸‰æ¬¡ï¼Œæ–­å¼€è¿æ¥æ˜¯å››æ¬¡</h2><ul><li>æœåŠ¡ç«¯ï¼š<code>ç¡®è®¤æ ‡è¯†+ç¡®è®¤åº”ç­”åºå·</code>,è¿›â¼Š <code>FIN_WAIT_1</code> çŠ¶æ€</li><li>æœåŠ¡ç«¯ï¼š<code>ç»“æŸæ ‡è¯†+åºåˆ—å·</code>,è¿›â¼Š <code>FIN_WAIT_2</code> çŠ¶æ€</li></ul><p>åˆ†ä¸ºä¸¤ä¸ªï¼Œç›®çš„æ˜¯åœ¨æœåŠ¡ç«¯å‘é€å®Œæ•°æ®åï¼Œç„¶åè¿›è¡Œå‘é€å…³é—­ä¿¡å·</p><h2 id="ä¸‰æ¬¡æ¡æ‰‹æ”¹ä¸ºä¸¤æ¬¡"><a href="#ä¸‰æ¬¡æ¡æ‰‹æ”¹ä¸ºä¸¤æ¬¡" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹æ”¹ä¸ºä¸¤æ¬¡"></a>ä¸‰æ¬¡æ¡æ‰‹æ”¹ä¸ºä¸¤æ¬¡</h2><p>é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹æ˜¯ä¸ºäº†<code>é˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°ä¸»æœºBï¼Œå› è€Œäº§ç”Ÿé”™è¯¯</code>ã€‚</p><p>å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µæ˜¯æŒ‡ï¼šä¸»æœº A å‘å‡ºçš„è¿æ¥è¯·æ±‚æ²¡æœ‰æ”¶åˆ°ä¸»æœº B çš„ç¡®è®¤ï¼Œäºæ˜¯ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œä¸»æœº A åˆé‡æ–°å‘ä¸»æœº B å‘é€è¿æ¥è¯·æ±‚ï¼Œä¸”å»ºç«‹æˆåŠŸï¼Œé¡ºåºå®Œæˆæ•°æ®ä¼ è¾“ã€‚</p><p>è€ƒè™‘è¿™æ ·ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š&#96;ä¸»æœº A ç¬¬ä¸€æ¬¡å‘é€çš„è¿æ¥è¯·æ±‚å¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯å› ä¸ºç½‘ç»œèŠ‚ç‚¹å¯¼è‡´å»¶è¿Ÿè¾¾åˆ°ä¸»æœº Bï¼Œä¸»æœº B ä»¥ä¸ºæ˜¯ä¸»æœº A åˆå‘èµ·çš„æ–°è¿æ¥ï¼Œäºæ˜¯ä¸»æœº B åŒæ„è¿æ¥ï¼Œå¹¶å‘ä¸»æœº A å‘å›ç¡®è®¤ï¼Œä½†æ˜¯æ­¤æ—¶ä¸»æœº A æ ¹æœ¬ä¸ä¼šç†ä¼šï¼Œä¸»æœº B å°±ä¸€ç›´åœ¨ç­‰å¾…ä¸»æœº A å‘é€æ•°æ®ï¼Œå¯¼è‡´ä¸»æœº B çš„èµ„æºæµªè´¹ã€‚</p><p>é‡‡ç”¨ä¸¤æ¬¡æ¡æ‰‹ä¸è¡Œï¼ŒåŸå› å°±æ˜¯ä¸Šé¢è¯´çš„<code>å¤±æ•ˆçš„è¿æ¥è¯·æ±‚</code>çš„ç‰¹æ®Šæƒ…å†µã€‚</p><p><strong>ä¸æ˜¯å¾ˆæ°å½“çš„ä¾‹å­</strong></p><ul><li>ä¾‹å­ 1ï¼ˆ3 æ¬¡æ¡æ‰‹ï¼‰ï¼šæœ‹å‹ï¼šæ¥åƒé¥­ -&gt; ä½ ï¼šå¥½å’§ï¼Œç­‰æˆ‘å“ˆ -&gt; æœ‹å‹ï¼šğŸ‘Œã€‚  <br/><br/></li><li>ä¾‹å­ 2ï¼ˆ2 æ¬¡æ¡æ‰‹ï¼‰ï¼šæœ‹å‹ï¼šæ¥åƒé¥­ -&gt; ä½ ï¼ˆç¬¬äºŒå¤©ä½ çœ‹åˆ°äº†ï¼‰ï¼šå¥½å’§ï¼Œç­‰æˆ‘å“ˆã€‚ æœ‹å‹ä¸åœ¨å®¶ï¼ˆåƒé—­é—¨ç¾¹ï¼‰</li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/nk298120/article/details/116596086" target="_blank" >TCP ä¸‰æ¬¡æ¡æ‰‹å¦‚æœä½¿ç”¨äºŒæ¬¡æ¡æ‰‹ä»£æ›¿åˆ™ä¼šå‡ºç°çš„é—®é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-å®‰å…¨</title>
      <link href="//post/2022-07-15%E5%AE%89%E5%85%A8.html"/>
      <url>//post/2022-07-15%E5%AE%89%E5%85%A8.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç«¯å®‰å…¨é—®é¢˜"><a href="#å‰ç«¯å®‰å…¨é—®é¢˜" class="headerlink" title="å‰ç«¯å®‰å…¨é—®é¢˜?"></a>å‰ç«¯å®‰å…¨é—®é¢˜?</h2><ul><li><code>è·¨ç«™è„šæœ¬ (Cross-Site Scripting, XSS)</code>: â¼€ç§ä»£ç æ³¨â¼Šâ½…å¼, ä¸ºäº†ä¸ CSS åŒºåˆ†æ‰€ä»¥è¢«ç§°ä½œ XSS. æ—©æœŸå¸¸â»…äºâ½¹ç»œè®ºå›, èµ·å› æ˜¯â½¹ç«™æ²¡æœ‰å¯¹â½¤æˆ·çš„è¾“â¼Šè¿›â¾ä¸¥æ ¼çš„é™åˆ¶, ä½¿å¾—æ”»å‡»è€…å¯ä»¥å°†è„šæœ¬ä¸Šä¼ åˆ°å¸–â¼¦è®©å…¶ä»–â¼ˆæµè§ˆåˆ°æœ‰æ¶æ„è„šæœ¬çš„â»š â¾¯, å…¶æ³¨â¼Šâ½…å¼å¾ˆç®€å•åŒ…æ‹¬ä½†ä¸é™äº JavaScript &#x2F; VBScript &#x2F; CSS &#x2F; Flash ç­‰</li><li><code>è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ï¼ˆCross-Site Request Forgeriesï¼ŒCSRFï¼‰</code>: æŒ‡æ”»å‡»è€…é€šè¿‡è®¾ç½®å¥½çš„é™·é˜±ï¼Œå¼ºåˆ¶å¯¹å·²å®Œæˆè®¤è¯çš„â½¤ æˆ·è¿›â¾â¾®é¢„æœŸçš„ä¸ªâ¼ˆä¿¡æ¯æˆ–è®¾å®šä¿¡æ¯ç­‰æŸäº›çŠ¶æ€æ›´æ–°ï¼Œå±äºè¢«åŠ¨æ”»å‡»</li><li><code>iframe çš„æ»¥â½¤</code>: iframe ä¸­çš„å†…å®¹æ˜¯ç”±ç¬¬ä¸‰â½…æ¥æä¾›çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä»–ä»¬ä¸å—æˆ‘ä»¬çš„æ§åˆ¶ï¼Œä»–ä»¬å¯ä»¥åœ¨ iframe ä¸­è¿â¾ JavaScirpt è„šæœ¬ã€Flash æ’ä»¶ã€å¼¹å‡ºå¯¹è¯æ¡†ç­‰ç­‰ï¼Œè¿™å¯èƒ½ä¼šç ´åå‰ç«¯â½¤æˆ·ä½“éªŒ</li><li><code>æ¶æ„ç¬¬ä¸‰â½…åº“</code>: ã€<code>è¿™ä¸ªå°±éœ€è¦æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸€äº›åº“ä¹‹å‰ï¼Œæœ€å¥½èƒ½å¤Ÿé˜…è¯»å…¶æºç </code>ã€‘â½†è®ºæ˜¯åç«¯æœåŠ¡å™¨åº”â½¤è¿˜æ˜¯å‰ç«¯åº”â½¤å¼€å‘ï¼Œç»â¼¤å¤šæ•°æ—¶å€™æˆ‘ä»¬éƒ½æ˜¯åœ¨å€ŸåŠ©å¼€å‘æ¡†æ¶å’Œå„ç§ç±»åº“è¿›â¾ å¿«é€Ÿå¼€å‘,â¼€æ—¦ç¬¬ä¸‰â½…åº“è¢«æ¤â¼Šæ¶æ„ä»£ç å¾ˆå®¹æ˜“å¼•èµ·å®‰å…¨é—®é¢˜,â½å¦‚ event-stream çš„æ¶æ„ä»£ç äº‹ä»¶,2018 å¹´ 11 â½‰ 21 â½‡ï¼Œ åä¸º FallingSnow çš„â½¤æˆ·åœ¨çŸ¥å JavaScript åº”â½¤åº“ event-stream åœ¨ github Issuse ä¸­å‘å¸ƒäº†é’ˆå¯¹æ¤â¼Šçš„æ¶æ„ä»£ç çš„ç–‘ é—®ï¼Œè¡¨ç¤º event-stream ä¸­å­˜åœ¨â½¤äºçªƒå–â½¤æˆ·æ•°å­—é’±åŒ…çš„æ¶æ„ä»£ç </li><li>DDoS æ”»å‡»ï¼Œ <code>DDos</code>å…¨å<code>Distributed Denial of Service</code>ï¼Œç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯<code>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡</code></li><li>ä¸­é—´äººæ”»å‡»ï¼Œ (Man-in-the-middle attack, MITM)</li></ul><h2 id="XSS-åˆ†ä¸ºå“ªâ¼ç±»"><a href="#XSS-åˆ†ä¸ºå“ªâ¼ç±»" class="headerlink" title="XSS åˆ†ä¸ºå“ªâ¼ç±»?"></a>XSS åˆ†ä¸ºå“ªâ¼ç±»?</h2><p>æ ¹æ®æ”»å‡»çš„æ¥æºï¼ŒXSS æ”»å‡»å¯åˆ†ä¸º<code>å­˜å‚¨å‹</code>ã€<code>åå°„å‹</code>å’Œ <code>DOMå‹</code>ä¸‰ç§ã€‚</p><h3 id="å­˜å‚¨å‹ï¼š"><a href="#å­˜å‚¨å‹ï¼š" class="headerlink" title="å­˜å‚¨å‹ï¼š"></a>å­˜å‚¨å‹ï¼š</h3><ul><li>æ¶æ„ä»£ç å­˜æ”¾çš„ä½ç½®ã€‚ æ’â¼Šç‚¹ï¼šç”±è°å–å¾—æ¶æ„ä»£ç ï¼Œå¹¶æ’â¼Šåˆ°â½¹â»šä¸Šã€‚ å­˜å‚¨å‹ XSS å­˜å‚¨å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š</li></ul><ol><li>æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°â½¬æ ‡â½¹ç«™çš„<code>æ•°æ®åº“</code>ä¸­ã€‚</li><li>â½¤æˆ·æ‰“å¼€â½¬æ ‡â½¹ç«™æ—¶ï¼Œâ½¹ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç <code>ä»æ•°æ®åº“å–å‡º</code>ï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚</li><li>â½¤æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§â¾ï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§â¾ã€‚</li><li>æ¶æ„ä»£ç çªƒå–â½¤æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„â½¹ç«™ï¼Œæˆ–è€…å†’å……â½¤æˆ·çš„â¾ä¸ºï¼Œè°ƒâ½¤â½¬æ ‡â½¹ç«™æ¥â¼æ‰§â¾æ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚</li></ol><p><strong>åœºæ™¯</strong></p><p>è¿™ç§æ”»å‡»å¸¸â»…äºå¸¦æœ‰â½¤æˆ·ä¿å­˜æ•°æ®çš„â½¹ç«™åŠŸèƒ½ï¼Œå¦‚è®ºå›å‘å¸–ã€å•†å“è¯„è®ºã€â½¤æˆ·ç§ä¿¡ç­‰ã€‚</p><h3 id="åå°„å‹"><a href="#åå°„å‹" class="headerlink" title="åå°„å‹"></a>åå°„å‹</h3><p>åå°„å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š</p><ol><li>æ”»å‡»è€…æ„<code>é€ å‡ºç‰¹æ®Šçš„ URL</code>ï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚</li><li>â½¤æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URL æ—¶ï¼Œâ½¹ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç <code>ä»URLä¸­å–å‡º</code>ï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚</li><li>â½¤æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§â¾ï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§â¾ã€‚</li><li>æ¶æ„ä»£ç çªƒå–â½¤æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„â½¹ç«™ï¼Œæˆ–è€…å†’å……â½¤æˆ·çš„â¾ä¸ºï¼Œè°ƒâ½¤â½¬æ ‡â½¹ç«™æ¥â¼æ‰§â¾æ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚</li></ol><p>åå°„å‹ XSS è·Ÿå­˜å‚¨å‹ XSS çš„åŒºåˆ«æ˜¯ï¼šå­˜å‚¨å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨æ•°æ®åº“â¾¥ï¼Œåå°„å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨ URL â¾¥ã€‚</p><p><strong>åœºæ™¯</strong></p><p>åå°„å‹ XSS æ¼æ´å¸¸â»…äºé€šè¿‡ URL ä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚â½¹ç«™æœç´¢ã€è·³è½¬ç­‰ã€‚ ç”±äºéœ€è¦â½¤æˆ·ä¸»åŠ¨æ‰“å¼€æ¶æ„çš„ URL æ‰èƒ½â½£æ•ˆï¼Œæ”»å‡»è€…å¾€å¾€ä¼šç»“åˆå¤šç§â¼¿æ®µè¯±å¯¼â½¤æˆ·ç‚¹å‡»ã€‚</p><p>POST çš„å†…å®¹ä¹Ÿå¯ä»¥è§¦å‘åå°„å‹ XSSï¼Œåªä¸è¿‡å…¶è§¦å‘æ¡ä»¶â½è¾ƒè‹›åˆ»ï¼ˆéœ€è¦æ„é€ è¡¨å•æäº¤â»šâ¾¯ï¼Œå¹¶å¼•å¯¼â½¤æˆ·ç‚¹å‡»ï¼‰ï¼Œæ‰€ ä»¥â¾®å¸¸å°‘â»…ã€‚</p><h3 id="DOM-å‹"><a href="#DOM-å‹" class="headerlink" title="DOM å‹"></a>DOM å‹</h3><p>XSS DOM å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š</p><ol><li>æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚</li><li>â½¤æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URLã€‚</li><li>â½¤æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§â¾ï¼Œå‰ç«¯ JavaScript å–å‡º URL ä¸­çš„æ¶æ„ä»£ç å¹¶æ‰§â¾ã€‚</li><li>æ¶æ„ä»£ç çªƒå–â½¤æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„â½¹ç«™ï¼Œæˆ–è€…å†’å……â½¤æˆ·çš„â¾ä¸ºï¼Œè°ƒâ½¤â½¬æ ‡â½¹ç«™æ¥â¼æ‰§â¾æ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚</li></ol><p>DOM å‹ XSS è·Ÿå‰ä¸¤ç§ XSS çš„åŒºåˆ«ï¼š</p><p>DOM å‹ XSS æ”»å‡»ä¸­ï¼Œ<code>å–å‡ºå’Œæ‰§â¾æ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆ</code>ï¼Œå±äºå‰ç«¯ JavaScript â¾ƒèº«çš„å®‰å…¨æ¼æ´ï¼Œâ½½å…¶ä»–ä¸¤ç§ XSS éƒ½å±äºæœåŠ¡ç«¯çš„å®‰å…¨æ¼æ´ã€‚</p><h2 id="å¦‚ä½•é¢„é˜²-XSS"><a href="#å¦‚ä½•é¢„é˜²-XSS" class="headerlink" title="å¦‚ä½•é¢„é˜² XSS?"></a>å¦‚ä½•é¢„é˜² XSS?</h2><p>XSS æ”»å‡»æœ‰ä¸¤â¼¤è¦ç´ ï¼š</p><ol><li>æ”»å‡»è€…æäº¤æ¶æ„ä»£ç ã€‚</li><li>æµè§ˆå™¨æ‰§â¾æ¶æ„ä»£ç ã€‚</li></ol><p>é’ˆå¯¹ç¬¬â¼€ä¸ªè¦ç´ ï¼šæˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿåœ¨â½¤æˆ·è¾“â¼Šçš„è¿‡ç¨‹ï¼Œè¿‡æ»¤æ‰â½¤æˆ·è¾“â¼Šçš„æ¶æ„ä»£ç å‘¢ï¼Ÿ</p><h3 id="è¾“â¼Šè¿‡æ»¤"><a href="#è¾“â¼Šè¿‡æ»¤" class="headerlink" title="è¾“â¼Šè¿‡æ»¤"></a>è¾“â¼Šè¿‡æ»¤</h3><ul><li>é˜²â½Œ HTML ä¸­å‡ºç°æ³¨â¼Š</li><li>é˜²â½Œ JavaScript æ‰§â¾æ—¶ï¼Œæ‰§â¾æ¶æ„ä»£ç </li></ul><h3 id="å­˜å‚¨å‹å’Œåå°„å‹-XSS"><a href="#å­˜å‚¨å‹å’Œåå°„å‹-XSS" class="headerlink" title="å­˜å‚¨å‹å’Œåå°„å‹ XSS"></a>å­˜å‚¨å‹å’Œåå°„å‹ XSS</h3><p>å¦‚ä½•äº§ç”Ÿï¼Ÿ</p><p>å­˜å‚¨å‹å’Œåå°„å‹ XSS éƒ½æ˜¯åœ¨æœåŠ¡ç«¯å–å‡ºæ¶æ„ä»£ç åï¼Œæ’â¼Šåˆ°å“åº” HTML â¾¥çš„ï¼Œæ”»å‡»è€…åˆ»æ„ç¼–å†™çš„â€œæ•°æ®â€è¢«å†…åµŒåˆ°â€œä»£ ç â€ä¸­ï¼Œè¢«æµè§ˆå™¨æ‰€æ‰§â¾ã€‚</p><p>é¢„é˜²è¿™ä¸¤ç§æ¼æ´ï¼Œæœ‰ä¸¤ç§å¸¸â»…åšæ³•ï¼š</p><ul><li>æ”¹æˆçº¯å‰ç«¯æ¸²æŸ“ï¼ŒæŠŠä»£ç å’Œæ•°æ®åˆ†éš”å¼€</li><li>å¯¹ HTML åšå……åˆ†è½¬ä¹‰ã€‚</li></ul><h3 id="DOM-å‹-XSS"><a href="#DOM-å‹-XSS" class="headerlink" title="DOM å‹ XSS"></a>DOM å‹ XSS</h3><p>DOM å‹ XSS æ”»å‡»ï¼Œå®é™…ä¸Šå°±æ˜¯â½¹ç«™å‰ç«¯ JavaScript ä»£ç æœ¬èº«ä¸å¤Ÿä¸¥è°¨ï¼ŒæŠŠä¸å¯ä¿¡çš„æ•°æ®å½“ä½œä»£ç æ‰§â¾äº†ã€‚</p><ul><li><p>åœ¨ä½¿â½¤ <code>.innerHTML</code> ã€ <code>.outerHTML</code> ã€ <code>document.write()</code> æ—¶è¦ç‰¹åˆ«â¼©â¼¼ï¼Œä¸è¦æŠŠä¸å¯ä¿¡çš„æ•°æ®ä½œä¸º HTML æ’åˆ°â»šâ¾¯ä¸Šï¼Œâ½½åº”å°½é‡ä½¿â½¤ <code>.textContent</code> ã€ <code>.setAttribute()</code> ç­‰ã€‚</p><br/><br/></li><li><p>å¦‚æœâ½¤ Vue&#x2F;React æŠ€æœ¯æ ˆï¼Œå¹¶ä¸”ä¸ä½¿â½¤ <code>v-html</code> &#x2F; <code>dangerouslySetInnerHTML</code> åŠŸèƒ½ï¼Œå°±åœ¨å‰ç«¯ render é˜¶æ®µé¿å… <code>innerHTML</code> ã€ <code>outerHTML</code> çš„ XSS éšæ‚£ã€‚</p><br/><br/></li><li><p>DOM ä¸­çš„å†…è”äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚ location ã€ onclick ã€ onerror ã€ onload ã€ onmouseover ç­‰ï¼Œ</p><br/><br/></li><li><p><code>&lt;a&gt;</code> æ ‡ç­¾çš„ href å± æ€§ï¼Œ</p><br/><br/></li><li><p>JavaScript çš„ <code>eval()</code> ã€ <code>setTimeout()</code> ã€ <code>setInterval()</code> ç­‰ï¼Œéƒ½èƒ½<code>æŠŠå­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿â¾</code>ã€‚</p></li></ul><p>å¦‚æœä¸å¯ä¿¡çš„æ•°æ®æ‹¼æ¥ åˆ°å­—ç¬¦ä¸²ä¸­ä¼ é€’ç»™è¿™äº› APIï¼Œå¾ˆå®¹æ˜“äº§â½£å®‰å…¨éšæ‚£ï¼Œè¯·åŠ¡å¿…é¿å…ã€‚</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;!-- å†…è”äº‹ä»¶ç›‘å¬å™¨ä¸­åŒ…å«æ¶æ„ä»£ç  --&gt;![](https:&#x2F;&#x2F;awps-assets.meituan.net&#x2F;mit-x&#x2F;blog-images-bundle-2018b&#x2F;3e724ce0.data:image&#x2F;png,)&lt;!-- é“¾æ¥å†…åŒ…å«æ¶æ„ä»£ç  --&gt;&lt;a href&#x3D;&quot;UNTRUSTED&quot;&gt;1&lt;&#x2F;a&gt;&lt;script&gt;  &#x2F;&#x2F; setTimeout()&#x2F;setInterval() ä¸­è°ƒâ½¤æ¶æ„ä»£ç   setTimeout(&quot;UNTRUSTED&quot;);  setInterval(&quot;UNTRUSTED&quot;);  &#x2F;&#x2F; location è°ƒâ½¤æ¶æ„ä»£ç   location.href &#x3D; &quot;UNTRUSTED&quot;;  &#x2F;&#x2F; eval() ä¸­è°ƒâ½¤æ¶æ„ä»£ç   eval(&quot;UNTRUSTED&quot;);&lt;&#x2F;script&gt;</code></pre><h3 id="å…¶ä»–-XSS-é˜²èŒƒæªæ–½"><a href="#å…¶ä»–-XSS-é˜²èŒƒæªæ–½" class="headerlink" title="å…¶ä»– XSS é˜²èŒƒæªæ–½"></a>å…¶ä»– XSS é˜²èŒƒæªæ–½</h3><p>è™½ç„¶åœ¨æ¸²æŸ“â»šâ¾¯å’Œæ‰§â¾ JavaScript æ—¶ï¼Œé€šè¿‡è°¨æ…çš„è½¬ä¹‰å¯ä»¥é˜²â½Œ XSS çš„å‘â½£ï¼Œä½†å®Œå…¨ä¾é å¼€å‘çš„è°¨æ…ä»ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚</p><p>ä»¥ä¸‹ä»‹ç»â¼€äº›é€šâ½¤çš„â½…æ¡ˆï¼Œå¯ä»¥é™ä½ XSS å¸¦æ¥çš„â»›é™©å’Œåæœã€‚</p><ul><li><p><code>Content Security Policy</code> ä¸¥æ ¼çš„ CSP åœ¨ XSS çš„é˜²èŒƒä¸­å¯ä»¥èµ·åˆ°ä»¥ä¸‹çš„ä½œâ½¤ï¼š ç¦â½ŒåŠ è½½å¤–åŸŸä»£ç ï¼Œé˜²â½Œå¤æ‚çš„æ”»å‡»é€»è¾‘ ç¦â½Œå¤–åŸŸæäº¤ï¼Œâ½¹ç«™è¢«æ”»å‡»åï¼Œâ½¤æˆ·çš„æ•°æ®ä¸ä¼šæ³„éœ²åˆ°å¤–åŸŸ</p></li><li><p><code>ç¦â½Œå†…è”è„šæœ¬æ‰§â¾</code>ï¼ˆè§„åˆ™è¾ƒä¸¥æ ¼ï¼Œâ½¬å‰å‘ç° GitHub ä½¿â½¤ï¼‰ ç¦â½Œæœªæˆæƒçš„è„šæœ¬æ‰§â¾ï¼ˆæ–°ç‰¹æ€§ï¼ŒGoogle Map ç§»åŠ¨ç‰ˆåœ¨ä½¿â½¤ï¼‰</p></li><li><p><code>åˆç†ä½¿â½¤ä¸ŠæŠ¥</code>å¯ä»¥åŠæ—¶å‘ç° XSSï¼Œåˆ©äºå°½å¿«ä¿®å¤é—®é¢˜ è¾“â¼Šå†…å®¹â»“åº¦æ§åˆ¶ å¯¹äºä¸å—ä¿¡ä»»çš„è¾“â¼Šï¼Œéƒ½åº”è¯¥é™å®šâ¼€ä¸ªåˆç†çš„â»“åº¦ã€‚è™½ç„¶â½†æ³•å®Œå…¨é˜²â½Œ XSS å‘â½£ï¼Œä½†å¯ä»¥å¢åŠ  XSS æ”»å‡»çš„éš¾åº¦ã€‚</p></li><li><p>å…¶ä»–å®‰å…¨æªæ–½<code> HTTP-only Cookie</code>: ç¦â½Œ JavaScript è¯»å–æŸäº›æ•æ„Ÿ Cookieï¼Œæ”»å‡»è€…å®Œæˆ XSS æ³¨â¼Šåä¹Ÿâ½†æ³•çªƒå–æ­¤ Cookieã€‚ éªŒè¯ç ï¼šé˜²â½Œè„šæœ¬å†’å……â½¤æˆ·æäº¤å±é™©æ“ä½œã€‚</p></li></ul><h2 id="CSRF-æ˜¯ä»€ä¹ˆ"><a href="#CSRF-æ˜¯ä»€ä¹ˆ" class="headerlink" title="CSRF æ˜¯ä»€ä¹ˆ?"></a>CSRF æ˜¯ä»€ä¹ˆ?</h2><p><code>CSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ </code>ï¼šæ”»å‡»è€…è¯±å¯¼å—å®³è€…è¿›â¼Šç¬¬ä¸‰â½…â½¹ç«™ï¼Œåœ¨ç¬¬ä¸‰â½…â½¹ç«™ä¸­ï¼Œå‘è¢«æ”»å‡»â½¹ ç«™å‘é€è·¨ç«™è¯·æ±‚ã€‚åˆ©â½¤å—å®³è€…åœ¨è¢«æ”»å‡»â½¹ç«™å·²ç»è·å–çš„æ³¨å†Œå‡­è¯ï¼Œç»•è¿‡åå°çš„â½¤æˆ·éªŒè¯ï¼Œè¾¾åˆ°å†’å……â½¤æˆ·å¯¹è¢«æ”»å‡»çš„â½¹ç«™ æ‰§â¾æŸé¡¹æ“ä½œçš„â½¬çš„ã€‚ â¼€ä¸ªå…¸å‹çš„ CSRF æ”»å‡»æœ‰ç€å¦‚ä¸‹çš„æµç¨‹ï¼š</p><ul><li>å—å®³è€…ç™»å½• a.com ï¼Œå¹¶ä¿ç•™äº†ç™»å½•å‡­è¯ï¼ˆCookieï¼‰</li><li>æ”»å‡»è€…å¼•è¯±å—å®³è€…è®¿é—®äº† b.com b.com å‘ a.com å‘é€äº†â¼€ä¸ªè¯·æ±‚ï¼š a.com&#x2F;act&#x3D;xx</li><li>æµè§ˆå™¨ä¼šé»˜è®¤æºå¸¦ a.com çš„ Cookie a.com æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå¯¹è¯·æ±‚è¿›â¾éªŒè¯ï¼Œå¹¶ç¡®è®¤æ˜¯å—å®³è€…çš„å‡­è¯ï¼Œè¯¯ä»¥ä¸ºæ˜¯å—å®³è€…â¾ƒâ¼°å‘é€çš„è¯·æ±‚</li><li>a.com ä»¥å—å®³è€…çš„åä¹‰æ‰§â¾äº† act&#x3D;xx</li><li>æ”»å‡»å®Œæˆï¼Œæ”»å‡»è€…åœ¨å—å®³è€…ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå†’å……å—å®³è€…ï¼Œè®© a.com æ‰§â¾äº†â¾ƒâ¼°å®šä¹‰çš„æ“ä½œ</li></ul><h2 id="CSRF-çš„æ”»å‡»ç±»å‹"><a href="#CSRF-çš„æ”»å‡»ç±»å‹" class="headerlink" title="CSRF çš„æ”»å‡»ç±»å‹?"></a>CSRF çš„æ”»å‡»ç±»å‹?</h2><ul><li>GET ç±»å‹çš„ CSRF</li><li>POST ç±»å‹çš„ CSRF</li><li>é“¾æ¥ç±»å‹çš„ CSRF</li></ul><h2 id="å¦‚ä½•é¢„é˜²-CSRF"><a href="#å¦‚ä½•é¢„é˜²-CSRF" class="headerlink" title="å¦‚ä½•é¢„é˜² CSRF?"></a>å¦‚ä½•é¢„é˜² CSRF?</h2><p>CSRF é€šå¸¸ä»ç¬¬ä¸‰â½…â½¹ç«™å‘èµ·ï¼Œè¢«æ”»å‡»çš„â½¹ç«™â½†æ³•é˜²â½Œæ”»å‡»å‘â½£ï¼Œåªèƒ½é€šè¿‡å¢å¼ºâ¾ƒâ¼°â½¹ç«™é’ˆå¯¹ CSRF çš„é˜²æŠ¤èƒ½â¼’æ¥æå‡å®‰å…¨æ€§ã€‚<br>CSRF çš„ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>CSRFï¼ˆé€šå¸¸ï¼‰å‘â½£åœ¨ç¬¬ä¸‰â½…åŸŸå</li><li>CSRF æ”»å‡»è€…ä¸èƒ½è·å–åˆ° Cookie ç­‰ä¿¡æ¯ï¼Œåªæ˜¯ä½¿â½¤ã€‚</li></ul><p>é’ˆå¯¹è¿™ä¸¤ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“â»”åˆ¶å®šé˜²æŠ¤ç­–ç•¥ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>é˜»â½Œä¸æ˜å¤–åŸŸçš„è®¿é—®<ol><li><code>åŒæºæ£€æµ‹</code></li><li><code>Samesite Cookie</code></li></ol></li><li>æäº¤æ—¶è¦æ±‚é™„åŠ æœ¬åŸŸæ‰èƒ½è·å–çš„ä¿¡æ¯<ol><li>CSRF Token</li><li>åŒé‡ Cookie éªŒè¯</li></ol></li></ul><p>å› æ­¤æˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ€§å¾—è¿›â¾é¢„é˜²</p><h3 id="åŒæºæ£€æµ‹"><a href="#åŒæºæ£€æµ‹" class="headerlink" title="åŒæºæ£€æµ‹"></a>åŒæºæ£€æµ‹</h3><p>æ—¢ç„¶ CSRF â¼¤å¤šæ¥â¾ƒç¬¬ä¸‰â½…â½¹ç«™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›´æ¥ç¦â½Œå¤–åŸŸï¼ˆæˆ–è€…ä¸å—ä¿¡ä»»çš„åŸŸåï¼‰å¯¹æˆ‘ä»¬å‘èµ·è¯·æ±‚:</p><ul><li>ä½¿â½¤ Origin Header ç¡®å®šæ¥æºåŸŸå: åœ¨éƒ¨åˆ†ä¸ CSRF æœ‰å…³çš„è¯·æ±‚ä¸­ï¼Œè¯·æ±‚çš„ Header ä¸­ä¼šæºå¸¦ Origin å­—æ®µ,å¦‚æœ Origin å­˜åœ¨ï¼Œé‚£ä¹ˆç›´æ¥ä½¿â½¤ Origin ä¸­çš„å­—æ®µç¡®è®¤æ¥æºåŸŸåå°±å¯ä»¥</li><li>ä½¿â½¤ Referer Header ç¡®å®šæ¥æºåŸŸå: æ ¹æ® HTTP åè®®ï¼Œåœ¨ HTTP å¤´ä¸­æœ‰â¼€ä¸ªå­—æ®µå« Refererï¼Œè®°å½•äº†è¯¥ HTTP è¯·æ±‚çš„æ¥ æºåœ°å€</li></ul><h3 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h3><p>CSRF çš„å¦â¼€ä¸ªç‰¹å¾æ˜¯ï¼Œæ”»å‡»è€…â½†æ³•ç›´æ¥çªƒå–åˆ°â½¤æˆ·çš„ä¿¡æ¯ï¼ˆCookieï¼ŒHeaderï¼Œâ½¹ç«™å†…å®¹ç­‰ï¼‰ï¼Œä»…ä»…æ˜¯å†’â½¤ Cookie ä¸­çš„ ä¿¡æ¯ã€‚</p><p>â½½ CSRF æ”»å‡»ä¹‹æ‰€ä»¥èƒ½å¤ŸæˆåŠŸï¼Œæ˜¯å› ä¸ºæœåŠ¡å™¨è¯¯æŠŠæ”»å‡»è€…å‘é€çš„è¯·æ±‚å½“æˆäº†â½¤æˆ·â¾ƒâ¼°çš„è¯·æ±‚ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¦æ±‚æ‰€æœ‰çš„ â½¤æˆ·è¯·æ±‚éƒ½æºå¸¦â¼€ä¸ª CSRF æ”»å‡»è€…â½†æ³•è·å–åˆ°çš„ Tokenã€‚æœåŠ¡å™¨é€šè¿‡æ ¡éªŒè¯·æ±‚æ˜¯å¦æºå¸¦æ­£ç¡®çš„ Tokenï¼Œæ¥æŠŠæ­£å¸¸çš„è¯·æ±‚ å’Œæ”»å‡»çš„è¯·æ±‚åŒºåˆ†å¼€ï¼Œä¹Ÿå¯ä»¥é˜²èŒƒ CSRF çš„æ”»å‡»:</p><p>CSRF Token çš„é˜²æŠ¤ç­–ç•¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><ul><li>å°† CSRF Token è¾“å‡ºåˆ°â»šâ¾¯ä¸­</li><li>â»šâ¾¯æäº¤çš„è¯·æ±‚æºå¸¦è¿™ä¸ª Token</li><li>æœåŠ¡å™¨éªŒè¯ Token æ˜¯å¦æ­£ç¡®</li></ul><h3 id="åŒé‡-Cookie-éªŒè¯"><a href="#åŒé‡-Cookie-éªŒè¯" class="headerlink" title="åŒé‡ Cookie éªŒè¯"></a>åŒé‡ Cookie éªŒè¯</h3><p>åœ¨ä¼šè¯ä¸­å­˜å‚¨ CSRF Token â½è¾ƒç¹çï¼Œâ½½ä¸”ä¸èƒ½åœ¨é€šâ½¤çš„æ‹¦æˆªä¸Šç»Ÿâ¼€å¤„ç†æ‰€æœ‰çš„æ¥â¼ é‚£ä¹ˆå¦â¼€ç§é˜²å¾¡æªæ–½æ˜¯ä½¿â½¤åŒé‡æäº¤ Cookieã€‚åˆ©â½¤ CSRF æ”»å‡»ä¸èƒ½è·å–åˆ°â½¤æˆ· Cookie çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ Ajax å’Œè¡¨å• è¯·æ±‚æºå¸¦â¼€ä¸ª Cookie ä¸­çš„å€¼</p><p>åŒé‡ Cookie é‡‡â½¤ä»¥ä¸‹æµç¨‹ï¼š</p><ul><li>åœ¨â½¤æˆ·è®¿é—®â½¹ç«™â»šâ¾¯æ—¶ï¼Œå‘è¯·æ±‚åŸŸåæ³¨â¼Šâ¼€ä¸ª Cookieï¼Œå†…å®¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ csrfcookie&#x3D;v8g9e4ksfhw ï¼‰ã€‚</li><li>åœ¨å‰ç«¯å‘åç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œå–å‡º Cookieï¼Œå¹¶æ·»åŠ åˆ° URL çš„å‚æ•°ä¸­ï¼ˆæ¥ä¸Šä¾‹ POST <a href="https://www.a.com/comment">https://www.a.com/comment</a>? csrfcookie&#x3D;v8g9e4ksfhw ï¼‰ã€‚</li><li>åç«¯æ¥â¼éªŒè¯ Cookie ä¸­çš„å­—æ®µä¸ URL å‚æ•°ä¸­çš„å­—æ®µæ˜¯å¦â¼€è‡´ï¼Œä¸â¼€è‡´åˆ™æ‹’ç»ã€‚</li></ul><h3 id="Samesite-Cookie-å±æ€§"><a href="#Samesite-Cookie-å±æ€§" class="headerlink" title="Samesite Cookie å±æ€§"></a>Samesite Cookie å±æ€§</h3><p>Google èµ·è‰äº†â¼€ä»½è‰æ¡ˆæ¥æ”¹è¿› HTTP åè®®ï¼Œé‚£å°±æ˜¯ä¸º Set-Cookie å“åº”å¤´æ–°å¢ Samesite å±æ€§ï¼Œå®ƒâ½¤æ¥æ ‡æ˜è¿™ä¸ª Cookie æ˜¯ ä¸ªâ€œåŒç«™ Cookieâ€ï¼ŒåŒç«™ Cookie åªèƒ½ä½œä¸ºç¬¬â¼€â½… Cookieï¼Œä¸èƒ½ä½œä¸ºç¬¬ä¸‰â½… Cookieï¼ŒSamesite æœ‰ä¸¤ä¸ªå±æ€§å€¼:</p><ul><li>Samesite&#x3D;Strict: è¿™ç§ç§°ä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œè¡¨æ˜è¿™ä¸ª Cookie åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å¯èƒ½ä½œä¸ºç¬¬ä¸‰â½… Cookie</li><li>Samesite&#x3D;Lax: è¿™ç§ç§°ä¸ºå®½æ¾æ¨¡å¼ï¼Œâ½ Strict æ”¾å®½äº†ç‚¹é™åˆ¶,å‡å¦‚è¿™ä¸ªè¯·æ±‚æ˜¯è¿™ç§è¯·æ±‚ä¸”åŒæ—¶æ˜¯ä¸ª GET è¯·æ±‚ï¼Œåˆ™è¿™ä¸ª Cookie å¯ä»¥ä½œä¸ºç¬¬ä¸‰â½… Cookie</li></ul><h2 id="â½¹ç»œåŠ«æŒ"><a href="#â½¹ç»œåŠ«æŒ" class="headerlink" title="â½¹ç»œåŠ«æŒ"></a>â½¹ç»œåŠ«æŒ</h2><p>â½¹ç»œåŠ«æŒâ¼€èˆ¬åˆ†ä¸ºä¸¤ç§:</p><ul><li><code>DNS åŠ«æŒ</code>: (è¾“â¼Šäº¬ä¸œè¢«å¼ºåˆ¶è·³è½¬åˆ°æ·˜å®è¿™å°±å±äº dns åŠ«æŒ) DNS å¼ºåˆ¶è§£æ: é€šè¿‡ä¿®æ”¹è¿è¥å•†çš„æœ¬åœ° DNS è®°å½•ï¼Œæ¥å¼•å¯¼â½¤æˆ·æµé‡åˆ°ç¼“å­˜æœåŠ¡å™¨</li><li><code>302 è·³è½¬çš„â½…å¼</code>: é€šè¿‡ç›‘æ§â½¹ç»œå‡ºâ¼çš„æµé‡ï¼Œåˆ†æåˆ¤æ–­å“ªäº›å†…å®¹æ˜¯å¯ä»¥è¿›â¾åŠ«æŒå¤„ç†çš„,å†å¯¹åŠ«æŒçš„å†…å­˜å‘èµ· 302 è·³è½¬çš„å›å¤ï¼Œå¼•å¯¼â½¤æˆ·è·å–å†…å®¹</li><li><code>HTTP åŠ«æŒ</code>: (è®¿é—®â¾•æ­Œä½†æ˜¯â¼€ç›´æœ‰è´ªç©è“â½‰çš„â¼´å‘Š),ç”±äº http æ˜â½‚ä¼ è¾“,è¿è¥å•†ä¼šä¿®æ”¹ä½ çš„ http å“åº”å†…å®¹(å³åŠ â¼´å‘Š)</li></ul><h2 id="å¦‚ä½•åº”å¯¹â½¹ç»œåŠ«æŒ"><a href="#å¦‚ä½•åº”å¯¹â½¹ç»œåŠ«æŒ" class="headerlink" title="å¦‚ä½•åº”å¯¹â½¹ç»œåŠ«æŒ?"></a>å¦‚ä½•åº”å¯¹â½¹ç»œåŠ«æŒ?</h2><ul><li>DNS åŠ«æŒç”±äºæ¶‰å«Œè¿æ³•,å·²ç»è¢«ç›‘ç®¡èµ·æ¥,ç°åœ¨å¾ˆå°‘ä¼šæœ‰ DNS åŠ«æŒ,â½½ http åŠ«æŒä¾ç„¶â¾®å¸¸ç››â¾.</li><li>æœ€æœ‰æ•ˆçš„åŠæ³•å°±æ˜¯å…¨ç«™ HTTPS,å°† HTTP åŠ å¯†,è¿™ä½¿å¾—è¿è¥å•†â½†æ³•è·å–æ˜â½‚,å°±â½†æ³•åŠ«æŒä½ çš„å“åº”å†…å®¹.</li></ul><h2 id="ä¸­é—´â¼ˆæ”»å‡»"><a href="#ä¸­é—´â¼ˆæ”»å‡»" class="headerlink" title="ä¸­é—´â¼ˆæ”»å‡»"></a>ä¸­é—´â¼ˆæ”»å‡»</h2><p>ä¸­é—´â¼ˆ (Man-in-the-middle attack, MITM) æ˜¯æŒ‡<code>æ”»å‡»è€…ä¸é€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«åˆ›å»ºç‹¬â½´çš„è”ç³», å¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®, ä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡â¼€ä¸ªç§å¯†çš„è¿æ¥ä¸å¯¹â½…ç›´æ¥å¯¹è¯</code>, ä½†äº‹å®ä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æ§åˆ¶. åœ¨ä¸­é—´â¼ˆæ”»å‡»ä¸­, æ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒâ½…çš„é€šè¯å¹¶æ’â¼Šæ–°çš„å†…å®¹.</p><p>â¼€èˆ¬çš„è¿‡ç¨‹å¦‚ä¸‹:</p><ul><li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼Œè¯·æ±‚è¢«ä¸­é—´â¼ˆæˆªè·æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€å…¬é’¥ä¸­é—´â¼ˆæˆªè·å…¬é’¥ï¼Œä¿ç•™åœ¨â¾ƒâ¼°â¼¿ä¸Šã€‚</li><li>ç„¶åâ¾ƒâ¼°â½£æˆâ¼€ä¸ª<code>ã€ä¼ªé€ çš„ã€‘å…¬é’¥</code>ï¼Œå‘ç»™å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯æ”¶åˆ°ä¼ªé€ çš„å…¬é’¥åï¼Œâ½£æˆåŠ å¯† hash å€¼å‘ç»™æœåŠ¡å™¨</li><li>ä¸­é—´â¼ˆè·å¾—åŠ å¯† hash å€¼ï¼Œâ½¤â¾ƒâ¼°çš„ç§é’¥è§£å¯†è·å¾—çœŸç§˜é’¥,åŒæ—¶â½£æˆå‡çš„åŠ å¯† hash å€¼ï¼Œå‘ç»™æœåŠ¡å™¨</li><li>æœåŠ¡å™¨â½¤ç§é’¥è§£å¯†è·å¾—å‡å¯†é’¥,ç„¶ååŠ å¯†æ•°æ®ä¼ è¾“ç»™å®¢æˆ·ç«¯</li></ul><h2 id="é‡æ”¾æ”»å‡»"><a href="#é‡æ”¾æ”»å‡»" class="headerlink" title="é‡æ”¾æ”»å‡»"></a>é‡æ”¾æ”»å‡»</h2><p><a href="https://zh.wikipedia.org/zh-cn/%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB" target="_blank" >é‡æ”¾æ”»å‡»- ä¸­é—´äººæ”»å‡»çš„ä¸€ç§</a></p><h2 id="DDoS-æ”»å‡»"><a href="#DDoS-æ”»å‡»" class="headerlink" title="DDoS æ”»å‡»"></a>DDoS æ”»å‡»</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><code>DDos</code>å…¨å<code>Distributed Denial of Service</code>ï¼Œç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯<code>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡</code>ã€‚æŒ‡çš„æ˜¯å¤„äºä¸åŒä½ç½®çš„å¤šä¸ªæ”»å‡»è€…åŒæ—¶å‘ä¸€ä¸ªæˆ–æ•°ä¸ªç›®æ ‡å‘åŠ¨æ”»å‡»ï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒçš„ã€ååŒçš„å¤§è§„æ¨¡æ”»å‡»æ–¹å¼ã€‚å•ä¸€çš„ DoS æ”»å‡»ä¸€èˆ¬æ˜¯é‡‡ç”¨ä¸€å¯¹ä¸€æ–¹å¼çš„ï¼Œå®ƒåˆ©ç”¨ç½‘ç»œåè®®å’Œæ“ä½œç³»ç»Ÿçš„ä¸€äº›ç¼ºé™·ï¼Œé‡‡ç”¨æ¬ºéª—å’Œä¼ªè£…çš„ç­–ç•¥æ¥è¿›è¡Œç½‘ç»œæ”»å‡»ï¼Œä½¿ç½‘ç«™æœåŠ¡å™¨å……æ–¥å¤§é‡è¦æ±‚å›å¤çš„ä¿¡æ¯ï¼Œæ¶ˆè€—ç½‘ç»œå¸¦å®½æˆ–ç³»ç»Ÿèµ„æºï¼Œå¯¼è‡´ç½‘ç»œæˆ–ç³»ç»Ÿä¸èƒœè´Ÿè·ä»¥è‡³äºç˜«ç—ªè€Œåœæ­¢æä¾›æ­£å¸¸çš„ç½‘ç»œæœåŠ¡ã€‚</p></blockquote><p>æ”»å‡»æ–¹å¼å¾ˆå¤šï¼Œæ¯”å¦‚<code>UDP Flood</code>ã€<code>SYN Flood</code>ã€<code>DNS Query Flood</code>ç­‰ç­‰ã€‚</p><p><strong>ä¸‹é¢æ˜¯ SYN Flood è¿›è¡Œ DDoS æ”»å‡»çš„å®ç°åŸç†</strong></p><p>SYN Flood æ˜¯ä¸€ç§åˆ©ç”¨ TCP åè®®ç¼ºé™·ï¼Œå‘é€å¤§é‡ä¼ªé€ çš„ TCP è¿æ¥è¯·æ±‚ï¼Œä»è€Œä½¿å¾—è¢«æ”»å‡»æ–¹èµ„æºè€—å°½ï¼ˆCPU æ»¡è´Ÿè·æˆ–å†…å­˜ä¸è¶³ï¼‰çš„æ”»å‡»æ–¹å¼ã€‚</p><p>ä¸€æ¬¡æ­£å¸¸çš„å»ºç«‹ TCP è¿æ¥ï¼Œéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ SYN æŠ¥æ–‡ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚å¹¶è¿”å›æŠ¥æ–‡è¡¨ç¤ºæ¥å—ï¼Œå®¢æˆ·ç«¯ä¹Ÿè¿”å›ç¡®è®¤ï¼Œå®Œæˆè¿æ¥ã€‚</p><p>SYN Flood å°±æ˜¯ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€æŠ¥æ–‡åçªç„¶æ­»æœºæˆ–æ‰çº¿ï¼Œé‚£ä¹ˆæœåŠ¡å™¨åœ¨å‘å‡ºåº”ç­”æŠ¥æ–‡åå°±æ— æ³•æ”¶åˆ°å®¢æˆ·ç«¯çš„ç¡®è®¤æŠ¥æ–‡ï¼ˆç¬¬ä¸‰æ¬¡æ¡æ‰‹æ— æ³•å®Œæˆï¼‰ï¼Œè¿™æ—¶æœåŠ¡å™¨ç«¯ä¸€èˆ¬ä¼šé‡è¯•å¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´åå†ä¸¢å¼ƒè¿™ä¸ªæœªå®Œæˆçš„è¿æ¥ã€‚</p><p><code>ä¸€ä¸ªç”¨æˆ·å‡ºç°å¼‚å¸¸å¯¼è‡´æœåŠ¡å™¨çš„ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ä¸€ä¼šå„¿å¹¶ä¸æ˜¯å¤§é—®é¢˜</code>ï¼Œä½†æ¶æ„æ”»å‡»è€…å¤§é‡æ¨¡æ‹Ÿè¿™ç§æƒ…å†µï¼ŒæœåŠ¡å™¨ç«¯ä¸ºäº†ç»´æŠ¤æ•°ä»¥ä¸‡è®¡çš„åŠè¿æ¥è€Œæ¶ˆè€—éå¸¸å¤šçš„èµ„æºï¼Œç»“æœå¾€å¾€æ˜¯æ— æš‡ç†ç¬å®¢æˆ·çš„æ­£å¸¸è¯·æ±‚ï¼Œç”šè‡³å´©æºƒã€‚ä»æ­£å¸¸å®¢æˆ·çš„è§’åº¦çœ‹æ¥ï¼Œç½‘ç«™å¤±å»äº†å“åº”ï¼Œæ— æ³•è®¿é—®ã€‚</p><h3 id="é«˜é˜²æœåŠ¡å™¨"><a href="#é«˜é˜²æœåŠ¡å™¨" class="headerlink" title="é«˜é˜²æœåŠ¡å™¨"></a>é«˜é˜²æœåŠ¡å™¨</h3><p>è¿˜æ˜¯æ‹¿å¼€çš„é‡åº†ç«é”…åº—ä¸¾ä¾‹ï¼Œé«˜é˜²æœåŠ¡å™¨å°±æ˜¯æˆ‘ç»™é‡åº†ç«é”…åº—å¢åŠ äº†ä¸¤åä¿å®‰ï¼Œè¿™ä¸¤åä¿å®‰å¯ä»¥è®©ä¿æŠ¤åº—é“ºä¸å—æµæ°“éªšæ‰°ï¼Œå¹¶ä¸”è¿˜ä¼šå®šæœŸåœ¨åº—é“ºå‘¨å›´å·¡é€»é˜²æ­¢æµæ°“éªšæ‰°ã€‚</p><p>é«˜é˜²æœåŠ¡å™¨ä¸»è¦æ˜¯æŒ‡èƒ½ç‹¬ç«‹ç¡¬é˜²å¾¡ 50Gbps ä»¥ä¸Šçš„æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿå¸®åŠ©ç½‘ç«™æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå®šæœŸæ‰«æç½‘ç»œä¸»èŠ‚ç‚¹ç­‰ï¼Œè¿™ä¸œè¥¿æ˜¯ä¸é”™ï¼Œå°±æ˜¯è´µ~</p><h3 id="é»‘åå•"><a href="#é»‘åå•" class="headerlink" title="é»‘åå•"></a>é»‘åå•</h3><p>é¢å¯¹ç«é”…åº—é‡Œé¢çš„æµæ°“ï¼Œæˆ‘ä¸€æ€’ä¹‹ä¸‹å°†ä»–ä»¬æ‹ç…§å…¥æ¡£ï¼Œå¹¶ç¦æ­¢ä»–ä»¬è¸å…¥åº—é“ºï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™é‡åˆ°é•¿å¾—åƒçš„äººä¹Ÿä¼šç¦æ­¢ä»–è¿›å…¥åº—é“ºã€‚è¿™ä¸ªå°±æ˜¯è®¾ç½®é»‘åå•ï¼Œæ­¤æ–¹æ³•ç§‰æ‰¿çš„å°±æ˜¯â€œé”™æ€ä¸€åƒï¼Œä¹Ÿä¸æ”¾ä¸€ç™¾â€çš„åŸåˆ™ï¼Œä¼šå°é”æ­£å¸¸æµé‡ï¼Œå½±å“åˆ°æ­£å¸¸ä¸šåŠ¡ã€‚</p><h3 id="DDoS-æ¸…æ´—"><a href="#DDoS-æ¸…æ´—" class="headerlink" title="DDoS æ¸…æ´—"></a>DDoS æ¸…æ´—</h3><p>DDos æ¸…æ´—ï¼Œå°±æ˜¯æˆ‘å‘ç°å®¢äººè¿›åº—å‡ åˆ†é’Ÿä»¥åï¼Œä½†æ˜¯ä¸€ç›´ä¸ç‚¹é¤ï¼Œæˆ‘å°±æŠŠä»–è¸¢å‡ºåº—é‡Œã€‚</p><p>DDoS æ¸…æ´—ä¼šå¯¹ç”¨æˆ·è¯·æ±‚æ•°æ®è¿›è¡Œå®æ—¶ç›‘æ§ï¼ŒåŠæ—¶å‘ç° DOS æ”»å‡»ç­‰å¼‚å¸¸æµé‡ï¼Œåœ¨ä¸å½±å“æ­£å¸¸ä¸šåŠ¡å¼€å±•çš„æƒ…å†µä¸‹æ¸…æ´—æ‰è¿™äº›å¼‚å¸¸æµé‡ã€‚</p><h3 id="CDN-åŠ é€Ÿ"><a href="#CDN-åŠ é€Ÿ" class="headerlink" title="CDN åŠ é€Ÿ"></a>CDN åŠ é€Ÿ</h3><p>CDN åŠ é€Ÿï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç†è§£ï¼šä¸ºäº†å‡å°‘æµæ°“éªšæ‰°ï¼Œæˆ‘å¹²è„†å°†ç«é”…åº—å¼€åˆ°äº†çº¿ä¸Šï¼Œæ‰¿æ¥å¤–å–æœåŠ¡ï¼Œè¿™æ ·æµæ°“æ‰¾ä¸åˆ°åº—åœ¨å“ªé‡Œï¼Œä¹Ÿè€ä¸æ¥æµæ°“äº†ã€‚</p><p>åœ¨ç°å®ä¸­ï¼ŒCDN æœåŠ¡å°†ç½‘ç«™è®¿é—®æµé‡åˆ†é…åˆ°äº†å„ä¸ªèŠ‚ç‚¹ä¸­ï¼Œè¿™æ ·ä¸€æ–¹é¢éšè—ç½‘ç«™çš„çœŸå® IPï¼Œå¦ä¸€æ–¹é¢å³ä½¿é­é‡ DDoS æ”»å‡»ï¼Œä¹Ÿå¯ä»¥å°†æµé‡åˆ†æ•£åˆ°å„ä¸ªèŠ‚ç‚¹ä¸­ï¼Œé˜²æ­¢æºç«™å´©æºƒã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/weixin_38405253/article/details/114297755" target="_blank" >DDoS æ”»å‡»åŸç†</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-webpackç³»åˆ—</title>
      <link href="//post/2022-07-14webpack.html"/>
      <url>//post/2022-07-14webpack.html</url>
      
        <content type="html"><![CDATA[<h2 id="webpack-ä¸-gruntã€gulp-çš„ä¸åŒï¼Ÿ"><a href="#webpack-ä¸-gruntã€gulp-çš„ä¸åŒï¼Ÿ" class="headerlink" title="webpack ä¸ gruntã€gulp çš„ä¸åŒï¼Ÿ"></a>webpack ä¸ gruntã€gulp çš„ä¸åŒï¼Ÿ</h2><ul><li><p><code>Gruntã€Gulp</code> æ˜¯åŸºäºä»»åŠ¡è¿â¾çš„â¼¯å…·ï¼š å®ƒä»¬ä¼šâ¾ƒåŠ¨æ‰§â¾æŒ‡å®šçš„ä»»åŠ¡ï¼Œå°±åƒæµâ½”çº¿ï¼ŒæŠŠèµ„æºæ”¾ä¸Šå»ç„¶åé€šè¿‡ä¸åŒæ’ä»¶è¿›â¾åŠ â¼¯ï¼Œå®ƒä»¬åŒ…å«æ´»è·ƒçš„ç¤¾åŒºï¼Œä¸°å¯Œçš„æ’ ä»¶ï¼Œèƒ½â½…ä¾¿çš„æ‰“é€ å„ç§â¼¯ä½œæµã€‚</p></li><li><p><code>Webpack</code> æ˜¯åŸºäºæ¨¡å—åŒ–æ‰“åŒ…çš„â¼¯å…·: â¾ƒåŠ¨åŒ–å¤„ç†æ¨¡å—,webpack æŠŠâ¼€åˆ‡å½“æˆæ¨¡å—ï¼Œå½“ webpack å¤„ç†åº”â½¤ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æ„å»ºâ¼€ä¸ªä¾èµ–å…³ç³»å›¾ (dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”â½¤ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆâ¼€ä¸ªæˆ–å¤šä¸ª bundleã€‚ å› æ­¤è¿™æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ç±»â¼¯å…·,â½½ç°åœ¨ä¸»æµçš„â½…å¼æ˜¯â½¤ npm script ä»£æ›¿ Gruntã€Gulp,npm script åŒæ ·å¯ä»¥æ‰“é€ ä»»åŠ¡æµ</p></li></ul><h2 id="webpackã€rollupã€parcelã€vite-ä¼˜åŠ£ï¼Ÿ"><a href="#webpackã€rollupã€parcelã€vite-ä¼˜åŠ£ï¼Ÿ" class="headerlink" title="webpackã€rollupã€parcelã€vite ä¼˜åŠ£ï¼Ÿ"></a>webpackã€rollupã€parcelã€vite ä¼˜åŠ£ï¼Ÿ</h2><ul><li>webpack é€‚â½¤äºâ¼¤å‹å¤æ‚çš„å‰ç«¯ç«™ç‚¹æ„å»º: webpack æœ‰å¼ºâ¼¤çš„ loader å’Œæ’ä»¶â½£æ€,æ‰“åŒ…åçš„â½‚ä»¶å®é™…ä¸Šå°±æ˜¯â¼€ä¸ªâ½´å³ æ‰§â¾å‡½æ•°ï¼Œè¿™ä¸ªâ½´å³æ‰§â¾å‡½æ•°æ¥æ”¶â¼€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯æ¨¡å—å¯¹è±¡ï¼Œé”®ä¸ºå„ä¸ªæ¨¡å—çš„è·¯å¾„ï¼Œå€¼ä¸ºæ¨¡å—å†…å®¹ã€‚â½´å³æ‰§ â¾å‡½æ•°å†…éƒ¨åˆ™å¤„ç†æ¨¡å—ä¹‹é—´çš„å¼•â½¤ï¼Œæ‰§â¾æ¨¡å—ç­‰,è¿™ç§æƒ…å†µæ›´é€‚åˆâ½‚ä»¶ä¾èµ–å¤æ‚çš„åº”â½¤å¼€å‘.</li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>webpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚</p></blockquote><ul><li>Rollup</li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æ˜¯ä¸€ä¸ª JavaScript æ¨¡å—æ‰“åŒ…å™¨ï¼Œå¯ä»¥å°†å°å—ä»£ç ç¼–è¯‘æˆå¤§å—å¤æ‚çš„ä»£ç ï¼Œä¾‹å¦‚ library æˆ–åº”ç”¨ç¨‹åºã€‚Rollup å¯¹ä»£ç æ¨¡å—ä½¿ç”¨æ–°çš„æ ‡å‡†åŒ–æ ¼å¼ï¼Œè¿™äº›æ ‡å‡†éƒ½åŒ…å«åœ¨ JavaScript çš„ ES6 ç‰ˆæœ¬ä¸­ï¼Œè€Œä¸æ˜¯ä»¥å‰çš„ç‰¹æ®Šè§£å†³æ–¹æ¡ˆï¼Œå¦‚ CommonJS å’Œ AMDã€‚ES6 æ¨¡å—å¯ä»¥ä½¿ä½ è‡ªç”±ã€æ— ç¼åœ°ä½¿ç”¨ä½ æœ€å–œçˆ±çš„ library ä¸­é‚£äº›æœ€æœ‰ç”¨ç‹¬ç«‹å‡½æ•°ï¼Œè€Œä½ çš„é¡¹ç›®ä¸å¿…æºå¸¦å…¶ä»–æœªä½¿ç”¨çš„ä»£ç ã€‚ES6 æ¨¡å—æœ€ç»ˆè¿˜æ˜¯è¦ç”±æµè§ˆå™¨åŸç”Ÿå®ç°ï¼Œä½†å½“å‰ Rollup å¯ä»¥ä½¿ä½ æå‰ä½“éªŒã€‚</p></blockquote><ul><li>parcel æé€Ÿé›¶é…ç½® Web åº”ç”¨æ‰“åŒ…å·¥å…·</li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ğŸš€ <code>æé€Ÿæ‰“åŒ…</code>: Parcel ä½¿ç”¨ worker è¿›ç¨‹å»å¯ç”¨å¤šæ ¸ç¼–è¯‘ã€‚åŒæ—¶æœ‰æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼Œå³ä½¿åœ¨é‡å¯æ„å»ºåä¹Ÿèƒ½å¿«é€Ÿå†ç¼–è¯‘ã€‚<br>ğŸ“¦ <code>å°†ä½ æ‰€æœ‰çš„èµ„æºæ‰“åŒ…</code>: Parcel å…·å¤‡å¼€ç®±å³ç”¨çš„å¯¹ JS, CSS, HTML, æ–‡ä»¶ åŠæ›´å¤šçš„æ”¯æŒï¼Œè€Œä¸”ä¸éœ€è¦æ’ä»¶ã€‚<br>ğŸ  <code>è‡ªåŠ¨è½¬æ¢</code>: å¦‚è‹¥æœ‰éœ€è¦ï¼ŒBabel, PostCSS, å’Œ PostHTML ç”šè‡³ node_modules åŒ…ä¼šè¢«ç”¨äºè‡ªåŠ¨è½¬æ¢ä»£ç .<br>âœ‚ï¸ <code>é›¶é…ç½®ä»£ç åˆ†æ‹†</code>: ä½¿ç”¨åŠ¨æ€ import() è¯­æ³•, Parcel å°†ä½ çš„è¾“å‡ºæ–‡ä»¶æŸ(bundles)åˆ†æ‹†ï¼Œå› æ­¤ä½ åªéœ€è¦åœ¨åˆæ¬¡åŠ è½½æ—¶åŠ è½½ä½ æ‰€éœ€è¦çš„ä»£ç ã€‚<br>ğŸ”¥ <code>çƒ­æ¨¡å—æ›¿æ¢</code>: Parcel æ— éœ€é…ç½®ï¼Œåœ¨å¼€å‘ç¯å¢ƒçš„æ—¶å€™ä¼šè‡ªåŠ¨åœ¨æµè§ˆå™¨å†…éšç€ä½ çš„ä»£ç æ›´æ”¹è€Œå»æ›´æ–°æ¨¡å—ã€‚<br>ğŸš¨ <code>å‹å¥½çš„é”™è¯¯æ—¥å¿—</code>:å½“é‡åˆ°é”™è¯¯æ—¶ï¼ŒParcel ä¼šè¾“å‡º è¯­æ³•é«˜äº®çš„ä»£ç ç‰‡æ®µï¼Œå¸®åŠ©ä½ å®šä½é—®é¢˜ã€‚</p></blockquote><ul><li>vite ä¸‹ä¸€ä»£å‰ç«¯å¼€å‘ä¸æ„å»ºå·¥å…·</li></ul><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ğŸ“¦ <code>æé€Ÿçš„æœåŠ¡å¯åŠ¨</code>: ä½¿ç”¨åŸç”Ÿ ESM æ–‡ä»¶ï¼Œæ— éœ€æ‰“åŒ…!<br>âš¡ï¸ <code>è½»é‡å¿«é€Ÿçš„çƒ­é‡è½½</code>: æ— è®ºåº”ç”¨ç¨‹åºå¤§å°å¦‚ä½•ï¼Œéƒ½å§‹ç»ˆæå¿«çš„æ¨¡å—çƒ­é‡è½½ï¼ˆHMRï¼‰<br>ğŸ› ï¸ <code>ä¸°å¯Œçš„åŠŸèƒ½</code>: å¯¹ TypeScriptã€JSXã€CSS ç­‰æ”¯æŒå¼€ç®±å³ç”¨ã€‚<br>ğŸ“¦ <code>ä¼˜åŒ–çš„æ„å»º</code>: å¯é€‰ â€œå¤šé¡µåº”ç”¨â€ æˆ– â€œåº“â€ æ¨¡å¼çš„é¢„é…ç½® Rollup æ„å»º<br>ğŸ”© <code>é€šç”¨çš„æ’ä»¶</code>: åœ¨å¼€å‘å’Œæ„å»ºä¹‹é—´å…±äº« Rollup-superset æ’ä»¶æ¥å£ã€‚<br>ğŸ”‘ <code>å®Œå…¨ç±»å‹åŒ–çš„ API</code>: çµæ´»çš„ API å’Œå®Œæ•´ TypeScript ç±»å‹ã€‚</p></blockquote><h2 id="æœ‰å“ªäº›å¸¸â»…çš„-Loaderï¼Ÿ"><a href="#æœ‰å“ªäº›å¸¸â»…çš„-Loaderï¼Ÿ" class="headerlink" title="æœ‰å“ªäº›å¸¸â»…çš„ Loaderï¼Ÿ"></a>æœ‰å“ªäº›å¸¸â»…çš„ Loaderï¼Ÿ</h2><p><a href="https://www.webpackjs.com/loaders/url-loader/" target="_blank" >æ›´å¤š</a></p><p><strong>æ–‡ä»¶ç›¸å…³çš„</strong></p><!-- - `raw-loader`ï¼šåŠ è½½æ–‡ä»¶åŸå§‹å†…å®¹ï¼ˆutf-8ï¼‰ --><ul><li><code>file-loader</code>ï¼šæŠŠæ–‡ä»¶è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨ä»£ç ä¸­é€šè¿‡ç›¸å¯¹ URL å»å¼•ç”¨è¾“å‡ºçš„æ–‡ä»¶ (å¤„ç†å›¾ç‰‡å’Œå­—ä½“)</li><li><code>url-loader</code>ï¼šä¸ file-loader ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯ç”¨æˆ·å¯ä»¥è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œå¤§äºé˜ˆå€¼ä¼šäº¤ç»™ file-loader å¤„ç†ï¼Œå°äºé˜ˆå€¼æ—¶è¿”å›æ–‡ä»¶ base64 å½¢å¼ç¼–ç  (å¤„ç†å›¾ç‰‡å’Œå­—ä½“)</li><li><code>source-map-loader</code>ï¼šåŠ è½½é¢å¤–çš„ Source Map æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿æ–­ç‚¹è°ƒè¯•</li><li><code>svg-inline-loader</code>ï¼šå°†å‹ç¼©åçš„ SVG å†…å®¹æ³¨å…¥ä»£ç ä¸­</li><li><code>image-loader</code>ï¼šåŠ è½½å¹¶ä¸”å‹ç¼©å›¾ç‰‡æ–‡ä»¶</li><li><code>json-loader</code> åŠ è½½ JSON æ–‡ä»¶ï¼ˆé»˜è®¤åŒ…å«ï¼‰</li><li><code>handlebars-loader</code>: å°† Handlebars æ¨¡ç‰ˆç¼–è¯‘æˆå‡½æ•°å¹¶è¿”å›</li></ul><p><strong>è„šæœ¬ç›¸å…³çš„</strong></p><ul><li><code>babel-loader</code>ï¼šæŠŠ ES6 è½¬æ¢æˆ ES5</li><li><code>ts-loader</code>: å°† TypeScript è½¬æ¢æˆ JavaScript</li><li><code>awesome-typescript-loader</code>ï¼šå°† TypeScript è½¬æ¢æˆ JavaScriptï¼Œæ€§èƒ½ä¼˜äº ts-loader</li></ul><p><strong>æ ·å¼ç›¸å…³çš„</strong></p><ul><li><code>sass-loader</code>ï¼šå°† SCSS&#x2F;SASS ä»£ç è½¬æ¢æˆ CSS</li><li><code>css-loader</code>ï¼šåŠ è½½ CSSï¼Œæ”¯æŒæ¨¡å—åŒ–ã€å‹ç¼©ã€æ–‡ä»¶å¯¼å…¥ç­‰ç‰¹æ€§</li><li><code>style-loader</code>ï¼šæŠŠ CSS ä»£ç æ³¨å…¥åˆ° JavaScript ä¸­ï¼Œé€šè¿‡ DOM æ“ä½œå»åŠ è½½ CSS</li><li><code>postcss-loader</code>ï¼šæ‰©å±• CSS è¯­æ³•ï¼Œä½¿ç”¨ä¸‹ä¸€ä»£ CSSï¼Œå¯ä»¥é…åˆ autoprefixer æ’ä»¶è‡ªåŠ¨è¡¥é½ CSS3 å‰ç¼€</li></ul><p><strong>æ ¡éªŒç›¸å…³çš„</strong></p><ul><li><code>eslint-loader</code>ï¼šé€šè¿‡ ESLint æ£€æŸ¥ JavaScript ä»£ç </li><li><code>tslint-loader</code>ï¼šé€šè¿‡ TSLint æ£€æŸ¥ TypeScript ä»£ç </li></ul><p><strong>æµ‹è¯•ç›¸å…³çš„</strong></p><ul><li><code>mocha-loader</code>ï¼šåŠ è½½ Mocha æµ‹è¯•ç”¨ä¾‹çš„ä»£ç </li><li><code>coverjs-loader</code>ï¼šè®¡ç®—æµ‹è¯•çš„è¦†ç›–ç‡</li></ul><p><strong>æ¡†æ¶ç›¸å…³çš„</strong></p><ul><li><code>vue-loader</code>ï¼šåŠ è½½ Vue.js å•æ–‡ä»¶ç»„ä»¶</li></ul><p><strong>è¯­è¨€ç›¸å…³çš„</strong></p><ul><li><code>i18n-loader</code>: å›½é™…åŒ–</li></ul><p><strong>æ€§èƒ½ç›¸å…³çš„</strong></p><ul><li><code>cache-loader</code>: å¯ä»¥åœ¨ä¸€äº›æ€§èƒ½å¼€é”€è¾ƒå¤§çš„ Loader ä¹‹å‰æ·»åŠ ï¼Œç›®çš„æ˜¯å°†ç»“æœç¼“å­˜åˆ°ç£ç›˜é‡Œ</li></ul><p><a href="https://webpack.docschina.org/loaders/cache-loader/#getting-started" target="_blank" >è§ webpack cache-loader</a></p><h2 id="æœ‰å“ªäº›å¸¸â»…çš„-Pluginï¼Ÿ"><a href="#æœ‰å“ªäº›å¸¸â»…çš„-Pluginï¼Ÿ" class="headerlink" title="æœ‰å“ªäº›å¸¸â»…çš„ Pluginï¼Ÿ"></a>æœ‰å“ªäº›å¸¸â»…çš„ Pluginï¼Ÿ</h2><p><strong>åŸºæœ¬</strong></p><ul><li><code>define-plugin</code>ï¼šå®šä¹‰ç¯å¢ƒå˜é‡ (Webpack4 ä¹‹åæŒ‡å®š mode ä¼šè‡ªåŠ¨é…ç½®)</li><li><code>html-webpack-plugin</code>ï¼šç®€åŒ– HTML æ–‡ä»¶åˆ›å»º (ä¾èµ–äº html-loader)</li><li><code>web-webpack-plugin</code>ï¼šå¯æ–¹ä¾¿åœ°ä¸ºå•é¡µåº”ç”¨è¾“å‡º HTMLï¼Œæ¯” html-webpack-plugin å¥½ç”¨</li><li><code>clean-webpack-plugin</code>: ç›®å½•æ¸…ç†</li></ul><p><strong>ç¼–è¯‘èŒƒå›´ä¼˜åŒ–ç›¸å…³</strong></p><ul><li><code>ignore-plugin</code>ï¼šå¿½ç•¥éƒ¨åˆ†æ–‡ä»¶</li></ul><p><strong>å‹ç¼©ä¼˜åŒ–ç›¸å…³</strong></p><ul><li><code>uglifyjs-webpack-plugin</code>ï¼šä¸æ”¯æŒ ES6 å‹ç¼© (Webpack4 ä»¥å‰)</li><li><code>terser-webpack-plugin</code>: æ”¯æŒå‹ç¼© ES6 (Webpack4)</li><li><code>webpack-parallel-uglify-plugin</code>: å¤šè¿›ç¨‹æ‰§è¡Œä»£ç å‹ç¼©ï¼Œæå‡æ„å»ºé€Ÿåº¦</li></ul><p><strong>å…¶ä»–ä¼˜åŒ–ç›¸å…³</strong></p><ul><li><code>mini-css-extract-plugin</code>: åˆ†ç¦»æ ·å¼æ–‡ä»¶ï¼ŒCSS æå–ä¸ºç‹¬ç«‹æ–‡ä»¶ï¼Œæ”¯æŒæŒ‰éœ€åŠ è½½ (æ›¿ä»£ extract-text-webpack-plugin)</li><li><code>serviceworker-webpack-plugin</code>ï¼šä¸ºç½‘é¡µåº”ç”¨å¢åŠ ç¦»çº¿ç¼“å­˜åŠŸèƒ½</li><li><code>ModuleConcatenationPlugin</code>: å¼€å¯ Scope Hoisting</li></ul><p><strong>åˆ†æç›¸å…³</strong></p><ul><li><code>speed-measure-webpack-plugin</code>: å¯ä»¥çœ‹åˆ°æ¯ä¸ª Loader å’Œ Plugin æ‰§è¡Œè€—æ—¶ (æ•´ä¸ªæ‰“åŒ…è€—æ—¶ã€æ¯ä¸ª Plugin å’Œ Loader è€—æ—¶)</li><li><code>webpack-bundle-analyzer</code>: å¯è§†åŒ– Webpack è¾“å‡ºæ–‡ä»¶çš„ä½“ç§¯ (ä¸šåŠ¡ç»„ä»¶ã€ä¾èµ–ç¬¬ä¸‰æ–¹æ¨¡å—)</li></ul><h2 id="åˆ†åˆ«ä»‹ç»-bundleï¼Œchunkï¼Œmodule-æ˜¯ä»€ä¹ˆ"><a href="#åˆ†åˆ«ä»‹ç»-bundleï¼Œchunkï¼Œmodule-æ˜¯ä»€ä¹ˆ" class="headerlink" title="åˆ†åˆ«ä»‹ç» bundleï¼Œchunkï¼Œmodule æ˜¯ä»€ä¹ˆ"></a>åˆ†åˆ«ä»‹ç» bundleï¼Œchunkï¼Œmodule æ˜¯ä»€ä¹ˆ</h2><ul><li><code>bundle</code>ï¼šæ˜¯ç”± webpack æ‰“åŒ…å‡ºæ¥çš„â½‚ä»¶</li><li><code>chunk</code>ï¼šä»£ç å—ï¼Œâ¼€ä¸ª chunk ç”±å¤šä¸ªæ¨¡å—ç»„åˆâ½½æˆï¼Œâ½¤äºä»£ç çš„åˆå¹¶å’Œåˆ†å‰²</li><li><code>module</code>ï¼šæ˜¯å¼€å‘ä¸­çš„å•ä¸ªæ¨¡å—ï¼Œåœ¨ webpack çš„ä¸–ç•Œï¼Œâ¼€åˆ‡çš†æ¨¡å—ï¼Œâ¼€ä¸ªæ¨¡å—å¯¹åº”â¼€ä¸ªâ½‚ä»¶ï¼Œwebpack ä¼šä»é…ç½®çš„ entry ä¸­é€’å½’å¼€å§‹æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—</li></ul><h2 id="Loader-å’Œ-Plugin-çš„ä¸åŒï¼Ÿ"><a href="#Loader-å’Œ-Plugin-çš„ä¸åŒï¼Ÿ" class="headerlink" title="Loader å’Œ Plugin çš„ä¸åŒï¼Ÿ"></a>Loader å’Œ Plugin çš„ä¸åŒï¼Ÿ</h2><p><strong>ä½œç”¨</strong></p><ul><li><code>Loader</code> æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°ä¸­å¯¹æ¥æ”¶åˆ°çš„å†…å®¹è¿›è¡Œè½¬æ¢ï¼Œè¿”å›è½¬æ¢åçš„ç»“æœã€‚<br>å› ä¸º Webpack åªè®¤è¯† JavaScriptï¼Œæ‰€ä»¥ Loader å°±æˆäº†ç¿»è¯‘å®˜ï¼Œå¯¹å…¶ä»–ç±»å‹çš„èµ„æºè¿›è¡Œè½¬è¯‘çš„é¢„å¤„ç†å·¥ä½œã€‚</li><li><code>Plugin</code> å°±æ˜¯æ’ä»¶ï¼ŒåŸºäºäº‹ä»¶æµæ¡†æ¶ Tapableï¼Œæ’ä»¶å¯ä»¥æ‰©å±• Webpack çš„åŠŸèƒ½ï¼Œåœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚</li></ul><p><strong>ä½¿ç”¨</strong></p><ul><li><code>Loader</code> åœ¨ <code>module.rules</code> ä¸­é…ç½®ï¼Œä½œä¸ºæ¨¡å—çš„è§£æè§„åˆ™ï¼Œç±»å‹ä¸ºæ•°ç»„ã€‚<code>æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ª Object</code>ï¼Œå†…éƒ¨åŒ…å«äº† <code>test</code>(ç±»å‹æ–‡ä»¶)ã€<code>loader</code>ã€<code>options</code> (å‚æ•°)ç­‰å±æ€§ã€‚</li><li><code>Plugin</code> åœ¨ <code>plugins</code> ä¸­å•ç‹¬é…ç½®ï¼Œç±»å‹ä¸ºæ•°ç»„ï¼Œ<code>æ¯ä¸€é¡¹æ˜¯ä¸€ä¸ª Plugin çš„å®ä¾‹</code>ï¼Œå‚æ•°éƒ½é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ã€‚</li></ul><h2 id="webpack-çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ"><a href="#webpack-çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ" class="headerlink" title="webpack çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ?"></a>webpack çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ?</h2><p>Webpack çš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ª<code>ä¸²è¡Œçš„è¿‡ç¨‹</code>ï¼Œä»å¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š</p><ul><li><code>åˆå§‹åŒ–å‚æ•°</code>ï¼šä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°</li><li><code>å¼€å§‹ç¼–è¯‘</code>ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘</li><li><code>ç¡®å®šå…¥å£</code>ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶</li><li><code>ç¼–è¯‘æ¨¡å—</code>ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†</li><li><code>å®Œæˆæ¨¡å—ç¼–è¯‘</code>ï¼šåœ¨ç»è¿‡ç¬¬ 4 æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»</li><li><code>è¾“å‡ºèµ„æº</code>ï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼š</li><li><code>è¾“å‡ºå®Œæˆ</code>ï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿ</li></ul><p>åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼ŒWebpack <code>ä¼šåœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹å¹¿æ’­å‡ºç‰¹å®šçš„äº‹ä»¶</code>ï¼Œ<code>æ’ä»¶</code>åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ï¼Œå¹¶ä¸”<code>æ’ä»¶</code>å¯ä»¥è°ƒç”¨ Webpack æä¾›çš„ API æ”¹å˜ Webpack çš„è¿è¡Œç»“æœã€‚<br>ç®€å•è¯´</p><ul><li><code>åˆå§‹åŒ–</code>ï¼šå¯åŠ¨æ„å»ºï¼Œè¯»å–ä¸åˆå¹¶é…ç½®å‚æ•°ï¼ŒåŠ è½½ Pluginï¼Œå®ä¾‹åŒ– Compiler</li><li><code>ç¼–è¯‘</code>ï¼šä» Entry å‡ºå‘ï¼Œé’ˆå¯¹æ¯ä¸ª Module ä¸²è¡Œè°ƒç”¨å¯¹åº”çš„ Loader å»ç¿»è¯‘æ–‡ä»¶çš„å†…å®¹ï¼Œå†æ‰¾åˆ°è¯¥ Module ä¾èµ–çš„ Moduleï¼Œé€’å½’åœ°è¿›è¡Œç¼–è¯‘å¤„ç†</li><li><code>è¾“å‡º</code>ï¼šå°†ç¼–è¯‘åçš„ Module ç»„åˆæˆ Chunkï¼Œå°† Chunk è½¬æ¢æˆæ–‡ä»¶ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ç³»ç»Ÿä¸­</li></ul><h2 id="æè¿°ä¸‹ç¼–å†™-loader-çš„æ€è·¯"><a href="#æè¿°ä¸‹ç¼–å†™-loader-çš„æ€è·¯" class="headerlink" title="æè¿°ä¸‹ç¼–å†™ loader çš„æ€è·¯"></a>æè¿°ä¸‹ç¼–å†™ loader çš„æ€è·¯</h2><p>Loader åƒâ¼€ä¸ªâ€ç¿»è¯‘å®˜â€æŠŠè¯»åˆ°çš„æºâ½‚ä»¶å†…å®¹è½¬ä¹‰æˆæ–°çš„â½‚ä»¶å†…å®¹ï¼Œå¹¶ä¸”æ¯ä¸ª Loader é€šè¿‡é“¾å¼æ“ä½œï¼Œå°†æºâ½‚ä»¶â¼€æ­¥æ­¥ç¿»è¯‘ æˆæƒ³è¦çš„æ ·â¼¦ã€‚ ç¼–å†™ Loader æ—¶è¦éµå¾ªå•â¼€åŸåˆ™ï¼Œæ¯ä¸ª Loader åªåšâ¼€ç§â€è½¬ä¹‰â€â¼¯ä½œã€‚ æ¯ä¸ª Loader çš„æ‹¿åˆ°çš„æ˜¯æºâ½‚ä»¶å†…å®¹ï¼ˆ source ï¼‰ï¼Œå¯ ä»¥é€šè¿‡è¿”å›å€¼çš„â½…å¼å°†å¤„ç†åçš„å†…å®¹è¾“å‡ºï¼Œä¹Ÿå¯ä»¥è°ƒâ½¤ this.callback() â½…æ³•ï¼Œå°†å†…å®¹è¿”å›ç»™ webpackã€‚ è¿˜å¯ä»¥é€šè¿‡ this.async() â½£æˆâ¼€ä¸ª callback å‡½æ•°ï¼Œå†â½¤è¿™ä¸ª callback å°†å¤„ç†åçš„å†…å®¹è¾“å‡ºå‡ºå»ã€‚ æ­¤å¤– webpack è¿˜ä¸ºå¼€å‘è€…å‡†å¤‡äº† å¼€å‘ loader çš„â¼¯å…·å‡½æ•°é›†â€”â€” loader-utils ã€‚<br><strong>æ³¨æ„</strong></p><ul><li>Loader æ˜¯æ— çŠ¶æ€çš„ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åœ¨ Loader ä¸­ä¿ç•™çŠ¶æ€</li><li>ä½¿ç”¨ loader-utils å’Œ schema-utils ä¸ºæˆ‘ä»¬æä¾›çš„å®ç”¨å·¥å…·</li><li>åŠ è½½æœ¬åœ° Loader æ–¹æ³•<code>Npm link</code></li></ul><p><a href="https://www.webpackjs.com/contribute/writing-a-loader/" target="_blank" >ç¼–å†™ä¸€ä¸ª loader</a></p><p>loader æ˜¯å¯¼å‡ºä¸ºä¸€ä¸ªå‡½æ•°çš„ node æ¨¡å—ã€‚è¯¥å‡½æ•°åœ¨ loader è½¬æ¢èµ„æºçš„æ—¶å€™è°ƒç”¨ã€‚ç»™å®šçš„å‡½æ•°å°†è°ƒç”¨ loader APIï¼Œå¹¶é€šè¿‡ this ä¸Šä¸‹æ–‡è®¿é—®ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; getOptions &#125; from &quot;loader-utils&quot;;import validateOptions from &quot;schema-utils&quot;;const schema &#x3D; &#123;  type: &quot;object&quot;,  properties: &#123;    test: &#123;      type: &quot;string&quot;,    &#125;,  &#125;,&#125;;export default function (source) &#123;  const options &#x3D; getOptions(this);  validateOptions(schema, options, &quot;Example Loader&quot;);  &#x2F;&#x2F; å¯¹èµ„æºåº”ç”¨ä¸€äº›è½¬æ¢â€¦â€¦  return &#96;export default $&#123;JSON.stringify(source)&#125;&#96;;&#125;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123;  test: &#x2F;\.js$&#x2F;;  use: [    &#123;      loader: path.resolve(&quot;path&#x2F;to&#x2F;loader.js&quot;), &#x2F;&#x2F;ç›´æ¥ä½¿ç”¨æœ¬åœ°loader      options: &#123;        &#x2F;* ... *&#x2F;      &#125;,    &#125;,  ];&#125;</code></pre><h2 id="æè¿°ä¸‹ç¼–å†™-plugin-çš„æ€è·¯ï¼Ÿ"><a href="#æè¿°ä¸‹ç¼–å†™-plugin-çš„æ€è·¯ï¼Ÿ" class="headerlink" title="æè¿°ä¸‹ç¼–å†™ plugin çš„æ€è·¯ï¼Ÿ"></a>æè¿°ä¸‹ç¼–å†™ plugin çš„æ€è·¯ï¼Ÿ</h2><p>æ’ä»¶æ˜¯ webpack çš„æ”¯æŸ±åŠŸèƒ½ã€‚webpack è‡ªèº«ä¹Ÿæ˜¯æ„å»ºäºï¼Œä½ åœ¨ webpack é…ç½®ä¸­ç”¨åˆ°çš„ç›¸åŒçš„æ’ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼</p><p>æ’ä»¶ç›®çš„åœ¨äºè§£å†³ loader æ— æ³•å®ç°çš„å…¶ä»–äº‹ã€‚</p><p>webpack æ’ä»¶æ˜¯ä¸€ä¸ªå…·æœ‰ apply å±æ€§çš„ JavaScript å¯¹è±¡ã€‚apply å±æ€§ä¼šè¢« webpack compiler è°ƒç”¨ï¼Œå¹¶ä¸” compiler å¯¹è±¡å¯åœ¨æ•´ä¸ªç¼–è¯‘ç”Ÿå‘½å‘¨æœŸè®¿é—®ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ConsoleLogOnBuildWebpackPlugin.jsconst pluginName &#x3D; &quot;ConsoleLogOnBuildWebpackPlugin&quot;;class ConsoleLogOnBuildWebpackPlugin &#123;  apply(compiler) &#123;    &#x2F;&#x2F; æ³¨æ„è¿™ä¸ªcompiler    compiler.hooks.run.tap(pluginName, (compilation) &#x3D;&gt; &#123;      &#x2F;&#x2F; æ³¨æ„è¿™ä¸ªcompilation      console.log(&quot;webpack æ„å»ºè¿‡ç¨‹å¼€å§‹ï¼&quot;);    &#125;);  &#125;&#125;</code></pre><p>compiler hook çš„ tap æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯é©¼å³°å¼å‘½åçš„æ’ä»¶åç§°ã€‚å»ºè®®ä¸ºæ­¤ä½¿ç”¨ä¸€ä¸ªå¸¸é‡ï¼Œä»¥ä¾¿å®ƒå¯ä»¥åœ¨æ‰€æœ‰ hook ä¸­å¤ç”¨ã€‚</p><p><a href="https://www.webpackjs.com/concepts/plugins/#%E5%89%96%E6%9E%90" target="_blank" >è§ plugin å‰–æ</a></p><h2 id="webpack-çš„çƒ­æ›´æ–°åŸç†"><a href="#webpack-çš„çƒ­æ›´æ–°åŸç†" class="headerlink" title="webpack çš„çƒ­æ›´æ–°åŸç†"></a>webpack çš„çƒ­æ›´æ–°åŸç†</h2><p>Webpack çš„<code>çƒ­æ›´æ–°</code>åˆç§°<code>çƒ­æ›¿æ¢</code>ï¼ˆHot Module Replacementï¼‰ï¼Œç¼©å†™ä¸º HMRã€‚ è¿™ä¸ªæœºåˆ¶å¯ä»¥åšåˆ°<code>ä¸ç”¨åˆ·æ–°æµè§ˆå™¨</code>è€Œå°†æ–°å˜æ›´çš„æ¨¡å—æ›¿æ¢æ‰æ—§çš„æ¨¡å—ã€‚</p><p>HMR çš„æ ¸å¿ƒå°±æ˜¯å®¢æˆ·ç«¯ä»æœåŠ¡ç«¯æ‹‰å»æ›´æ–°åçš„æ–‡ä»¶ï¼Œå‡†ç¡®çš„è¯´æ˜¯ <code>chunk diff</code> (chunk éœ€è¦æ›´æ–°çš„éƒ¨åˆ†)ï¼Œå®é™…ä¸Š <code>WDS</code> ä¸æµè§ˆå™¨ä¹‹é—´ç»´æŠ¤äº†ä¸€ä¸ª Websocketï¼Œå½“æœ¬åœ°èµ„æºå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒWDS ä¼šå‘æµè§ˆå™¨æ¨é€æ›´æ–°ï¼Œ<code>å¹¶å¸¦ä¸Šæ„å»ºæ—¶çš„ hash</code>ï¼Œè®©å®¢æˆ·ç«¯ä¸ä¸Šä¸€æ¬¡èµ„æºè¿›è¡Œå¯¹æ¯”ã€‚</p><p>å®¢æˆ·ç«¯å¯¹æ¯”å‡ºå·®å¼‚åä¼šå‘ WDS å‘èµ· Ajax è¯·æ±‚æ¥è·å–æ›´æ”¹å†…å®¹(æ–‡ä»¶åˆ—è¡¨ã€hash)ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥å†å€ŸåŠ©è¿™äº›ä¿¡æ¯ç»§ç»­å‘ WDS å‘èµ· jsonp è¯·æ±‚è·å–è¯¥ chunk çš„å¢é‡æ›´æ–°ã€‚</p><p>åç»­çš„éƒ¨åˆ†(æ‹¿åˆ°å¢é‡æ›´æ–°ä¹‹åå¦‚ä½•å¤„ç†ï¼Ÿå“ªäº›çŠ¶æ€è¯¥ä¿ç•™ï¼Ÿå“ªäº›åˆéœ€è¦æ›´æ–°ï¼Ÿ)ç”±<code> HotModulePlugin</code> æ¥å®Œæˆï¼Œæä¾›äº†ç›¸å…³ API ä»¥ä¾›å¼€å‘è€…é’ˆå¯¹è‡ªèº«åœºæ™¯è¿›è¡Œå¤„ç†ï¼Œåƒ <code>react-hot-loader</code> å’Œ <code>vue-loader</code> éƒ½æ˜¯å€ŸåŠ©è¿™äº› API å®ç° HMRã€‚</p><p><a href="https://zhuanlan.zhihu.com/p/30669007" target="_blank" >è§</a></p><h2 id="â½¤-webpack-æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½"><a href="#â½¤-webpack-æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½" class="headerlink" title="â½¤ webpack æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½"></a>â½¤ webpack æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½</h2><p>åŸåˆ™ï¼š<code>æ›´å°</code>ã€<code>æ›´å°‘</code>ã€<code>æ›´è¿‘</code></p><p>â½¤ webpack ä¼˜åŒ–å‰ç«¯æ€§èƒ½æ˜¯æŒ‡ä¼˜åŒ– webpack çš„è¾“å‡ºç»“æœï¼Œè®©æ‰“åŒ…çš„æœ€ç»ˆç»“æœåœ¨æµè§ˆå™¨è¿â¾å¿«é€Ÿâ¾¼æ•ˆã€‚</p><p><strong>æ›´å°</strong></p><ul><li><code>å‹ç¼©ä»£ç </code>:åˆ é™¤å¤šä½™çš„ä»£ç ã€æ³¨é‡Šã€ç®€åŒ–ä»£ç çš„å†™æ³•ç­‰ç­‰â½…å¼ã€‚å¯ä»¥åˆ©â½¤ webpack çš„ <code>UglifyJsPlugin</code> å’Œ <code>ParallelUglifyPlugin</code> æ¥å‹ç¼© JS â½‚ä»¶ï¼Œ</li><li><code>åˆ©â½¤ cssnano</code> ï¼ˆcss-loader?minimizeï¼‰æ¥å‹ç¼© css</li><li><code>Tree Shaking</code>: å°†ä»£ç ä¸­æ°¸è¿œä¸ä¼šâ¾›åˆ°çš„â½šæ®µåˆ é™¤æ‰ã€‚å¯ä»¥é€šè¿‡åœ¨å¯åŠ¨ webpack æ—¶è¿½åŠ å‚æ•° â€“optimize-minimize æ¥å®ç°</li></ul><p><strong>æ›´å°‘</strong></p><ul><li><code>Code Splitting</code>: å°†ä»£ç æŒ‰è·¯ç”±ç»´åº¦æˆ–è€…ç»„ä»¶åˆ†å—(chunk),è¿™æ ·åšåˆ°æŒ‰éœ€åŠ è½½,åŒæ—¶å¯ä»¥å……åˆ†åˆ©â½¤æµè§ˆå™¨ç¼“å­˜</li><li><code>æå–å…¬å…±ç¬¬ä¸‰â½…åº“</code>: SplitChunksPlugin æ’ä»¶æ¥è¿›â¾å…¬å…±æ¨¡å—æŠ½å–,åˆ©â½¤æµè§ˆå™¨ç¼“å­˜å¯ä»¥â»“æœŸç¼“å­˜è¿™äº›â½†éœ€é¢‘ç¹å˜åŠ¨çš„ å…¬å…±ä»£ç </li></ul><p><strong>æ›´è¿‘</strong></p><ul><li><code>åˆ©â½¤ CDN åŠ é€Ÿ</code>: åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå°†å¼•â½¤çš„é™æ€èµ„æºè·¯å¾„ä¿®æ”¹ä¸º CDN ä¸Šå¯¹åº”çš„è·¯å¾„ã€‚å¯ä»¥åˆ©â½¤ webpack å¯¹ äº output å‚æ•°å’Œå„ loader çš„ publicPath å‚æ•°æ¥ä¿®æ”¹èµ„æºè·¯å¾„</li></ul><h2 id="æâ¾¼-webpack-çš„æ‰“åŒ…é€Ÿåº¦"><a href="#æâ¾¼-webpack-çš„æ‰“åŒ…é€Ÿåº¦" class="headerlink" title="æâ¾¼ webpack çš„æ‰“åŒ…é€Ÿåº¦"></a>æâ¾¼ webpack çš„æ‰“åŒ…é€Ÿåº¦</h2><p><strong>æ‰“ä¸ªæ¯”æ–¹ï¼š</strong></p><p>ä¸€æœŸéœ€æ±‚æ—¶é—´ç´§ä»»åŠ¡é‡ï¼Œé¢†å¯¼æ¥äº†ï¼Œè¯´è¦æ˜å¤©ä¸Šçº¿ã€‚<br>å¦‚ä½•åšåˆ°æ›´å¿«ä¸Šçº¿ï¼Ÿï¼ˆéœ€è¦ï¼š<code>æ›´å¤šçš„ç ”å‘èµ„æº</code>ï¼ˆå¹¶è¡Œï¼‰ï¼›<code>ä¹‹å‰æœ‰çš„åŠŸèƒ½ç»„ä»¶ç›´æ¥ç”¨</code>ï¼ˆä¸é‡å¤åšäº‹ï¼‰ï¼›<code>ç å‡ ä¸ªéœ€æ±‚å§</code>ï¼ˆæ›´å°çš„èŒƒå›´ï¼‰ï¼‰</p><p><strong>ç”¨æ›´å‰å®³çš„</strong></p><ul><li>é«˜ç‰ˆæœ¬<code>node</code>å’Œ<code>webpack</code></li></ul><p><strong>å¹¶è¡Œ</strong></p><ul><li><code>happypack</code>: åˆ©â½¤è¿›ç¨‹å¹¶â¾ç¼–è¯‘ loader,åˆ©â½¤ç¼“å­˜æ¥ä½¿å¾— rebuild æ›´å¿«,é—æ†¾çš„æ˜¯ä½œè€…è¡¨ç¤ºå·²ç»ä¸ä¼šç»§ç»­å¼€å‘æ­¤é¡¹â½¬,ç±» ä¼¼çš„æ›¿ä»£è€…æ˜¯<code>thread-loader</code></li></ul><p><strong>ä¸é‡å¤åšäº‹</strong></p><ul><li><code>å¤–éƒ¨æ‰©å±•(externals)</code>: å°†ä¸æ€ä¹ˆéœ€è¦æ›´æ–°çš„ç¬¬ä¸‰â½…åº“è„±ç¦» webpack æ‰“åŒ…ï¼Œä¸è¢«æ‰“â¼Š bundle ä¸­ï¼Œä»â½½å‡å°‘æ‰“åŒ…æ—¶é—´,â½ å¦‚ jQuery <code>â½¤ script æ ‡ç­¾å¼•â¼Š</code></li><li><code>dll</code>: é‡‡â½¤ webpack çš„ <code>DllPlugin</code> å’Œ <code>DllReferencePlugin</code> å¼•â¼Š dllï¼Œè®©â¼€äº›åŸºæœ¬ä¸ä¼šæ”¹åŠ¨çš„ä»£ç å…ˆæ‰“åŒ…æˆé™æ€èµ„æº,é¿å… åå¤ç¼–è¯‘æµªè´¹æ—¶é—´</li><li><code>åˆ©â½¤ç¼“å­˜</code>: <code>webpack.cache</code> ã€<code>babel-loader.cacheDirectory</code>ã€ <code>HappyPack.cache</code> éƒ½å¯ä»¥åˆ©â½¤ç¼“å­˜æâ¾¼ rebuild æ•ˆç‡</li></ul><p><strong>æ›´å°çš„èŒƒå›´</strong></p><ul><li><code>ç¼©â¼©â½‚ä»¶æœç´¢èŒƒå›´</code>: â½å¦‚ babel-loader æ’ä»¶,å¦‚æœä½ çš„â½‚ä»¶ä»…å­˜åœ¨äº src ä¸­,é‚£ä¹ˆå¯ä»¥ include: path.resolve(__dirname, â€˜srcâ€™) ,å½“ç„¶ç»â¼¤å¤šæ•°æƒ…å†µä¸‹è¿™ç§æ“ä½œçš„æå‡æœ‰é™,é™¤â¾®ä¸â¼©â¼¼ build äº† node_modules â½‚ä»¶</li></ul><h2 id="æâ¾¼-webpack-çš„æ„å»ºé€Ÿåº¦"><a href="#æâ¾¼-webpack-çš„æ„å»ºé€Ÿåº¦" class="headerlink" title="æâ¾¼ webpack çš„æ„å»ºé€Ÿåº¦"></a>æâ¾¼ webpack çš„æ„å»ºé€Ÿåº¦</h2><ul><li>é«˜ç‰ˆæœ¬<code>node</code>å’Œ<code>webpack</code></li><li>å¤šâ¼Šâ¼æƒ…å†µä¸‹ï¼Œä½¿â½¤ CommonsChunkPlugin æ¥æå–å…¬å…±ä»£ç </li><li>é€šè¿‡ <code>externals</code> é…ç½®æ¥æå–å¸¸â½¤åº“</li><li>åˆ©â½¤ <code>DllPlugin</code> å’Œ <code>DllReferencePlugin</code> é¢„ç¼–è¯‘èµ„æºæ¨¡å— é€šè¿‡ DllPlugin æ¥å¯¹é‚£äº›æˆ‘ä»¬å¼•â½¤ä½†æ˜¯ç»å¯¹ä¸ä¼šä¿®æ”¹çš„ npm åŒ…æ¥è¿›â¾é¢„ç¼–è¯‘ï¼Œå†é€šè¿‡ DllReferencePlugin å°†é¢„ç¼–è¯‘çš„æ¨¡å—åŠ è½½è¿›æ¥ã€‚</li><li>ä½¿â½¤ <code>Happypack</code> å®ç°å¤šçº¿ç¨‹åŠ é€Ÿç¼–è¯‘</li><li>ä½¿â½¤ <code>webpack-uglify-parallel</code> æ¥æå‡ uglifyPlugin çš„å‹ç¼©é€Ÿåº¦ã€‚ åŸç†ä¸Š webpack-uglify-parallel é‡‡â½¤äº†å¤šæ ¸å¹¶â¾ å‹ç¼©æ¥æå‡å‹ç¼©é€Ÿåº¦</li><li>ä½¿â½¤ <code>Tree-shaking</code> å’Œ <code>Scope Hoisting</code> æ¥å‰”é™¤å¤šä½™ä»£ç </li></ul><h2 id="æ€ä¹ˆé…ç½®å•â»šåº”â½¤ï¼Ÿæ€ä¹ˆé…ç½®å¤šâ»šåº”â½¤ï¼Ÿ"><a href="#æ€ä¹ˆé…ç½®å•â»šåº”â½¤ï¼Ÿæ€ä¹ˆé…ç½®å¤šâ»šåº”â½¤ï¼Ÿ" class="headerlink" title="æ€ä¹ˆé…ç½®å•â»šåº”â½¤ï¼Ÿæ€ä¹ˆé…ç½®å¤šâ»šåº”â½¤ï¼Ÿ"></a>æ€ä¹ˆé…ç½®å•â»šåº”â½¤ï¼Ÿæ€ä¹ˆé…ç½®å¤šâ»šåº”â½¤ï¼Ÿ</h2><ul><li><p><code>å•â»šåº”â½¤</code>å¯ä»¥ç†è§£ä¸º webpack çš„æ ‡å‡†æ¨¡å¼ï¼Œç›´æ¥åœ¨ entry ä¸­æŒ‡å®šå•â»šåº”â½¤çš„â¼Šâ¼å³å¯ï¼Œè¿™â¾¥ä¸å†èµ˜è¿°</p><br/><br/></li><li><p><code>å¤šâ»šåº”â½¤</code>çš„è¯ï¼Œå¯ä»¥ä½¿â½¤ webpack çš„ <code>AutoWebPlugin</code> æ¥å®Œæˆç®€å•â¾ƒåŠ¨åŒ–çš„æ„å»ºï¼Œä½†æ˜¯å‰ææ˜¯é¡¹â½¬çš„<code>â½¬å½•ç»“æ„å¿…é¡»éµå®ˆä»–é¢„è®¾çš„è§„èŒƒ</code>ã€‚ å¤šâ»šåº”â½¤ä¸­è¦æ³¨æ„çš„æ˜¯ï¼š <code>æ¯ä¸ªâ»šâ¾¯éƒ½æœ‰å…¬å…±çš„ä»£ç ï¼Œå¯ä»¥å°†è¿™äº›ä»£ç æŠ½ç¦»å‡ºæ¥ï¼Œé¿å…é‡å¤çš„åŠ è½½</code>ã€‚â½å¦‚ï¼Œæ¯ä¸ªâ»šâ¾¯éƒ½å¼•â½¤äº†åŒâ¼€å¥— css æ ·å¼è¡¨éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å±•ï¼Œâ»šâ¾¯å¯èƒ½ä¼šä¸æ–­çš„è¿½åŠ ï¼Œæ‰€ä»¥â¼€å®šè¦è®©<code>â¼Šâ¼çš„é…ç½®â¾œå¤Ÿçµæ´»</code>ï¼Œé¿å…æ¯æ¬¡æ·»åŠ æ–°â»šâ¾¯è¿˜éœ€è¦ä¿®æ”¹æ„å»ºé…ç½®</p></li></ul><h2 id="source-map-æ˜¯ä»€ä¹ˆï¼Ÿç”Ÿäº§ç¯å¢ƒæ€ä¹ˆç”¨ï¼Ÿ"><a href="#source-map-æ˜¯ä»€ä¹ˆï¼Ÿç”Ÿäº§ç¯å¢ƒæ€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="source map æ˜¯ä»€ä¹ˆï¼Ÿç”Ÿäº§ç¯å¢ƒæ€ä¹ˆç”¨ï¼Ÿ"></a>source map æ˜¯ä»€ä¹ˆï¼Ÿç”Ÿäº§ç¯å¢ƒæ€ä¹ˆç”¨ï¼Ÿ</h2><p><code>source map</code> æ˜¯å°†ç¼–è¯‘ã€æ‰“åŒ…ã€å‹ç¼©åçš„ä»£ç æ˜ å°„å›æºä»£ç çš„è¿‡ç¨‹ã€‚</p><ul><li><code>æ‰“åŒ…å‹ç¼©åçš„ä»£ç ä¸å…·å¤‡è‰¯å¥½çš„å¯è¯»æ€§ï¼Œæƒ³è¦è°ƒè¯•æºç å°±éœ€è¦ soucre map</code>ã€‚</li><li>map æ–‡ä»¶åªè¦ä¸æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œæµè§ˆå™¨æ˜¯ä¸ä¼šåŠ è½½çš„ã€‚</li></ul><p><strong>çº¿ä¸Šç¯å¢ƒä¸€èˆ¬æœ‰ä¸‰ç§å¤„ç†æ–¹æ¡ˆï¼š</strong></p><ul><li><code>hidden-source-map</code>ï¼šå€ŸåŠ©ç¬¬ä¸‰æ–¹é”™è¯¯ç›‘æ§å¹³å° Sentry ä½¿ç”¨</li><li><code>nosources-source-map</code>ï¼šåªä¼šæ˜¾ç¤ºå…·ä½“è¡Œæ•°ä»¥åŠæŸ¥çœ‹æºä»£ç çš„é”™è¯¯æ ˆã€‚å®‰å…¨æ€§æ¯” sourcemap é«˜</li><li><code>sourcemap</code>ï¼šé€šè¿‡<code>nginx</code> è®¾ç½®å°† <code>.map</code> æ–‡ä»¶<code>åªå¯¹ç™½åå•å¼€æ”¾</code>(å…¬å¸å†…ç½‘)</li></ul><p>æ³¨æ„ï¼šé¿å…åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ <code>inline-</code> å’Œ <code>eval-</code>ï¼Œå› ä¸ºå®ƒä»¬ä¼šå¢åŠ  bundle ä½“ç§¯å¤§å°ï¼Œå¹¶é™ä½æ•´ä½“æ€§èƒ½ã€‚</p><p><a href="https://juejin.cn/post/6844903450644316174" target="_blank" >[webpack] devtool é‡Œçš„ 7 ç§ SourceMap æ¨¡å¼æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ</a></p><p>sourcemap å…³é”®å­—å¦‚ä¸‹</p><p><strong>eval</strong></p><p>ä½¿ç”¨ eval åŒ…è£¹ä»£ç æ¨¡å—ï¼ˆè¿™ä¸ªä»£ç å—æ˜¯è½¬è¯‘åçš„ä»£ç ï¼Œå¹¶æœªè¿›è¡Œæ‰“åŒ…å’Œå‹ç¼©ï¼‰<br>eval åŒ…è£¹æ¯ä¸ªä»£ç å—æ—¶å€™ï¼Œä¼šåœ¨åé¢å¢åŠ â€sourceURLâ€ï¼ˆå’Œ sourcemap é‡Œçš„â€sourceMappingURLâ€ä¸åŒï¼‰ç”¨æ¥å®šä½åˆ°åŸæ–‡ä»¶ã€‚</p><p>eval æ¨¡å¼ä¼˜åŠ¿åœ¨äºï¼Œå®ƒæ˜¯å°†æ¯ä¸ªæ¨¡å—å•ç‹¬ eval æ‰§è¡Œï¼Œå› æ­¤å¦‚æœé…åˆ source-map ä½¿ç”¨ï¼Œå°±å¯ä»¥å•ç‹¬ç¼“å­˜æ¯ä¸ªæ¨¡å—çš„ sourcemapï¼Œè¿™æ ·å°±å¯ä»¥åœ¨é‡æ–°æ„å»ºæ—¶å€™å®ç°å¢é‡ä¿®æ”¹ sourcemapï¼ŒèŠ‚çœæ—¶é—´ã€‚</p><p>å¦‚æœä¸ä½¿ç”¨ eval æ¨¡å¼ï¼Œå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆchunkï¼‰å¯¹åº”ä¸€ä¸ª sourcemapï¼Œé‡æ–°æ„å»ºæ—¶å€™éœ€è¦å°†æ•´ä¸ª chunk çš„ sourcemap é‡æ–°ç”Ÿæˆï¼Œæ›´è€—è´¹æ—¶é—´ã€‚</p><p>å› æ­¤ eval æ¨¡å¼çš„ä¼˜åŠ¿å°±åœ¨äºé‡æ–°æ„å»ºçš„é€Ÿåº¦æ›´å¿«</p><p><strong>source-map</strong></p><p>äº§ç”Ÿ source map</p><p><strong>cheap</strong></p><p>ç”¨æ¥ä¿®é¥° source-map<br>è®© sourcemap åªä¿å­˜è¡Œä¿¡æ¯ï¼Œä¸ä¿å­˜åˆ—ä¿¡æ¯<br>è®© sourcemap åªå°†æ‰“åŒ…åçš„ä»£ç æ˜ å°„åˆ°è½¬æ¢è¿‡çš„ä»£ç ï¼Œä¸æ˜ å°„åˆ°åŸå§‹æºä»£ç <br>ã€ç”±äºæºä»£ç åˆ°è½¬è¯‘åçš„ä»£ç çš„æ˜ å°„å…³ç³»ç”±ç›¸åº”çš„ loader æä¾›ï¼Œå› æ­¤ cheap æ¨¡å¼åº”è¯¥ä¸éœ€è¦å…³å¿ƒè¿™éƒ¨åˆ†çš„ sourcemapã€‘</p><p><strong>module</strong></p><p>ç”¨æ¥ä¿®é¥° cheap-source-map<br>è®© sourcemap å¯ä»¥æ˜ å°„åˆ°åŸå§‹æºä»£ç <br>ã€ç”±äºæºä»£ç åˆ°è½¬è¯‘åçš„ä»£ç çš„æ˜ å°„å…³ç³»ç”±ç›¸åº”çš„ loader æä¾›ï¼Œå› æ­¤ module æ¨¡å¼åº”è¯¥ä¼šå¤„ç†è¿™éƒ¨åˆ† sourcemapï¼Œä»¥æœ€ç»ˆå¾—åˆ°åˆ°åŸå§‹æºä»£ç çš„æ˜ å°„ã€‘</p><p><strong>inline</strong></p><p>ç”¨æ¥ä¿®é¥° source-map<br>å°†.map ä½œä¸º DataURI åµŒå…¥ï¼Œä¸å•ç‹¬ç”Ÿæˆ.map æ–‡ä»¶</p><p><a href="https://www.jianshu.com/p/b2316aab32bb" target="_blank" >webpack çš„ sourcemap å„ç§å‚æ•°è¯¦è§£</a></p><table><thead><tr><th>devtool</th><th>æ„å»ºé€Ÿåº¦</th><th>é‡æ–°æ„å»ºé€Ÿåº¦</th><th>ç”Ÿäº§ç¯å¢ƒ</th><th>å“è´¨</th></tr></thead><tbody><tr><td>(none)</td><td>+++</td><td>+++</td><td>yes</td><td>æ‰“åŒ…åçš„ä»£ç </td></tr><tr><td>eval</td><td>+++</td><td>+++</td><td>no</td><td>ç”Ÿæˆåçš„ä»£ç </td></tr><tr><td>source-map</td><td>â€“</td><td>â€“</td><td>yes</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>eval-source-map</td><td>â€“</td><td>+</td><td>no</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>cheap-source-map</td><td>+</td><td>o</td><td>no</td><td>è½¬æ¢è¿‡çš„ä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>cheap-module-source-map</td><td>o</td><td>-</td><td>no</td><td>åŸå§‹æºä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>cheap-eval-source-map</td><td>+</td><td>++</td><td>no</td><td>è½¬æ¢è¿‡çš„ä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>cheap-module-eval-source-map</td><td>o</td><td>++</td><td>no</td><td>åŸå§‹æºä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>inline-source-map</td><td>â€“</td><td>â€“</td><td>no</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>inline-cheap-source-map</td><td>+</td><td>o</td><td>no</td><td>è½¬æ¢è¿‡çš„ä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>inline-cheap-module-source-map</td><td>o</td><td>-</td><td>no</td><td>åŸå§‹æºä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>hidden-source-map</td><td>â€“</td><td>â€“</td><td>yes</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>nosources-source-map</td><td>â€“</td><td>â€“</td><td>yes</td><td>æ— æºä»£ç å†…å®¹</td></tr></tbody></table><h2 id="æ¨¡å—æ‰“åŒ…åŸç†çŸ¥é“å—ï¼Ÿ"><a href="#æ¨¡å—æ‰“åŒ…åŸç†çŸ¥é“å—ï¼Ÿ" class="headerlink" title="æ¨¡å—æ‰“åŒ…åŸç†çŸ¥é“å—ï¼Ÿ"></a>æ¨¡å—æ‰“åŒ…åŸç†çŸ¥é“å—ï¼Ÿ</h2><p>Webpack <code>å®é™…ä¸Šä¸ºæ¯ä¸ªæ¨¡å—åˆ›é€ äº†ä¸€ä¸ªå¯ä»¥å¯¼å‡ºå’Œå¯¼å…¥çš„ç¯å¢ƒ</code>ï¼Œ<code>æœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ä¿®æ”¹ ä»£ç çš„æ‰§è¡Œé€»è¾‘</code>ï¼Œ<code>ä»£ç æ‰§è¡Œé¡ºåºä¸æ¨¡å—åŠ è½½é¡ºåºä¹Ÿå®Œå…¨ä¸€è‡´</code>ã€‚</p><h2 id="æ–‡ä»¶æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ"><a href="#æ–‡ä»¶æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="æ–‡ä»¶æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ"></a>æ–‡ä»¶æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ</h2><p>æ–‡ä»¶æŒ‡çº¹æ˜¯æ‰“åŒ…åè¾“å‡ºçš„æ–‡ä»¶åçš„åç¼€ã€‚</p><ul><li><code>Hash</code>ï¼šå’Œæ•´ä¸ªé¡¹ç›®çš„æ„å»ºç›¸å…³ï¼Œåªè¦é¡¹ç›®æ–‡ä»¶æœ‰ä¿®æ”¹ï¼Œæ•´ä¸ªé¡¹ç›®æ„å»ºçš„ hash å€¼å°±ä¼šæ›´æ”¹</li><li><code>Chunkhash</code>ï¼šå’Œ Webpack æ‰“åŒ…çš„ chunk æœ‰å…³ï¼Œä¸åŒçš„ entry ä¼šç”Ÿå‡ºä¸åŒçš„ chunkhash</li><li><code>Contenthash</code>ï¼šæ ¹æ®æ–‡ä»¶å†…å®¹æ¥å®šä¹‰ hashï¼Œæ–‡ä»¶å†…å®¹ä¸å˜ï¼Œåˆ™ contenthash ä¸å˜</li></ul><h3 id="JS-çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®"><a href="#JS-çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®" class="headerlink" title="JS çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®"></a>JS çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">module.exports &#x3D; &#123;  entry: &#123;    app: &quot;.&#x2F;scr&#x2F;app.js&quot;,    search: &quot;.&#x2F;src&#x2F;search.js&quot;,  &#125;,  output: &#123;    filename: &quot;[name][chunkhash:8].js&quot;,    path: __dirname + &quot;&#x2F;dist&quot;,  &#125;,&#125;;</code></pre><h3 id="CSS-çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®"><a href="#CSS-çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®" class="headerlink" title="CSS çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®"></a>CSS çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®</h3><p>è®¾ç½® <code>MiniCssExtractPlugin</code> çš„ <code>filename</code>ï¼Œä½¿ç”¨ <code>contenthash</code>ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">module.exports &#x3D; &#123;  entry: &#123;    app: &quot;.&#x2F;scr&#x2F;app.js&quot;,    search: &quot;.&#x2F;src&#x2F;search.js&quot;,  &#125;,  output: &#123;    filename: &quot;[name][chunkhash:8].js&quot;,    path: __dirname + &quot;&#x2F;dist&quot;,  &#125;,  plugins: [    new MiniCssExtractPlugin(&#123;      filename: &#96;[name][contenthash:8].css&#96;,    &#125;),  ],&#125;;</code></pre><h3 id="å›¾ç‰‡çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®"><a href="#å›¾ç‰‡çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®" class="headerlink" title="å›¾ç‰‡çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®"></a>å›¾ç‰‡çš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®</h3><p>è®¾ç½®<code>file-loader</code>çš„<code>name</code>ï¼Œä½¿ç”¨<code>hash</code>ã€‚<br>å ä½ç¬¦åç§°åŠå«ä¹‰</p><ul><li><code>ext</code> èµ„æºåç¼€å</li><li><code>name</code> æ–‡ä»¶åç§°</li><li><code>path</code> æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„</li><li><code>folder</code> æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹</li><li><code>contenthash</code> æ–‡ä»¶çš„å†…å®¹ hashï¼Œé»˜è®¤æ˜¯ md5 ç”Ÿæˆ</li><li><code>hash</code> æ–‡ä»¶å†…å®¹çš„ hashï¼Œé»˜è®¤æ˜¯ md5 ç”Ÿæˆ</li><li><code>emoji</code> ä¸€ä¸ªéšæœºçš„æŒ‡ä»£æ–‡ä»¶å†…å®¹çš„ emoj</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">const path &#x3D; require(&quot;path&quot;);module.exports &#x3D; &#123;  entry: &quot;.&#x2F;src&#x2F;index.js&quot;,  output: &#123;    filename: &quot;bundle.js&quot;,    path: path.resolve(__dirname, &quot;dist&quot;),  &#125;,  module: &#123;    rules: [      &#123;        test: &#x2F;\.(png|svg|jpg|gif)$&#x2F;,        use: [          &#123;            loader: &quot;file-loader&quot;, &#x2F;&#x2F; è¿™é‡Œ            options: &#123;              name: &quot;img&#x2F;[name][hash:8].[ext]&quot;, &#x2F;&#x2F; è¿™é‡Œ            &#125;,          &#125;,        ],      &#125;,    ],  &#125;,&#125;;</code></pre><h2 id="å¦‚ä½•å¯¹-bundle-ä½“ç§¯è¿›è¡Œç›‘æ§å’Œåˆ†æï¼Ÿ"><a href="#å¦‚ä½•å¯¹-bundle-ä½“ç§¯è¿›è¡Œç›‘æ§å’Œåˆ†æï¼Ÿ" class="headerlink" title="å¦‚ä½•å¯¹ bundle ä½“ç§¯è¿›è¡Œç›‘æ§å’Œåˆ†æï¼Ÿ"></a>å¦‚ä½•å¯¹ bundle ä½“ç§¯è¿›è¡Œç›‘æ§å’Œåˆ†æï¼Ÿ</h2><ul><li>VSCode ä¸­æœ‰ä¸€ä¸ªæ’ä»¶ <code>Import Cost</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹å¼•å…¥æ¨¡å—çš„å¤§å°è¿›è¡Œå®æ—¶ç›‘æµ‹ï¼Œ</li><li>è¿˜å¯ä»¥ä½¿ç”¨ <code>webpack-bundle-analyzer</code> ç”Ÿæˆ bundle çš„æ¨¡å—ç»„æˆå›¾ï¼Œæ˜¾ç¤ºæ‰€å ä½“ç§¯ã€‚</li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://juejin.cn/post/6844904094281236487" target="_blank" >åè¡€æ•´ç†ã€å†æ¥ä¸€æ‰“ Webpack é¢è¯•é¢˜</a></p><p><a href="https://juejin.cn/post/7073869980411887652" target="_blank" >æœ€è¿‘ä¸¤å‘¨å‡ºå»é¢è¯•é‡åˆ°çš„é¢è¯•é¢˜ï¼ˆå‰ç«¯åˆçº§ã€é•¿æ›´ï¼‰</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-æ•°ç»„</title>
      <link href="//post/2022-07-14js-arr.html"/>
      <url>//post/2022-07-14js-arr.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><ul><li>åˆ›å»º</li><li>å–å€¼</li><li>æŸ¥æ‰¾</li><li>æ‰å¹³åŒ–</li><li>éå†</li><li>è¿”å› boolean</li><li>è¿”å›å­—ç¬¦ä¸²</li><li>å¢&#x2F;åˆ &#x2F;æ”¹&#x2F;æ‹·è´&#x2F;è§£æ„</li></ul><details class="custom-details"><summary>è¯¦ç»†å†…å®¹</summary><p><img src="http://t-blog-images.aijs.top/img/202208022304934.png"  style="max-width: 100%; width: 500px"/></p></p></details><h2 id="æŸ¥çœ‹æ•°ç»„-proto"><a href="#æŸ¥çœ‹æ•°ç»„-proto" class="headerlink" title="æŸ¥çœ‹æ•°ç»„ proto"></a>æŸ¥çœ‹æ•°ç»„ <strong>proto</strong></h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3]; &#x2F;&#x2F; å°†ç»“æœå±•å¼€åï¼Œè§ä¸‹å›¾</code></pre><img src="http://t-blog-images.aijs.top/img/20220714151858.webp" style="max-width: 100%; width: 500px"/><h2 id="å“å‘¦-proto"><a href="#å“å‘¦-proto" class="headerlink" title="å“å‘¦ [].__proto__"></a>å“å‘¦ <code>[].__proto__</code></h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">Object.getOwnPropertyDescriptors([].__proto__);</code></pre><img src="http://t-blog-images.aijs.top/img/20220714155241.webp"/><details class="custom-details"><summary>æŸ¥çœ‹ json æ•°æ®</summary><p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;at&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;concat&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;constructor&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;copyWithin&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;entries&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;every&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;fill&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;filter&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;find&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;findIndex&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;findLast&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;findLastIndex&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;flat&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;flatMap&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;forEach&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;includes&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;indexOf&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;join&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;keys&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;lastIndexOf&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;length&quot;: &#123;    &quot;configurable&quot;: false,    &quot;enumerable&quot;: false,    &quot;value&quot;: 0,    &quot;writable&quot;: true  &#125;,  &quot;map&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;pop&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;push&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;reduce&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;reduceRight&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;reverse&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;shift&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;slice&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;some&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;sort&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;splice&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;toLocaleString&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;toString&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;unshift&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;,  &quot;values&quot;: &#123;    &quot;configurable&quot;: true,    &quot;enumerable&quot;: false,    &quot;writable&quot;: true  &#125;&#125;</code></pre></p></details><h2 id="ä¸€ç‚¹æƒ³æ³•"><a href="#ä¸€ç‚¹æƒ³æ³•" class="headerlink" title="ä¸€ç‚¹æƒ³æ³•"></a>ä¸€ç‚¹æƒ³æ³•</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">Object.keys(Object.getOwnPropertyDescriptors([].__proto__));</code></pre><img src="http://t-blog-images.aijs.top/img/20220714155944.webp" /><h2 id="at"><a href="#at" class="headerlink" title="at"></a>at</h2><p>at() æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ•´æ•°å€¼å¹¶è¿”å›è¯¥ç´¢å¼•çš„é¡¹ç›®ï¼Œå…è®¸æ­£æ•°å’Œè´Ÿæ•°ã€‚è´Ÿæ•´æ•°ä»æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªé¡¹ç›®å¼€å§‹å€’æ•°ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a &#x3D; [1, 2, 3];a[-1]; &#x2F;&#x2F; undefineda.at(-1); &#x2F;&#x2F; 3</code></pre><p><strong>polyfill</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (Array.at) &#123;  Array.proptotype.at &#x3D; function (index) &#123;    if (index &gt;&#x3D; 0) &#123;      return this[index];    &#125; else &#123;      return this.slice(index, index + 1)?.[0];    &#125;  &#125;;&#125;</code></pre><h2 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è¯­æ³•var new_array &#x3D; old_array.concat(value1[, value2[, ...[, valueN]]])</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>concat() æ–¹æ³•ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚æ­¤æ–¹æ³•ä¸ä¼šæ›´æ”¹ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚<br>æ•°ç»„å’Œ&#x2F;æˆ–å€¼ï¼Œå°†è¢«åˆå¹¶åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ä¸­ã€‚å¦‚æœçœç•¥äº†æ‰€æœ‰ valueN å‚æ•°ï¼Œåˆ™ concat ä¼šè¿”å›è°ƒç”¨æ­¤æ–¹æ³•çš„ç°å­˜æ•°ç»„çš„ä¸€ä¸ª<code>æµ…æ‹·è´</code></p><ul><li><strong>å¯¹è±¡å¼•ç”¨</strong>ï¼ˆè€Œä¸æ˜¯å®é™…å¯¹è±¡ï¼‰ï¼šconcat å°†å¯¹è±¡å¼•ç”¨å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚ åŸå§‹æ•°ç»„å’Œæ–°æ•°ç»„éƒ½å¼•ç”¨ç›¸åŒçš„å¯¹è±¡ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå¼•ç”¨çš„å¯¹è±¡è¢«ä¿®æ”¹ï¼Œåˆ™æ›´æ”¹å¯¹äºæ–°æ•°ç»„å’ŒåŸå§‹æ•°ç»„éƒ½æ˜¯å¯è§çš„ã€‚ è¿™åŒ…æ‹¬ä¹Ÿæ˜¯æ•°ç»„çš„æ•°ç»„å‚æ•°çš„å…ƒç´ ã€‚</li><li><strong>æ•°æ®ç±»å‹</strong>å¦‚å­—ç¬¦ä¸²ï¼Œæ•°å­—å’Œå¸ƒå°”ï¼ˆä¸æ˜¯ Stringï¼ŒNumber å’Œ Boolean å¯¹è±¡ï¼‰ï¼šconcat å°†å­—ç¬¦ä¸²å’Œæ•°å­—çš„å€¼å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚</li></ul></blockquote><p>ä½¿ç”¨ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/concat#examples" target="_blank" >è§ MDN ç¤ºä¾‹</a></p><h2 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h2><p>constructor å±æ€§è¿”å› Object çš„æ„é€ å‡½æ•°ï¼ˆç”¨äºåˆ›å»ºå®ä¾‹å¯¹è±¡ï¼‰ã€‚<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor" target="_blank" >è§</a></p><h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><ol><li><p>æ³¨æ„ï¼Œæ­¤å±æ€§çš„å€¼æ˜¯å¯¹å‡½æ•°æœ¬èº«çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŒ…å«å‡½æ•°åç§°çš„å­—ç¬¦ä¸²ã€‚</p></li><li><p>å¯ä»¥ä¸ºé™¤äº† null å’Œ undefinedï¼ˆå› ä¸ºè¿™ä¸¤è€…æ²¡æœ‰ç›¸åº”çš„æ„é€ å‡½æ•°ï¼‰ä¹‹å¤–çš„ä»»ä½•ç±»å‹æŒ‡å®š</p></li><li><p>æ¯å½“æŠŠè¿™æ ·çš„åŸºæœ¬ç±»å‹å½“æˆå¯¹è±¡ä½¿ç”¨æ—¶ï¼Œå…¶å¯¹åº”çš„æ„é€ å‡½æ•°çš„å®ä¾‹å°±ä¼šåœ¨è¯­å¥æ‰§è¡Œåç«‹å³è¢«åˆ›å»ºå’Œä¸¢å¼ƒã€‚</p></li><li><p>ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥æ›´æ”¹ constructor å±æ€§çš„å€¼ï¼Œè¯·æ³¨æ„ï¼Œæ”¹å˜ constructor çš„å±æ€§ä¸ä¼šå½±å“ instanceof è¿ç®—ç¬¦</p></li><li><p>å¦‚æœå¯¹è±¡è¢«å¯†å°æˆ–å†»ç»“ï¼Œé‚£ä¹ˆæ›´æ”¹ constructor å°†ä¸ä¼šèµ·ä½œç”¨ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š</p></li></ol></div><pre class="line-numbers language-js" data-language="js"><code class="language-js">const a &#x3D; new Array();a.constructor &#x3D;&#x3D;&#x3D; Array; &#x2F;&#x2F; true</code></pre><h2 id="copyWithin"><a href="#copyWithin" class="headerlink" title="copyWithin"></a>copyWithin</h2><p><code>å·¦é—­å³å¼€</code></p><p>copyWithin() æ–¹æ³•æµ…å¤åˆ¶æ•°ç»„çš„ä¸€éƒ¨åˆ†åˆ°åŒä¸€æ•°ç»„ä¸­çš„å¦ä¸€ä¸ªä½ç½®ï¼Œå¹¶è¿”å›å®ƒï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„çš„é•¿åº¦ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const array1 &#x3D; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;];&#x2F;&#x2F; æŠŠä¸‹æ ‡3çš„å…ƒç´ æ‹·è´åˆ°ä¸‹æ ‡ä¸º0çš„ä½ç½®console.log(array1.copyWithin(0, 3, 4));&#x2F;&#x2F; [&quot;d&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]&#x2F;&#x2F; æŠŠä¸‹æ ‡ä»3å¼€å§‹åˆ°ç»“æŸçš„å…ƒç´ ï¼Œæ‹·è´åˆ°1çš„ä½ç½®console.log(array1.copyWithin(1, 3));&#x2F;&#x2F; [&quot;d&quot;, &quot;d&quot;, &quot;e&quot;, &quot;d&quot;, &quot;e&quot;]</code></pre><h2 id="entries"><a href="#entries" class="headerlink" title="entries"></a>entries</h2><p>entries() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Array Iterator å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„é”®&#x2F;å€¼å¯¹ã€‚</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/entries#%E7%A4%BA%E4%BE%8B" target="_blank" >ç¤ºä¾‹è§</a></p><h2 id="every"><a href="#every" class="headerlink" title="every"></a>every</h2><h2 id="fill"><a href="#fill" class="headerlink" title="fill"></a>fill</h2><p><code>å·¦é—­å³å¼€</code></p><p>fill() æ–¹æ³•ç”¨ä¸€ä¸ªå›ºå®šå€¼å¡«å……ä¸€ä¸ªæ•°ç»„ä¸­, ä» èµ·å§‹ç´¢å¼• åˆ° ç»ˆæ­¢ç´¢å¼• å†…çš„å…¨éƒ¨å…ƒç´ ã€‚ä¸åŒ…æ‹¬ ç»ˆæ­¢ç´¢å¼•ã€‚</p><p><strong>è¯­æ³•</strong></p><p><code>arr.fill(value[, start[, end]])</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].fill(4); &#x2F;&#x2F; [4, 4, 4][1, 2, 3].fill(4, 1); &#x2F;&#x2F; [1, 4, 4][1, 2, 3].fill(4, 1, 2); &#x2F;&#x2F; [1, 4, 3][1, 2, 3].fill(4, 1, 1); &#x2F;&#x2F; [1, 2, 3][1, 2, 3].fill(4, 3, 3); &#x2F;&#x2F; [1, 2, 3][1, 2, 3].fill(4, -3, -2); &#x2F;&#x2F; [4, 2, 3][1, 2, 3].fill(4, NaN, NaN); &#x2F;&#x2F; [1, 2, 3][1, 2, 3].fill(4, 3, 5); &#x2F;&#x2F; [1, 2, 3]Array(3).fill(4); &#x2F;&#x2F; [4, 4, 4][].fill.call(&#123; length: 3 &#125;, 4); &#x2F;&#x2F; &#123;0: 4, 1: 4, 2: 4, length: 3&#125;</code></pre><h3 id="æ³¨æ„-1"><a href="#æ³¨æ„-1" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Objects by reference.var arr &#x3D; Array(3).fill(&#123;&#125;); &#x2F;&#x2F; [&#123;&#125;, &#123;&#125;, &#123;&#125;];&#x2F;&#x2F; éœ€è¦æ³¨æ„å¦‚æœ fill çš„å‚æ•°ä¸ºå¼•ç”¨ç±»å‹ï¼Œä¼šå¯¼è‡´éƒ½æ‰§è¡ŒåŒä¸€ä¸ªå¼•ç”¨ç±»å‹&#x2F;&#x2F; å¦‚ arr[0] &#x3D;&#x3D;&#x3D; arr[1] ä¸º truearr[0].hi &#x3D; &quot;hi&quot;; &#x2F;&#x2F; [&#123; hi: &quot;hi&quot; &#125;, &#123; hi: &quot;hi&quot; &#125;, &#123; hi: &quot;hi&quot; &#125;]</code></pre></p></div><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><h2 id="findIndex"><a href="#findIndex" class="headerlink" title="findIndex"></a>findIndex</h2><h2 id="findLast"><a href="#findLast" class="headerlink" title="findLast"></a>findLast</h2><h2 id="findLastIndex"><a href="#findLastIndex" class="headerlink" title="findLastIndex"></a>findLastIndex</h2><h2 id="flat"><a href="#flat" class="headerlink" title="flat"></a>flat</h2><h2 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h2><h2 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h2><h2 id="includes"><a href="#includes" class="headerlink" title="includes"></a>includes</h2><h2 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h2><h2 id="join"><a href="#join" class="headerlink" title="join"></a>join</h2><h2 id="keys"><a href="#keys" class="headerlink" title="keys"></a>keys</h2><h2 id="lastIndexOf"><a href="#lastIndexOf" class="headerlink" title="lastIndexOf"></a>lastIndexOf</h2><h2 id="length"><a href="#length" class="headerlink" title="length"></a>length</h2><h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><h2 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h2><h2 id="push"><a href="#push" class="headerlink" title="push"></a>push</h2><h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h2><h2 id="reduceRight"><a href="#reduceRight" class="headerlink" title="reduceRight"></a>reduceRight</h2><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h2 id="shift"><a href="#shift" class="headerlink" title="shift"></a>shift</h2><h2 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h2><p><code>å·¦é—­å³å¼€</code></p><p>slice() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡æ˜¯ä¸€ä¸ªç”± begin å’Œ end å†³å®šçš„åŸæ•°ç»„çš„æµ…æ‹·è´ï¼ˆåŒ…æ‹¬ beginï¼Œä¸åŒ…æ‹¬ endï¼‰ã€‚åŸå§‹æ•°ç»„ä¸ä¼šè¢«æ”¹å˜ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è¯­æ³•arr.slice([begin[, end]])</code></pre><h2 id="some"><a href="#some" class="headerlink" title="some"></a>some</h2><h2 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h2><p>sort() æ–¹æ³•ç”¨åŸåœ°ç®—æ³•å¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œå¹¶è¿”å›æ•°ç»„ã€‚<code>é»˜è®¤æ’åºé¡ºåºæ˜¯åœ¨å°†å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²</code>ï¼Œç„¶åæ¯”è¾ƒå®ƒä»¬çš„ UTF-16 ä»£ç å•å…ƒå€¼åºåˆ—æ—¶æ„å»ºçš„</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const months &#x3D; [&quot;March&quot;, &quot;Jan&quot;, &quot;Feb&quot;, &quot;Dec&quot;];months.sort();console.log(months);&#x2F;&#x2F;  [&quot;Dec&quot;, &quot;Feb&quot;, &quot;Jan&quot;, &quot;March&quot;]const array1 &#x3D; [1, 30, 4, 21, 100000];array1.sort();console.log(array1);&#x2F;&#x2F; [1, 100000, 21, 30, 4]</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>ES10ï¼ˆEcmaScript 2019ï¼‰ä»¥å‰æ²¡æœ‰è¦æ±‚ç¨³å®šæ€§ï¼Œæ„å‘³ç€ä½ <code>å¯èƒ½</code>ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const students &#x3D; [  &#123; name: &quot;Alex&quot;, grade: 15 &#125;,  &#123; name: &quot;Devlin&quot;, grade: 15 &#125;,  &#123; name: &quot;Eagle&quot;, grade: 13 &#125;,  &#123; name: &quot;Sam&quot;, grade: 14 &#125;,];students.sort((firstItem, secondItem) &#x3D;&gt; firstItem.grade - secondItem.grade);&#x2F;&#x2F; es10 +&#x2F;&#x2F; [&#x2F;&#x2F;   &#123; name: &quot;Eagle&quot;,  grade: 13 &#125;,&#x2F;&#x2F;   &#123; name: &quot;Sam&quot;,    grade: 14 &#125;,&#x2F;&#x2F;   &#123; name: &quot;Alex&quot;,   grade: 15 &#125;, &#x2F;&#x2F; grade ç›¸åŒæ—¶ç»´æŒåŸå…ˆçš„é¡ºåº (ç¨³å®šæ’åº)&#x2F;&#x2F;   &#123; name: &quot;Devlin&quot;, grade: 15 &#125;, &#x2F;&#x2F; grade ç›¸åŒæ—¶ç»´æŒåŸå…ˆçš„é¡ºåº (ç¨³å®šæ’åº)&#x2F;&#x2F; ];&#x2F;&#x2F; - es9&#x2F;&#x2F; [&#x2F;&#x2F;   &#123; name: &quot;Eagle&quot;,  grade: 13 &#125;,&#x2F;&#x2F;   &#123; name: &quot;Sam&quot;,    grade: 14 &#125;,&#x2F;&#x2F;   &#123; name: &quot;Devlin&quot;, grade: 15 &#125;, &#x2F;&#x2F; æ²¡æœ‰ç»´æŒåŸå…ˆçš„é¡ºåº&#x2F;&#x2F;   &#123; name: &quot;Alex&quot;,   grade: 15 &#125;, &#x2F;&#x2F; æ²¡æœ‰ç»´æŒåŸå…ˆçš„é¡ºåº&#x2F;&#x2F; ];</code></pre></div><h2 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h2><p>splice() æ–¹æ³•é€šè¿‡åˆ é™¤æˆ–æ›¿æ¢ç°æœ‰å…ƒç´ æˆ–è€…åŸåœ°æ·»åŠ æ–°çš„å…ƒç´ æ¥ä¿®æ”¹æ•°ç»„ï¼Œå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›è¢«ä¿®æ”¹çš„å†…å®¹ã€‚æ­¤æ–¹æ³•<strong>ä¼šæ”¹å˜åŸæ•°ç»„</strong>ã€‚</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/splice#%E7%A4%BA%E4%BE%8B" target="_blank" >ç¤ºä¾‹è§</a></p><h2 id="toLocaleString-NaN"><a href="#toLocaleString-NaN" class="headerlink" title="toLocaleString"></a>toLocaleString</h2><h2 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString"></a>toString</h2><h2 id="unshift"><a href="#unshift" class="headerlink" title="unshift"></a>unshift</h2><h2 id="values"><a href="#values" class="headerlink" title="values"></a>values</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a &#x3D; [1, 2, 3];Array.from(a.keys()); &#x2F;&#x2F; [0, 1, 2]a.fill(10); &#x2F;&#x2F; Â [10, 10, 10]a.fill(1, 0, 1); &#x2F;&#x2F; Â [1, 10, 10]Array.from(a.entries()); &#x2F;&#x2F; [[0,1],[1,10],[2,10]]</code></pre><h2 id="å‡ ä¸ªéåŸå‹é“¾ä¸Šçš„æ–¹æ³•"><a href="#å‡ ä¸ªéåŸå‹é“¾ä¸Šçš„æ–¹æ³•" class="headerlink" title="å‡ ä¸ªéåŸå‹é“¾ä¸Šçš„æ–¹æ³•"></a>å‡ ä¸ªéåŸå‹é“¾ä¸Šçš„æ–¹æ³•</h2><h3 id="isArray"><a href="#isArray" class="headerlink" title="isArray"></a>isArray</h3><ol><li>Array.prototype ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„</li></ol><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.isArray(Array.prototype); &#x2F;&#x2F; é²œä¸ºäººçŸ¥çš„äº‹å®ï¼šå…¶å® Array.prototype ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</code></pre><ol start="2"><li>instanceof_å’Œ_isArray<br>å½“æ£€æµ‹ Array å®ä¾‹æ—¶ï¼ŒArray.isArray ä¼˜äº instanceofï¼Œå› ä¸º Array.isArray èƒ½æ£€æµ‹ iframes</li><li>polyfill</li></ol><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (!Array.isArray) &#123;  Array.isArray &#x3D; function (arg) &#123;    return Object.prototype.toString.call(arg) &#x3D;&#x3D;&#x3D; &quot;[object Array]&quot;;  &#125;;&#125;</code></pre><h3 id="of"><a href="#of" class="headerlink" title="of"></a>of</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.of(7); &#x2F;&#x2F; [7]Array.of(1, 2, 3); &#x2F;&#x2F; [1, 2, 3]Array(7); &#x2F;&#x2F; [ , , , , , , ]Array(1, 2, 3); &#x2F;&#x2F; [1, 2, 3]</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" >MDN Array</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cookieæ³¨å…¥é—®é¢˜</title>
      <link href="//post/2022-07-12cookie.html"/>
      <url>//post/2022-07-12cookie.html</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æ³¨å…¥çš„ cookie æ€ä¹ˆæ²¡æœ‰å•¦ï¼Œåœ¨<code>vconsole</code>ä¸­è°ƒè¯•æŸ¥çœ‹ï¼Œ<code>storage</code>æœ‰<code>cookie</code>ä¿¡æ¯,æ¥å£è°ƒç”¨ï¼Œå‘ç°æ²¡æœ‰ cookie è¢«<code>SSO</code>æ ¡éªŒæ‹¦æˆªä½äº†</p><h2 id="æŠ“åŒ…ç»“æœ"><a href="#æŠ“åŒ…ç»“æœ" class="headerlink" title="æŠ“åŒ…ç»“æœ"></a>æŠ“åŒ…ç»“æœ</h2><p><strong>æœåŠ¡ç«¯æ¸²æŸ“ï¼Œä¸­é—´æœ‰ä»£ç†è½¬å‘ï¼Œnextjs æœåŠ¡ç«¯è‡ªé€‚åº”</strong></p><img src="http://t-blog-images.aijs.top/img/20220712110204.webp" /><p><strong>æ¥å£è¯·æ±‚</strong></p><img src="http://t-blog-images.aijs.top/img/20220712110334.webp" /><h2 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h2><p>é€šè¿‡ chrome,æ‰‹åŠ¨æ³¨å…¥è°ƒè¯•å‘ç°æ­£å¸¸ã€‚æ‰‹åŠ¨æ³¨å…¥ä¸€èˆ¬æƒ…å†µæ˜¯é»˜è®¤<code>/</code>,å­—æ®µä¸æ˜¯å¾ˆå¤šï¼Œcookie æ³¨å…¥æœ‰é—®é¢˜ï¼Œé—®é¢˜å¤§æ¦‚å‡ºç°åœ¨ path</p><img src="http://t-blog-images.aijs.top/img/20220712154936.webp" /><img src="http://t-blog-images.aijs.top/img/20220712154647.webp" /><p>ç›´æ¥æœäº†ä¸‹<code>cookie path</code>å°±æŠŠé—®é¢˜è§£å†³äº†</p><h2 id="ä¿®æ”¹å‰ä»£ç "><a href="#ä¿®æ”¹å‰ä»£ç " class="headerlink" title="ä¿®æ”¹å‰ä»£ç "></a>ä¿®æ”¹å‰ä»£ç </h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">(function () &#123;  document.cookie &#x3D; &quot;SSO_USER_TOKEN&#x3D;å€¼;&quot;;&#125;)();</code></pre><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p><strong><code>é»˜è®¤path</code></strong></p><img src="http://t-blog-images.aijs.top/img/20220712104539.webp" /><p><strong><code>path=/</code></strong></p><img src="http://t-blog-images.aijs.top/img/20220712104801.webp" /><h2 id="cookie-çš„-path-å€¼çš„é»˜è®¤è§„åˆ™"><a href="#cookie-çš„-path-å€¼çš„é»˜è®¤è§„åˆ™" class="headerlink" title="cookie çš„ path å€¼çš„é»˜è®¤è§„åˆ™"></a>cookie çš„ path å€¼çš„é»˜è®¤è§„åˆ™</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><a href="https://www.jianshu.com/p/48556e5c44f5" target="_blank" >cookie çš„ path å€¼çš„é»˜è®¤è§„åˆ™</a><br>å½“ cookie çš„ path è®¾ç½®äº†å€¼ä¸ä¸º null çš„æ—¶å€™ï¼Œä»¥è®¾ç½®çš„å€¼ä¸ºå‡†ã€‚(<strong>æ»¡è¶³å½“å‰åœºæ™¯éœ€è¦</strong>)<br>å½“ cookie çš„ path ä¸º null æ—¶å€™ï¼Œè·å–è¯·æ±‚çš„ URI çš„ path å€¼<br>1). å½“ URI çš„ path å€¼æ˜¯ä»¥â€œ&#x2F;â€ç»“å°¾çš„æ—¶å€™ï¼Œç›´æ¥è®¾ç½®ä¸º cookie çš„ path å€¼<br>2). å½“ URI çš„ path å€¼ä¸æ˜¯ä»¥â€œ&#x2F;â€ç»“å°¾çš„æ—¶å€™ï¼ŒæŸ¥çœ‹ path é‡Œé¢æ˜¯å¦æœ‰â€œ&#x2F;â€<br>2.1). å¦‚æœæœ‰â€œ&#x2F;â€çš„è¯ï¼Œç›´æ¥æˆªå–åˆ°æœ€åä¸€ä¸ªâ€œ&#x2F;â€ï¼Œç„¶åè®¾ç½®ä¸º cookie çš„ path å€¼ã€‚<br>2.2). å¦‚æœæ²¡æœ‰â€œ&#x2F;â€çš„è¯ï¼Œå°† cookie çš„ path è®¾ç½®ä¸ºâ€&#x2F;â€ã€‚</p></blockquote><p><strong>å¯¹äº 1).æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</strong>å¹¶ä¸æ»¡è¶³æœ¬æ¬¡ä¸šåŠ¡éœ€è¦</p><img src="http://t-blog-images.aijs.top/img/20220712162419.webp" /><h2 id="ä¿®æ”¹åä»£ç "><a href="#ä¿®æ”¹åä»£ç " class="headerlink" title="ä¿®æ”¹åä»£ç "></a>ä¿®æ”¹åä»£ç </h2><p>å°† cookie æ³¨å…¥åˆ°<code>/</code>,ä»£ç <code>path=/;</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">(function () &#123;  document.cookie &#x3D; &quot;SSO_USER_TOKEN&#x3D;å€¼;path&#x3D;&#x2F;;&quot;;&#125;)();</code></pre><h2 id="å„å­—æ®µå«ä¹‰"><a href="#å„å­—æ®µå«ä¹‰" class="headerlink" title="å„å­—æ®µå«ä¹‰"></a>å„å­—æ®µå«ä¹‰</h2><p><a href="https://baike.baidu.com/item/cookie/1119" target="_blank" >ç™¾åº¦ç™¾ç§‘</a></p><p>Cookie æ˜¯ä¸€æ®µä¸è¶…è¿‡ 4KB çš„å°å‹æ–‡æœ¬æ•°æ®ï¼Œç”±ä¸€ä¸ªåç§°ï¼ˆNameï¼‰ã€ä¸€ä¸ªå€¼ï¼ˆValueï¼‰å’Œå…¶å®ƒå‡ ä¸ªç”¨äºæ§åˆ¶ Cookie æœ‰æ•ˆæœŸã€å®‰å…¨æ€§ã€ä½¿ç”¨èŒƒå›´çš„å¯é€‰å±æ€§ç»„æˆã€‚å…¶ä¸­ ï¼š</p><ul><li>(1)<strong>Name&#x2F;Value</strong>ï¼šè®¾ç½® Cookie çš„åç§°åŠç›¸å¯¹åº”çš„å€¼ï¼Œå¯¹äºè®¤è¯ Cookieï¼ŒValue å€¼åŒ…æ‹¬ Web æœåŠ¡å™¨æ‰€æä¾›çš„è®¿é—®ä»¤ç‰Œ ã€‚</li><li>(2)<strong>Expires å±æ€§</strong>ï¼šè®¾ç½® Cookie çš„ç”Ÿå­˜æœŸã€‚æœ‰ä¸¤ç§å­˜å‚¨ç±»å‹çš„ Cookieï¼š<strong>ä¼šè¯æ€§</strong>ä¸<strong>æŒä¹…æ€§</strong>ã€‚<ul><li><em>Expires å±æ€§ç¼ºçœæ—¶ï¼Œä¸ºä¼šè¯æ€§ Cookieï¼Œä»…ä¿å­˜åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼Œå¹¶åœ¨ç”¨æˆ·å…³é—­æµè§ˆå™¨æ—¶å¤±æ•ˆ;</em></li><li><em>æŒä¹…æ€§ Cookie ä¼šä¿å­˜åœ¨ç”¨æˆ·çš„ç¡¬ç›˜ä¸­ï¼Œç›´è‡³ç”Ÿå­˜æœŸåˆ°æˆ–ç”¨æˆ·ç›´æ¥åœ¨ç½‘é¡µä¸­å•å‡»â€œæ³¨é”€â€ç­‰æŒ‰é’®ç»“æŸä¼šè¯æ—¶æ‰ä¼šå¤±æ•ˆã€‚</em></li></ul></li><li>(3)<strong>Path å±æ€§</strong>ï¼šå®šä¹‰äº† Web ç«™ç‚¹ä¸Šå¯ä»¥è®¿é—®è¯¥ Cookie çš„ç›®å½• ã€‚</li><li>(4)<strong>Domain å±æ€§</strong>ï¼šæŒ‡å®šäº†å¯ä»¥è®¿é—®è¯¥ Cookie çš„ Web ç«™ç‚¹æˆ–åŸŸã€‚<strong>Cookie æœºåˆ¶å¹¶æœªéµå¾ªä¸¥æ ¼çš„åŒæºç­–ç•¥ï¼Œå…è®¸ä¸€ä¸ªå­åŸŸå¯ä»¥è®¾ç½®æˆ–è·å–å…¶çˆ¶åŸŸçš„ Cookie</strong>ã€‚å½“éœ€è¦å®ç°å•ç‚¹ç™»å½•æ–¹æ¡ˆæ—¶ï¼ŒCookie çš„ä¸Šè¿°ç‰¹æ€§éå¸¸æœ‰ç”¨ï¼Œç„¶è€Œä¹Ÿå¢åŠ äº† Cookie å—æ”»å‡»çš„å±é™©ï¼Œæ¯”å¦‚æ”»å‡»è€…å¯ä»¥å€Ÿæ­¤å‘åŠ¨ä¼šè¯å®šç½®æ”»å‡»ã€‚å› è€Œï¼Œæµè§ˆå™¨ç¦æ­¢åœ¨ Domain å±æ€§ä¸­è®¾ç½®.orgã€.com ç­‰é€šç”¨é¡¶çº§åŸŸåã€ä»¥åŠåœ¨å›½å®¶åŠåœ°åŒºé¡¶çº§åŸŸä¸‹æ³¨å†Œçš„äºŒçº§åŸŸåï¼Œä»¥å‡å°æ”»å‡»å‘ç”Ÿçš„èŒƒå›´ ã€‚</li><li>(5)<strong>Secure å±æ€§</strong>ï¼šæŒ‡å®šæ˜¯å¦ä½¿ç”¨ HTTPS å®‰å…¨åè®®å‘é€ Cookieã€‚ä½¿ç”¨ HTTPS å®‰å…¨åè®®ï¼Œå¯ä»¥ä¿æŠ¤ Cookie åœ¨æµè§ˆå™¨å’Œ Web æœåŠ¡å™¨é—´çš„ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«çªƒå–å’Œç¯¡æ”¹ã€‚è¯¥æ–¹æ³•ä¹Ÿå¯ç”¨äº Web ç«™ç‚¹çš„èº«ä»½é‰´åˆ«ï¼Œå³åœ¨ HTTPS çš„è¿æ¥å»ºç«‹é˜¶æ®µï¼Œæµè§ˆå™¨ä¼šæ£€æŸ¥ Web ç½‘ç«™çš„ SSL è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯åŸºäºå…¼å®¹æ€§çš„åŸå› ï¼ˆæ¯”å¦‚æœ‰äº›ç½‘ç«™ä½¿ç”¨è‡ªç­¾ç½²çš„è¯ä¹¦ï¼‰åœ¨æ£€æµ‹åˆ° SSL è¯ä¹¦æ— æ•ˆæ—¶ï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šç«‹å³ç»ˆæ­¢ç”¨æˆ·çš„è¿æ¥è¯·æ±‚ï¼Œè€Œæ˜¯æ˜¾ç¤ºå®‰å…¨é£é™©ä¿¡æ¯ï¼Œç”¨æˆ·ä»å¯ä»¥é€‰æ‹©ç»§ç»­è®¿é—®è¯¥ç«™ç‚¹ã€‚ç”±äºè®¸å¤šç”¨æˆ·ç¼ºä¹å®‰å…¨æ„è¯†ï¼Œå› è€Œä»å¯èƒ½è¿æ¥åˆ° Pharming æ”»å‡»æ‰€ä¼ªé€ çš„ç½‘ç«™ ã€‚</li><li>(6)<strong>HTTPOnly å±æ€§</strong> ï¼šç”¨äºé˜²æ­¢å®¢æˆ·ç«¯è„šæœ¬é€šè¿‡ document.cookie å±æ€§è®¿é—® Cookieï¼Œæœ‰åŠ©äºä¿æŠ¤ Cookie ä¸è¢«è·¨ç«™è„šæœ¬æ”»å‡»çªƒå–æˆ–ç¯¡æ”¹ã€‚ä½†æ˜¯ï¼ŒHTTPOnly çš„åº”ç”¨ä»å­˜åœ¨å±€é™æ€§ï¼Œä¸€äº›æµè§ˆå™¨å¯ä»¥é˜»æ­¢å®¢æˆ·ç«¯è„šæœ¬å¯¹ Cookie çš„è¯»æ“ä½œï¼Œä½†å…è®¸å†™æ“ä½œï¼›æ­¤å¤–å¤§å¤šæ•°æµè§ˆå™¨ä»å…è®¸é€šè¿‡ XMLHTTP å¯¹è±¡è¯»å– HTTP å“åº”ä¸­çš„ Set-Cookie å¤´ ã€‚</li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jianshu.com/p/48556e5c44f5" target="_blank" >cookie çš„ path å€¼çš„é»˜è®¤è§„åˆ™</a></p><p><a href="https://baike.baidu.com/item/cookie/1119" target="_blank" >ç™¾åº¦ç™¾ç§‘</a></p>]]></content>
      
      
      <categories>
          
          <category> webview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webview </tag>
            
            <tag> cookie </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ä¸šå¾®ä¿¡æ–‡ä»¶é¢„è§ˆ</title>
      <link href="//post/2022-07-05wxfile.html"/>
      <url>//post/2022-07-05wxfile.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼ä¸šå¾®ä¿¡æ–‡ä»¶é¢„è§ˆ"><a href="#ä¼ä¸šå¾®ä¿¡æ–‡ä»¶é¢„è§ˆ" class="headerlink" title="ä¼ä¸šå¾®ä¿¡æ–‡ä»¶é¢„è§ˆ"></a>ä¼ä¸šå¾®ä¿¡æ–‡ä»¶é¢„è§ˆ</h2><p><strong>è¯•é”™ 1:</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const fileName &#x3D; &quot;xxxxx.jpeg&quot;; &#x2F;&#x2F; ä¸¾ä¸ªä¾‹å­downloadAttachment(downloadUrl).then((res) &#x3D;&gt; &#123;  var reader &#x3D; new FileReader();  reader.readAsDataURL(res); &#x2F;&#x2F; è½¬æ¢ä¸ºbase64ï¼Œå¯ä»¥ç›´æ¥æ”¾å…¥aæ ‡ç­¾href  reader.onload &#x3D; function (e) &#123;    const anchorEle &#x3D; document.createElement(&quot;a&quot;);    document.body.appendChild(anchorEle);    anchorEle.href &#x3D; e?.target?.result as any;    anchorEle.download &#x3D; fileName;    anchorEle.click();    setTimeout(() &#x3D;&gt; &#123;      document.body.removeChild(anchorEle);    &#125;);  &#125;;&#125;);</code></pre><p><strong>è¯•é”™ 2: file-saver</strong></p><p><strong>è¯•é”™ 3: file-saver</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export const downloadFile &#x3D; (target, filename &#x3D; &quot;&quot;, type &#x3D; &quot;url&quot;) &#x3D;&gt; &#123;  const link &#x3D; document.createElement(&quot;a&quot;);  const body &#x3D; document.querySelector(&quot;body&quot;);  if (!body) return;  &#x2F;&#x2F; éœ€ä¸‹è½½çš„æ–‡ä»¶ç±»å‹  if (type &#x3D;&#x3D;&#x3D; &quot;url&quot;) &#123;    link.href &#x3D; target;  &#125; else if (type &#x3D;&#x3D;&#x3D; &quot;blob&quot;) &#123;    link.href &#x3D; window.URL.createObjectURL(target);  &#125;  &#x2F;&#x2F; æ–‡ä»¶å  if (filename) link.download &#x3D; filename;  link.style.display &#x3D; &quot;none&quot;;  body.appendChild(link);  link.click();  window.URL.revokeObjectURL(link.href); &#x2F;&#x2F; é‡Šæ”¾ URL å¯¹è±¡  body.removeChild(link);&#125;;</code></pre><p>åœ¨æµè§ˆå™¨ä¸Šæ²¡é—®é¢˜ï¼Œåœ¨ä¼ä¸šå¾®ä¿¡ä¸Š<code>å—å±ï½</code>ï¼Œæœ‰äººè¦è¯´äº†ï¼Œç›´æ¥<code>window.open(downloadUrl)</code>,é€šå¸¸æ¥è¯´æ²¡æ¯›ç—…ã€‚</p><p><strong>å¯æ˜¯</strong>ï¼Œè¦åœ¨è¯·æ±‚<code>downloadUrl</code>æ¥å£æ—¶å€™è¦åŠ ä¸€ä¸ªè¯·æ±‚å¤´ï¼Œè¿™å°¼ç›æ•´çš„ï½</p><img src="http://t-blog-images.aijs.top/img/20220705223754.webp" /><h2 id="è¿™åœºæ™¯çœŸ-ğŸ¶"><a href="#è¿™åœºæ™¯çœŸ-ğŸ¶" class="headerlink" title="è¿™åœºæ™¯çœŸ ğŸ¶"></a>è¿™åœºæ™¯çœŸ ğŸ¶</h2><p>ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¥‡è‘©çš„äº‹æƒ…å‘¢ï¼Ÿâ€”â€” ç»§ä¹‹å‰ï¼Œå¯¹åŒä¸€ä¸ªåŸŸåï¼Œä»¥è¯·æ±‚å¤´åŒºåˆ†æ˜¯<strong>ä¼ä¸šå¾®ä¿¡</strong>ã€<strong>éä¼ä¸šå¾®ä¿¡</strong>ï¼Œä¸¤ç§ç¯å¢ƒçš„æˆæƒæ ¡éªŒæ–¹å¼ä¸åŒã€‚æœ¬èº«æ¶‰åŠæ²¡ä½¿ç”¨ userAgent,è®¾è®¡ç¼ºé™·ï¼Œå¯¼è‡´ä¸€è¿ä¸²é—®é¢˜ã€‚</p><p>é—®ï¼š<code>ä½ æ€ä¹ˆä¸é‡æ„ï¼Ÿ</code> ç­”ï¼š<code>éƒ¨é—¨éƒ½è¢«è£äº†ï¼Œæˆ‘å†åŠªåŠ›æœ‰ç”¨å—ï¼Ÿ</code></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æ–¹æ¡ˆ 1: æŒ‰ç…§ä¹‹å‰çš„è®¾è®¡ï¼Œå†ç”³è¯·ä¸ªåŸŸåï¼ŒæŒ‰ç…§åŸŸåæŠŠåº”ç”¨æ‹†åˆ†ï¼ˆ<code>è¿™ä¸ªè¦èµ°å®¡æ ¸</code>ï¼‰</p><p>æ–¹æ¡ˆ 2: åç«¯å¤„ç†ç”¨<code>userAgent</code>å¤„ç†ä¸‹ï¼Œå…¶ä»–åœ°æ–¹é€»è¾‘ä¸åŠ¨ï¼Œåªå¤„ç† a æ ‡ç­¾ä¸‹è½½çš„æƒ…å†µï¼ˆ<code>è¿™ä¸ªè¦åç«¯æ”¹---æ²¡æƒé™æˆ‘è§‰å¾—æˆ‘è‡ªå·±æ”¹æˆ–è®¸æ›´å¿«</code>ï¼‰</p><p>æ–¹æ¡ˆ 3: æŠŠ API æ”¹äº†ï¼Œå“ªé‡Œå‡ºé—®é¢˜æ”¹å“ªé‡Œ <code>api/wx/download</code> ç»™è¿™ä¸ªå¢åŠ è¯·æ±‚å¤´ï¼Œ ä»£ç†åˆ° <code>api/download</code>ï¼ˆ<code>è¿™é‡Œåº”è¯¥ä¼šå¸¦è¿‡æ¥è¯·æ±‚å¤´</code>ï¼‰</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let fileUrl &#x3D;  &quot;themis&#x2F;attach&#x2F;download?cloudKey&#x3D;&quot; +  attachment.themisCloudKey +  &quot;&amp;fileName&#x3D;&quot; +  encodeURIComponen(attachment.name);&#x2F;&#x2F; ä¼ä¸šå¾®ä¿¡if (getWechatUserAgent(navigator.userAgent)) &#123;  downloadFile(&#96;&#x2F;api&#x2F;redline&#x2F;wx&#x2F;$&#123;fileUrl&#125;&#96;);  &#x2F;&#x2F; éä¼ä¸šå¾®ä¿¡&#125; else &#123;  downloadFile(&#96;&#x2F;api&#x2F;redline&#x2F;$&#123;fileUrl&#125;&#96;);&#125;</code></pre><img src="http://t-blog-images.aijs.top/img/20220706000557.webp" /><img src="http://t-blog-images.aijs.top/img/20220706000652.webp" /><p>å“ˆå“ˆï½ï¼Œå¼€å¿ƒï½</p>]]></content>
      
      
      <categories>
          
          <category> ä¼ä¸šå¾®ä¿¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ä¸šå¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-jsç®—æ³•</title>
      <link href="//post/2022-07-04js.html"/>
      <url>//post/2022-07-04js.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><h3 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h3><img src="https://img-blog.csdnimg.cn/img_convert/afb80e39ce7684d6330fdc66b0873abd.gif" width=300 /><h3 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h3><img src="https://img-blog.csdnimg.cn/img_convert/76339a259488423b03370e381ca5edb0.gif" width=300/><h3 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h3><img src="https://img-blog.csdnimg.cn/img_convert/c894e22dcc48b03559e3087627e3dbb8.gif" width=300/><h3 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h3><img src="https://img-blog.csdnimg.cn/956f63eccd75480791c85edd8ce91658.gif" width=300/><h3 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h3><img src="http://t-blog-images.aijs.top/img/1940317-acc6c6f16b096794.gif" /><h3 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h3><img src="https://img-blog.csdnimg.cn/img_convert/4ad3b539bee9bfe9a6acdba476ceed78.gif" width=300 /><img src="http://t-blog-images.aijs.top/img/20220704153839.webp" /><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;*å¿«æ’æ˜¯å†’æ³¡çš„ä¸€ç§æ”¹è¿›ï¼ŒåŸºäºåˆ†æ²»æ€æƒ³*&#x2F;const arr2 &#x3D; [2, 44, 1, 0, -22, 56, -78];function quickSort2(arr) &#123;  if (arr.length &#x3D;&#x3D;&#x3D; 0) return arr;  const pivot &#x3D; arr.pop(); &#x2F;&#x2F; ä½¿ç”¨æœ€åä¸€ä¸ªå…ƒç´ å½“ä½œåŸºå‡†æ•°  const left &#x3D; [],    right &#x3D; [];  for (let i &#x3D; 0; i &lt; arr.length; i++) &#123;    if (arr[i] &lt; pivot) left.push(arr[i]); &#x2F;&#x2F; å°äºåŸºå‡†æ•°åˆ™æ”¾åˆ°left    else right.push(arr[i]); &#x2F;&#x2F; å¤§äºåŸºå‡†æ•°åˆ™æ”¾åˆ°right  &#125;  &#x2F;&#x2F; åˆå¹¶leftçš„å¿«æ’ç»“æœï¼ŒåŸºå‡†æ•°å’Œå³ä¾§çš„å¿«æ’ç»“æœ  return quickSort2(left).concat(pivot, quickSort2(right));&#125;console.log(quickSort2(arr2));</code></pre><h2 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function deepClone(obj) &#123;  let result;  if (typeof obj &#x3D;&#x3D; &quot;object&quot;) &#123;    &#x2F;&#x2F; éåŸºæœ¬æ•°æ®ç±»å‹ï¼Œéå†èµ‹å€¼    result &#x3D; isArray(obj) ? [] : &#123;&#125;; &#x2F;&#x2F; ç©ºå¯¹è±¡æ¥æ”¶    for (let i in obj) &#123;      result[i] &#x3D;        isObject(obj[i]) || isArray(obj[i]) ? deepClone(obj[i]) : obj[i];    &#125;  &#125; else &#123;    &#x2F;&#x2F;åŸºæœ¬æ•°æ®ç±»å‹ï¼Œç›´æ¥èµ‹å€¼    result &#x3D; obj;  &#125;  return result;&#125;function isObject(obj) &#123;  return Object.prototype.toString.call(obj) &#x3D;&#x3D; &quot;[object Object]&quot;;&#125;function isArray(obj) &#123;  return Object.prototype.toString.call(obj) &#x3D;&#x3D; &quot;[object Array]&quot;;&#125;</code></pre><h2 id="æ·±æ¯”è¾ƒ"><a href="#æ·±æ¯”è¾ƒ" class="headerlink" title="æ·±æ¯”è¾ƒ"></a>æ·±æ¯”è¾ƒ</h2><p>å®ç°ä¸€ä¸ª compare å‡½æ•°ï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒ<a href="https://www.jianshu.com/p/0828ded57b19#:~:text=%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%AF%94%E8%BE%83-,%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A,-//%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%B7%B1%E5%BA%A6" target="_blank" >è§</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * åŸç†ï¼š * 1. åŸºæœ¬æ•°æ®ç±»å‹æ¯”è¾ƒ * 2. å¤åˆç±»å‹ï¼Œé€’å½’æ¯ä¸ªå€¼ä¾æ¬¡æ¯”è¾ƒ **&#x2F;function deepCompare(a, b) &#123;  if (    a &#x3D;&#x3D;&#x3D; null ||    typeof a !&#x3D;&#x3D; &quot;object&quot; ||    b &#x3D;&#x3D;&#x3D; null ||    typeof b !&#x3D;&#x3D; &quot;object&quot; &#x2F;&#x2F; åŸºç¡€ç±»å‹&#x2F;nullçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç›´æ¥æ¯”è¾ƒ  ) &#123;    &#x2F;&#x2F; åŸºæœ¬æ•°æ®ç±»å‹    return a &#x3D;&#x3D;&#x3D; b;  &#125;  const propsA &#x3D; Object.getOwnPropertyDescriptors(a);  &#x2F;&#x2F; Object.getOwnPropertyDescriptors() æ–¹æ³•ç”¨æ¥è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰è‡ªèº«å±æ€§çš„æè¿°ç¬¦ã€‚  const propsB &#x3D; Object.getOwnPropertyDescriptors(b);  &#x2F;&#x2F; é”®æ˜¯å¦é•¿åº¦ä¸€è‡´  if (Object.keys(propsA).length !&#x3D;&#x3D; Object.keys(propsB).length) &#123;    return false;  &#125;  &#x2F;&#x2F; é”®é•¿åº¦ä¸€è‡´æƒ…å†µï¼Œæ¯”è¾ƒå€¼ï¼Œéœ€è¦æ¯ä¸ªéƒ½æ˜¯ç›¸ç­‰  return Object.keys(propsA).every((key) &#x3D;&gt; deepCompare(a[key], b[key]));&#125;</code></pre><h2 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; å»æŠ–åŠ¨åŸç†ï¼šåœ¨äº‹ä»¶è¢«è§¦å‘nç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™nç§’å†…åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶.&#x2F;&#x2F; æ–¹æ³•1const debounce &#x3D; function (fn, delay) &#123;  let timer &#x3D; null; &#x2F;&#x2F; é—­åŒ…ç»´æŠ¤ä¸€ä¸ªtimer  return (...args) &#x3D;&gt; &#123;    &#x2F;&#x2F; æŸ¯é‡ŒåŒ–    clearTimeout(timer);    timer &#x3D; setTimeout(() &#x3D;&gt; &#123;      fn?.apply(this, args); &#x2F;&#x2F; thisæŒ‡å‘window    &#125;, delay);  &#125;;&#125;;&#x2F;&#x2F; æµ‹è¯•let biu &#x3D; function () &#123;  console.log(&quot;biu biu biu&quot;, new Date().getTime());&#125;;let boom &#x3D; function () &#123;  console.log(&quot;boom boom boom&quot;, new Date().getTime());&#125;;var a &#x3D; setInterval(debounce(biu, 500), 1000);var b &#x3D; setInterval(debounce(boom, 2000), 1000);setTimeout(() &#x3D;&gt; &#123;  clearInterval(a);  clearInterval(b);&#125;, 10000);</code></pre><h2 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">const throttle &#x3D; (fn, delay &#x3D; 500) &#x3D;&gt; &#123;  let allow &#x3D; true; &#x2F;&#x2F; å®ˆé—¨å‘˜ï¼Œdelayç§’é’Ÿæ”¾è¿›å»ä¸€ä¸ªçƒ  return (...args) &#x3D;&gt; &#123;    if (!allow) return;    allow &#x3D; false;    setTimeout(() &#x3D;&gt; &#123;      fn.apply(this, args);      allow &#x3D; true;    &#125;, delay);  &#125;;&#125;;</code></pre><h2 id="call"><a href="#call" class="headerlink" title="call"></a>call</h2><ul><li>è¯­æ³•</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">function.call(thisArg, arg1, arg2, ...)</code></pre><ul><li>å‚æ•°<br><code>thisArg</code>å¯é€‰çš„ã€‚åœ¨ function å‡½æ•°è¿è¡Œæ—¶ä½¿ç”¨çš„ this å€¼ã€‚è¯·æ³¨æ„ï¼Œthis å¯èƒ½ä¸æ˜¯è¯¥æ–¹æ³•çœ‹åˆ°çš„å®é™…å€¼ï¼šå¦‚æœè¿™ä¸ªå‡½æ•°å¤„äºéä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™æŒ‡å®šä¸º null æˆ– undefined æ—¶ä¼šè‡ªåŠ¨æ›¿æ¢ä¸ºæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ŒåŸå§‹å€¼ä¼šè¢«åŒ…è£…ã€‚<br><code>arg1, arg2, ...</code> æŒ‡å®šçš„å‚æ•°åˆ—è¡¨ã€‚</li><li>è¿”å›å€¼<br>ä½¿ç”¨è°ƒç”¨è€…æä¾›çš„ this å€¼å’Œå‚æ•°è°ƒç”¨è¯¥å‡½æ•°çš„è¿”å›å€¼ã€‚è‹¥è¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™è¿”å› undefinedã€‚</li><li>å®ç°åŸç†</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Function.prototype.myCall &#x3D; function (context) &#123;  var context &#x3D; context || window;  context.fn &#x3D; this;  var args &#x3D; [];  for (var i &#x3D; 1, len &#x3D; arguments.length; i &lt; len; i++) &#123;    args.push(&quot;arguments[&quot; + i + &quot;]&quot;);  &#125;  var result &#x3D; eval(&quot;context.fn(&quot; + args + &quot;)&quot;);  delete context.fn;  return result;&#125;;</code></pre><h2 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h2><ul><li>è¯­æ³•</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">apply(thisArg);apply(thisArg, argsArray);</code></pre><ul><li>å‚æ•°</li></ul><p><code>thisArg</code>åœ¨ func å‡½æ•°è¿è¡Œæ—¶ä½¿ç”¨çš„ this å€¼ã€‚è¯·æ³¨æ„ï¼Œthis å¯èƒ½ä¸æ˜¯è¯¥æ–¹æ³•çœ‹åˆ°çš„å®é™…å€¼ï¼šå¦‚æœè¿™ä¸ªå‡½æ•°å¤„äºéä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™æŒ‡å®šä¸º null æˆ– undefined æ—¶ä¼šè‡ªåŠ¨æ›¿æ¢ä¸ºæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ŒåŸå§‹å€¼ä¼šè¢«åŒ…è£…ã€‚</p><p><code>argsArray</code> å¯é€‰,ä¸€ä¸ªæ•°ç»„æˆ–è€…ç±»æ•°ç»„å¯¹è±¡ï¼Œå…¶ä¸­çš„æ•°ç»„å…ƒç´ å°†ä½œä¸ºå•ç‹¬çš„å‚æ•°ä¼ ç»™ func å‡½æ•°ã€‚å¦‚æœè¯¥å‚æ•°çš„å€¼ä¸º null æˆ– undefinedï¼Œåˆ™è¡¨ç¤ºä¸éœ€è¦ä¼ å…¥ä»»ä½•å‚æ•°ã€‚ä» ECMAScript 5 å¼€å§‹å¯ä»¥ä½¿ç”¨ç±»æ•°ç»„å¯¹è±¡ã€‚æµè§ˆå™¨å…¼å®¹æ€§è¯·å‚é˜…æœ¬æ–‡åº•éƒ¨å†…å®¹ã€‚</p><ul><li>è¿”å›å€¼</li></ul><p>è°ƒç”¨æœ‰æŒ‡å®š this å€¼å’Œå‚æ•°çš„å‡½æ•°çš„ç»“æœã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Function.prototype.myApply &#x3D; function (context, arr) &#123;  var context &#x3D; context || window;  context.fn &#x3D; this;  var result;  if (!arr) &#123;    &#x2F;&#x2F; æ²¡æœ‰å‚æ•°    result &#x3D; context.fn();  &#125; else &#123;    &#x2F;&#x2F; æœ‰å‚æ•°    var args &#x3D; [];    for (let i &#x3D; 0, len &#x3D; arr.length; i &lt; len; i++) &#123;      args.push(&quot;arr[&quot; + i + &quot;]&quot;);    &#125;    result &#x3D; eval(&quot;context.fn(&quot; + args + &quot;)&quot;);  &#125;  delete context.fn;  return result;&#125;;</code></pre><h2 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h2><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p><a href="https://blog.csdn.net/weixin_45774485/article/details/122462081" target="_blank" >æ‰‹å†™ promise çš„æ–¹æ³•ï¼ˆallã€raceã€allSettledã€anyã€finallyï¼‰</a></p><h3 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h3><ul><li>è¦ä¹ˆè¿”å›å…¨éƒ¨ resolve ç»“æœï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ª reject</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise.myAll &#x3D; function (promises) &#123;  return new Promise((resolve, reject) &#x3D;&gt; &#123;    let res &#x3D; [];    promises.forEach((promise, index) &#x3D;&gt; &#123;      Promise.resolve(promise) &#x2F;&#x2F; é˜²æ­¢ä½ ä¸æ˜¯ä¸€ä¸ªpromise        &#x2F;&#x2F; å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼,æˆ–è€…æ˜¯ä¸€ä¸ªä¸å…·æœ‰thenæ–¹æ³•çš„å¯¹è±¡,åˆ™Promise.resolveæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡,çŠ¶æ€ä¸ºresolved        &#x2F;&#x2F; @link https:&#x2F;&#x2F;wenku.baidu.com&#x2F;view&#x2F;8bf2d73451d380eb6294dd88d0d233d4b14e3fef.html        .then((data) &#x3D;&gt; &#123;          res.push(data);          if (index &#x3D;&#x3D;&#x3D; promises.length - 1) &#123;            &#x2F;&#x2F; æ‰€æœ‰çš„éƒ½æ²¡æœ‰å¼‚å¸¸            resolve(res);          &#125;        &#125;)        .catch((err) &#x3D;&gt; &#123;          &#x2F;&#x2F; æ•è·ï¼Œç›´æ¥è¿”å›          reject(err);        &#125;);    &#125;);  &#125;);&#125;;</code></pre><h3 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race"></a>Promise.race</h3><ul><li>ä¸ç®¡ resolve, rejectï¼Œè§åˆ°å°±è¿”å›</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise.myRace &#x3D; (promises) &#x3D;&gt;  return new Promise((resolve, reject) &#x3D;&gt; &#123;    promises?.forEach((promise) &#x3D;&gt; &#123;      promise.then(resolve, reject);    &#125;);  &#125;);</code></pre><h3 id="Promise-allSettle"><a href="#Promise-allSettle" class="headerlink" title="Promise.allSettle"></a>Promise.allSettle</h3><ul><li>å…¨éƒ¨ç»“æœï¼Œresolve, reject éƒ½è¦</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise.myAllSettled &#x3D; function (promises) &#123;  let len &#x3D; promises.length;  let result &#x3D; new Array(len);  let count &#x3D; 0;  return new Promise((resolve, reject) &#x3D;&gt; &#123;    for (let p of promises) &#123;      Promise.resolve(p).then(        (res) &#x3D;&gt; &#123;          &#x2F;&#x2F;æˆåŠŸï¼šåŠ å…¥è£…çŠ¶æ€åˆ—è¡¨          result[count] &#x3D; &#123;            &#x2F;&#x2F;è®°å½•å½“å‰promiseä¿¡æ¯            status: &quot;fullfilled&quot;,            result: res,          &#125;;          if (++count &#x3D;&#x3D; len) &#123;            &#x2F;&#x2F;éå†å®Œï¼Œèµ°resolve            resolve(result);          &#125;        &#125;,        (err) &#x3D;&gt; &#123;          &#x2F;&#x2F;å¤±è´¥ï¼šåŠ å…¥çŠ¶æ€åˆ—è¡¨          result[count] &#x3D; &#123;            &#x2F;&#x2F;è®°å½•å½“å‰promiseçŠ¶æ€ä¿¡æ¯            status: &quot;rejected&quot;,            result: err,          &#125;;          if (++count &#x3D;&#x3D; len) &#123;            &#x2F;&#x2F;éå†å®Œä¾ç„¶èµ°resolve            reject(result);          &#125;        &#125;      );    &#125;  &#125;);&#125;;</code></pre><h3 id="Promise-any"><a href="#Promise-any" class="headerlink" title="Promise.any"></a>Promise.any</h3><ul><li>è¦ä¹ˆæ²¡æœ‰ resolve çš„,è¿”å›å…¨éƒ¨ reject ç»“æœï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ª resolve çš„è¿”å› resolve ç»“æœ(çœ‹ä¸Šå»å’Œ<code>Promise.all</code>åˆšå¥½åè¿‡æ¥äº†)</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise.myAny &#x3D; function (promises) &#123;  let res &#x3D; [],    count &#x3D; 0,    len &#x3D; promises.length;  return new Promise((resolve, reject) &#x3D;&gt; &#123;    for (let p of promises) &#123;      Promise.resolve(p).then(        (res) &#x3D;&gt; &#123;          resolve(res); &#x2F;&#x2F; åªè¦æœ‰ä¸€ä¸ªæˆåŠŸï¼Œå°±èµ°resolve        &#125;,        (err) &#x3D;&gt; &#123;          res[count] &#x3D; err; &#x2F;&#x2F; é‡åˆ°é”™è¯¯å…ˆä¸ç®¡ï¼Œç»§ç»­æ£€æŸ¥          if (++count &#x3D;&#x3D; len) &#123;            &#x2F;&#x2F; ç›´åˆ°é‡åˆ°æˆåŠŸçš„æˆ–æ£€æŸ¥å®Œ            reject(res);          &#125;        &#125;      );    &#125;  &#125;);&#125;;</code></pre><h3 id="Promise-finally"><a href="#Promise-finally" class="headerlink" title="Promise.finally"></a>Promise.finally</h3><ul><li>æ— è®ºå“ªä¸ªæ‰§è¡Œå®Œï¼Œå›è°ƒä¸‹</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise.prototype.myFinally &#x3D; function (cb) &#123;  &#x2F;&#x2F;cbå°±æ˜¯è¦å…±åŒæ‰§è¡Œçš„é€»è¾‘  return this.then(    &#x2F;&#x2F;è°è°ƒç”¨finallyï¼Œthiså°±æ˜¯è°    (value) &#x3D;&gt; Promise.resolve(cb()), &#x2F;&#x2F;ä¸ç®¡è°ƒç”¨finallyçš„promiseæ˜¯ä»€ä¹ˆçŠ¶æ€éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªcb    (error) &#x3D;&gt; Promise.resolve(cb()) &#x2F;&#x2F;ä¸ç®¡è°ƒç”¨finallyçš„promiseæ˜¯ä»€ä¹ˆçŠ¶æ€éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªcb  );&#125;;</code></pre><h3 id="Promise-resolve"><a href="#Promise-resolve" class="headerlink" title="Promise.resolve"></a>Promise.resolve</h3><ul><li>æ— è®ºå“ªä¸ªæ‰§è¡Œå®Œï¼Œå›è°ƒä¸‹</li></ul><p><a href="https://wenku.baidu.com/view/8bf2d73451d380eb6294dd88d0d233d4b14e3fef.html" target="_blank" >è§ Promise.resolveï¼ˆï¼‰è¯¦è§£</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise.prototype.myResolve &#x3D; function (params) &#123;  return new Promise((resolve) &#x3D;&gt; resolve(params));&#125;;</code></pre><h2 id="ä½¿ç”¨-Promise-è¿‡ç¨‹ä¸­-resolve-æˆ–-reject-åï¼Œåé¢ä»£ç è¿˜ä¼šæ‰§è¡Œï¼Œé»˜è®¤åŠ -return-è¾ƒå¦¥"><a href="#ä½¿ç”¨-Promise-è¿‡ç¨‹ä¸­-resolve-æˆ–-reject-åï¼Œåé¢ä»£ç è¿˜ä¼šæ‰§è¡Œï¼Œé»˜è®¤åŠ -return-è¾ƒå¦¥" class="headerlink" title="ä½¿ç”¨ Promise è¿‡ç¨‹ä¸­ resolve æˆ– reject åï¼Œåé¢ä»£ç è¿˜ä¼šæ‰§è¡Œï¼Œé»˜è®¤åŠ  return è¾ƒå¦¥"></a>ä½¿ç”¨ Promise è¿‡ç¨‹ä¸­ resolve æˆ– reject åï¼Œåé¢ä»£ç è¿˜ä¼šæ‰§è¡Œï¼Œé»˜è®¤åŠ  return è¾ƒå¦¥</h2><p><a href="https://www.freesion.com/article/68121031859/" target="_blank" >ä½¿ç”¨ Promise è¿‡ç¨‹ä¸­ resolve æˆ– reject åï¼Œåé¢ä»£ç è¿˜ä¼šæ‰§è¡Œï¼Œé»˜è®¤åŠ  return è¾ƒå¦¥</a></p><h2 id="é™åˆ¶å¹¶å‘æ•°é‡"><a href="#é™åˆ¶å¹¶å‘æ•°é‡" class="headerlink" title="é™åˆ¶å¹¶å‘æ•°é‡"></a>é™åˆ¶å¹¶å‘æ•°é‡</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; åŸç†ï¼šå°†åœ¨ç”¨æ•°é‡ï¼Œé™åˆ¶åœ¨æœ€å¤§æ•°é‡å†…çš„å¼‚æ­¥ç›´æ¥å‘ï¼Œ&#x2F;&#x2F; é™åˆ¶å¤–çš„ç°å­˜åˆ°æ•°ç»„ä¸­ï¼Œå½“åœ¨ç”¨æ•°é‡å‡å°‘æ—¶ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥è¿è¡Œexport class LimitPromise &#123;  private limit: number;        &#x2F;&#x2F; æœ€å¤§é™åˆ¶æ•°  private count: number;        &#x2F;&#x2F; ç›®å‰å¹¶å‘çš„æ•°é‡  private taskQueue: any[];     &#x2F;&#x2F; å¦‚æœå¹¶å‘æ•°ç­‰äºæœ€å¤§é™åˆ¶ï¼Œåˆ™æŠŠæ–°åŠ çš„å¼‚æ­¥æ“ä½œç”¨æ•°ç»„å­˜èµ·æ¥  constructor(limit: number) &#123;    this.limit &#x3D; limit;    this.count &#x3D; 0;    this.taskQueue &#x3D; [];  &#125;  &#x2F;&#x2F; ç®¡ç†ä»»åŠ¡æ‰§è¡Œ  private createTask(    asyncFn: Function,    args: any[],    resolve: (value: unknown) &#x3D;&gt; void,    reject: (reason?: any) &#x3D;&gt; void,  ) &#123;    return () &#x3D;&gt; &#123;      asyncFn(...args)        .then(resolve)        .catch(reject)        .finally(() &#x3D;&gt; &#123;          this.count--; &#x2F;&#x2F; ä»»åŠ¡ç»“æŸåï¼Œå¯¹ä»»åŠ¡é˜Ÿåˆ—è¿›è¡Œå‡ºåˆ—ï¼Œæ‰§è¡Œ          if (this.taskQueue.length) &#123;            let task &#x3D; this.taskQueue.shift();            task();          &#125;        &#125;);      this.count++; &#x2F;&#x2F; åœ¨æ‰§è¡Œçš„æ•°é‡    &#125;;  &#125;  &#x2F;&#x2F; ç®¡ç†é˜Ÿåˆ—  public call(asyncFn: Function, ...args: any[]) &#123;    return new Promise((resolve, reject) &#x3D;&gt; &#123; &#x2F;&#x2F; è¿™å±‚promiseä»¤äººè´¹è§£ï¼Œä¸»è¦æ˜¯ä¸ºäº†æä¾›resolveå’Œrejectç»™ limitP.callï¼Œè¿™æ ·limitPå¯ä»¥åšäº›å…¶ä»–çš„äº‹æƒ…ï¼Œç†è®ºä¸Šæ²¡æœ‰å¿…è¦      const task &#x3D; this.createTask(asyncFn, args, resolve, reject); &#x2F;&#x2F; åˆ›å»ºä»»åŠ¡      if (this.count &gt;&#x3D; this.limit) &#123; &#x2F;&#x2F; å¤§äºé™åˆ¶çš„å­˜èµ·æ¥        this.taskQueue.push(task);      &#125; else &#123; &#x2F;&#x2F; å¦åˆ™ç›´æ¥æ‰§è¡Œ        task();      &#125;    &#125;);  &#125;&#125;let limitP &#x3D; new LimitPromise(3)&#x2F;&#x2F; æµ‹è¯•function sleep(sec: number) &#123;  console.log(&#39;..............&#39;);  return new Promise((resolve, reject) &#x3D;&gt; &#123;    setTimeout(() &#x3D;&gt; &#123;      console.log(&#39;ç­‰å¾…äº†&#39; + sec + &#39;ç§’&#39;);      resolve(&#39;&#39;);    &#125;, sec * 1000);  &#125;);&#125;limitP.call(sleep, 1);limitP.call(sleep, 2);limitP.call(sleep, 3);limitP.call(sleep, 4);limitP.call(sleep, 5);limitP.call(sleep, 6);&#x2F;&#x2F; https:&#x2F;&#x2F;stackblitz.com&#x2F;edit&#x2F;typescript-sdhev3?file&#x3D;index.ts</code></pre><h2 id="æ•°ç»„å»é‡"><a href="#æ•°ç»„å»é‡" class="headerlink" title="æ•°ç»„å»é‡"></a>æ•°ç»„å»é‡</h2><p><a href="https://blog.csdn.net/weixin_45663702/article/details/123504807" target="_blank" >å¸¸è§å‰ç«¯é¢è¯•é¢˜â€“æ•°ç»„å»é‡</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; æ–¹æ¡ˆ1:function unique(arr) &#123;  return Array.from(new Set(arr));&#125;let arr &#x3D; [  1,  1,  &quot;true&quot;,  true,  true,  15,  15,  false,  false,  undefined,  undefined,  null,  null,  NaN,  NaN,  &quot;NaN&quot;,  0,  0,  &quot;a&quot;,  &quot;a&quot;,  &#123;&#125;,  &#123;&#125;,];console.log(unique(arr));&#x2F;&#x2F; [&#39;1&#39;, &#39;true&#39;, true, 15, undefined, null, null, NaN, &#39;NaN&#39;, 0, &#39;a&#39;, &#123;&#125;, &#123;&#125;]&#x2F;&#x2F;æ— æ³•å»æ‰&#39;&#123;&#125;&#39;ç©ºå¯¹è±¡&#x2F;&#x2F; æ–¹æ¡ˆ2:function unique(arr) &#123;  return arr.filter(function (item, index, arr) &#123;    &#x2F;&#x2F; å½“å‰å…ƒç´ ï¼Œåœ¨åŸå§‹æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªç´¢å¼•&#x3D;&#x3D;å½“å‰ç´¢å¼•å€¼ï¼Œå¦åˆ™è¿”å›å½“å‰å…ƒç´     return arr.indexOf(item, 0) &#x3D;&#x3D;&#x3D; index;  &#125;);&#125;let arr &#x3D; [  1,  1,  &quot;true&quot;,  true,  true,  15,  15,  false,  false,  undefined,  undefined,  null,  null,  NaN,  NaN,  &quot;NaN&quot;,  0,  0,  &quot;a&quot;,  &quot;a&quot;,  &#123;&#125;,  &#123;&#125;,];console.log(unique(arr));&#x2F;&#x2F; [1, &#39;true&#39;, true, 15, false, undefined, null, &#39;NaN&#39;, 0, &#39;a&#39;, &#123;&#125;, &#123;&#125;]&#x2F;&#x2F; &#123;&#125;ä¸èƒ½å»é‡&#x2F;&#x2F; æ–¹æ¡ˆ3:function unique(arr) &#123;  return arr.reduce(    (prev, cur) &#x3D;&gt; (prev.includes(cur) ? prev : [...prev, cur]),    []  );&#125;let arr &#x3D; [  1,  1,  &quot;true&quot;,  true,  true,  15,  15,  false,  false,  undefined,  undefined,  null,  null,  NaN,  NaN,  &quot;NaN&quot;,  0,  0,  &quot;a&quot;,  &quot;a&quot;,  &#123;&#125;,  &#123;&#125;,];console.log(unique(arr));&#x2F;&#x2F; [1, &#39;true&#39;, true, 15, false, undefined, null, NaN, &#39;NaN&#39;, 0, &#39;a&#39;, &#123;&#125;, &#123;&#125;]</code></pre><h2 id="å°†å¥‡æ•°æ’åœ¨å‰é¢ï¼Œå¶æ•°æ’åœ¨åé¢ã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦-O-n-ã€‚ç©ºé—´å¤æ‚åº¦-O-1-ï¼ˆä¸èƒ½ç”¨-spliceï¼‰"><a href="#å°†å¥‡æ•°æ’åœ¨å‰é¢ï¼Œå¶æ•°æ’åœ¨åé¢ã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦-O-n-ã€‚ç©ºé—´å¤æ‚åº¦-O-1-ï¼ˆä¸èƒ½ç”¨-spliceï¼‰" class="headerlink" title="å°†å¥‡æ•°æ’åœ¨å‰é¢ï¼Œå¶æ•°æ’åœ¨åé¢ã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦ O(n)ã€‚ç©ºé—´å¤æ‚åº¦ O(1)ï¼ˆä¸èƒ½ç”¨ spliceï¼‰"></a>å°†å¥‡æ•°æ’åœ¨å‰é¢ï¼Œå¶æ•°æ’åœ¨åé¢ã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦ O(n)ã€‚ç©ºé—´å¤æ‚åº¦ O(1)ï¼ˆä¸èƒ½ç”¨ spliceï¼‰</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var testAry &#x3D; [1, 2, 3, 4, 5, 6, 7, 8, 9];var newAry &#x3D; [];testAry.forEach((item, i) &#x3D;&gt; &#123;  let n &#x3D; Number(item);  if (n % 2 &#x3D;&#x3D; 0) &#123;    newAry.push(n);  &#125; else &#123;    newAry.unshift(n);  &#125;&#125;);console.log(newAry); &#x2F;&#x2F;[&quot;9&quot;,&quot;7&quot;,&quot;5&quot;,&quot;3&quot;,&quot;1&quot;,&quot;2&quot;,&quot;4&quot;,&quot;6&quot;]</code></pre><h2 id="æ•°ç»„è½¬æ ‘ç»“æ„"><a href="#æ•°ç»„è½¬æ ‘ç»“æ„" class="headerlink" title="æ•°ç»„è½¬æ ‘ç»“æ„"></a>æ•°ç»„è½¬æ ‘ç»“æ„</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">const arr &#x3D; [    &#123; id: 1, pid: 0 &#125;,    &#123; id: 2, pid: 1 &#125;,    &#123; id: 3, pid: 1 &#125;,    &#123; id: 4, pid: 2 &#125;,    &#123; id: 5, pid: 2 &#125;,    &#123; id: 6, pid: 3 &#125;,];&#x2F;&#x2F; è¦æ±‚ç¼–å†™ä¸€ä¸ªå‡½æ•° arr2tree(arr)ï¼Œå¾—åˆ°è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&#123;    &quot;id&quot;: 0,    &quot;children&quot;: [        &#123;            &quot;id&quot;: 1,            &quot;children&quot;: [                &#123;                    &quot;id&quot;: 2,                    &quot;children&quot;: [                        &#123;                            &quot;id&quot;: 4                        &#125;,                        &#123;                            &quot;id&quot;: 5                        &#125;                    ]                &#125;,                &#123;                    &quot;id&quot;: 3,                    &quot;children&quot;: [                        &#123;                            &quot;id&quot;: 6                        &#125;                    ]                &#125;            ]        &#125;    ]&#125;</code></pre><p><strong>å®ç°</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function arr2tree(arr) &#123;  let hash &#x3D; &#123;&#125;;  const result &#x3D; [];  &#x2F;&#x2F; æ”¾åˆ°å¯¹è±¡ä¸­  for (let item of arr) &#123;    hash[item.id] &#x3D; item;  &#125;  for (let item of arr) &#123;    const parent &#x3D; hash[item.pid];    if (parent) &#123;      if (!parent.children) &#123;        parent.children &#x3D; [];      &#125;      delete item.pid; &#x2F;&#x2F; æ¯”ç»“æœå¤šçš„å­—æ®µåˆ é™¤      parent.children.push(item); &#x2F;&#x2F; ä¹‹æ‰€ä»¥èƒ½å¤Ÿå®ç°ï¼ŒåŸå› ï¼šä½¿ç”¨äº†æ•°ç»„å¼•ç”¨    &#125; else &#123;      delete item.pid; &#x2F;&#x2F; æ¯”ç»“æœå¤šçš„å­—æ®µåˆ é™¤      result.push(item); &#x2F;&#x2F; åªæœ‰ç¬¬ä¸€æ¬¡pid &#x3D; 0çš„æ—¶å€™ï¼Œæ ‘æ ¹èŠ‚ç‚¹æ‰èµ°è¿™é‡Œ    &#125;  &#125;  hash &#x3D; undefined; &#x2F;&#x2F; è¿™é‡Œè®°å¾—å›æ”¶  return result;&#125;const res &#x3D; arr2tree(arr);console.log(&quot;res&quot;, JSON.stringify(res, null, 2));</code></pre><h2 id="è§£æ-URL-ä¸­æ‰€æœ‰çš„éƒ¨åˆ†"><a href="#è§£æ-URL-ä¸­æ‰€æœ‰çš„éƒ¨åˆ†" class="headerlink" title="è§£æ URL ä¸­æ‰€æœ‰çš„éƒ¨åˆ†"></a>è§£æ URL ä¸­æ‰€æœ‰çš„éƒ¨åˆ†</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function parseParam(url) &#123;  const paramsStr &#x3D; &#x2F;.+\?(.+)$&#x2F;.exec(url)[1]; &#x2F;&#x2F; ?ä¹‹åéƒ¨åˆ†æˆªå–  const paramsArr &#x3D; paramsStr.split(&quot;&amp;&quot;); &#x2F;&#x2F; æ‹†åˆ†kvå¯¹  let paramsObj &#x3D; &#123;&#125;;  paramsArr.forEach((param) &#x3D;&gt; &#123;    if (&#x2F;&#x3D;&#x2F;.test(param)) &#123;      &#x2F;&#x2F;      let [key, val] &#x3D; param.split(&quot;&#x3D;&quot;);      val &#x3D; decodeURIComponent(val); &#x2F;&#x2F; è§£ç       val &#x3D; &#x2F;^\d+$&#x2F;.test(val) ? parseFloat(val) : val; &#x2F;&#x2F; å­—ç¬¦ä¸²æ•°å€¼è½¬åŒ–      if (paramsObj.hasOwnProperty(key)) &#123;        paramsObj[key] &#x3D; [].concat(paramsObj[key], val); &#x2F;&#x2F; è¿™ä¸ªæ²¡æœ‰ç›´æ¥push, åˆ©ç”¨concatç‰¹æ€§ï¼ˆæ•°ç»„concat,éæ•°ç»„pushï¼‰      &#125; else &#123;        paramsObj[key] &#x3D; val;      &#125;    &#125; else &#123;      &#x2F;&#x2F; æœ‰äº›æ²¡æœ‰&#x3D;å·      paramsObj[param] &#x3D; true;    &#125;  &#125;);  return paramsObj;&#125;</code></pre><!-- ## ä½¿ç”¨ es5 å®ç° es6 çš„ let å…³é”®å­—<a href="https://blog.csdn.net/weixin_44242181/article/details/124340622" target="_blank" >es5 å®ç° es6+æ–°ç‰¹æ€§</a> --><h2 id="ä¸­åˆ’çº¿è½¬å¤§å†™"><a href="#ä¸­åˆ’çº¿è½¬å¤§å†™" class="headerlink" title="ä¸­åˆ’çº¿è½¬å¤§å†™"></a>ä¸­åˆ’çº¿è½¬å¤§å†™</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var str &#x3D; &quot;get-user-by-id&quot;;var f &#x3D; function (s) &#123;  return s.replace(&#x2F;-\w&#x2F;g, function (x) &#123;    return x.slice(1).toUpperCase();  &#125;);&#125;;</code></pre><h2 id="é‡‘é¢åƒåˆ†"><a href="#é‡‘é¢åƒåˆ†" class="headerlink" title="é‡‘é¢åƒåˆ†"></a>é‡‘é¢åƒåˆ†</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function parseToMoney(num) &#123;  num &#x3D; parseFloat(num).toFixed(3);  let [integer, decimal] &#x3D; String.prototype.split.call(num, &quot;.&quot;);  integer &#x3D; integer.replace(&#x2F;\d(?&#x3D;(\d&#123;3&#125;)+$)&#x2F;g, &quot;$&amp;,&quot;);  &#x2F;&#x2F; ä»å³åˆ°å·¦â€œä¸‰ä¸ªæ•°å€¼ä¸€ç»„â€ ?&#x3D; å°½å¯èƒ½å¤šçš„å»åŒ¹é…  return &#96;$&#123;integer&#125;.$&#123;decimal&#125;&#96;;&#125;console.log(parseToMoney(10000000.0));&#x2F;&#x2F; $&amp; ä¸regexpç›¸åŒ¹é…çš„å­ä¸²ã€‚ &#x2F;&#x2F; https:&#x2F;&#x2F;q.cnblogs.com&#x2F;q&#x2F;63769&#x2F;</code></pre><h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><p><a href="http://v.aijs.top/post/2022-06-16interview#:~:text=new%20%E5%92%8C%20Object.create%20%E9%83%BD%E6%98%AF%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%84%8F%E6%80%9D%EF%BC%8C%E4%BA%8C%E8%80%85%E6%9C%89%E5%95%A5%E5%8C%BA%E5%88%AB%E5%91%A2%EF%BC%9F" target="_blank" >è§</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function myNew() &#123;  let obj &#x3D; &#123;&#125;;  let func &#x3D; [].shift.call(arguments); &#x2F;&#x2F;å‡ºåˆ—ï¼Œè·å–ç¬¬ä¸€ä¸ªå‚æ•°  obj.__proto__ &#x3D; func.prototype; &#x2F;&#x2F;protoæŒ‡å‘åŸå‹  func.apply(obj, arguments); &#x2F;&#x2F;è®©objæ‰§è¡Œfuncå‡½æ•°  return obj;&#125;</code></pre><h2 id="Object-create"><a href="#Object-create" class="headerlink" title="Object.create"></a>Object.create</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function myCreate(obj) &#123;  let F &#x3D; function () &#123;&#125;;  F.prototype &#x3D; obj;  return new F();&#125;</code></pre><h2 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">function instance_of(L, R) &#123;  var O &#x3D; R.prototype; &#x2F;&#x2F; å–Rçš„æ˜¾ç¤ºåŸå‹  L &#x3D; L.__proto__; &#x2F;&#x2F; å–Lçš„éšå¼åŸå‹  while (true) &#123;    &#x2F;&#x2F; æ­»å¾ªç¯ï¼Œç»“æŸæ¡ä»¶ï¼šè¦ä¹ˆæ‰¾åˆ°ï¼Œè¦ä¹ˆæ²¡æ‰¾åˆ°    if (L &#x3D;&#x3D;&#x3D; null) return false;    if (O &#x3D;&#x3D;&#x3D; L) &#123;      &#x2F;&#x2F; è¿™é‡Œé‡ç‚¹ï¼šå½“Oä¸¥æ ¼ç­‰äºLæ—¶ï¼Œè¿”å›true      return true;    &#125;    L &#x3D; L.__proto__;  &#125;&#125;</code></pre><h2 id="æŸ¯é‡ŒåŒ–"><a href="#æŸ¯é‡ŒåŒ–" class="headerlink" title="æŸ¯é‡ŒåŒ–"></a>æŸ¯é‡ŒåŒ–</h2><p><a href="https://article.itxueyuan.com/46m5K2" target="_blank" >è§</a><br>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰<code>æ˜¯æŠŠæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æ¢æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°(æœ€åˆå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°)çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°ä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯</code>ã€‚è¿™ä¸ªæŠ€æœ¯ä»¥é€»è¾‘å­¦å®¶ Haskell Curry å‘½åçš„ã€‚</p><ul><li>æŸ¯é‡ŒåŒ–çªå‡ºä¸€ç§é‡è¦æ€æƒ³ï¼š<code>é™ä½é€‚ç”¨èŒƒå›´</code>ï¼Œ<code>æé«˜é€‚ç”¨æ€§</code></li><li>æŸ¯é‡ŒåŒ–çš„ä¸‰ä¸ªä½œç”¨å’Œç‰¹ç‚¹ï¼š<code>å‚æ•°å¤ç”¨</code>ã€<code>æå‰è¿”å›</code>ã€<code>å»¶è¿Ÿæ‰§è¡Œ</code></li><li>æŸ¯é‡ŒåŒ–æ˜¯é—­åŒ…çš„ä¸€ä¸ªå…¸å‹åº”ç”¨ï¼Œ<code>åˆ©ç”¨é—­åŒ…å½¢æˆäº†ä¸€ä¸ªä¿å­˜åœ¨å†…å­˜ä¸­çš„ä½œç”¨åŸŸï¼ŒæŠŠæ¥æ”¶åˆ°çš„éƒ¨åˆ†å‚æ•°ä¿å­˜åœ¨è¿™ä¸ªä½œç”¨åŸŸä¸­ï¼Œç­‰å¾…åç»­ä½¿ç”¨</code>ã€‚å¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°å‡½æ•°æ¥æ”¶å‰©ä½™å‚æ•°</li></ul><p><a href="https://juejin.cn/post/6844903814139478030" target="_blank" >å‡½æ•°æŸ¯é‡ŒåŒ–å’Œåå‡½æ•°åº”ç”¨</a></p><ul><li><p>æŸ¯é‡ŒåŒ–å’Œåå‡½æ•°éƒ½æ˜¯ç”¨äºå°†å¤šä¸ªå‚æ•°å‡½æ•°ï¼Œè½¬åŒ–ä¸ºæ¥å—æ›´å°‘å‚æ•°å‡½æ•°çš„æ–¹æ³•ã€‚ä¼ å…¥éƒ¨åˆ†å‚æ•°åï¼Œå¤„äºä¸­é—´çŠ¶æ€çš„å‡½æ•°å¯ä»¥ä½œä¸ºå›ºå®šå€¼è¿›è¡Œå¤ç”¨ã€‚ä½†æ˜¯å…¶ä¸­ä¸åŒä¹‹å¤„åœ¨äºï¼š</p></li><li><p><code>æŸ¯é‡ŒåŒ–</code>æ˜¯å°†å‡½æ•°è½¬åŒ–ä¸ºå¤šä¸ªåµŒå¥—çš„ä¸€å…ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ã€‚</p></li><li><p><code>åå‡½æ•°</code>å¯ä»¥æ¥å—ä¸åªä¸€ä¸ªå‚æ•°ï¼Œå®ƒè¢«å›ºå®šäº†éƒ¨åˆ†å‚æ•°ä½œä¸ºé¢„è®¾ï¼Œå¹¶å¯ä»¥æ¥å—å‰©ä½™çš„å‚æ•°</p></li></ul><p>ä½œè€…ï¼šLanceT<br>é“¾æ¥ï¼š<a href="https://juejin.cn/post/6844903814139478030">https://juejin.cn/post/6844903814139478030</a><br>æ¥æºï¼šç¨€åœŸæ˜é‡‘<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><h2 id="uuid"><a href="#uuid" class="headerlink" title="uuid"></a>uuid</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">const getUniqueID &#x3D; ((id) &#x3D;&gt; (() &#x3D;&gt; &#123;  id +&#x3D; 1;  return id;&#125;))(-1);&#x2F;&#x2F; getUniqueID&#x2F;&#x2F; () &#x3D;&gt; &#123;&#x2F;&#x2F;   id +&#x3D; 1;&#x2F;&#x2F;   return id;&#x2F;&#x2F; &#125;</code></pre><h2 id="æ´‹è‘±æ¨¡å‹"><a href="#æ´‹è‘±æ¨¡å‹" class="headerlink" title="æ´‹è‘±æ¨¡å‹"></a>æ´‹è‘±æ¨¡å‹</h2><p><a href="https://github.com/841660202/redux/blob/2edd0363271af46e327e118f3d92e78e258bf0cd/src/compose.ts#L46" target="_blank" >redux compose æºç </a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function compose(...funcs: Function[]) &#123;  if (funcs.length &#x3D;&#x3D;&#x3D; 0) &#123;    &#x2F;&#x2F; infer the argument type so it is usable in inference down the line    return &lt;T&gt;(arg: T) &#x3D;&gt; arg;  &#125;  if (funcs.length &#x3D;&#x3D;&#x3D; 1) &#123;    return funcs[0];  &#125;  return funcs.reduce(    (a, b) &#x3D;&gt;      (...args: any) &#x3D;&gt;        a(b(...args))  );  &#x2F;&#x2F; return funcs.reduce((a, b) &#x3D;&gt;(...args: any) &#x3D;&gt;a(b(...args)));&#125;</code></pre><h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>æœ¬è´¨æ˜¯ä¸€ä¸ª hack,åˆ©ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾ä¸å—åŒæºä¾§éœ²é™åˆ¶çš„ç‰¹æ€§è¿›è¡Œè·¨åŸŸæ“ä½œ</p><p><a href="https://blog.csdn.net/weixin_42371354/article/details/104651961" target="_blank" >å‚è€ƒé“¾æ¥</a><br><a href="https://blog.csdn.net/qq_38800316/article/details/120440865" target="_blank" >jsonp å‡½æ•°å°è£…</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; 1. ç”Ÿæˆä¸ªå‡½æ•°å&#x2F;&#x2F; 2. æ•´ç†å‚æ•°ï¼Œç”Ÿæˆè¯·æ±‚url&#x2F;&#x2F; 3. åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾ï¼Œå¹¶æŒ‚è½½&#x2F;&#x2F; 4. åŠ è½½å®Œæˆåç§»é™¤scriptæ ‡ç­¾function jsonP(&#123; url, params, success &#125;) &#123;  &#x2F;&#x2F; åœ¨å‚æ•°é‡Œåˆ¶å®šcallbackçš„åå­—  params &#x3D; params || &#123;&#125;;  &#x2F;&#x2F; é¢„ç•™callback  const funcName &#x3D; &quot;func&quot; + Math.random().toString().replace(&quot;.&quot;, &quot;&quot;);  &#x2F;&#x2F; è¿™æ ·ä¾èµ–ï¼ŒæœåŠ¡å™¨ç«¯ä¸€ä¸ªreq.query.callbackå°±å¯ä»¥è·å–åˆ°åŠ¨æ€çš„å‡½æ•°å  params.callback &#x3D; funcName;  window[funcName] &#x3D; success;  &#x2F;&#x2F; æ‹¼æ¥å‚æ•°å­—ç¬¦ä¸²  const paramKeys &#x3D; Object.keys(params);  const paramString &#x3D; paramKeys.map((key) &#x3D;&gt; &#96;$&#123;key&#125;&#x3D;$&#123;params[key]&#125;&#96;).join(&quot;&amp;&quot;);  &#x2F;&#x2F; æ’å…¥domå…ƒç´   const script &#x3D; document.createElement(&quot;script&quot;);  script.setAttribute(&quot;src&quot;, &#96;$&#123;url&#125;?$&#123;paramString&#125;&#96;);  document.body.appendChild(script);  &#x2F;&#x2F; ç›‘å¬scriptæ ‡ç­¾çš„onloadäº‹ä»¶ï¼Œå½“scriptæ ‡ç­¾æ‰§è¡Œåå°†å…¶åˆ é™¤ï¼Œé¿å…ä»£ç ç»“æ„çš„å†—ä½™  script.onload &#x3D; function () &#123;    &#x2F;&#x2F; ä»bodyçš„åˆ é™¤æ‰æ·»åŠ çš„scriptæ ‡ç­¾    document.body.removeChild(script);  &#125;;&#125;&#x2F;&#x2F; ä½¿ç”¨jsonP(&#123;  url: &quot;https:&#x2F;&#x2F;example.com&#x2F;ajax&#x2F;jsonp&#x2F;suggestion&quot;,  params: &#123;    key: &quot;test&quot;,  &#125;,  success(result) &#123;    console.log(result.data);  &#125;,&#125;);</code></pre><h2 id="å®ç°-event-bus"><a href="#å®ç°-event-bus" class="headerlink" title="å®ç° event bus"></a>å®ç° event bus</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">class EventBus &#123;  constructor() &#123;    this.events &#x3D; &#123;&#125;;  &#125;  &#x2F;&#x2F; ç›‘å¬ï¼Œç»™å¯¹è±¡æ·»åŠ æ–¹æ³•  on(name, callback) &#123;    const &#123; events &#125; &#x3D; this;    if (!events[name]) &#123;      events[name] &#x3D; [];    &#125;    events[name].push(callback);  &#125;  &#x2F;&#x2F; å–å‡ºæ¥æ‰§è¡Œ  emit(name, ...args) &#123;    const handlers &#x3D; this.events[name];    handlers &amp;&amp;      handlers.forEach((fn) &#x3D;&gt; &#123;        fn.apply(this, args);      &#125;);  &#125;  &#x2F;&#x2F; è§£é™¤  off(name, callback) &#123;    const &#123; events &#125; &#x3D; this;    if (!events[name]) return;    events[name] &#x3D; events[name].filter((fn) &#x3D;&gt; fn !&#x3D;&#x3D; callback); &#x2F;&#x2F; å¼•ç”¨ï¼ŒæŒ‡å‘å¯¹è±¡ï¼Œç›´æ¥æ”¹kvé”®å€¼å¯¹  &#125;  &#x2F;&#x2F;  ç”¨å®Œç«‹é©¬ã€è§£é™¤  once(name, callback) &#123;    const handler &#x3D; function () &#123;      callback.apply(this, arguments); &#x2F;&#x2F; æ™®é€šå‡½æ•°å‚æ•°      this.off(name, handler);    &#125;;    this.on(name, handler);  &#125;  &#x2F;&#x2F; äº‹ä»¶æ¸…ç©º  clear() &#123;    this.events &#x3D; &#123;&#125;;  &#125;&#125;</code></pre><h2 id="æ•°æ®åŠ«æŒ"><a href="#æ•°æ®åŠ«æŒ" class="headerlink" title="æ•°æ®åŠ«æŒ"></a>æ•°æ®åŠ«æŒ</h2><p><a href="https://www.freesion.com/article/47611264830/" target="_blank" >æ•°æ®åŠ«æŒ|æ•°æ®ä»£ç†</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" >MDN</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Proxylet obj &#x3D; &#123;  name: &quot;Eason&quot;,  age: 30,&#125;;let handler &#x3D; &#123;  get(target, key, receiver) &#123;    console.log(&quot;get&quot;, key);    return Reflect.get(target, key, receiver);  &#125;,  set(target, key, value, receiver) &#123;    console.log(&quot;set&quot;, key, value);    return Reflect.set(target, key, value, receiver);  &#125;,&#125;;let proxy &#x3D; new Proxy(&#123; ...obj &#125;, handler);proxy.name &#x3D; &quot;Zoe&quot;; &#x2F;&#x2F; set name Zoeproxy.age &#x3D; 18; &#x2F;&#x2F; set age 18&#x2F;&#x2F; definePropertylet arr &#x3D; [1, 2, 3];let obj &#x3D; &#123;&#125;;Object.defineProperty(obj, &quot;arr&quot;, &#123;  get() &#123;    console.log(&quot;get arr&quot;);    return arr;  &#125;,  set(newVal) &#123;    console.log(&quot;set&quot;, newVal);    arr &#x3D; newVal;  &#125;,&#125;);obj.arr.push(4); &#x2F;&#x2F; åªä¼šæ‰“å° get arr, ä¸ä¼šæ‰“å° setobj.arr &#x3D; [1, 2, 3, 4]; &#x2F;&#x2F; è¿™ä¸ªèƒ½æ­£å¸¸ set</code></pre><h2 id="a-x3D-x3D-x3D-1-amp-amp-a-x3D-x3D-x3D-2-amp-amp-a-x3D-x3D-x3D-3-x3D-x3D-x3D-true"><a href="#a-x3D-x3D-x3D-1-amp-amp-a-x3D-x3D-x3D-2-amp-amp-a-x3D-x3D-x3D-3-x3D-x3D-x3D-true" class="headerlink" title="a &#x3D;&#x3D;&#x3D; 1 &amp;&amp; a &#x3D;&#x3D;&#x3D; 2 &amp;&amp; a &#x3D;&#x3D;&#x3D; 3) &#x3D;&#x3D;&#x3D; true"></a>a &#x3D;&#x3D;&#x3D; 1 &amp;&amp; a &#x3D;&#x3D;&#x3D; 2 &amp;&amp; a &#x3D;&#x3D;&#x3D; 3) &#x3D;&#x3D;&#x3D; true</h2><p><a href="https://blog.csdn.net/RedaTao/article/details/107170267" target="_blank" >a &#x3D;&#x3D; 1 &amp;&amp; a &#x3D;&#x3D; 2 &amp;&amp; a &#x3D;&#x3D; 3</a></p><p>ä»€ä¹ˆæ ·çš„ a å¯ä»¥æ»¡è¶³ (a &#x3D;&#x3D;&#x3D; 1 &amp;&amp; a &#x3D;&#x3D;&#x3D; 2 &amp;&amp; a &#x3D;&#x3D;&#x3D; 3) &#x3D;&#x3D;&#x3D; true å‘¢ï¼Ÿ(æ³¨æ„æ˜¯ 3 ä¸ª &#x3D;ï¼Œä¹Ÿå°±æ˜¯ä¸¥æ ¼ç›¸ç­‰)???</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let i &#x3D; 1;Object.defineProperty(window, &quot;a&quot;, &#123;  get: function () &#123;    return i++;  &#125;,&#125;);console.log(a &#x3D;&#x3D; 1 &amp;&amp; a &#x3D;&#x3D; 2 &amp;&amp; a &#x3D;&#x3D; 3);</code></pre><h2 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h2><p><strong>ä»€ä¹ˆæ˜¯é“¾è¡¨</strong></p><p>æ•°æ®çš„ä¸€ç§å­˜å‚¨ç»“æ„ï¼Œä¸€ä¸ªé“¾è¡¨åŒ…å«è‹¥å¹²ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°æ®åŸŸå’ŒæŒ‡é’ˆåŸŸ</p><p><a href="https://wenku.baidu.com/view/33d6ed103a68011ca300a6c30c2259010302f35b.html" target="_blank" >ç™¾åº¦æ–‡åº“(æ”¶è´¹äº†ï¼Œåªèƒ½çœ‹éƒ¨åˆ†)ã€å‚è€ƒé“¾æ¥</a></p><p><a href="https://blog.csdn.net/m0_47109503/article/details/117566907" target="_blank" >å‚è€ƒé“¾æ¥</a></p><h3 id="å•é“¾è¡¨"><a href="#å•é“¾è¡¨" class="headerlink" title="å•é“¾è¡¨"></a>å•é“¾è¡¨</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; åœ¨åˆ›å»ºé“¾è¡¨æ—¶ï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªç±»ï¼šæŒ‡é’ˆç±»å’ŒèŠ‚ç‚¹ç±»class Node &#123;  constructor(data) &#123;    this.data &#x3D; data; &#x2F;&#x2F; èŠ‚ç‚¹çš„æ•°æ®åŸŸ&#x2F;æ•°æ®æˆå‘˜    this.next &#x3D; null; &#x2F;&#x2F; èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸ&#x2F;æŒ‡é’ˆæˆå‘˜  &#125;&#125;&#x2F;&#x2F; å®šä¹‰ä¸€ä¸ªå•å‘é“¾è¡¨ç±»class singleLinked &#123;  constructor() &#123;    this.size &#x3D; 0; &#x2F;&#x2F; è®°å½•å•é“¾è¡¨é•¿åº¦æˆ–èŠ‚ç‚¹ä¸ªæ•°    this.head &#x3D; new Node(&quot;head&quot;); &#x2F;&#x2F; è®°å½•é“¾è¡¨çš„å¤´æŒ‡é’ˆï¼šä¸»è¦ä½œç”¨è®°å½•é“¾è¡¨çš„èµ·å§‹åœ°å€    this.currentNode &#x3D; &quot;&quot;;  &#125;  &#x2F;&#x2F; è·å–é“¾è¡¨çš„é•¿åº¦  getLength() &#123;    return this.size;  &#125;  &#x2F;&#x2F; åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º  isEmpty() &#123;    return this.size &#x3D;&#x3D;&#x3D; 0;  &#125;  &#x2F;&#x2F; éå†é“¾è¡¨ï¼šä¸é‡å¤è®¿é—®é“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹  displayList() &#123;    var list &#x3D; &quot;&quot;;    var currentNode &#x3D; this.head; &#x2F;&#x2F; æŒ‡å‘é“¾è¡¨çš„å¤´æŒ‡é’ˆ    while (currentNode) &#123;      &#x2F;&#x2F; å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™è¡¨æ˜å½“å‰èŠ‚ç‚¹ä¸­å­˜åœ¨æ•°æ®      list +&#x3D; currentNode.data;      &#x2F;&#x2F; åŒæ—¶è®©å½“å‰èŠ‚ç‚¹çš„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹      currentNode &#x3D; currentNode.next;      if (currentNode) &#123;        &#x2F;&#x2F; å¦‚æœå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ä¸ºç©º        list +&#x3D; &quot;-&gt;&quot;; &#x2F;&#x2F; æ‹¼æ¥åçœ‹èµ·æ¥åƒä¸€ä¸ªé“¾è¡¨      &#125;    &#125;    console.log(list);  &#125;  &#x2F;&#x2F; è·å–é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹  findLast() &#123;    var currentNode &#x3D; this.head;    while (currentNode.next) &#123;      currentNode &#x3D; currentNode.next;    &#125;    return currentNode;  &#125;  &#x2F;&#x2F; é‡‡ç”¨å°¾æ’æ³•åœ¨é“¾è¡¨å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œå³åˆ›å»ºä¸€ä¸ªé“¾è¡¨  appendNode(element) &#123;    var currentNode &#x3D; this.findLast(); &#x2F;&#x2F; æ‰¾åˆ°é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹    var newNode &#x3D; new Node(element); &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹    currentNode.next &#x3D; newNode; &#x2F;&#x2F; æŠŠæ–°çš„èŠ‚ç‚¹æ”¾åœ¨é“¾è¡¨é‡Œå»ï¼ˆæ”¾åœ¨æœ€åä¸€ä¸ªçš„åé¢ï¼‰    newNode.next &#x3D; null; &#x2F;&#x2F; å› ä¸ºæ–°èŠ‚ç‚¹å·²ç»æ˜¯é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹    this.size++; &#x2F;&#x2F; å› ä¸ºæ–°æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®©é“¾è¡¨çš„é•¿åº¦+1  &#125;  &#x2F;&#x2F; åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹  deleteNode(element) &#123;    var currentNode &#x3D; this.head;    while (currentNode.next.data !&#x3D;&#x3D; element) &#123;      currentNode &#x3D; currentNode.next;    &#125;    &#x2F;&#x2F; å°†é“¾çš„èŠ‚ç‚¹ä¸å¦ä¸€ä¸ªèŠ‚ç‚¹è¿ä¸Š    currentNode.next &#x3D; currentNode.next.next;    this.size--;  &#125;&#125;&#x2F;&#x2F; ä¸Šè¿°é“¾è¡¨ä»£ç çš„æµ‹è¯•&#x2F;&#x2F; æœ€å¥½ä½¿ç”¨å¾ªç¯ï¼Œå¾€é‡Œé¢åŠ æ•°æ®var slist &#x3D; new singleLinked();var arr &#x3D; [1001, 1234, 1006, 7788, 5512, 6129];for (var i &#x3D; 0; i &lt; arr.length; i++) &#123;  slist.appendNode(arr[i]);&#125;slist.displayList();slist.deleteNode(1001);slist.displayList();</code></pre><h3 id="åŒå‘é“¾è¡¨"><a href="#åŒå‘é“¾è¡¨" class="headerlink" title="åŒå‘é“¾è¡¨"></a>åŒå‘é“¾è¡¨</h3><p><a href="https://blog.csdn.net/dingshao1114/article/details/105340579" target="_blank" >js æ•°æ®ç»“æ„ä¹‹åŒå‘é“¾è¡¨ doublyLinkedList</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"></code></pre><h2 id="leecode"><a href="#leecode" class="headerlink" title="leecode"></a>leecode</h2><h3 id="çº¢åŒ…ç®—æ³•"><a href="#çº¢åŒ…ç®—æ³•" class="headerlink" title="çº¢åŒ…ç®—æ³•"></a>çº¢åŒ…ç®—æ³•</h3><h3 id="æ‹¬å·åŒ¹é…"><a href="#æ‹¬å·åŒ¹é…" class="headerlink" title="æ‹¬å·åŒ¹é…"></a>æ‹¬å·åŒ¹é…</h3><h3 id="èºæ—‹çŸ©é˜µ"><a href="#èºæ—‹çŸ©é˜µ" class="headerlink" title="èºæ—‹çŸ©é˜µ"></a>èºæ—‹çŸ©é˜µ</h3><h3 id="å¤§æ•°ç›¸åŠ "><a href="#å¤§æ•°ç›¸åŠ " class="headerlink" title="å¤§æ•°ç›¸åŠ "></a>å¤§æ•°ç›¸åŠ </h3><p><a href="https://blog.csdn.net/qq_39816673/article/details/88667505" target="_blank" >JS å¤§æ•°ç›¸åŠ </a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function add(str1, str2) &#123;  str1 &#x3D; str1.split(&quot;&quot;); &#x2F;&#x2F; è½¬åŒ–æˆæ•°ç»„  str2 &#x3D; str2.split(&quot;&quot;); &#x2F;&#x2F; è½¬åŒ–æˆæ•°ç»„  let result &#x3D; &quot;&quot;; &#x2F;&#x2F; ç»“æœ  let flag &#x3D; 0; &#x2F;&#x2F; æ»¡10è¿›1æ ‡è®°  while (str1.length || str2.length || flag) &#123;    &#x2F;&#x2F; è®¡ç®—å®Œ    flag &#x3D; flag + ~~str1.pop() + ~~str2.pop(); &#x2F;&#x2F; ~~undefined &#x3D; 0, true + 0 &#x3D;1, false + 0 &#x3D; 0    result &#x3D; (flag % 10) + result; &#x2F;&#x2F; ç»“æœ    flag &#x3D; flag &gt; 9; &#x2F;&#x2F; æ˜¯å¦è¿›ä½  &#125;  return result.replace(&#x2F;^0+&#x2F;, &quot;&quot;); &#x2F;&#x2F; é¦–éƒ¨æœ‰0å»é™¤&#125;add(&quot;00125&quot;, &quot;0131231231232132136&quot;);</code></pre><h3 id="æ‰¾å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„è‹±è¯­å•è¯"><a href="#æ‰¾å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„è‹±è¯­å•è¯" class="headerlink" title="æ‰¾å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„è‹±è¯­å•è¯"></a>æ‰¾å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„è‹±è¯­å•è¯</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">var paragraph &#x3D; &quot;Bob hit a ball, the hit BALL flew far after it was hit.&quot;;function findMaxWord(paragraph) &#123;  var p &#x3D; paragraph    .replace(&#x2F;[\W\s_]&#x2F;g, &quot; &quot;)    .toLowerCase()    .split(&quot; &quot;);  const obj &#x3D; &#123;&#125;;  for (const word of p) &#123;    if (!word) continue;    if (obj[word]) &#123;      obj[word]++;    &#125; else &#123;      obj[word] &#x3D; 1;    &#125;  &#125;  let max &#x3D; 0;  let word &#x3D; &quot;&quot;;  for (const k in obj) &#123;    if (obj[k] &gt; max) &#123;      max &#x3D; obj[k];      word &#x3D; k;    &#125;  &#125;  return &#123;    count: max,    word,  &#125;;&#125;const res &#x3D; findMaxWord(paragraph);console.log(res);</code></pre><h3 id="èŠ‚ç‚¹å€’åºï¼ˆå°†-ul-id-x3D-listï¼Œå°†-ul-èŠ‚ç‚¹ä¸‹çš„-10000-ä¸ª-li-èŠ‚ç‚¹å€’åºã€‚è€ƒè™‘æ€§èƒ½ã€‚ï¼‰"><a href="#èŠ‚ç‚¹å€’åºï¼ˆå°†-ul-id-x3D-listï¼Œå°†-ul-èŠ‚ç‚¹ä¸‹çš„-10000-ä¸ª-li-èŠ‚ç‚¹å€’åºã€‚è€ƒè™‘æ€§èƒ½ã€‚ï¼‰" class="headerlink" title="èŠ‚ç‚¹å€’åºï¼ˆå°† ul.id&#x3D;listï¼Œå°† ul èŠ‚ç‚¹ä¸‹çš„ 10000 ä¸ª li èŠ‚ç‚¹å€’åºã€‚è€ƒè™‘æ€§èƒ½ã€‚ï¼‰"></a>èŠ‚ç‚¹å€’åºï¼ˆå°† ul.id&#x3D;listï¼Œå°† ul èŠ‚ç‚¹ä¸‹çš„ 10000 ä¸ª li èŠ‚ç‚¹å€’åºã€‚è€ƒè™‘æ€§èƒ½ã€‚ï¼‰</h3><h3 id="å®ç°ä¸€ä¸ªå‡½æ•°è®¡ç®—-â€œ1-12-31-100-93â€"><a href="#å®ç°ä¸€ä¸ªå‡½æ•°è®¡ç®—-â€œ1-12-31-100-93â€" class="headerlink" title="å®ç°ä¸€ä¸ªå‡½æ•°è®¡ç®— â€œ1+12-31+100-93â€"></a>å®ç°ä¸€ä¸ªå‡½æ•°è®¡ç®— â€œ1+12-31+100-93â€</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">function calc(str) &#123;  return eval(str);&#125;</code></pre><h3 id="åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯"><a href="#åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯" class="headerlink" title="åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯"></a>åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯</h3><ul><li><p>å¿«æ…¢æŒ‡é’ˆ</p><p><a href="https://www.zhihu.com/question/23208893" target="_blank" >ä¸ºä»€ä¹ˆç”¨å¿«æ…¢æŒ‡é’ˆæ‰¾é“¾è¡¨çš„ç¯ï¼Œå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆä¸€å®šä¼šç›¸é‡ï¼Ÿ</a></p></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">class Solution &#123;  ...  hasCycle() &#123;    let fast &#x3D; this.head;    let slow &#x3D; this.head;    while (fast !&#x3D; null &amp;&amp; fast.next !&#x3D;&#x3D; null) &#123;      fast &#x3D; fast.next.next      &#x2F;&#x2F; 0 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; 6      &#x2F;&#x2F;               fast      &#x2F;&#x2F;               slow      slow &#x3D; slow.next      if(fast &#x3D;&#x3D;&#x3D; slow)&#123;        return true      &#125;    &#125;    return false  &#125;&#125;</code></pre><h3 id="çˆ¬æ¥¼æ¢¯"><a href="#çˆ¬æ¥¼æ¢¯" class="headerlink" title="çˆ¬æ¥¼æ¢¯"></a>çˆ¬æ¥¼æ¢¯</h3><h3 id="åˆ é™¤å•å‘é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹"><a href="#åˆ é™¤å•å‘é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹" class="headerlink" title="åˆ é™¤å•å‘é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹"></a>åˆ é™¤å•å‘é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; åœ¨åˆ›å»ºé“¾è¡¨æ—¶ï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªç±»ï¼šæŒ‡é’ˆç±»å’ŒèŠ‚ç‚¹ç±»class Node &#123;  constructor(data) &#123;    this.data &#x3D; data; &#x2F;&#x2F; èŠ‚ç‚¹çš„æ•°æ®åŸŸ&#x2F;æ•°æ®æˆå‘˜    this.next &#x3D; null; &#x2F;&#x2F; èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸ&#x2F;æŒ‡é’ˆæˆå‘˜  &#125;&#125;&#x2F;&#x2F; å®šä¹‰ä¸€ä¸ªå•å‘é“¾è¡¨ç±»class singleLinked &#123;  constructor() &#123;    this.size &#x3D; 0; &#x2F;&#x2F; è®°å½•å•é“¾è¡¨é•¿åº¦æˆ–èŠ‚ç‚¹ä¸ªæ•°    this.head &#x3D; new Node(&quot;head&quot;); &#x2F;&#x2F; è®°å½•é“¾è¡¨çš„å¤´æŒ‡é’ˆï¼šä¸»è¦ä½œç”¨è®°å½•é“¾è¡¨çš„èµ·å§‹åœ°å€    this.currentNode &#x3D; &quot;&quot;;  &#125;  &#x2F;&#x2F; åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹  deleteNode(element) &#123;    var currentNode &#x3D; this.head;    while (currentNode.next.data !&#x3D;&#x3D; element) &#123;      currentNode &#x3D; currentNode.next;    &#125;    &#x2F;&#x2F; å°†é“¾çš„èŠ‚ç‚¹ä¸å¦ä¸€ä¸ªèŠ‚ç‚¹è¿ä¸Š    currentNode.next &#x3D; currentNode.next.next;    this.size--;  &#125;&#125;</code></pre><h2 id="äº”åˆ†é’Ÿå­¦ä¹ ç®—æ³•"><a href="#äº”åˆ†é’Ÿå­¦ä¹ ç®—æ³•" class="headerlink" title="äº”åˆ†é’Ÿå­¦ä¹ ç®—æ³•"></a>äº”åˆ†é’Ÿå­¦ä¹ ç®—æ³•</h2><p><a href="https://www.jianshu.com/p/d13fcada7c2d" target="_blank" >é“¾æ¥</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.cnblogs.com/pangqianjin/p/14998643.html" target="_blank" >JavaScript æ‰‹å†™å‡ ç§å¸¸è§çš„æ’åºç®—æ³•ï¼šå†’æ³¡ã€é€‰æ‹©ã€æ’å…¥ã€å¸Œå°”ã€å½’å¹¶ã€å¿«æ’</a><br><a href="https://blog.csdn.net/qq_44433261/article/details/117235740" target="_blank" >æ’åºåŠ¨ç”»</a><br><a href="https://wenku.baidu.com/view/7f84552a6f85ec3a87c24028915f804d2b16878c.html" target="_blank" >åˆ†æ²»æ€æƒ³â€”â€”ç²¾é€‰æ¨è</a><br><a href="https://baike.baidu.com/item/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%B3%95/9763353?fr=aladdin" target="_blank" >å½’å¹¶æ’åºæ³• ç™¾åº¦ç™¾ç§‘</a><br><a href="https://blog.csdn.net/Sherlook_Holmes/article/details/120584469" target="_blank" >ï¼ˆå«åŠ¨ç”»æ¼”ç¤ºï¼‰ææ‡‚å½’å¹¶æ’åº ä¸€å­¦å°±ä¼š</a></p><p><a href="https://www.jianshu.com/u/c6ad3f2ed2d6" target="_blank" >äº”åˆ†é’Ÿå­¦ç®—æ³•(PPT åšçš„ gif)</a><br><a href="https://wenku.baidu.com/view/8bf2d73451d380eb6294dd88d0d233d4b14e3fef.html" target="_blank" >Promise.resolveï¼ˆï¼‰è¯¦è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆæƒä¸æ ¡éªŒåœºæ™¯ã€Œç®€èŠã€</title>
      <link href="//post/2022-07-01auth.html"/>
      <url>//post/2022-07-01auth.html</url>
      
        <content type="html"><![CDATA[<h2 id="æœ€ç®€å•"><a href="#æœ€ç®€å•" class="headerlink" title="æœ€ç®€å•"></a>æœ€ç®€å•</h2><p>ç”¨å˜é‡ï¼Œæ¨¡æ‹Ÿæ•°æ®</p><h2 id="session-cookie"><a href="#session-cookie" class="headerlink" title="session + cookie"></a>session + cookie</h2><p>æ¯ä¸ªç”¨æˆ·å¯¹åº”ä¸€ä¸ªä¼šè¯</p><h2 id="SSO-1"><a href="#SSO-1" class="headerlink" title="SSO 1"></a>SSO 1</h2><ul><li>session + redis + cookie</li></ul><p>è§‰å¾—æœ‰ç‚¹å¥‡è‘©ï¼Œç¬¬äºŒä»½<strong>æ ¸å¿ƒé¡¹ç›®</strong>é‡åˆ°</p><h2 id="jwt-redis"><a href="#jwt-redis" class="headerlink" title="jwt + redis"></a>jwt + redis</h2><p>ç¬¬äºŒä»½<strong>éæ ¸å¿ƒé¡¹ç›®</strong>é‡åˆ°</p><p><strong>ä»¥ä¸‹æ˜¯ä¸€èˆ¬å…¬å¸å¸¸ç”¨çš„æ–¹å¼ï¼Œé¢è¯•çš„æ—¶å€™ï¼Œå¤§å®¶éƒ½åœ¨å” è¿™ä¸ª</strong></p><h2 id="SSO-2"><a href="#SSO-2" class="headerlink" title="SSO 2"></a>SSO 2</h2><ul><li>jwt + redis + cookie</li></ul><h2 id="ç¬¬ä¸‰æ–¹"><a href="#ç¬¬ä¸‰æ–¹" class="headerlink" title="ç¬¬ä¸‰æ–¹"></a>ç¬¬ä¸‰æ–¹</h2><ul><li>æˆæƒ + SSOï¼ˆ jwt + redis + cookieï¼‰</li><li>æ‰«ç æˆæƒ + SSOï¼ˆ jwt + redis + cookieï¼‰</li></ul><p>ç¬¬ä¸‰æ–¹ä½¿ç”¨æœ€å¤šçš„å¾®ä¿¡ã€æ”¯ä»˜å®ã€QQã€é£ä¹¦ï¼Œç¬¬ä¸‰æ–¹æˆæƒä¸€èˆ¬é€šè¿‡å›è°ƒçš„å½¢å¼ï¼ŒæŠŠæˆæƒç»“æœ<code>code</code>è¿”å›ä¸ªå¼€å‘è€…</p><h2 id="ä¼ä¸šåˆè§„"><a href="#ä¼ä¸šåˆè§„" class="headerlink" title="ä¼ä¸šåˆè§„"></a>ä¼ä¸šåˆè§„</h2><ul><li>app æ‰«ç +ä¼ä¸š web + SSO(jwt + redis + cookie)</li></ul><p>å¤§å…¬å¸éœ€è¦åš<strong>åˆè§„</strong>ï¼Œå°¤å…¶æ˜¯ä¸Šå¸‚å…¬å¸è¦è¿™äº›ä¸œä¸œï¼Œæ‰€æœ‰ç”¨æˆ·æ•°æ®å…¨éƒ¨æ¥è‡ªå…¬å¸å†…éƒ¨ç³»ç»Ÿï¼Œé¢è¯•çš„æ—¶å€™ï¼Œå¤§å®¶åŸºæœ¬ä¸Šä¸ä¼šè°ˆè¿™ä¸ªï¼Œå¦‚æœä½ ç»™é¢è¯•å®˜å” äº†ï¼Œè‚¯å®šè§‰å¾—ä½ åœ¨èƒ¡è¯´å…«é“ï¼Œå› ä¸ºä¸‹é¢çš„å¾ˆçµæ´»,åœºæ™¯å’Œå¾®ä¿¡ç±»ä¼¼ï¼Œä½ è¯´æ‰«ç ï¼Œé¢è¯•å®˜è‚¯å®šè®¤ä¸ºä½ è¯´çš„æ˜¯ä¸Šé¢<code>ç¬¬ä¸‰æ–¹</code>é‚£å¥—ä¸œè¥¿ï¼Œç„¶è€Œå®Œå…¨ä¸ä¸€æ ·</p><p>åœ¨æ‰«ç ç™»å½•å’Œç¡®è®¤ç™»é™†æ—¶å€™è¿™ä¸ªç‚¹åˆ†äº†å¤šç§ï¼ˆé•¿é“¾æ¥ã€Websocketã€MQTTã€å‚å®¶é€šé“æ¨é€ï¼Œéƒ½å¯ä»¥å®ç°ï¼‰</p><p>ä»¥æˆ‘ç¬¬ä¸‰ä»½å·¥ä½œä¸ºä¾‹ï¼š</p><ul><li><code>Flutteræ¡Œé¢ç«¯VPN</code> + <code>ç§»åŠ¨ç«¯</code>ç”¨äº† MQTT</li><li><code>Electronæ¡Œé¢ç«¯</code> + <code>ç§»åŠ¨ç«¯</code>, Electron æ¡Œé¢ç«¯ç”¨å®šæ—¶å™¨è°ƒ,<code>ç§»åŠ¨ç«¯</code>MQTT</li><li><code>æ‰«ç æ‰“å¼€é“¾æ¥</code>ï¼Œç›´æ¥æ³¨å…¥ cookieï¼Œè€Œä¸æ˜¯é€šè¿‡<code>å›è°ƒ</code>æˆ–è€…<code>redirecté‡å®šå‘</code></li></ul><p>ä¹‹æ‰€ä»¥æ²¡ç”¨å‚å®¶é€šé“ï¼Œå› ä¸ºå…¬å¸åŸç”Ÿéƒ¨é—¨çš„å‚å®¶é€šé“éœ€è¦æ”¹é€ æ‰èƒ½ç”¨ï¼Œç”±äºæ”¹é€ æˆæœ¬çš„å­˜åœ¨ï¼Œä¸æä¾›ã€‚æ€»ä¹‹éº»çƒ¦ï½ï¼Œæ¢äº†ä¸ª MQTT æ–¹æ¡ˆ</p><p>mobile åŸç”Ÿ(ã€Œ<code>RN</code>ã€<code>Flutter</code>ã€<code>IOS</code>ã€<code>å®‰å“</code>ã€<code>Weex</code>ã€<code>uniapp</code>ã€<code>ionic</code>ã€)åˆ†çš„ç»†ç‚¹,æˆ‘é‡åˆ°è¿‡çš„éƒ½åˆ—å‡ºæ¥äº†ï¼Œç®€å•æ¥è¯´å°±æ˜¯ IOS å’Œå®‰å“ï¼Œè‡³äºé¸¿è’™å•¥çš„å°±ä¸è¯´äº†</p><p>æ€»ç»“ï¼šè¿™ä¸ªå§ï¼Œå°±ç›¸å½“äºï¼Œå…¬å¸å¼€å‘äº†è‡ªå·±çš„<code>å¾®ä¿¡æ¡Œé¢window/mac</code> + <code>å¾®ä¿¡æ‰‹æœº</code></p><h2 id="webview-cookie-æ³¨å…¥"><a href="#webview-cookie-æ³¨å…¥" class="headerlink" title="webview cookie æ³¨å…¥"></a>webview cookie æ³¨å…¥</h2><p><code>react-native-webview</code>å‘ h5 åº”ç”¨æ³¨å…¥ cookieï¼Œ<code>èµ° SSO éªŒè¯å®ç°å…ç™»</code>ï¼Œ åŸç”Ÿå½“ç„¶ä¹ŸOKçš„</p>]]></content>
      
      
      <categories>
          
          <category> auth </category>
          
      </categories>
      
      
        <tags>
            
            <tag> auth </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react hook ä½¿ç”¨ bug</title>
      <link href="//post/2022-07-01bug.html"/>
      <url>//post/2022-07-01bug.html</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>Rendered more hooks than during the previous render.</p><img src="http://t-blog-images.aijs.top/img/20220701111839.webp" /><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><img src="http://t-blog-images.aijs.top/img/20220701111740.webp" /><p>ä¸¤ç§æ–¹å¼è§£å†³ï¼š</p><ul><li>å‹¾å­å‰ç½®</li><li>ä¸ç”¨è¿™ä¸ªå‹¾å­</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><strong>å‹¾å­ä¸èƒ½åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨</strong> è¿™ä¸ªè¦æ³¨æ„å¹¶ä¸æ˜¯ä¸€å®šè¿™ç§å½¢å¼</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (æ¡ä»¶) &#123;  &#x2F;&#x2F; å¦‚æœæ¡ä»¶ç”¨äºæ˜¯trueï¼Œç›¸å½“äºæ²¡æœ‰å¤–å±‚çš„ifï¼Œ  å‹¾å­;&#125;</code></pre><ul><li>è¿™ä¸ªå‹¾å­æ”¾åœ¨äº† if çš„åé¢ æ¡ä»¶è¯­å¥å¦‚æœåœ¨ç¬¬ä¸€æ¬¡å‘½ä¸­çš„æ˜¯æå‰ç»“æŸï¼Œä¸‹æ¬¡æ¸²æŸ“æ²¡å‘½ä¸­ ifï¼Œèµ°äº†åé¢çš„ä»£ç å°±ä¼šå‡ºè¿™ä¸ªé—®é¢˜</li><li>å¦‚æœæµ‹è¯•ä¸å…¨é¢ï¼Œè¿™ä¸ª bug å°±å¯èƒ½åˆ°çº¿ä¸Šäº†ï¼Œ å› ä¸ºä½ æµ‹è¯•çš„æœ‰å¯èƒ½æ¯æ¬¡å‘½ä¸­ if è€Œä¸ä¼šåˆ° elseï¼Œ<strong>ä¸‹é¢è¿™ç§æ¨¡å¼</strong>ä¸€ä¸æ³¨æ„å°±é”™äº†</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">if () &#123;  return æ¸²æŸ“&#125;å‹¾å­</code></pre><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><p>react æ”¶é›†å‹¾å­çš„æ—¶å€™ï¼Œéœ€è¦ä¿è¯å‹¾å­æ•°é‡æ˜¯ä¸€è‡´çš„ï¼Œä¸å¤šä¸å°‘ï¼Œåˆšåˆšå¥½</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Hook æœ¬è´¨å°±æ˜¯ JavaScript å‡½æ•°ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒæ—¶éœ€è¦éµå¾ªä¸¤æ¡è§„åˆ™ã€‚Reactå®˜æ–¹æä¾›äº†ä¸€ä¸ª <code>eslint-plugin-react-hooks</code> æ’ä»¶æ¥å¼ºåˆ¶æ‰§è¡Œè¿™äº›è§„åˆ™ï¼š</p></blockquote><p>ç»­ã€‚ã€‚ã€‚æºç æ‰¾è¿™ä¸ªæ—¥å¿—</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zh-hans.reactjs.org/docs/hooks-rules.html#explanation" target="_blank" >Hook è§„åˆ™</a></p>]]></content>
      
      
      <categories>
          
          <category> bug </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-native-webviewä¸­å¤„ç†å¤–ç½‘é“¾æ¥</title>
      <link href="//post/2022-06-29rn-web.html"/>
      <url>//post/2022-06-29rn-web.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä¹‹å‰å…¬å¸ç§»åŠ¨ç«¯æ˜¯ä½¿ç”¨ vpn è¿æ¥åˆ°å†…ç½‘ï¼Œç”±äºæŸäº›åŸå› ï¼ŒIOS ä¼ä¸šè¯ä¹¦å³å°†åˆ°æœŸï¼Œåº”ç”¨éœ€è¦ä¸Šæ¶ï¼Œvpn ä¸æ»¡è¶³ä¸Šæ¶è¦æ±‚ï¼Œæ‰€ä»¥ï¼š</p><ul><li>vpn è¦ä» iOS åŒ…ä¸­ç§»é™¤</li><li>vpn ç§»é™¤å¯¼è‡´ä¸èƒ½ç›´æ¥è®¿é—®å†…ç½‘</li><li>éœ€è¦é€šè¿‡å¤–ç½‘åŸŸåè®¿é—®å†…ç½‘èµ„æº</li></ul><p>ä¸åŒç¯å¢ƒçš„è¯·æ±‚</p><ul><li>åŸç”ŸåŠ RN ä»£ç ï¼Œæ¥å£è®¿é—®èµ° ATOP æ¥å£è®¿é—®</li><li>å†…ç½‘åº”ç”¨åµŒå…¥åˆ° react-native-webview ä¸­ï¼Œä½¿ç”¨ cookie æ³¨å…¥çš„æ–¹å¼è¿›è¡Œæˆæƒï¼Œ</li></ul><p>å·²æœ‰çš„åŸŸåï¼š</p><ul><li>ä¹‹å‰å·²ç»åšäº†ä¼ä¸šå¾®ä¿¡å·¥ä½œå°åŠŸèƒ½ï¼Œè€ƒè™‘åˆ°ç”³è¯·å¤–ç½‘åŸŸåéœ€è¦èµ°å®‰å…¨ã€åˆè§„å®¡æ ¸æ¯”è¾ƒéº»çƒ¦</li><li>æˆ‘ä»¬çš„ä¼ä¸šå¾®ä¿¡æˆæƒæ˜¯æ ¹æ®è¯·æ±‚å¤´åŒºåˆ†çš„ï¼ŒåŒæ—¶åº”ç”¨ä¸­ä¹Ÿæœ‰æ˜¯å¦æ˜¯å¾®ä¿¡ç¯å¢ƒçš„åˆ¤æ–­, æ‰€ä»¥ï¼šåªè¦åœ¨é¡¹ç›®ä¸­é¿å¼€å¾®ä¿¡æˆæƒï¼Œèµ° SSO æˆæƒï¼ˆcookie æ³¨å…¥ï¼‰</li></ul><img src="http://t-blog-images.aijs.top/img/20220629172711.webp" /><p><em>é¡ºä¾¿è¯´å¥ï¼šè¿™é‡Œçš„åˆ¤æ–­æ˜¯é‡‡ç”¨(nextjs)æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ‰€ä»¥èƒ½ç›´æ¥åœ¨è¯·æ±‚å¤´ä¸­åˆ¤æ–­ï¼Œå¦‚æœä¸æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Œå¯èƒ½è¦è€ƒè™‘å…¶ä»– rn æ³¨å…¥çš„æ–¹å¼</em></p><h2 id="æ”¹é€ "><a href="#æ”¹é€ " class="headerlink" title="æ”¹é€ "></a>æ”¹é€ </h2><p><strong>RN æ”¹é€ </strong></p><img src="http://t-blog-images.aijs.top/img/20220629173240.webp" /><p><strong>h5 é¡¹ç›®æ”¹é€ </strong></p><!-- <img src="http://t-blog-images.aijs.top/img/20220629173017.webp" /> --><img src="http://t-blog-images.aijs.top/img/20220629180554.webp" /><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const lang &#x3D; cookie.parse(req.headers.cookie || &#39;&#39;).gTyPlatLang || &#39;en&#39;const ua &#x3D; parser(req.headers[&#39;user-agent&#39;])CommonModel.actions.setDevice(ua.device.type, req)if (!getWechatUserAgent(req.headers[&#39;user-agent&#39;]) &amp;&amp; req.headers[&#39;x-public&#39;]) &#123;  const isMobile &#x3D; ua.device.type &#x3D;&#x3D;&#x3D; &#39;mobile&#39;  if(!(isMobile &amp;&amp; !!req.headers.tyxz))&#123;  &#x2F;&#x2F; ç§»åŠ¨ç«¯ä¸æ˜¯ä¼ä¸šå¾®ä¿¡çš„    redirect(Config.tyHost + join(&#39;&#x2F;&#39;, req.url), ctx) &#x2F;&#x2F; ç§»åŠ¨ç«¯æ˜¯rnxzçš„é‡å®šå‘åˆ°å†…ç½‘  &#125;&#125;</code></pre><img src="http://t-blog-images.aijs.top/img/20220630093816.webp" /><p>æœ¬ç¯‡æ–‡ç« é’ˆå¯¹çš„æ˜¯éä¼ä¸šå¾®ä¿¡æˆæƒçš„æƒ…å†µï¼Œå³ï¼šå›¾ç¬¬ä¸€è¡Œä»å·¦åˆ°å³ï¼ˆæœ‰cookieä¿¡æ¯çš„æƒ…å†µï¼‰</p><h2 id="æ€»ç»“ä¸‹"><a href="#æ€»ç»“ä¸‹" class="headerlink" title="æ€»ç»“ä¸‹"></a>æ€»ç»“ä¸‹</h2><p><strong>æŒ‰ç…§åŸæœ‰çš„è®¾è®¡ç¼ºé™·ï¼š</strong></p><ul><li>åŸŸåæ˜¯ç»™ä¼ä¸šå¾®ä¿¡ç”¨çš„ï¼Œæ˜¯åœ¨nginxé‚£è¾¹é…ç½®çš„è¯·æ±‚å¤´ï¼Œè¿™æœ¬èº«ä¸å¤Ÿçµæ´»</li><li>ä»£ç ä¸­é€»è¾‘ï¼š<br>1.å…ˆè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œè·å–ä¸åˆ°ï¼Œ<br>2.æ£€æµ‹çŠ¶æ€ç ï¼ˆ<code>fetch</code>å·¥å…·å¯¹äºåå°è¿”å›çš„<code>401çŠ¶æ€ç </code>ï¼Œå¦‚æœæ˜¯<code>401</code>ï¼Œé»˜è®¤æ˜¯èµ°å¾®ä¿¡æˆæƒï¼Œåå°ä¸šåŠ¡æ ¡éªŒæˆæƒä¿¡æ¯ä¸é€šè¿‡çš„ï¼‰ï¼Œ<br>3.å¯¹äºä¸æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„ï¼Œæ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æ˜¯ä¼ä¸šå¾®ä¿¡ï¼Œ<br>4.å¦‚æœä¸æ˜¯é‡å®šå‘åˆ°å†…ç½‘<br>ï¼ˆè¿˜æ˜¯è¿‡äºä¾èµ–åŸŸåé…ç½®ï¼‰</li></ul><p><strong>é‡æ–°è®¾è®¡ï¼š</strong></p><ul><li>æ­£å¸¸ä¸šåŠ¡é€»è¾‘ï¼Œåº”è¯¥å…ˆåˆ¤æ–­æ˜¯ç¯å¢ƒï¼Œå†³å®šèµ°å“ªå¥—æˆæƒéªŒè¯ï¼ˆè¿™æ ·ä¸ä¼šå› ä¸ºä¸€å¥—æˆæƒï¼Œä¸€ä¸ªåŸŸåäº†ï¼‰</li></ul><h2 id="vconsole"><a href="#vconsole" class="headerlink" title="vconsole"></a>vconsole</h2><p>å¯¹äº react-native-webview è°ƒè¯•ï¼Œä½¿ç”¨äº† <code>vconsole</code>è°ƒè¯•ï¼Œå¯ä»¥ç®€å•æŸ¥çœ‹ä¸€äº›æ§åˆ¶å°ä¿¡æ¯ï¼ŒåŒ…æ‹¬ cookie ç›¸å…³çš„æŸ¥çœ‹ã€å¤åˆ¶ã€ç¼–è¾‘æ“ä½œ</p><div style="display:flex;flex-direction:row; flex-wrap:wrap"><img src="http://t-blog-images.aijs.top/img/20220629173944.webp" style="margin-right: 6px" width=300/><img src="http://t-blog-images.aijs.top/img/20220629173856.webp" width=300/></div>]]></content>
      
      
      <categories>
          
          <category> react-native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ä¸šå¾®ä¿¡æˆæƒæµç¨‹</title>
      <link href="//post/2022-06-29wx-auth.html"/>
      <url>//post/2022-06-29wx-auth.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ul><li>ç¡®ä¿æœ¬åœ°å·²ç»æ­£ç¡®é…ç½®äº† HOSTï¼Œèƒ½å¤Ÿä»å·¥ä½œå°å…¥å£æ‰“å¼€æœ¬åœ°çš„å¼€å‘æœåŠ¡</li><li>ç¡®ä¿å·²è·å–åˆ°å½“å‰ä¼ä¸šçš„å”¯ä¸€ IDï¼šcorp_idï¼Œåœ¨ã€ç®¡ç†åå°ã€‘- ã€æˆ‘çš„ä¼ä¸šã€‘-ã€ä¼ä¸šä¿¡æ¯ã€‘é¡µé¢ï¼Œæœ€ä¸‹é¢æ‰¾åˆ°ã€ä¼ä¸š IDã€‘</li><li>å·²ç»é€šè¿‡æ¥å£è°ƒç”¨è·å–åˆ°å½“å‰åº”ç”¨çš„ access_tokenï¼Œè¯·å‚è€ƒ äºŒï¼š<a href="https://developer.work.weixin.qq.com/tutorial/detail/46" target="_blank" >å¦‚ä½•è·å–åº”ç”¨æ¥å£å‡­è¯</a></li></ul><h2 id="é…ç½®å¯ä¿¡åŸŸå"><a href="#é…ç½®å¯ä¿¡åŸŸå" class="headerlink" title="é…ç½®å¯ä¿¡åŸŸå"></a>é…ç½®å¯ä¿¡åŸŸå</h2><p>ä¼ä¸šå¾®ä¿¡æä¾›äº† OAuth çš„æˆæƒç™»å½•æ–¹å¼ï¼Œå¯ä»¥è®©ä»ä¼ä¸šå¾®ä¿¡ç»ˆç«¯æ‰“å¼€çš„ç½‘é¡µè·å–æˆå‘˜çš„èº«ä»½ä¿¡æ¯ï¼Œä»è€Œå…å»ç™»å½•çš„ç¯èŠ‚ã€‚</p><p>ä¸ºäº†ä¿è¯è®¿é—®æˆæƒçš„å®‰å…¨æ€§ï¼Œéœ€è¦é…ç½®æˆæƒé“¾æ¥ URL æ‰€åœ¨åŸŸåä¸ºå¯ä¿¡åŸŸåã€‚<br>åœ¨ã€åº”ç”¨è¯¦æƒ…ã€‘-ã€å¼€å‘è€…æ¥å£ã€‘-ã€ç½‘é¡µæˆæƒåŠ JS-SDKã€‘ï¼Œç‚¹å‡»ã€è®¾ç½®å¯ä¿¡åŸŸåã€‘</p><img src="http://t-blog-images.aijs.top/img/20220629163014.webp" /><p>åœ¨ã€è®¾ç½®å¯ä¿¡åŸŸåã€‘å¼¹çª—ï¼Œå¡«å†™ç½‘é¡µæˆæƒåŠŸèƒ½çš„å›è°ƒåŸŸå</p><img src="http://t-blog-images.aijs.top/img/20220629163042.webp" width=300 /><p>ç½‘é¡µæˆæƒå›è°ƒåŸŸåçš„é…ç½®é¡»ä¸å®é™…è®¿é—®é“¾æ¥çš„åŸŸåå®Œå…¨ä¸€è‡´ï¼Œè¯¦ç»†è¦æ±‚è¯·å‚è€ƒæ–‡æ¡£ <a href="https://developer.work.weixin.qq.com/document/path/91335#%E5%85%B3%E4%BA%8E%E7%BD%91%E9%A1%B5%E6%8E%88%E6%9D%83%E7%9A%84%E5%8F%AF%E4%BF%A1%E5%9F%9F%E5%90%8D" target="_blank" >å…³äºç½‘é¡µæˆæƒçš„å¯ä¿¡åŸŸå</a>ã€‚</p><h2 id="æ„é€ ç½‘é¡µæˆæƒé“¾æ¥"><a href="#æ„é€ ç½‘é¡µæˆæƒé“¾æ¥" class="headerlink" title="æ„é€ ç½‘é¡µæˆæƒé“¾æ¥"></a>æ„é€ ç½‘é¡µæˆæƒé“¾æ¥</h2><p>åœ¨æˆ‘ä»¬å½“å‰çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰å‡ ä¸ª URL éœ€è¦æ³¨æ„å’ŒåŒºåˆ†ï¼š</p><ul><li>åº”ç”¨ä¸»é¡µ URL<br>ä»å·¥ä½œå°ç‚¹å‡»æ‰“å¼€çš„é¡µé¢ URL ï¼Œåœ¨åˆ›å»ºåº”ç”¨æ˜¯é…ç½®å¡«å†™çš„ï¼Œç”¨æ¥å‘æˆæƒé“¾æ¥ URL è·³è½¬ã€‚</li><li>é‡å®šå‘ URL<br>å½“ç”¨æˆ·æˆæƒæˆåŠŸåï¼Œä¼šå¸¦ç€æˆå‘˜æˆæƒ code è·³è½¬çš„ URLï¼Œç”¨æ¥æ¥æ”¶ code å¹¶è·å–æˆå‘˜èº«ä»½ã€‚</li><li>æˆæƒé“¾æ¥ URL<br>ä¼ä¸šå¾®ä¿¡åŸŸåä¸‹çš„ URLï¼ŒåŒ…å«äº† suite_idã€é‡å®šå‘ URL ç­‰ä¿¡æ¯ï¼Œå½“ä¼ä¸šå¾®ä¿¡æœåŠ¡å‚æ•°éªŒè¯æˆåŠŸåï¼Œä¼šè·³è½¬åˆ°é‡å®šå‘ URLã€‚</li></ul><p>æˆ‘ä»¬åœ¨ä¸ŠèŠ‚è¯¾ç¨‹ä¸­é…ç½®ä¼ä¸šçš„ä¸»é¡µ URL ä¸º <a href="http://myapp.com:300/home%EF%BC%8C%E6%88%91%E4%BB%AC%E5%9C%A8%E8%BF%99%E4%B8%AA" target="_blank" >http://myapp.com:300/homeï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ª URL</a> è®¿é—®é€»è¾‘é‡Œé¢æ ¹æ®çº¦å®šæ„é€ æˆæƒé“¾æ¥ URLï¼Œå¹¶å‘è¿™ä¸ªé“¾æ¥è·³è½¬ï¼š</p><p>å…³äº OAuth çš„è¯¦ç»†å†…å®¹ï¼Œè¯·å‚è€ƒ <a href="https://developer.work.weixin.qq.com/document/path/91119" target="_blank" >ç½‘é¡µæˆæƒç™»å½•</a>ã€‚å…³äºæˆæƒé“¾æ¥æ›´å¤šçš„å†…å®¹ï¼Œè¯·å‚è€ƒ <a href="https://developer.work.weixin.qq.com/document/path/91022" target="_blank" >æ„é€ ç½‘é¡µæˆæƒé“¾æ¥</a>ã€‚</p><h2 id="è§£ææˆå‘˜æˆæƒ-code"><a href="#è§£ææˆå‘˜æˆæƒ-code" class="headerlink" title="è§£ææˆå‘˜æˆæƒ code"></a>è§£ææˆå‘˜æˆæƒ code</h2><p>ä¼ä¸šæˆå‘˜ä»å·¥ä½œå°ç‚¹å‡»åº”ç”¨ï¼Œæ‰“å¼€åº”ç”¨ä¸»é¡µ URLï¼Œå‘æˆæƒé“¾æ¥ URL è·³è½¬ï¼›ä¼ä¸šå¾®ä¿¡å¯¹æˆæƒé“¾æ¥ä¸Šçš„ä¿¡æ¯è¿›è¡Œæ ¡éªŒä¹‹åï¼Œä¼šé‡å®šå‘ URL è·³è½¬ï¼Œå¹¶ä»¥ query çš„å½¢å¼å¸¦ä¸Šå½“å‰è®¿é—®æˆå‘˜çš„ code ä¿¡æ¯ã€‚</p><p>åœ¨ä¸Šä¸€æ­¥ï¼Œæˆ‘ä»¬å®šä¹‰äº†é‡å®šå‘ URL ä¸º <a href="http://myapp.com/app%EF%BC%8C%E5%9C%A8%E8%BF%99%E4%B8%AA" target="_blank" > http://myapp.com/app</a>ï¼Œåœ¨è¿™ä¸ª URL çš„è®¿é—®é‡Œæˆ‘ä»¬è§£æå‡º code å‚æ•°ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; é‡å®šå‘ URLrouter.get(&quot;&#x2F;app&quot;, async function (req, res, next) &#123;  &#x2F;&#x2F; ä» query å‚æ•°ä¸­è§£æ code  let &#123; code &#125; &#x3D; req.query;  &#x2F;&#x2F; å±•ç¤ºç™»å½•åçš„é¡µé¢  res.render(&quot;home&quot;);&#125;);</code></pre><h2 id="è·å–è®¿é—®ç”¨æˆ·èº«ä»½ä¿¡æ¯"><a href="#è·å–è®¿é—®ç”¨æˆ·èº«ä»½ä¿¡æ¯" class="headerlink" title="è·å–è®¿é—®ç”¨æˆ·èº«ä»½ä¿¡æ¯"></a>è·å–è®¿é—®ç”¨æˆ·èº«ä»½ä¿¡æ¯</h2><p>åœ¨è§£æå‡ºæˆå‘˜æˆæƒ code ä¹‹åï¼Œä½¿ç”¨ access_token ï¼Œè°ƒç”¨ <a href="https://developer.work.weixin.qq.com/document/path/91023" target="_blank" >è·å–è®¿é—®ç”¨æˆ·èº«ä»½</a> æ¥å£ï¼Œå³å¯å¾—åˆ°è®¿é—®ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ user_idï¼Œå¦‚æœæƒ³è¦è®¿é—®ç”¨æˆ·æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œåˆ™éœ€è¦é€šè¿‡ <a href="https://developer.work.weixin.qq.com/document/path/90196" target="_blank" >è¯»å–æˆå‘˜</a> å¾—åˆ°ç”¨æˆ·çš„å§“åã€å¤´åƒç­‰å®Œæ•´ä¿¡æ¯ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">router.get(&quot;&#x2F;app&quot;, async function (req, res, next) &#123;  let &#123; code &#125; &#x3D; req.query;  &#x2F;&#x2F; ä»ç¼“å­˜ä¸­è¯»å–å‡º access_token  let access_token &#x3D; Tool.GetAccessToken();  if (access_token) &#123;    &#x2F;&#x2F; è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯    let &#123; data: user_data &#125; &#x3D; await axios.get(      &#96;https:&#x2F;&#x2F;qyapi.weixin.qq.com&#x2F;cgi-bin&#x2F;user&#x2F;getuserinfo?access_token&#x3D;$&#123;access_token&#125;&amp;code&#x3D;$&#123;code&#125;&#96;    );    console.log(&quot;è·å– user_data æˆåŠŸ&quot;, user_data);    &#x2F;&#x2F; è·å¾—ç”¨æˆ·çš„ user_id    let user_id &#x3D; user_data.UserId;    &#x2F;&#x2F; è·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯    let &#123; data: user_detail_data &#125; &#x3D; await axios.get(      &#96;https:&#x2F;&#x2F;qyapi.weixin.qq.com&#x2F;cgi-bin&#x2F;user&#x2F;get?access_token&#x3D;$&#123;access_token&#125;&amp;userid&#x3D;$&#123;user_id&#125;&#96;    );    console.log(&quot;è·å–æˆå‘˜è¯¦ç»†ä¿¡æ¯æˆåŠŸ&quot;, user_detail_data);    &#x2F;&#x2F; å°†ç”¨æˆ·ä¿¡æ¯å±•ç¤ºåœ¨é¡µé¢ä¸Š    res.render(&quot;home&quot;, user_detail_data);  &#125; else &#123;    res.render(&quot;error&quot;);  &#125;&#125;);</code></pre><p>åœ¨å‰ç«¯é¡µé¢ä¸­å±•ç¤ºç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;!DOCTYPE html&gt;&lt;html&gt;  &lt;head&gt;    &lt;title&gt;Hello World&lt;&#x2F;title&gt;  &lt;&#x2F;head&gt;  &lt;body&gt;    &lt;h1&gt;Hello World!&lt;&#x2F;h1&gt;    &lt;div&gt;      &lt;img src&#x3D;&quot;&lt;%&#x3D;avatar %&gt;&quot; &#x2F;&gt;&lt;span&gt;&lt;%&#x3D;name %&gt;(&lt;%&#x3D;english_name %&gt;) &lt;&#x2F;span&gt;    &lt;&#x2F;div&gt;  &lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><img src="http://t-blog-images.aijs.top/img/20220629163741.webp" width=300/><p>å…³äºè·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯å†…å®¹ä»¥åŠæ¥å£è¿”å›çš„å®Œæ•´å­—æ®µä¿¡æ¯ï¼Œè¯·å‚è€ƒ <a href="https://developer.work.weixin.qq.com/document/path/90196" target="_blank" >è¯»å–æˆå‘˜</a>ã€‚å¦‚æœæƒ³è¦æˆå‘˜åœ¨ç³»ç»Ÿæµè§ˆå™¨ä¸­æ‰“å¼€åº”ç”¨æ—¶ä¹Ÿèƒ½è¿›è¡Œä¼ä¸šå¾®ä¿¡æˆæƒç™»å½•ï¼Œè¯·å‚è€ƒ <a href="https://developer.work.weixin.qq.com/document/path/91025" target="_blank" >æ„é€ æ‰«ç ç™»å½•</a> ã€‚</p><h2 id="æˆæƒæµç¨‹"><a href="#æˆæƒæµç¨‹" class="headerlink" title="æˆæƒæµç¨‹"></a>æˆæƒæµç¨‹</h2><p>ä¼ä¸šå¾®ä¿¡å®˜ç½‘æœ‰æˆæƒæµç¨‹ï¼Œçœ‹ä¸Šå»æ²¡é‚£ä¹ˆç›´æ¥ï¼Œç»“åˆé¡¹ç›®ç”»ä¸ªè‰å›¾</p><img src="http://t-blog-images.aijs.top/img/20220630093816.webp" /><p>æœ¬ç¯‡æ–‡ç« é’ˆå¯¹çš„æ˜¯<strong>ä¼ä¸šå¾®ä¿¡æˆæƒ</strong>çš„æƒ…å†µï¼Œå³ï¼š<strong>å›¾ç¬¬ä¸€è¡Œèµ°åˆ°æ²¡æˆæƒï¼Œå¾€ä¸‹èµ°ï¼ˆæ²¡æœ‰ cookie ä¿¡æ¯çš„æƒ…å†µï¼‰</strong></p><h2 id="æ›´å¥½çš„æ–¹æ¡ˆ"><a href="#æ›´å¥½çš„æ–¹æ¡ˆ" class="headerlink" title="æ›´å¥½çš„æ–¹æ¡ˆ"></a>æ›´å¥½çš„æ–¹æ¡ˆ</h2><p><strong>æ–¹æ¡ˆ 1:</strong> å¯¹äºä¼ä¸šå¾®ä¿¡æˆæƒå’Œ SSO æˆæƒï¼Œæœ¬è´¨ä¸Šå¹¶æ— åŒºåˆ«ï¼Œæœ€ç»ˆçš„ç›®çš„æ˜¯æ³¨å…¥ cookie,å¯¹äºæˆ‘å½“å‰æ‰€åœ¨å…¬å¸çš„æƒ…å†µï¼ˆä¼ä¸šå¾®ä¿¡æˆæƒï¼Œå•ç‹¬ç»´æŠ¤åˆ° redies ä¸­ï¼Œç‹¬ç«‹äº SSO,æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼‰ã€‚</p><p><strong>æ–¹æ¡ˆ 2:</strong> å¦‚æœæŠŠä¼ä¸šå¾®ä¿¡æˆæƒçš„è¿”å›ç”¨äºæ¢å– SSO çš„ï¼ˆtokenï¼‰æ³¨å…¥ cookie å®ç°æˆæƒï¼Œæœ€ç»ˆæ¯æ¬¡æ ¡éªŒéƒ½æ˜¯ SSO,ä¼šèŠ‚çœä¸å°‘æˆæœ¬ã€‚</p><p>æˆ‘åœ¨ä¸Šå®¶åš<strong>é’‰é’‰ ISV ç¬¬ä¸‰æ–¹ä¾›åº”å•†å¼€å‘</strong>æ—¶å€™ï¼Œå®ç°æ•ˆæœç±»ä¼¼æ–¹æ¡ˆ 2</p><p><strong>æ›´ä¼˜æ–¹æ¡ˆ 3:</strong> åœ¨æ–¹æ¡ˆ 2 çš„åŸºç¡€ï¼Œå°†è¯·æ±‚å¤´æ ‡è®°å»æ‰ï¼ˆè®©åç«¯è‡ªè¡Œå¤„ç†ï¼‰ã€‚è¯·æ±‚åˆ°åç«¯ï¼Œåç«¯èƒ½æ‹¿åˆ°è¯·æ±‚å¤´<code>userAgent</code>å­—æ®µï¼Œå¯ä»¥çŸ¥é“åˆ°æ­¤è¯·æ±‚æ˜¯ä»å“ªä¸ªåº”ç”¨è¿‡æ¥çš„ï¼Œåç«¯è‡ªå·±åˆ¤æ–­ä¸‹å°±å¥½äº†ï¼ˆå®Œå…¨æ²¡å¿…è¦<code>åŸŸååŠ é…ç½®ï¼Œå°¤å…¶æ˜¯é‚£ç§nginxé…ç½®åï¼Œä»£ç åˆä¹±å†™çš„</code>ï¼‰</p><h2 id="å¾®ä¿¡ç¯å¢ƒåˆ¤æ–­"><a href="#å¾®ä¿¡ç¯å¢ƒåˆ¤æ–­" class="headerlink" title="å¾®ä¿¡ç¯å¢ƒåˆ¤æ–­"></a>å¾®ä¿¡ç¯å¢ƒåˆ¤æ–­</h2><p><strong>å‰ç«¯ä»£ç </strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * ï¼ˆæœåŠ¡ç«¯+å®¢æˆ·ç«¯ï¼‰æ¸²æŸ“ï¼šæ ¹æ®req headersä¸­user-agentåˆ¤æ–­æ˜¯å¦æ¥è‡ªå¾®ä¿¡ç«¯ï¼ˆæ¡Œé¢ç«¯å’Œæ‰‹æœºç«¯ï¼‰ *&#x2F;export default function getWechatUserAgent(userAgent?: string): boolean &#123;  const agent &#x3D;    userAgent || (typeof navigator &#x3D;&#x3D;&#x3D; &quot;undefined&quot; ? &quot;&quot; : navigator.userAgent);  const user_agent &#x3D; agent ? agent.toLowerCase() : &quot;&quot;;  return !!(    user_agent &amp;&amp;    (user_agent.includes(&quot;wechat&quot;) ||      user_agent.includes(&quot;wxwork&quot;) ||      user_agent.includes(&quot;windowswechat&quot;))  );&#125;</code></pre><p><strong>ç¯å¢ƒåˆ¤æ–­ä¹Ÿæ”¾åç«¯</strong></p><p>å…¬å¸è®¾è®¡çš„åŠ è¯·æ±‚å¤´æ ‡è®°æ˜¯ä¸æ˜¯ä¼ä¸šå¾®ä¿¡ï¼Œå®Œå…¨æ²¡å¿…è¦ æœåŠ¡ç«¯æ¥åˆ°è¯·æ±‚å¯ä»¥æ‹¿åˆ°<code>user-agent</code></p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><p><code>&lt;a&gt;æ ‡ç­¾ä¸‹è½½</code></p><p>å› ä¸ºåç«¯æ˜¯é€šè¿‡å‰ç«¯ç»™çš„é¢å¤–æ ‡è¯†åˆ¤æ–­ç¯å¢ƒçš„ï¼Œæœ‰ä¸ªå¾ˆè‡´å‘½çš„é—®é¢˜ é€šè¿‡ <code>&lt;a&gt;æ ‡ç­¾ä¸‹è½½</code>çš„æ²¡åŠæ³•åŠ è¯·æ±‚å¤´ï¼Œéœ€è¦å°†<code>&lt;a&gt;æ ‡ç­¾æ–¹å¼çš„ä¸‹è½½</code>æ”¹ä¸º http è¯·æ±‚ä¸‹è½½</p></p></div><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.work.weixin.qq.com/tutorial/detail/47" target="_blank" >å¦‚ä½•è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯</a></p><p><a href="https://developer.work.weixin.qq.com/document/path/91022" target="_blank" >æ„é€ ç½‘é¡µæˆæƒé“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> ä¼ä¸šå¾®ä¿¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ä¸šå¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-theme-auroraæºç ä¿®æ”¹</title>
      <link href="//post/2022-06-24aurora.html"/>
      <url>//post/2022-06-24aurora.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p><code>hexo-theme-aurora</code>æ˜¯ä¸€æ¬¾ä¸é”™çš„ä¸»é¢˜ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹æ— ç–‘ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ã€‚é‡åˆ°é—®é¢˜é¦–å…ˆå» github ä¸Šæ‰¾ issue æ¥å¤„ç†ï¼Œæœ‰äº›é—®é¢˜éœ€è¦æ”¹æºç ï¼Œä¹‹å‰ä½¿ç”¨<code>patch</code>è¿›è¡Œç®€å•çš„ä¿®æ”¹ï¼Œè¿™æ¬¡é‡åˆ°äº† tag æŸ¥ä¸åˆ°ï¼Œæœ¬åœ°æ˜¯æœ‰çš„ï¼Œå‘å¸ƒåæ‰¾ä¸åˆ°äº†ï¼Œå¯¼è‡´æ–‡ç« åœ¨<code>tag</code>æƒ…å†µä¸‹ä¸å¯è§ï¼Œä¹‹å‰ä½œè€…åœ¨è¯¦æƒ…é¡µç•™äº†<code>categories</code>ï¼Œä½†æ˜¯æ²¡æœ‰å…¥å£ã€‚ç­‰äº†å‡ å‘¨ï¼Œä½œè€…æ²¡æœ‰ fix,åŠ¨æ‰‹æ”¹ï½</p><img src="http://t-blog-images.aijs.top/img/20220624114614.webp" /><p>æºç <code>node-sass</code>å®‰è£…è¦æ³¨æ„äº†ï¼Œå¯èƒ½ä¼šæŠ¥é”™</p><p>æŸ¥è¯¢ node-sass å¯¹åº”çš„ node.js ç‰ˆæœ¬ã€‚<br><a href="https://github.com/sass/node-sass/releases?page=1#:~:text=Compare-,v5.0.0,-Breaking%20changes" target="_blank" >è§</a></p><p><a href="https://github.com/841660202/hexo-theme-aurora" target="_blank" >æºç å·²ç» fork</a></p><p>æºç ä½¿ç”¨ï¼švue3 + pinia + cliï¼Œç†æƒ³ç»„åˆæ˜¯ï¼švue3 + pinia + vite</p><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p><code>hexo-theme-aurora</code>è¿è¡Œèµ·æ¥ä¼šå¼€å¯ <code>http://localhost:9666/</code>ç«¯å£ï¼Œä¼šä¸ä½ çš„ hexo æ‰“é€š <code>9966ç«¯å£</code> è®¿é—®çš„æ˜¯<code>ä½ çš„hexoåšå®¢é¡¹ç›®4000ç«¯å£</code>ï¼Œä¸»é¢˜èµ„æºæ˜¯<code>hexo-theme-aurora</code>,å‰å®³ï½</div><p>ä¸»è¦æ”¹ categories ç›¸å…³åŠŸèƒ½</p><img src="http://t-blog-images.aijs.top/img/20220624112340.webp" /><img src="http://t-blog-images.aijs.top/img/20220624112640.webp" /><hr/><h2 id="categories"><a href="#categories" class="headerlink" title="categories"></a>categories</h2><pre class="line-numbers language-log" data-language="log"><code class="language-log">Commit:        b1e1d23ed1bf320b1151db3a7708f3ea6078d5baAuthor:        æ˜Šå¤© &lt;haotian.chen@ty.com&gt;AuthorDate:    Fri Jun 24 11:51:04 2022Commit:        æ˜Šå¤© &lt;haotian.chen@ty.com&gt;CommitDate:    Fri Jun 24 11:51:04 2022fix categories----------------------------- _config.yml                                |   1 + æ–°å¢éƒ¨åˆ† src&#x2F;components&#x2F;Category&#x2F;CategoryItem.vue   | 110 +++++++++++++++++++++++++++++ src&#x2F;components&#x2F;Category&#x2F;CategoryList.vue   |  13 ++++ src&#x2F;components&#x2F;Category&#x2F;index.ts           |   2 + ä¿®æ”¹ä¸ºå¯ç‚¹å‡» src&#x2F;components&#x2F;Sidebar&#x2F;src&#x2F;CategoryBox.vue |  47 ++++-------- categoriesç©ºå¤šè¯­è¨€æç¤º src&#x2F;locales&#x2F;languages&#x2F;cn.json              |   1 + src&#x2F;locales&#x2F;languages&#x2F;en.json              |   1 + é…ç½®å¯¼èˆª src&#x2F;models&#x2F;ThemeConfig.class.ts            |   8 +++ å¢åŠ æ–°çš„categoryæŸ¥è¯¢ç»“æœ src&#x2F;router&#x2F;index.ts                        |   7 ++ fix åˆ†ç±»å±•ç¤ºæ•°æ® src&#x2F;views&#x2F;Category.vue                     |  75 ++++++++++++++------ 3ä¸­æƒ…å†µï¼Œå±•ç¤ºä¸åŒç»´åº¦çš„æ•°æ®å†…å®¹ src&#x2F;views&#x2F;Result.vue                       |  10 +++ 11 files changed, 220 insertions(+), 55 deletions(-)</code></pre><img src="http://t-blog-images.aijs.top/img/20220624120506.webp" /><p>å…·ä½“ä¿®æ”¹å†…å®¹<a href="https://github.com/841660202/hexo-theme-aurora/commit/b1e1d23ed1bf320b1151db3a7708f3ea6078d5ba" target="_blank" >è§</a></p><hr/><h2 id="Author-ä¿¡æ¯ä¸å±•ç¤º"><a href="#Author-ä¿¡æ¯ä¸å±•ç¤º" class="headerlink" title="Author ä¿¡æ¯ä¸å±•ç¤º"></a>Author ä¿¡æ¯ä¸å±•ç¤º</h2><img src="http://t-blog-images.aijs.top/img/20220624140553.webp" /><img src="http://t-blog-images.aijs.top/img/20220624140458.webp" /><p><a href="https://github.com/auroral-ui/hexo-theme-aurora/commit/e46b36250fa424993e8b0548b37bd0cecf2f0b60" target="_blank" >è§ fix author æ¥å£</a></p><hr/><h2 id="ä»£ç é…è‰²"><a href="#ä»£ç é…è‰²" class="headerlink" title="ä»£ç é…è‰²"></a>ä»£ç é…è‰²</h2><p><a href="https://github.com/auroral-ui/hexo-theme-aurora/commit/6aa84b720220d70242f8ef763e095ef6a9d06d5c" target="_blank" >è§ opt é…è‰²</a></p><h2 id="æ ·å¼é”™ä¹±"><a href="#æ ·å¼é”™ä¹±" class="headerlink" title="æ ·å¼é”™ä¹±"></a>æ ·å¼é”™ä¹±</h2><img src="http://t-blog-images.aijs.top/img/20220624141103.webp" /><pre class="line-numbers language-css" data-language="css"><code class="language-css">.article .article-content p &#123;  font-size: 1rem;  line-height: 1.5rem;  margin-bottom: 0.5rem;  padding-bottom: 1.5rem;  word-break: break-all; &#x2F;&#x2F; è¿™é‡Œ&#125;</code></pre><p><a href="https://github.com/auroral-ui/hexo-theme-aurora/commit/0af1a5a33b6665adbc0038f6310bc07b823698ec" target="_blank" >è§ fix p style</a></p><h2 id="a-æ ‡ç­¾æ ‡è®°"><a href="#a-æ ‡ç­¾æ ‡è®°" class="headerlink" title="a æ ‡ç­¾æ ‡è®°"></a>a æ ‡ç­¾æ ‡è®°</h2><p>æ ‡ç­¾çš„ target &#x3D; â€˜_blankâ€™ å±æ€§çš„å…ƒç´ </p><img src="http://t-blog-images.aijs.top/img/20220624141924.webp" /><p><a href="https://github.com/auroral-ui/hexo-theme-aurora/commit/7cce635a6cc89e81af0fc934d1cc45265a5a19be" target="_blank" >è§ å« a target&#x3D;_blank å±æ€§çš„å¢åŠ æ ‡è®°</a></p><h2 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h2><p>ä¸äº†è§£<code>patch</code>ï¼Œ<a href="http://v.aijs.top/post/2022-06-09patch-package" target="_blank" >æ›´å¤š</a></p><ol><li>ä¿®æ”¹åçš„<code>hexo-theme-aurora</code>é¡¹ç›®æ‰“åŒ…ï¼Œ</li><li>åšå®¢ä¸­ä¹‹å‰è¡¥ä¸ç§»é™¤ï¼Œä¹‹åé‡æ–°ç”Ÿæˆæ–°çš„è¡¥ä¸</li></ol><p><code>package.json</code></p><pre class="line-numbers language-json" data-language="json"><code class="language-json">-    &quot;patch:hexo-theme-aurora&quot;: &quot;yarn patch-package hexo-theme-aurora&quot;,-    &quot;postinstall&quot;: &quot;yarn patch-package&quot;</code></pre><ol start="3"><li><p>åˆ é™¤ <code>technology-blog/patches/hexo-theme-aurora+1.5.5.patch</code> è¡¥ä¸</p></li><li><p>æ‹·è´<code>hexo-theme-aurora</code>æ‰“åŒ…åçš„ä»£ç </p></li></ol><pre class="line-numbers language-none"><code class="language-none">source&#x2F;static ç›®å½•source&#x2F;layout ç›®å½•ï¼ˆhashæ”¹å˜ï¼Œè¿™ä¸ªä¹Ÿè¦æ¢æ–°çš„ï¼‰</code></pre><ol start="5"><li><p>ç”Ÿæˆè¡¥ä¸, æ‰§è¡Œ<code>yarn patch-package hexo-theme-aurora</code></p></li><li><p>package.json</p></li></ol><pre class="line-numbers language-json" data-language="json"><code class="language-json">+    &quot;patch:hexo-theme-aurora&quot;: &quot;yarn patch-package hexo-theme-aurora&quot;,+    &quot;postinstall&quot;: &quot;yarn patch-package&quot;</code></pre><h2 id="éƒ¨åˆ†è·¯ç”±åˆ·æ–°å-404"><a href="#éƒ¨åˆ†è·¯ç”±åˆ·æ–°å-404" class="headerlink" title="éƒ¨åˆ†è·¯ç”±åˆ·æ–°å 404"></a>éƒ¨åˆ†è·¯ç”±åˆ·æ–°å 404</h2><img src="http://t-blog-images.aijs.top/img/202207260934046.webp" />]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‚¹</title>
      <link href="//post/2022-06-23%E7%82%B9.html"/>
      <url>//post/2022-06-23%E7%82%B9.html</url>
      
        <content type="html"><![CDATA[<img src="http://t-blog-images.aijs.top/img/20220623175342.webp" /><p>è®°å¾—ä¹‹å‰åœ¨å“ªçœ‹åˆ°è¿‡æ˜¯jsè§£ææ—¶å€™çš„é—®é¢˜</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; æ¯”å¦‚ 1.toString() &#x2F;&#x2F; ä¼šè¢«è§£æè®¤ä¸ºè¿™ä¸ª.æ˜¯æ•°å­—1çš„ç‚¹ï¼Œå³ï¼š1. è¿™ä¸ªå«å°æ•°çš„æ•°Number(1).toString() &#x2F;&#x2F; ok1 .toString() &#x2F;&#x2F; ok&#x2F;&#x2F; é‚£ä¹ˆ &#123;&#125;.__proto__ &#x2F;&#x2F; å…ˆæ‰§è¡Œ &#123;&#125;. å°±ä¼šæŠ¥é”™ï¼Œè€Œä¸”æŠ¥é”™ä¸€æ · å¦‚ä¸‹å›¾(&#123;&#125;).__proto__ &#x2F;&#x2F; ok</code></pre><img src="http://t-blog-images.aijs.top/img/20220623175915.webp" />]]></content>
      
      
      <categories>
          
          <category> javaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>axios 1.0.0-alpha.1 æºç </title>
      <link href="//post/2022-06-23axios.html"/>
      <url>//post/2022-06-23axios.html</url>
      
        <content type="html"><![CDATA[<h2 id="å®˜ç½‘"><a href="#å®˜ç½‘" class="headerlink" title="å®˜ç½‘"></a>å®˜ç½‘</h2><p><a href="https://axios-http.com" target="_blank" >å®˜ç½‘é¦–é¡µ</a><br><a href="https://axios-http.com/docs/intro" target="_blank" >å®˜æ–¹æ–‡æ¡£ä»‹ç»</a><br><a href="https://axios-http.com/zh/docs/example" target="_blank" >ä¸­æ–‡æ–‡æ¡£</a></p><p>Promise based HTTP client for the browser and node.js<br><em>åŸºäº promise å¯ä»¥ç”¨äºæµè§ˆå™¨å’Œ node.js çš„ç½‘ç»œè¯·æ±‚åº“</em></p><p>Axios is a promise-based HTTP Client for node.js and the browser. It is isomorphic (&#x3D; it can run in the browser and nodejs with the same codebase). On the server-side it uses the native node.js http module, while on the client (browser) it uses XMLHttpRequests.<br><em>Axios æ˜¯ä¸€ä¸ªåŸºäº promise ç½‘ç»œè¯·æ±‚åº“ï¼Œä½œç”¨äº node.js å’Œæµè§ˆå™¨ä¸­ã€‚ å®ƒæ˜¯ isomorphicã€ŒåŒæ„ã€ çš„(å³åŒä¸€å¥—ä»£ç å¯ä»¥è¿è¡Œåœ¨æµè§ˆå™¨å’Œ node.js ä¸­)ã€‚åœ¨æœåŠ¡ç«¯å®ƒä½¿ç”¨åŸç”Ÿ node.js http æ¨¡å—, è€Œåœ¨å®¢æˆ·ç«¯ (æµè§ˆç«¯) åˆ™ä½¿ç”¨ XMLHttpRequestsã€‚</em></p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>ä»æµè§ˆå™¨åˆ›å»º XMLHttpRequests</li><li>ä» node.js åˆ›å»º http è¯·æ±‚</li><li>æ”¯æŒ Promise API</li><li>æ‹¦æˆªè¯·æ±‚å’Œå“åº”</li><li>è½¬æ¢è¯·æ±‚å’Œå“åº”æ•°æ®</li><li>å–æ¶ˆè¯·æ±‚</li><li>è‡ªåŠ¨è½¬æ¢ JSON æ•°æ®</li><li>å®¢æˆ·ç«¯æ”¯æŒé˜²å¾¡ XSRF</li></ul><h2 id="ä½¿ç”¨åŠ-Axios-API"><a href="#ä½¿ç”¨åŠ-Axios-API" class="headerlink" title="ä½¿ç”¨åŠ Axios API"></a>ä½¿ç”¨åŠ Axios API</h2><p><a href="https://axios-http.com/zh/docs/example" target="_blank" >get example ä½¿ç”¨</a><br><a href="https://axios-http.com/zh/docs/post_example" target="_blank" >post example ä½¿ç”¨</a><br><a href="https://axios-http.com/zh/docs/api_intro" target="_blank" >API</a></p><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>è¯·æ±‚æ–¹å¼åˆ«å<br>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œå·²ç»ä¸ºæ‰€æœ‰æ”¯æŒçš„è¯·æ±‚æ–¹æ³•æä¾›äº†åˆ«åã€‚</p><p>axios.request(config)<br>axios.get(url[, config])<br>axios.delete(url[, config])<br>axios.head(url[, config]) ?<br>axios.options(url[, config]) é¢„æ£€<br>axios.post(url[, data[, config]])<br>axios.put(url[, data[, config]])<br>axios.patch(url[, data[, config]])? patch æ–¹æ³•ç”¨æ¥æ›´æ–°å±€éƒ¨èµ„æº<br>æ³¨æ„<br>åœ¨ä½¿ç”¨åˆ«åæ–¹æ³•æ—¶ï¼Œ urlã€methodã€data è¿™äº›å±æ€§éƒ½ä¸å¿…åœ¨é…ç½®ä¸­æŒ‡å®šã€‚</p><p>restful åªæ˜¯æ ‡å‡†ï¼Œæ ‡å‡†çš„æ„æ€æ˜¯å¦‚æœåœ¨å¤§å®¶éƒ½ä¾æ­¤è¡Œäº‹çš„è¯ï¼Œæ²Ÿé€šæˆæœ¬ä¼šå¾ˆä½ï¼Œå¼€å‘æ•ˆç‡å°±é«˜ã€‚ä½†å¹¶éå¼ºåˆ¶(ä¹Ÿæ²¡äººå¼ºåˆ¶å¾—äº†)ï¼Œæ‰€ä»¥ä½ è¯´åœ¨ä½ çš„ç¨‹åºé‡ŒæŠŠæ–¹æ³•åä» put æ”¹æˆ patch æ²¡æœ‰ä»»ä½•å½±å“ï¼Œé‚£æ˜¯è‡ªç„¶ï¼Œå› ä¸ºä½ çš„åç«¯ç¨‹åºå¹¶æ²¡æœ‰æŒ‰ç…§æ ‡å‡†å¯¹ä¸¤ä¸ªæ–¹æ³•åšä¸åŒå¤„ç†ï¼Œå¥¹çš„è¡¨ç°è‡ªç„¶æ˜¯ä¸€æ ·çš„</p><p>å³çº¦å®šï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„äººéƒ½è¿™ä¹ˆå¹²ï¼Œå…·ä½“é¡¹ç›®å¦‚ä½•å®ç°ï¼Œè¿˜éœ€è¦å‰åç«¯ä¸€è‡´ï¼ˆæ‰“ä¸ªæ¯”æ–¹ï¼šæœ‰çš„åç«¯ç”¨ post åšåˆ é™¤ï¼Œç”¨ post åšæŸ¥è¯¢ï¼Œç”¨ post åšæ›´æ–°ï¼Œå†ä¸¾ä¸ªä¾‹å­ä¸‰è„šæ’å¤´æœ‰å¤§æœ‰å°ä¸çŸ¥é“ä½ æ™“ä¸æ™“å¾—ï¼Ÿåªè¦å¯¹åº”çš„æ’å­”æ˜¯å¯¹åº”çš„å¤§å°ä¹Ÿå°±å¯ä»¥è¿è¡Œï¼Œè¦ä¸ç„¶è¿ä¸ä¸Šï¼‰</p></p></div><p>â€¦</p><p><strong>axios.options(url[, config])</strong></p><p><a href="https://blog.csdn.net/csdnyp/article/details/122651869">axios ä¸­ä¸ºä»€ä¹ˆä¼šæœ‰ OPTIONS è¯·æ±‚</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æµè§ˆå™¨é™åˆ¶è·¨åŸŸ<br>æµè§ˆå™¨é™åˆ¶è·¨åŸŸè¯·æ±‚ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š<br>1ã€é™åˆ¶å‘èµ·è·¨åŸŸè¯·æ±‚<br>2ã€è·¨åŸŸè¯·æ±‚å¯ä»¥æ­£å¸¸å‘èµ·ï¼Œä½†æ˜¯è¿”å›çš„ç»“æœä¼šè¢«æµè§ˆå™¨æ‹¦æˆª</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šä»¥ç¬¬äºŒç§æ–¹å¼é™åˆ¶è·¨åŸŸè¯·æ±‚ã€‚è¿™ç§å­˜åœ¨ä¸€ç§æƒ…å†µï¼Œ_è¯·æ±‚å·²ç»åˆ°è¾¾æœåŠ¡å™¨å¹¶å“åº”äº†æŸäº›æ“ä½œï¼Œæ”¹å˜äº†æ•°æ®åº“æ•°æ®ï¼Œä½†æ˜¯è¿”å›çš„ç»“æœä¼šè¢«æµè§ˆå™¨æ‹¦æˆªï¼Œç”¨æˆ·å°±ä¸èƒ½å–åˆ°ç›¸åº”çš„ç»“æœè¿›è¡Œåç»­çš„æ“ä½œ_ã€‚<strong>æ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæµè§ˆå™¨å°±ä¼šé€šè¿‡ OPTIONS æ–¹æ³•å¯¹è¯·æ±‚è¿›è¡Œé¢„æ£€ï¼Œé€šè¿‡è¯¢é—®æœåŠ¡å™¨æ˜¯å¦å…è®¸è¿™æ¬¡è¯·æ±‚ï¼Œå…è®¸ä¹‹åï¼ŒæœåŠ¡å™¨æ‰ä¼šå“åº”çœŸå®è¯·æ±‚ï¼Œå¦åˆ™å°±é˜»æ­¢çœŸå®è¯·æ±‚</strong>ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>é¡¹ç›®ä¸­éœ€è¦ OPTIONS é¢„æ£€å—ï¼Ÿ<br>ç”¨æˆ·ç™»é™†ä¹‹åï¼Œæˆ‘ä»¬ä¼šè·å– token å€¼ï¼Œåœ¨æ¯ä¸€æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œè¯·æ±‚å¤´éƒ½ä¼šæºå¸¦è¿™ä¸ª token å€¼ï¼Œæ‰€ä»¥ä¼šè§¦å‘é¢„æ£€è¯·æ±‚ã€‚å› ä¸ºç›®å‰é™¤äº†ç™»å½•ï¼Œå…¶ä»–è¯·æ±‚æ¥å£è¯·æ±‚å¤´éƒ½æºå¸¦äº† tokenï¼Œè€Œä¸”æˆ‘ä»¬çš„ Content-Type ç»å¤§å¤šæ•°æ˜¯ application&#x2F;jsonï¼Œæ‰€ä»¥é¢„æ£€æ€»ä¼šå­˜åœ¨ã€‚å¦‚æœä¸æƒ³å‘èµ· OPTIONS é¢„æ£€è¯·æ±‚ï¼Œå»ºè®®åç«¯åœ¨è¯·æ±‚çš„è¿”å›å¤´éƒ¨æ·»åŠ ï¼šAccess-Control-Max-Age:(number)ã€‚</p></blockquote><p><a href="https://blog.csdn.net/u011200562/article/details/110431341" target="_blank" >Access-Control-Max-Age æ˜¯ä»€ä¹ˆ</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œå°±æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨ä¼šé™åˆ¶ä»è„šæœ¬å‘èµ·çš„è·¨åŸŸ HTTP è¯·æ±‚ï¼ˆæ¯”å¦‚å¼‚æ­¥è¯·æ±‚ GET, POST, PUT, DELETE, OPTIONS ç­‰ç­‰ï¼‰ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šå‘æ‰€è¯·æ±‚çš„æœåŠ¡å™¨å‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡æ˜¯æµè§ˆå™¨ä½¿ç”¨ OPTIONS æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯çœŸæ­£çš„å¼‚æ­¥è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡çš„é¢„æ£€è¯·æ±‚è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥è·¨åŸŸè¯·æ±‚ï¼šå¦‚æœå…è®¸ï¼Œæ‰å‘èµ·ç¬¬äºŒæ¬¡çœŸå®çš„è¯·æ±‚ï¼›å¦‚æœä¸å…è®¸ï¼Œåˆ™æ‹¦æˆªç¬¬äºŒæ¬¡è¯·æ±‚ã€‚</p><p>Access-Control-Max-Age ç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ï¼Œï¼Œåœ¨æ­¤æœŸé—´ä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>resp.addHeader(â€œAccess-Control-Max-Ageâ€, â€œ0â€)ï¼Œè¡¨ç¤ºæ¯æ¬¡å¼‚æ­¥è¯·æ±‚éƒ½å‘èµ·é¢„æ£€è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€ä¸¤æ¬¡è¯·æ±‚ã€‚</p><p>resp.addHeader(â€œAccess-Control-Max-Ageâ€, â€œ1800â€)ï¼Œè¡¨ç¤ºéš” 30 åˆ†é’Ÿæ‰å‘èµ·é¢„æ£€è¯·æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€ä¸¤æ¬¡è¯·æ±‚</p></blockquote><h2 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h2><ol><li><p><a href="https://axios-http.com/zh/docs/config_defaults#:~:text=%3D%20AUTH_TOKEN%3B-,%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7,-%E9%85%8D%E7%BD%AE%E5%B0%86%E4%BC%9A%E6%8C%89" target="_blank" >é…ç½®çš„ä¼˜å…ˆçº§</a><br>é…ç½®å°†ä¼šæŒ‰ä¼˜å…ˆçº§è¿›è¡Œåˆå¹¶ã€‚å®ƒçš„é¡ºåºæ˜¯ï¼šåœ¨ <code>lib/defaults.js</code> ä¸­æ‰¾åˆ°çš„åº“é»˜è®¤å€¼ï¼Œç„¶åæ˜¯å®ä¾‹çš„ <code>defaults</code> å±æ€§ï¼Œæœ€åæ˜¯<code>è¯·æ±‚çš„ config å‚æ•°</code>ã€‚åé¢çš„ä¼˜å…ˆçº§è¦é«˜äºå‰é¢çš„ã€‚ä¸‹é¢æœ‰ä¸€ä¸ªä¾‹å­ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ä½¿ç”¨åº“æä¾›çš„é»˜è®¤é…ç½®åˆ›å»ºå®ä¾‹&#x2F;&#x2F; æ­¤æ—¶è¶…æ—¶é…ç½®çš„é»˜è®¤å€¼æ˜¯ &#96;0&#96;const instance &#x3D; axios.create();&#x2F;&#x2F; é‡å†™åº“çš„è¶…æ—¶é»˜è®¤å€¼&#x2F;&#x2F; ç°åœ¨ï¼Œæ‰€æœ‰ä½¿ç”¨æ­¤å®ä¾‹çš„è¯·æ±‚éƒ½å°†ç­‰å¾… 2.5 ç§’ï¼Œç„¶åæ‰ä¼šè¶…æ—¶instance.defaults.timeout &#x3D; 2500;&#x2F;&#x2F; é‡å†™æ­¤è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œå› ä¸ºè¯¥è¯·æ±‚éœ€è¦å¾ˆé•¿æ—¶é—´instance.get(&quot;&#x2F;longRequest&quot;, &#123;  timeout: 5000,&#125;);</code></pre></li><li><p>ç‰ˆæœ¬å‘å¸ƒæ²¡æœ‰éµå®ˆ<code>è¯­ä¹‰åŒ–ç‰ˆæœ¬</code></p></li></ol><p>åœ¨ redux ç« èŠ‚æ›¾èŠè¿‡åŒ…çš„ç‰ˆæœ¬, å¿…é¡»æœ‰, è¦ç¬¦åˆ<a href="https://docs.npmjs.com/about-semantic-versioning">semantic versioning guidelines</a>, å‚è€ƒ <a href="https://semver.org/lang/zh-CN/">è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ</a>, å»ºè®®ä»”ç»†é€šè¯»<br><img src="http://t-blog-images.aijs.top/img/20220525140247.webp" width=600 style="object-fit: content"/></p><p></p><h2 id="å‡è®¾"><a href="#å‡è®¾" class="headerlink" title="å‡è®¾"></a>å‡è®¾</h2><p>å·²ç»é€šè¿‡å®˜æ–¹æ–‡æ¡£å¯¹ axios çš„ä½¿ç”¨å’Œ api å·²ç»æœ‰äº†åˆæ­¥çš„äº†è§£</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><ul><li>äº†è§£ç‰¹æ€§çš„å®ç°è¿‡ç¨‹</li><li>äº†è§£ api çš„å®ç°è¿‡ç¨‹</li><li>çœ‹çœ‹ä»£ç é ä¸é è°±ï¼Œæœ‰æ²¡æœ‰â€œå½©è›‹â€(è›™å»ï½ï¼Œæˆ‘æ—©ä¸Šçªç„¶å†’çš„æƒ³æ³•ï¼Œç«Ÿç„¶åœ¨ä¸‹åˆçœŸçš„é‡åˆ°äº†ï¼Œç›´è§‰ï½)</li></ul><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.â”œâ”€â”€ CHANGELOG.mdâ”œâ”€â”€ CODE_OF_CONDUCT.mdâ”œâ”€â”€ COLLABORATOR_GUIDE.mdâ”œâ”€â”€ CONTRIBUTING.mdâ”œâ”€â”€ ECOSYSTEM.mdâ”œâ”€â”€ LICENSEâ”œâ”€â”€ README.mdâ”œâ”€â”€ SECURITY.mdâ”œâ”€â”€ UPGRADE_GUIDE.mdâ”œâ”€â”€ binâ”œâ”€â”€ bower.json # ç”¨äºbower installâ”œâ”€â”€ distâ”œâ”€â”€ examplesâ”œâ”€â”€ gulpfile.js # gulpä»»åŠ¡â”œâ”€â”€ index.d.tsâ”œâ”€â”€ index.jsâ”œâ”€â”€ karma.conf.cjsâ”œâ”€â”€ libâ”œâ”€â”€ package-lock.jsonâ”œâ”€â”€ package.json # &quot;build&quot;: &quot;gulp clear &amp;&amp; cross-env NODE_ENV&#x3D;production rollup -c -m&quot;,â”œâ”€â”€ rollup.config.js # rollup æ‰“åŒ…é…ç½®â”œâ”€â”€ sandbox # ä¸€ä¸ªå‰åç«¯æµ‹è¯•demoâ”œâ”€â”€ testâ”œâ”€â”€ tsconfig.jsonâ”œâ”€â”€ tslint.jsonâ””â”€â”€ webpack.config.js # webpacké…ç½®ï¼Œæ²¡æœ‰ä½¿ç”¨çš„æ ·å­6 directories, 20 files</code></pre><h2 id="gulpfile-js"><a href="#gulpfile-js" class="headerlink" title="gulpfile.js"></a>gulpfile.js</h2><p>gulpfile ç°åœ¨é¡¹ç›®å¾ˆå°‘è§ï¼Œä¸Šæ¬¡è§æ˜¯åœ¨ 2017 å¹´çš„æ—¶å€™äº†ï¼Œä¸€å¼€å§‹ï¼Œæˆ‘çœ‹åˆ°æœ‰ æ ¹ç›®å½•<code>bower.json</code> <code>gulpfile.js</code> <code>rollup.config.js</code> <code>webpack.config.js</code>,æœ‰ç‚¹æ‡µé€¼ï½</p><img src="http://t-blog-images.aijs.top/img/20220623135204.webp"/><h2 id="bower-json"><a href="#bower-json" class="headerlink" title="bower.json"></a>bower.json</h2><p><strong>äº†è§£ä¸‹ï¼Œæœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œä»¥åä¼°è®¡ä¹Ÿç”¨ä¸åˆ°</strong></p><p><a href="https://baijiahao.baidu.com/s?id=1710656712337561707&wfr=spider&for=pc" target="_blank" >bower ä»‹ç»è§</a><br><a href="https://github.com/bower/bower" target="_blank" >github ä»“åº“</a></p><p>Bower æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œå®ƒå¯ç”¨äºæœç´¢ã€å®‰è£…å’Œå¸è½½å¦‚ JavaScriptã€HTMLã€CSS<br>ä¹‹ç±»çš„ç½‘ç»œèµ„æºï¼ŒBower æ˜¯ Web å¼€å‘ä¸­çš„ä¸€ä¸ªå‰ç«¯æ–‡ä»¶åŒ…ç®¡ç†å™¨ï¼Œç±»ä¼¼äº Node æ¨¡å—çš„<br>npm åŒ…ç®¡ç†å™¨ï¼Œbower ä¾èµ–äº Gitã€Node å’Œ npmã€‚</p><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>çœ‹å®Œä¸Šè¿°å‡ ä¸ªæ–‡ä»¶æœ‰ç‚¹æ‡µï¼Œå·¥å…·åƒæ˜¯é‡å¤çš„æ ·å­</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;scripts&quot;: &#123;  &quot;test&quot;: &quot;npm run test:eslint &amp;&amp; npm run test:mocha &amp;&amp; npm run test:karma &amp;&amp; npm run test:dtslint&quot;,  &quot;test:eslint&quot;: &quot;node bin&#x2F;ssl_hotfix.js eslint lib&#x2F;**&#x2F;*.js&quot;,  &quot;test:dtslint&quot;: &quot;node bin&#x2F;ssl_hotfix.js dtslint&quot;,  &quot;test:mocha&quot;: &quot;node bin&#x2F;ssl_hotfix.js mocha test&#x2F;unit&#x2F;**&#x2F;*.js --timeout 30000 --exit&quot;,  &quot;test:karma&quot;: &quot;node bin&#x2F;ssl_hotfix.js cross-env LISTEN_ADDR&#x3D;:: karma start karma.conf.cjs --single-run&quot;,  &quot;test:karma:server&quot;: &quot;node bin&#x2F;ssl_hotfix.js cross-env karma start karma.conf.cjs&quot;,  &quot;start&quot;: &quot;node .&#x2F;sandbox&#x2F;server.js&quot;,  &quot;preversion&quot;: &quot;gulp version &amp;&amp; npm test&quot;,  &quot;version&quot;: &quot;npm run build &amp;&amp; git add dist &amp;&amp; git add package.json&quot;,  &quot;prepublishOnly&quot;: &quot;npm test&quot;,  &quot;postpublish&quot;: &quot;git push &amp;&amp; git push --tags &quot;,  &quot;build&quot;: &quot;gulp clear &amp;&amp; cross-env NODE_ENV&#x3D;production rollup -c -m&quot;, &#x2F;&#x2F; æ‰“åŒ…åªç”¨åˆ°äº†gulp å’Œ rollupï¼Œæ²¡æœ‰ç”¨åˆ°webpack,webpack.config.jsæ˜¯å¤šä½™çš„  &quot;examples&quot;: &quot;node .&#x2F;examples&#x2F;server.js&quot;,  &quot;coveralls&quot;: &quot;cat coverage&#x2F;lcov.info | .&#x2F;node_modules&#x2F;coveralls&#x2F;bin&#x2F;coveralls.js&quot;,  &quot;fix&quot;: &quot;eslint --fix lib&#x2F;**&#x2F;*.js&quot;&#125;,</code></pre><h2 id="rollup-config-js"><a href="#rollup-config-js" class="headerlink" title="rollup.config.js"></a>rollup.config.js</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">import resolve from &quot;@rollup&#x2F;plugin-node-resolve&quot;;import commonjs from &quot;@rollup&#x2F;plugin-commonjs&quot;;import &#123; terser &#125; from &quot;rollup-plugin-terser&quot;;import json from &quot;@rollup&#x2F;plugin-json&quot;;import &#123; babel &#125; from &quot;@rollup&#x2F;plugin-babel&quot;;import autoExternal from &quot;rollup-plugin-auto-external&quot;;const lib &#x3D; require(&quot;.&#x2F;package.json&quot;);const outputFileName &#x3D; &quot;axios&quot;;const name &#x3D; &quot;axios&quot;;const input &#x3D; &quot;.&#x2F;lib&#x2F;axios.js&quot;; &#x2F;&#x2F; æºç å…¥å£&#x2F;&#x2F; minifiedVersionå‚æ•°æœ€å°åŒ–ï¼Œé»˜è®¤trueï¼Œä¸‹é¢ä¸‰å¤„è°ƒç”¨éƒ½æ²¡æœ‰ä¼ ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸webpack.config.jsæ— å…³const buildConfig &#x3D; (&#123;  es5,  browser &#x3D; true,  minifiedVersion &#x3D; true,  ...config&#125;) &#x3D;&gt; &#123;  const build &#x3D; (&#123; minified &#125;) &#x3D;&gt; (&#123;    input,    ...config,    output: &#123;      ...config.output, &#x2F;&#x2F; é‡Œé¢æœ‰bannerä¿¡æ¯      file: &#96;$&#123;config.output.file&#125;.$&#123;minified ? &quot;min.js&quot; : &quot;js&quot;&#125;&#96;,    &#125;,    plugins: [      json(),      resolve(&#123; browser &#125;),      commonjs(),      minified &amp;&amp; terser(),      ...(es5        ? [            babel(&#123;              babelHelpers: &quot;bundled&quot;,              presets: [&quot;@babel&#x2F;preset-env&quot;],            &#125;),          ]        : []),      ...(config.plugins || []),    ],  &#125;);  const configs &#x3D; [build(&#123; minified: false &#125;)];  if (minifiedVersion) &#123;    build(&#123; minified: true &#125;);  &#125;  return configs;&#125;;export default async () &#x3D;&gt; &#123;  const year &#x3D; new Date().getFullYear();  const banner &#x3D; &#96;&#x2F;&#x2F; Axios v$&#123;lib.version&#125; Copyright (c) $&#123;year&#125; $&#123;lib.author&#125; and contributors&#96;;  return [    ...buildConfig(&#123;      es5: true,      output: &#123;        file: &#96;dist&#x2F;$&#123;outputFileName&#125;&#96;,        name,        format: &quot;umd&quot;, &#x2F;&#x2F; umdæ ¼å¼        exports: &quot;default&quot;,        banner,      &#125;,    &#125;),    ...buildConfig(&#123;      output: &#123;        file: &#96;dist&#x2F;esm&#x2F;$&#123;outputFileName&#125;&#96;,        format: &quot;esm&quot;, &#x2F;&#x2F; esmæ ¼å¼        preferConst: true,        exports: &quot;named&quot;,        banner,      &#125;,    &#125;),    &#x2F;&#x2F; Node.js commonjs build    &#123;      input,      output: &#123;        file: &#96;dist&#x2F;node&#x2F;$&#123;name&#125;.cjs&#96;,        format: &quot;cjs&quot;, &#x2F;&#x2F; commonjsæ ¼å¼        preferConst: true,        exports: &quot;default&quot;,        banner,      &#125;,      plugins: [autoExternal(), resolve(), commonjs()],    &#125;,  ];&#125;;</code></pre><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ğŸ‘‘ ~&#x2F;Desktop&#x2F;axios git:(v1.x) âœ— $ yarn buildyarn run v1.4.0$ gulp clear &amp;&amp; cross-env NODE_ENV&#x3D;production rollup -c -m[14:19:33] Using gulpfile ~&#x2F;Desktop&#x2F;axios&#x2F;gulpfile.js[14:19:33] Starting &#39;clear&#39;...[14:19:33] Finished &#39;clear&#39; after 5.74 ms[!] Error: Cannot find module &#39;@babel&#x2F;core&#39;Require stack:- &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;node_modules&#x2F;@rollup&#x2F;plugin-babel&#x2F;dist&#x2F;index.js- &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;rollup.config.js- &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;node_modules&#x2F;rollup&#x2F;dist&#x2F;shared&#x2F;loadConfigFile.js- &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;node_modules&#x2F;rollup&#x2F;dist&#x2F;bin&#x2F;rollupError: Cannot find module &#39;@babel&#x2F;core&#39;è§£å†³ï¼šğŸ‘‘ ~&#x2F;Desktop&#x2F;axios git:(v1.x) âœ— $ yarn add @babel&#x2F;core -Dyarn add v1.4.0[1&#x2F;4] ğŸ”  Resolving packages...[2&#x2F;4] ğŸšš  Fetching packages...warning Pattern [&quot;@definitelytyped&#x2F;typescript-versions@latest&quot;] is trying to unpack in the same destination &quot;&#x2F;Users&#x2F;haotian&#x2F;Library&#x2F;Caches&#x2F;Yarn&#x2F;v1&#x2F;npm-@definitelytyped&#x2F;typescript-versions-0.0.118-de13fb755c5181443860c3c74b6730f47f6541fc&quot; as pattern [&quot;@definitelytyped&#x2F;typescript-versions@^0.0.118&quot;,&quot;@definitelytyped&#x2F;typescript-versions@^0.0.118&quot;,&quot;@definitelytyped&#x2F;typescript-versions@^0.0.118&quot;]. This could result in non-deterministic behavior, skipping.[3&#x2F;4] ğŸ”—  Linking dependencies...warning &quot; &gt; @rollup&#x2F;plugin-babel@5.3.1&quot; has unmet peer dependency &quot;@types&#x2F;babel__core@^7.1.9&quot;.warning &quot; &gt; istanbul-instrumenter-loader@3.0.1&quot; has unmet peer dependency &quot;webpack@^2.0.0 || ^3.0.0 || ^4.0.0&quot;.warning &quot;karma &gt; socket.io &gt; engine.io &gt; ws@8.2.3&quot; has unmet peer dependency &quot;bufferutil@^4.0.1&quot;.warning &quot;karma &gt; socket.io &gt; engine.io &gt; ws@8.2.3&quot; has unmet peer dependency &quot;utf-8-validate@^5.0.2&quot;.warning &quot;karma-sauce-launcher &gt; webdriverio &gt; puppeteer-core &gt; node-fetch@2.6.7&quot; has unmet peer dependency &quot;encoding@^0.1.0&quot;.warning &quot;karma-sauce-launcher &gt; webdriverio &gt; puppeteer-core &gt; ws@7.5.8&quot; has unmet peer dependency &quot;bufferutil@^4.0.1&quot;.warning &quot;karma-sauce-launcher &gt; webdriverio &gt; puppeteer-core &gt; ws@7.5.8&quot; has unmet peer dependency &quot;utf-8-validate@^5.0.2&quot;.warning &quot; &gt; terser-webpack-plugin@4.2.3&quot; has unmet peer dependency &quot;webpack@^4.0.0 || ^5.0.0&quot;.[4&#x2F;4] ğŸ“ƒ  Building fresh packages...success Saved lockfile.success Saved 5 new dependencies.â”œâ”€ @ampproject&#x2F;remapping@2.2.0â”œâ”€ @babel&#x2F;core@7.18.5â”œâ”€ @babel&#x2F;helpers@7.18.2â”œâ”€ gensync@1.0.0-beta.2â””â”€ json5@2.2.1âœ¨  Done in 37.80s.ğŸ‘‘ ~&#x2F;Desktop&#x2F;axios git:(v1.x) âœ— $ yarn buildyarn run v1.4.0$ gulp clear &amp;&amp; cross-env NODE_ENV&#x3D;production rollup -c -m[14:20:32] Using gulpfile ~&#x2F;Desktop&#x2F;axios&#x2F;gulpfile.js[14:20:32] Starting &#39;clear&#39;...[14:20:32] Finished &#39;clear&#39; after 48 ms.&#x2F;lib&#x2F;axios.js â†’ dist&#x2F;axios.js...created dist&#x2F;axios.js in 3.5s.&#x2F;lib&#x2F;axios.js â†’ dist&#x2F;esm&#x2F;axios.js...created dist&#x2F;esm&#x2F;axios.js in 711ms.&#x2F;lib&#x2F;axios.js â†’ dist&#x2F;node&#x2F;axios.cjs...created dist&#x2F;node&#x2F;axios.cjs in 1.1sâœ¨  Done in 9.39s.ğŸ‘‘ ~&#x2F;Desktop&#x2F;axios git:(v1.x) âœ— $</code></pre></p></div><h2 id="æ‰“åŒ…äº§ç‰©"><a href="#æ‰“åŒ…äº§ç‰©" class="headerlink" title="æ‰“åŒ…äº§ç‰©"></a>æ‰“åŒ…äº§ç‰©</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.â”œâ”€â”€ axios.jsâ”œâ”€â”€ axios.js.mapâ”œâ”€â”€ esmâ”‚   â”œâ”€â”€ axios.jsâ”‚   â””â”€â”€ axios.js.mapâ””â”€â”€ node    â”œâ”€â”€ axios.cjs    â””â”€â”€ axios.cjs.map2 directories, 6 files</code></pre><p>å“ï¼Ÿå’‹æ»´å›äº‹ï¼Œæˆ‘ä»¬åœ¨<code>rollup.config.js</code>è§åˆ°<code>minifiedVersion</code>é»˜è®¤æ˜¯<code>true</code>,ä¼ ç»™ <code>minified</code>å’‹çš„æ²¡è§<code>min.js</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const configs &#x3D; [build(&#123; minified: false &#125;)];if (minifiedVersion) &#123;  build(&#123; minified: true &#125;); &#x2F;&#x2F; è¿™ä¹ˆäº›åº”è¯¥æ˜¯ä¸ºäº†å¼€å‘è°ƒè¯•ï¼Œåœ¨sandboxä¸­ &lt;script src&#x3D;&quot;&#x2F;axios.js&quot;&gt;&lt;&#x2F;script&gt;&#125;return configs;&#x2F;&#x2F; è¿™é‡Œæš´éœ²çš„æ˜¯configsï¼Œ build(&#123;minified: true&#125;)å®Œå…¨æ²¡æäº‹æƒ…ï¼Œ&#x2F;&#x2F; è¿™ä»£ç åº”è¯¥æ˜¯ç”¨ build(&#123;minified: true&#125;) æ›¿æ¢   build(&#123;minified: false&#125;) æ‰å¯¹</code></pre><p>ä¿®æ”¹ä¸‹ï¼Œç„¶åè¿è¡Œ<code>yarn build</code></p><img src="http://t-blog-images.aijs.top/img/20220623143251.webp" /><h2 id="axios-js"><a href="#axios-js" class="headerlink" title="axios.js"></a>axios.js</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&quot;use strict&quot;;import utils from &quot;.&#x2F;utils.js&quot;;import bind from &quot;.&#x2F;helpers&#x2F;bind.js&quot;;import Axios from &quot;.&#x2F;core&#x2F;Axios.js&quot;;import mergeConfig from &quot;.&#x2F;core&#x2F;mergeConfig.js&quot;;import defaults from &quot;.&#x2F;defaults&#x2F;index.js&quot;;import formDataToJSON from &quot;.&#x2F;helpers&#x2F;formDataToJSON.js&quot;;import CanceledError from &quot;.&#x2F;cancel&#x2F;CanceledError.js&quot;;import CancelToken from &quot;.&#x2F;cancel&#x2F;CancelToken.js&quot;;import isCancel from &quot;.&#x2F;cancel&#x2F;isCancel.js&quot;;import &#123; VERSION &#125; from &quot;.&#x2F;env&#x2F;data.js&quot;;import toFormData from &quot;.&#x2F;helpers&#x2F;toFormData.js&quot;;import AxiosError from &quot;..&#x2F;lib&#x2F;core&#x2F;AxiosError.js&quot;;import spread from &quot;.&#x2F;helpers&#x2F;spread.js&quot;;import isAxiosError from &quot;.&#x2F;helpers&#x2F;isAxiosError.js&quot;;&#x2F;** * Create an instance of Axios * * @param &#123;Object&#125; defaultConfig The default config for the instance * * @returns &#123;Axios&#125; A new instance of Axios *&#x2F;function createInstance(defaultConfig) &#123;  const context &#x3D; new Axios(defaultConfig);  const instance &#x3D; bind(Axios.prototype.request, context);  &#x2F;&#x2F; Copy axios.prototype to instance  &#x2F;&#x2F; æ‹·è´åŸå‹åˆ°å®ä¾‹  utils.extend(instance, Axios.prototype, context, &#123; allOwnKeys: true &#125;);  &#x2F;&#x2F; Copy context to instance  &#x2F;&#x2F; æ‹·è´ä¸Šä¸‹æ–‡åˆ°å®ä¾‹  utils.extend(instance, context, &#123; allOwnKeys: true &#125;);  &#x2F;&#x2F; Factory for creating new instances  &#x2F;&#x2F; ç”¨äºåˆ›å»ºæ–°å®ä¾‹çš„å·¥å‚  instance.create &#x3D; function create(instanceConfig) &#123;    return createInstance(mergeConfig(defaultConfig, instanceConfig));  &#125;;  return instance;&#125;&#x2F;&#x2F; Create the default instance to be exported&#x2F;&#x2F; ä½¿ç”¨é»˜è®¤é…ç½®åˆ›å»ºå®ä¾‹const axios &#x3D; createInstance(defaults);&#x2F;&#x2F; Expose Axios class to allow class inheritance&#x2F;&#x2F; æš´éœ²Axiosç±»ï¼Œå…è®¸ç±»è¢«ç»§æ‰¿axios.Axios &#x3D; Axios;&#x2F;&#x2F; Expose Cancel &amp; CancelTokenaxios.CanceledError &#x3D; CanceledError;axios.CancelToken &#x3D; CancelToken;axios.isCancel &#x3D; isCancel;axios.VERSION &#x3D; VERSION; &#x2F;&#x2F; gulpçš„envä»»åŠ¡ä¼šå°†package.jsonçš„ç‰ˆæœ¬ä¿¡æ¯è¯»å–å¹¶å†™å…¥ .&#x2F;lib&#x2F;env&#x2F;data.jsï¼Œè§ä¸‹é¢ä»£ç ï¼š&#x2F;&#x2F; const env &#x3D; gulp.task(&#39;env&#39;, async function () &#123;&#x2F;&#x2F;   var npm &#x3D; JSON.parse(await fs.readFile(&#39;package.json&#39;));&#x2F;&#x2F;   await fs.writeFile(&#39;.&#x2F;lib&#x2F;env&#x2F;data.js&#39;, Object.entries(&#123;&#x2F;&#x2F;     VERSION: npm.version&#x2F;&#x2F;   &#125;).map(([key, value]) &#x3D;&gt; &#123;&#x2F;&#x2F;     return &#96;export const $&#123;key&#125; &#x3D; $&#123;JSON.stringify(value)&#125;;&#96;&#x2F;&#x2F;   &#125;).join(&#39;\n&#39;));&#x2F;&#x2F; &#125;);axios.toFormData &#x3D; toFormData;&#x2F;&#x2F; Expose AxiosError class&#x2F;&#x2F; æš´éœ²AxuosErroré”™è¯¯ç±»axios.AxiosError &#x3D; AxiosError;&#x2F;&#x2F; alias for CanceledError for backward compatibility&#x2F;&#x2F; CanceledErrorçš„åˆ«åç”¨äºå‘åå…¼å®¹axios.Cancel &#x3D; axios.CanceledError;&#x2F;&#x2F; Expose all&#x2F;spread&#x2F;&#x2F; æš´éœ²å¹¶å‘axios.all &#x3D; function all(promises) &#123;  return Promise.all(promises);&#125;;&#x2F;&#x2F; æš´éœ²spreadaxios.spread &#x3D; spread; &#x2F;&#x2F; ä½¿ç”¨å°¾éƒ¨è°ƒç”¨æŸ¯é‡ŒåŒ–ï¼Œæ‰§è¡Œçš„ç»“æœè¿˜æ˜¯ä¸€ä¸ªå‡½æ•°&#x2F;&#x2F; Expose isAxiosError&#x2F;&#x2F; æš´éœ²åˆ¤æ–­AxiosErrorçš„æ–¹æ³•axios.isAxiosError &#x3D; isAxiosError;axios.formToJSON &#x3D; (thing) &#x3D;&gt; &#123;  &#x2F;&#x2F; è°ƒç”¨å·¥å…·ï¼Œå°†thingè¿›è¡ŒjsonåŒ–  return formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);&#125;;export default axios;</code></pre><p>å…¶ä»–ç»†èŠ‚ä¸çœ‹</p><h2 id="è¿è¡Œ-sandbox"><a href="#è¿è¡Œ-sandbox" class="headerlink" title="è¿è¡Œ sandbox"></a>è¿è¡Œ sandbox</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yarn start</code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ğŸ‘‘ ~&#x2F;Desktop&#x2F;axios git:(v1.x) âœ— $ yarn startyarn run v1.4.0$ node .&#x2F;sandbox&#x2F;server.jsListening on localhost:3009...[Thu Jun 23 2022 16:16:31 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)] GET &#x2F;file:&#x2F;&#x2F;&#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;sandbox&#x2F;server.js:14  fs.createReadStream(path.join(__dirname, file)).pipe(res);                                ^ReferenceError: __dirname is not defined    at pipeFileToResponse (file:&#x2F;&#x2F;&#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;sandbox&#x2F;server.js:14:33)    at Server.&lt;anonymous&gt; (file:&#x2F;&#x2F;&#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;sandbox&#x2F;server.js:30:5)    at Server.emit (node:events:390:28)    at parserOnIncoming (node:_http_server:951:12)    at HTTPParser.parserOnHeadersComplete (node:_http_common:128:17)error An unexpected error occurred: &quot;Command failed.\nExit code: 1\nCommand: sh\nArguments: -c node .&#x2F;sandbox&#x2F;server.js\nDirectory: &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios\nOutput:\n&quot;.info If you think this is a bug, please open a bug report with the information provided in &quot;&#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;axios&#x2F;yarn-error.log&quot;.info Visit https:&#x2F;&#x2F;yarnpkg.com&#x2F;en&#x2F;docs&#x2F;cli&#x2F;run for documentation about this command.</code></pre><p>ä¿®æ”¹</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const __filename &#x3D; url.fileURLToPath(import.meta.url); &#x2F;&#x2F; å¢åŠ è¿™è¡Œ @see https:&#x2F;&#x2F;developer.mozilla.org&#x2F;zh-CN&#x2F;docs&#x2F;Web&#x2F;JavaScript&#x2F;Reference&#x2F;Statements&#x2F;import.metaconst __dirname &#x3D; path.dirname(__filename); &#x2F;&#x2F; å¢åŠ è¿™è¡Œfunction pipeFileToResponse(res, file, type) &#123;  if (type) &#123;    res.writeHead(200, &#123;      &quot;Content-Type&quot;: type,    &#125;);  &#125;  fs.createReadStream(path.join(__dirname, file)).pipe(res);&#125;</code></pre><img src="http://t-blog-images.aijs.top/img/20220623162402.webp" /><h2 id="core-ç›®å½•"><a href="#core-ç›®å½•" class="headerlink" title="core ç›®å½•"></a>core ç›®å½•</h2><h2 id="axios-æ‰§è¡Œæµç¨‹"><a href="#axios-æ‰§è¡Œæµç¨‹" class="headerlink" title="axios æ‰§è¡Œæµç¨‹"></a>axios æ‰§è¡Œæµç¨‹</h2><p>æ‰§è¡Œæµç¨‹</p><p>å…ˆçœ‹çœ‹æ•´ä½“æ‰§è¡Œæµç¨‹ï¼Œæœ‰å¤§ä½“çš„æ¦‚å¿µï¼Œåé¢ä¼šç»†è¯´æ•´ä½“æµç¨‹æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>axios.create åˆ›å»ºå•ç‹¬å®ä¾‹ï¼Œæˆ–ç›´æ¥ä½¿ç”¨ axios å®ä¾‹(axios&#x2F;axios.getâ€¦)</li><li>request æ–¹æ³•æ˜¯å…¥å£ï¼Œaxios&#x2F;axios.get ç­‰è°ƒç”¨éƒ½ä¼šèµ°è¿› request è¿›è¡Œå¤„ç†</li><li>è¯·æ±‚æ‹¦æˆªå™¨</li><li>è¯·æ±‚æ•°æ®è½¬æ¢å™¨ï¼Œå¯¹ä¼ å…¥çš„å‚æ•° data å’Œ header åšæ•°æ®å¤„ç†ï¼Œæ¯”å¦‚ JSON.stringify(data)</li><li>é€‚é…å™¨ï¼Œåˆ¤æ–­æ˜¯æµè§ˆå™¨ç«¯è¿˜æ˜¯ node ç«¯ï¼Œæ‰§è¡Œä¸åŒçš„æ–¹æ³•</li><li>å“åº”æ•°æ®è½¬æ¢å™¨ï¼Œå¯¹æœåŠ¡ç«¯çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ JSON.parse(data)</li><li>å“åº”æ‹¦æˆªå™¨ï¼Œå¯¹æœåŠ¡ç«¯æ•°æ®åšå¤„ç†ï¼Œæ¯”å¦‚ token å¤±æ•ˆé€€å‡ºç™»é™†ï¼ŒæŠ¥é”™ dialog æç¤º</li><li>è¿”å›æ•°æ®ç»™å¼€å‘è€…</li></ol><img src="http://t-blog-images.aijs.top/img/20220623165311.webp"/><h2 id="å…¥å£æ–‡ä»¶"><a href="#å…¥å£æ–‡ä»¶" class="headerlink" title="å…¥å£æ–‡ä»¶"></a>å…¥å£æ–‡ä»¶</h2><p><code>file:lib/axios.js</code></p><p>ä»ä¸‹é¢è¿™æ®µä»£ç å¯ä»¥å¾—å‡ºï¼Œå¯¼å‡ºçš„ axios å°±æ˜¯å®ä¾‹åŒ–åçš„å¯¹è±¡ï¼Œè¿˜åœ¨å…¶ä¸ŠæŒ‚è½½ create æ–¹æ³•ï¼Œä»¥ä¾›åˆ›å»ºç‹¬ç«‹å®ä¾‹ï¼Œä»è€Œè¾¾åˆ°å®ä¾‹ä¹‹é—´äº’ä¸å½±å“ï¼Œäº’ç›¸éš”ç¦»ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">...&#x2F;&#x2F; åˆ›å»ºå®ä¾‹è¿‡ç¨‹çš„æ–¹æ³•functioncreateInstance(defaultConfig) &#123;return instance;&#125;&#x2F;&#x2F; å®ä¾‹åŒ–var axios &#x3D; createInstance(defaults);&#x2F;&#x2F; åˆ›å»ºç‹¬ç«‹çš„å®ä¾‹ï¼Œéš”ç¦»ä½œç”¨åŸŸaxios.create &#x3D; functioncreate(instanceConfig) &#123;return createInstance(mergeConfig(axios.defaults, instanceConfig));&#125;;...&#x2F;&#x2F; å¯¼å‡ºå®ä¾‹module.exports &#x3D; axios; &#x2F;&#x2F; å¯èƒ½å¤§å®¶å¯¹ createInstance æ–¹æ³•æ„Ÿåˆ°å¥½å¥‡ï¼Œä¸‹é¢ä¸€æ¢ç©¶ç«Ÿã€‚functioncreateInstance(defaultConfig) &#123;  &#x2F;&#x2F; å®ä¾‹åŒ–ï¼Œåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡var context &#x3D; new Axios(defaultConfig);&#x2F;&#x2F; å¹³æ—¶è°ƒç”¨çš„ get&#x2F;post ç­‰ç­‰è¯·æ±‚ï¼Œåº•å±‚éƒ½æ˜¯è°ƒç”¨ request æ–¹æ³•&#x2F;&#x2F; å°† request æ–¹æ³•çš„ this æŒ‡å‘ context(ä¸Šä¸‹æ–‡)ï¼Œå½¢æˆæ–°çš„å®ä¾‹var instance &#x3D; bind(Axios.prototype.request, context);&#x2F;&#x2F; Axios.prototype ä¸Šçš„æ–¹æ³• (get&#x2F;post...)æŒ‚è½½åˆ°æ–°çš„å®ä¾‹ instance ä¸Šï¼Œ&#x2F;&#x2F; å¹¶ä¸”å°†åŸå‹æ–¹æ³•ä¸­ this æŒ‡å‘context utils.extend(instance, Axios.prototype, context);&#x2F;&#x2F; Axios å±æ€§å€¼æŒ‚è½½åˆ°æ–°çš„å®ä¾‹ instance ä¸Š&#x2F;&#x2F; å¼€å‘ä¸­æ‰èƒ½ä½¿ç”¨ axios.default&#x2F;interceptorsutils.extend(instance, context);return instance;&#125;&#x2F;&#x2F; ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å¾—å‡ºï¼ŒAxios ä¸æ˜¯ç®€å•çš„åˆ›å»ºå®ä¾‹ contextï¼Œè€Œä¸”è¿›è¡Œä¸€ç³»åˆ—çš„ä¸Šä¸‹æ–‡ç»‘å®šå’Œå±æ€§æ–¹æ³•æŒ‚è½½ï¼Œä»è€Œå»æ”¯æŒ axios()ï¼Œä¹Ÿæ”¯æŒ axios.get() ç­‰ç­‰ç”¨æ³•ï¼›</code></pre><p>createInstance å‡½æ•°æ˜¯ä¸€ä¸ªæ ¸å¿ƒå…¥å£ï¼Œæˆ‘ä»¬åœ¨æŠŠä¸Šé¢æµç¨‹æ¢³ç†ä¸€ä¸‹ï¼š</p><ol><li>é€šè¿‡æ„é€ å‡½æ•° Axios åˆ›å»ºå®ä¾‹ contextï¼Œä½œä¸ºä¸‹é¢ request æ–¹æ³•çš„ä¸Šä¸‹æ–‡ï¼ˆthis æŒ‡å‘ï¼‰</li><li>å°† Axios.prototype.request æ–¹æ³•ä½œä¸ºå®ä¾‹ä½¿ç”¨ï¼Œå¹¶æŠŠ this æŒ‡å‘ contextï¼Œå½¢æˆæ–°çš„å®ä¾‹ instance</li><li>å°†æ„é€ å‡½æ•° Axios.prototype ä¸Šçš„æ–¹æ³•æŒ‚è½½åˆ°æ–°çš„å®ä¾‹ instance ä¸Šï¼Œç„¶åå°†åŸå‹å„ä¸ªæ–¹æ³•ä¸­çš„ this æŒ‡å‘ contextï¼Œå¼€å‘ä¸­æ‰èƒ½ä½¿ç”¨ axios.get&#x2F;postâ€¦ ç­‰ç­‰</li><li>å°†æ„é€ å‡½æ•° Axios çš„å®ä¾‹å±æ€§æŒ‚è½½åˆ°æ–°çš„å®ä¾‹ instance ä¸Šï¼Œæˆ‘ä»¬å¼€å‘ä¸­æ‰èƒ½ä½¿ç”¨ä¸‹é¢å±æ€§ axios.default.baseUrl &#x3D; â€˜https:&#x2F;&#x2F;â€¦â€™axios.interceptors.request.use(resolve,reject)<br>å¤§å®¶å¯èƒ½å¯¹ä¸Šé¢ç¬¬ 2 ç‚¹ request æ–¹æ³•æ„Ÿåˆ°å¥½å¥‡ï¼ŒcreateInstance æ–¹æ³•æ˜æ˜å¯ä»¥å†™ä¸€è¡Œä»£ç  return new Axios() å³å¯ï¼Œä¸ºä»€ä¹ˆå¤§è´¹å‘¨ç« ä½¿ç”¨ request æ–¹æ³•ç»‘å®šæ–°å®ä¾‹ï¼Œå…¶å®å°±åªæ˜¯ä¸ºäº†æ”¯æŒ axios() å†™æ³•ï¼Œå¼€å‘è€…å¯ä»¥å†™å°‘å‡ è¡Œä»£ç ã€‚ã€‚ã€‚</li></ol><h2 id="é»˜è®¤é…ç½®"><a href="#é»˜è®¤é…ç½®" class="headerlink" title="é»˜è®¤é…ç½®"></a>é»˜è®¤é…ç½®</h2><p><code>file:lib/defaults.js</code></p><p>ä» createInstance æ–¹æ³•è°ƒç”¨å‘ç°æœ‰ä¸ªé»˜è®¤é…ç½®ï¼Œä¸»è¦æ˜¯å†…ç½®çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¯å¯¹å…¶è¿›è¡Œè¦†ç›–</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var defaults &#x3D; &#123;  ...  &#x2F;&#x2F; è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸è¶…æ—¶  timeout: 0,   &#x2F;&#x2F; è¯·æ±‚æ•°æ®è½¬æ¢å™¨  transformRequest: [functiontransformRequest(data, headers) &#123;...&#125;],  &#x2F;&#x2F; å“åº”æ•°æ®è½¬æ¢å™¨  transformResponse: [functiontransformResponse(data) &#123;...&#125;], ...&#125;;  ...</code></pre><p>ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š</p><ol><li>é…ç½®ï¼šå¤–éƒ¨ä¼ å…¥ï¼Œå¯è¦†ç›–å†…éƒ¨é»˜è®¤é…ç½®</li><li>æ‹¦æˆªå™¨ï¼šå®ä¾‹åï¼Œå¼€å‘è€…å¯é€šè¿‡ use æ–¹æ³•æ³¨å†ŒæˆåŠŸå’Œå¤±è´¥çš„é’©å­å‡½æ•°ï¼Œæ¯”å¦‚</li></ol><pre class="line-numbers language-js" data-language="js"><code class="language-js">axios.interceptors.request.use((config)&#x3D;&gt;config,(error)&#x3D;&gt;error);functionAxios(instanceConfig) &#123;  &#x2F;&#x2F; é…ç½®  this.defaults &#x3D; instanceConfig;  &#x2F;&#x2F; æ‹¦æˆªå™¨å®ä¾‹  this.interceptors &#x3D; &#123;request: new InterceptorManager(),response: new InterceptorManager() &#125;;&#125;</code></pre><p>åœ¨çœ‹çœ‹åŸå‹æ–¹æ³• request åšäº†ä»€ä¹ˆ</p><p>æ”¯æŒå¤šç±»å‹ä¼ å‚<br>é…ç½®ä¼˜å…ˆçº§å®šä¹‰<br>é€šè¿‡ promise é“¾å¼è°ƒç”¨ï¼Œä¾æ¬¡é¡ºåºæ‰§è¡Œ</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ä¼ªä»£ç Axios.prototype.request &#x3D; functionrequest(config) &#123;  &#x2F;&#x2F; ä¸ºäº†æ”¯æŒ  request(url, &#123;...&#125;), request(&#123;url, ...&#125;)if (typeof config &#x3D;&#x3D;&#x3D; &#39;string&#39;) &#123; config &#x3D; arguments[1] || &#123;&#125;; config.url &#x3D; arguments[0]; &#125; else &#123; config &#x3D; config || &#123;&#125;; &#125;  &#x2F;&#x2F; é…ç½®ä¼˜å…ˆçº§ï¼š è°ƒç”¨æ–¹æ³•çš„é…ç½® &gt; å®ä¾‹åŒ– axios çš„é…ç½® &gt; é»˜è®¤é…ç½®  &#x2F;&#x2F; ä¸¾ä¸ªä¾‹å­ï¼Œç±»ä¼¼ï¼š  axios.get(url, &#123;&#125;) &gt; axios.create(url, &#123;&#125;) &gt; å†…éƒ¨é»˜è®¤è®¾ç½® config &#x3D; mergeConfig(this.defaults, config);  &#x2F;&#x2F; æ‹¦æˆªå™¨ï¼ˆè¯·æ±‚å’Œå“åº”ï¼‰  var requestInterceptorChain &#x3D; [&#123;fulfilled: interceptor.request.fulfilled,rejected: interceptor.request.rejected &#125;];  var responseInterceptorChain &#x3D; [&#123;fulfilled: interceptor.response.fulfilled,rejected: interceptor.response.rejected &#125;];  var promise;&#x2F;&#x2F; å½¢æˆä¸€ä¸ª promise é“¾æ¡çš„æ•°ç»„  var chain &#x3D; [].concat(requestInterceptorChain, chain, responseInterceptorChain);  &#x2F;&#x2F; ä¼ å…¥é…ç½®  promise &#x3D; Promise.resolve(config);  &#x2F;&#x2F; å½¢æˆ promise é“¾æ¡è°ƒç”¨   while (chain.length) &#123; promise &#x3D; promise.then(chain.shift(), chain.shift()); &#125; ... return promise;&#125;;</code></pre><p>é€šè¿‡å¯¹æ•°ç»„çš„éå†ï¼Œå½¢æˆä¸€æ¡å¼‚æ­¥çš„ promise è°ƒç”¨é“¾ï¼Œæ˜¯ axios å¯¹ promise çš„å·§å¦™è¿ç”¨ï¼Œç”¨ä¸€å¼ å›¾è¡¨ç¤º</p><img src="http://t-blog-images.aijs.top/img/20220623165416.webp" /><h2 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h2><p><code>file:lib/core/InterceptorManager.js</code></p><p>ä¸Šé¢è¯´åˆ°çš„ promise è°ƒç”¨é“¾ï¼Œé‡Œé¢æ¶‰åŠåˆ°æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªå™¨æ¯”è¾ƒç®€å•ï¼ŒæŒ‚è½½ä¸€ä¸ªå±æ€§å’Œä¸‰ä¸ªåŸå‹æ–¹æ³•</p><ul><li>handler: å­˜æ”¾ use æ³¨å†Œçš„å›è°ƒå‡½æ•°</li><li>use: æ³¨å†ŒæˆåŠŸå’Œå¤±è´¥çš„å›è°ƒå‡½æ•°</li><li>eject: åˆ é™¤æ³¨å†Œè¿‡çš„å‡½æ•°</li><li>forEach: éå†å›è°ƒå‡½æ•°ï¼Œä¸€èˆ¬å†…éƒ¨ä½¿ç”¨å¤šï¼Œæ¯”å¦‚ï¼špromise è°ƒç”¨é“¾é‚£ä¸ªæ–¹æ³•é‡Œï¼Œå¾ªç¯éå†å›è°ƒå‡½æ•°ï¼Œå­˜æ”¾åˆ° promise è°ƒç”¨é“¾çš„æ•°ç»„ä¸­</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">class InterceptorManager &#123;  constructor() &#123;    this.handlers &#x3D; [];  &#125;  &#x2F;**   * Add a new interceptor to the stack   * &#x2F;&#x2F; æ³¨å†ŒæˆåŠŸå’Œå¤±è´¥çš„å›è°ƒå‡½æ•°   * @param &#123;Function&#125; fulfilled The function to handle &#96;then&#96; for a &#96;Promise&#96;   * @param &#123;Function&#125; rejected The function to handle &#96;reject&#96; for a &#96;Promise&#96;   *   * @return &#123;Number&#125; An ID used to remove interceptor later   *&#x2F;  use(fulfilled, rejected, options) &#123;    this.handlers.push(&#123;      fulfilled,      rejected,      synchronous: options ? options.synchronous : false,      runWhen: options ? options.runWhen : null,    &#125;);    return this.handlers.length - 1;  &#125;  &#x2F;**   * Remove an interceptor from the stack   * &#x2F;&#x2F; åˆ é™¤æ³¨å†Œè¿‡çš„å‡½æ•°   * @param &#123;Number&#125; id The ID that was returned by &#96;use&#96;   *   * @returns &#123;Boolean&#125; &#96;true&#96; if the interceptor was removed, &#96;false&#96; otherwise   *&#x2F;  eject(id) &#123;    if (this.handlers[id]) &#123;      this.handlers[id] &#x3D; null;    &#125;  &#125;  &#x2F;**   * Clear all interceptors from the stack   * è°ƒç”¨æ ˆæ¸…ç©ºæ‰€æœ‰æ‹¦æˆªå™¨   * @returns &#123;void&#125;   *&#x2F;  clear() &#123;    if (this.handlers) &#123;      this.handlers &#x3D; [];    &#125;  &#125;  &#x2F;**   * Iterate over all the registered interceptors   *   * This method is particularly useful for skipping over any   * interceptors that may have become &#96;null&#96; calling &#96;eject&#96;.   * &#x2F;&#x2F; éå†å›è°ƒå‡½æ•°ï¼Œä¸€èˆ¬å†…éƒ¨ä½¿ç”¨å¤š   * @param &#123;Function&#125; fn The function to call for each interceptor   *   * @returns &#123;void&#125;   *&#x2F;  forEach(fn) &#123;    utils.forEach(this.handlers, function forEachHandler(h) &#123;      if (h !&#x3D;&#x3D; null) &#123;        fn(h);      &#125;    &#125;);  &#125;&#125;export default InterceptorManager;</code></pre><h2 id="dispatchRequest"><a href="#dispatchRequest" class="headerlink" title="dispatchRequest"></a>dispatchRequest</h2><p><code>file: lib/core/dispatchRequest.js</code></p><p>ä¸Šé¢è¯´åˆ°çš„ promise è°ƒç”¨é“¾ä¸­çš„ dispatchRequest æ–¹æ³•ï¼Œä¸»è¦åšäº†ä»¥ä¸‹æ“ä½œï¼š<br>ä»¥ <code>transformData.call</code>æ–¹å¼è°ƒç”¨</p><ul><li>transformRequest: å¯¹ config ä¸­çš„ data è¿›è¡ŒåŠ å·¥ï¼Œæ¯”å¦‚å¯¹ post è¯·æ±‚çš„ data è¿›è¡Œå­—ç¬¦ä¸²åŒ– ï¼ˆJSON.stringify(data)ï¼‰</li><li>adapterï¼šé€‚é…å™¨ï¼ŒåŒ…å«æµè§ˆå™¨ç«¯ xhr å’Œ node ç«¯çš„ http</li><li>transformResponse: å¯¹æœåŠ¡ç«¯å“åº”çš„æ•°æ®è¿›è¡ŒåŠ å·¥ï¼Œæ¯”å¦‚ JSON.parse(data)</li></ul><p>dispatchRequest å±€éƒ¨å›¾</p><img src="http://t-blog-images.aijs.top/img/20220623165506.webp" width=300 height=/><pre class="line-numbers language-js" data-language="js"><code class="language-js">module.exports &#x3D; functiondispatchRequest(config) &#123;  ...  &#x2F;&#x2F; transformRequest æ–¹æ³•ï¼Œä¸Šä¸‹æ–‡ç»‘å®š configï¼Œå¯¹ data å’Œ headers è¿›è¡ŒåŠ å·¥  config.data &#x3D; transformData.call( config,  &#x2F;&#x2F; ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå³ this æŒ‡å‘ config.data,  &#x2F;&#x2F; è¯·æ±‚ body å‚æ•° config.headers,  &#x2F;&#x2F; è¯·æ±‚å¤´ config.transformRequest  &#x2F;&#x2F; è½¬æ¢æ•°æ®æ–¹æ³•  );  &#x2F;&#x2F; adapter æ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼ŒåŒ…å«æµè§ˆå™¨ç«¯ xhr å’Œ node ç«¯çš„ http  &#x2F;&#x2F; å†…ç½®æœ‰ adapterï¼Œä¹Ÿå¯å¤–éƒ¨è‡ªå®šä¹‰å»å‘èµ· ajax è¯·æ±‚  var adapter &#x3D; config.adapter || defaults.adapter;return adapter(config).then(    functiononAdapterResolution(response) &#123;    &#x2F;&#x2F; transformResponse æ–¹æ³•ï¼Œä¸Šä¸‹æ–‡ç»‘å®š configï¼Œå¯¹ data å’Œ headers è¿›è¡ŒåŠ å·¥      response.data &#x3D; transformData.call( config,      &#x2F;&#x2F; ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå³ this æŒ‡å‘      response.data, &#x2F;&#x2F; æœåŠ¡ç«¯å“åº”çš„ data      config.transformResponse &#x2F;&#x2F; è½¬æ¢æ•°æ®æ–¹æ³•      );      response.headers, &#x2F;&#x2F; æœåŠ¡ç«¯å“åº”çš„ headers      return response;     &#125;,    functiononAdapterRejection(reason) &#123;     ...     return Promise.reject(reason);    &#125;);  &#125;;</code></pre><h2 id="æ•°æ®è½¬æ¢å™¨"><a href="#æ•°æ®è½¬æ¢å™¨" class="headerlink" title="æ•°æ®è½¬æ¢å™¨"></a>æ•°æ®è½¬æ¢å™¨</h2><p><code>file:lib/core/transformData.js</code></p><p>ä¸Šé¢è¯´åˆ°çš„æ•°æ®è½¬æ¢å™¨ï¼Œæ¯”è¾ƒå¥½ç†è§£ï¼Œæºç å¦‚ä¸‹</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; fns æ–¹æ³•å³ï¼ˆè¯·æ±‚æˆ–å“åº”ï¼‰æ•°æ®è½¬æ¢å™¨æ–¹æ³•ï¼Œåœ¨åˆšå¼€å§‹ defaults æ–‡ä»¶é‡Œå®šä¹‰çš„é»˜è®¤é…ç½®ï¼Œä¹Ÿå¯å¤–éƒ¨è‡ªå®šä¹‰æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š&#x2F;** * Transform the data for a request or a response * è½¬æ¢è¯·æ±‚æˆ–å“åº”çš„æ•°æ® * @param &#123;Array|Function&#125; fns ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•è½¬æ¢å™¨æ–¹æ³• * @param &#123;?Object&#125; response The response object * * @returns &#123;*&#125; The resulting transformed data *&#x2F;export default function transformData(fns, response) &#123;  const config &#x3D; this || defaults;  const context &#x3D; response || config;  const headers &#x3D; AxiosHeaders.from(context.headers);  let data &#x3D; context.data;  utils.forEach(fns, function transform(fn) &#123;    data &#x3D; fn.call(      config,      data,      headers.normalize(),      response ? response.status : undefined    );  &#125;);  headers.normalize();  return data;&#125;</code></pre><h2 id="Axios"><a href="#Axios" class="headerlink" title="Axios"></a>Axios</h2><p><code>file: lib/defaults.js</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const defaults &#x3D; &#123;  ...  &#x2F;&#x2F; è¿”å›è½¬åŒ–åçš„è¯·æ±‚å‚æ•°  transformRequest: [function transformRequest(data, headers) &#123;    const contentType &#x3D; headers.getContentType() || &#39;&#39;;    const hasJSONContentType &#x3D; contentType.indexOf(&#39;application&#x2F;json&#39;) &gt; -1;    const isObjectPayload &#x3D; utils.isObject(data);    if (isObjectPayload &amp;&amp; utils.isHTMLForm(data)) &#123;      data &#x3D; new FormData(data);    &#125;    const isFormData &#x3D; utils.isFormData(data);    if (isFormData) &#123;      if (!hasJSONContentType) &#123;        return data;      &#125;      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;    &#125;    if (utils.isArrayBuffer(data) ||      utils.isBuffer(data) ||      utils.isStream(data) ||      utils.isFile(data) ||      utils.isBlob(data)    ) &#123;      return data;    &#125;    if (utils.isArrayBufferView(data)) &#123;      return data.buffer;    &#125;    if (utils.isURLSearchParams(data)) &#123;      headers.setContentType(&#39;application&#x2F;x-www-form-urlencoded;charset&#x3D;utf-8&#39;, false);      return data.toString();    &#125;    let isFileList;    if (isObjectPayload) &#123;      if (contentType.indexOf(&#39;application&#x2F;x-www-form-urlencoded&#39;) &gt; -1) &#123;        return toURLEncodedForm(data, this.formSerializer).toString();      &#125;      if ((isFileList &#x3D; utils.isFileList(data)) || contentType.indexOf(&#39;multipart&#x2F;form-data&#39;) &gt; -1) &#123;        const _FormData &#x3D; this.env &amp;&amp; this.env.FormData;        return toFormData(          isFileList ? &#123;&#39;files[]&#39;: data&#125; : data,          _FormData &amp;&amp; new _FormData(),          this.formSerializer        );      &#125;    &#125;    if (isObjectPayload || hasJSONContentType ) &#123;      headers.setContentType(&#39;application&#x2F;json&#39;, false);      return stringifySafely(data);    &#125;    return data;  &#125;],  &#x2F;&#x2F; è¿”å›è½¬åŒ–åçš„å“åº”æ•°æ®  transformResponse: [function transformResponse(data) &#123;    const transitional &#x3D; this.transitional || defaults.transitional;    const forcedJSONParsing &#x3D; transitional &amp;&amp; transitional.forcedJSONParsing;    const JSONRequested &#x3D; this.responseType &#x3D;&#x3D;&#x3D; &#39;json&#39;;    if (data &amp;&amp; utils.isString(data) &amp;&amp; ((forcedJSONParsing &amp;&amp; !this.responseType) || JSONRequested)) &#123;      const silentJSONParsing &#x3D; transitional &amp;&amp; transitional.silentJSONParsing;      const strictJSONParsing &#x3D; !silentJSONParsing &amp;&amp; JSONRequested;      try &#123;        return JSON.parse(data); &#x2F;&#x2F; è§£ææ•°æ®      &#125; catch (e) &#123;        if (strictJSONParsing) &#123;          if (e.name &#x3D;&#x3D;&#x3D; &#39;SyntaxError&#39;) &#123;            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);          &#125;          throw e;        &#125;      &#125;    &#125;    return data;  &#125;],&#125;;</code></pre><h2 id="é€‚é…å™¨"><a href="#é€‚é…å™¨" class="headerlink" title="é€‚é…å™¨"></a>é€‚é…å™¨</h2><p><code>file:lib/defaults.js</code></p><p>ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†æºç ï¼Œå³æµè§ˆå™¨ç«¯ xhr å’Œ node ç«¯çš„ http è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­ç¯å¢ƒï¼Œæ‰§è¡Œä¸åŒç«¯çš„ apiã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import utils from &quot;..&#x2F;utils.js&quot;;import httpAdapter from &quot;.&#x2F;http.js&quot;;import xhrAdapter from &quot;.&#x2F;xhr.js&quot;;const adapters &#x3D; &#123;  http: httpAdapter,  xhr: xhrAdapter,&#125;;export default &#123;  getAdapter: (nameOrAdapter) &#x3D;&gt; &#123;    if (utils.isString(nameOrAdapter)) &#123;      const adapter &#x3D; adapters[nameOrAdapter];      if (!nameOrAdapter) &#123;        throw Error(          utils.hasOwnProp(nameOrAdapter)            ? &#96;Adapter &#39;$&#123;nameOrAdapter&#125;&#39; is not available in the build&#96;            : &#96;Can not resolve adapter &#39;$&#123;nameOrAdapter&#125;&#39;&#96;        );      &#125;      return adapter;    &#125;    if (!utils.isFunction(nameOrAdapter)) &#123;      throw new TypeError(&quot;adapter is not a function&quot;);    &#125;    return nameOrAdapter;  &#125;,  adapters,&#125;;&#x2F;&#x2F; æ³¨ï¼š&#x2F;axios&#x2F;lib&#x2F;core&#x2F;dispatchRequest.js&#x2F;&#x2F; const adapter &#x3D; config.adapter || defaults.adapter; ä¸­è°ƒç”¨ defaults.adapter&#x2F;&#x2F; file: &#x2F;axios&#x2F;lib&#x2F;defaults&#x2F;index.js&#x2F;&#x2F; export const default &#x3D; &#123;&#x2F;&#x2F;   adapter: getDefaultAdapter(),&#x2F;&#x2F; &#125;</code></pre><p>å¯¹å¤–æä¾›ç»Ÿä¸€ apiï¼Œä½†åº•å±‚å…¼å®¹æµè§ˆå™¨ç«¯å’Œ node ç«¯ï¼Œç±»ä¼¼ sdkï¼Œåº•å±‚æ›´æ”¹ä¸å½±å“ä¸Šå±‚ apiï¼Œä¿æŒå‘åå…¼å®¹</p><h2 id="å‘èµ·è¯·æ±‚"><a href="#å‘èµ·è¯·æ±‚" class="headerlink" title="å‘èµ·è¯·æ±‚"></a>å‘èµ·è¯·æ±‚</h2><p><code>file: lib/adapters/xhr.js</code><br>å¹³æ—¶ç”¨å¾—æ¯”è¾ƒå¤šçš„æ˜¯æµè§ˆå™¨ç«¯ï¼Œè¿™é‡Œåªè®² XMLHttpRequest çš„å°è£…ï¼Œnode ç«¯æœ‰å…´è¶£çš„åŒå­¦è‡ªè¡ŒæŸ¥çœ‹æºç (lib&#x2F;adapters&#x2F;http.js)</p><p>ç®€æ˜“ç‰ˆæµç¨‹å›¾è¡¨ç¤ºå¤§è‡´å†…å®¹ï¼š</p><p><a href="http://t-blog-images.aijs.top/img/20220623172736.webp" target="_blank" ></a></p><p>æ³¨æ„ï¼šæ–°ç‰ˆæœ¬æœ‰æ”¹åŠ¨</p><ul><li>setCancelToken æ²¡å•¦ï¼Œæœ‰ cancelToken å’Œ signal</li><li>isSetCookie æ²¡æœ‰è¿™ä¸ª</li><li><code>onreadystatechange</code> ä¸ä¸€å®šæœ‰, <code>onloadend</code>æ–¹æ³•ä¸€å®šä¼šè¢«è°ƒç”¨</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (&quot;onloadend&quot; in request) &#123;  &#x2F;&#x2F; Use onloadend if available  request.onloadend &#x3D; onloadend;&#125; else &#123;  &#x2F;&#x2F; Listen for ready state to emulate onloadend  request.onreadystatechange &#x3D; function handleLoad() &#123;    if (!request || request.readyState !&#x3D;&#x3D; 4) &#123;      return;    &#125;    &#x2F;&#x2F; The request errored out and we didn&#39;t get a response, this will be    &#x2F;&#x2F; handled by onerror instead    &#x2F;&#x2F; With one exception: request that using file: protocol, most browsers    &#x2F;&#x2F; will return status as 0 even though it&#39;s a successful request    if (      request.status &#x3D;&#x3D;&#x3D; 0 &amp;&amp;      !(request.responseURL &amp;&amp; request.responseURL.indexOf(&quot;file:&quot;) &#x3D;&#x3D;&#x3D; 0)    ) &#123;      return;    &#125;    &#x2F;&#x2F; readystate handler is calling before onerror or ontimeout handlers,    &#x2F;&#x2F; so we should call onloadend on the next &#39;tick&#39;    setTimeout(onloadend);  &#125;;&#125;</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://baijiahao.baidu.com/s?id=1704404768648603231&wfr=spider&for=pc&searchword=axios%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90" target="_blank" >Axios æºç è§£æ-å®Œæ•´ç¯‡</a></p><p><a href="https://blog.csdn.net/qq_27053493/article/details/97462300" target="_blank" >ä¸€æ­¥ä¸€æ­¥è§£æ Axios æºç ï¼Œä»å…¥é—¨åˆ°åŸç†</a></p><p><a href="https://www.codingsky.com/doc/2022/4/2/433.html" target="_blank" >axiosæºç ä¸­çš„10å¤šä¸ªå·¥å…·å‡½æ•°ï¼Œå€¼å¾—ä¸€å­¦~</a></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-router v0.6.4 ä¾èµ– history 5.0.0-beta.5æºç </title>
      <link href="//post/2022-06-22.history.html"/>
      <url>//post/2022-06-22.history.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Documentation for version 5 can be found in the docs directory. This is the current stable release. Version 5 is used in React Router version 6.<br><em>history 5 å¯¹åº” React Router 6</em></p><p>Documentation for version 4 can be found on the v4 branch. Version 4 is used in React Router versions 4 and 5.<br><em>history 4 å¯¹åº” React Router 4 å’Œ 5</em></p><p>The history library provides history tracking and navigation primitives for JavaScript applications that run in browsers and other stateful environments.<br><em>å†å²åº“ä¸ºåœ¨æµè§ˆå™¨å’Œå…¶ä»–æœ‰çŠ¶æ€ç¯å¢ƒä¸­è¿è¡Œçš„ JavaScript åº”ç”¨ç¨‹åºæä¾›å†å²è·Ÿè¸ªå’Œå¯¼èˆªã€‚</em><br>If you havenâ€™t yet, please take a second to read through the Installation guide to get the library installed and running on your system.<br><em>å¦‚æœå°šæœªå®‰è£…ï¼Œè¯·èŠ±å‡ ç§’é’Ÿé˜…è¯»å®‰è£…æŒ‡å—ï¼Œä»¥ä¾¿åœ¨ç³»ç»Ÿä¸Šå®‰è£…å¹¶è¿è¡Œåº“ã€‚</em></p><p>We provide 3 different methods for working with history, depending on your environment:<br><em>æ ¹æ®æ‚¨çš„ç¯å¢ƒï¼Œæˆ‘ä»¬æä¾›äº† 3 ç§ä¸åŒçš„å†å²å¤„ç†æ–¹æ³•ï¼š</em></p><ul><li><p>A â€œbrowser historyâ€ is for use in modern web browsers that support the HTML5 history API (see cross-browser compatibility)<br><em>â€œæµè§ˆå™¨å†å²è®°å½•â€ç”¨äºæ”¯æŒ HTML5 å†å²è®°å½• API çš„ç°ä»£ web æµè§ˆå™¨ï¼ˆè¯·å‚é˜…è·¨æµè§ˆå™¨å…¼å®¹æ€§ï¼‰</em></p></li><li><p>A â€œhash historyâ€ is for use in web browsers where you want to store the location in the hash portion of the current URL to avoid sending it to the server when the page reloads<br><em>â€œå“ˆå¸Œå†å²è®°å½•â€ç”¨äº web æµè§ˆå™¨ä¸­ï¼Œæ‚¨å¸Œæœ›å°†ä½ç½®å­˜å‚¨åœ¨å½“å‰ URL çš„å“ˆå¸Œéƒ¨åˆ†ä¸­ï¼Œä»¥é¿å…åœ¨é¡µé¢é‡æ–°åŠ è½½æ—¶å°†å…¶å‘é€åˆ°æœåŠ¡å™¨</em></p></li><li><p>A â€œmemory historyâ€ is used as a reference implementation that may be used in non-browser environments, like React Native or tests<br><em>â€œå†…å­˜å†å²è®°å½•â€ç”¨ä½œå‚è€ƒå®ç°ï¼Œå¯åœ¨éæµè§ˆå™¨ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¦‚ React Native æˆ– tests</em></p></li></ul><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>å¸¸ç”¨çš„æ˜¯ â€œbrowser historyâ€ ï¼Œä½¿ç”¨ â€œhash historyâ€ï¼Œä¼šæœ‰ç”¨æˆ·åé¦ˆæ€ä¹ˆæœ‰#å·ï¼Œè¦ä½ å»é™¤ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæœ‰æ—¶å€™éœ€è¦ç”¨åˆ°<code>hash</code>æ»šåŠ¨åˆ°é¡µé¢å…·ä½“æŸä¸ªä½ç½®ï¼Œæ‰€ä»¥ä¸ºäº†<code>hash</code>åªåšå®šä½ï¼Œé€šå¸¸ç”¨ browser historyï¼Œè¿›è¡Œå¯¼èˆª</p><p>ä»¥ github ä¸ºä¾‹ï¼š</p><p><code>https://github.com/841660202/history/blob/dev/docs/getting-started.md#basic-usage</code></p><p>â€œmemory historyâ€ è¿™ä¸ªåŸºæœ¬ä¸Šæ²¡è§åˆ°è¿‡æœ‰ç”¨çš„ï¼Œ<code>react-native</code>ä½¿ç”¨<code>react-navigation</code>è¿›è¡Œå¯¼èˆª,<code>react-navigation</code>çš„<code>package.json</code>ç§æœªè§åˆ°<code>history</code>ä¾èµ–</p></div><p>The main bundle exports one method for each environment: createBrowserHistory for browsers, createHashHistory for using hash history in browsers, and createMemoryHistory for creating an in-memory history.</p><p><em>ä¸»æ†ç»‘åŒ…ä¸ºæ¯ä¸ªç¯å¢ƒå¯¼å‡ºä¸€ä¸ªæ–¹æ³•ï¼šcreateBrowserHistory ç”¨äºæµè§ˆå™¨ï¼ŒCreateBhashHistory ç”¨äºåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨å“ˆå¸Œå†å²ï¼ŒcreateMemoryHistory ç”¨äºåˆ›å»ºå†…å­˜ä¸­çš„å†å²ã€‚</em></p><p>In addition to the main bundle, the library also includes history&#x2F;browser and history&#x2F;hash bundles that export singletons you can use to quickly get a history instance for the current document (web page).<br><em>é™¤äº†ä¸»æ†ç»‘åŒ…ä¹‹å¤–ï¼Œè¯¥åº“è¿˜åŒ…æ‹¬ history&#x2F;browser å’Œ history&#x2F;hash åŒ…ï¼Œè¿™äº›æ†ç»‘åŒ…å¯¼å‡ºå¯ä»¥ç”¨äºå¿«é€Ÿè·å–å½“å‰æ–‡æ¡£ï¼ˆç½‘é¡µï¼‰çš„å†å²å®ä¾‹çš„å•ä¾‹ã€‚</em></p><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><p><a href="https://github.com/841660202/history/blob/dev/docs/getting-started.md#basic-usage" target="_blank" >è§</a></p><h2 id="api-å‚è€ƒ"><a href="#api-å‚è€ƒ" class="headerlink" title="api å‚è€ƒ"></a>api å‚è€ƒ</h2><p><a href="https://github.com/841660202/history/blob/dev/docs/api-reference.md" target="_blank" >è§</a></p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><ol><li><code>package.json</code>ç§ workspaces æ ¼å¼é”™è¯¯ï¼Œæ— æ³• <code>yarn</code></li></ol><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#x2F;&#x2F; æ”¹å‰&quot;workspaces&quot;: &#123;    &quot;packages&quot;: [      &quot;packages&#x2F;history&quot;    ]  &#125;&#x2F;&#x2F; æ”¹å&quot;workspaces&quot;: [  &quot;packages&#x2F;*&quot;]</code></pre><ol start="2"><li>åœ¨<code>yarn test</code>å‰ï¼Œéœ€è¦<code>yarn build</code>,æ‰§è¡Œæ‰“åŒ…è¾“å‡ºï¼Œå› ä¸º test ä¼šå¼•ç”¨ build çš„äº§ç‰©</li></ol><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;private&quot;: true,  &quot;scripts&quot;: &#123;    &quot;build&quot;: &quot;node .&#x2F;scripts&#x2F;build.js&quot;,    &quot;size&quot;: &quot;filesize&quot;,    &quot;clean&quot;: &quot;git clean -fdX .&quot;,    &quot;lint&quot;: &quot;eslint .&quot;,    &quot;prepublishOnly&quot;: &quot;yarn build&quot;,    &quot;test&quot;: &quot;node .&#x2F;scripts&#x2F;test.js&quot;  &#125;,  &quot;dependencies&quot;: &#123;    &quot;@ampproject&#x2F;filesize&quot;: &quot;^2.1.1&quot;,    &quot;@ampproject&#x2F;rollup-plugin-closure-compiler&quot;: &quot;0.21.0&quot;,    &quot;@babel&#x2F;core&quot;: &quot;^7.1.2&quot;,    &quot;@babel&#x2F;plugin-transform-runtime&quot;: &quot;^7.7.6&quot;,    &quot;@babel&#x2F;preset-env&quot;: &quot;^7.1.0&quot;,    &quot;@babel&#x2F;preset-modules&quot;: &quot;^0.1.1&quot;,    &quot;@rollup&#x2F;plugin-replace&quot;: &quot;^2.2.1&quot;,    &quot;babel-core&quot;: &quot;^7.0.0-bridge.0&quot;,    &quot;babel-eslint&quot;: &quot;^7.0.0&quot;,    &quot;babel-loader&quot;: &quot;^8.0.4&quot;,    &quot;babel-plugin-dev-expression&quot;: &quot;^0.2.1&quot;,    &quot;eslint&quot;: &quot;^3.3.0&quot;,    &quot;eslint-plugin-import&quot;: &quot;^2.0.0&quot;,    &quot;expect&quot;: &quot;^21.0.0&quot;,    &quot;express&quot;: &quot;^4.17.1&quot;,    &quot;jest-mock&quot;: &quot;^21.0.0&quot;,    &quot;karma&quot;: &quot;^3.1.3&quot;,    &quot;karma-browserstack-launcher&quot;: &quot;^1.3.0&quot;,    &quot;karma-chrome-launcher&quot;: &quot;^2.2.0&quot;,    &quot;karma-firefox-launcher&quot;: &quot;^1.1.0&quot;,    &quot;karma-mocha&quot;: &quot;^1.3.0&quot;,    &quot;karma-mocha-reporter&quot;: &quot;^2.2.5&quot;,    &quot;karma-sourcemap-loader&quot;: &quot;^0.3.7&quot;,    &quot;karma-webpack&quot;: &quot;^3.0.5&quot;,    &quot;mocha&quot;: &quot;^5.2.0&quot;,    &quot;rollup&quot;: &quot;^1.27.9&quot;,    &quot;rollup-plugin-babel&quot;: &quot;^4.0.3&quot;,    &quot;rollup-plugin-copy&quot;: &quot;^3.1.0&quot;,    &quot;rollup-plugin-prettier&quot;: &quot;^0.6.0&quot;,    &quot;rollup-plugin-terser&quot;: &quot;^5.1.2&quot;,    &quot;webpack&quot;: &quot;^3.12.0&quot;  &#125;,  &quot;filesize&quot;: &#123;    &quot;build&#x2F;history&#x2F;history.production.min.js&quot;: &#123;      &quot;none&quot;: &quot;5 kB&quot;    &#125;,    &quot;build&#x2F;history&#x2F;umd&#x2F;history.production.min.js&quot;: &#123;      &quot;none&quot;: &quot;6 kB&quot;    &#125;  &#125;,  &quot;workspaces&quot;: [&quot;packages&#x2F;*&quot;]&#125;</code></pre><p>æŸ¥çœ‹æ–‡ä»¶æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°,è¯¥é¡¹ç›®ä¾èµ–ç§æ²¡æœ‰<code>history</code>åŒ…ï¼Œç”±äºæ˜¯<code>yarn</code> workspaces é¡¹ç›®ï¼Œtest ä¸‹å¼•å…¥<code>history</code>çš„éƒ½æ˜¯äº§ç‰©</p><ol start="3"><li>æµ‹è¯• <code>yarn test</code>, æµè§ˆå™¨ä¼šè¿è¡Œå¼€å¯ï¼Œé¡µé¢å†å²æ ˆ è¿›æ ˆ å‡ºæ ˆ æ“ä½œï¼Œæœ€ç»ˆæµè§ˆå™¨å†å²ä¼šå®Œå…¨å‡ºæ ˆã€‚å¤§æ¦‚æ˜¯ä½¿ç”¨äº†<code>karma-chrome-launcher</code></li></ol><h2 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h2><p>ä½¿ç”¨ rollup</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import babel from &quot;rollup-plugin-babel&quot;;import compiler from &quot;@ampproject&#x2F;rollup-plugin-closure-compiler&quot;;import copy from &quot;rollup-plugin-copy&quot;; &#x2F;&#x2F; æœ‰äº›ä¸éœ€è¦æ”¹å˜çš„ç›´æ¥æ‹·è´import prettier from &quot;rollup-plugin-prettier&quot;;import replace from &quot;@rollup&#x2F;plugin-replace&quot;;import &#123; terser &#125; from &quot;rollup-plugin-terser&quot;; &#x2F;&#x2F; deadcodeconst PRETTY &#x3D; !!process.env.PRETTY;console.log(&quot;PRETTY&quot;, PRETTY); &#x2F;&#x2F; falseconst SOURCE_DIR &#x3D; &quot;packages&#x2F;history&quot;;const OUTPUT_DIR &#x3D; &quot;build&#x2F;history&quot;;&#x2F;&#x2F; æ¨¡å—åŒ–ï¼Œåº”è¯¥æ˜¯æŒ‰éœ€çš„ä¸œè¥¿ï¼Œäº§å‡ºesmæ ¼å¼, äº§å‡º browserã€hashconst modules &#x3D; [  &#123;    input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;history.js&#96;,    output: &#123;      file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;history.js&#96;,      format: &quot;esm&quot;,      sourcemap: !PRETTY,    &#125;,    external: [&quot;@babel&#x2F;runtime&#x2F;helpers&#x2F;esm&#x2F;extends&quot;],    plugins: [      babel(&#123;        exclude: &#x2F;node_modules&#x2F;,        presets: [[&quot;@babel&#x2F;preset-env&quot;, &#123; loose: true &#125;]],        plugins: [          &quot;babel-plugin-dev-expression&quot;,          [&quot;@babel&#x2F;plugin-transform-runtime&quot;, &#123; useESModules: true &#125;],        ],        runtimeHelpers: true,      &#125;),      compiler(),      copy(&#123;        targets: [          &#123; src: &quot;README.md&quot;, dest: OUTPUT_DIR &#125;,          &#123; src: &quot;LICENSE&quot;, dest: OUTPUT_DIR &#125;,          &#123; src: &#96;$&#123;SOURCE_DIR&#125;&#x2F;package.json&#96;, dest: OUTPUT_DIR &#125;,          &#123; src: &#96;$&#123;SOURCE_DIR&#125;&#x2F;history.d.ts&#96;, dest: OUTPUT_DIR &#125;,          &#123; src: &#96;$&#123;SOURCE_DIR&#125;&#x2F;browser.d.ts&#96;, dest: OUTPUT_DIR &#125;,          &#123; src: &#96;$&#123;SOURCE_DIR&#125;&#x2F;hash.d.ts&#96;, dest: OUTPUT_DIR &#125;,        ],        verbose: true,      &#125;),    ].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),  &#125;,  ...[&quot;browser&quot;, &quot;hash&quot;].map((env) &#x3D;&gt; &#123;    return &#123;      input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;$&#123;env&#125;.js&#96;,      output: &#123;        file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;$&#123;env&#125;.js&#96;,        format: &quot;esm&quot;,        sourcemap: !PRETTY,      &#125;,      plugins: [        babel(&#123;          exclude: &#x2F;node_modules&#x2F;,          presets: [[&quot;@babel&#x2F;preset-env&quot;, &#123; loose: true &#125;]],          plugins: [&quot;babel-plugin-dev-expression&quot;],        &#125;),        compiler(),      ].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),    &#125;;  &#125;),];&#x2F;&#x2F; webæµè§ˆå™¨esmç»“æ„ï¼Œåªå¤„ç†historyconst webModules &#x3D; [  &#123;    input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;history.js&#96;,    output: &#123;      file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;history.development.js&#96;,      format: &quot;esm&quot;,      sourcemap: !PRETTY,    &#125;,    plugins: [      babel(&#123;        exclude: &#x2F;node_modules&#x2F;,        presets: [&quot;@babel&#x2F;preset-modules&quot;],        plugins: [&quot;babel-plugin-dev-expression&quot;],      &#125;),      replace(&#123; &quot;process.env.NODE_ENV&quot;: JSON.stringify(&quot;development&quot;) &#125;),      compiler(),    ].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),  &#125;,  &#123;    input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;history.js&#96;,    output: &#123;      file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;history.production.min.js&#96;,      format: &quot;esm&quot;,      sourcemap: !PRETTY,    &#125;,    plugins: [      babel(&#123;        exclude: &#x2F;node_modules&#x2F;,        presets: [&quot;@babel&#x2F;preset-modules&quot;],        plugins: [&quot;babel-plugin-dev-expression&quot;],      &#125;),      replace(&#123; &quot;process.env.NODE_ENV&quot;: JSON.stringify(&quot;production&quot;) &#125;),      compiler(),      terser(&#123; ecma: 8, safari10: true &#125;),    ].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),  &#125;,];&#x2F;&#x2F; æµè§ˆå™¨ã€æœåŠ¡ç«¯ umdæ ¼å¼const globals &#x3D; [  &#123;    input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;history.js&#96;,    output: &#123;      file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;umd&#x2F;history.development.js&#96;,      format: &quot;umd&quot;,      sourcemap: !PRETTY,      name: &quot;HistoryLibrary&quot;,    &#125;,    plugins: [      babel(&#123;        exclude: &#x2F;node_modules&#x2F;,        presets: [[&quot;@babel&#x2F;preset-env&quot;, &#123; loose: true &#125;]],        plugins: [&quot;babel-plugin-dev-expression&quot;],      &#125;),      replace(&#123; &quot;process.env.NODE_ENV&quot;: JSON.stringify(&quot;development&quot;) &#125;),      compiler(),    ].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),  &#125;,  &#123;    input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;history.js&#96;,    output: &#123;      file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;umd&#x2F;history.production.min.js&#96;,      format: &quot;umd&quot;,      sourcemap: !PRETTY,      name: &quot;HistoryLibrary&quot;,    &#125;,    plugins: [      babel(&#123;        exclude: &#x2F;node_modules&#x2F;,        presets: [[&quot;@babel&#x2F;preset-env&quot;, &#123; loose: true &#125;]],        plugins: [&quot;babel-plugin-dev-expression&quot;],      &#125;),      replace(&#123; &quot;process.env.NODE_ENV&quot;: JSON.stringify(&quot;production&quot;) &#125;),      compiler(),      terser(),    ].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),  &#125;,];&#x2F;&#x2F; æœåŠ¡ç«¯common.jsconst node &#x3D; [  &#123;    input: &#96;$&#123;SOURCE_DIR&#125;&#x2F;node-main.js&#96;,    output: &#123;      file: &#96;$&#123;OUTPUT_DIR&#125;&#x2F;main.js&#96;,      format: &quot;cjs&quot;,    &#125;,    plugins: [compiler()].concat(PRETTY ? prettier(&#123; parser: &quot;babel&quot; &#125;) : []),  &#125;,];export default [...modules, ...webModules, ...globals, ...node];</code></pre><h2 id="history-js"><a href="#history-js" class="headerlink" title="history.js"></a>history.js</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; history&#x2F;packages&#x2F;history&#x2F;history.js&#x2F;&#x2F; å–ä¸­é—´å€¼function clamp(n, lowerBound, upperBound) &#123;  return Math.min(Math.max(n, lowerBound), upperBound);&#125;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F; UTILS&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F; å¸è½½å‰æç¤ºfunction promptBeforeUnload(event) &#123;  &#x2F;&#x2F; Cancel the event.  event.preventDefault();  &#x2F;&#x2F; Chrome (and legacy IE) requires returnValue to be set.  event.returnValue &#x3D; &quot;&quot;;&#125;&#x2F;&#x2F; åˆ›å»ºäº‹ä»¶function createEvents() &#123;  let handlers &#x3D; [];  return &#123;    get length() &#123;      return handlers.length;    &#125;,    push(fn) &#123;      handlers.push(fn);      return function () &#123;        handlers &#x3D; handlers.filter((handler) &#x3D;&gt; handler !&#x3D;&#x3D; fn);      &#125;;    &#125;,    call(arg) &#123;      handlers.forEach((fn) &#x3D;&gt; fn &amp;&amp; fn(arg));    &#125;,  &#125;;&#125;&#x2F;&#x2F; åˆ›å»ºå”¯ä¸€keyfunction createKey() &#123;  return Math.random().toString(36).substr(2, 8);&#125;&#x2F;&#x2F; ç”Ÿæˆpathexport function createPath(&#123; pathname &#x3D; &quot;&#x2F;&quot;, search &#x3D; &quot;&quot;, hash &#x3D; &quot;&quot; &#125;) &#123;  return pathname + search + hash;&#125;&#x2F;&#x2F; è§£æpathexport function parsePath(path) &#123;  &#x2F;&#x2F; &#39;https:&#x2F;&#x2F;fanyi.baidu.com&#x2F;?aldtype&#x3D;16047#ast&#x2F;zh&#x2F;promptBeforeUnload&#39;  let pieces &#x3D; &#123;&#125;;  if (path) &#123;    let hashIndex &#x3D; path.indexOf(&quot;#&quot;);    if (hashIndex &gt;&#x3D; 0) &#123;      pieces.hash &#x3D; path.substr(hashIndex); &#x2F;&#x2F; #ast&#x2F;zh&#x2F;promptBeforeUnload      path &#x3D; path.substr(0, hashIndex); &#x2F;&#x2F; https:&#x2F;&#x2F;fanyi.baidu.com&#x2F;?aldtype&#x3D;16047    &#125;    let searchIndex &#x3D; path.indexOf(&quot;?&quot;);    if (searchIndex &gt;&#x3D; 0) &#123;      pieces.search &#x3D; path.substr(searchIndex); &#x2F;&#x2F; ?aldtype&#x3D;16047      path &#x3D; path.substr(0, searchIndex); &#x2F;&#x2F; https:&#x2F;&#x2F;fanyi.baidu.com&#x2F;    &#125;    if (path) &#123;      pieces.pathname &#x3D; path;    &#125;  &#125;  return pieces;&#125;</code></pre><h2 id="createBrowserHistory"><a href="#createBrowserHistory" class="headerlink" title="createBrowserHistory"></a>createBrowserHistory</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; å¯¹è±¡åªè¯»const readOnly &#x3D; __DEV__ ? (obj) &#x3D;&gt; Object.freeze(obj) : (obj) &#x3D;&gt; obj;&#x2F;** * Browser history stores the location in regular URLs. This is the * standard for most web apps, but it requires some configuration on * the server to ensure you serve the same app at multiple URLs. * æµè§ˆå™¨å†å²è®°å½•å°†ä½ç½®å­˜å‚¨åœ¨å¸¸è§„URLä¸­ã€‚è¿™æ˜¯ * å¤§å¤šæ•°webåº”ç”¨ç¨‹åºçš„æ ‡å‡†é…ç½®ï¼Œä½†å®ƒéœ€è¦åœ¨ * ç¡®ä¿æ‚¨åœ¨å¤šä¸ªURLä¸Šä¸ºåŒä¸€åº”ç”¨ç¨‹åºæä¾›æœåŠ¡çš„æœåŠ¡å™¨ã€‚ *&#x2F;export function createBrowserHistory(&#123; window &#x3D; document.defaultView &#125; &#x3D; &#123;&#125;) &#123;  let globalHistory &#x3D; window.history;  &#x2F;&#x2F; è·å–ç¬¬å‡ ä¸ªï¼Œå’Œ location ä¿¡æ¯  function getIndexAndLocation() &#123;    let &#123; pathname, search, hash &#125; &#x3D; window.location;    let state &#x3D; globalHistory.state || &#123;&#125;;    return [      state.idx,      readOnly(&#123;        &#x2F;&#x2F; å¯¹è±¡åªè¯»        pathname,        search,        hash,        state: state.usr || null,        key: state.key || &quot;default&quot;,      &#125;),    ];  &#125;  let blockedPopTx &#x3D; null;  function handlePop() &#123;    &#x2F;&#x2F; å‡ºæ ˆ    if (blockedPopTx) &#123;      blockers.call(blockedPopTx);      blockedPopTx &#x3D; null;    &#125; else &#123;      let nextAction &#x3D; PopAction;      let [nextIndex, nextLocation] &#x3D; getIndexAndLocation();      if (blockers.length) &#123;        if (nextIndex !&#x3D; null) &#123;          let n &#x3D; index - nextIndex;          if (n) &#123;            &#x2F;&#x2F; Revert the POP è¿˜åŸPOP            blockedPopTx &#x3D; &#123;              action: nextAction,              location: nextLocation,              retry() &#123;                go(n * -1);              &#125;,            &#125;;            go(n);          &#125;        &#125; else &#123;          &#x2F;&#x2F; Trying to POP to a location with no index. We did not create          &#x2F;&#x2F; this location, so we can&#39;t effectively block the navigation.          &#x2F;&#x2F; æ­£åœ¨å°è¯•å¼¹å‡ºåˆ°æ²¡æœ‰ç´¢å¼•çš„ä½ç½®ã€‚æˆ‘ä»¬æ²¡æœ‰åˆ›å»ºæ­¤ä½ç½®ï¼Œå› æ­¤æ— æ³•æœ‰æ•ˆé˜»æ­¢å¯¼èˆªã€‚          warning(            false,            &#x2F;&#x2F; TODO: Write up a doc that explains our blocking strategy in            &#x2F;&#x2F; detail and link to it here so people can understand better            &#x2F;&#x2F; what is going on and how to avoid it.            &#96;You are trying to block a POP navigation to a location that was not &#96; +              &#96;created by the history library. The block will fail silently in &#96; +              &#96;production, but in general you should do all navigation with the &#96; +              &#96;history library (instead of using window.history.pushState directly) &#96; +              &#96;to avoid this situation.&#96;          );        &#125;      &#125; else &#123;        applyTx(nextAction);      &#125;    &#125;  &#125;  window.addEventListener(PopStateEventType &#x2F;* popstate *&#x2F;, handlePop);  let action &#x3D; PopAction;  let [index, location] &#x3D; getIndexAndLocation();  let blockers &#x3D; createEvents();  let listeners &#x3D; createEvents();  if (index &#x3D;&#x3D; null) &#123;    index &#x3D; 0;    globalHistory.replaceState(&#123; ...globalHistory.state, idx: index &#125;, null);  &#125;  function createHref(to) &#123;    return typeof to &#x3D;&#x3D;&#x3D; &quot;string&quot; ? to : createPath(to);  &#125;  function getNextLocation(to, state &#x3D; null) &#123;    return readOnly(&#123;      ...location,      ...(typeof to &#x3D;&#x3D;&#x3D; &quot;string&quot; ? parsePath(to) : to),      state,      key: createKey(),    &#125;);  &#125;  &#x2F;&#x2F; è·å–history state å’Œ url  function getHistoryStateAndUrl(nextLocation, index) &#123;    return [      &#123;        usr: nextLocation.state,        key: nextLocation.key,        idx: index,      &#125;,      createHref(nextLocation),    ];  &#125;  &#x2F;&#x2F; æ‰§è¡Œè§‚å¯Ÿè€…  function allowTx(action, location, retry) &#123;    return (      !blockers.length || (blockers.call(&#123; action, location, retry &#125;), false)    );  &#125;  &#x2F;&#x2F; æ‰§è¡Œè§‚å¯Ÿè€…  function applyTx(nextAction) &#123;    action &#x3D; nextAction;    [index, location] &#x3D; getIndexAndLocation();    listeners.call(&#123; action, location &#125;);  &#125;  &#x2F;&#x2F; è¿›æ ˆ  function push(to, state) &#123;    let nextAction &#x3D; PushAction;    let nextLocation &#x3D; getNextLocation(to, state);    function retry() &#123;      push(to, state);    &#125;    if (allowTx(nextAction, nextLocation, retry)) &#123;      let [historyState, url] &#x3D; getHistoryStateAndUrl(nextLocation, index + 1);      &#x2F;&#x2F; TODO: Support forced reloading      &#x2F;&#x2F; try...catch because iOS limits us to 100 pushState calls :&#x2F;      try &#123;        globalHistory.pushState(historyState, null, url);      &#125; catch (error) &#123;        &#x2F;&#x2F; They are going to lose state here, but there is no real        &#x2F;&#x2F; way to warn them about it since the page will refresh...        window.location.assign(url);      &#125;      applyTx(nextAction);    &#125;  &#125;  &#x2F;&#x2F; æ›¿æ¢  function replace(to, state) &#123;    let nextAction &#x3D; ReplaceAction;    let nextLocation &#x3D; getNextLocation(to, state);    function retry() &#123;      replace(to, state);    &#125;    if (allowTx(nextAction, nextLocation, retry)) &#123;      let [historyState, url] &#x3D; getHistoryStateAndUrl(nextLocation, index);      &#x2F;&#x2F; TODO: Support forced reloading      globalHistory.replaceState(historyState, null, url);      applyTx(nextAction);    &#125;  &#125;  function go(n) &#123;    globalHistory.go(n);  &#125;  let history &#x3D; &#123;    get action() &#123;      return action;    &#125;,    get location() &#123;      return location;    &#125;,    createHref,    push,    replace,    go,    back() &#123;      go(-1);    &#125;,    forward() &#123;      go(1);    &#125;,    listen(fn) &#123;      &#x2F;&#x2F; react-routerä½¿ç”¨listenç›‘å¬å˜åŒ–ï¼Œå¹¶è¿›è¡ŒåŒ¹é…æ¸²æŸ“      return listeners.push(fn);    &#125;,    block(fn) &#123;      let unblock &#x3D; blockers.push(fn);      if (blockers.length &#x3D;&#x3D;&#x3D; 1) &#123;        window.addEventListener(BeforeUnloadEventType, promptBeforeUnload);      &#125;      return function () &#123;        unblock();        &#x2F;&#x2F;é¡µé¢undloadä¹‹å‰æ¸…ç©ºç›‘å¬ï¼Œé¿å…å†…å­˜æ³„æ¼        &#x2F;&#x2F; Remove the beforeunload listener so the document may        &#x2F;&#x2F; still be salvageable in the pagehide event.        &#x2F;&#x2F; See https:&#x2F;&#x2F;html.spec.whatwg.org&#x2F;#unloading-documents        if (!blockers.length) &#123;          window.removeEventListener(BeforeUnloadEventType, promptBeforeUnload);        &#125;      &#125;;    &#125;,  &#125;;  &#x2F;&#x2F; æœ€ç»ˆè¿”å›ä¸€ä¸ªhistoryå¯¹è±¡ï¼Œæœ‰ä¸€ç³»åˆ—æ–¹æ³•  return history;&#125;</code></pre><h2 id="createHashHistory"><a href="#createHashHistory" class="headerlink" title="createHashHistory"></a>createHashHistory</h2><p>å…ˆä¸çœ‹äº†â€¦</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://github.com/remix-run/history" target="_blank" >remix-run&#x2F;history</a></p>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è…¾è®¯äº‘COS,docxæ— æ³•åœ¨æµè§ˆå™¨é¢„è§ˆ</title>
      <link href="//post/2022-06-22cos.html"/>
      <url>//post/2022-06-22cos.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å…¶ä»–éƒ¨é—¨é¡¹ç›®æ¥å…¥æˆ‘ä»¬éƒ¨é—¨ wfc å®¡æ‰¹æµï¼Œæœ‰é™„ä»¶éœ€è¦é¢„è§ˆï¼Œé™„ä»¶ç§ç±»éå¸¸å¤šï¼šå›¾ç‰‡ã€office(docã€pptâ€¦)ã€ä»£ç æ–‡ä»¶ï¼ˆcssã€htmlã€jsâ€¦ï¼‰</p><ul><li><p>å›¾ç‰‡é¢„è§ˆï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶&#x2F;è‡ªå·±å¼€å‘</p></li><li><p>pdf: ä½¿ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶&#x2F;iframe å…·å¤‡æµè§ˆå™¨é¢„è§ˆ pdf åŠŸèƒ½</p></li><li><p>office é¢„è§ˆï¼š<code>officeé¢„è§ˆåœ°å€ + iframe</code></p></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getOfficeUrl(fileUrl: string) &#123;  if(!fileUrl) &#123;    throw new Error(&quot;fileUrl is required&quot;);  &#125;  return &#96;https:&#x2F;&#x2F;view.officeapps.live.com&#x2F;op&#x2F;view.aspx?src&#x3D;$&#123;encodeURIComponent(fileUrl))&#125;&#96;;&#125;getOfficeUrl(&#39;https:&#x2F;&#x2F;hello-1257881288.cos.ap-shanghai.myqcloud.com&#x2F;demo.docx&#39;)&#x2F;&#x2F; ç»“æœ&#x2F;&#x2F; https:&#x2F;&#x2F;view.officeapps.live.com&#x2F;op&#x2F;view.aspx?src&#x3D;https%3A%2F%2Fhello-1257881288.cos.ap-shanghai.myqcloud.com%2Fdemo.docx</code></pre><p>æ³¨æ„ï¼šä¸€ä¸ªæœˆå†…æœ‰æ•ˆï¼ˆä»…ä¹°äº†ä¸€ä¸ªæœˆï¼‰</p><iframe src="https://view.officeapps.live.com/op/view.aspx?src=https%3A%2F%2Fhello-1257881288.cos.ap-shanghai.myqcloud.com%2Fdemo.docx" height=300 width='100%'></iframe><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>é¡ºä¾¿æå¥: ä½¿ç”¨ <code>https://view.officeapps.live.com/op/view.aspx?src=</code>é¢„è§ˆå¤±è´¥åè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„urlé”™è¯¯åœ°å€ï¼Œè¿™å¹¶ä¸æ„å‘³ç€æ˜¯iframeåŠ è½½é”™è¯¯</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;iframe src&#x3D;&quot;https:&#x2F;&#x2F;view.officeapps.live.com&#x2F;op&#x2F;view.aspx?src&#x3D;https%3A%2F%2Fhello-1257881288.cos.ap-shanghai.myqcloud.com%2Fdemo.docx&quot; height&#x3D;300 width&#x3D;&#39;100%&#39;&gt;  åŠ è½½å¤±è´¥äº†ï¼Œæé†’æˆ‘ï¼ˆè¿™ä¸ªæ°¸è¿œä¸ä¼šèµ°åˆ°ï¼Œé™¤é&#96;https:&#x2F;&#x2F;view.officeapps.live.com&#96;æŒ‚äº†ï¼‰&lt;&#x2F;iframe&gt;</code></pre></p></div><h2 id="é‡åˆ°å‘"><a href="#é‡åˆ°å‘" class="headerlink" title="é‡åˆ°å‘"></a>é‡åˆ°å‘</h2><p><strong>é€šè¿‡ fileKey è·å–é¢„è§ˆåœ°å€</strong></p><p style="color: red">æ±—ï½,æ–‡ä»¶å­˜å‚¨åŒå­¦ç»™çš„è§£é‡Š</p><p>åœ¨é€šè¿‡ fileKey è·å–é¢„è§ˆåœ°å€æ—¶å€™ï¼Œç”±äºä¸šåŠ¡æ–¹çš„ pdf ç±»å‹ fileKey æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>fileKey<strong>æœ‰.pdf ç»“å°¾</strong>ï¼šè·å–åˆ°çš„ä¸´æ—¶é¢„è§ˆåœ°å€æ˜¯<strong>å¯ä»¥é¢„è§ˆ</strong></li><li>fileKey<strong>æ— .pdf ç»“å°¾</strong>ï¼šè·å–åˆ°çš„ä¸´æ—¶é¢„è§ˆåœ°å€æ˜¯<strong>ä¸å¯ä»¥é¢„è§ˆ</strong>ï¼Œä»…æ”¯æŒä¸‹è½½</li></ol><p><strong>è…¾è®¯äº‘æ–‡æ¡£</strong></p><ol><li><p><a href="https://cloud.tencent.com/document/product/436/13361" target="_blank" >Content-Disposition</a>: attachment; filename*&#x3D;â€abc.txtâ€ï¼Œ ä¸­æœ‰ attachment å³ä¸‹è½½</p></li><li><p>æ¯ä¸ªæ–‡ä»¶è¯¦æƒ…<strong>è‡ªå®šä¹‰ Headers</strong>éƒ¨åˆ†</p></li></ol><img src="http://t-blog-images.aijs.top/img/20220622100858.webp"/><p>æ–‡æ¡£çš„æ„æ€æ˜¯ï¼šè¦æƒ³æµè§ˆå™¨é¢„è§ˆï¼šä¸Šä¼ æ–‡ä»¶éœ€æ»¡è¶³å“åº”å¤´æ­£ç¡®</p><ol><li><p>æ–¹å¼ 1: ä¸Šä¼ æ–‡ä»¶å¸¦åç¼€ï¼Œè‡ªåŠ¨ç”Ÿæˆå“åº”å¤´</p></li><li><p>æ–¹å¼ 1: ä¸Šä¼ æ–‡ä»¶ï¼Œéœ€è¦é…ç½®æ–‡ä»¶çš„ content-type</p></li></ol><p><strong>é€šè¿‡ fileKey è·å–é¢„è§ˆåœ°å€ä¸º office ç±»å‹æ–‡ä»¶</strong></p><p>å‰é¢è¯´äº†ï¼Œoffice é¢„è§ˆå€ŸåŠ©<code>iframe</code>,ä»…æ­¤å³å¯å®ç°ï¼Œé˜¿é‡Œäº‘ OSSï¼Œå¦¥å¦¥æ»´æ²¡é—®é¢˜ï¼ˆé˜¿é‡Œäº‘æˆ‘ä¸è´´å›¾äº†ï¼Œæµ‹è¯•æ–‡ä»¶å·²è¢«åˆ é™¤ï¼‰</p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>é˜¿é‡Œäº‘ä¸Šä¸Šä¼ æ–‡ä»¶ï¼Œæµ‹è¯•åï¼Œåˆ é™¤ï¼Œå‡ åˆ†é’Ÿå†…ï¼Œæ–‡ä»¶è¿˜å¯ä»¥è®¿é—®ï¼Œç¬¬äºŒå¤©å†è®¿é—®ä¸å¯è®¿é—®äº†</p><p>è´´ä¸‹ä¸å¯è®¿é—®çš„åœ°å€ï¼šï¼ˆæƒ³ç€èƒ½è®¿é—®ï¼Œå°±ä¸è´´äº†ï¼ŒåŸå› æ˜¯ï¼šè¿™æ˜¯å…¬å¸çš„ä¸€ä¸ªæ¨¡ç‰ˆæ–‡ä»¶ï¼Œæ•ä¸æ•æ„Ÿï¼Œæˆ‘ä¸æ™“å¾—ï¼Œæˆ‘åªæ˜¯ç”¨æ¥æµ‹è¯•ï¼‰</p><p><code>https://view.officeapps.live.com/op/view.aspx?src=http%3A%2F%2Ft-blog-images.aijs.top%2FTYZN-XPPZ-04-006%252B%25E4%25BE%259B%25E5%25BA%2594%25E5%2595%2586%25E4%25BA%25A7%25E5%2593%2581%25E8%25B4%25A8%25E9%2587%258F%25E4%25BF%259D%25E8%25AF%2581%25E5%258D%258F%25E8%25AE%25AE_B1.docx</code></p><p>å¦‚æœæ˜¯éå¸¸æ•æ„Ÿçš„æ•°æ®ï¼Œä¸å»ºè®®æ‹¿æ¥æµ‹è¯•ï¼Œ<strong>å› ä¸ºå³ä½¿ä½ åˆ é™¤æ–‡ä»¶ï¼ŒçŸ­æ—¶é—´å†…è¯¥æ–‡ä»¶åœ°å€è¿˜æ˜¯å¯ä»¥è®¿é—®çš„</strong></p></div><p>å¯¹äºè…¾è®¯ COSï¼Œæˆ‘ç‰¹åœ°èŠ±äº† 0.85RMB ä¹°äº†ä¸€ä¸ªæœˆ</p><img src="http://t-blog-images.aijs.top/img/20220622094259.webp"/><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; https:&#x2F;&#x2F;hello-1257881288.cos.ap-shanghai.myqcloud.com&#x2F;demo.docx</code></pre><img src="http://t-blog-images.aijs.top/img/20220622094131.webp" /><p>å¯åˆ°äº†è…¾è®¯äº‘å¯å°±ä¸ä¸€æ ·äº†ï¼Œæ˜¨å¤©è…¾è®¯äº‘ï¼Œæ…¢çš„è¦æ­»ï¼Œå®˜ç½‘æ‰“å¼€é€Ÿåº¦ç«Ÿç„¶æ¯”ç®€ä¹¦ä¸€ç¯‡æ–‡ç« è¿˜æ…¢</p><p>ç¬¬äºŒå¤©è¯¢é—®å…¬å¸é™„ä»¶å­˜å‚¨æ–¹æˆ‘ä»¬ wfc é¡¹ç›® office é¢„è§ˆæ€ä¹ˆåˆå¯ä»¥äº†ï¼Œä¹‹å‰ 6ï¼ˆé¢„å‘ç¯å¢ƒï¼‰6 ä¸ªæ–‡ä»¶ 1 ä¸ªå¯ä»¥é¢„è§ˆï¼Œï¼ˆçº¿ä¸Šç¯å¢ƒï¼‰6 ä¸ªéƒ½ä¸èƒ½é¢„è§ˆ</p><p>å›ç­”ï¼š</p><img src="http://t-blog-images.aijs.top/img/20220622093847.webp" width=300/><p>æ±—ï½ï¼Œ æˆ‘è¯´æ˜¨å¤©è®¿é—®æ€ä¹ˆé‚£ä¹ˆæ…¢</p><p>å¤æµ‹æ˜¨å¤©ä¹°çš„ COSï¼Œdocx æ–‡ä»¶é¢„è§ˆ,ä»Šå¤©ç¡®å®åˆå¯ä»¥äº†</p><img src="http://t-blog-images.aijs.top/img/20220622094517.webp"/><p>æ˜¨å¤©ç¡®å®ä¸è¡Œï¼Œæˆ‘æµ‹äº†å‡ ç™¾é</p><img src="http://t-blog-images.aijs.top/img/20220622094640.webp"/><p>æœŸé—´æ€€ç–‘è¿‡å“åº”å¤´,<code>ç½‘ä¸Šå„ç§ä¹±ä¸ƒå…«ç³Ÿçš„å†…å®¹è¿˜éœ€è¦è‡ªå·±è¾¨åˆ«</code></p><img src="http://t-blog-images.aijs.top/img/20220622094640.webp"/><h2 id="ç»­-æ•°æ®ä¸‡è±¡è§£ç»‘"><a href="#ç»­-æ•°æ®ä¸‡è±¡è§£ç»‘" class="headerlink" title="ç»­ æ•°æ®ä¸‡è±¡è§£ç»‘"></a>ç»­ æ•°æ®ä¸‡è±¡è§£ç»‘</h2><p>æˆ‘æµ‹è¯•ä¸€ä¸‹ï¼Œç»§ç»­æ‰£è´¹ï¼Œå…³æ‰</p><img src="http://t-blog-images.aijs.top/img/20220701115515.webp" width=300 /><img src="http://t-blog-images.aijs.top/img/20220701115411.webp" /><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ‰æ—¶åçœŸçš„ä¸æ˜¯ä½ çš„æ–¹å¼é”™è¯¯ï¼Œç¬¬ä¸‰æ–¹å‡ºçš„é—®é¢˜ï¼Œå¥‡è‘©çš„ä¸€ç¬”ï¼Œï¼ˆé¢„å‘ç¯å¢ƒï¼‰6 ä¸ªæ–‡ä»¶ 1 ä¸ªå¯ä»¥é¢„è§ˆï¼Œï¼ˆçº¿ä¸Šç¯å¢ƒï¼‰6 ä¸ªéƒ½ä¸èƒ½é¢„è§ˆ,å¤‡æ³¨ï¼š<strong>ç›¸åŒçš„æ•°æ®</strong>.</p><p>è¿™ä¸ªé—®é¢˜æäº†å¤§åŠå¤©ï¼Œä¸‹åˆæ”¶åˆ°å†…éƒ¨ç³»ç»Ÿåé¦ˆå·¥å•ï¼Œåˆ°æ™šä¸Šè¿‘ 8 ç‚¹ï¼Œé—®é¢˜ä¸€ç›´å­˜åœ¨ã€‚ ç”±äºç›²ç›®ç›¸ä¿¡è…¾è®¯ï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯å†…éƒ¨ç³»ç»Ÿæ–‡ä»¶æˆ–æ˜¯é¡¹ç›®ä»£ç ä¹¦å†™é—®é¢˜ï¼Œæ’æŸ¥äº†é‚£ä¹ˆä¹…æµ‹è¯•äº†é‚£ä¹ˆé•¿æ—¶é—´ï¼ˆæ¯æ¬¡éƒ½è¦å‘åˆ°é¢„å‘æµ‹è¯•ï¼Œå› ä¸ºæ—¥å¸¸å…¬å¸å­˜å‚¨æœåŠ¡ä¸æ”¯æŒ office é¢„è§ˆï¼Œä¸¤å‘¨å‰å·²åé¦ˆäº†æ²¡ç»™è§£å†³ï¼‰ã€‚è¿™ä¹ˆä¸¥é‡çš„é—®é¢˜ï¼Œè…¾è®¯å†…éƒ¨ç«Ÿç„¶ä¹Ÿé‚£ä¹ˆä¹…æ‰è§£å†³å—ï¼Ÿ<br><img src="https://img2.baidu.com/it/u=164072396,1121091430&fm=253&fmt=auto&app=138&f=JPEG?w=440&h=492" width=100/><br>æ²¡æœ‰é»‘ä»»ä½•å¹³å°çš„æ„æ€ï¼Œæˆ‘è¢«è…¾è®¯ COS å®³è‹¦äº†ï½</p>]]></content>
      
      
      <categories>
          
          <category> å¯¹è±¡å­˜å‚¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯¹è±¡å­˜å‚¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-router v6.4.0 æºç </title>
      <link href="//post/2022-06-21react-router-code.html"/>
      <url>//post/2022-06-21react-router-code.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æ•´äº†åŠå¤©ä¸Šä¸€ç¯‡çœ‹çš„ç«Ÿç„¶æ˜¯æ¦‚å¿µï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯åŸç†å‘¢</p><p>æœ€è¿‘çœ‹åˆ°äº†ï¼Œé¢è¯•é¢˜ react-router åŸç†ï¼ŒæŸ¥äº†ä¸‹ç­”æ¡ˆï¼Œå†…å®¹ä¸æ˜¯å¾ˆå¤š</p><p><a href="https://blog.csdn.net/weixin_39907713/article/details/111237885" target="_blank" >React Router åŸç†</a><br><a href="https://blog.csdn.net/qingfeng2020/article/details/121136648" target="_blank" >æµ…è°ˆå‰ç«¯è·¯ç”±åŸç†ï¼ŒVueRouter åŸç†å’Œ ReactRouter åŸç†</a></p><p><a href="https://blog.csdn.net/Android_boom/article/details/125200222" target="_blank" >React Router æºç è§£æ</a></p><p>ä¹‹å‰æ²¡çœ‹è¿‡å®ç°åŸç†ï¼Œç°åœ¨çœ‹åˆ°ä¹Ÿæ²¡é‚£ä¹ˆéš¾ <code>ä»å°è¢«å“å¤§çš„</code>ï¼Œ å¸¦ç€å¥½å¥‡å¿ƒçœ‹ä¸‹ä»“åº“ä»£ç ï¼š<code>4+1ï¼ˆindex.tsï¼‰ä¸ªæ–‡ä»¶</code>æ²¡çœ‹é”™</p><img src="http://t-blog-images.aijs.top/img/20220621091016.webp" width=300 /><h2 id="index-ts"><a href="#index-ts" class="headerlink" title="index.ts"></a>index.ts</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; æš´éœ²å‡ºçš„apiexport &#123;  MemoryRouter,  Navigate,  NavigationType,  Outlet,  Route,  Router,  Routes,  createPath,  createRoutesFromChildren,  generatePath,  matchPath,  matchRoutes,  parsePath,  renderMatches,  resolvePath,  useHref,  useInRouterContext,  useLocation,  useMatch,  useNavigate,  useNavigationType,  useOutlet,  useOutletContext,  useParams,  useResolvedPath,  useRoutes,&#125;;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F; DANGER! PLEASE READ ME! å±é™©ï¼è¯·è¯»è¿™ä¸ªï¼&#x2F;&#x2F; We provide these exports as an escape hatch in the event that you need any&#x2F;&#x2F; routing data that we don&#39;t provide an explicit API for. With that said, we&#x2F;&#x2F; want to cover your use case if we can, so if you feel the need to use these&#x2F;&#x2F; we want to hear from you. Let us know what you&#39;re building and we&#39;ll do our&#x2F;&#x2F; best to make sure we can support you!&#x2F;&#x2F; æˆ‘ä»¬æä¾›è¿™äº›å¯¼å‡ºä½œä¸ºä¸€ä¸ªé€ƒé€¸å¼•ç”¨ï¼Œä»¥é˜²ä½ éœ€è¦æˆ‘ä»¬æ²¡æœ‰æä¾›æ˜ç¡® API çš„ä»»ä½•è·¯ç”±æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ&#x2F;&#x2F; å¦‚æœä½ éœ€è¦è¿™äº›ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä¸ºä½ æä¾›æ”¯æŒï¼Œæ‰€ä»¥å¦‚æœä½ æœ‰éœ€è¦ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ä½ çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ä¼šå°½å¯èƒ½åœ°ä¸ºä½ æä¾›æ”¯æŒã€‚&#x2F;&#x2F; We consider these exports an implementation detail and do not guarantee&#x2F;&#x2F; against any breaking changes, regardless of the semver release. Use with&#x2F;&#x2F; extreme caution and only if you understand the consequences. Godspeed.&#x2F;&#x2F; æˆ‘ä»¬è€ƒè™‘è¿™äº›å¯¼å‡ºæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œå¹¶ä¸”ä¸ä¿è¯å¯¹ä»»ä½•å˜æ›´ä¸ä¼šæœ‰ä»»ä½•å½±å“ï¼Œæ— è®ºæ˜¯åœ¨ semver ç‰ˆæœ¬å‘å¸ƒå‰æˆ–è€…åã€‚&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</code></pre><h2 id="history"><a href="#history" class="headerlink" title="history"></a>history</h2><p>æºç ä¸­ä½¿ç”¨äº†ä¸€ä¸ª <a href="https://github.com/remix-run/history" target="_blank" >history åº“</a></p><p>The history library lets you easily manage session history anywhere JavaScript runs. A history object abstracts away the differences in various environments and provides a minimal API that lets you manage the history stack, navigate, and persist state between sessions.<br><em>è¿™ä¸ªåº“è®©ä½ åœ¨ä»»ä½• JavaScript è¿è¡Œçš„åœ°æ–¹éƒ½èƒ½æ–¹ä¾¿åœ°ç®¡ç†ä¼šè¯å†å²è®°å½•ã€‚ä¸€ä¸ªå†å²å¯¹è±¡æŠ½è±¡äº†ä¸åŒç¯å¢ƒçš„å·®å¼‚ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæœ€å°çš„ APIï¼Œè®©ä½ ç®¡ç†å†å²å †æ ˆï¼Œå¯¼èˆªï¼Œå¹¶åœ¨ä¼šè¯é—´ä¿æŒçŠ¶æ€ã€‚</em></p><h2 id="react-router-dom"><a href="#react-router-dom" class="headerlink" title="react-router-dom"></a>react-router-dom</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¯¹<code>react-router</code>è¿›è¡Œäº†æ‰©å±•ï¼Œ</p></blockquote><p><code>react-router-dom</code>,åœ¨<code>react-router</code>çš„æ ¸å¿ƒåŸºç¡€ä¸Šï¼Œæ·»åŠ äº†ç”¨äºè·³è½¬çš„<code>Link</code>ç»„ä»¶ï¼Œå’Œ<code>histoy</code>æ¨¡å¼ä¸‹çš„<code>BrowserRouter</code>å’Œ hash æ¨¡å¼ä¸‹çš„<code>HashRouter</code>ç»„ä»¶ç­‰ã€‚æ‰€è°“ B<code>rowserRouter</code>å’Œ<code>HashRouter</code>ï¼Œä¹Ÿåªä¸è¿‡ç”¨äº†<code>history</code>åº“ä¸­<code>createBrowserHistory</code>å’Œ<code>createHashHistory</code>æ–¹æ³•</p><h2 id="æ‰¾ä¸ª-demo-ä»å¤´çœ‹"><a href="#æ‰¾ä¸ª-demo-ä»å¤´çœ‹" class="headerlink" title="æ‰¾ä¸ª demo ä»å¤´çœ‹"></a>æ‰¾ä¸ª demo ä»å¤´çœ‹</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import React from &quot;react&quot;;import ReactDOM from &quot;react-dom&quot;;import &#123; BrowserRouter &#125; from &quot;react-router-dom&quot;;import &quot;.&#x2F;index.css&quot;;import App from &quot;.&#x2F;App&quot;;ReactDOM.render(  &lt;React.StrictMode&gt;    &lt;BrowserRouter&gt; &#x2F;&#x2F; react-router-dom      &lt;App &#x2F;&gt;    &lt;&#x2F;BrowserRouter&gt;  &lt;&#x2F;React.StrictMode&gt;,  document.getElementById(&quot;root&quot;)</code></pre><h2 id="BrowserRouter"><a href="#BrowserRouter" class="headerlink" title="BrowserRouter"></a>BrowserRouter</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">export function BrowserRouter(&#123;  basename,  children,  window,&#125;: BrowserRouterProps) &#123;  let historyRef &#x3D; React.useRef&lt;BrowserHistory&gt;();  if (historyRef.current &#x3D;&#x3D; null) &#123;    historyRef.current &#x3D; createBrowserHistory(&#123; window &#125;);  &#125;  let history &#x3D; historyRef.current;  let [state, setState] &#x3D; React.useState(&#123;    action: history.action,    location: history.location,  &#125;);  &#x2F;&#x2F; ç›‘å¬urlå˜åŒ–ï¼Œ æ”¹å˜stateï¼Œæ›´æ–°Routerçš„locationï¼Œlocationæ›´æ–°åä¼šè§¦å‘Routerå†…éƒ¨é‡æ–°æ¸²æŸ“  React.useLayoutEffect(() &#x3D;&gt; history.listen(setState), [history]);  return (    &lt;Router &#x2F;&#x2F; react-router &quot;.&#x2F;lib&#x2F;components&quot;      basename&#x3D;&#123;basename&#125;      children&#x3D;&#123;children&#125;      location&#x3D;&#123;state.location&#125;      navigationType&#x3D;&#123;state.action&#125;      navigator&#x3D;&#123;history&#125;    &#x2F;&gt;  );&#125;</code></pre><p><strong>react-router â€œ.&#x2F;lib&#x2F;componentsâ€</strong></p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Provides location context for the rest of the app. * ä¸ºåº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†æä¾›ä½ç½®ä¸Šä¸‹æ–‡ã€‚ * Note: You usually won&#39;t render a &lt;Router&gt; directly. Instead, you&#39;ll render a * router that is more specific to your environment such as a &lt;BrowserRouter&gt; * in web browsers or a &lt;StaticRouter&gt; for server rendering. * æ³¨æ„ï¼šé€šå¸¸ä¸ä¼šç›´æ¥æ¸²æŸ“&lt;Router&gt;ã€‚ç›¸åï¼Œæ‚¨å°†æ¸²æŸ“ * æ›´ç‰¹å®šäºæ‚¨çš„ç¯å¢ƒçš„è·¯ç”±å™¨ï¼Œå¦‚&lt;BrowserRouter&gt; * åœ¨webæµè§ˆå™¨ä¸­æˆ–ç”¨äºæœåŠ¡å™¨æ¸²æŸ“çš„&lt;StaticRouter&gt;ã€‚ * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;routers&#x2F;router *&#x2F;export function Router(&#123;  basename: basenameProp &#x3D; &quot;&#x2F;&quot;,  children &#x3D; null,  location: locationProp, &#x2F;&#x2F; Location  navigationType &#x3D; NavigationType.Pop,  navigator,  static: staticProp &#x3D; false,&#125;: RouterProps): React.ReactElement | null &#123;  invariant(    !useInRouterContext(),    &#96;You cannot render a &lt;Router&gt; inside another &lt;Router&gt;.&#96; +      &#96; You should never have more than one in your app.&#96;  );  let basename &#x3D; normalizePathname(basenameProp);  let navigationContext &#x3D; React.useMemo(    () &#x3D;&gt; (&#123; basename, navigator, static: staticProp &#125;),    [basename, navigator, staticProp]  );  if (typeof locationProp &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    locationProp &#x3D; parsePath(locationProp);  &#125;  let &#123;    pathname &#x3D; &quot;&#x2F;&quot;,    search &#x3D; &quot;&quot;,    hash &#x3D; &quot;&quot;,    state &#x3D; null,    key &#x3D; &quot;default&quot;,  &#125; &#x3D; locationProp;  let location &#x3D; React.useMemo(() &#x3D;&gt; &#123;    let trailingPathname &#x3D; stripBasename(pathname, basename);    if (trailingPathname &#x3D;&#x3D; null) &#123;      return null;    &#125;    return &#123;      pathname: trailingPathname,      search,      hash,      state,      key,    &#125;;  &#125;, [basename, pathname, search, hash, state, key]);  warning(    location !&#x3D; null,    &#96;&lt;Router basename&#x3D;&quot;$&#123;basename&#125;&quot;&gt; is not able to match the URL &#96; +      &#96;&quot;$&#123;pathname&#125;$&#123;search&#125;$&#123;hash&#125;&quot; because it does not start with the &#96; +      &#96;basename, so the &lt;Router&gt; won&#39;t render anything.&#96;  );  if (location &#x3D;&#x3D; null) &#123;    return null;  &#125;  return (    &lt;NavigationContext.Provider value&#x3D;&#123;navigationContext&#125;&gt;      &#123;&quot; &quot;&#125;      &#x2F;&#x2F; React.createContextä½¿ç”¨ï¼Œ ä¸€èˆ¬æƒ…å†µè¿™é‡Œä¼šå•ç‹¬æŠ½å– NavigationContextï¼Œ å¹¶å†™æˆuseNavigationContext      &lt;LocationContext.Provider &#x2F;&#x2F; ä¸€èˆ¬æƒ…å†µè¿™é‡Œä¼šå•ç‹¬æŠ½å– LocationContext, å¹¶å†™æˆuseLocationContext        children&#x3D;&#123;children&#125; &#x2F;&#x2F; æ˜¯è¿™ç§ä»¥å±æ€§å½¢å¼å†™å…¥çš„ï¼Œä¸æ˜¯åœ¨æ ‡ç­¾ä¸­åŒ…è£¹çš„ï¼Œ å³example&#x2F;basic &lt;App &#x2F;&gt;        value&#x3D;&#123;&#123; location, navigationType &#125;&#125;      &#x2F;&gt;    &lt;&#x2F;NavigationContext.Provider&gt;  );&#125;</code></pre><p><strong>NavigationContext</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * A Navigator is a &quot;location changer&quot;; it&#39;s how you get to different locations. * * Every history instance conforms to the Navigator interface, but the * distinction is useful primarily when it comes to the low-level &lt;Router&gt; API * where both the location and a navigator must be provided separately in order * to avoid &quot;tearing&quot; that may occur in a suspense-enabled app if the action * and&#x2F;or location were to be read directly from the history instance. *&#x2F;export type Navigator &#x3D; Pick&lt;History, &quot;go&quot; | &quot;push&quot; | &quot;replace&quot; | &quot;createHref&quot;&gt;;interface NavigationContextObject &#123;  basename: string;  navigator: Navigator;  static: boolean;&#125;export const NavigationContext &#x3D; React.createContext&lt;NavigationContextObject&gt;(  null!);</code></pre><p><strong>LocationContext</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface LocationContextObject &#123;  location: Location;  navigationType: NavigationType;&#125;export const LocationContext &#x3D; React.createContext&lt;LocationContextObject&gt;(  null!);</code></pre><p><strong>App.tsx</strong></p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import * as React from &quot;react&quot;;import &#123; Routes, Route, Outlet, Link &#125; from &quot;react-router-dom&quot;;export default function App() &#123;  return (    &lt;div&gt;      &lt;h1&gt;Basic Example&lt;&#x2F;h1&gt;      &lt;p&gt;        This example demonstrates some of the core features of React Router        including nested &lt;code&gt;&lt;Route&gt;&lt;&#x2F;code&gt;s,&#123;&quot; &quot;&#125;        &lt;code&gt;&lt;Outlet&gt;&lt;&#x2F;code&gt;s, &lt;code&gt;&lt;Link&gt;&lt;&#x2F;code&gt;s, and using a        &quot;*&quot; route (aka &quot;splat route&quot;) to render a &quot;not found&quot; page when someone        visits an unrecognized URL.      &lt;&#x2F;p&gt;      &#123;&#x2F;* Routes nest inside one another. Nested route paths build upon            parent route paths, and nested route elements render inside            parent route elements. See the note about &lt;Outlet&gt; below. *&#x2F;&#125;      &#123;&#x2F;* ç®¡çº¿ç›¸äº’åµŒå¥—ã€‚åµŒå¥—å¸ƒçº¿è·¯å¾„åŸºäº      çº¿è·¯å¾„å’ŒåµŒå¥—ç®¡çº¿å…ƒç´ åœ¨å†…éƒ¨æ¸²æŸ“      çˆ¶ç®¡çº¿å…ƒç´ ã€‚è¯·å‚è§ä¸‹é¢å…³äº&lt;Outlet&gt;çš„æ³¨é‡Šã€‚*&#x2F;&#125;      &lt;Routes&gt;        &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;Layout &#x2F;&gt;&#125;&gt;          &#123;&quot; &quot;&#125;          &#x2F;&#x2F; Routeåœ¨createRoutesFromChildrenä¸­è¿›è¡Œå¤„ç† element.type &#x3D;&#x3D;&#x3D; Route          &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;          &lt;Route path&#x3D;&quot;about&quot; element&#x3D;&#123;&lt;About &#x2F;&gt;&#125; &#x2F;&gt;          &lt;Route path&#x3D;&quot;dashboard&quot; element&#x3D;&#123;&lt;Dashboard &#x2F;&gt;&#125; &#x2F;&gt;          &#123;&#x2F;* Using path&#x3D;&quot;*&quot;&quot; means &quot;match anything&quot;, so this route                acts like a catch-all for URLs that we don&#39;t have explicit                routes for. *&#x2F;&#125;          &#123;&#x2F;* å•¥éƒ½æ²¡æç€ï¼Œèµ°åŒ¹é…*&#x2F;&#125;          &lt;Route path&#x3D;&quot;*&quot; element&#x3D;&#123;&lt;NoMatch &#x2F;&gt;&#125; &#x2F;&gt;        &lt;&#x2F;Route&gt;      &lt;&#x2F;Routes&gt;    &lt;&#x2F;div&gt;  );&#125;function Layout() &#123;  return (    &lt;div&gt;      &#123;&#x2F;* A &quot;layout route&quot; is a good place to put markup you want to          share across all the pages on your site, like navigation. *&#x2F;&#125;      &lt;nav&gt;        &lt;ul&gt;          &lt;li&gt;            &lt;Link to&#x3D;&quot;&#x2F;&quot;&gt;Home&lt;&#x2F;Link&gt;          &lt;&#x2F;li&gt;          &lt;li&gt;            &lt;Link to&#x3D;&quot;&#x2F;about&quot;&gt;About&lt;&#x2F;Link&gt;          &lt;&#x2F;li&gt;          &lt;li&gt;            &lt;Link to&#x3D;&quot;&#x2F;dashboard&quot;&gt;Dashboard&lt;&#x2F;Link&gt;          &lt;&#x2F;li&gt;          &lt;li&gt;            &lt;Link to&#x3D;&quot;&#x2F;nothing-here&quot;&gt;Nothing Here&lt;&#x2F;Link&gt;          &lt;&#x2F;li&gt;        &lt;&#x2F;ul&gt;      &lt;&#x2F;nav&gt;      &lt;hr &#x2F;&gt;      &#123;&#x2F;* An &lt;Outlet&gt; renders whatever child route is currently active,          so you can think about this &lt;Outlet&gt; as a placeholder for          the child routes we defined above. *&#x2F;&#125;      &lt;Outlet &#x2F;&gt;    &lt;&#x2F;div&gt;  );&#125;function Home() &#123;  return (    &lt;div&gt;      &lt;h2&gt;Home&lt;&#x2F;h2&gt;    &lt;&#x2F;div&gt;  );&#125;function About() &#123;  return (    &lt;div&gt;      &lt;h2&gt;About&lt;&#x2F;h2&gt;    &lt;&#x2F;div&gt;  );&#125;function Dashboard() &#123;  return (    &lt;div&gt;      &lt;h2&gt;Dashboard&lt;&#x2F;h2&gt;    &lt;&#x2F;div&gt;  );&#125;function NoMatch() &#123;  return (    &lt;div&gt;      &lt;h2&gt;Nothing to see here!&lt;&#x2F;h2&gt;      &lt;p&gt;        &lt;Link to&#x3D;&quot;&#x2F;&quot;&gt;Go to the home page&lt;&#x2F;Link&gt;      &lt;&#x2F;p&gt;    &lt;&#x2F;div&gt;  );&#125;</code></pre><p><strong><code>import &#123; Routes, Route, Outlet, Link &#125; from &quot;react-router-dom&quot;;</code></strong></p><h2 id="Routes"><a href="#Routes" class="headerlink" title="Routes"></a>Routes</h2><p>ä¼ å…¥ä¸€ä¸ªè·¯ç”±çš„æ•°ç»„ï¼Œè¿”å›å¯¹åº”è¦å±•ç¤ºçš„ç»„ä»¶ï¼Œæœ‰ç‚¹ç±»ä¼¼äº vue çš„è·¯ç”±çš„é…ç½®ï¼Œå¯ä»¥åœ¨åˆ«çš„æ–‡ä»¶å¤¹é…ç½®å¥½è·¯ç”±ï¼Œç„¶åä¼ å…¥ APP.tsx ä¸­</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * A container for a nested tree of &lt;Route&gt; elements that renders the branch * that best matches the current location. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;components&#x2F;routes *&#x2F;export function Routes(&#123;  children,  location,&#125;: RoutesProps): React.ReactElement | null &#123;  return useRoutes(createRoutesFromChildren(children), location);&#125;</code></pre><h3 id="createRoutesFromChildren"><a href="#createRoutesFromChildren" class="headerlink" title="createRoutesFromChildren"></a>createRoutesFromChildren</h3><p>çœ‹å¤§æ¦‚æ„æ€ï¼Œæ€ä¹ˆå®ç°ä¸ç®¡</p><p>å¤§æ„æ˜¯ä» Children ä¸­åˆ›å»ºè·¯ç”±</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Creates a route config from a React &quot;children&quot; object, which is usually * either a &#96;&lt;Route&gt;&#96; element or an array of them. Used internally by * &#96;&lt;Routes&gt;&#96; to create a route config from its children. * ä»Reactâ€œchildrenâ€å¯¹è±¡åˆ›å»ºè·¯ç”±é…ç½®ï¼Œé€šå¸¸ * ä¸€ä¸ª&#96;&lt;è·¯ç”±&gt;&#96;å…ƒç´ æˆ–å®ƒä»¬çš„æ•°ç»„ã€‚å†…éƒ¨ä½¿ç”¨äºº * &#96;&lt;è·¯ç”±&gt;&#96;ä»å…¶å­çº§åˆ›å»ºè·¯ç”±é…ç½®ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;utils&#x2F;create-routes-from-children *&#x2F;export function createRoutesFromChildren(  children: React.ReactNode): RouteObject[] &#123;  let routes: RouteObject[] &#x3D; [];  React.Children.forEach(children, (element) &#x3D;&gt; &#123;    if (!React.isValidElement(element)) &#123;      &#x2F;&#x2F; Ignore non-elements. This allows people to more easily inline      &#x2F;&#x2F; conditionals in their route config.      return;    &#125;    if (element.type &#x3D;&#x3D;&#x3D; React.Fragment) &#123;      &#x2F;&#x2F; Transparently support React.Fragment and its children.      &#x2F;&#x2F; é€’å½’      routes.push.apply(        routes,        createRoutesFromChildren(element.props.children)      );      return;    &#125;    invariant(      element.type &#x3D;&#x3D;&#x3D; Route,      &#96;[$&#123;        typeof element.type &#x3D;&#x3D;&#x3D; &quot;string&quot; ? element.type : element.type.name      &#125;] is not a &lt;Route&gt; component. All component children of &lt;Routes&gt; must be a &lt;Route&gt; or &lt;React.Fragment&gt;&#96;    );    let route: RouteObject &#x3D; &#123;      caseSensitive: element.props.caseSensitive,      element: element.props.element,      index: element.props.index,      path: element.props.path,    &#125;;    if (element.props.children) &#123;      &#x2F;&#x2F; é€’å½’      route.children &#x3D; createRoutesFromChildren(element.props.children);    &#125;    routes.push(route);  &#125;);  return routes;&#125;</code></pre><h3 id="useRoutes"><a href="#useRoutes" class="headerlink" title="useRoutes"></a>useRoutes</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Returns the element of the route that matched the current location, prepared * with the correct context to render the remainder of the route tree. Route * elements in the tree must render an &lt;Outlet&gt; to render their child route&#39;s * element. * è¿”å›ä¸å½“å‰ä½ç½®åŒ¹é…çš„è·¯ç”±å…ƒç´ ï¼Œå·²å‡†å¤‡å°±ç»ª * ä½¿ç”¨æ­£ç¡®çš„ä¸Šä¸‹æ–‡æ¸²æŸ“è·¯ç”±æ ‘çš„å…¶ä½™éƒ¨åˆ†ã€‚è·¯çº¿ * æ ‘ä¸­çš„å…ƒç´ å¿…é¡»æ¸²æŸ“ä¸€ä¸ª&lt;Outlet&gt;ï¼Œæ‰èƒ½æ¸²æŸ“å…¶å­è·¯ç”±çš„ * å…ƒç´ ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-routes *&#x2F;export function useRoutes(  routes: RouteObject[],  locationArg?: Partial&lt;Location&gt; | string): React.ReactElement | null &#123;  &#x2F;&#x2F; invariant(  &#x2F;&#x2F;   useInRouterContext(),  &#x2F;&#x2F;   &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the  &#x2F;&#x2F;   &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.  &#x2F;&#x2F;   &#96;useRoutes() may be used only in the context of a &lt;Router&gt; component.&#96;  &#x2F;&#x2F; );  let &#123; matches: parentMatches &#125; &#x3D; React.useContext(RouteContext);  let routeMatch &#x3D; parentMatches[parentMatches.length - 1];  let parentParams &#x3D; routeMatch ? routeMatch.params : &#123;&#125;;  let parentPathname &#x3D; routeMatch ? routeMatch.pathname : &quot;&#x2F;&quot;;  let parentPathnameBase &#x3D; routeMatch ? routeMatch.pathnameBase : &quot;&#x2F;&quot;;  let parentRoute &#x3D; routeMatch &amp;&amp; routeMatch.route;  &#x2F;&#x2F; if (__DEV__) &#123;  &#x2F;&#x2F;   &#x2F;&#x2F; You won&#39;t get a warning about 2 different &lt;Routes&gt; under a &lt;Route&gt;  &#x2F;&#x2F;   &#x2F;&#x2F; without a trailing *, but this is a best-effort warning anyway since we  &#x2F;&#x2F;   &#x2F;&#x2F; cannot even give the warning unless they land at the parent route.  &#x2F;&#x2F;   &#x2F;&#x2F;  &#x2F;&#x2F;   &#x2F;&#x2F; Example:  &#x2F;&#x2F;   &#x2F;&#x2F;  &#x2F;&#x2F;   &#x2F;&#x2F; &lt;Routes&gt;  &#x2F;&#x2F;   &#x2F;&#x2F;   &#123;&#x2F;* This route path MUST end with &#x2F;* because otherwise  &#x2F;&#x2F;   &#x2F;&#x2F;       it will never match &#x2F;blog&#x2F;post&#x2F;123 *&#x2F;&#125;  &#x2F;&#x2F;   &#x2F;&#x2F;   &lt;Route path&#x3D;&quot;blog&quot; element&#x3D;&#123;&lt;Blog &#x2F;&gt;&#125; &#x2F;&gt;  &#x2F;&#x2F;   &#x2F;&#x2F;   &lt;Route path&#x3D;&quot;blog&#x2F;feed&quot; element&#x3D;&#123;&lt;BlogFeed &#x2F;&gt;&#125; &#x2F;&gt;  &#x2F;&#x2F;   &#x2F;&#x2F; &lt;&#x2F;Routes&gt;  &#x2F;&#x2F;   &#x2F;&#x2F;  &#x2F;&#x2F;   &#x2F;&#x2F; function Blog() &#123;  &#x2F;&#x2F;   &#x2F;&#x2F;   return (  &#x2F;&#x2F;   &#x2F;&#x2F;     &lt;Routes&gt;  &#x2F;&#x2F;   &#x2F;&#x2F;       &lt;Route path&#x3D;&quot;post&#x2F;:id&quot; element&#x3D;&#123;&lt;Post &#x2F;&gt;&#125; &#x2F;&gt;  &#x2F;&#x2F;   &#x2F;&#x2F;     &lt;&#x2F;Routes&gt;  &#x2F;&#x2F;   &#x2F;&#x2F;   );  &#x2F;&#x2F;   &#x2F;&#x2F; &#125;  &#x2F;&#x2F;   let parentPath &#x3D; (parentRoute &amp;&amp; parentRoute.path) || &quot;&quot;;  &#x2F;&#x2F;   warningOnce(  &#x2F;&#x2F;     parentPathname,  &#x2F;&#x2F;     !parentRoute || parentPath.endsWith(&quot;*&quot;),  &#x2F;&#x2F;     &#96;You rendered descendant &lt;Routes&gt; (or called \&#96;useRoutes()\&#96;) at &#96; +  &#x2F;&#x2F;       &#96;&quot;$&#123;parentPathname&#125;&quot; (under &lt;Route path&#x3D;&quot;$&#123;parentPath&#125;&quot;&gt;) but the &#96; +  &#x2F;&#x2F;       &#96;parent route path has no trailing &quot;*&quot;. This means if you navigate &#96; +  &#x2F;&#x2F;       &#96;deeper, the parent won&#39;t match anymore and therefore the child &#96; +  &#x2F;&#x2F;       &#96;routes will never render.\n\n&#96; +  &#x2F;&#x2F;       &#96;Please change the parent &lt;Route path&#x3D;&quot;$&#123;parentPath&#125;&quot;&gt; to &lt;Route &#96; +  &#x2F;&#x2F;       &#96;path&#x3D;&quot;$&#123;parentPath &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot; ? &quot;*&quot; : &#96;$&#123;parentPath&#125;&#x2F;*&#96;&#125;&quot;&gt;.&#96;  &#x2F;&#x2F;   );  &#x2F;&#x2F; &#125;  let locationFromContext &#x3D; useLocation();  let location;  if (locationArg) &#123;    let parsedLocationArg &#x3D;      typeof locationArg &#x3D;&#x3D;&#x3D; &quot;string&quot; ? parsePath(locationArg) : locationArg;    &#x2F;&#x2F; invariant(    &#x2F;&#x2F;   parentPathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot; ||    &#x2F;&#x2F;     parsedLocationArg.pathname?.startsWith(parentPathnameBase),    &#x2F;&#x2F;   &#96;When overriding the location using \&#96;&lt;Routes location&gt;\&#96; or \&#96;useRoutes(routes, location)\&#96;, &#96; +    &#x2F;&#x2F;     &#96;the location pathname must begin with the portion of the URL pathname that was &#96; +    &#x2F;&#x2F;     &#96;matched by all parent routes. The current pathname base is &quot;$&#123;parentPathnameBase&#125;&quot; &#96; +    &#x2F;&#x2F;     &#96;but pathname &quot;$&#123;parsedLocationArg.pathname&#125;&quot; was given in the \&#96;location\&#96; prop.&#96;    &#x2F;&#x2F; );    location &#x3D; parsedLocationArg;  &#125; else &#123;    location &#x3D; locationFromContext;  &#125;  let pathname &#x3D; location.pathname || &quot;&#x2F;&quot;;  let remainingPathname &#x3D;    parentPathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot;      ? pathname      : pathname.slice(parentPathnameBase.length) || &quot;&#x2F;&quot;;  let matches &#x3D; matchRoutes(routes, &#123; pathname: remainingPathname &#125;);  &#x2F;&#x2F; if (__DEV__) &#123;  &#x2F;&#x2F;   warning(  &#x2F;&#x2F;     parentRoute || matches !&#x3D; null,  &#x2F;&#x2F;     &#96;No routes matched location &quot;$&#123;location.pathname&#125;$&#123;location.search&#125;$&#123;location.hash&#125;&quot; &#96;  &#x2F;&#x2F;   );  &#x2F;&#x2F;   warning(  &#x2F;&#x2F;     matches &#x3D;&#x3D; null ||  &#x2F;&#x2F;       matches[matches.length - 1].route.element !&#x3D;&#x3D; undefined,  &#x2F;&#x2F;     &#96;Matched leaf route at location &quot;$&#123;location.pathname&#125;$&#123;location.search&#125;$&#123;location.hash&#125;&quot; does not have an element. &#96; +  &#x2F;&#x2F;       &#96;This means it will render an &lt;Outlet &#x2F;&gt; with a null value by default resulting in an &quot;empty&quot; page.&#96;  &#x2F;&#x2F;   );  &#x2F;&#x2F; &#125;  return _renderMatches(    matches &amp;&amp;      matches.map((match) &#x3D;&gt;        Object.assign(&#123;&#125;, match, &#123;          params: Object.assign(&#123;&#125;, parentParams, match.params),          pathname: joinPaths([parentPathnameBase, match.pathname]),          pathnameBase:            match.pathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot;              ? parentPathnameBase              : joinPaths([parentPathnameBase, match.pathnameBase]),        &#125;)      ),    parentMatches  );&#125;</code></pre><h3 id="matchRoutes"><a href="#matchRoutes" class="headerlink" title="matchRoutes"></a>matchRoutes</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Matches the given routes to a location and returns the match data. * å°†ç»™å®šè·¯ç”±åŒ¹é…åˆ°æŸä¸ªä½ç½®å¹¶è¿”å›åŒ¹é…æ•°æ®ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;utils&#x2F;match-routes *&#x2F;export function matchRoutes(  routes: RouteObject[],  locationArg: Partial&lt;Location&gt; | string,  basename &#x3D; &quot;&#x2F;&quot;): RouteMatch[] | null &#123;  let location &#x3D;    typeof locationArg &#x3D;&#x3D;&#x3D; &quot;string&quot; ? parsePath(locationArg) : locationArg;  let pathname &#x3D; stripBasename(location.pathname || &quot;&#x2F;&quot;, basename);  if (pathname &#x3D;&#x3D; null) &#123;    return null;  &#125;  let branches &#x3D; flattenRoutes(routes);  rankRouteBranches(branches);  let matches &#x3D; null;  for (let i &#x3D; 0; matches &#x3D;&#x3D; null &amp;&amp; i &lt; branches.length; ++i) &#123;    matches &#x3D; matchRouteBranch(branches[i], pathname);  &#125;  return matches;&#125;</code></pre><h3 id="renderMatches"><a href="#renderMatches" class="headerlink" title="_renderMatches"></a>_renderMatches</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function _renderMatches(  matches: RouteMatch[] | null,  parentMatches: RouteMatch[] &#x3D; []): React.ReactElement | null &#123;  if (matches &#x3D;&#x3D; null) return null;  return matches.reduceRight((outlet, match, index) &#x3D;&gt; &#123;    return (      &lt;RouteContext.Provider        children&#x3D;&#123;          match.route.element !&#x3D;&#x3D; undefined ? match.route.element : outlet        &#125;        value&#x3D;&#123;&#123;          outlet,          matches: parentMatches.concat(matches.slice(0, index + 1)),        &#125;&#125;      &#x2F;&gt;    );  &#125;, null as React.ReactElement | null);&#125;</code></pre><h3 id="RouteContext"><a href="#RouteContext" class="headerlink" title="RouteContext"></a>RouteContext</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface RouteContextObject &#123;  outlet: React.ReactElement | null;  matches: RouteMatch[];&#125;export const RouteContext &#x3D; React.createContext&lt;RouteContextObject&gt;(&#123;  outlet: null,  matches: [],&#125;);if (__DEV__) &#123;  RouteContext.displayName &#x3D; &quot;Route&quot;;&#125;</code></pre><h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">export interface LinkProps  extends Omit&lt;React.AnchorHTMLAttributes&lt;HTMLAnchorElement&gt;, &quot;href&quot;&gt; &#123;  &#x2F;&#x2F; å‰”é™¤ href å±æ€§ï¼Œä»£ç ä¸­å†…éƒ¨ä½¿ç”¨useHref(to)ç”Ÿæˆ  reloadDocument?: boolean;  replace?: boolean;  state?: any;  to: To;&#125;&#x2F;** * The public API for rendering a history-aware &lt;a&gt;. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;components&#x2F;link *&#x2F;export const Link &#x3D; React.forwardRef&lt;HTMLAnchorElement, LinkProps&gt;(  function LinkWithRef(    &#123; onClick, reloadDocument, replace &#x3D; false, state, target, to, ...rest &#125;,    ref  ) &#123;    let href &#x3D; useHref(to);    let internalOnClick &#x3D; useLinkClickHandler(to, &#123; replace, state, target &#125;);    function handleClick(      event: React.MouseEvent&lt;HTMLAnchorElement, MouseEvent&gt;    ) &#123;      if (onClick) onClick(event);      if (!event.defaultPrevented &amp;&amp; !reloadDocument) &#123;        internalOnClick(event);      &#125;    &#125;    return (      &#x2F;&#x2F; eslint-disable-next-line jsx-a11y&#x2F;anchor-has-content      &lt;a        &#123;...rest&#125;        href&#x3D;&#123;href&#125;        onClick&#x3D;&#123;handleClick&#125;        ref&#x3D;&#123;ref&#125;        target&#x3D;&#123;target&#125;      &#x2F;&gt;    );  &#125;);</code></pre><h3 id="useHref"><a href="#useHref" class="headerlink" title="useHref"></a>useHref</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Returns the full href for the given &quot;to&quot; value. This is useful for building * custom links that are also accessible and preserve right-click behavior. * è¿”å›ç»™å®šâ€œtoâ€å€¼çš„å®Œæ•´hrefã€‚è¿™å¯¹äºæ„å»ºä¹Ÿå¯è®¿é—®å¹¶ä¿ç•™å³é”®å•å‡»è¡Œä¸ºçš„è‡ªå®šä¹‰é“¾æ¥éå¸¸æœ‰ç”¨ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-href *&#x2F;export function useHref(to: To): string &#123;  invariant(    useInRouterContext(),    &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the    &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.    &#96;useHref() may be used only in the context of a &lt;Router&gt; component.&#96;  );  let &#123; basename, navigator &#125; &#x3D; React.useContext(NavigationContext);  let &#123; hash, pathname, search &#125; &#x3D; useResolvedPath(to);  let joinedPathname &#x3D; pathname;  if (basename !&#x3D;&#x3D; &quot;&#x2F;&quot;) &#123;    let toPathname &#x3D; getToPathname(to);    let endsWithSlash &#x3D; toPathname !&#x3D; null &amp;&amp; toPathname.endsWith(&quot;&#x2F;&quot;);    joinedPathname &#x3D;      pathname &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot;        ? basename + (endsWithSlash ? &quot;&#x2F;&quot; : &quot;&quot;)        : joinPaths([basename, pathname]);  &#125;  return navigator.createHref(&#123; pathname: joinedPathname, search, hash &#125;);&#125;</code></pre><h3 id="useLinkClickHandler"><a href="#useLinkClickHandler" class="headerlink" title="useLinkClickHandler"></a>useLinkClickHandler</h3><p><a href="https://blog.csdn.net/m0_52537576/article/details/124901230#:~:text=5-,useLinkClickHandler,-%E8%BF%99%E4%B8%AAhooks%E8%BF%94%E5%9B%9E" target="_blank" >useLinkClickHandler</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Handles the click behavior for router &#96;&lt;Link&gt;&#96; components. This is useful if * you need to create custom &#96;&lt;Link&gt;&#96; components with the same click behavior we * use in our exported &#96;&lt;Link&gt;&#96;. * å¤„ç†&#96;&lt;Link&gt;&#96;ç»„ä»¶çš„å•å‡»è¡Œä¸ºã€‚å¦‚æœ * æ‚¨éœ€è¦åˆ›å»ºå…·æœ‰ä¸æˆ‘ä»¬ç›¸åŒçš„å•å‡»è¡Œä¸ºçš„è‡ªå®šä¹‰&#96;&lt;Link&gt;&#96;ç»„ä»¶ * åœ¨å¯¼å‡ºçš„&#96;&lt;Link&gt;&#96;ä¸­ä½¿ç”¨ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-link-click-handler *&#x2F;export function useLinkClickHandler&lt;E extends Element &#x3D; HTMLAnchorElement&gt;(  to: To,  &#123;    target,    replace: replaceProp,    state,  &#125;: &#123;    target?: React.HTMLAttributeAnchorTarget;    replace?: boolean;    state?: any;  &#125; &#x3D; &#123;&#125;): (event: React.MouseEvent&lt;E, MouseEvent&gt;) &#x3D;&gt; void &#123;  let navigate &#x3D; useNavigate();  let location &#x3D; useLocation();  let path &#x3D; useResolvedPath(to);  return React.useCallback(    (event: React.MouseEvent&lt;E, MouseEvent&gt;) &#x3D;&gt; &#123;      if (        event.button &#x3D;&#x3D;&#x3D; 0 &amp;&amp; &#x2F;&#x2F; Ignore everything but left clicks        (!target || target &#x3D;&#x3D;&#x3D; &quot;_self&quot;) &amp;&amp; &#x2F;&#x2F; Let browser handle &quot;target&#x3D;_blank&quot; etc.        !isModifiedEvent(event) &#x2F;&#x2F; Ignore clicks with modifier keys      ) &#123;        event.preventDefault();        &#x2F;&#x2F; If the URL hasn&#39;t changed, a regular &lt;a&gt; will do a replace instead of        &#x2F;&#x2F; a push, so do the same here.        &#x2F;&#x2F; urlæ²¡æœ‰æ”¹å˜ï¼Œåšreplaceæ“ä½œï¼Œè€Œä¸æ˜¯pushæ“ä½œ        let replace &#x3D;          !!replaceProp || createPath(location) &#x3D;&#x3D;&#x3D; createPath(path);        navigate(to, &#123; replace, state &#125;);      &#125;    &#125;,    [location, navigate, path, replaceProp, state, target, to]  );&#125;</code></pre><h3 id="useNavigate"><a href="#useNavigate" class="headerlink" title="useNavigate"></a>useNavigate</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Returns an imperative method for changing the location. Used by &lt;Link&gt;s, but * may also be used by other elements to change the location. * è¿”å›æ›´æ”¹ä½ç½®çš„å‘½ä»¤å¼æ–¹æ³•ã€‚ç”±sä½¿ç”¨ï¼Œä½† * ä¹Ÿå¯ç”±å…¶ä»–å…ƒç´ ç”¨äºæ›´æ”¹ä½ç½®ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-navigate *&#x2F;export function useNavigate(): NavigateFunction &#123;  invariant(    useInRouterContext(),    &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the    &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.    &#96;useNavigate() may be used only in the context of a &lt;Router&gt; component.&#96;  );  let &#123; basename, navigator &#125; &#x3D; React.useContext(NavigationContext);  let &#123; matches &#125; &#x3D; React.useContext(RouteContext);  let &#123; pathname: locationPathname &#125; &#x3D; useLocation();  let routePathnamesJson &#x3D; JSON.stringify(    matches.map((match) &#x3D;&gt; match.pathnameBase)  );  let activeRef &#x3D; React.useRef(false);  React.useEffect(() &#x3D;&gt; &#123;    activeRef.current &#x3D; true;  &#125;);  let navigate: NavigateFunction &#x3D; React.useCallback(    (to: To | number, options: NavigateOptions &#x3D; &#123;&#125;) &#x3D;&gt; &#123;      warning(        activeRef.current,        &#96;You should call navigate() in a React.useEffect(), not when &#96; +          &#96;your component is first rendered.&#96;      );      if (!activeRef.current) return;      if (typeof to &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;        navigator.go(to);        return;      &#125;      let path &#x3D; resolveTo(        to,        JSON.parse(routePathnamesJson),        locationPathname      );      if (basename !&#x3D;&#x3D; &quot;&#x2F;&quot;) &#123;        path.pathname &#x3D; joinPaths([basename, path.pathname]);      &#125;      &#x2F;&#x2F; è¿™è¡Œä»£ç å†™æ³•ï¼Œæ²¡è§è¿‡ï¼Œå‡½æ•°æ‰§è¡Œ      (!!options.replace ? navigator.replace : navigator.push)(        path,        options.state      );    &#125;,    [basename, navigator, routePathnamesJson, locationPathname]  );  return navigate;&#125;</code></pre><h3 id="resolveTo"><a href="#resolveTo" class="headerlink" title="resolveTo"></a>resolveTo</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function resolveTo(  toArg: To,  routePathnames: string[],  locationPathname: string): Path &#123;  let to &#x3D; typeof toArg &#x3D;&#x3D;&#x3D; &quot;string&quot; ? parsePath(toArg) : toArg;  let toPathname &#x3D; toArg &#x3D;&#x3D;&#x3D; &quot;&quot; || to.pathname &#x3D;&#x3D;&#x3D; &quot;&quot; ? &quot;&#x2F;&quot; : to.pathname;  &#x2F;&#x2F; If a pathname is explicitly provided in &#96;to&#96;, it should be relative to the  &#x2F;&#x2F; route context. This is explained in &#96;Note on &#96;&lt;Link to&gt;&#96; values&#96; in our  &#x2F;&#x2F; migration guide from v5 as a means of disambiguation between &#96;to&#96; values  &#x2F;&#x2F; that begin with &#96;&#x2F;&#96; and those that do not. However, this is problematic for  &#x2F;&#x2F; &#96;to&#96; values that do not provide a pathname. &#96;to&#96; can simply be a search or  &#x2F;&#x2F; hash string, in which case we should assume that the navigation is relative  &#x2F;&#x2F; to the current location&#39;s pathname and *not* the route pathname.  &#x2F;&#x2F; å¦‚æœåœ¨â€œtoâ€ä¸­æ˜¾å¼æä¾›äº†è·¯å¾„åï¼Œåˆ™å®ƒåº”è¯¥ç›¸å¯¹äºè·¯ç”±ä¸Šä¸‹æ–‡ã€‚è¿™åœ¨æˆ‘ä»¬çš„v5è¿ç§»æŒ‡å—ä¸­çš„â€œå…³äº&#96;&lt;Link&gt;&#96;å€¼&#39;çš„æ³¨é‡Šâ€ä¸­æœ‰è§£é‡Šï¼Œ  &#x2F;&#x2F; ä½œä¸ºæ¶ˆé™¤ä»¥&#96;&#x2F;&#96;å¼€å¤´çš„&#96;åˆ°&#96;å€¼ä¸ä¸ä»¥&#96;&#x2F;&#96;å¼€å¤´çš„&#96;åˆ°&#96;å€¼ä¹‹é—´æ­§ä¹‰çš„ä¸€ç§æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸æä¾›è·¯å¾„åçš„â€œtoâ€å€¼æ¥è¯´ï¼Œ  &#x2F;&#x2F; è¿™æ˜¯æœ‰é—®é¢˜çš„&#96;to &#96;å¯ä»¥æ˜¯ä¸€ä¸ªæœç´¢æˆ–å“ˆå¸Œå­—ç¬¦ä¸²ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å‡è®¾å¯¼èˆªç›¸å¯¹äºå½“å‰ä½ç½®çš„è·¯å¾„åï¼Œè€Œä¸æ˜¯è·¯å¾„åã€‚  let from: string;  if (toPathname &#x3D;&#x3D; null) &#123;    from &#x3D; locationPathname;  &#125; else &#123;    let routePathnameIndex &#x3D; routePathnames.length - 1;    if (toPathname.startsWith(&quot;..&quot;)) &#123;      let toSegments &#x3D; toPathname.split(&quot;&#x2F;&quot;);      &#x2F;&#x2F; Each leading .. segment means &quot;go up one route&quot; instead of &quot;go up one      &#x2F;&#x2F; URL segment&quot;.  This is a key difference from how &lt;a href&gt; works and a      &#x2F;&#x2F; major reason we call this a &quot;to&quot; value instead of a &quot;href&quot;.      while (toSegments[0] &#x3D;&#x3D;&#x3D; &quot;..&quot;) &#123;        toSegments.shift();        routePathnameIndex -&#x3D; 1;      &#125;      to.pathname &#x3D; toSegments.join(&quot;&#x2F;&quot;);    &#125;    &#x2F;&#x2F; If there are more &quot;..&quot; segments than parent routes, resolve relative to    &#x2F;&#x2F; the root &#x2F; URL.    from &#x3D; routePathnameIndex &gt;&#x3D; 0 ? routePathnames[routePathnameIndex] : &quot;&#x2F;&quot;;  &#125;  let path &#x3D; resolvePath(to, from);  &#x2F;&#x2F; Ensure the pathname has a trailing slash if the original to value had one.  &#x2F;&#x2F; å¦‚æœåŸå§‹toå€¼æœ‰æ–œæ ï¼Œè¯·ç¡®ä¿è·¯å¾„ååé¢æœ‰æ–œæ ã€‚  if (    toPathname &amp;&amp;    toPathname !&#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp;    toPathname.endsWith(&quot;&#x2F;&quot;) &amp;&amp;    !path.pathname.endsWith(&quot;&#x2F;&quot;)  ) &#123;    path.pathname +&#x3D; &quot;&#x2F;&quot;;  &#125;  return path;&#125;</code></pre><h3 id="useInRouterContext"><a href="#useInRouterContext" class="headerlink" title="useInRouterContext"></a>useInRouterContext</h3><p>åˆ¤æ–­æ˜¯å¦åœ¨æŸä¸ª React.createContext çš„ä¸Šä¸‹æ–‡</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function useInRouterContext(): boolean &#123;  return React.useContext(LocationContext) !&#x3D; null;&#125;&#x2F;&#x2F; invariant(&#x2F;&#x2F;   useInRouterContext(),&#x2F;&#x2F;   &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the&#x2F;&#x2F;   &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.&#x2F;&#x2F;   &#96;useNavigate() may be used only in the context of a &lt;Router&gt; component.&#96;&#x2F;&#x2F; );</code></pre><hr /><p>ä»¥ä¸Šéƒ¨åˆ†ï¼Œæ˜¯å¦‚ä½•ç”Ÿæˆè·¯ç”±çš„æºç éƒ¨åˆ†ã€‚æœ‰ä¸ªé—®é¢˜ï¼Œè·¯ç”±ç”Ÿæˆå‡ºæ¥äº†ï¼Œå¦‚ä½•è¿›è¡Œé…å¯¹æ¸²æŸ“ï¼Ÿèµ°çš„å¤ªå¿«äº†ï¼Œå›å»çœ‹ä¸‹</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; è¿™å—ä»£ç æˆ‘ä»¬ä¸Šé¢æœ‰çœ‹è¿‡çš„&#x2F;&#x2F; BrowserRouterReact.useLayoutEffect(() &#x3D;&gt; history.listen(setState), [history]);&#x2F;&#x2F;  history.listen(setState) å»æ‰¾ä¸‹historyçš„api&#x2F;&#x2F; @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;blob&#x2F;dev&#x2F;docs&#x2F;api-reference.md#historylistenlistener-listenerreturn (  &lt;Router &#x2F;&#x2F; react-router &quot;.&#x2F;lib&#x2F;components&quot;    basename&#x3D;&#123;basename&#125;    children&#x3D;&#123;children&#125;    location&#x3D;&#123;state.location&#125;    navigationType&#x3D;&#123;state.action&#125;    navigator&#x3D;&#123;history&#125;  &#x2F;&gt;);&#x2F;&#x2F; ç›´æ¥åœ¨è¿™é‡Œå †ç§¯ä¸‹ï¼Œä¸Šæ–‡æ˜¯æœ‰çš„let &#123;  pathname &#x3D; &quot;&#x2F;&quot;,  search &#x3D; &quot;&quot;,  hash &#x3D; &quot;&quot;,  state &#x3D; null,  key &#x3D; &quot;default&quot;,&#125; &#x3D; locationProp;&lt;LocationContext.Provider &#x2F;&#x2F; ä¸€èˆ¬æƒ…å†µè¿™é‡Œä¼šå•ç‹¬æŠ½å– LocationContext, å¹¶å†™æˆuseLocationContext  children&#x3D;&#123;children&#125; &#x2F;&#x2F; æ˜¯è¿™ç§ä»¥å±æ€§å½¢å¼å†™å…¥çš„ï¼Œä¸æ˜¯åœ¨æ ‡ç­¾ä¸­åŒ…è£¹çš„ï¼Œ å³example&#x2F;basic &lt;App &#x2F;&gt;  value&#x3D;&#123;&#123; location, navigationType &#125;&#125;&#x2F;&gt;;</code></pre><p>æ–‡æ¡£å†…å®¹</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Listener &#123;  (update: Update): void;&#125;interface Update &#123;  action: Action;  location: Location; &#x2F;&#x2F; ç”± Location,ç»“åˆRouter&#125;</code></pre><h2 id="Location-ç±»å‹"><a href="#Location-ç±»å‹" class="headerlink" title="Location ç±»å‹"></a>Location ç±»å‹</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * A URL pathname, beginning with a &#x2F;. * * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.pathname *&#x2F;export type Pathname &#x3D; string;&#x2F;** * A URL search string, beginning with a ?. * * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.search *&#x2F;export type Search &#x3D; string;&#x2F;** * The pathname, search, and hash values of a URL. *&#x2F;export interface Path &#123;  &#x2F;**   * A URL pathname, beginning with a &#x2F;.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.pathname   *&#x2F;  pathname: Pathname;  &#x2F;**   * A URL search string, beginning with a ?.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.search   *&#x2F;  search: Search;  &#x2F;**   * A URL fragment identifier, beginning with a #.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.hash   *&#x2F;  hash: Hash;&#125;&#x2F;** * An entry in a history stack. A location contains information about the * URL path, as well as possibly some arbitrary state and a key. * * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location *&#x2F;export interface Location extends Path &#123;  &#x2F;**   * A value of arbitrary data associated with this location.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.state   *&#x2F;  state: unknown;  &#x2F;**   * A unique string associated with this location. May be used to safely store   * and retrieve data in some other storage API, like &#96;localStorage&#96;.   *   * Note: This value is always &quot;default&quot; on the initial location.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.key   *&#x2F;  key: Key;&#125;</code></pre><h2 id="history-x2F-index-ts-æºç "><a href="#history-x2F-index-ts-æºç " class="headerlink" title="history&#x2F;index.ts æºç "></a>history&#x2F;index.ts æºç </h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * A function that receives notifications about location changes. *&#x2F;export interface Listener &#123;  (update: Update): void;&#125;</code></pre><p>Starts listening for location changes and calls the given callback with an Update when it does.<br>å¼€å§‹ä¾¦å¬ä½ç½®æ›´æ”¹ï¼Œå¹¶åœ¨æ›´æ”¹æ—¶ä½¿ç”¨æ›´æ–°è°ƒç”¨ç»™å®šå›è°ƒã€‚</p><h2 id="é˜¶æ®µæ€§æ€»ç»“"><a href="#é˜¶æ®µæ€§æ€»ç»“" class="headerlink" title="é˜¶æ®µæ€§æ€»ç»“"></a>é˜¶æ®µæ€§æ€»ç»“</h2><p>BrowserRouter + App.tsxï¼ˆRoutesã€Route ç”Ÿæˆè·¯ç”±ç»„ä»¶å…³ç³»ï¼‰</p><p>BrowserRouterï¼šå†…éƒ¨ history ç›‘å¬è·¯ç”±å˜åŒ–ï¼Œå°† location è¿›è¡Œç»“æ„ï¼Œå¹¶ä½¿ç”¨ useMemo è¿›è¡Œç¯å¢ƒï¼Œä¼ é€’ç»™ LocationContext.Provider çš„ valueï¼Œé©±åŠ¨å­ç»„ä»¶ children æ¸²æŸ“ï¼Œ<strong>ä»£ç  1</strong></p><p>LocationContext.Provider å­ç»„ä»¶ &#x3D; ä¹Ÿå°±æ˜¯ BrowserRouter çš„å­ç»„ä»¶ &#x3D; App.tsxï¼Œ å†…éƒ¨ï¼Œè·å– locationFromContextï¼Œè¿›è¡ŒåŒ¹é…æ¸²æŸ“ <strong>ä»£ç  2</strong>ï¼ˆè§ä¸‹è¿°å †ç§¯ä»£ç <code>ã€Œä¸Šæ–‡ä»¥è´´è¿‡æºç ï¼Œå†è´´ä¸€éã€</code>ï¼‰</p><p>è¿™é‡Œè¦æ³¨æ„ä¸‹ï¼šuseRoutes TOC å†™æ³•ï¼Œæœ€ç»ˆåº”è¯¥æ˜¯</p><h2 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç  2"></a>ä»£ç  2</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Returns the current location object, which represents the current URL in web * browsers. * * Note: If you&#39;re using this it may mean you&#39;re doing some of your own * &quot;routing&quot; in your app, and we&#39;d like to know what your use case is. We may * be able to provide something higher-level to better suit your needs. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-location *&#x2F;export function useLocation(): Location &#123;  invariant(    useInRouterContext(),    &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the    &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.    &#96;useLocation() may be used only in the context of a &lt;Router&gt; component.&#96;  );  return React.useContext(LocationContext).location;&#125;</code></pre><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; hooks.ts useRoutesä¸­let locationFromContext &#x3D; useLocation(); &#x2F;&#x2F; è¿™é‡Œlet location;if (locationArg) &#123;  let parsedLocationArg &#x3D;    typeof locationArg &#x3D;&#x3D;&#x3D; &quot;string&quot; ? parsePath(locationArg) : locationArg;  invariant(    parentPathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot; ||      parsedLocationArg.pathname?.startsWith(parentPathnameBase),    &#96;When overriding the location using \&#96;&lt;Routes location&gt;\&#96; or \&#96;useRoutes(routes, location)\&#96;, &#96; +      &#96;the location pathname must begin with the portion of the URL pathname that was &#96; +      &#96;matched by all parent routes. The current pathname base is &quot;$&#123;parentPathnameBase&#125;&quot; &#96; +      &#96;but pathname &quot;$&#123;parsedLocationArg.pathname&#125;&quot; was given in the \&#96;location\&#96; prop.&#96;  );  location &#x3D; parsedLocationArg;&#125; else &#123;  location &#x3D; locationFromContext; &#x2F;&#x2F; è¿™é‡Œ&#125;let pathname &#x3D; location.pathname || &quot;&#x2F;&quot;;let remainingPathname &#x3D;  parentPathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot;    ? pathname    : pathname.slice(parentPathnameBase.length) || &quot;&#x2F;&quot;;let matches &#x3D; matchRoutes(routes, &#123; pathname: remainingPathname &#125;);&#x2F;&#x2F; å¼€å‘æé†’ è·³è¿‡&#x2F;&#x2F; if (__DEV__) &#123;&#x2F;&#x2F;   warning(&#x2F;&#x2F;     parentRoute || matches !&#x3D; null,&#x2F;&#x2F;     &#96;No routes matched location &quot;$&#123;location.pathname&#125;$&#123;location.search&#125;$&#123;location.hash&#125;&quot; &#96;&#x2F;&#x2F;   );&#x2F;&#x2F;   warning(&#x2F;&#x2F;     matches &#x3D;&#x3D; null || matches[matches.length - 1].route.element !&#x3D;&#x3D; undefined,&#x2F;&#x2F;     &#96;Matched leaf route at location &quot;$&#123;location.pathname&#125;$&#123;location.search&#125;$&#123;location.hash&#125;&quot; does not have an element. &#96; +&#x2F;&#x2F;       &#96;This means it will render an &lt;Outlet &#x2F;&gt; with a null value by default resulting in an &quot;empty&quot; page.&#96;&#x2F;&#x2F;   );&#x2F;&#x2F; &#125;&#x2F;&#x2F; æ¸²æŸ“return _renderMatches(  matches &amp;&amp;    matches.map((match) &#x3D;&gt;      Object.assign(&#123;&#125;, match, &#123;        params: Object.assign(&#123;&#125;, parentParams, match.params),        pathname: joinPaths([parentPathnameBase, match.pathname]),        pathnameBase:          match.pathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot;            ? parentPathnameBase            : joinPaths([parentPathnameBase, match.pathnameBase]),      &#125;)    ),  parentMatches);&#x2F;&#x2F; _renderMatchesexport function _renderMatches(  matches: RouteMatch[] | null,  parentMatches: RouteMatch[] &#x3D; []): React.ReactElement | null &#123;  if (matches &#x3D;&#x3D; null) return null;  &#x2F;&#x2F; è¿™æ˜¯ä¸€ä¸ªé€’å½’ reduceRightï¼Œä¸reduceç±»ä¼¼ï¼Œä¸è¿‡reduceRightæ˜¯ä»å³åˆ°å·¦  return matches.reduceRight((outlet, match, index) &#x3D;&gt; &#123;    return (      &lt;RouteContext.Provider &#x2F;&#x2F; éœ€è¦çœ‹ä¸‹ RouteContextåœ¨ä»€ä¹ˆåœ°æ–¹ä½¿ç”¨çš„ï¼Œä¸ºä»€è¦çœ‹å®ƒï¼Œå› ä¸ºè¿™ä¸ªContextè·ç¦»æ¸²æŸ“ç»„ä»¶çš„chilrenæœ€è¿‘ï¼Œçœ‹ä»–æ˜¯å¦‚ä½•é©±åŠ¨ç»„ä»¶æ›´æ–°çš„ã€elementã€outletã€‘        children&#x3D;&#123;          match.route.element !&#x3D;&#x3D; undefined ? match.route.element : outlet        &#125;        value&#x3D;&#123;&#123;          outlet,          matches: parentMatches.concat(matches.slice(0, index + 1)),        &#125;&#125;      &#x2F;&gt;    );  &#125;, null as React.ReactElement | null);&#125;</code></pre><h2 id="RouteContext-åœ¨æºç ä¸­çš„ä½¿ç”¨"><a href="#RouteContext-åœ¨æºç ä¸­çš„ä½¿ç”¨" class="headerlink" title="RouteContext åœ¨æºç ä¸­çš„ä½¿ç”¨"></a>RouteContext åœ¨æºç ä¸­çš„ä½¿ç”¨</h2><ul><li>useNavigate</li><li>useOutlet</li><li>useParams</li><li>useResolvedPath</li><li>useRoutes</li></ul><h3 id="useNavigate-1"><a href="#useNavigate-1" class="headerlink" title="useNavigate"></a>useNavigate</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Returns an imperative method for changing the location. Used by &lt;Link&gt;s, but * may also be used by other elements to change the location. * è¿”å›æ›´æ”¹ä½ç½®çš„å‘½ä»¤å¼æ–¹æ³•ã€‚ç”±&lt;Link&gt;sä½¿ç”¨ï¼Œä½†ä¹Ÿå¯ç”±å…¶ä»–å…ƒç´ ç”¨äºæ›´æ”¹ä½ç½®ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-navigate *&#x2F;export function useNavigate(): NavigateFunction &#123;  invariant(    useInRouterContext(),    &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the    &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.    &#96;useNavigate() may be used only in the context of a &lt;Router&gt; component.&#96;  );  let &#123; basename, navigator &#125; &#x3D; React.useContext(NavigationContext);  let &#123; matches &#125; &#x3D; React.useContext(RouteContext); &#x2F;&#x2F; è¿™é‡Œ  let &#123; pathname: locationPathname &#125; &#x3D; useLocation();  let routePathnamesJson &#x3D; JSON.stringify(    matches.map((match) &#x3D;&gt; match.pathnameBase)  );  let activeRef &#x3D; React.useRef(false);  React.useEffect(() &#x3D;&gt; &#123;    activeRef.current &#x3D; true;  &#125;);  let navigate: NavigateFunction &#x3D; React.useCallback(    (to: To | number, options: NavigateOptions &#x3D; &#123;&#125;) &#x3D;&gt; &#123;      warning(        activeRef.current,        &#96;You should call navigate() in a React.useEffect(), not when &#96; +          &#96;your component is first rendered.&#96;      );      if (!activeRef.current) return;      if (typeof to &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;        navigator.go(to);        return;      &#125;      let path &#x3D; resolveTo(        to,        JSON.parse(routePathnamesJson),        locationPathname      );      if (basename !&#x3D;&#x3D; &quot;&#x2F;&quot;) &#123;        path.pathname &#x3D; joinPaths([basename, path.pathname]);      &#125;      (!!options.replace ? navigator.replace : navigator.push)(        path,        options.state      );    &#125;,    [basename, navigator, routePathnamesJson, locationPathname]  );  return navigate;&#125;&#x2F;** * Returns the element for the child route at this level of the route * hierarchy. Used internally by &lt;Outlet&gt; to render child routes. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-outlet *&#x2F;export function useOutlet(context?: unknown): React.ReactElement | null &#123;  let outlet &#x3D; React.useContext(RouteContext).outlet; &#x2F;&#x2F; è¿™é‡Œ  if (outlet) &#123;    return (      &lt;OutletContext.Provider value&#x3D;&#123;context&#125;&gt;&#123;outlet&#125;&lt;&#x2F;OutletContext.Provider&gt;    );  &#125;  return outlet;&#125;export function useParams&lt;  ParamsOrKey extends string | Record&lt;string, string | undefined&gt; &#x3D; string&gt;(): Readonly&lt;  [ParamsOrKey] extends [string] ? Params&lt;ParamsOrKey&gt; : Partial&lt;ParamsOrKey&gt;&gt; &#123;  let &#123; matches &#125; &#x3D; React.useContext(RouteContext);&#x2F;&#x2F; è¿™é‡Œ  let routeMatch &#x3D; matches[matches.length - 1];  return routeMatch ? (routeMatch.params as any) : &#123;&#125;;&#125;&#x2F;** * Resolves the pathname of the given &#96;to&#96; value against the current location. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;api#useresolvedpath *&#x2F;export function useResolvedPath(to: To): Path &#123;  let &#123; matches &#125; &#x3D; React.useContext(RouteContext); &#x2F;&#x2F; è¿™é‡Œ  let &#123; pathname: locationPathname &#125; &#x3D; useLocation();  let routePathnamesJson &#x3D; JSON.stringify(    matches.map((match) &#x3D;&gt; match.pathnameBase)  );  return React.useMemo(    () &#x3D;&gt; resolveTo(to, JSON.parse(routePathnamesJson), locationPathname),    [to, routePathnamesJson, locationPathname]  );&#125;&#x2F;** * Returns the element of the route that matched the current location, prepared * with the correct context to render the remainder of the route tree. Route * elements in the tree must render an &lt;Outlet&gt; to render their child route&#39;s * element. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-routes *&#x2F;export function useRoutes(  routes: RouteObject[],  locationArg?: Partial&lt;Location&gt; | string): React.ReactElement | null &#123;  invariant(    useInRouterContext(),    &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the    &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.    &#96;useRoutes() may be used only in the context of a &lt;Router&gt; component.&#96;  );  let &#123; matches: parentMatches &#125; &#x3D; React.useContext(RouteContext); &#x2F;&#x2F; è¿™é‡Œ  let routeMatch &#x3D; parentMatches[parentMatches.length - 1];  let parentParams &#x3D; routeMatch ? routeMatch.params : &#123;&#125;;  let parentPathname &#x3D; routeMatch ? routeMatch.pathname : &quot;&#x2F;&quot;;  let parentPathnameBase &#x3D; routeMatch ? routeMatch.pathnameBase : &quot;&#x2F;&quot;;  let parentRoute &#x3D; routeMatch &amp;&amp; routeMatch.route;</code></pre><p>æœ€ç»ˆå‘ç°ï¼Œåˆå›åˆ° useRoutesï¼Œä¹Ÿç¡®å®æ˜¯åœ¨å°¾éƒ¨è°ƒç”¨ TOC,å¦‚ä¸‹æŠ½å–éƒ¨åˆ†ä»£ç ç‰‡æ®µ</p><h2 id="ä»£ç -2-1"><a href="#ä»£ç -2-1" class="headerlink" title="ä»£ç  2"></a>ä»£ç  2</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; 1 useRouteså°¾éƒ¨è°ƒç”¨let locationFromContext &#x3D; useLocation(); &#x2F;&#x2F; è¿™é‡Œreturn _renderMatches(  matches &amp;&amp;    matches.map((match) &#x3D;&gt;      Object.assign(&#123;&#125;, match, &#123;        params: Object.assign(&#123;&#125;, parentParams, match.params),        pathname: joinPaths([parentPathnameBase, match.pathname]),        pathnameBase:          match.pathnameBase &#x3D;&#x3D;&#x3D; &quot;&#x2F;&quot;            ? parentPathnameBase            : joinPaths([parentPathnameBase, match.pathnameBase]),      &#125;)    ),  parentMatches);&#x2F;&#x2F; 2export function _renderMatches(  matches: RouteMatch[] | null,  parentMatches: RouteMatch[] &#x3D; []): React.ReactElement | null &#123;  if (matches &#x3D;&#x3D; null) return null;  &#x2F;&#x2F; è¿™æ˜¯ä¸€ä¸ªé€’å½’ reduceRightï¼Œä¸reduceç±»ä¼¼ï¼Œä¸è¿‡reduceRightæ˜¯ä»å³åˆ°å·¦  return matches.reduceRight((outlet, match, index) &#x3D;&gt; &#123;    return (      &lt;RouteContext.Provider &#x2F;&#x2F; éœ€è¦çœ‹ä¸‹ RouteContextåœ¨ä»€ä¹ˆåœ°æ–¹ä½¿ç”¨çš„ï¼Œä¸ºä»€è¦çœ‹å®ƒï¼Œå› ä¸ºè¿™ä¸ªContextè·ç¦»æ¸²æŸ“ç»„ä»¶çš„chilrenæœ€è¿‘ï¼Œçœ‹ä»–æ˜¯å¦‚ä½•é©±åŠ¨ç»„ä»¶æ›´æ–°çš„ã€elementã€outletã€‘        children&#x3D;&#123;          match.route.element !&#x3D;&#x3D; undefined ? match.route.element : outlet &#x2F;&#x2F; è¿™é‡Œçš„returnç›¸å½“äºå°† ä¸Šè¿°1çš„ä»£ç å…¨éƒ¨å¡åœ¨RouteContext.Providerä¸­  æ³¨æ„ï¼šå› ä¸ºreact.contextåªèƒ½åœ¨å¯¹åº”çš„providerä¸­ä½¿ç”¨          &#x2F;&#x2F; è¿™é‡Œæ‹¿äº† Routeçš„elementçš„å±æ€§ï¼ˆç»„ä»¶æ¸²æŸ“ï¼‰æ®è¯´ï¼ŒRouteçš„å½¢å¼æœ‰å¥½å¤šç§ï¼Œä¸‹é¢çœ‹çœ‹å»        &#125;        value&#x3D;&#123;&#123;          outlet,          matches: parentMatches.concat(matches.slice(0, index + 1)),        &#125;&#125;      &#x2F;&gt;    );  &#125;, null as React.ReactElement | null);&#125;</code></pre><h2 id="Route"><a href="#Route" class="headerlink" title="Route"></a>Route</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Declares an element that should be rendered at a certain URL path. * å£°æ˜åœ¨æŸä¸ªURLè·¯å¾„æ¸²æŸ“çš„å…ƒç´  * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;components&#x2F;route *&#x2F;export function Route( &#x2F;&#x2F; è¿™ä¸ªçœ‹ä¸Šå»å°±ä¸€ä¸ªå‡½æ•°å£°æ˜ï¼Œå•¥éƒ½æ²¡æœ‰  _props: PathRouteProps | LayoutRouteProps | IndexRouteProps): React.ReactElement | null &#123;  invariant(    false,    &#96;A &lt;Route&gt; is only ever to be used as the child of &lt;Routes&gt; element, &#96; +      &#96;never rendered directly. Please wrap your &lt;Route&gt; in a &lt;Routes&gt;.&#96;  );&#125;</code></pre><h2 id="createRoutesFromChildren-1"><a href="#createRoutesFromChildren-1" class="headerlink" title="createRoutesFromChildren"></a>createRoutesFromChildren</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Creates a route config from a React &quot;children&quot; object, which is usually * either a &#96;&lt;Route&gt;&#96; element or an array of them. Used internally by * &#96;&lt;Routes&gt;&#96; to create a route config from its children. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;utils&#x2F;create-routes-from-children *&#x2F;export function createRoutesFromChildren(  children: React.ReactNode): RouteObject[] &#123;  let routes: RouteObject[] &#x3D; [];  React.Children.forEach(children, (element) &#x3D;&gt; &#123;    if (!React.isValidElement(element)) &#123;      &#x2F;&#x2F; ä¸æ˜¯reactç»„ä»¶è¿”å›undefined,ç»“æŸ      &#x2F;&#x2F; Ignore non-elements. This allows people to more easily inline      &#x2F;&#x2F; conditionals in their route config.      return;    &#125;    if (element.type &#x3D;&#x3D;&#x3D; React.Fragment) &#123;      &#x2F;&#x2F; React.Fragment      &#x2F;&#x2F; Transparently support React.Fragment and its children.      &#x2F;&#x2F; æ”¯æŒReact.FragmentåŠå…¶å­çº§ã€‚      routes.push.apply(        routes,        createRoutesFromChildren(element.props.children)      );      return;    &#125;    invariant(      element.type &#x3D;&#x3D;&#x3D; Route,      &#96;[$&#123;        typeof element.type &#x3D;&#x3D;&#x3D; &quot;string&quot; ? element.type : element.type.name      &#125;] is not a &lt;Route&gt; component. All component children of &lt;Routes&gt; must be a &lt;Route&gt; or &lt;React.Fragment&gt;&#96;    );    let route: RouteObject &#x3D; &#123;      caseSensitive: element.props.caseSensitive,      element: element.props.element, &#x2F;&#x2F; è¿™é‡Œç›´æ¥æŠŠç»„ä»¶ç»™äº†routeï¼Œä¸Šé¢   match.route.element !&#x3D;&#x3D; undefined ? match.route.element : outlet  æ¸²æŸ“æ—¶å€™æ¸²æŸ“å°±æ˜¯å®ƒ      index: element.props.index,      path: element.props.path,    &#125;;    if (element.props.children) &#123;      &#x2F;&#x2F; æœ‰children      route.children &#x3D; createRoutesFromChildren(element.props.children);    &#125;    routes.push(route);  &#125;);  return routes;&#125;</code></pre><h2 id="è‡³æ­¤"><a href="#è‡³æ­¤" class="headerlink" title="è‡³æ­¤"></a>è‡³æ­¤</h2><p>æˆ‘ä»¬äº†è§£åˆ°äº†ï¼Œreact-router ç›‘å¬ï¼Œæ¸²æŸ“æ•´ä¸ªè¿‡ç¨‹</p><h2 id="ä½™ä¸‹çš„å‹¾å­"><a href="#ä½™ä¸‹çš„å‹¾å­" class="headerlink" title="ä½™ä¸‹çš„å‹¾å­"></a>ä½™ä¸‹çš„å‹¾å­</h2><ul><li>useNavigate</li><li>useOutlet</li><li>useParams</li><li>useResolvedPath</li></ul><h3 id="useNavigate-2"><a href="#useNavigate-2" class="headerlink" title="useNavigate"></a>useNavigate</h3><p>ç‹¬ç«‹åŠŸèƒ½å—ï¼Œæä¾› navigate ç”¨äºè·³è½¬ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ¥å—æ•°å­—å’Œè·¯å¾„</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Returns an imperative method for changing the location. Used by &lt;Link&gt;s, but * may also be used by other elements to change the location. * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-navigate *&#x2F;export function useNavigate(): NavigateFunction &#123;  invariant(    useInRouterContext(),    &#x2F;&#x2F; TODO: This error is probably because they somehow have 2 versions of the    &#x2F;&#x2F; router loaded. We can help them understand how to avoid that.    &#96;useNavigate() may be used only in the context of a &lt;Router&gt; component.&#96;  );  let &#123; basename, navigator &#125; &#x3D; React.useContext(NavigationContext);  let &#123; matches &#125; &#x3D; React.useContext(RouteContext);  let &#123; pathname: locationPathname &#125; &#x3D; useLocation();  let routePathnamesJson &#x3D; JSON.stringify(    matches.map((match) &#x3D;&gt; match.pathnameBase)  );  let activeRef &#x3D; React.useRef(false);  React.useEffect(() &#x3D;&gt; &#123;    activeRef.current &#x3D; true;  &#125;);  &#x2F;&#x2F; å£°æ˜ä¸€ä¸ªå‡½æ•°  let navigate: NavigateFunction &#x3D; React.useCallback(    (to: To | number, options: NavigateOptions &#x3D; &#123;&#125;) &#x3D;&gt; &#123;      warning(        activeRef.current,        &#96;You should call navigate() in a React.useEffect(), not when &#96; +          &#96;your component is first rendered.&#96;      );      if (!activeRef.current) return;      if (typeof to &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;        &#x2F;&#x2F; æ”¯æŒæ•°å­—        navigator.go(to);        return;      &#125;      let path &#x3D; resolveTo(        to,        JSON.parse(routePathnamesJson),        locationPathname      );      if (basename !&#x3D;&#x3D; &quot;&#x2F;&quot;) &#123;        path.pathname &#x3D; joinPaths([basename, path.pathname]);      &#125;      (!!options.replace ? navigator.replace : navigator.push)(        path, &#x2F;&#x2F; æ”¯æŒè·¯å¾„è·³è½¬        options.state      );    &#125;,    [basename, navigator, routePathnamesJson, locationPathname]  );  &#x2F;&#x2F; è¿”å›è¿™ä¸ªå‡½æ•°  return navigate;&#125;</code></pre><h3 id="useOutlet"><a href="#useOutlet" class="headerlink" title="useOutlet"></a>useOutlet</h3><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Returns the element for the child route at this level of the route * hierarchy. Used internally by &lt;Outlet&gt; to render child routes. * è¿”å›è·¯ç”±å±‚æ¬¡ç»“æ„æ­¤çº§åˆ«çš„å­è·¯ç”±çš„å…ƒç´ ã€‚ç”±&lt;Outlet&gt;å†…éƒ¨ä½¿ç”¨ä»¥æ¸²æŸ“å­è·¯ç”±ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-outlet *&#x2F;export function useOutlet(context?: unknown): React.ReactElement | null &#123;  let outlet &#x3D; React.useContext(RouteContext).outlet;  if (outlet) &#123;    return (      &lt;OutletContext.Provider value&#x3D;&#123;context&#125;&gt;&#123;outlet&#125;&lt;&#x2F;OutletContext.Provider&gt;    );  &#125;  return outlet;&#125;&#x2F;&#x2F; ä½¿ç”¨&#x2F;** * Renders the child route&#39;s element, if there is one. * æ¸²æŸ“å­è·¯ç”±çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;components&#x2F;outlet *&#x2F;export function Outlet(props: OutletProps): React.ReactElement | null &#123;  return useOutlet(props.context);&#125;</code></pre><h3 id="useParams"><a href="#useParams" class="headerlink" title="useParams"></a>useParams</h3><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Returns an object of key&#x2F;value pairs of the dynamic params from the current * URL that were matched by the route path. * è¿”å›ç”±è·¯ç”±è·¯å¾„åŒ¹é…çš„å½“å‰URLä¸­çš„åŠ¨æ€å‚æ•°çš„é”®&#x2F;å€¼å¯¹ç»„æˆçš„å¯¹è±¡ã€‚ * * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;hooks&#x2F;use-params *&#x2F;export function useParams&lt;  ParamsOrKey extends string | Record&lt;string, string | undefined&gt; &#x3D; string&gt;(): Readonly&lt;  [ParamsOrKey] extends [string] ? Params&lt;ParamsOrKey&gt; : Partial&lt;ParamsOrKey&gt;&gt; &#123;  let &#123; matches &#125; &#x3D; React.useContext(RouteContext);  let routeMatch &#x3D; matches[matches.length - 1];  &#x2F;&#x2F; æœ€åä¸€ä¸ªå°±æ˜¯å½“å‰é¡µé¢å¯¹åº”å‚æ•°ï¼šæ€ä¹ˆç†è§£  &#x2F;&#x2F; 1. pushæƒ…å†µï¼Œæœ€åä¸€ä¸ªæ˜¯å½“å‰é¡µé¢  &#x2F;&#x2F; 2. replaceæƒ…å†µï¼Œæœ€åä¸€ä¸ªæ˜¯å½“å‰é¡µé¢  &#x2F;&#x2F; 3. pop è¿”å›æƒ…å†µï¼Œæœ€åä¸€ä¸ªæ˜¯å½“å‰é¡µé¢  &#x2F;&#x2F; æ‰€ä»¥æœ€åä¸€ä¸ªå°±æ˜¯å½“å‰é¡µé¢  return routeMatch ? (routeMatch.params as any) : &#123;&#125;;&#125;</code></pre><h3 id="useResolvedPath"><a href="#useResolvedPath" class="headerlink" title="useResolvedPath"></a>useResolvedPath</h3><p><a href="https://github.com/841660202/react-router/blob/854f4a41780089ad114fecef1a25111830f5cc0b/examples/custom-link/src/App.tsx#L36">å…·ä½“ä½¿ç”¨è§</a></p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Resolves the pathname of the given &#96;to&#96; value against the current location. * æ ¹æ®å½“å‰ä½ç½®è§£æç»™å®šâ€œtoâ€å€¼çš„è·¯å¾„åã€‚ * @see https:&#x2F;&#x2F;reactrouter.com&#x2F;docs&#x2F;en&#x2F;v6&#x2F;api#useresolvedpath *&#x2F;export function useResolvedPath(to: To): Path &#123;  let &#123; matches &#125; &#x3D; React.useContext(RouteContext);  let &#123; pathname: locationPathname &#125; &#x3D; useLocation();  let routePathnamesJson &#x3D; JSON.stringify(    matches.map((match) &#x3D;&gt; match.pathnameBase)  );  return React.useMemo(    () &#x3D;&gt; resolveTo(to, JSON.parse(routePathnamesJson), locationPathname),    [to, routePathnamesJson, locationPathname]  );&#125;&#x2F;&#x2F; Pathexport interface Path &#123;  &#x2F;**   * A URL pathname, beginning with a &#x2F;.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.pathname   *&#x2F;  pathname: Pathname;  &#x2F;**   * A URL search string, beginning with a ?.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.search   *&#x2F;  search: Search;  &#x2F;**   * A URL fragment identifier, beginning with a #.   *   * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.hash   *&#x2F;  hash: Hash;&#125;&#x2F;** * A URL pathname, beginning with a &#x2F;. * * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.pathname *&#x2F;export type Pathname &#x3D; string;&#x2F;** * A URL search string, beginning with a ?. * * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.search *&#x2F;export type Search &#x3D; string;&#x2F;** * A URL fragment identifier, beginning with a #. * * @see https:&#x2F;&#x2F;github.com&#x2F;remix-run&#x2F;history&#x2F;tree&#x2F;main&#x2F;docs&#x2F;api-reference.md#location.hash *&#x2F;export type Hash &#x3D; string;</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://github.com/841660202/react-router">fork çš„ react-router ä»£ç </a><br><a href="https://juejin.cn/post/6886290490640039943">ã€Œæºç è§£æ ã€è¿™ä¸€æ¬¡å½»åº•å¼„æ‡‚ react-router è·¯ç”±åŸç†</a><br><a href="https://www.lmlphp.com/user/60155/article/item/1561048/">React Router æ•™ç¨‹</a></p>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-router v6.4.0 ä¸»è¦æ¦‚å¿µ</title>
      <link href="//post/2022-06-21react-router.html"/>
      <url>//post/2022-06-21react-router.html</url>
      
        <content type="html"><![CDATA[<h2 id="å®˜ç½‘"><a href="#å®˜ç½‘" class="headerlink" title="å®˜ç½‘"></a>å®˜ç½‘</h2><p><a href="https://reactrouter.com/" target="_blank" >React Router v6 is Here</a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>React Router v6 åœ¨å®¢æˆ·ç«¯è·¯ç”±åå¹´çš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨äº†ä»¥å‰ç‰ˆæœ¬åŠå…¶å§å¦¹é¡¹ç›® Reach Router çš„æœ€ä½³åŠŸèƒ½ï¼Œé‡‡ç”¨äº†è¿„ä»Šä¸ºæ­¢æœ€å°å’Œæœ€å¼ºå¤§çš„è½¯ä»¶åŒ…ã€‚</p></blockquote><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>æˆ–è®¸æŸä¸€å¤©ï¼Œå†è§æ—¶ï¼Œå·²ä¸æ˜¯ v6</p></div><p>å®˜ç½‘åˆ†ä¸ºä¸¤å—å†…å®¹ <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#main-concepts" target="_blank" >æ ¸å¿ƒæ¦‚å¿µ</a> <a href="https://reactrouter.com/docs/en/v6/getting-started/tutorial" target="_blank" >å®è·µæŒ‡å¯¼</a>,æœ¬ç« å†…å®¹ä¸»è¦æ˜¯<strong>ä¸»è¦æ¦‚å¿µ</strong></p><p>You might be wondering what exactly React Router does. How can it help you build your app? What exactly is a router, anyway?<br><em>ä½ å¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘ï¼Œä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿå¦‚ä½•æ„å»ºä½ çš„åº”ç”¨ï¼Ÿä»€ä¹ˆæ˜¯ä¸€ä¸ªè·¯ç”±ï¼Ÿã€‚ã€‚ã€‚</em><br>If youâ€™ve ever had any of these questions, or youâ€™d just like to dig into the fundamental pieces of routing, youâ€™re in the right place. This document contains detailed explanations of all the core concepts behind routing as implemented in React Router.<br><em>å¦‚æœä½ æœ‰è¿‡è¿™äº›é—®é¢˜ï¼Œæˆ–è€…ä½ æƒ³è¦æ·±å…¥äº†è§£è·¯ç”±çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä½ å°±åœ¨æ­£ç¡®çš„ä½ç½®äº†ã€‚æœ¬æ–‡æ¡£åŒ…å«äº† React Router çš„å®ç°ä¸­æ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µçš„è¯¦ç»†è§£é‡Šã€‚</em></p><p>Please donâ€™t let this document overwhelm you! For everyday use, React Router is pretty simple. You donâ€™t need to go this deep to use it.<br><em>è¯·ä¸è¦è®©è¿™ä»½æ–‡æ¡£å‡»è´¥ä½ ï¼å¯¹äºæ¯æ—¥ä½¿ç”¨ï¼ŒReact Router æ˜¯éå¸¸ç®€å•çš„ã€‚ä½ ä¸éœ€è¦å»æ·±å…¥åˆ°è¿™é‡Œæ¥ä½¿ç”¨å®ƒã€‚</em></p><p>React Router isnâ€™t just about matching a url to a function or component: itâ€™s about building a full user interface that maps to the URL, so it might have more concepts in it than youâ€™re used to. Weâ€™ll go into detail on the three main jobs of React Router:<br><em>React Router ä¸ä»…ä»…æ˜¯åŒ¹é…ä¸€ä¸ª url åˆ°ä¸€ä¸ªå‡½æ•°æˆ–ç»„ä»¶ï¼šå®ƒæ˜¯æ„å»ºä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒå¯èƒ½æœ‰æ›´å¤šæ¦‚å¿µåœ¨é‡Œé¢ï¼Œä½ å¯èƒ½ä¸ä¼šæ„Ÿåˆ°ã€‚æˆ‘ä»¬å°†ä»ä¸‰ä¸ªä¸»è¦çš„å·¥ä½œä¸­å»è§£é‡Š React Routerï¼š</em></p><ol><li>Subscribing and manipulating the history stack <em>è®¢é˜…å’Œæ“ä½œå†å²å †æ ˆ</em></li><li>Matching the URL to your routes <em>åŒ¹é… URL åˆ°ä½ çš„è·¯ç”±</em></li><li>Rendering a nested UI from the route matches <em>åœ¨è·¯ç”±åŒ¹é…ä¸­æ¸²æŸ“åµŒå¥—çš„ UI</em></li></ol><h2 id="Definitions"><a href="#Definitions" class="headerlink" title="Definitions"></a>Definitions</h2><p><em>å®šä¹‰</em></p><p>But first, some definitions! There are a lot of different ideas around routing from back and front end frameworks. Sometimes a word in one context might have different meaning than another.<br><em>é¦–å…ˆï¼Œæœ‰ä¸€äº›å®šä¹‰ï¼æœ‰å¾ˆå¤šä¸åŒçš„ç†å¿µåœ¨è·¯ç”±çš„åç«¯å’Œå‰ç«¯æ¡†æ¶ã€‚æœ‰æ—¶ä¸€ä¸ªå•è¯åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­å¯èƒ½æœ‰ä¸åŒçš„æ„æ€ã€‚</em></p><p>Here are some words we use a lot when we talk about React Router. The rest of this guide will go into more detail on each one.<br><em>è¿™é‡Œæœ‰ä¸€äº›æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„è¯æ±‡ï¼ŒReact Router çš„å…¶ä»–éƒ¨åˆ†å°†ä¼šä»¥æ¯ä¸ªè¯æ±‡ä¸ºé¢˜æ¥è®²è¿°ã€‚</em></p><p><strong>URL</strong> - The URL in the address bar. A lot of people use the term â€œURLâ€ and â€œrouteâ€ interchangeably, but this is not a route in React Router, itâ€™s just a URL.<br><em><strong>URL</strong> - åœ°å€æ ä¸­çš„ URLã€‚å¾ˆå¤šäººä½¿ç”¨â€œURLâ€å’Œâ€œè·¯ç”±â€å¯äº¤æ¢ä½¿ç”¨ï¼Œä½†è¿™ä¸æ˜¯ React Router çš„è·¯ç”±ï¼Œå®ƒåªæ˜¯ä¸€ä¸ª URLã€‚</em></p><p><strong>Location</strong> - This is a React Router specific object that is based on the built-in browserâ€™s window.location object. It represents â€œwhere the user is atâ€. Itâ€™s mostly an object representation of the URL but has a bit more to it than that.<br><em><strong>ä½ç½®</strong>- è¿™æ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„ window.location å¯¹è±¡çš„<code>React Router</code>ç‰¹å®šå¯¹è±¡ã€‚å®ƒè¡¨ç¤ºâ€œç”¨æˆ·åœ¨å“ªé‡Œâ€ã€‚å®ƒä¸»è¦æ˜¯ä¸€ä¸ªå¯¹ URL çš„å¯¹è±¡è¡¨ç¤ºï¼Œä½†æœ‰æ›´å¤šçš„äº‹æƒ…ã€‚</em></p><p><strong>Location State</strong> - A value that persists with a location that isnâ€™t encoded in the URL. Much like hash or search params (data encoded in the URL), but stored invisibly in the browserâ€™s memory.<br><em><strong>ä½ç½®çŠ¶æ€</strong> - ä¸€ä¸ªå€¼ï¼Œåœ¨ä¸åœ¨ URL ä¸­ç¼–ç çš„ä½ç½®ä¿æŒã€‚ç±»ä¼¼äºå“ˆå¸Œæˆ–æœç´¢å‚æ•°ï¼ˆåœ¨ URL ä¸­ç¼–ç çš„æ•°æ®ï¼‰ï¼Œä½†å­˜å‚¨åœ¨æµè§ˆå™¨çš„å†…å­˜ä¸­ã€‚</em></p><p><strong>History Stack</strong> - As the user navigates, the browser keeps track of each location in a stack. If you click and hold the back button in a browser you can see the browserâ€™s history stack right there.<br><em><strong>å†å²å †æ ˆ</strong> - å½“ç”¨æˆ·å¯¼èˆªæ—¶ï¼Œæµè§ˆå™¨ä¼šè®°å½•æ¯ä¸ªä½ç½®åœ¨ä¸€ä¸ªå †æ ˆä¸­ã€‚å¦‚æœä½ ç‚¹å‡»å¹¶ä¿æŒåé€€æŒ‰é’®åœ¨æµè§ˆå™¨ï¼Œä½ å¯ä»¥çœ‹åˆ°æµè§ˆå™¨çš„å†å²å †æ ˆåœ¨é‚£é‡Œã€‚</em></p><p><strong>Client Side Routing (CSR)</strong> - A plain HTML document can link to other documents and the browser handles the history stack itself. Client Side Routing enables developers to manipulate the browser history stack without making a document request to the server.<br><em><strong>å®¢æˆ·ç«¯ç«¯è·¯ç”± (CSR)</strong> - åªéœ€è¦ä¸€ä¸ª HTML æ–‡æ¡£ï¼Œå¯ä»¥é“¾æ¥åˆ°å…¶ä»–æ–‡æ¡£ï¼Œæµè§ˆå™¨ä¼šè‡ªå·±å¤„ç†å†å²å †æ ˆã€‚å®¢æˆ·ç«¯ç«¯è·¯ç”±ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ“ä½œæµè§ˆå™¨å†å²å †æ ˆï¼Œè€Œä¸éœ€è¦è¯·æ±‚æ–‡æ¡£ã€‚</em></p><p><strong>History</strong> - An object that allows React Router to subscribe to changes in the URL as well as providing APIs to manipulate the browser history stack programmatically.<br><em><strong>å†å²</strong> - ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ React Router è®¢é˜… URL çš„å˜åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€ä¸ª APIï¼Œç”¨äºæ‰‹åŠ¨æ“ä½œæµè§ˆå™¨å†å²å †æ ˆã€‚</em></p><p><strong>History Action</strong> - One of POP, PUSH, or REPLACE. Users can arrive at a URL for one of these three reasons. A push when a new entry is added to the history stack (typically a link click or the programmer forced a navigation). A replace is similar except it replaces the current entry on the stack instead of pushing a new one. Finally, a pop happens when the user clicks the back or forward buttons in the browser chrome.<br><em><strong>å†å²åŠ¨ä½œ</strong> - POPã€PUSH æˆ– REPLACE ä¹‹ä¸€ã€‚ç”¨æˆ·å¯ä»¥åˆ°è¾¾è¿™ä¸‰ä¸ªåŸå› çš„ URLã€‚ä¸€ä¸ª push å½“æ·»åŠ ä¸€ä¸ªæ–°æ¡ç›®åˆ°å†å²å †æ ˆæ—¶ï¼ˆé€šå¸¸æ˜¯é“¾æ¥ç‚¹å‡»æˆ–ç¨‹åºå‘˜å¼ºåˆ¶å¯¼èˆªï¼‰ã€‚ä¸€ä¸ª replace ç±»ä¼¼ï¼Œä½†å®ƒæ›¿æ¢å½“å‰æ¡ç›®è€Œä¸æ˜¯æ·»åŠ ä¸€ä¸ªæ–°çš„ã€‚æœ€åï¼Œä¸€ä¸ª pop å‘ç”Ÿåœ¨ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨çª—å£çš„åé€€æˆ–å‰è¿›æŒ‰é’®ã€‚</em></p><p><strong>Segment</strong> - The parts of a URL or path pattern between the &#x2F; characters. For example, â€œ&#x2F;users&#x2F;123â€ has two segments.<br><em><strong>åˆ†æ®µ</strong> - URL æˆ–è·¯å¾„æ¨¡å¼ä¸­çš„ &#x2F; å­—ç¬¦ä¹‹é—´çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œâ€&#x2F;users&#x2F;123â€ æœ‰ä¸¤ä¸ªåˆ†æ®µã€‚</em></p><p><strong>Path Pattern</strong> - These look like URLs but can have special characters for matching URLs to routes, like dynamic segments (â€œ&#x2F;users&#x2F;:userIdâ€) or star segments (â€œ&#x2F;docs&#x2F;*â€œ). They arenâ€™t URLs, theyâ€™re patterns that React Router will match.<br><em><strong>è·¯å¾„æ¨¡å¼</strong> - è¿™æ ·çœ‹èµ·æ¥åƒ URLï¼Œä½†å®ƒä»¬å¯ä»¥åŒ…å«ç‰¹æ®Šå­—ç¬¦æ¥åŒ¹é… URL åˆ°è·¯ç”±ï¼Œä¾‹å¦‚åŠ¨æ€åˆ†æ®µ (â€œ&#x2F;users&#x2F;:userIdâ€) æˆ–æ˜Ÿå·åˆ†æ®µ (â€œ&#x2F;docs&#x2F;*â€œ)ã€‚å®ƒä»¬ä¸æ˜¯ URLï¼Œå®ƒä»¬æ˜¯ React Router å°†åŒ¹é…çš„æ¨¡å¼ã€‚</em></p><p><strong>Dynamic Segment</strong> - A segment of a path pattern that is dynamic, meaning it can match any values in the segment. For example the pattern &#x2F;users&#x2F;:userId will match URLs like &#x2F;users&#x2F;123<br><em><strong>åŠ¨æ€åˆ†æ®µ</strong> - è·¯å¾„æ¨¡å¼ä¸­çš„ä¸€ä¸ªåˆ†æ®µï¼Œå®ƒå¯ä»¥åŒ¹é…åˆ†æ®µä¸­çš„ä»»ä½•å€¼ã€‚ä¾‹å¦‚ï¼Œè·¯å¾„æ¨¡å¼ &#x2F;users&#x2F;:userId å°†åŒ¹é… URL ç±»ä¼¼ &#x2F;users&#x2F;123</em></p><p><strong>URL Params</strong> - The parsed values from the URL that matched a dynamic segment.<br><em><strong>URL å‚æ•°</strong> - ä» URL ä¸­è§£æå‡ºçš„å€¼ã€‚</em></p><p><strong>Router</strong> - Stateful, top-level component that makes all the other components and hooks work.<br><em><strong>è·¯ç”±</strong> - ä¸€ä¸ªçŠ¶æ€ä¸ºç»„ä»¶ï¼Œç”¨äºè®©æ‰€æœ‰å…¶ä»–ç»„ä»¶å’Œé’©å­å·¥ä½œã€‚</em></p><p><strong>Route Config</strong> - A tree of routes objects that will be ranked and matched (with nesting) against the current location to create a branch of route matches.<br><em><strong>è·¯ç”±é…ç½®</strong> - ä¸€ä¸ªè·¯ç”±å¯¹è±¡çš„æ ‘ï¼Œå°†ä¼šæ’åºå’ŒåŒ¹é…ï¼ˆåŒ…å«åµŒå¥—ï¼‰ä¸å½“å‰ä½ç½®æ¥åˆ›å»ºä¸€ä¸ªè·¯ç”±åŒ¹é…çš„åˆ†æ”¯ã€‚</em></p><p><strong>Route</strong> - An object or Route Element typically with a shape of { path, element } or <Route path element>. The path is a path pattern. When the path pattern matches the current URL, the element will be rendered.<br><em><strong>è·¯ç”±</strong> - ä¸€ä¸ªå¯¹è±¡æˆ–è·¯ç”±å…ƒç´ é€šå¸¸æ˜¯ { path, element } æˆ– <Route path element>ã€‚è·¯å¾„æ˜¯è·¯å¾„æ¨¡å¼ã€‚å½“è·¯å¾„æ¨¡å¼ä¸å½“å‰ URL åŒ¹é…æ—¶ï¼Œå°†ä¼šæ¸²æŸ“è¯¥å…ƒç´ ã€‚</em></p><p><strong>Route Element</strong> - Or <Route>. This elementâ€™s props are read to create a route by <Routes>, but otherwise does nothing.<br><em><strong>è·¯ç”±å…ƒç´ </strong> - æˆ– <Route>ã€‚è¿™ä¸ªå…ƒç´ çš„ props è¢«è¯»å–æ¥åˆ›å»ºä¸€ä¸ªè·¯ç”±ï¼Œä½†æ˜¯ä¸åšä»»ä½•äº‹æƒ…ã€‚</em></p><p><strong>Nested Routes</strong> - Because routes can have children and each route defines a portion of the URL through segments, a single URL can match multiple routes in a nested â€œbranchâ€ of the tree. This enables automatic layout nesting through outlet, relative links, and more.<br><em><strong>åµŒå¥—è·¯ç”±</strong> - å› ä¸ºè·¯ç”±å¯ä»¥æœ‰å­è·¯ç”±ï¼Œæ¯ä¸ªè·¯ç”±éƒ½å®šä¹‰ä¸€éƒ¨åˆ† URL çš„è·¯å¾„æ®µï¼Œä¸€ä¸ª URL å¯ä»¥åŒ¹é…å¤šä¸ªè·¯ç”±åœ¨æ ‘çš„åµŒå¥— â€œåˆ†æ”¯â€ ä¸­ã€‚è¿™ä½¿å¾—é€šè¿‡ outletã€ç›¸å¯¹é“¾æ¥å’Œæ›´å¤šçš„åŠŸèƒ½æ¥å®ç°å¸ƒå±€åµŒå¥—ã€‚</em></p><p><strong>Relative links</strong> - Links that donâ€™t start with &#x2F; will inherit the closest route in which they are rendered. This makes it easy to link to deeper URLs without having to know and build up the entire path.<br><em><strong>ç›¸å¯¹é“¾æ¥</strong> - ä¸ä»¥ &#x2F; å¼€å¤´çš„é“¾æ¥ä¼šç»§æ‰¿æœ€è¿‘æ¸²æŸ“çš„è·¯ç”±ã€‚è¿™ä½¿å¾—å®ƒå¾ˆå®¹æ˜“é“¾æ¥åˆ°æ›´æ·±çš„ URLï¼Œè€Œä¸éœ€è¦çŸ¥é“å’Œå»ºç«‹æ•´ä¸ªè·¯å¾„ã€‚</em></p><p><strong>Match</strong> - An object that holds information when a route matches the URL, like the url params and pathname that matched.<br><em><strong>åŒ¹é…</strong> - å½“è·¯ç”±åŒ¹é… URL æ—¶ï¼ŒåŒ¹é…ä¿¡æ¯ä¼šä¿å­˜åœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œä¾‹å¦‚åŒ¹é…çš„ URL å‚æ•°å’Œè·¯å¾„åã€‚</em></p><p><strong>Matches</strong> - An array of routes (or branch of the route config) that matches the current location. This structure enables nested routes.<br><em><strong>åŒ¹é…</strong> - å½“å‰ä½ç½®åŒ¹é…çš„è·¯ç”±ï¼ˆæˆ–è·¯ç”±é…ç½®çš„åˆ†æ”¯ï¼‰çš„æ•°ç»„ã€‚è¿™ä¸ªç»“æ„å¯ä»¥åµŒå¥—è·¯ç”±ã€‚</em></p><p><strong>Parent Route</strong> - A route with child routes.<br><em><strong>çˆ¶è·¯ç”±</strong> - æœ‰å­è·¯ç”±çš„è·¯ç”±ã€‚</em></p><p><strong>Outlet</strong> - A component that renders the next match in a set of matches.<strong>å•¥ç©æ„ï¼Ÿ</strong><br><em><strong>å‡ºå£</strong> - ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒæ¸²æŸ“ä¸€ç»„åŒ¹é…ä¸­çš„ä¸‹ä¸€ä¸ªåŒ¹é…ã€‚</em></p><p><strong>Index Route</strong> - A child route with no path that renders in the parentâ€™s outlet at the parentâ€™s URL.<br><em><strong>é¦–é¡µè·¯ç”±</strong> - ä¸€ä¸ªå­è·¯ç”±ï¼Œæ²¡æœ‰è·¯å¾„ï¼Œå®ƒæ¸²æŸ“åœ¨çˆ¶è·¯ç”±çš„å‡ºå£ï¼Œåœ¨çˆ¶è·¯ç”±çš„ URL ä¸­ã€‚</em></p><p><strong>Layout Route</strong> - A parent route without a path, used exclusively for grouping child routes inside a specific layout.<br><em><strong>å¸ƒå±€è·¯ç”±</strong> - ä¸€ä¸ªæ²¡æœ‰è·¯å¾„çš„çˆ¶è·¯ç”±ï¼Œç”¨äºå°†å­è·¯ç”±åˆ†ç»„åœ¨ç‰¹å®šå¸ƒå±€ä¸­ã€‚</em></p><h2 id="History-and-Locations"><a href="#History-and-Locations" class="headerlink" title="History and Locations"></a>History and Locations</h2><p>Before React Router can do anything, it has to be able to subscribe to changes in the browser history stack.<br><em>åœ¨ React Router å¯ä»¥åšä»»ä½•äº‹æƒ…ä¹‹å‰ï¼Œå®ƒéœ€è¦èƒ½å¤Ÿè®¢é˜…æµè§ˆå™¨å†å²å †æ ˆçš„å˜åŒ–ã€‚</em></p><p>Browsers maintain their own history stack as the user navigates around. Thatâ€™s how the back and forward buttons can work. In a traditional website (HTML documents without JavaScript) the browser will make requests to the server every time the user clicks a link, submits a form, or clicks the back and forward buttons.<br><em>åœ¨ä¸€ä¸ªçº¯ç²¹çš„ç½‘ç«™ï¼ˆæ²¡æœ‰ JavaScript çš„ HTML æ–‡æ¡£ï¼‰ä¸­ï¼Œæµè§ˆå™¨ä¼šæ¯æ¬¡ç‚¹å‡»é“¾æ¥ã€æäº¤è¡¨å•æˆ–ç‚¹å‡»åé€€å’Œå‰è¿›æŒ‰é’®æ—¶ï¼Œéƒ½ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</em></p><p>For example, consider the user:<br><em>ä¾‹å¦‚ï¼Œè€ƒè™‘ç”¨æˆ·ï¼š</em></p><ol><li>clicks a link to &#x2F;dashboard</li><li>clicks a link to &#x2F;accounts</li><li>clicks a link to &#x2F;customers&#x2F;123</li><li>clicks the back button</li><li>clicks a link to &#x2F;dashboard</li></ol><p>The history stack will change as follows where bold entries denote the current URL:<br><em>å¦‚ä¸‹çš„åœ°æ–¹å†å²å †æ ˆå°†æ”¹å˜ï¼ŒåŠ ç²—çš„æ¡ç›®è¡¨ç¤ºå½“å‰ URLï¼š</em></p><ol><li><strong>&#x2F;dashboard</strong></li><li>&#x2F;dashboard, <strong>&#x2F;accounts</strong></li><li>&#x2F;dashboard, &#x2F;accounts**, &#x2F;customers&#x2F;123**</li><li>&#x2F;dashboard, <strong>&#x2F;accounts</strong>, &#x2F;customers&#x2F;123</li><li>&#x2F;dashboard, &#x2F;accounts, <strong>&#x2F;dashboard</strong></li></ol><h3 id="History-Object"><a href="#History-Object" class="headerlink" title="History Object"></a>History Object</h3><p>With client side routing, developers are able to manipulate the browser history stack programmatically. For example, we can write some code like this to change the URL without the browsers default behavior of making a request to the server:<br><em>ä½¿ç”¨å®¢æˆ·ç«¯è·¯ç”±ï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼æ”¹å˜æµè§ˆå™¨å†å²å †æ ˆï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼Œæ”¹å˜ URLï¼Œè€Œä¸ä¼šæ‰§è¡Œæµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œå³å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;a  href&#x3D;&quot;&#x2F;contact&quot;  onClick&#x3D;&#123;(event) &#x3D;&gt; &#123;    &#x2F;&#x2F; stop the browser from changing the URL and requesting the new document    &#x2F;&#x2F; é˜»æ­¢æµè§ˆå™¨æ”¹å˜ URL å¹¶è¯·æ±‚æ–°æ–‡æ¡£    event.preventDefault();    &#x2F;&#x2F; push an entry into the browser history stack and change the URL    &#x2F;&#x2F; å°†ä¸€ä¸ªæ¡ç›®æ¨å…¥æµè§ˆå™¨å†å²å †æ ˆå¹¶æ”¹å˜ URL    window.history.pushState(&#123;&#125;, undefined, &quot;&#x2F;contact&quot;);  &#125;&#125;&#x2F;&gt;</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>For illustration only, donâ€™t use window.history.pushState directly in React Router<br><em>ä»…ä¾›å‚è€ƒï¼Œä¸è¦ä½¿ç”¨ window.history.pushState ç›´æ¥åœ¨ React Router ä¸­ä½¿ç”¨</em></p></div><p>This code changes the URL but doesnâ€™t do anything for the UI. We would need to write some more code that changed some state somewhere to get the UI to change to the contact page. The trouble is, the browser doesnâ€™t give us a way to â€œlisten to the URLâ€ and subscribe to changes like this.<br><em>è¿™æ®µä»£ç æ”¹å˜ URL ä½†ä¸ä¼šå¯¹ UI æœ‰ä»»ä½•å½±å“ã€‚æˆ‘ä»¬éœ€è¦å†™ä¸€äº›ä»£ç ï¼Œæ”¹å˜æŸäº›çŠ¶æ€ï¼Œä½¿ UI å˜ä¸ºè”ç³»é¡µé¢ã€‚é—®é¢˜æ˜¯ï¼Œæµè§ˆå™¨æ²¡æœ‰æä¾›è¿™æ ·çš„æ–¹å¼ï¼Œâ€œç›‘å¬ URLâ€ï¼Œè®¢é˜…å˜åŒ–ã€‚</em></p><p>Well, thatâ€™s not totally true. We can listen for changes to the URL via pop events:<br><em>è¿™ä¸æ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›‘å¬ URL å˜åŒ–çš„äº‹ä»¶ï¼Œé€šè¿‡å¼¹å‡ºäº‹ä»¶ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">window.addEventListener(&quot;popstate&quot;, () &#x3D;&gt; &#123;  &#x2F;&#x2F; URL changed!&#125;);</code></pre><p>But that only fires when the user clicks the back or forward buttons. There is no event for when the programmer called window.history.pushState or window.history.replaceState.<br><em>ä½†æ˜¯ï¼Œåªæœ‰å½“ç”¨æˆ·ç‚¹å‡»åé€€æˆ–å‰è¿›æŒ‰é’®æ—¶ï¼Œæ‰ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚æ²¡æœ‰è°ƒç”¨ window.history.pushState æˆ– window.history.replaceState çš„äº‹ä»¶ã€‚</em><br>Thatâ€™s where a React Router specific history object comes into play. It provides a way to â€œlisten for URLâ€ changes whether the history action is push, pop, or replace.<br><em>è¿™é‡Œæ˜¯ React Router ç‰¹å®šçš„å†å²å¯¹è±¡çš„äº‹ä»¶ã€‚å®ƒæä¾›ä¸€ç§æ–¹å¼ï¼Œâ€œç›‘å¬ URLâ€å˜åŒ–ï¼Œæ— è®ºå†å²æ“ä½œæ˜¯ pushã€pop æˆ– replaceã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let history &#x3D; createBrowserHistory();history.listen((&#123; location, action &#125;) &#x3D;&gt; &#123;  &#x2F;&#x2F; this is called whenever new locations come in  &#x2F;&#x2F; the action is POP, PUSH, or REPLACE&#125;);</code></pre><p>Apps donâ€™t need to set up their own history objectsâ€“thatâ€™s job of <Router>. It sets up one of these objects, subscribe to changes in the history stack, and finally updates its state when the URL changes. This causes the app to re-render and the correct UI to display. The only thing it needs to put on state is a location, everything else works from that single object.<br><em>åº”ç”¨ä¸éœ€è¦è®¾ç½®è‡ªå·±çš„å†å²å¯¹è±¡ï¼Œè¿™æ˜¯ <code>&lt;Router&gt;</code> çš„å·¥ä½œã€‚å®ƒè®¾ç½®ä¸€ä¸ªè¿™æ ·çš„å¯¹è±¡ï¼Œè®¢é˜…å†å²å †æ ˆçš„å˜åŒ–ï¼Œå¹¶ä¸”æœ€ç»ˆæ›´æ–°å®ƒçš„çŠ¶æ€ï¼Œå½“ URL å˜åŒ–æ—¶ã€‚è¿™ä¼šå¯¼è‡´åº”ç”¨é‡æ–°æ¸²æŸ“å¹¶æ˜¾ç¤ºæ­£ç¡®çš„ UIã€‚å®ƒåªéœ€è¦æŠŠçŠ¶æ€æ”¾åœ¨çŠ¶æ€ä¸­ï¼Œå…¶ä»–éƒ½å¯ä»¥ä»è¿™ä¸ªå•ä¸€å¯¹è±¡ä¸­è·å–ã€‚</em></p><h3 id="Locations"><a href="#Locations" class="headerlink" title="Locations"></a>Locations</h3><p>The browser has a location object on window.location. It tells you information about the URL but also has some methods to change it:<br><em>æµè§ˆå™¨æœ‰ä¸€ä¸ª location å¯¹è±¡åœ¨ window.location ä¸Šã€‚å®ƒå‘Šè¯‰ä½ å…³äº URL çš„ä¿¡æ¯ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥æ”¹å˜å®ƒï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">window.location.pathname; &#x2F;&#x2F; &#x2F;getting-started&#x2F;concepts&#x2F;window.location.hash; &#x2F;&#x2F; #locationwindow.location.reload(); &#x2F;&#x2F; force a refresh w&#x2F; the server&#x2F;&#x2F; and a lot more</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>For illustration. You donâ€™t typically work with window.location in a React Router app<br><em>åœ¨ React Router åº”ç”¨ä¸­é€šå¸¸ä¸ä½¿ç”¨ window.location</em></p></div><p>Instead of using window.location, React Router has the concept of a location thatâ€™s patterned after window.location but is much simpler. It looks like this:<br><em>è€Œä¸æ˜¯ä½¿ç”¨ window.locationï¼ŒReact Router æœ‰ä¸€ä¸ªåƒ window.location ä¸€æ ·çš„<code>location</code>ï¼Œä½†æ›´ç®€å•ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</em></p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;pathname&quot;: &quot;&#x2F;bbq&#x2F;pig-pickins&quot;,  &quot;search&quot;: &quot;?campaign&#x3D;instagram&quot;,  &quot;hash&quot;: &quot;#menu&quot;,  &quot;state&quot;: null,  &quot;key&quot;: &quot;aefz24ie&quot;&#125;</code></pre><p>The first three: { pathname, search, hash } are exactly like window.location. If you just add up the three youâ€™ll get the URL the user sees in the browser:<br><em>å‰ä¸‰ä¸ªï¼š{ pathname, search, hash } ç›¸å½“äº window.locationã€‚å¦‚æœæŠŠä¸‰ä¸ªåŠ èµ·æ¥å°±ç­‰äºç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„ URLï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">location.pathname + location.search + location.hash;&#x2F;&#x2F; &#x2F;bbq&#x2F;pig-pickins?campaign&#x3D;instagram#menu</code></pre><p>The last two, { state, key }, are React Router specific.<br><em>æœ€åä¸¤ä¸ªï¼Œ{ state, key }ï¼Œæ˜¯ React Router ç‰¹å®šçš„ã€‚</em></p><p><strong>Location Pathname</strong></p><p>This is the part of URL after the origin, so for <a href="https://example.com/teams/hotspurs">https://example.com/teams/hotspurs</a> the pathname is &#x2F;teams&#x2F;hotspurs. This is the only part of the location that routes match against.<br><em>è¿™æ˜¯ URL çš„éƒ¨åˆ†ï¼Œåœ¨ origin ä¹‹åï¼Œæ‰€ä»¥ <a href="https://example.com/teams/hotspurs">https://example.com/teams/hotspurs</a> çš„ pathname æ˜¯ &#x2F;teams&#x2F;hotspursã€‚è¿™æ˜¯ location çš„å”¯ä¸€éƒ¨åˆ†ï¼Œå®ƒåŒ¹é…è·¯ç”±ã€‚</em></p><p><strong>Location Search</strong></p><p>People use a lot of different terms for this part of the URL:<br><em>äººä»¬ä½¿ç”¨å¾ˆå¤šä¸åŒçš„è¯æ¥è¡¨è¾¾è¿™éƒ¨åˆ† URLï¼š</em></p><ul><li>location search</li><li>search params</li><li>URL search params</li><li>query string</li></ul><p>In React Router we call it the â€œlocation searchâ€. However, location search is a serialized version of URLSearchParams. So sometimes we might call it â€œURL search paramsâ€ as well.<br><em>åœ¨ React Router ä¸­æˆ‘ä»¬ç§°å®ƒä¸º â€œlocation searchâ€ã€‚ä½†æ˜¯ï¼Œlocation search æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„ URLSearchParams çš„ç‰ˆæœ¬ã€‚æ‰€ä»¥æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½ç§°å®ƒ â€œURL search paramsâ€ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; given a location like this:let location &#x3D; &#123;  pathname: &quot;&#x2F;bbq&#x2F;pig-pickins&quot;,  search: &quot;?campaign&#x3D;instagram&amp;popular&#x3D;true&quot;,  hash: &quot;&quot;,  state: null,  key: &quot;aefz24ie&quot;,&#125;;&#x2F;&#x2F; we can turn the location.search into URLSearchParams&#x2F;&#x2F; æˆ‘ä»¬å¯ä»¥æŠŠ location.search è½¬æ¢æˆ URLSearchParamslet params &#x3D; new URLSearchParams(location.search);params.get(&quot;campaign&quot;); &#x2F;&#x2F; &quot;instagram&quot;params.get(&quot;popular&quot;); &#x2F;&#x2F; &quot;true&quot;params.toString(); &#x2F;&#x2F; &quot;campaign&#x3D;instagram&amp;popular&#x3D;true&quot;,</code></pre><p>When being precise, refer to the serialized string version as â€œsearchâ€ and the parsed version as â€œsearch paramsâ€, but itâ€™s common to use the terms interchangeably when precision isnâ€™t important.<br><em>å½“ç²¾ç¡®æ—¶ï¼Œå‚è€ƒåºåˆ—åŒ–çš„å­—ç¬¦ä¸²ç‰ˆæœ¬ä¸º â€œsearchâ€ï¼Œè§£æç‰ˆæœ¬ä¸º â€œsearch paramsâ€ï¼Œä½†æ˜¯é€šå¸¸ä½¿ç”¨æ—¶å¯ä»¥ä½¿ç”¨äº¤æ¢çš„è¯æ¥è¡¨è¾¾ã€‚</em></p><p><strong>Location Hash</strong></p><p>Hashes in URLs indicate a scroll position on the current page. Before the window.history.pushState API was introduced, web developers did client side routing exclusively with the hash portion of the URL, it was the only part we could manipulate without making a new request to the server. However, today we can use it for its designed purpose.<br><em>URL ä¸­çš„ hash å¯ä»¥è¡¨ç¤ºå½“å‰é¡µé¢çš„æ»šåŠ¨ä½ç½®ã€‚åœ¨ window.history.pushState API å°šæœªå¼•å…¥å‰ï¼Œweb å¼€å‘è€…åªèƒ½åœ¨ URL ä¸­çš„ hash éƒ¨åˆ†è¿›è¡Œå®¢æˆ·ç«¯è·¯ç”±ï¼Œå®ƒæ˜¯æˆ‘ä»¬åªèƒ½åœ¨ä¸éœ€è¦è¯·æ±‚æœåŠ¡å™¨çš„æƒ…å†µä¸‹æ“ä½œå®ƒã€‚ä½†æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å®ç°å®ƒçš„æä¾›çš„åŠŸèƒ½ã€‚</em></p><p><strong>Location State</strong></p><p>You may have wondered why the window.history.pushState() API is called â€œpush stateâ€. State? Arenâ€™t we just changing the URL? Shouldnâ€™t it be history.push? Well, we werenâ€™t in the room when the API was designed, so weâ€™re not sure why â€œstateâ€ was the focus, but it is a cool feature of browsers nonetheless.<br><em>ä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆ window.history.pushState() API è¢«ç§°ä¸º â€œpush stateâ€ã€‚çŠ¶æ€ï¼Ÿæˆ‘ä»¬ä¸æ˜¯æ”¹å˜ URL å—ï¼Ÿåº”è¯¥ä¸æ˜¯ history.pushï¼Ÿæˆ‘ä»¬ä¸æ˜¯åœ¨æˆ¿é—´é‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“ä¸ºä»€ä¹ˆ â€œstateâ€ æ˜¯ç„¦ç‚¹ï¼Œä½†æ˜¯å®ƒæ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªé…·åŠŸèƒ½ã€‚</em><br>Browsers let us persist information about a transition by passing a value to pushState. When the user clicks back, the value on history.state changes to whatever was â€œpushedâ€ before.<br><em>æµè§ˆå™¨è®©æˆ‘ä»¬ä¿æŒä¸€ä¸ªè¿‡æ¸¡çš„ä¿¡æ¯ï¼Œé€šè¿‡ä¼ é€’ä¸€ä¸ªå€¼æ¥ pushStateã€‚å½“ç”¨æˆ·ç‚¹å‡»åï¼Œhistory.state å°†å˜æˆä»€ä¹ˆæ—¶å€™ â€œpushedâ€ã€‚</em></p><pre class="line-numbers language-javaScript" data-language="javaScript"><code class="language-javaScript">window.history.pushState(&quot;look ma!&quot;, undefined, &quot;&#x2F;contact&quot;);window.history.state; &#x2F;&#x2F; &quot;look ma!&quot;&#x2F;&#x2F; user clicks backwindow.history.state; &#x2F;&#x2F; undefined&#x2F;&#x2F; user clicks forwardwindow.history.state; &#x2F;&#x2F; &quot;look ma!&quot;</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>For illustration. You donâ€™t read history.state directly in React Router apps<br><em>ä¸ºäº†æ¼”ç¤ºã€‚ä½ ä¸è¦ç›´æ¥è¯»å– history.state åœ¨ React Router åº”ç”¨ä¸­ã€‚</em></p></div><p>React Router takes advantage of this browser feature, abstracts it a bit, and surfaces the values on the location instead of history.<br><em>React Router åˆ©ç”¨è¿™ä¸ªæµè§ˆå™¨åŠŸèƒ½ï¼ŒæŠ½è±¡å®ƒç‚¹ï¼Œè€Œä¸æ˜¯æŠŠå€¼æ”¾åœ¨ history ä¸Šã€‚</em></p><p>You can think about location.state just like location.hash or location.search except instead of putting the values in the URL itâ€™s hiddenâ€“like a super secret piece of the URL only the programmer knows about.<br><em>ä½ å¯ä»¥æƒ³è±¡ location.state åƒ location.hash æˆ– location.searchï¼Œåªä¸è¿‡å®ƒæ”¾åœ¨ URL ä¸­æ˜¯éšè—çš„â€“åªæœ‰ç¨‹åºå‘˜çŸ¥é“çš„ç§˜å¯†ã€‚</em></p><p>A couple of great use-cases for location state are:<br><em>ä¸€äº›å¥½çš„ä½¿ç”¨åœºæ™¯æ˜¯ location stateï¼š</em></p><p>Telling the next page where the user came from and branching the UI. The most popular implementation here is showing a record in a modal if the user clicked on an item in a grid view, but if they show up to the URL directly, show the record in its own layout (pinterest, old instagram).<br><em>å¦‚æœç”¨æˆ·ç‚¹å‡»ä¸€ä¸ª item åœ¨ grid è§†å›¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ modal ä¸­æ˜¾ç¤ºè®°å½•ï¼Œä½†å¦‚æœç”¨æˆ·ç›´æ¥è®¿é—® URLï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨å®ƒçš„è‡ªå·±çš„å¸ƒå±€ä¸­æ˜¾ç¤ºè®°å½•ï¼ˆpinterestï¼Œæ—§ instagramï¼‰ã€‚</em></p><p>Sending a partial record from a list to the next screen so it can render the partial data immediately and then fetching the rest of the data afterward.<br><em>ä»åˆ—è¡¨å‘é€ä¸€ä¸ªéƒ¨åˆ†è®°å½•åˆ°ä¸‹ä¸€ä¸ªå±å¹•ï¼Œä»¥ä¾¿å®ƒå¯ä»¥ç«‹å³æ¸²æŸ“éƒ¨åˆ†æ•°æ®ï¼Œç„¶åå†æ¬¡è·å–å…¶ä½™çš„æ•°æ®ã€‚</em></p><p>You set location state in two ways: on <Link> or navigate:<br><em>ä½ å¯ä»¥åœ¨ <Link> æˆ– navigate ä¸­è®¾ç½® location stateï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Link to&#x3D;&quot;&#x2F;pins&#x2F;123&quot; state&#x3D;&#123;&#123; fromDashboard: true &#125;&#125; &#x2F;&gt;;let navigate &#x3D; useNavigate();navigate(&quot;&#x2F;users&#x2F;123&quot;, &#123; state: partialUser &#125;);</code></pre><p>And on the next page you can access it with useLocation:<br><em>åœ¨ä¸‹ä¸€ä¸ªé¡µé¢ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ useLocation æ¥è®¿é—®å®ƒï¼š</em></p><pre class="line-numbers language-javaScript" data-language="javaScript"><code class="language-javaScript">let location &#x3D; useLocation();location.state;</code></pre><p>Location state values will get serialized, so something like new Date() will be turned into a string.<br><em>Location state å€¼å°†ä¼šè¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥ something like new Date() å°†ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</em></p><p><strong>Location Key</strong></p><p>Each location gets a unique key. This is useful for advanced cases like location-based scroll management, client side data caching, and more. Because each new location gets a unique key, you can build abstractions that store information in a plain object, new Map(), or even locationStorage.<br><em>æ¯ä¸ª location å¯ä»¥è·å¾—ä¸€ä¸ªå”¯ä¸€çš„ keyã€‚è¿™æ˜¯ä¸€ä¸ªé«˜çº§çš„æƒ…å†µï¼Œæ¯”å¦‚ location-based scroll managementï¼Œå®¢æˆ·ç«¯æ•°æ®ç¼“å­˜ï¼Œä»¥åŠæ›´å¤šã€‚å› ä¸ºæ¯ä¸ªæ–°çš„ location å¯ä»¥è·å¾—ä¸€ä¸ªå”¯ä¸€çš„ keyï¼Œæ‰€ä»¥ä½ å¯ä»¥æŠŠä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œnew Map()ï¼Œæˆ–è€… locationStorageã€‚</em></p><p>For example, a very basic client side data cache could store values by location key (and the fetch URL) and skip fetching the data when the user clicks back into it:<br><em>ä¾‹å¦‚ï¼Œä¸€ä¸ªéå¸¸åŸºç¡€çš„å®¢æˆ·ç«¯æ•°æ®ç¼“å­˜å¯ä»¥é€šè¿‡ location keyï¼ˆå’Œ fetch URLï¼‰æ¥å­˜å‚¨å€¼ï¼Œå¹¶ä¸”å½“ç”¨æˆ·ç‚¹å‡»å›åˆ°å®ƒæ—¶è·³è¿‡ fetch æ•°æ®ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let cache &#x3D; new Map();function useFakeFetch(URL) &#123;  let location &#x3D; useLocation();  let cacheKey &#x3D; location.key + URL;  let cached &#x3D; cache.get(cacheKey);  let [data, setData] &#x3D; useState(() &#x3D;&gt; &#123;    &#x2F;&#x2F; initialize from the cache    return cached || null;  &#125;);  let [state, setState] &#x3D; useState(() &#x3D;&gt; &#123;    &#x2F;&#x2F; avoid the fetch if cached    return cached ? &quot;done&quot; : &quot;loading&quot;;  &#125;);  useEffect(() &#x3D;&gt; &#123;    if (state &#x3D;&#x3D;&#x3D; &quot;loading&quot;) &#123;      let controller &#x3D; new AbortController();      fetch(URL, &#123; signal: controller.signal &#125;)        .then((res) &#x3D;&gt; res.json())        .then((data) &#x3D;&gt; &#123;          if (controller.signal.aborted) return;          &#x2F;&#x2F; set the cache          cache.set(cacheKey, data);          setData(data);        &#125;);      return () &#x3D;&gt; controller.abort();    &#125;  &#125;, [state, cacheKey]);  useEffect(() &#x3D;&gt; &#123;    setState(&quot;loading&quot;);  &#125;, [URL]);  return data;&#125;</code></pre><h2 id="Matching"><a href="#Matching" class="headerlink" title="Matching"></a>Matching</h2><p>On the initial render, and when the history stack changes, React Router will match the location against your route config to come up with a set of matches to render.<br><em>åœ¨åˆå§‹æ¸²æŸ“å’Œå½“ history stack å˜åŒ–æ—¶ï¼ŒReact Router å°†ä¼šåŒ¹é… location ä¸ä½ çš„è·¯ç”±é…ç½®æ¥å¾—åˆ°ä¸€ç»„åŒ¹é…æ¥æ¸²æŸ“ã€‚</em></p><h3 id="Defining-Routes"><a href="#Defining-Routes" class="headerlink" title="Defining Routes"></a>Defining Routes</h3><p>A route config is a tree of routes that looks something like this:<br><em>ä¸€ä¸ªè·¯ç”±é…ç½®æ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œæ¯”å¦‚è¿™æ ·ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Routes&gt;  &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;App &#x2F;&gt;&#125;&gt;    &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;    &lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;      &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;:teamId&#x2F;edit&quot; element&#x3D;&#123;&lt;EditTeam &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;    &lt;&#x2F;Route&gt;  &lt;&#x2F;Route&gt;  &lt;Route element&#x3D;&#123;&lt;PageLayout &#x2F;&gt;&#125;&gt;    &lt;Route path&#x3D;&quot;&#x2F;privacy&quot; element&#x3D;&#123;&lt;Privacy &#x2F;&gt;&#125; &#x2F;&gt;    &lt;Route path&#x3D;&quot;&#x2F;tos&quot; element&#x3D;&#123;&lt;Tos &#x2F;&gt;&#125; &#x2F;&gt;  &lt;&#x2F;Route&gt;  &lt;Route path&#x3D;&quot;contact-us&quot; element&#x3D;&#123;&lt;Contact &#x2F;&gt;&#125; &#x2F;&gt;&lt;&#x2F;Routes&gt;</code></pre><p>The <code>&lt;Routes&gt;</code> component recurses through its props.children, strips their props, and generates an object like this:<br><em><Routes> ç»„ä»¶é€’å½’éå†å…¶ props.childrenï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªåƒè¿™æ ·çš„å¯¹è±¡ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let routes &#x3D; [  &#123;    element: &lt;App &#x2F;&gt;,    path: &quot;&#x2F;&quot;,    children: [      &#123;        index: true,        element: &lt;Home &#x2F;&gt;,      &#125;,      &#123;        path: &quot;teams&quot;,        element: &lt;Teams &#x2F;&gt;,        children: [          &#123;            index: true,            element: &lt;LeagueStandings &#x2F;&gt;,          &#125;,          &#123;            path: &quot;:teamId&quot;,            element: &lt;Team &#x2F;&gt;,          &#125;,          &#123;            path: &quot;:teamId&#x2F;edit&quot;,            element: &lt;EditTeam &#x2F;&gt;,          &#125;,          &#123;            path: &quot;new&quot;,            element: &lt;NewTeamForm &#x2F;&gt;,          &#125;,        ],      &#125;,    ],  &#125;,  &#123;    element: &lt;PageLayout &#x2F;&gt;,    children: [      &#123;        element: &lt;Privacy &#x2F;&gt;,        path: &quot;&#x2F;privacy&quot;,      &#125;,      &#123;        element: &lt;Tos &#x2F;&gt;,        path: &quot;&#x2F;tos&quot;,      &#125;,    ],  &#125;,  &#123;    element: &lt;Contact &#x2F;&gt;,    path: &quot;&#x2F;contact-us&quot;,  &#125;,];</code></pre><p>In fact, instead of <Routes> you can use the hook useRoutes(routesGoHere) instead. Thatâ€™s all <Routes> is doing.<br><em>åœ¨å®é™…ä¸Šï¼Œ<Routes> çš„ä½œç”¨æ˜¯ï¼ŒæŠŠ routesGoHere ä¼ é€’ç»™ useRoutesã€‚</em></p><p>As you can see, routes can define multiple segments like :teamId&#x2F;edit, or just one like :teamId. All of the segments down a branch of the route config are added together to create a final path pattern for a route.<br><em>ä½ å¯ä»¥çœ‹åˆ°ï¼Œè·¯ç”±å¯ä»¥å®šä¹‰å¤šä¸ªåˆ†æ®µï¼Œæ¯”å¦‚ :teamId&#x2F;editï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ª :teamIdã€‚æ‰€æœ‰ä»è·¯ç”±é…ç½®çš„åˆ†æ”¯ä¸‹é¢çš„åˆ†æ®µéƒ½ä¼šç»„åˆåœ¨ä¸€èµ·ï¼Œæ¥åˆ›å»ºä¸€ä¸ªæœ€ç»ˆçš„è·¯å¾„æ¨¡å¼ã€‚</em></p><h3 id="Match-Params"><a href="#Match-Params" class="headerlink" title="Match Params"></a>Match Params</h3><p>Note the :teamId segments. This is what we call a dynamic segment of the path pattern, meaning it doesnâ€™t match the URL statically (the actual characters) but it matches it dynamically. Any value can fill in for :teamId. Both &#x2F;teams&#x2F;123 or &#x2F;teams&#x2F;cupcakes will match. We call the parsed values URL params. So in this case our teamId param would be â€œ123â€ or â€œcupcakesâ€. Weâ€™ll see how to use them in your app in the Rendering section.<br><em>æ³¨æ„ï¼Œè¿™é‡Œæœ‰ :teamId åˆ†æ®µã€‚è¿™æ˜¯ä¸€ä¸ªåŠ¨æ€åˆ†æ®µï¼Œæ„å‘³ç€å®ƒä¸æ˜¯é™æ€çš„ï¼Œè€Œæ˜¯åŠ¨æ€çš„ã€‚ä»»ä½•å€¼éƒ½å¯ä»¥å¡«å…… :teamIdã€‚&#x2F;teams&#x2F;123 æˆ– &#x2F;teams&#x2F;cupcakes å‡å¯åŒ¹é…ã€‚æˆ‘ä»¬ç§°è¿™äº›è§£æåçš„å€¼ä¸º URL å‚æ•°ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ teamId å‚æ•°å°†æ˜¯ â€œ123â€ æˆ– â€œcupcakesâ€ã€‚æˆ‘ä»¬ä¼šåœ¨æ¸²æŸ“éƒ¨åˆ†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚</em></p><h3 id="Ranking-Routes"><a href="#Ranking-Routes" class="headerlink" title="Ranking Routes"></a>Ranking Routes</h3><p>If we add up all the segments of all the branches of our route config, we end up with the following path patterns that our app responds to:<br><em>å¦‚æœæˆ‘ä»¬æŠŠæ‰€æœ‰è·¯ç”±é…ç½®çš„åˆ†æ”¯çš„æ‰€æœ‰åˆ†æ®µç›¸åŠ ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°ä»¥ä¸‹è·¯å¾„æ¨¡å¼ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¼šå“åº”ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[  &quot;&#x2F;&quot;,  &quot;&#x2F;teams&quot;,  &quot;&#x2F;teams&#x2F;:teamId&quot;,  &quot;&#x2F;teams&#x2F;:teamId&#x2F;edit&quot;,  &quot;&#x2F;teams&#x2F;new&quot;,  &quot;&#x2F;privacy&quot;,  &quot;&#x2F;tos&quot;,  &quot;&#x2F;contact-us&quot;,];</code></pre><p>Now this is where things get really interesting. Consider the URL &#x2F;teams&#x2F;new. Which pattern in that list matches the URL?<br><em>è€ƒè™‘ä¸€ä¸‹è¿™ä¸ª URL &#x2F;teams&#x2F;newï¼Œå®ƒåœ¨é‚£ä¸ªåˆ—è¡¨ä¸­åŒ¹é…å“ªä¸ªæ¨¡å¼ï¼Ÿ</em><br>Thatâ€™s right, two of them!<br><em>å¯¹çš„ï¼Œä¸¤ä¸ªï¼</em></p><pre class="line-numbers language-none"><code class="language-none">&#x2F;teams&#x2F;new&#x2F;teams&#x2F;:teamId</code></pre><p>React Router has to make a decision here, there can be only one. Many routers, both client side and server side, will simply process the patterns in the order in which they were defined. First to match wins. In this case we would match &#x2F; and render the <Home/> component. Definitely not what we wanted. These kinds of routers require us to order our routes perfectly to get the expected result. This is how React Router has worked up until v6, but now itâ€™s much smarter.<br><em>React Router åœ¨è¿™é‡Œéœ€è¦åšä¸€ä¸ªå†³å®šï¼Œåªæœ‰ä¸€ä¸ªè·¯ç”±å™¨ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½ä¼šç®€å•åœ°å¤„ç†æ¨¡å¼ã€‚ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä¼˜å…ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåŒ¹é… &#x2F; å¹¶å‘ˆç° <Home/> ç»„ä»¶ã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è¿™ç§ç±»å‹çš„è·¯ç”±å™¨éœ€è¦æˆ‘ä»¬æŒ‰ç…§å®šä¹‰çš„é¡ºåºæ¥æ’åˆ—è·¯ç”±ï¼Œä»¥ä¾¿å¾—åˆ°é¢„æœŸçš„ç»“æœã€‚è¿™æ˜¯ React Router çš„ v6 å‰çš„å·¥ä½œï¼Œç°åœ¨å®ƒæ›´åŠ æ™ºèƒ½ã€‚</em></p><p>Looking at those patterns, you intuitively know that we want &#x2F;teams&#x2F;new to match the URL &#x2F;teams&#x2F;new. Itâ€™s a perfect match! React Router also knows that. When matching, it will rank your routes according the number of segments, static segments, dynamic segments, star patterns, etc. and pick the most specific match. Youâ€™ll never have to think about ordering your routes.<br><em>çœ‹è¿™äº›æ¨¡å¼ï¼Œä½ æ„Ÿè§‰åˆ°æˆ‘ä»¬æƒ³è¦ &#x2F;teams&#x2F;new åŒ¹é… URL &#x2F;teams&#x2F;newã€‚è¿™æ˜¯ä¸€ä¸ªå®Œç¾çš„åŒ¹é…ï¼React Router ä¹ŸçŸ¥é“ã€‚å½“åŒ¹é…æ—¶ï¼Œå®ƒä¼šæŒ‰ç…§åˆ†æ®µæ•°ï¼Œé™æ€åˆ†æ®µï¼ŒåŠ¨æ€åˆ†æ®µï¼Œæ˜Ÿå·æ¨¡å¼ï¼Œç­‰ç­‰æ¥æ’åˆ—è·¯ç”±ï¼Œå¹¶é€‰æ‹©æœ€æœ‰ç”¨çš„åŒ¹é…ã€‚ä½ æ°¸è¿œä¸ä¼šå¿…é¡»æƒ³è±¡è·¯ç”±çš„é¡ºåºã€‚</em></p><h3 id="Pathless-Routes"><a href="#Pathless-Routes" class="headerlink" title="Pathless Routes"></a>Pathless Routes</h3><p>You may have noticed the weird routes from earlier:<br><em>ä½ å¯èƒ½æ³¨æ„åˆ°ä»¥å‰çš„å¥‡æ€ªè·¯ç”±ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;&lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;&lt;Route element&#x3D;&#123;&lt;PageLayout &#x2F;&gt;&#125; &#x2F;&gt;</code></pre><p>They donâ€™t even have a path, how can they be a route? This is where the word â€œrouteâ€ in React Router is used pretty loosely. <code>&lt;Home/&gt;</code> and <code>&lt;LeagueStandings/&gt;</code> are <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#index-route" target="_blank" >index routes</a> and <code>&lt;PageLayout/&gt;</code> is a <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#layout-route" target="_blank" >layout route</a>. Weâ€™ll discuss how they work in the Rendering section. Neither really has much to do with matching.<br><em>å®ƒä»¬ä¹Ÿæ²¡æœ‰è·¯å¾„ï¼Œæ€ä¹ˆå¯èƒ½æ˜¯è·¯ç”±ï¼Ÿè¿™æ˜¯ React Router ä¸­çš„â€œè·¯ç”±â€è¯çš„ä½¿ç”¨å¾ˆæ¨¡ç³Šã€‚<Home/> å’Œ <LeagueStandings/> æ˜¯ç´¢å¼•è·¯ç”±ï¼Œ<PageLayout/> æ˜¯å¸ƒå±€è·¯ç”±ã€‚æˆ‘ä»¬ä¼šåœ¨æ¸²æŸ“éƒ¨åˆ†è®¨è®ºå¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚<Home/> å’Œ <LeagueStandings/> ä¸æ˜¯çœŸæ­£çš„è·¯ç”±ï¼Œ<PageLayout/> æ˜¯çœŸæ­£çš„è·¯ç”±ã€‚</em></p><h3 id="Route-Matches"><a href="#Route-Matches" class="headerlink" title="Route Matches"></a>Route Matches</h3><p>When a route matches the URL, itâ€™s represented by a <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#match" target="_blank" >match</a> object. A match for <code>&lt;Route path=&quot;:teamId&quot; element=&#123;&lt;Team/&gt;&#125;/&gt;</code> would look something like this:</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123;  pathname: &quot;&#x2F;teams&#x2F;firebirds&quot;,  params: &#123;    teamId: &quot;firebirds&quot;  &#125;,  route: &#123;    element: &lt;Team &#x2F;&gt;,    path: &quot;:teamId&quot;  &#125;&#125;</code></pre><p>pathname holds the portion of the URL that matched this route (in our case itâ€™s all of it). params holds the parsed values from any dynamic segments that matched. Note that the paramâ€™s object keys map directly to the name of the segment: :teamId becomes params.teamId.<br><em>match.pathname å­˜æ”¾åŒ¹é…åˆ°çš„ URL çš„éƒ¨åˆ†ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­å®ƒæ˜¯å…¨éƒ¨ï¼‰ã€‚params å­˜æ”¾ä»ä»»ä½•åŠ¨æ€åˆ†æ®µåŒ¹é…çš„è§£æå€¼ã€‚æ³¨æ„ï¼Œå‚æ•°çš„å¯¹è±¡é”®æ˜ å°„åˆ°åŠ¨æ€åˆ†æ®µçš„åç§°ï¼š:teamId å˜æˆ params.teamIdã€‚</em><br>Because our routes are a tree, a single URL can match an entire branch of the tree. Consider the URL &#x2F;teams&#x2F;firebirds, it would be the following route branch:<br><em>å› ä¸ºæˆ‘ä»¬çš„è·¯ç”±æ˜¯ä¸€æ£µæ ‘ï¼Œä¸€ä¸ª URL å¯ä»¥åŒ¹é…æ•´ä¸ªæ ‘çš„ä¸€ä¸ªåˆ†æ”¯ã€‚è€ƒè™‘ URL &#x2F;teams&#x2F;firebirdsï¼Œå®ƒå°†æ˜¯ä»¥ä¸‹è·¯ç”±åˆ†æ”¯ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Routes&gt;  &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;App &#x2F;&gt;&#125;&gt;    &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt; &#x2F;&#x2F; +    &lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;      &#123;&quot; &quot;&#125;      &#x2F;&#x2F;+      &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt; &#x2F;&#x2F;+      &lt;Route path&#x3D;&quot;:teamId&#x2F;edit&quot; element&#x3D;&#123;&lt;EditTeam &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;    &lt;&#x2F;Route&gt;  &lt;&#x2F;Route&gt;  &lt;Route element&#x3D;&#123;&lt;PageLayout &#x2F;&gt;&#125;&gt;    &lt;Route path&#x3D;&quot;&#x2F;privacy&quot; element&#x3D;&#123;&lt;Privacy &#x2F;&gt;&#125; &#x2F;&gt;    &lt;Route path&#x3D;&quot;&#x2F;tos&quot; element&#x3D;&#123;&lt;Tos &#x2F;&gt;&#125; &#x2F;&gt;  &lt;&#x2F;Route&gt;  &lt;Route path&#x3D;&quot;contact-us&quot; element&#x3D;&#123;&lt;Contact &#x2F;&gt;&#125; &#x2F;&gt;&lt;&#x2F;Routes&gt;</code></pre><p>React Router will create an array of matches from these routes and the url so it can render a nested UI that matches the route nesting.<br><em>React Router å°†ä»è¿™äº›è·¯ç”±åˆ›å»ºä¸€ä¸ªåŒ¹é…æ•°ç»„ï¼Œå¹¶å°† url ä¼ é€’ç»™å®ƒï¼Œä»¥ä¾¿å®ƒå¯ä»¥æ¸²æŸ“ä¸€ä¸ªåµŒå¥—çš„ UIï¼ŒåŒ¹é…è·¯ç”±åµŒå¥—ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[  &#123;    pathname: &quot;&#x2F;&quot;,    params: null,    route: &#123;      element: &lt;App &#x2F;&gt;,      path: &quot;&#x2F;&quot;,    &#125;,  &#125;,  &#123;    pathname: &quot;&#x2F;teams&quot;,    params: null,    route: &#123;      element: &lt;Teams &#x2F;&gt;,      path: &quot;teams&quot;,    &#125;,  &#125;,  &#123;    pathname: &quot;&#x2F;teams&#x2F;firebirds&quot;,    params: &#123;      teamId: &quot;firebirds&quot;,    &#125;,    route: &#123;      element: &lt;Team &#x2F;&gt;,      path: &quot;:teamId&quot;,    &#125;,  &#125;,];</code></pre><h2 id="Rendering"><a href="#Rendering" class="headerlink" title="Rendering"></a>Rendering</h2><p>The final concept is rendering. Consider that the entry to your app looks like this:<br><em>æœ€åä¸€ä¸ªæ¦‚å¿µæ˜¯æ¸²æŸ“ã€‚è€ƒè™‘ä½ çš„åº”ç”¨ç¨‹åºçš„å…¥å£å¦‚ä¸‹ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const root &#x3D; ReactDOM.createRoot(document.getElementById(&quot;root&quot;));root.render(  &lt;BrowserRouter&gt;    &lt;Routes&gt;      &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;App &#x2F;&gt;&#125;&gt;        &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;        &lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;          &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;          &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;          &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;        &lt;&#x2F;Route&gt;      &lt;&#x2F;Route&gt;      &lt;Route element&#x3D;&#123;&lt;PageLayout &#x2F;&gt;&#125;&gt;        &lt;Route path&#x3D;&quot;&#x2F;privacy&quot; element&#x3D;&#123;&lt;Privacy &#x2F;&gt;&#125; &#x2F;&gt;        &lt;Route path&#x3D;&quot;&#x2F;tos&quot; element&#x3D;&#123;&lt;Tos &#x2F;&gt;&#125; &#x2F;&gt;      &lt;&#x2F;Route&gt;      &lt;Route path&#x3D;&quot;contact-us&quot; element&#x3D;&#123;&lt;Contact &#x2F;&gt;&#125; &#x2F;&gt;    &lt;&#x2F;Routes&gt;  &lt;&#x2F;BrowserRouter&gt;);</code></pre><p>Letâ€™s use the &#x2F;teams&#x2F;firebirds URL as an example again. <Routes> will match the location to your route config, get a set of matches, and then render a React element tree like this:<br><em>ä½¿ç”¨ <code>/teams/firebirds</code> URL ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œ<code>&lt;Routes&gt;</code> å°†åŒ¹é…ä½ç½®åˆ°ä½ çš„è·¯ç”±é…ç½®ï¼Œè·å–ä¸€ç»„åŒ¹é…ï¼Œç„¶åæ¸²æŸ“ä¸€ä¸ª React å…ƒç´ æ ‘ï¼Œå¦‚ä¸‹ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;App&gt;  &lt;Teams&gt;    &lt;Team &#x2F;&gt;  &lt;&#x2F;Teams&gt;&lt;&#x2F;App&gt;</code></pre><p>Each match rendered inside the parent routeâ€™s element is a really powerful abstraction. Most websites and apps share this characteristic: boxes inside of boxes inside of boxes, each with a navigation section that changes a child section of the page.<br><em>æ¯ä¸ªåŒ¹é…åœ¨çˆ¶è·¯ç”±çš„å…ƒç´ ä¸­éƒ½æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æŠ½è±¡ã€‚å¤§å¤šæ•°ç½‘ç«™å’Œåº”ç”¨ç¨‹åºéƒ½å…±äº«è¿™ç§ç‰¹æ€§ï¼šç›’å­é‡Œé¢ç›’å­é‡Œé¢ç›’å­ï¼Œæ¯ä¸ªç›’å­éƒ½æœ‰ä¸€ä¸ªå¯¼èˆªåŒºåŸŸï¼Œå®ƒæ”¹å˜é¡µé¢çš„å­åŒºåŸŸã€‚</em></p><h3 id="Outlets"><a href="#Outlets" class="headerlink" title="Outlets"></a>Outlets</h3><p>This nested element tree wonâ€™t happen automatically. <Routes> will render the first matchâ€™s element for you (In our case thatâ€™s <App/>). The next matchâ€™s element is <Teams>. In order to render that, App needs to render an outlet.<br><em>è¿™ä¸ªåµŒå¥—å…ƒç´ æ ‘ä¸ä¼šè‡ªåŠ¨å‘ç”Ÿã€‚<code>&lt;Routes&gt;</code> å°†ä¼šæ¸²æŸ“ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ <code>&lt;App/&gt;</code>ï¼‰ã€‚ä¸‹ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ æ˜¯ <code>&lt;Teams&gt;</code>ã€‚ä¸ºäº†æ¸²æŸ“è¿™ä¸ªï¼ŒApp éœ€è¦æ¸²æŸ“ä¸€ä¸ªå‡ºå£ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function App() &#123;  return (    &lt;div&gt;      &lt;GlobalNav &#x2F;&gt;      &lt;Outlet &#x2F;&gt;      &lt;GlobalFooter &#x2F;&gt;    &lt;&#x2F;div&gt;  );&#125;</code></pre><p>The Outlet component will always render the next match. That means <Teams> also needs an outlet to render <Team/>.<br><em>Outlet å…ƒç´ å°†å§‹ç»ˆæ¸²æŸ“ä¸‹ä¸€ä¸ªåŒ¹é…ã€‚è¿™æ„å‘³ç€ <code>&lt;Teams&gt;</code> éœ€è¦ä¸€ä¸ªå‡ºå£æ¥æ¸²æŸ“ <code>&lt;Team/&gt;</code>ã€‚</em><br>If the URL were &#x2F;contact-us, the element tree would change to:<br><em>å¦‚æœ URL æ˜¯ <code>/contact-us</code>ï¼Œå…ƒç´ æ ‘ä¼šå˜æˆï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;App&gt;  &lt;Teams&gt;    &lt;EditTeam &#x2F;&gt;  &lt;&#x2F;Teams&gt;&lt;&#x2F;App&gt;</code></pre><p>The outlet swaps out the child for the new child that matches, but the parent layout persists. Itâ€™s subtle but very effective at cleaning up your components.<br><em>å‡ºå£å°†äº¤æ¢å­ç»„ä»¶ï¼Œä½†çˆ¶å¸ƒå±€ä»ç„¶å­˜åœ¨ã€‚å®ƒå¾ˆå·§å¦™ï¼Œä½†ååˆ†æœ‰æ•ˆåœ°æ¸…ç†ä½ çš„ç»„ä»¶ã€‚</em></p><h3 id="Index-Routes"><a href="#Index-Routes" class="headerlink" title="Index Routes"></a>Index Routes</h3><p>Remember the <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#route-config" target="_blank" >route config</a> for &#x2F;teams:</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;  &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;  &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;  &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;&lt;&#x2F;Route&gt;</code></pre><p>If the URL were <code>/teams/firebirds</code>, the element tree would be:<br><em>å¦‚æœ URL æ˜¯ <code>/teams/firebirds</code>ï¼Œå…ƒç´ æ ‘ä¼šæ˜¯ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;App&gt;  &lt;Teams&gt;    &lt;Team &#x2F;&gt;  &lt;&#x2F;Teams&gt;&lt;&#x2F;App&gt;</code></pre><p>But if the URL were <code>/teams</code>, the element tree would be:<br><em>å¦‚æœ URL æ˜¯ <code>/teams</code>ï¼Œå…ƒç´ æ ‘ä¼šæ˜¯ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;App&gt;  &lt;Teams&gt;    &lt;LeagueStandings &#x2F;&gt;  &lt;&#x2F;Teams&gt;&lt;&#x2F;App&gt;</code></pre><p>League standings? How the heck did <code>&lt;Route index element=&#123;&lt;LeagueStandings&gt;&#125;/&gt;</code> pop in there? It doesnâ€™t even have a path! The reason is that itâ€™s an index route. Index routes render in their parent routeâ€™s outlet at the parent routeâ€™s path.<br><em>æ’åï¼Ÿ ä¸ºä»€ä¹ˆ <code>&lt;Route index element=&#123;&lt;LeagueStandings&gt;&#125;/&gt;</code> ä¸èƒ½å‡ºç°åœ¨å®ƒçš„çˆ¶è·¯ç”±çš„å‡ºå£ï¼Ÿ å®ƒä¸æ˜¯ä¸€ä¸ªè·¯å¾„ï¼ åŸå› æ˜¯å®ƒæ˜¯ä¸€ä¸ªç´¢å¼•è·¯ç”±ã€‚ ç´¢å¼•è·¯ç”±æ¸²æŸ“åœ¨å®ƒçš„çˆ¶è·¯ç”±çš„å‡ºå£ï¼Œåœ¨çˆ¶è·¯ç”±çš„è·¯å¾„ã€‚</em><br>Think of it this way, if youâ€™re not at one of the child routesâ€™ paths, the <Outlet> will render nothing in the UI:<br><em>å¦‚æœä½ ä¸åœ¨å­è·¯ç”±çš„è·¯å¾„ä¸Šï¼Œ<code>&lt;Outlet&gt;</code> å°†ä¸ä¼šæ¸²æŸ“ä»»ä½• UIï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;App&gt;  &lt;Teams &#x2F;&gt;&lt;&#x2F;App&gt;</code></pre><p>If all the teams are in a list on the left then an empty outlet means youâ€™ve got a blank page on the right! Your UI needs something to fill the space: index routes to the rescue.<br><em>å¦‚æœæ‰€æœ‰æˆå‘˜éƒ½åœ¨å·¦è¾¹çš„åˆ—è¡¨ä¸­ï¼Œç©ºçš„å‡ºå£æ„å‘³ç€ä½ æœ‰ä¸€ä¸ªç©ºç™½é¡µåœ¨å³è¾¹ï¼ ä½ çš„ UI éœ€è¦ä¸€äº›ä¸œè¥¿æ¥å¡«å……ç©ºç™½ï¼šç´¢å¼•è·¯ç”±ã€‚</em><br>Another way to think of an index route is that itâ€™s the default child route when the parent matches but none of its children do.<br><em>å¦ä¸€ç§æ€è€ƒç´¢å¼•è·¯ç”±æ˜¯ï¼Œå®ƒæ˜¯çˆ¶è·¯ç”±åŒ¹é…ï¼Œä½†æ²¡æœ‰ä»»ä½•å­è·¯ç”±çš„é»˜è®¤å­è·¯ç”±ã€‚</em><br>Depending on the user interface, you might not need an index route, but if there is any sort of persistent navigation in the parent route youâ€™ll most likely want index route to fill the space when the user hasnâ€™t clicked one of the items yet.<br><em>æ ¹æ®ç”¨æˆ·ç•Œé¢ï¼Œä½ å¯èƒ½ä¸éœ€è¦ç´¢å¼•è·¯ç”±ï¼Œä½†å¦‚æœçˆ¶è·¯ç”±æœ‰æŒä¹…çš„å¯¼èˆªï¼Œä½ å°†æœ€æœ‰å¯èƒ½éœ€è¦ç´¢å¼•è·¯ç”±æ¥å¡«å……ç©ºç™½ï¼Œå½“ç”¨æˆ·è¿˜æ²¡æœ‰ç‚¹å‡»ä¸€ä¸ªé¡¹ç›®ã€‚</em></p><h3 id="Layout-Routes"><a href="#Layout-Routes" class="headerlink" title="Layout Routes"></a>Layout Routes</h3><p>Hereâ€™s a part of our route config we havenâ€™t matched yet: <code>/privacy</code>. Letâ€™s look at the route config again, highlighting the matched routes:<br><em>è¿™é‡Œæ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰åŒ¹é…çš„è·¯ç”±é…ç½®çš„ä¸€éƒ¨åˆ†ï¼š<code>/privacy</code>ã€‚æˆ‘ä»¬å†çœ‹ä¸€ä¸‹è·¯ç”±é…ç½®ï¼Œé«˜äº®åŒ¹é…çš„è·¯ç”±ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Routes&gt;  &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;App &#x2F;&gt;&#125;&gt;    &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;    &lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;      &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;:teamId&#x2F;edit&quot; element&#x3D;&#123;&lt;EditTeam &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;    &lt;&#x2F;Route&gt;  &lt;&#x2F;Route&gt;  &lt;Route element&#x3D;&#123;&lt;PageLayout &#x2F;&gt;&#125;&gt;    &lt;Route path&#x3D;&quot;&#x2F;privacy&quot; element&#x3D;&#123;&lt;Privacy &#x2F;&gt;&#125; &#x2F;&gt;    &lt;Route path&#x3D;&quot;&#x2F;tos&quot; element&#x3D;&#123;&lt;Tos &#x2F;&gt;&#125; &#x2F;&gt;  &lt;&#x2F;Route&gt;  &lt;Route path&#x3D;&quot;contact-us&quot; element&#x3D;&#123;&lt;Contact &#x2F;&gt;&#125; &#x2F;&gt;&lt;&#x2F;Routes&gt;</code></pre><p>And the resulting element tree rendered will be:<br><em>æ ¹æ®ç»“æœï¼Œæ¸²æŸ“å‡ºæ¥çš„å…ƒç´ æ ‘ä¼šæ˜¯ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;App&gt;  &lt;PageLayout&gt;    &lt;Privacy &#x2F;&gt;  &lt;&#x2F;PageLayout&gt;&lt;&#x2F;App&gt;</code></pre><p>The <code>PageLayout</code> route is admittedly weird. We call it a <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#layout-route" target="_blank" >layout route</a> because it doesnâ€™t participate in the matching at all (though its children do). It only exists to make wrapping multiple child routes in the same layout simpler. If we didnâ€™t allow this then youâ€™d have to handle layouts in two different ways: sometimes your routes do it for you, sometimes you do it manually with lots of layout component repetition throughout your app:<br><em>è¿™ä¸ª<code>PageLayout</code>è·¯ç”±æ˜¯ä¸å‹å¥½çš„ã€‚ æˆ‘ä»¬è°ƒç”¨å®ƒæ˜¯ä¸€ä¸ª <a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#layout-route" target="_blank" >layout route</a>ï¼Œå› ä¸ºå®ƒä¸å‚ä¸åŒ¹é…ï¼ˆä½†å®ƒçš„å­è·¯ç”±å´æ˜¯ï¼‰ã€‚ å®ƒåªæ˜¯ä¸ºäº†è®©åŒ…è£¹å¤šä¸ªå­è·¯ç”±åœ¨ä¸€ä¸ªå¸ƒå±€ä¸Šæ›´åŠ ç®€å•ã€‚ å¦‚æœæˆ‘ä»¬ä¸å…è®¸è¿™æ ·åšï¼Œé‚£ä¹ˆä½ å°±éœ€è¦åœ¨ä½ çš„åº”ç”¨ä¸­æ‰‹åŠ¨å¤„ç†å¸ƒå±€ï¼Œæœ‰æ—¶å€™ä½ çš„è·¯ç”±ä¼šè‡ªåŠ¨åšè¿™ä»¶äº‹ï¼Œæœ‰æ—¶å€™ä½ éœ€è¦æ‰‹åŠ¨å¤„ç†å¸ƒå±€ï¼Œé€šè¿‡é‡å¤å¸ƒå±€ç»„ä»¶æ¥å®ç°ï¼š</em></p><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>You can do it like this, but we recommend using a layout route<br><em>ä½ å¯ä»¥è¿™æ ·åšï¼Œä½†æˆ‘ä»¬å»ºè®®ä½¿ç”¨ä¸€ä¸ªå¸ƒå±€è·¯ç”±</em></p></div><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Routes&gt;  &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;App &#x2F;&gt;&#125;&gt;    &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;    &lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;      &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;:teamId&#x2F;edit&quot; element&#x3D;&#123;&lt;EditTeam &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;      &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;    &lt;&#x2F;Route&gt;  &lt;&#x2F;Route&gt;  &lt;Route    path&#x3D;&quot;&#x2F;privacy&quot;    element&#x3D;&#123;      &lt;PageLayout&gt;        &lt;Privacy &#x2F;&gt;      &lt;&#x2F;PageLayout&gt;    &#125;  &#x2F;&gt;  &lt;Route    path&#x3D;&quot;&#x2F;tos&quot;    element&#x3D;&#123;      &lt;PageLayout&gt;        &lt;Tos &#x2F;&gt;      &lt;&#x2F;PageLayout&gt;    &#125;  &#x2F;&gt;  &lt;Route path&#x3D;&quot;contact-us&quot; element&#x3D;&#123;&lt;Contact &#x2F;&gt;&#125; &#x2F;&gt;&lt;&#x2F;Routes&gt;</code></pre><p>So, yeah, the semantics of a layout â€œrouteâ€ is a bit silly since it has nothing to do with the URL matching, but itâ€™s just too convenient to disallow.<br><em>å› æ­¤ï¼Œå˜¿ï¼Œå¸ƒå±€â€œè·¯ç”±â€çš„è¯­ä¹‰æ˜¯ä¸€ç‚¹ç‚¹è›‹ç–¼ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä»€ä¹ˆå…³ç³»åˆ° URL åŒ¹é…ï¼Œä½†å®ƒæ˜¯å¤ªæ–¹ä¾¿äº†ã€‚</em></p><h2 id="Navigating"><a href="#Navigating" class="headerlink" title="Navigating"></a>Navigating</h2><p>When the URL changes we call that a â€œnavigationâ€. There are two ways to navigate in React Router:<br><em>åœ¨ URL å˜åŒ–æ—¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•â€œnavigationâ€ï¼šæœ‰ä¸¤ç§æ–¹å¼ï¼š</em></p><ul><li><code>&lt;Link&gt;</code></li><li><code>navigate</code></li></ul><h3 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h3><p>This is the primary means of navigation. Rendering a <Link> allows the user to change the URL when they click it. React Router will prevent the browserâ€™s default behavior and tell the history to push a new entry into the history stack. The location changes and the new matches will render.<br><em>è¿™æ˜¯ä¸»è¦çš„å¯¼èˆªæ–¹å¼ï¼Œæ¸²æŸ“ä¸€ä¸ª<Link>å…è®¸ç”¨æˆ·ç‚¹å‡»å®ƒæ—¶å˜æ›´ URLã€‚ React Router å°†é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œå¹¶å‘Šè¯‰å†å²è®°å½•æ¨å…¥ä¸€ä¸ªæ–°æ¡ç›®åˆ°å†å²å †æ ˆä¸­ã€‚ åœ°ç‚¹å˜åŒ–äº†ï¼Œæ–°åŒ¹é…çš„å…ƒç´ ä¼šæ¸²æŸ“ã€‚</em></p><p>However, links are accessible in that they:<br><em>ä½†æ˜¯ï¼Œé“¾æ¥æ˜¯å¯è®¿é—®çš„ï¼Œå®ƒï¼š</em></p><p>Still render a <code>&lt;a href&gt;</code> so all default accessibility concerns are met (like keyboard, focusability, SEO, etc.)<br><em>ä»ç„¶æ¸²æŸ“ä¸€ä¸ª<a href>ï¼Œè¿™æ ·æ‰€æœ‰é»˜è®¤çš„è®¿é—®æ€§é—®é¢˜éƒ½ä¼šè¢«æ»¡è¶³ï¼ˆå¦‚é”®ç›˜ï¼Œå¯èšç„¦æ€§ï¼ŒSEO ç­‰ç­‰ï¼‰</em></p><p>Donâ€™t prevent the browserâ€™s default behavior if itâ€™s a right click or command&#x2F;control click to â€œopen in new tabâ€<br><em>å¦‚æœæ˜¯å³é”®ç‚¹å‡»æˆ–å‘½ä»¤&#x2F;æ§åˆ¶ç‚¹å‡»â€œåœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€â€ï¼Œé‚£ä¹ˆä¸è¦é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸º</em></p><p><a href="https://reactrouter.com/docs/en/v6/getting-started/concepts#nested-routes" target="_blank" >Nested routes</a> arenâ€™t just about rendering layouts; they also enable â€œrelative linksâ€. Consider our teams route from before:<br><em>åµŒå¥—è·¯ç”±ä¸ä»…ä»…æ˜¯æ¸²æŸ“å¸ƒå±€ï¼Œå®ƒä¹Ÿå¯ä»¥å¯ç”¨â€œç›¸å¯¹é“¾æ¥â€ã€‚ è€ƒè™‘æˆ‘ä»¬çš„ teams è·¯ç”±ä»å‰é¢ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;  &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;&lt;&#x2F;Route&gt;</code></pre><p>The <Teams> component can render links like:<br><em><Teams>ç»„ä»¶å¯ä»¥æ¸²æŸ“é“¾æ¥ï¼Œå¦‚ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;Link to&#x3D;&quot;psg&quot; &#x2F;&gt;&lt;Link to&#x3D;&quot;new&quot; &#x2F;&gt;</code></pre><p>The full path it links to will be <code>/teams/psg</code> and <code>/teams/new</code>. They inherit the route within which they are rendered. This makes it so your route components donâ€™t have to really know anything about the rest of the routes in the app. A very large amount of links just go one more segment deeper. You can rearrange your whole route config and these links will likely still work just fine. This is very valuable when building out a site in the beginning and the designs and layouts are shifting around.<br><em>å®ƒä»¬é“¾æ¥åˆ°çš„å®Œæ•´è·¯å¾„æ˜¯ <code>/teams/psg</code> å’Œ <code>/teams/new</code>ã€‚ å®ƒä»¬ç»§æ‰¿æ¸²æŸ“æ—¶çš„è·¯ç”±ã€‚ è¿™ä½¿å¾—ä½ çš„è·¯ç”±ç»„ä»¶ä¸éœ€è¦çœŸçš„çŸ¥é“åº”ç”¨ä¸­çš„å…¶ä»–è·¯ç”±ã€‚ ä¸€å¤§å †é“¾æ¥åªéœ€è¦ä¸€ä¸ªæ›´æ·±ä¸€å±‚ã€‚ ä½ å¯ä»¥é‡æ–°æ’åˆ—ä½ çš„æ•´ä¸ªè·¯ç”±é…ç½®ï¼Œè¿™äº›é“¾æ¥å¯èƒ½ä»ç„¶èƒ½å·¥ä½œã€‚ è¿™åœ¨å¼€å§‹å»ºç«™æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºè®¾è®¡å’Œå¸ƒå±€ä¼šç§»åŠ¨ã€‚</em></p><h3 id="Navigate-Function"><a href="#Navigate-Function" class="headerlink" title="Navigate Function"></a>Navigate Function</h3><p>This function is returned from the useNavigate hook and allows you, the programmer, to change the URL whenever you want. You could do it on a timeout:<br><em>è¿™ä¸ªå‡½æ•°æ˜¯ç”± useNavigate é’©å­è¿”å›çš„ï¼Œå…è®¸ä½ ï¼Œç¨‹åºå‘˜ï¼Œåœ¨ä½ æƒ³è¦çš„æ—¶å€™æ”¹å˜ URLã€‚ ä½ å¯ä»¥åšä¸€ä¸ªå»¶è¿Ÿï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let navigate &#x3D; useNavigate();useEffect(() &#x3D;&gt; &#123;  setTimeout(() &#x3D;&gt; &#123;    navigate(&quot;&#x2F;logout&quot;);  &#125;, 30000);&#125;, []);</code></pre><p>Or after a form is submitted:<br><em>æˆ–è€…ï¼Œåœ¨è¡¨å•æäº¤åï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;form onSubmit&#x3D;&#123;event &#x3D;&gt; &#123;  event.preventDefault();  let data &#x3D; new FormData(event.target)  let urlEncoded &#x3D; new URLSearchParams(data)  navigate(&quot;&#x2F;create&quot;, &#123; state: urlEncoded &#125;)&#125;&#125;&gt;</code></pre><p>Like <code>Link</code>, <code>navigate</code> works with nested â€œtoâ€ values as well.<br><em>åƒ Link ä¸€æ ·ï¼Œnavigate ä¹Ÿå¯ä»¥ç”¨åµŒå¥—çš„â€œtoâ€å€¼ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">navigate(&quot;psg&quot;);</code></pre><p>You should have a good reason to use navigate instead of <Link>. This makes us very sad:<br><em>ä½ åº”è¯¥æœ‰ä¸€ä¸ªå¥½çš„ç†ç”±ä½¿ç”¨ navigate è€Œä¸æ˜¯ <Link>ã€‚ è¿™ä½¿æˆ‘ä»¬å¾ˆä¼¤å¿ƒï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;li onClick&#x3D;&#123;() &#x3D;&gt; navigate(&quot;&#x2F;somewhere&quot;)&#125; &#x2F;&gt;</code></pre><p>Aside from links and forms, very few interactions should change the URL because it introduces complexity around accessibility and user expectations.<br><em>é™¤äº†é“¾æ¥å’Œè¡¨å•ä¹‹å¤–ï¼Œå¾ˆå°‘åº”è¯¥æ”¹å˜ URLï¼Œå› ä¸ºå®ƒä¼šå¼•å…¥ä¸€äº›å…³äºè®¿é—®æ€§å’Œç”¨æˆ·æœŸæœ›çš„å¤æ‚æ€§ã€‚</em></p><h3 id="Data-Access"><a href="#Data-Access" class="headerlink" title="Data Access"></a>Data Access</h3><p>Finally, an application is going to want to ask React Router for a few pieces of information in order to build out the full UI. For this, React Router has a pile of hooks<br><em>æœ€åï¼Œåº”ç”¨ç¨‹åºéœ€è¦è¦æ±‚ React è·¯ç”±æ¥è·å–ä¸€äº›ä¿¡æ¯ï¼Œä»¥ä¾¿å»ºç«‹å®Œæ•´çš„ UIã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let location &#x3D; useLocation();let urlParams &#x3D; useParams();let [urlSearchParams] &#x3D; useSearchParams();</code></pre><h2 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h2><p>Letâ€™s put it all together from the top!<br><em>ä»é¡¶éƒ¨ä¸€èµ·æ¥çœ‹ï¼</em></p><ol><li>You render your app:</li></ol><pre class="line-numbers language-js" data-language="js"><code class="language-js">const root &#x3D; ReactDOM.createRoot(document.getElementById(&quot;root&quot;));root.render(  &lt;BrowserRouter&gt;    &lt;Routes&gt;      &lt;Route path&#x3D;&quot;&#x2F;&quot; element&#x3D;&#123;&lt;App &#x2F;&gt;&#125;&gt;        &lt;Route index element&#x3D;&#123;&lt;Home &#x2F;&gt;&#125; &#x2F;&gt;        &lt;Route path&#x3D;&quot;teams&quot; element&#x3D;&#123;&lt;Teams &#x2F;&gt;&#125;&gt;          &lt;Route path&#x3D;&quot;:teamId&quot; element&#x3D;&#123;&lt;Team &#x2F;&gt;&#125; &#x2F;&gt;          &lt;Route path&#x3D;&quot;new&quot; element&#x3D;&#123;&lt;NewTeamForm &#x2F;&gt;&#125; &#x2F;&gt;          &lt;Route index element&#x3D;&#123;&lt;LeagueStandings &#x2F;&gt;&#125; &#x2F;&gt;        &lt;&#x2F;Route&gt;      &lt;&#x2F;Route&gt;      &lt;Route element&#x3D;&#123;&lt;PageLayout &#x2F;&gt;&#125;&gt;        &lt;Route path&#x3D;&quot;&#x2F;privacy&quot; element&#x3D;&#123;&lt;Privacy &#x2F;&gt;&#125; &#x2F;&gt;        &lt;Route path&#x3D;&quot;&#x2F;tos&quot; element&#x3D;&#123;&lt;Tos &#x2F;&gt;&#125; &#x2F;&gt;      &lt;&#x2F;Route&gt;      &lt;Route path&#x3D;&quot;contact-us&quot; element&#x3D;&#123;&lt;Contact &#x2F;&gt;&#125; &#x2F;&gt;    &lt;&#x2F;Routes&gt;  &lt;&#x2F;BrowserRouter&gt;);</code></pre><p><code>&lt;BrowserRouter&gt;</code> creates a history, puts the initial location in to state, and subscribes to the URL.<br><em><code>&lt;BrowserRouter&gt;</code> åˆ›å»ºä¸€ä¸ªå†å²ï¼Œå°†åˆå§‹ä½ç½®æ”¾å…¥çŠ¶æ€ï¼Œå¹¶è®¢é˜… URLã€‚</em></p><p><code>&lt;Routes&gt;</code> recurses its child routes to build a route config, matches those routes against the location, creates some route matches, and renders the first matchâ€™s route element.<br><em><code>&lt;Routes&gt;</code> é€’å½’å­è·¯ç”±æ¥å»ºç«‹è·¯ç”±é…ç½®ï¼ŒåŒ¹é…è¿™äº›è·¯ç”±ä¸ä½ç½®ï¼Œåˆ›å»ºä¸€äº›è·¯ç”±åŒ¹é…ï¼Œå¹¶å‘ˆç°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è·¯ç”±å…ƒç´ ã€‚</em></p><p>You render an <Outlet/> in each parent route.<br><em>ä½ åœ¨æ¯ä¸ªçˆ¶è·¯ç”±ä¸­æ¸²æŸ“ä¸€ä¸ª <code>&lt;Outlet/&gt;</code>ã€‚</em></p><p>The <code>outlets</code> render the next match in the route matches.<br><em>è·¯ç”±åŒ¹é…ä¸­çš„ä¸‹ä¸€ä¸ªåŒ¹é…æ¸²æŸ“ã€‚</em></p><p>The user clicks a link<br><em>ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥</em></p><p>The link calls navigate()<br><em>é“¾æ¥è°ƒç”¨ navigate()</em></p><p>The history changes the URL and notifies <code>&lt;BrowserRouter&gt;</code>.<br><em>å†å²æ”¹å˜ URLï¼Œå¹¶é€šçŸ¥ <code>&lt;BrowserRouter&gt;</code>ã€‚</em></p><p><code>&lt;BrowserRouter&gt;</code> rerenders, start over at (2)!<br><em><BrowserRouter> é‡æ–°æ¸²æŸ“ï¼Œä» (2) å¼€å§‹ï¼</em></p><p>Thatâ€™s it! We hope this guide has helped you gain a deeper understanding of the main concepts in React Router.<br><em>è¿™å°±æ˜¯äº†ï¼æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæŒ‡å—æœ‰èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ React è·¯ç”±çš„ä¸»è¦æ¦‚å¿µã€‚</em></p><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æœ€è¿‘çœ‹åˆ°äº†ï¼Œé¢è¯•é¢˜ react-router åŸç†ï¼ŒæŸ¥äº†ä¸‹ç­”æ¡ˆï¼Œå†…å®¹ä¸æ˜¯å¾ˆå¤š</p><p><a href="https://blog.csdn.net/weixin_39907713/article/details/111237885" target="_blank" >React Router åŸç†</a><br><a href="https://blog.csdn.net/qingfeng2020/article/details/121136648" target="_blank" >æµ…è°ˆå‰ç«¯è·¯ç”±åŸç†ï¼ŒVueRouter åŸç†å’Œ ReactRouter åŸç†</a></p><p><a href="https://blog.csdn.net/Android_boom/article/details/125200222" target="_blank" >React Router æºç è§£æ</a></p><p>ä¹‹å‰æ²¡çœ‹è¿‡å®ç°åŸç†ï¼Œç°åœ¨çœ‹åˆ°ä¹Ÿæ²¡é‚£ä¹ˆéš¾ <code>ä»å°è¢«å“å¤§çš„</code>ï¼Œ å¸¦ç€å¥½å¥‡å¿ƒçœ‹ä¸‹ä»“åº“ä»£ç ï¼š<code>4+1ï¼ˆindex.tsï¼‰ä¸ªæ–‡ä»¶</code>æ²¡çœ‹é”™</p><img src="http://t-blog-images.aijs.top/img/20220621091016.webp" width=300 /><h2 id="index-ts"><a href="#index-ts" class="headerlink" title="index.ts"></a>index.ts</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; æš´éœ²å‡ºçš„apiexport &#123;  MemoryRouter,  Navigate,  NavigationType,  Outlet,  Route,  Router,  Routes,  createPath,  createRoutesFromChildren,  generatePath,  matchPath,  matchRoutes,  parsePath,  renderMatches,  resolvePath,  useHref,  useInRouterContext,  useLocation,  useMatch,  useNavigate,  useNavigationType,  useOutlet,  useOutletContext,  useParams,  useResolvedPath,  useRoutes,&#125;;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F; DANGER! PLEASE READ ME! å±é™©ï¼è¯·è¯»è¿™ä¸ªï¼&#x2F;&#x2F; We provide these exports as an escape hatch in the event that you need any&#x2F;&#x2F; routing data that we don&#39;t provide an explicit API for. With that said, we&#x2F;&#x2F; want to cover your use case if we can, so if you feel the need to use these&#x2F;&#x2F; we want to hear from you. Let us know what you&#39;re building and we&#39;ll do our&#x2F;&#x2F; best to make sure we can support you!&#x2F;&#x2F; æˆ‘ä»¬æä¾›è¿™äº›å¯¼å‡ºä½œä¸ºä¸€ä¸ªé€ƒé€¸å¼•ç”¨ï¼Œä»¥é˜²ä½ éœ€è¦æˆ‘ä»¬æ²¡æœ‰æä¾›æ˜ç¡® API çš„ä»»ä½•è·¯ç”±æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ&#x2F;&#x2F; å¦‚æœä½ éœ€è¦è¿™äº›ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä¸ºä½ æä¾›æ”¯æŒï¼Œæ‰€ä»¥å¦‚æœä½ æœ‰éœ€è¦ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ä½ çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ä¼šå°½å¯èƒ½åœ°ä¸ºä½ æä¾›æ”¯æŒã€‚&#x2F;&#x2F; We consider these exports an implementation detail and do not guarantee&#x2F;&#x2F; against any breaking changes, regardless of the semver release. Use with&#x2F;&#x2F; extreme caution and only if you understand the consequences. Godspeed.&#x2F;&#x2F; æˆ‘ä»¬è€ƒè™‘è¿™äº›å¯¼å‡ºæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œå¹¶ä¸”ä¸ä¿è¯å¯¹ä»»ä½•å˜æ›´ä¸ä¼šæœ‰ä»»ä½•å½±å“ï¼Œæ— è®ºæ˜¯åœ¨ semver ç‰ˆæœ¬å‘å¸ƒå‰æˆ–è€…åã€‚&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</code></pre><h2 id="react-router-dom"><a href="#react-router-dom" class="headerlink" title="react-router-dom"></a>react-router-dom</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¯¹<code>react-router</code>è¿›è¡Œäº†æ‰©å±•ï¼Œ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é¢˜æ±‡æ€»</title>
      <link href="//post/2022-06-16interview.html"/>
      <url>//post/2022-06-16interview.html</url>
      
        <content type="html"><![CDATA[<img src="https://img0.baidu.com/it/u=4204937089,859074527&fm=253&fmt=auto&app=138&f=JPEG?w=255&h=255" /><p><a href="https://www.nowcoder.com/discuss/763567" target="_blank" >å°çº¢ä¹¦å‰ç«¯é¢ç»</a></p><p><a href="https://juejin.cn/post/7013953652578582558?share_token=ad9faad3-d177-4d34-9228-086d1d192112" target="_blank" >å‰ç«¯ä¸¤å¹´ç»éªŒï¼Œå†æ—¶ä¸€ä¸ªæœˆçš„é¢ç»å’Œæ€»ç»“</a></p><p><a href="https://cloud.tencent.com/developer/article/1663670" target="_blank" >ã€é¢è¯•é¢˜ã€‘CSS çŸ¥è¯†ç‚¹æ•´ç†(é™„ç­”æ¡ˆ)</a></p><h2 id="HTTP-ä¸-TCP"><a href="#HTTP-ä¸-TCP" class="headerlink" title="HTTP ä¸ TCP"></a>HTTP ä¸ TCP</h2><p><a href="https://blog.csdn.net/SuNew_bee/article/details/117303320" target="_blank" >HTTP&#x2F;1.1ã€HTTP&#x2F;2ã€HTTP&#x2F;3 å¯¹ HTTP çš„æ”¹è¿›</a></p><p><a href="https://blog.csdn.net/SuNew_bee/article/details/117248731?spm=1001.2014.3001.5502" target="_blank" >TCP ä¸‰æ¬¡æ¡æ‰‹</a></p><p><a href="https://blog.csdn.net/SuNew_bee/article/details/117251247?spm=1001.2014.3001.5502" target="_blank" >TCP å››æ¬¡æŒ¥æ‰‹</a></p><p><a href="https://blog.csdn.net/SuNew_bee/article/details/117257895?spm=1001.2014.3001.5502" target="_blank" >TCP é‡ä¼ æœºåˆ¶</a></p><p><a href="https://blog.csdn.net/SuNew_bee/article/details/117263730?spm=1001.2014.3001.5502" target="_blank" >æµé‡æ§åˆ¶</a></p><p><a href="https://www.likecs.com/show-204397172.html" target="_blank" >HTTP è¯·æ±‚å’Œ TCP é“¾æ¥çš„å¯¹åº”å…³ç³»</a></p><p><a href="https://blog.csdn.net/sinat_41696687/article/details/123458338" target="_blank" >å½»åº•ææ‡‚è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„è”ç³»</a></p><p><a href="https://zhuanlan.zhihu.com/p/420055986" target="_blank" >TLS&#x2F;SSL</a></p><p><a href="https://juejin.cn/post/6871060072936505352" target="_blank" >TLS&#x2F;SSL</a></p><p><a href="https://baijiahao.baidu.com/s?id=1633945802472340217&wfr=spider&for=pc" target="_blank" >CDN</a></p><p><a href="https://www.jianshu.com/p/60cc4ea02971/" target="_blank" >websocket é¢è¯•é¢˜</a></p><p><a href="https://blog.csdn.net/weixin_42674490/article/details/120647995" target="_blank" >websocket ä½¿ç”¨</a></p><p><strong>çŠ¶æ€ç çš„å«ä¹‰</strong></p><p><a href="" target="_blank" >101 SwitchingProtocolsï¼Œè¡¨ç¤ºåˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®</a></p><p><a href="https://www.bbsmax.com/A/gGdX3AWm54/" target="_blank" >204 çŠ¶æ€ç çš„å«ä¹‰</a></p><p><a href="" target="_blank" >206 partial Content, è¿›è¡ŒèŒƒå›´è¯·æ±‚ï¼Œæ‰“å¼€ B ç«™çš„è§†é¢‘å¯ä»¥çœ‹åˆ° 206 è¯·æ±‚</a></p><h2 id="èº«ä»½ä¿¡æ¯"><a href="#èº«ä»½ä¿¡æ¯" class="headerlink" title="èº«ä»½ä¿¡æ¯"></a>èº«ä»½ä¿¡æ¯</h2><!-- <a href="https://zhuanlan.zhihu.com/p/482474619" target="_blank" >JWT å²ä¸Šæœ€å…¨é¢è¯•é¢˜(å¤§å‚å¸¸é—®)</a> --><p><a href="https://www.php.cn/website-design-ask-484695.html" target="_blank" >JWT</a></p><p><a href="https://zhuanlan.zhihu.com/p/66037342" target="_blank" >å•ç«™ç‚¹ç™»å½•</a></p><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><p><a href="https://blog.csdn.net/Dax1_/article/details/123185260" target="_blank" >æ€»ç»“ ES6 ä¸­ Map å’Œ Set çš„ç‰¹ç‚¹ä¸æ¯”è¾ƒ</a></p><p><a href="https://www.itheima.com/news/20201110/183621.html" target="_blank" >ä» async&#x2F;await é¢è¯•é¢˜çœ‹å®è§‚ä»»åŠ¡å’Œå¾®è§‚ä»»åŠ¡</a></p><p><a href="https://www.jianshu.com/p/844e293d90a7" target="_blank" >ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«</a></p><h2 id="js"><a href="#js" class="headerlink" title="js"></a>js</h2><p><a href="https://zhuanlan.zhihu.com/p/142681436?from_voters_page=true" target="_blank" >js å †å’Œæ ˆçš„åŒºåˆ«</a><br><a href="https://segmentfault.com/a/1190000039042550" target="_blank" >ä»€ä¹ˆæ˜¯é—­åŒ…</a><br><a href="https://blog.csdn.net/z591102/article/details/110634593#:~:text=%E6%9C%BA%E7%A7%91%E5%AD%A6%E9%87%8C%EF%BC%8C-,%E5%B0%BE%E8%B0%83%E7%94%A8,-%E6%98%AF%E6%8C%87%E4%B8%80%E4%B8%AA" target="_blank" >tail è°ƒç”¨:å°¾è°ƒç”¨ä¼˜åŒ–ï¼ˆTail Call Optimizationï¼ŒTCOï¼‰</a></p><p><a href="https://segmentfault.com/a/1190000013396601" target="_blank" >Promise å®ç°åŸç†</a><br><a href="" target="_blank" >æ•°æ®åŠ«æŒ â€¦â€¦^_^</a></p><hr /><p><strong>new å’Œ Object.create éƒ½æ˜¯åˆ›é€ ä¸€ä¸ªå¯¹è±¡çš„æ„æ€ï¼ŒäºŒè€…æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿ</strong></p><p><a href="https://www.jianshu.com/p/5f718f4a9441#:~:text=jack%27))-,Object.create(),-Object.create%E6%98%AF" target="_blank" >new &#x2F; Object.create()çš„å®ç°åŸç†</a></p><ul><li>ç”¨ Object.create()æ–¹æ³•åˆ›å»ºæ–°å¯¹è±¡,å¹¶ä½¿ç”¨ç°æœ‰å¯¹è±¡æä¾›æ–°å¯¹è±¡çš„ protoã€‚</li><li>Object.create() æ˜¯ es5 ç»„åˆç»§æ‰¿çš„ es6 api</li><li>Object.create å…‹éš†çš„å¯¹è±¡ä¹Ÿåªèƒ½å®ç°ä¸€çº§å¯¹è±¡çš„æ·±æ‹·è´</li><li><a href="https://blog.csdn.net/qq_48648782/article/details/118498146" target="_blank" >ä½¿ç”¨ï¼šåˆ›å»ºå­å¯¹è±¡ï¼Œè®©å­å¯¹è±¡ç»§æ‰¿çˆ¶å¯¹è±¡çš„åŒæ—¶ï¼Œä¸ºå­å¯¹è±¡æ·»åŠ è‡ªæœ‰å±æ€§</a></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function myNew() &#123;  let obj &#x3D; &#123;&#125;  let func &#x3D; [].shift.call(arguments); &#x2F;&#x2F;å‡ºåˆ—ï¼Œè·å–ç¬¬ä¸€ä¸ªå‚æ•°  obj.__proto__ &#x3D; func.prototype; &#x2F;&#x2F;protoæŒ‡å‘åŸå‹  func.apply(obj, arguments); &#x2F;&#x2F;è®©objæ‰§è¡Œfuncå‡½æ•°  return obj;&#125;function myCreate(obj) &#123;  let F &#x3D; function () &#123;&#125;;  F.prototype &#x3D; obj;  return new F();&#125;</code></pre>  <hr />  <p><strong>å¯¹ç€å›¾çœ‹</strong></p><!-- ![](http://t-blog-images.aijs.top/img/20220617151244.webp) --><img src="http://t-blog-images.aijs.top/img/202207271745383.webp" /><h2 id="æµè§ˆå™¨"><a href="#æµè§ˆå™¨" class="headerlink" title="æµè§ˆå™¨"></a>æµè§ˆå™¨</h2><p><a href="http://t.zoukankan.com/Zzbj-p-13923489.html" target="_blank" > å¼ºç¼“å­˜ã€åå•†ç¼“å­˜å‘ç”Ÿåœ¨ 8 ä¸­çš„å“ªäº›é˜¶æ®µ</a><br><a href="https://mp.weixin.qq.com/s/0w6aWwpR3MAJnmyLwDnAzA" target="_blank" >JavaScript å†…å­˜æ³„æ¼é˜²èŒƒä¹‹é“</a></p><h2 id="html"><a href="#html" class="headerlink" title="html"></a>html</h2><p><a href="https://blog.csdn.net/oscar999/article/details/121044091" target="_blank" >HTML å¦‚ä½•ç¦ç”¨ç¼“å­˜</a></p><p><a href="https://www.jianshu.com/p/50c37351f873" target="_blank" >onloadã€DOMContentLoaded åŒºåˆ«</a></p><h2 id="CSS3"><a href="#CSS3" class="headerlink" title="CSS3"></a>CSS3</h2><p><a href="https://www.jianshu.com/p/274a9b3200b4" target="_blank" >BFC ä¸æ¸…é™¤æµ®åŠ¨</a><br>æ ¹èŠ‚ç‚¹ã€æµ®åŠ¨ã€å®šä½[]ã€display[ç›¸å…³]ã€è¡¨æ ¼ã€ç½‘æ ¼ã€å¤šåˆ—ï¼Œæ€»ä¹‹æ˜¯æŠŠä¸€äº›å­å…ƒç´ åœˆèµ·æ¥å½¢æˆå°é—­çš„ç›’å­ï¼Œè·µè¡Œ BFC çš„åŸåˆ™[ç‹¬ç«‹ã€å¯¹å¤–ä¸å½±å“ï¼ˆä¸é‡å ï¼‰]</p><p><a href="https://blog.csdn.net/NCZB007/article/details/108440570" target="_blank" >.clearfix::after(æ¸…é™¤æµ®åŠ¨)ä¸­å„ä¸ªå±æ€§åŠå€¼è¯¦ç»†è§£è¯´</a></p><p><a href="https://blog.csdn.net/weixin_43613849/article/details/116561796" target="_blank" >css ä¸­å®ç°å•è¡Œå¤šè¡Œæ–‡å­—æˆªæ–­</a><br><a href="https://blog.csdn.net/qq_39221436/article/details/124450355" target="_blank" > css-modules æ¥æ·±å…¥ç†è§£å®ƒçš„åŸç†</a></p><p><a href="https://blog.csdn.net/xun__xing/article/details/108253723" target="_blank" >css module</a></p><p><a href="http://v.aijs.top/post/2022-05-23width0" target="_blank" >flex å¸ƒå±€</a></p><p><a href="https://juejin.cn/post/6844903582370643975" target="_blank" >æ€ä¹ˆç”»ä¸€æ¡ 0.5px çš„è¾¹ï¼ˆæ›´æ–°ï¼‰</a></p><p><a href="http://www.alloyteam.com/2016/05/summary-of-pseudo-classes-and-pseudo-elements/" target="_blank" >æ€»ç»“ä¼ªç±»ä¸ä¼ªå…ƒç´ </a></p><div style="display: flex;flex-direction: row;flex-wrap: wrap">  <img src="http://t-blog-images.aijs.top/img/20220625174736.png" width=400 style="margin-right: 4px; margin-bottom: 4px"/>  <img src="http://t-blog-images.aijs.top/img/20220625174712.png" style="boject-fix: none; height: 200px"/></div><p><code>:first-child</code> <code>:first-of-type</code> <code>:nth-child</code> <code>:nth-of-type</code> åŒºåˆ«</p><ul><li><a href="http://www.alloyteam.com/2016/05/summary-of-pseudo-classes-and-pseudo-elements/#prettyPhoto:~:text=2-,%3Afirst%2Dchild,-%E5%8C%B9%E9%85%8D%E5%85%83%E7%B4%A0%E7%9A%84" target="_blank" >:first-child</a> åŒ¹é…å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚</li><li><a href="http://www.alloyteam.com/2016/05/summary-of-pseudo-classes-and-pseudo-elements/#prettyPhoto:~:text=%7D-,4%20first%2Dof%2Dtype,-%E5%8C%B9%E9%85%8D%E5%B1%9E%E4%BA%8E%E5%85%B6" target="_blank" >:first-of-type</a> åŒ¹é…å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚</li><li><a href="http://www.alloyteam.com/2016/05/summary-of-pseudo-classes-and-pseudo-elements/#prettyPhoto:~:text=%7D-,6%20%3Anth%2Dchild,-%3Anth%2Dchild%20%E6%A0%B9%E6%8D%AE" target="_blank" >:nth-child </a> æ ¹æ®å…ƒç´ çš„ä½ç½®åŒ¹é…ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼Œå®ƒæ¥å—ä¸€ä¸ª an+b å½¢å¼çš„å‚æ•°ï¼Œan+b åŒ¹é…åˆ°çš„å…ƒç´ ç¤ºä¾‹å¦‚ä¸‹ï¼š<br>1n+0ï¼Œæˆ– nï¼ŒåŒ¹é…æ¯ä¸€ä¸ªå­å…ƒç´ ã€‚<br>2n+0ï¼Œæˆ– 2nï¼ŒåŒ¹é…ä½ç½®ä¸º 2ã€4ã€6ã€8â€¦ çš„å­å…ƒç´ ï¼Œè¯¥è¡¨è¾¾å¼ä¸å…³é”®å­— even ç­‰ä»·ã€‚<br>2n+1 åŒ¹é…ä½ç½®ä¸º 1ã€3ã€5ã€7â€¦ çš„å­å…ƒç´ ã€è¯¥è¡¨è¾¾å¼ä¸å…³é”®å­— odd ç­‰ä»·ã€‚<br>3n+4 åŒ¹é…ä½ç½®ä¸º 4ã€7ã€10ã€13â€¦ çš„å­å…ƒç´ ã€‚<br>:nth-of-type</li><li><a href="http://www.alloyteam.com/2016/05/summary-of-pseudo-classes-and-pseudo-elements/#prettyPhoto:~:text=%E5%BC%80%E5%A7%8B%E8%AE%A1%E6%95%B0%E7%9A%84%E3%80%82-,8%20%3Anth%2Dof%2Dtype,-%3Anth%2Dof%2Dtype" target="_blank" >:nth-of-type</a> ä¸ nth-child ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯åªåŒ¹é…ç‰¹å®šç±»å‹çš„å…ƒç´ ã€‚</li></ul><p><a href="https://www.runoob.com/cssref/pr-class-position.html" target="_blank" >position çš„å‡ ä¸ªå±æ€§å’Œå«ä¹‰</a></p><p><a href="" target="_blank" >è¯´ä¸€ä¸‹ç›’æ¨¡å‹&gt;_&lt;</a></p><p><a href="https://www.jianshu.com/p/ce7e4a997a2c" target="_blank" >vertical-align åˆ°åº•æ€ä¹ˆç”¨</a></p><p><a href="https://blog.csdn.net/qq_52340302/article/details/119238781" target="_blank" >å…­ç§å¸¸ç”¨çš„ css ä¸‰æ å¸ƒå±€æ–¹æ³•</a></p><h2 id="å“åº”å¼"><a href="#å“åº”å¼" class="headerlink" title="å“åº”å¼"></a>å“åº”å¼</h2><p><a href="https://juejin.cn/post/6844903814332432397" target="_blank" >å‰ç«¯å“åº”å¼å¸ƒå±€åŸç†ä¸æ–¹æ¡ˆï¼ˆè¯¦ç»†ç‰ˆï¼‰</a></p><p><a href="https://juejin.cn/post/6844903814332432397#:~:text=%E5%AF%B9%E4%BA%8E%E9%9C%80%E8%A6%81%E4%BF%9D%E6%8C%81%E5%AE%BD%E9%AB%98%E6%AF%94%E7%9A%84%E5%9B%BE%EF%BC%8C%E5%BA%94%E8%AF%A5%E7%94%A8padding%2Dtop%E5%AE%9E%E7%8E%B0" target="_blank" >å¯¹äºéœ€è¦ä¿æŒå®½é«˜æ¯”çš„å›¾ï¼Œåº”è¯¥ç”¨ padding-top å®ç°(ä¸€ç§ä¸ºäº†è§£å†³ï¼Œå›¾ç‰‡æœªåŠ è½½å‡ºæ¥ï¼Œé«˜åº¦ä¸º 0 åŠ è½½å®Œåï¼Œæœ‰äº†å†…å®¹å‘ç”Ÿè·³å˜çš„ç°è±¡)</a></p><p><a href="https://juejin.cn/post/6844903814332432397#:~:text=1%E7%89%A9%E7%90%86%E5%83%8F%E7%B4%A0%E7%BA%BF%EF%BC%88%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%99%AE%E9%80%9A%E5%B1%8F%E5%B9%95%E4%B8%8B1px%2C%E9%AB%98%E6%B8%85%E5%B1%8F%E5%B9%95%E4%B8%8B0.5px%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%89%E9%87%87%E7%94%A8transform%E5%B1%9E%E6%80%A7scale%E5%AE%9E%E7%8E%B0" target="_blank" >1 ç‰©ç†åƒç´ çº¿</a></p><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p><a href="https://www.nowcoder.com/exam/oj?tab=%E7%AE%97%E6%B3%95%E7%AF%87&topicId=295" target="_blank" >åˆ·ç®—æ³•</a></p><p><a href="https://juejin.cn/post/6844903846779551751" target="_blank" >å‰ç«¯é¢è¯•ä¹‹æ‰‹å†™ä»£ç </a></p><h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><p><a href="http://bigdata.ctocio.com.cn/bigdata/2022/0506/157700.html" target="_blank" >æ€ä¹ˆå®ç°æ¥å£é˜²åˆ·</a><br><a href="https://blog.csdn.net/liujiango/article/details/107372364" target="_blank" >æ€ä¹ˆå®ç°æ¥å£é˜²åˆ·</a></p><h2 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h2><p><a href="https://blog.csdn.net/weixin_45743636/article/details/118100951" target="_blank" >computed ä¸ watch çš„åŒºåˆ«</a></p><p>1ã€<strong>åŠŸèƒ½ä¸Š</strong>ï¼šcomputed æ˜¯è®¡ç®—å±æ€§ï¼Œwatch æ˜¯ç›‘å¬ä¸€ä¸ªå€¼çš„å˜åŒ–ï¼Œç„¶åæ‰§è¡Œå¯¹åº”çš„å›è°ƒã€‚<br>2ã€<strong>æ˜¯å¦è°ƒç”¨ ç¼“å­˜</strong>ï¼šcomputed ä¸­çš„å‡½æ•°æ‰€ä¾èµ–çš„å±æ€§æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè°ƒç”¨å½“å‰çš„å‡½æ•°çš„æ—¶å€™ä¼šä»ç¼“å­˜ä¸­è¯»å–ï¼Œè€Œ watch åœ¨æ¯æ¬¡ç›‘å¬çš„å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œå›è°ƒã€‚<br>3ã€<strong>æ˜¯å¦è°ƒç”¨ return</strong>ï¼šcomputed ä¸­çš„å‡½æ•°å¿…é¡»è¦ç”¨ return è¿”å›ï¼Œwatch ä¸­çš„å‡½æ•°ä¸æ˜¯å¿…é¡»è¦ç”¨ returnã€‚<br>4ã€<strong>computed</strong> é»˜è®¤ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™å°±å¼€å§‹ç›‘å¬ï¼›watch é»˜è®¤ç¬¬ä¸€æ¬¡åŠ è½½ä¸åšç›‘å¬ï¼Œå¦‚æœéœ€è¦ç¬¬ä¸€æ¬¡åŠ è½½åšç›‘å¬ï¼Œæ·»åŠ  immediate å±æ€§ï¼Œè®¾ç½®ä¸º trueï¼ˆimmediate:trueï¼‰<br>5ã€<strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šcomputedâ€”-å½“ä¸€ä¸ªå±æ€§å—å¤šä¸ªå±æ€§å½±å“çš„æ—¶å€™ï¼Œä½¿ç”¨ computedâ€”â€“è´­ç‰©è½¦å•†å“ç»“ç®—ã€‚watchâ€“å½“ä¸€æ¡æ•°æ®å½±å“å¤šæ¡æ•°æ®çš„æ—¶å€™ï¼Œä½¿ç”¨ watchâ€”â€“æœç´¢æ¡†.</p><h2 id="react"><a href="#react" class="headerlink" title="react"></a>react</h2><p><a href="https://blog.csdn.net/weixin_39907713/article/details/111237885" target="_blank" >React Router åŸç†</a><br><a href="https://blog.csdn.net/qingfeng2020/article/details/121136648" target="_blank" >æµ…è°ˆå‰ç«¯è·¯ç”±åŸç†ï¼ŒVueRouter åŸç†å’Œ ReactRouter åŸç†</a></p><p><a href="https://blog.csdn.net/Android_boom/article/details/125200222" target="_blank" >React Router æºç è§£æ</a><br><a href="https://wenku.baidu.com/view/dbc762dc740bf78a6529647d27284b73f342365b.html" target="_blank" >React åˆæˆäº‹ä»¶æœºåˆ¶</a><br><a href="https://baijiahao.baidu.com/s?id=1727882238371627418&wfr=spider&for=pc" target="_blank" >web å‰ç«¯åŸ¹è®­ React åˆæˆäº‹ä»¶åŸç†è§£æ</a></p><p><a href="https://www.jianshu.com/p/a68219093f88" target="_blank" >React äº‹ä»¶æœºåˆ¶ â€“ åˆæˆäº‹ä»¶</a></p><ul><li><strong>åŸç”Ÿäº‹ä»¶</strong><br>å½“æŸä¸ªå…ƒç´ è§¦å‘æŸä¸ªäº‹ä»¶ï¼ˆå¦‚ onclick ï¼‰ï¼Œé¡¶å±‚å¯¹è±¡ Document å°±ä¼šå‘å‡ºä¸€ä¸ªäº‹ä»¶æµï¼Œéšç€ DOM æ ‘çš„èŠ‚ç‚¹å‘ç›®æ ‡å…ƒç´ èŠ‚ç‚¹æµå»ï¼Œç›´åˆ°åˆ°è¾¾äº‹ä»¶çœŸæ­£å‘ç”Ÿçš„ç›®æ ‡å…ƒç´ ã€‚</li><li><strong>äº‹ä»¶ç›®æ ‡</strong><br>å½“åˆ°è¾¾ç›®æ ‡å…ƒç´ ä¹‹åï¼Œæ‰§è¡Œç›®æ ‡å…ƒç´ è¯¥äº‹ä»¶ç›¸åº”çš„å¤„ç†å‡½æ•°ã€‚å¦‚æœæ²¡æœ‰ç»‘å®šç›‘å¬å‡½æ•°ï¼Œé‚£å°±ä¸æ‰§è¡Œã€‚</li><li><strong>äº‹ä»¶å†’æ³¡</strong><br>ä»ç›®æ ‡å…ƒç´ å¼€å§‹ï¼Œå¾€é¡¶å±‚å…ƒç´ ä¼ æ’­ã€‚é€”ä¸­å¦‚æœæœ‰èŠ‚ç‚¹ç»‘å®šäº†ç›¸åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™äº›å‡½æ•°éƒ½ä¼šè¢«è§¦å‘ä¸€æ¬¡ã€‚</li><li><strong>äº‹ä»¶å§”æ‰˜&#x2F;äº‹ä»¶ä»£ç†</strong><ul><li>ç®€å•ç†è§£å°±æ˜¯å°†ä¸€ä¸ªå“åº”äº‹ä»¶å§”æ‰˜åˆ°å¦ä¸€ä¸ªå…ƒç´ ã€‚</li><li>å½“å­èŠ‚ç‚¹è¢«ç‚¹å‡»æ—¶ï¼Œclick äº‹ä»¶å‘ä¸Šå†’æ³¡ï¼Œçˆ¶èŠ‚ç‚¹æ•è·åˆ°äº‹ä»¶åï¼Œæˆ‘ä»¬åˆ¤æ–­æ˜¯å¦ä¸ºæ‰€éœ€çš„èŠ‚ç‚¹ï¼Œç„¶åè¿›è¡Œå¤„ç†ã€‚</li></ul></li><li><strong>åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶åŒºåˆ«</strong><ul><li>äº‹ä»¶åç§°å‘½åæ–¹å¼ä¸åŒ</li><li>äº‹ä»¶å¤„ç†å‡½æ•°å†™æ³•ä¸åŒ</li><li>é˜»æ­¢é»˜è®¤è¡Œä¸ºæ–¹å¼ä¸åŒ</li></ul></li><li><strong>React åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æ‰§è¡Œé¡ºåº</strong><!-- - ç±»ä¼¼æ´‹è‘±ï¼Œ  æ•è·ï¼š`document => react çˆ¶çº§ => react å­çº§ => çˆ¶çº§åŸç”Ÿ => å­çº§åŸç”Ÿ`  å†’æ³¡ï¼š`document <= react çˆ¶çº§ <= react å­çº§ <= çˆ¶çº§åŸç”Ÿ <= å­çº§åŸç”Ÿ` --></li><li><strong>é˜»æ­¢å†’æ³¡</strong></li><li><strong>åŸç”Ÿ:</strong> ä½¿ç”¨ <code>e.stopPropagation()</code> æˆ–è€… <code>e.cancelBubble=true</code>ï¼ˆIEï¼‰æ¥é˜»æ­¢</li><li><strong>react ä¸­ï¼Œ</strong>é˜»æ­¢å†’æ³¡çš„æ–¹å¼æœ‰ä¸‰ç§ï¼š<ol><li>é˜»æ­¢åˆæˆäº‹ä»¶ä¸éåˆæˆäº‹ä»¶ï¼ˆé™¤äº† documentï¼‰ä¹‹é—´çš„å†’æ³¡ï¼Œä»¥ä¸Šä¸¤ç§æ–¹å¼éƒ½ä¸é€‚ç”¨ï¼Œéœ€è¦ç”¨åˆ° e.target åˆ¤æ–­ã€‚</li><li>é˜»æ­¢åˆæˆäº‹ä»¶ä¸æœ€å¤–å±‚ document ä¸Šçš„äº‹ä»¶é—´çš„å†’æ³¡ï¼Œç”¨ <code>e.nativeEvent.stopImmediatePropagation()</code>;</li><li>é˜»æ­¢åˆæˆäº‹ä»¶é—´çš„å†’æ³¡ï¼Œç”¨ <code>e.stopPropagation()</code>;</li></ol></li></ul><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>react é˜»æ­¢äº‹ä»¶å†’æ³¡</p><ul><li><code>e.stopPropagation</code>ç”¨æ¥é˜»æ­¢ React æ¨¡æ‹Ÿçš„äº‹ä»¶å†’æ³¡</li><li><code>e.stopImmediatePropagation</code> æ²¡è¿™ä¸ªå‡½æ•°</li><li><code>e.nativeEvent.stopPropagation</code> åŸç”Ÿäº‹ä»¶å¯¹è±¡çš„ç”¨äºé˜»æ­¢ DOM äº‹ä»¶çš„è¿›ä¸€æ­¥æ•è·æˆ–è€…å†’æ³¡</li><li><code>e.nativeEvent.stopImmediatePropagation</code> åŸç”Ÿäº‹ä»¶å¯¹è±¡ç”¨äºé˜»æ­¢ dom äº‹ä»¶çš„è¿›ä¸€æ­¥æ•è·æˆ–è€…å†’æ³¡ï¼Œä¸”è¯¥å…ƒç´ çš„åç»­ç»‘å®šç›¸åŒäº‹ä»¶ç±»å‹çš„äº‹ä»¶ï¼Œéƒ½ä¼šè¢«é˜»æ­¢</li></ul></div><p><a href="https://zhuanlan.zhihu.com/p/150993869#:~:text=memo%E5%87%BD%E6%95%B0-,2.4.4.%20%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8A%9B%E9%87%8F,-%E6%88%91%E4%BB%AC%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA" target="_blank" >setState è¿”å›ä¸€æ ·çš„å¼•ç”¨ï¼Œrender ä¼šæ‰§è¡Œå—</a></p><p><a href="" target="_blank" >useEffect çš„ä½¿ç”¨æ–¹æ³•ï¼ŸuseEffect çš„ return ä¼šåœ¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œï¼ŸuseEffect åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</a></p><p><a href="https://blog.csdn.net/leelxp/article/details/108218088#:~:text=%E6%88%91%E4%BB%AC%E6%9D%A5%E7%9C%8B%E7%9C%8BPureComponent%E5%92%8CComponent%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%C2%A0" target="_blank" >æˆ‘ä»¬æ¥çœ‹çœ‹ PureComponent å’Œ Component çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ </a></p><p><strong>å•èŠ‚ç‚¹ Diff</strong><br><a href="https://react.iamkasong.com/diff/one.html" target="_blank" >å•èŠ‚ç‚¹ diff</a></p><p><strong>å¤šèŠ‚ç‚¹ Diff</strong><br><a href="https://react.iamkasong.com/diff/multi.html#diff%E7%9A%84%E6%80%9D%E8%B7%AF:~:text=%23-,%E7%AC%AC%E4%B8%80%E8%BD%AE%E9%81%8D%E5%8E%86,-%E7%AC%AC%E4%B8%80%E8%BD%AE%E9%81%8D" target="_blank" >ç¬¬ä¸€è½®éå†</a></p><p><a href="https://react.iamkasong.com/diff/multi.html#%E7%AC%AC%E4%B8%80%E8%BD%AE%E9%81%8D%E5%8E%86:~:text=%23-,%E7%AC%AC%E4%BA%8C%E8%BD%AE%E9%81%8D%E5%8E%86,-%E5%AF%B9%E4%BA%8E%E7%AC%AC%E4%B8%80%E8%BD%AE" target="_blank" >ç¬¬äºŒè½®éå†</a></p><p><a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" >react â½£å‘½å‘¨æœŸ</a></p><!-- <div><iframe src="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" height=600 width='100%'></iframe></div> --><p><a href="https://blog.csdn.net/weixin_45654582/article/details/122740125#:~:text=dependencies%20%E5%BB%BA%E7%AB%8B%E8%B5%B7%E5%85%B3%E8%81%94%E3%80%82-,Context%20%E5%8E%9F%E7%90%86,-Provider%20%E4%BC%A0%E9%80%92%E6%B5%81%E7%A8%8B" target="_blank" >Context åŸç†</a></p><ul><li>Provider ä¼ é€’æµç¨‹ï¼šProvider çš„æ›´æ–°ï¼Œä¼š æ·±åº¦éå†å­ä»£ fiberï¼Œæ¶ˆè´¹ context çš„ fiber å’Œçˆ¶çº§é“¾éƒ½ä¼š æå‡æ›´æ–°ä¼˜å…ˆçº§ã€‚ å¯¹äºç±»ç»„ä»¶çš„ fiber ï¼Œä¼š forceUpdate å¤„ç†ã€‚æ¥ä¸‹æ¥æ‰€æœ‰æ¶ˆè´¹çš„ fiberï¼Œéƒ½ä¼š beginWork ã€‚</li><li>Context è®¢é˜…æµç¨‹ï¼š contextType ï¼Œ useContextï¼Œ Consumer ä¼šå†…éƒ¨è°ƒç”¨ readContext ï¼ŒreadContext ä¼šæŠŠ fiber ä¸Šçš„ dependencies å±æ€§ å’Œ context å¯¹è±¡ å»ºç«‹èµ·å…³è”ã€‚</li></ul><p><a href="https://blog.csdn.net/github_37759996/article/details/119187241" target="_blank" >Hooks çš„å®ç°åŸç†</a><br><a href="https://blog.csdn.net/XH_jing/article/details/124188256" target="_blank" >ç±»ç»„ä»¶å’Œçº¯å‡½æ•°ç»„ä»¶çš„åŒºåˆ«</a></p><p><a href="https://www.php.cn/website-design-ask-491123.html" target="_blank" >React dom ç»‘å®šäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«</a></p><p><a href="https://juejin.cn/post/7064444554727915556" target="_blank" >useState çš„æºç è§£æ</a></p><h2 id="ç¨³æ“èƒœåˆ¸"><a href="#ç¨³æ“èƒœåˆ¸" class="headerlink" title="ç¨³æ“èƒœåˆ¸"></a>ç¨³æ“èƒœåˆ¸</h2><p><a href="http://dljz.nicethemes.cn/news/show-13202.html" target="_blank" >çœ‹å®Œè¿™ç¯‡æ–‡ç« ä¿ä½ é¢è¯•ç¨³æ“èƒœåˆ¸ â€”â€”ï¼ˆå¿…è€ƒé¢˜ï¼‰javaScript ç¯‡</a></p><p><a href="https://copyfuture.com/blogs-details/20211119150923474f" target="_blank" >çœ‹å®Œè¿™ç¯‡æ–‡ç« ä¿ä½ é¢è¯•ç¨³æ“èƒœåˆ¸â€”â€”åŸºç¡€ç¯‡ï¼ˆhtml&#x2F;css)</a></p><p><a href="https://www.wangt.cc/2021/11/%E7%9C%8B%E5%AE%8C%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%E4%BF%9D%E4%BD%A0%E9%9D%A2%E8%AF%95%E7%A8%B3%E6%93%8D%E8%83%9C%E5%88%B8-vue%E7%AF%87/" target="_blank" >çœ‹å®Œè¿™ç¯‡æ–‡ç« ä¿ä½ é¢è¯•ç¨³æ“èƒœåˆ¸-vue ç¯‡</a></p><p><a href="https://copyfuture.com/blogs-details/20211118131747765L" target="_blank" >è¯»å®Œè¿™ç¯‡ä¿ä½ é¢è¯•ç¨³æ“èƒœåˆ¸â€”â€”å‰ç«¯é¢è¯•é¢˜â€œéª¨ç°çº§â€æ€»ç»“</a></p><h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><p><a href="https://zhuanlan.zhihu.com/p/472733451" target="_blank" >Webpack | TreeShaking å·¥ä½œåŸç†</a><br><a href="https://juejin.cn/post/7039547628379439135" target="_blank" >ä»€ä¹ˆæ˜¯ tree-shaking</a></p><p><a href="https://juejin.cn/post/6844903924806189070" target="_blank" >Webpack ä¼˜åŒ–â€”â€”å°†ä½ çš„æ„å»ºæ•ˆç‡æé€Ÿç¿»å€</a></p><p><a href="https://juejin.cn/post/6844903685407916039" target="_blank" >Webpack æ­ç§˜â€”â€”èµ°å‘é«˜é˜¶å‰ç«¯çš„å¿…ç»ä¹‹è·¯</a></p><p><a href="https://www.cnblogs.com/zhilili/p/14721434.html" target="_blank" >webpackï¼ˆå››ï¼‰â€”â€”webpack é‡Œé¢çš„ plugin å’Œ loader çš„åŒºåˆ«</a></p><p><a href="https://zhuanlan.zhihu.com/p/429072485" target="_blank" >è·Ÿç€æºç äº†è§£ Webpack ç¼–è¯‘æµç¨‹</a></p><p><a href="https://blog.csdn.net/qq_39207948/article/details/102768659" target="_blank" >è¯´ä¸€ä¸‹å¯¹ tree-shaking çš„äº†è§£ï¼Œå¯¹ CommonJS å’Œ ESM éƒ½å¯ä»¥ç”¨ tree-shaking å—</a></p><p><a href="https://www.webpackjs.com/contribute/writing-a-loader/" target="_blank" >ç¼–å†™ä¸€ä¸ª loader</a></p><p><a href="https://www.webpackjs.com/contribute/writing-a-plugin/" target="_blank" >ç¼–å†™ä¸€ä¸ªæ’ä»¶</a></p><p><a href="https://juejin.cn/post/6918998088010956807" target="_blank" >Webpack5 çš„äº‹ä»¶æµå’Œæ’ä»¶æœºåˆ¶</a></p><p><a href="" target="_blank" >px2rem-loader[9], æˆ–è€… pxrem-loader[10]åŸç† ^_^</a></p><!-- <a href="https://cloud.tencent.com/developer/article/1432511" target="_blank" >Webpack 4 æ•™ç¨‹ - ç¬¬å››éƒ¨åˆ†ï¼Œä½¿ç”¨ SplitChunksPlugin åˆ†ç¦»ä»£ç </a><a href="https://cloud.tencent.com/developer/article/1432714" target="_blank" >Webpack 4 æ•™ç¨‹ - ç¬¬ä¸ƒéƒ¨åˆ† å‡å°‘æ‰“åŒ…ä½“ç§¯ä¸ Tree Shaking</a><a href="https://cloud.tencent.com/developer/article/1017015" target="_blank" >ä¼˜åŒ– Webpack æ„å»ºæ€§èƒ½çš„å‡ ç‚¹å»ºè®®</a>```js{  ä½“ç§¯å°ï¼š åˆé€‚çš„ source-mapã€å‡å°‘ä»£ç ä½“ç§¯ã€ webpack-bundle-analyzerè¿›è¡Œåˆ†æ  èŒƒå›´å°ï¼šç›®å½•æ£€ç´¢èŒƒå›´ã€æ£€ç´¢è·¯å¾„  ç¼“å­˜ï¼šå¼€å¯ loaderã€plugin ç¼“å­˜  ä¸é‡å¤æ‰“åŒ…ï¼šDLLPlugin + DLLRefrencePlugin ã€ externals}``` --><p><a href="https://javajgs.com/archives/36777" target="_blank" >å¸¸è§loaderä½¿ç”¨ , ä¸å¥½çœ‹ï¼Œæœ‰ä¹±ä¸ƒå…«ç³Ÿå›¾ç‰‡ï¼Œimg æ ·å¼è®¾ç½® display: none;</a></p><ul><li>æ–‡ä»¶ç›¸å…³ï¼š</li><li>JSONç›¸å…³ï¼š</li><li>JS&#x2F;TSè½¬è¯‘:</li><li>æ¨¡ç‰ˆï¼š</li><li>æ ·å¼ï¼š</li><li>lintæ ¡éªŒï¼š</li><li>æµ‹è¯•ï¼š</li><li>æ¡†æ¶ï¼š</li></ul><h2 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h2><p><a href="https://juejin.cn/post/6844903655330562062" target="_blank" >ç½‘ç«™æ€§èƒ½ä¼˜åŒ–å®æˆ˜â€”â€”ä» 12.67s åˆ° 1.06s çš„æ•…äº‹</a></p><p><a href="http://v.aijs.top/post/2022-05-12performance" target="_blank" >æµè§ˆå™¨é¦–å±ä¼˜åŒ–-é¦–å±æ—¶é—´è·å–</a></p><h2 id="åšå®¢æ¨è"><a href="#åšå®¢æ¨è" class="headerlink" title="åšå®¢æ¨è"></a>åšå®¢æ¨è</h2><p><a href="https://blog.csdn.net/JHXL_?type=blog" target="_blank" >å‡ ä½•å¿ƒå‡‰</a></p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>httpé”™è¯¯ä¿¡æ¯</title>
      <link href="//post/2022-06-15http.html"/>
      <url>//post/2022-06-15http.html</url>
      
        <content type="html"><![CDATA[<h2 id="http-é”™è¯¯ä¿¡æ¯"><a href="#http-é”™è¯¯ä¿¡æ¯" class="headerlink" title="http é”™è¯¯ä¿¡æ¯"></a>http é”™è¯¯ä¿¡æ¯</h2><pre class="line-numbers language-none"><code class="language-none">Request URL: http:&#x2F;&#x2F;localhost:8888&#x2F;api&#x2F;redline&#x2F;content_management&#x2F;api&#x2F;kbs&#x2F;search&#x2F;contentListRequest Method: POSTStatus Code: 403 ForbiddenRemote Address: [::1]:8888Referrer Policy: strict-origin-when-cross-origin</code></pre><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;code&quot;: &quot;102&quot;,  &quot;message&quot;: &quot;ACL not allowed!&quot;,  &quot;rs&quot;: &#123;    &quot;possessionApplyUrl&quot;: &quot;https:&#x2F;&#x2F;acl.fast-inside.xxxxxx:7799&#x2F;#&#x2F;dataPermission&#x2F;roleApplication?projectCode&#x3D;content-management&amp;resourceCode&#x3D;POST:&#x2F;api&#x2F;kbs&#x2F;search&#x2F;contentList&quot;,    &quot;resourceName&quot;: &quot;api_kbs_search_contentList&quot;  &#125;,  &quot;failure&quot;: true,  &quot;success&quot;: false&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">return fetch(API_URL, options)  .then(checkStatus)  .then(parseJSON)  .then((result) &#x3D;&gt; &#123;    const &#123; success &#125; &#x3D; result;    if (!success &amp;&amp; !&#x2F;\&#x2F;api\&#x2F;jira&#x2F;.test(API_URL)) &#123;      return Promise.reject(result);    &#125;    return result;  &#125;)  .catch((e) &#x3D;&gt; &#123;    console.log(&#96;error API_URL :::$&#123;url&#125; $&#123;API_URL&#125;&#96;);    logger.info(&#96;API_URL :::$&#123;url&#125; $&#123;API_URL&#125;&#96;);    logger.info(&#96;Error ::: $&#123;e&#125;&#96;);    &#x2F;&#x2F; ä¼šèµ°åˆ°è¿™é‡Œï¼Œè¿™é‡Œåªèƒ½è·å–åˆ°403ç›¸å…³ä¿¡æ¯ï¼Œè·å–ä¸åˆ°å“åº”çš„å†…å®¹  &#125;);</code></pre>]]></content>
      
      
      <categories>
          
          <category> bug </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bug </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>piniaæºç </title>
      <link href="//post/2022-06-14vue-pinia.html"/>
      <url>//post/2022-06-14vue-pinia.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>äº†è§£äº† playgroundï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ pinia æºç ï¼Œé‚£äº› api å’Œæ–¹æ³•ã€‚è¿™ä¹ˆç”¨åšäº†ä»€ä¹ˆäº‹æƒ…</p><p><code>this.$patch</code><a href="https://github.com/vuejs/pinia/blob/2eb123d8114ceb4fad46ac019844a1967d9a9135/packages/playground/src/stores/counter.ts#L49" target="_blank" >playgound</a></p><p><code>defineStore</code></p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å”¯ä¸€å­—ç¬¦ä¸²ï¼Œç”¨æ¥æ ‡è¯† storeï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª store å¯¹è±¡ <a href="https://github.com/vuejs/pinia/blob/2eb123d8114ceb4fad46ac019844a1967d9a9135/packages/playground/src/stores/nasa-pod.ts#L6" target="_blank" >playground</a></li><li>ç¬¬ä¸€ä¸ªå‚æ•°ç›´æ¥æ˜¯é…ç½®é¡¹ <a href="https://github.com/vuejs/pinia/blob/2eb123d8114ceb4fad46ac019844a1967d9a9135/packages/playground/src/stores/jokesUsePromised.ts#L6" target="_blank" >playgound</a></li></ul><p>ç»„ä»¶ä¸­ç›´æ¥é€šè¿‡<code>useXXStoreè·å–store</code> <a href="https://github.com/vuejs/pinia/blob/2eb123d8114ceb4fad46ac019844a1967d9a9135/packages/playground/src/views/NasaPOD.vue#L52" target="_blank" >playground</a></p><p><code>state</code>æ€ä¹ˆå°±æ˜¯ä¸ªå‡½æ•°ï¼Œè€Œä¸”è¿™ä¸ªå‡½æ•°å¯ä»¥è®©æˆ‘ä»¬è‡ªå®šä¹‰ store çš„åˆå§‹å€¼<br><code>$dispose</code> <a href="https://github.com/vuejs/pinia/blob/2eb123d8114ceb4fad46ac019844a1967d9a9135/packages/playground/src/views/NasaPOD.vue#L49" target="_blank" >playgound</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">onUnmounted(() &#x3D;&gt; &#123;  userStore.$dispose();  cartStore.$dispose();  counterStore.$dispose();&#125;);</code></pre><p><code>import &#123; storeToRefs &#125; from &#39;pinia&#39;</code></p><p>ä»¥åŠ playground æ²¡æ²¡æœ‰ç”¨åˆ°çš„ api</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const partialStore &#x3D; &#123;  _p: pinia,  &#x2F;&#x2F; _s: scope,  $id,  $onAction: addSubscription.bind(null, actionSubscriptions),  $patch,  $reset,  $subscribe,  $dispose,&#125; as _StoreWithState&lt;Id, S, G, A&gt;;const store: Store&lt;Id, S, G, A&gt; &#x3D; reactive(partialStore); &#x2F;&#x2F; ç®€åŒ–äº†ï¼Œä¸è€ƒè™‘ä¸­é—´ä»»ä½•ç»†èŠ‚pinia._s.set($id, store);</code></pre><ul><li>$reset:è¯¥apiæ˜¯$patchçš„è¯­æ³•ç³–ï¼Œåªä¸è¿‡ä¼ é€’çš„å‚æ•°æ˜¯åˆå§‹çš„stateå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œæºç ä¸­<code>const newState = state? state() : &#123;&#125;</code></li><li>$patchï¼špatchå°±æ˜¯ä¸€æ¬¡é€’å½’å¯¹valueè¦†ç›–çš„è¿‡ç¨‹</li><li>$subscribeï¼š æœ‰ç‚¹ç±»ä¼¼è§‚å¯Ÿè€…ï¼Œå½“è°ƒç”¨subscribeæ—¶ï¼Œä¼šå°†å½“å‰çš„çŠ¶æ€ä¿¡æ¯ä¿å­˜åˆ°subscriptions</li></ul><h2 id="æºç è§£è¯»"><a href="#æºç è§£è¯»" class="headerlink" title="æºç è§£è¯»"></a>æºç è§£è¯»</h2><p><a href="https://www.jianshu.com/p/2acc2d043d35" target="_blank" >piniaæºç è§£è¯»â€“å®ç°æµç¨‹</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jianshu.com/p/2acc2d043d35" target="_blank" >pinia æºç è§£è¯»â€“å®ç°æµç¨‹</a><br><a href="https://github.com/vuejs/pinia" target="_blank" >pinia</a></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>piniaä¸­çš„vue-demiæºç </title>
      <link href="//post/2022-06-15vue-demi.html"/>
      <url>//post/2022-06-15vue-demi.html</url>
      
        <content type="html"><![CDATA[<h2 id="pinia-ä¸­çš„-vue-demi"><a href="#pinia-ä¸­çš„-vue-demi" class="headerlink" title="pinia ä¸­çš„ vue-demi"></a>pinia ä¸­çš„ vue-demi</h2><p>Vue Demi æ˜¯ä¸€ä¸ªè®©ä½ å¯ä»¥å¼€å‘åŒæ—¶æ”¯æŒ Vue2 å’Œ 3 çš„é€šç”¨çš„ Vue åº“çš„å¼€å‘å·¥å…·ï¼Œè€Œæ— éœ€æ‹…å¿ƒç”¨æˆ·å®‰è£…çš„ç‰ˆæœ¬ã€‚</p><p>å½“ç”¨æˆ·è¦åˆ›å»ºä¸€ä¸ª Vue æ’ä»¶&#x2F;åº“æ—¶ï¼Œåªéœ€å°† vue-demi å®‰è£…ä¸ºä¾èµ–é¡¹å¹¶å°†å…¶å¯¼å…¥ï¼Œç„¶ååƒä¹‹å‰ä¸€æ ·å‘å¸ƒä½ çš„æ’ä»¶&#x2F;åº“ï¼Œç”¨æˆ·çš„è½¯ä»¶åŒ…å°±ä¼šå˜å¾—é€šç”¨ã€‚</p><p>Vue Demi ä½¿ç”¨äº† NPM é’©å­ postinstallã€‚å½“ç”¨æˆ·å®‰è£…æ‰€æœ‰åŒ…åï¼Œè„šæœ¬å°†å¼€å§‹æ£€æŸ¥å·²å®‰è£…çš„ Vue ç‰ˆæœ¬ï¼Œå¹¶æ ¹æ® Vue ç‰ˆæœ¬è¿”å›å¯¹åº”çš„ä»£ç ã€‚åœ¨ä½¿ç”¨ Vue 2 æ—¶ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…@vue&#x2F;composition-apiï¼Œå®ƒä¹Ÿä¼šè‡ªåŠ¨å®‰è£….</p><p><strong>ä»¥å‰</strong></p><p>ä»¥å‰ï¼Œè¦åˆ›å»ºæ”¯æŒä¸¤ä¸ªç›®æ ‡ç‰ˆæœ¬çš„ Vue åº“ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ä¸åŒçš„åˆ†æ”¯æ¥åˆ†ç¦»å¯¹æ¯ä¸ªç‰ˆæœ¬çš„æ”¯æŒã€‚å¯¹äºç°æœ‰åº“æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬çš„ä»£ç åº“é€šå¸¸æ›´ç¨³å®šã€‚<br>ç¼ºç‚¹æ˜¯ï¼Œä½ éœ€è¦ç»´æŠ¤ä¸¤ä¸ªä»£ç åº“ï¼Œè¿™è®©ä½ çš„å·¥ä½œé‡ç¿»å€ã€‚å¯¹äºæƒ³è¦æ”¯æŒ Vue çš„ä¸¤ä¸ªç›®æ ‡ç‰ˆæœ¬çš„æ–° Vue åº“æ¥è¯´ï¼Œæˆ‘ä¸æ¨èè¿™ç§æ–¹æ³•ã€‚å®æ–½ä¸¤æ¬¡åŠŸèƒ½è¯·æ±‚å’Œé”™è¯¯ä¿®å¤æ ¹æœ¬å°±ä¸ç†æƒ³ã€‚</p><p><strong>ç°åœ¨</strong></p><p>è¿™å°±æ˜¯ Vue Demi çš„ç”¨æ­¦ä¹‹åœ°ã€‚Vue Demi é€šè¿‡ä¸ºä¸¤ä¸ªç›®æ ‡ç‰ˆæœ¬æä¾›é€šç”¨æ”¯æŒæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ„å‘³ç€æ‚¨åªéœ€æ„å»ºä¸€æ¬¡å³å¯è·å¾—ä¸¤ä¸ªç›®æ ‡ç‰ˆæœ¬çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œä»è€Œè·å¾—ä¸¤å…¨å…¶ç¾çš„ä¼˜åŠ¿ã€‚</p><h2 id="æ ¸å¿ƒä»£ç ç›®å½•"><a href="#æ ¸å¿ƒä»£ç ç›®å½•" class="headerlink" title="æ ¸å¿ƒä»£ç ç›®å½•"></a>æ ¸å¿ƒä»£ç ç›®å½•</h2><pre class="line-numbers language-none"><code class="language-none">â”œâ”€â”€ libâ”‚Â Â  â”œâ”€â”€ index.cjsâ”‚Â Â  â”œâ”€â”€ index.d.tsâ”‚Â Â  â”œâ”€â”€ index.iife.jsâ”‚Â Â  â”œâ”€â”€ index.mjsâ”‚Â Â  â”œâ”€â”€ v2â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.cjsâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.d.tsâ”‚Â Â  â”‚Â Â  â””â”€â”€ index.mjsâ”‚Â Â  â”œâ”€â”€ v2.7â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.cjsâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.d.tsâ”‚Â Â  â”‚Â Â  â””â”€â”€ index.mjsâ”‚Â Â  â””â”€â”€ v3â”‚Â Â      â”œâ”€â”€ index.cjsâ”‚Â Â      â”œâ”€â”€ index.d.tsâ”‚Â Â      â””â”€â”€ index.mjsâ”œâ”€â”€ package.jsonâ””â”€â”€ scripts    â”œâ”€â”€ postinstall.js    â”œâ”€â”€ switch-cli.js    â””â”€â”€ utils.js</code></pre><h2 id="æ ¸å¿ƒä»£ç "><a href="#æ ¸å¿ƒä»£ç " class="headerlink" title="æ ¸å¿ƒä»£ç "></a>æ ¸å¿ƒä»£ç </h2><p><strong>package.json</strong></p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;name&quot;: &quot;vue-demi&quot;,  &quot;version&quot;: &quot;0.13.1&quot;,  &quot;scripts&quot;: &#123;    &quot;postinstall&quot;: &quot;node .&#x2F;scripts&#x2F;postinstall.js&quot;, &#x2F;&#x2F; é’©å­npm installç»“æŸåä¼šæ‰§è¡Œ    &quot;release&quot;: &quot;npx bumpp --tag --commit --push &amp;&amp; npm publish&quot;  &#125;,  &quot;peerDependencies&quot;: &#123;    &quot;@vue&#x2F;composition-api&quot;: &quot;^1.0.0-rc.1&quot;,    &quot;vue&quot;: &quot;^3.0.0-0 || ^2.6.0&quot;  &#125;,  &quot;peerDependenciesMeta&quot;: &#123;    &quot;@vue&#x2F;composition-api&quot;: &#123;      &quot;optional&quot;: true    &#125;  &#125;&#125;</code></pre><p><strong>scripts&#x2F;postinstall.js</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const &#123; switchVersion, loadModule &#125; &#x3D; require(&quot;.&#x2F;utils&quot;);const Vue &#x3D; loadModule(&quot;vue&quot;); &#x2F;&#x2F; åŠ è½½vue, é€šè¿‡Vue.versionè·å–ç‰ˆæœ¬if (!Vue || typeof Vue.version !&#x3D;&#x3D; &quot;string&quot;) &#123;  console.warn(    &#39;[vue-demi] Vue is not found. Please run &quot;npm install vue&quot; to install.&#39;  );&#125; else if (Vue.version.startsWith(&quot;2.7.&quot;)) &#123;  switchVersion(2.7); &#x2F;&#x2F; åˆ‡æ¢åˆ°2.7ç‰ˆæœ¬ï¼Œæ‹·è´å†…å®¹åˆ°lib&#x2F;v2.7ç›®å½•&#125; else if (Vue.version.startsWith(&quot;2.&quot;)) &#123;  switchVersion(2); &#x2F;&#x2F; åˆ‡æ¢åˆ°2.7ç‰ˆæœ¬ï¼Œæ‹·è´å†…å®¹åˆ°lib&#x2F;v2ç›®å½•ï¼Œå¹¶æ‰§è¡Œå®‰è£…@vue&#x2F;composition-apiï¼Œæ›´æ–°ç›¸å…³å†…å®¹,æ‰§è¡Œv2apiæ›´æ–°&#125; else if (Vue.version.startsWith(&quot;3.&quot;)) &#123;  &#x2F;&#x2F; åˆ‡æ¢åˆ°3.0ç‰ˆæœ¬ï¼Œæ‹·è´å†…å®¹åˆ°lib&#x2F;v3ç›®å½•  switchVersion(3);&#125; else &#123;  console.warn(&#96;[vue-demi] Vue version v$&#123;Vue.version&#125; is not suppported.&#96;);&#125;</code></pre><p><strong>loadModule</strong>ä¸<strong>switchVersion</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const fs &#x3D; require(&quot;fs&quot;);const path &#x3D; require(&quot;path&quot;);const dir &#x3D; path.resolve(__dirname, &quot;..&quot;, &quot;lib&quot;);&#x2F;&#x2F; loadModulefunction loadModule(name) &#123;  try &#123;    return require(name);  &#125; catch (e) &#123;    return undefined;  &#125;&#125;function copy(name, version, vue) &#123;  vue &#x3D; vue || &quot;vue&quot;;  const src &#x3D; path.join(dir, &#96;v$&#123;version&#125;&#96;, name);  const dest &#x3D; path.join(dir, name);  let content &#x3D; fs.readFileSync(src, &quot;utf-8&quot;);  content &#x3D; content.replace(&#x2F;&#39;vue&#39;&#x2F;g, &#96;&#39;$&#123;vue&#125;&#39;&#96;);  &#x2F;&#x2F; unlink for pnpm, #92  try &#123;    fs.unlinkSync(dest); &#x2F;&#x2F; åˆ é™¤æ—§çš„æ–‡ä»¶  &#125; catch (error) &#123;&#125;  &#x2F;&#x2F; å†™å…¥æ–°çš„æ–‡ä»¶  fs.writeFileSync(dest, content, &quot;utf-8&quot;);&#125;&#x2F;&#x2F; æ›´æ–°vue2apifunction updateVue2API() &#123;  const ignoreList &#x3D; [&quot;version&quot;, &quot;default&quot;];  const VCA &#x3D; loadModule(&quot;@vue&#x2F;composition-api&quot;);  if (!VCA) &#123;    console.warn(      &#39;[vue-demi] Composition API plugin is not found. Please run &quot;npm install @vue&#x2F;composition-api&quot; to install.&#39;    );    return;  &#125;  const exports &#x3D; Object.keys(VCA).filter((i) &#x3D;&gt; !ignoreList.includes(i));  const esmPath &#x3D; path.join(dir, &quot;index.mjs&quot;);  let content &#x3D; fs.readFileSync(esmPath, &quot;utf-8&quot;);  &#x2F;&#x2F;æºç ä»“åº“ç»“æœ @link https:&#x2F;&#x2F;github.com&#x2F;vueuse&#x2F;vue-demi&#x2F;blob&#x2F;813a8dadf3a8f12b3b4a1369ff2b8da6c813d97e&#x2F;lib&#x2F;v2&#x2F;index.mjs#L2  content &#x3D; content.replace(    &#x2F;\&#x2F;\*\*VCA-EXPORTS\*\*\&#x2F;[\s\S]+\&#x2F;\*\*VCA-EXPORTS\*\*\&#x2F;&#x2F;m,    &#96;&#x2F;**VCA-EXPORTS**&#x2F;export &#123; $&#123;exports.join(      &quot;, &quot;    )&#125; &#125; from &#39;@vue&#x2F;composition-api&#x2F;dist&#x2F;vue-composition-api.mjs&#39;&#x2F;**VCA-EXPORTS**&#x2F;&#96;  );  fs.writeFileSync(esmPath, content, &quot;utf-8&quot;);&#125;&#x2F;&#x2F; switchVersion æ‹·è´å…¥å£åˆ°å¯¹åº”çš„ç‰ˆæœ¬ç›®å½•function switchVersion(version, vue) &#123;  copy(&quot;index.cjs&quot;, version, vue);  copy(&quot;index.mjs&quot;, version, vue);  copy(&quot;index.d.ts&quot;, version, vue);  &#x2F;&#x2F; å¦‚æœæ˜¯v2è¿˜éœ€è¦æ›´æ–°api  if (version &#x3D;&#x3D;&#x3D; 2) updateVue2API();&#125;module.exports.loadModule &#x3D; loadModule;module.exports.switchVersion &#x3D; switchVersion;</code></pre><h2 id="å†æ¥çœ‹ä¸‹æš´éœ²çš„-api"><a href="#å†æ¥çœ‹ä¸‹æš´éœ²çš„-api" class="headerlink" title="å†æ¥çœ‹ä¸‹æš´éœ²çš„ api"></a>å†æ¥çœ‹ä¸‹æš´éœ²çš„ api</h2><p><strong>pinia ä¸­æºç å¼•ç”¨</strong></p><p><strong>pinia&#x2F;packages&#x2F;pinia&#x2F;src&#x2F;storeToRefs.ts</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123;  isReactive,  isRef,  isVue2,  toRaw,  toRef,  ToRefs,  toRefs,&#125; from &quot;vue-demi&quot;;</code></pre><p><strong>pinia&#x2F;packages&#x2F;pinia&#x2F;src&#x2F;rootStore.ts</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123;  App,  EffectScope,  getCurrentInstance,  inject,  InjectionKey,  Ref,&#125; from &quot;vue-demi&quot;;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; @link https:&#x2F;&#x2F;github.com&#x2F;vueuse&#x2F;vue-demi&#x2F;blob&#x2F;813a8dadf3a8f12b3b4a1369ff2b8da6c813d97e&#x2F;lib&#x2F;index.mjs#L27export * from &quot;vue&quot;;&#x2F;&#x2F; é™¤äº†æš´éœ²ç‰ˆæœ¬vue-demiäº§ç”Ÿçš„apiè¿˜å°†vueçš„apiä¹Ÿæš´éœ²äº†å‡ºæ¥ï¼Œåœ¨å¼€å‘ç¬¬ä¸‰æ–¹åŒ…çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‰ç…§ä¸åŒçš„ç‰ˆæœ¬ï¼Œè°ƒç”¨ä¸åŒçš„apiexport &#123; Vue, Vue2, isVue2, isVue3, install &#125;;</code></pre><p>ç”±ä¸Šé¢çš„æºç <code>export * from &quot;vue&quot;;</code>,æˆ‘ä»¬å¯ä»¥ä»vue-demiä¸­è·å–æ‰€æœ‰çš„apiï¼Œè¿™ä¹Ÿæ˜¯piniaä¸­é¢‘ç¹ä½¿ç”¨<code>vue-demi</code>ï¼Œå´ä¸è§<code>vue</code>çš„åŸå› </p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/qq_40021015/article/details/123658502" target="_blank" >vue Demi åŒæ—¶æ”¯æŒ vue2 å’Œ vue3</a><br><a href="https://madewith.cn/502" target="_blank" >https://madewith.cn/502</a><br><a href="https://github.com/vueuse/vue-demi" target="_blank" >vue-demi</a></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>piniaæºç åˆ†æ playground</title>
      <link href="//post/2022-06-13vue-pinia.html"/>
      <url>//post/2022-06-13vue-pinia.html</url>
      
        <content type="html"><![CDATA[<h2 id="playground-è¿è¡Œ"><a href="#playground-è¿è¡Œ" class="headerlink" title="playground è¿è¡Œ"></a>playground è¿è¡Œ</h2><p>æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ vue é¡¹ç›®</p><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;scripts&quot;: &#123;  &quot;release&quot;: &quot;node scripts&#x2F;release.mjs&quot;,  &quot;size&quot;: &quot;pnpm run -r size&quot;,  &quot;build&quot;: &quot;pnpm run -r build&quot;,  &quot;docs:build&quot;: &quot;pnpm run docs:api &amp;&amp; pnpm run -r docs:build --filter .&#x2F;packages&#x2F;docs&quot;,  &quot;play&quot;: &quot;pnpm run -r play&quot;,  &quot;build:dts&quot;: &quot;pnpm run -r build:dts --parallel&quot;,  &quot;lint&quot;: &quot;prettier -c --parser typescript \&quot;packages&#x2F;*&#x2F;&#123;src,__tests__,e2e&#125;&#x2F;**&#x2F;*.[jt]s?(x)\&quot;&quot;,  &quot;lint:fix&quot;: &quot;pnpm run lint --write&quot;,  &quot;test&quot;: &quot;pnpm run test:types &amp;&amp; pnpm run test:jest &amp;&amp; pnpm run -r test &amp;&amp; pnpm run build &amp;&amp; pnpm run build:dts &amp;&amp; pnpm test:dts&quot;,  &quot;test:jest&quot;: &quot;jest --coverage&quot;,  &quot;test:types&quot;: &quot;tsc --build .&#x2F;tsconfig.json&quot;,  &quot;test:dts&quot;: &quot;pnpm run -r test:dts&quot;,  &quot;docs:api&quot;: &quot;pnpm run -r docs:api --filter .&#x2F;packages&#x2F;docs&quot;&#125;</code></pre><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ node ç‰ˆæœ¬ <code>The engine &quot;node&quot; is incompatible with this module. Expected version &quot;^12.20.0 || ^14.13.1 || &gt;=16.0.0&quot;.</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ğŸ‘‘ ~&#x2F;Desktop&#x2F;pinia git:(v2) $ yarn yarn install v1.4.0     node&#x2F;14.17.4   Î¿ node&#x2F;15.14.0     node&#x2F;16.13.1 Use up&#x2F;down arrow keys to select a version, return key to install, d to delete, q to quit info No lockfile found. [1&#x2F;4] ğŸ”  Resolving packages... warning conventional-changelog-cli &gt; tempfile &gt; uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https:&#x2F;&#x2F;v8.dev&#x2F;blog&#x2F;math-random for details. warning workspace-aggregator-d3702d10-5118-458d-9b17-8c5b340f31d0 &gt; @pinia&#x2F;nuxt &gt; @nuxt&#x2F;types &gt; @types&#x2F;autoprefixer &gt; @types&#x2F;browserslist@4.15.0: This is a stub types definition. browserslist provides its own type definitions, so you do not need this installed. warning workspace-aggregator-d3702d10-5118-458d-9b17-8c5b340f31d0 &gt; @pinia&#x2F;nuxt &gt; @nuxt&#x2F;types &gt; @types&#x2F;webpack &gt; @types&#x2F;anymatch@3.0.0: This is a stub types definition. anymatch provides its own type definitions, so you do not need this installed. [2&#x2F;4] ğŸšš  Fetching packages... error execa@6.1.0: The engine &quot;node&quot; is incompatible with this module. Expected version &quot;^12.20.0 || ^14.13.1 || &gt;&#x3D;16.0.0&quot;. error An unexpected error occurred: &quot;Found incompatible module&quot;. info If you think this is a bug, please open a bug report with the information provided in &quot;&#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;pinia&#x2F;yarn-error.log&quot;. info Visit https:&#x2F;&#x2F;yarnpkg.com&#x2F;en&#x2F;docs&#x2F;cli&#x2F;install for documentation about this command. ğŸ‘‘ ~&#x2F;Desktop&#x2F;pinia git:(v2) $ sudo n Password:   installed : v16.13.1 (with npm 8.1.2)</code></pre></div><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># å…¨å±€å®‰è£…pnpmnpm install -g pnpm# æ ¹ç›®å½•yarn</code></pre><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yarn build &amp;&amp; yarn play</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p><p>å¦‚æœä¸è¿è¡Œ <code>yarn build</code>,ä½ å°†çœ‹åˆ°å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯ï¼ŒåŸå› æ˜¯<code>playgound/vite.config.ts</code>ï¼Œå†…éƒ¨å†™äº†<code>copyPiniaPlugin</code></p><p>[plugin:vite:import-analysis] Failed to resolve entry for package â€œpiniaâ€. The package may have incorrect main&#x2F;module&#x2F;exports specified in its package.json: Failed to resolve entry for package â€œpiniaâ€. The package may have incorrect main&#x2F;module&#x2F;exports specified in its package.json</p></div><h2 id="playgound-x2F-vite-config-ts"><a href="#playgound-x2F-vite-config-ts" class="headerlink" title="playgound&#x2F;vite.config.ts"></a>playgound&#x2F;vite.config.ts</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; defineConfig, Plugin &#125; from &quot;vite&quot;;import vue from &quot;@vitejs&#x2F;plugin-vue&quot;;import &#123; promises as fs &#125; from &quot;fs&quot;;import path from &quot;path&quot;;&#x2F;&#x2F; https:&#x2F;&#x2F;vitejs.dev&#x2F;config&#x2F;export default defineConfig(&#123;  plugins: [vue(), copyPiniaPlugin()],  define: &#123;    &#x2F;&#x2F; __DEV__: &#39;true&#39;,    &#x2F;&#x2F; __BROWSER__: &#39;true&#39;,    __TEST__: &quot;false&quot;,  &#125;,  resolve: &#123;    &#x2F;&#x2F; alias: &#123;    &#x2F;&#x2F;   &#39;@vue&#x2F;composition-api&#39;: &#39;vue-demi&#39;,    &#x2F;&#x2F; &#125;,    dedupe: [&quot;vue-demi&quot;, &quot;vue&quot;],  &#125;,  optimizeDeps: &#123;    &#x2F;&#x2F; piniaé¡¹æ’é™¤    exclude: [&quot;vue-demi&quot;, &quot;@vueuse&#x2F;shared&quot;, &quot;@vueuse&#x2F;core&quot;, &quot;pinia&quot;],  &#125;,&#125;);&#x2F;&#x2F; æ‹·è´piniaåˆ°é¡¹ç›®ä¸­ï¼Œé¿å…ç¼–è¯‘function copyPiniaPlugin(): Plugin &#123;  return &#123;    name: &quot;copy-pinia&quot;,    async generateBundle() &#123;      const filePath &#x3D; path.resolve(__dirname, &quot;..&#x2F;pinia&#x2F;dist&#x2F;pinia.mjs&quot;); &#x2F;&#x2F; æ³¨æ„è¿™é‡Œï¼Œä¸æ‰§è¡Œ yarn build è¿™é‡Œæ˜¯æ²¡æœ‰æ•°æ®çš„ï¼Œyarn playä¼šæŠ¥é”™      &#x2F;&#x2F; throws if file doesn&#39;t exist      await fs.access(filePath);      this.emitFile(&#123;        type: &quot;asset&quot;,        fileName: &quot;pinia.mjs&quot;,        source: await fs.readFile(filePath, &quot;utf-8&quot;),      &#125;);    &#125;,  &#125;;&#125;</code></pre><p><img src="http://t-blog-images.aijs.top/img/20220613184319.webp"></p><h2 id="playground-x2F-index-html"><a href="#playground-x2F-index-html" class="headerlink" title="playground&#x2F;index.html"></a>playground&#x2F;index.html</h2><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;!DOCTYPE html&gt;&lt;!-- htmlè§£æè§„åˆ™--&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;  &lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot; &#x2F;&gt;    &lt;!-- å…³é”®å­—ç¬¦é›† --&gt;    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot; &#x2F;&gt;    &lt;!-- æ–¹ä¾¿æ‰‹æœºç«¯è°ƒæ•´åˆ†è¾¨ç‡ --&gt;    &lt;title&gt;ğŸ Pinia playground&lt;&#x2F;title&gt;    &lt;link      rel&#x3D;&quot;stylesheet&quot;      href&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;@exampledev&#x2F;new.css@1&#x2F;new.min.css&quot;    &#x2F;&gt;    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;fonts.xz.style&#x2F;serve&#x2F;inter.css&quot; &#x2F;&gt;    &lt;!-- ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ é¦–å±ä¼˜åŒ–ï¼ŒåŠ è½½åŠ¨ç”» è¿è¡Œåå‘ç°ï¼Œå¹¶ä¸æ˜¯ï¼Œä»…ä»…æ˜¯æ ·å¼è€Œå·²ï¼Œä»£ç ä¸­ä½¿ç”¨v-if æˆ–v-else-ifæ¸²æŸ“åŠ è½½åŠ¨ç”»--&gt;    &lt;!--       JokesPromised.vue       NasaPOD.vue       NasaPODwrc.vue     --&gt;    &lt;style&gt;      @keyframes spinner &#123;        to &#123;          transform: rotate(360deg);        &#125;      &#125;      .spinner:before &#123;        content: &quot;&quot;;        box-sizing: border-box;        position: absolute;        top: 50%;        left: 50%;        width: 30px;        height: 30px;        margin-top: -15px;        margin-left: -15px;        border-radius: 50%;        border: 1px solid #ccc;        border-top-color: #07d;        animation: spinner 0.6s linear infinite;      &#125;    &lt;&#x2F;style&gt;  &lt;&#x2F;head&gt;  &lt;body&gt;    &lt;!-- vueæ ¹èŠ‚ç‚¹ --&gt;    &lt;div id&#x3D;&quot;app&quot;&gt;&lt;&#x2F;div&gt;    &lt;!-- æ¨¡å—åŠ è½½ --&gt;    &lt;script type&#x3D;&quot;module&quot; src&#x3D;&quot;&#x2F;src&#x2F;main.ts&quot;&gt;&lt;&#x2F;script&gt;  &lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><h2 id="api-ç›®å½•"><a href="#api-ç›®å½•" class="headerlink" title="api ç›®å½•"></a>api ç›®å½•</h2><p>ä¸€äº›å°ç»ƒä¹ ï¼Œdemo ä¹‹ç±»çš„ä¸œè¥¿ï¼Œæˆ‘æœ‰ç‚¹ä¸æ˜ç™½çš„æ˜¯ï¼Œ<code>pinia/packages/playground/src/api</code>ä¸‹ä½¿ç”¨äº†<code>mande</code>,ä¸èƒ½ç›´æ¥ç”¨<code>fetch</code>å—?</p><ul><li><code>mande</code><strong>Requires fetch support.</strong></li><li>Weekly Downloads 530 ğŸ˜“</li><li>Unpacked Size 47.3 kB<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¸ºäº†ç‚«æŠ€è€Œå†™çš„ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰ç”¨<code>fetch</code>ï¼Œè€Œæ˜¯ç”¨äº†<code>mande</code>ã€‚â€”â€”æ­¤å¤„ AI è‡ªåŠ¨ç”Ÿæˆ</p></blockquote></li></ul><h2 id="composables-ç›®å½•"><a href="#composables-ç›®å½•" class="headerlink" title="composables ç›®å½•"></a>composables ç›®å½•</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; useCachedRequest.ts&#x2F;&#x2F; pinia&#x2F;packages&#x2F;playground&#x2F;src&#x2F;composables&#x2F;useCachedRequest.tsexport function useCachedRequest&lt;T, U&gt;(  keySource: Ref&lt;U&gt;,  getter: (key: U) &#x3D;&gt; Promise&lt;T&gt; &#x2F;&#x2F; è¿™åº”è¯¥æ˜¯ä¸€ä¸ªæ¥å£) &#123;  const data &#x3D; ref&lt;T&gt;(); &#x2F;&#x2F; å­˜æ•°æ®  const isLoading &#x3D; ref(false); &#x2F;&#x2F; åŠ è½½åŠ¨ç”»  const isReady &#x3D; ref(false); &#x2F;&#x2F; æ˜¯å¦å·²åŠ è½½æ•°æ®  const error &#x3D; ref&lt;Error | undefined&gt;(); &#x2F;&#x2F; æœ‰æ²¡æœ‰å‡ºé”™  const cache &#x3D; new Map&lt;U, T&gt;(); &#x2F;&#x2F; ä½¿ç”¨mapå®ç°ç¼“å­˜  onScopeDispose(() &#x3D;&gt; &#123;    &#x2F;&#x2F; æ¸…ç†ç¼“å­˜    cache.clear();  &#125;);  watchEffect(async () &#x3D;&gt; &#123;    const key &#x3D; unref(keySource);    isReady.value &#x3D; false; &#x2F;&#x2F; æ˜¯ä¸æ˜¯å·²æ‹¿åˆ°æ•°æ®    isLoading.value &#x3D; true; &#x2F;&#x2F; åŠ è½½åŠ¨ç”»    if (cache.has(key)) &#123;      data.value &#x3D; cache.get(key)!;      isReady.value &#x3D; true;    &#125;    getter(key)      .then((newData) &#x3D;&gt; &#123;        cache.set(key, newData);        data.value &#x3D; newData;        isReady.value &#x3D; true;      &#125;)      .catch((err) &#x3D;&gt; &#123;        error.value &#x3D; err;      &#125;)      .finally(() &#x3D;&gt; &#123;        isLoading.value &#x3D; false;      &#125;);  &#125;);  return &#123; data, error, isLoading, isReady &#125;; &#x2F;&#x2F; æœ€åå°†è¿™äº›å€¼è¿”å›&#125;</code></pre><hr/><h2 style="text-aligin:center">å°æ’æ›²</h2><p><strong>onScopeDispose</strong></p><p>è¿™ä¸ª api æ²¡è§è¿‡ï¼Œæœä¸‹å…¶ä»–äººæ˜¯æ€ä¹ˆç†è§£çš„</p><p>åœ¨ vue3.2 ä¸­æ–°å¢äº†ä¸€ä¸ªå±æ€§ EffectScopeï¼Œå®˜æ–¹æ–‡æ¡£çš„è§£é‡Šæ¯”è¾ƒç®€å•ï¼Œåªè¯´æ˜¯ä¸€ä¸ªé«˜çº§å±æ€§ï¼Œå¹¶æ²¡æœ‰å…·ä½“çš„ç¤ºä¾‹ã€‚</p><p>antfu å¤§ç¥çš„ vueuse æ¡†æ¶æºç ï¼Œé‡Œé¢å¤§é‡ä½¿ç”¨ EffectScopeï¼Œæ‰€ä»¥ç ”ç©¶äº†ä¸€ä¸‹è¿™ä¸ªå±æ€§çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-EffectScope"><a href="#ä»€ä¹ˆæ˜¯-EffectScope" class="headerlink" title="ä»€ä¹ˆæ˜¯ EffectScope?"></a>ä»€ä¹ˆæ˜¯ EffectScope?</h2><p>ä¸‹é¢æ˜¯å®˜æ–¹æ–‡æ¡£è§£é‡Šï¼Œæ„Ÿè§‰æœ‰ç‚¹æ•·è¡</p><p>Effect scope is an advanced API primarily intended for library authors. For details on how to leverage this API, please consult its corresponding RFC(opens new window).<br>è¿™ä¸ª api æ˜¯é«˜çº§çš„ï¼Œä¸»è¦ç”¨äºåº“çš„å¼€å‘è€…ã€‚æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚è€ƒå…¶å¯¹åº”çš„ RFC(æ–°çª—å£æ‰“å¼€)ã€‚</p><p>RFC å…³äº EffectScopeApi çš„è§£é‡Š</p><p>åœ¨ Vue çš„ setup ä¸­ï¼Œå“åº”ä¼šåœ¨å¼€å§‹åˆå§‹åŒ–çš„æ—¶å€™è¢«æ”¶é›†ï¼Œåœ¨å®ä¾‹è¢«å¸è½½çš„æ—¶å€™ï¼Œå“åº”å°±ä¼šè‡ªåŠ¨çš„è¢«å–æ¶ˆè¿½è¸ªäº†ï¼Œè¿™æ—¶ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„ç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬åœ¨ç»„ä»¶å¤–ä½¿ç”¨æˆ–è€…ç¼–å†™ä¸€ä¸ªç‹¬ç«‹çš„åŒ…æ—¶ï¼Œè¿™ä¼šå˜å¾—éå¸¸éº»çƒ¦ã€‚å½“åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬è¯¥<strong>å¦‚ä½•åœæ­¢ computed &amp; watch çš„å“åº”å¼ä¾èµ–å‘¢ï¼Ÿ</strong></p><p>å®é™…ä¸Š EffectScope æŒ‰æˆ‘çš„ç†è§£å°±æ˜¯å‰¯ä½œç”¨ç”Ÿæ•ˆçš„ä½œç”¨åŸŸã€‚</p><p>vue3 å¯¹å“åº”å¼çš„ç›‘å¬æ˜¯é€šè¿‡ effect å®ç°çš„ï¼Œå½“æˆ‘ä»¬çš„ç»„ä»¶é”€æ¯çš„æ—¶å€™ vue ä¼šè‡ªåŠ¨å–æ¶ˆè¯¥ç»„ä»¶çš„ effectã€‚</p><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦è‡ªå·±æ§åˆ¶ effect ç”Ÿæ•ˆä¸å¦å‘¢ï¼Ÿ æ¯”å¦‚æˆ‘åªæƒ³åœ¨è«ç§ç‰¹å®šæƒ…å†µä¸‹æ‰ç›‘å¬æ‘¸ä¸ª refï¼Œå…¶ä»–æƒ…å†µä¸‹ä¸æƒ³ç›‘å¬è¯¥æ€ä¹ˆåšï¼Ÿ</p><p>vue3.2 ä¹‹å‰</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F;ï¼ˆvue-RFCç¤ºä¾‹ä»£ç ï¼‰const disposables &#x3D; [];const counter &#x3D; ref(0);const doubled &#x3D; computed(() &#x3D;&gt; counter.value * 2);disposables.push(() &#x3D;&gt; stop(doubled.effect));const stopWatch1 &#x3D; watchEffect(() &#x3D;&gt; &#123;  console.log(&#96;counter: $&#123;counter.value&#125;&#96;);&#125;);disposables.push(stopWatch1);const stopWatch2 &#x3D; watch(doubled, () &#x3D;&gt; &#123;  console.log(doubled.value);&#125;);disposables.push(stopWatch2);</code></pre><h2 id="EffectScope-å¦‚ä½•å®ç°"><a href="#EffectScope-å¦‚ä½•å®ç°" class="headerlink" title="EffectScope å¦‚ä½•å®ç°"></a>EffectScope å¦‚ä½•å®ç°</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; effect, computed, watch, watchEffect created inside the scope will be collectedconst scope &#x3D; effectScope();scope.run(() &#x3D;&gt; &#123;  const doubled &#x3D; computed(() &#x3D;&gt; counter.value * 2);  watch(doubled, () &#x3D;&gt; console.log(doubled.value));  watchEffect(() &#x3D;&gt; console.log(&quot;Count: &quot;, doubled.value));&#125;);&#x2F;&#x2F; to dispose all effects in the scopescope.stop();</code></pre><p>ç¤ºä¾‹;</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const scope &#x3D; effectScope();let counter &#x3D; ref(0);setInterval(() &#x3D;&gt; &#123;  counter.value++;&#125;, 1000);scope.run(() &#x3D;&gt; &#123;  watchEffect(() &#x3D;&gt; console.log(&#96;counter: $&#123;counter.value&#125;&#96;));&#125;);&#x2F;*log:counter: 0counter: 1counter: 2counter: 3counter: 4counter: 5*&#x2F;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const scope &#x3D; effectScope();let counter &#x3D; ref(0);setInterval(() &#x3D;&gt; &#123;  counter.value++;&#125;, 1000);scope.run(() &#x3D;&gt; &#123;  watchEffect(() &#x3D;&gt; console.log(&#96;counter: $&#123;counter.value&#125;&#96;));&#125;);scope.stop();&#x2F;*log:counter: 0*&#x2F;</code></pre><p>åŸºæœ¬ä½¿ç”¨<br>æ–°å»ºä¸€ä¸ª scope:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const scope &#x3D; effectScope();</code></pre><p>ä¸€ä¸ª scope å¯ä»¥æ‰§è¡Œä¸€ä¸ª run å‡½æ•°ï¼ˆæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›è¯¥å‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼Œå¹¶ä¸”æ•è·æ‰€æœ‰åœ¨è¯¥å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ›å»ºçš„ effect ï¼ŒåŒ…æ‹¬å¯ä»¥åˆ›å»º effect çš„ APIï¼Œä¾‹å¦‚ computed , watch , watchEffect :</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">scope.run(() &#x3D;&gt; &#123;  const doubled &#x3D; computed(() &#x3D;&gt; counter.value * 2);  watch(doubled, () &#x3D;&gt; console.log(doubled.value));  watchEffect(() &#x3D;&gt; console.log(&quot;Count: &quot;, doubled.value));&#125;);&#x2F;&#x2F; the same scope can run multiple timesscope.run(() &#x3D;&gt; &#123;  watch(counter, () &#x3D;&gt; &#123;    &#x2F;*...*&#x2F;  &#125;);&#125;);</code></pre><p>å½“è°ƒç”¨ scope.stop(), æ‰€æœ‰è¢«æ•è·çš„ effect éƒ½ä¼šè¢«å–æ¶ˆï¼ŒåŒ…æ‹¬ nested Scopes ä¹Ÿä¼šè¢«é€’å½’å–æ¶ˆ</p><h2 id="Nested-Scopes"><a href="#Nested-Scopes" class="headerlink" title="Nested Scopes"></a>Nested Scopes</h2><p>åµŒå¥— scope ä¹Ÿä¼šè¢«ä»–ä»¬çš„çˆ¶çº§ scope æ”¶é›†ã€‚å¹¶ä¸”å½“çˆ¶çº§ scope é”€æ¯çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åä»£ scope ä¹Ÿä¼šè¢«é€’å½’é”€æ¯ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const scope &#x3D; effectScope();scope.run(() &#x3D;&gt; &#123;  const doubled &#x3D; computed(() &#x3D;&gt; counter.value * 2);  &#x2F;&#x2F; not need to get the stop handler, it will be collected by the outer scope  effectScope().run(() &#x3D;&gt; &#123;    watch(doubled, () &#x3D;&gt; console.log(doubled.value));  &#125;);  watchEffect(() &#x3D;&gt; console.log(&quot;Count: &quot;, doubled.value));&#125;);&#x2F;&#x2F; dispose all effects, including those in the nested scopesscope.stop();</code></pre><h2 id="Detached-Nested-Scopes"><a href="#Detached-Nested-Scopes" class="headerlink" title="Detached Nested Scopes"></a>Detached Nested Scopes</h2><p>effectScope æ¥å—ä¸€ä¸ªå‚æ•°å¯ä»¥åœ¨åˆ†ç¦»æ¨¡å¼ï¼ˆdetached modeï¼‰ä¸‹åˆ›å»ºã€‚ detached scope ä¸ä¼šè¢«çˆ¶çº§ collectã€‚</p><p>è¿™ä¸€ç‰¹æ€§åŒæ—¶è§£å†³äº†ä¸€ä¸ª Issues lazy Initializationã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let nestedScope;const parentScope &#x3D; effectScope();parentScope.run(() &#x3D;&gt; &#123;  const doubled &#x3D; computed(() &#x3D;&gt; counter.value * 2);  &#x2F;&#x2F; with the detected flag,  &#x2F;&#x2F; the scope will not be collected and disposed by the outer scope  nestedScope &#x3D; effectScope(true &#x2F;* detached *&#x2F;);  nestedScope.run(() &#x3D;&gt; &#123;    watch(doubled, () &#x3D;&gt; console.log(doubled.value));  &#125;);  watchEffect(() &#x3D;&gt; console.log(&quot;Count: &quot;, doubled.value));&#125;);&#x2F;&#x2F; disposes all effects, but not &#96;nestedScope&#96;parentScope.stop();&#x2F;&#x2F; stop the nested scope only when appropriatenestedScope.stop();</code></pre><p>onScopeDispose<br>å…¨å±€é’©å­å‡½æ•° onScopeDispose æä¾›äº†ç±»ä¼¼äº onUnmounted çš„åŠŸèƒ½ï¼Œä¸åŒçš„æ˜¯å®ƒå·¥ä½œåœ¨ scope ä¸­è€Œä¸æ˜¯å½“å‰ instanceã€‚</p><p>è¿™ä½¿å¾— composable functions å¯ä»¥é€šè¿‡ä»–ä»¬çš„ scope æ¸…é™¤ä»–ä»¬çš„å‰¯ä½œç”¨ã€‚</p><p>ç”±äº setup() é»˜è®¤ä¼šä¸ºå½“å‰ instance åˆ›å»ºä¸€ä¸ª scopeï¼Œæ‰€ä»¥å½“æ²¡æœ‰æ˜ç¡®å£°æ˜ä¸€ä¸ª scope çš„æ—¶å€™ï¼ŒonScopeDispose ç­‰åŒäº onUnmountedã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; onScopeDispose &#125; from &quot;vue&quot;;const scope &#x3D; effectScope();scope.run(() &#x3D;&gt; &#123;  onScopeDispose(() &#x3D;&gt; &#123;    console.log(&quot;cleaned!&quot;);  &#125;);&#125;);scope.stop(); &#x2F;&#x2F; logs &#39;cleaned!&#39;</code></pre><p>Getting the current Scope</p><p>é€šè¿‡ getCurrentScope() å¯ä»¥è·å–å½“å‰ scope</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; getCurrentScope &#125; from &quot;vue&quot;;getCurrentScope(); &#x2F;&#x2F; EffectScope | undefined</code></pre><p>å®æˆ˜<br>ç¤ºä¾‹ï¼šShared Composable<br>ä¸€äº› composables ä¼šè®¾ç½®å…¨å±€å‰¯ä½œç”¨ï¼Œä¾‹å¦‚å¦‚ä¸‹çš„ useMouse() function:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function useMouse() &#123;  const x &#x3D; ref(0);  const y &#x3D; ref(0);  window.addEventListener(&quot;mousemove&quot;, handler);  function handler(e) &#123;    x.value &#x3D; e.x;    y.value &#x3D; e.y;  &#125;  onUnmounted(() &#x3D;&gt; &#123;    window.removeEventListener(&quot;mousemove&quot;, handler);  &#125;);  return &#123; x, y &#125;;&#125;</code></pre><p>å¦‚æœåœ¨å¤šä¸ªç»„ä»¶ä¸­è°ƒç”¨ useMouse () ï¼Œåˆ™æ¯ä¸ªç»„ä»¶å°†é™„åŠ ä¸€ä¸ª mouseemove ç›‘å¬å™¨ï¼Œå¹¶åˆ›å»ºè‡ªå·±çš„ x å’Œ y refs å‰¯æœ¬ã€‚æˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿé€šè¿‡åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«ç›¸åŒçš„ä¾¦å¬å™¨é›†å’Œ refs æ¥æé«˜æ•ˆç‡ï¼Œä½†æ˜¯æˆ‘ä»¬åšä¸åˆ°ï¼Œå› ä¸ºæ¯ä¸ª onUnmounted è°ƒç”¨éƒ½è€¦åˆåˆ°ä¸€ä¸ªç»„ä»¶å®ä¾‹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ†ç¦»ä½œç”¨åŸŸå’Œ onScopeDispose æ¥å®ç°è¿™ä¸€ç‚¹, é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”¨ onScopeDispose æ›¿æ¢ onUnmounted</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">- onUnmounted(() &#x3D;&gt; &#123;* onScopeDispose(() &#x3D;&gt; &#123;  window.removeEventListener(&#39;mousemove&#39;, handler)  &#125;)</code></pre><p>è¿™ä»ç„¶æœ‰æ•ˆï¼Œå› ä¸º Vue ç»„ä»¶ç°åœ¨ä¹Ÿåœ¨ä½œç”¨åŸŸå†…è¿è¡Œå…¶ setup () ï¼Œè¯¥ä½œç”¨åŸŸå°†åœ¨ç»„ä»¶å¸è½½æ—¶é‡Šæ”¾ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå·¥å…·å‡½æ•°æ¥ç®¡ç†çˆ¶èŒƒå›´è®¢é˜…:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function createSharedComposable(composable) &#123;  let subscribers &#x3D; 0;  let state, scope;  const dispose &#x3D; () &#x3D;&gt; &#123;    if (scope &amp;&amp; --subscribers &lt;&#x3D; 0) &#123;      scope.stop();      state &#x3D; scope &#x3D; null;    &#125;  &#125;;  &#x2F;&#x2F; è¿™é‡Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è¿è¡Œçš„æ—¶å€™åˆ›å»ºä¸€ä¸ª state, åé¢æ‰€æœ‰çš„ç»„ä»¶å°±ä¸ä¼šå†åˆ›å»ºæ–°çš„ stateï¼Œè€Œæ˜¯å…±ç”¨ä¸€ä¸ª state  return (...args) &#x3D;&gt; &#123;    subscribers++;    if (!state) &#123;      scope &#x3D; effectScope(true);      state &#x3D; scope.run(() &#x3D;&gt; composable(...args));    &#125;    onScopeDispose(dispose);    return state;  &#125;;&#125;</code></pre><p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª shared ç‰ˆæœ¬çš„ useMouse</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const useSharedMouse &#x3D; createSharedComposable(useMouse);</code></pre><p>é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä¸ç¦æƒ³åˆ°ï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡è¿™ç§æ¨¡å¼æ¨¡æ‹Ÿ vuex çš„èƒ½åŠ›ï¼Ÿæˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡ shared composables æ›´åŠ çµæ´»çš„è¾¾åˆ°å…¨å±€çŠ¶æ€ç®¡ç†çš„ç›®çš„å‘¢ï¼Ÿ</p><p>ä½œè€…ï¼šzifeiyu<br>é“¾æ¥ï¼š<a href="https://juejin.cn/post/7019241635942760455">https://juejin.cn/post/7019241635942760455</a></p><p>æ€»ç»“ï¼šè¯´äº†ä¸€å¤§å †ï¼Œå¤§æ¦‚æ„æ€æ˜¯æä¾›åœ¨ç»„ä»¶å¤–è¿›è¡Œå‰¯ä½œç”¨æ¸…ç†çš„ apiï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´ç»™åº“çš„å¼€å‘è€…ä½¿ç”¨</p><hr/><h2 id="stores-ç›®å½•ï¼Œå¯¹åº”-v2-çš„-vuex"><a href="#stores-ç›®å½•ï¼Œå¯¹åº”-v2-çš„-vuex" class="headerlink" title="stores ç›®å½•ï¼Œå¯¹åº” v2 çš„ vuex"></a>stores ç›®å½•ï¼Œå¯¹åº” v2 çš„ vuex</h2><p>ä¸€ä¸ªè´­ç‰©è½¦çš„ä¾‹å­</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; .&#x2F;&#x2F; â”œâ”€â”€ cart.ts&#x2F;&#x2F; â”œâ”€â”€ counter.ts&#x2F;&#x2F; â”œâ”€â”€ counterSetup.ts&#x2F;&#x2F; â”œâ”€â”€ demo-counter.ts&#x2F;&#x2F; â”œâ”€â”€ jokes-swrv.ts&#x2F;&#x2F; â”œâ”€â”€ jokes.ts&#x2F;&#x2F; â”œâ”€â”€ jokesUsePromised.ts&#x2F;&#x2F; â”œâ”€â”€ nasa-pod.ts&#x2F;&#x2F; â”œâ”€â”€ nasa.ts&#x2F;&#x2F; â””â”€â”€ user.ts</code></pre><p><strong>user.ts</strong></p><p>å®šä¹‰ useUserStoreï¼Œid ä¸ºâ€˜userâ€™, state ä¸¤ä¸ªå­—æ®µï¼Œ<br>actions 1. ç™»å½•ï¼Œè°ƒç”¨çš„æ˜¯ apiLogin æ¥å£ï¼Œè°ƒç”¨æˆåŠŸåè¿›è¡Œæ•°æ®<code>this.$patch</code>æ‰¹é‡æ›´æ–°<br>actions 2. é€€å‡ºç™»å½•</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; defineStore &#125; from &quot;pinia&quot;;export const useUserStore &#x3D; defineStore(&quot;user&quot;, &#123;  state: () &#x3D;&gt; (&#123;    name: &quot;Eduardo&quot;,    isAdmin: true,  &#125;),  actions: &#123;    &#x2F;**     * Attempt to login a user     *&#x2F;    async login(user: string, password: string) &#123;      const userData &#x3D; await apiLogin(user, password);      this.$patch(&#123;        name: user,        ...userData,      &#125;);    &#125;,    logout() &#123;      this.$patch(&#123;        name: &quot;&quot;,        isAdmin: false,      &#125;);      &#x2F;&#x2F; we could do other stuff like redirecting the user    &#125;,  &#125;,&#125;);&#x2F;** * Simulate a login æ¨¡æ‹Ÿç™»å½• *&#x2F;function apiLogin(a: string, p: string) &#123;  if (a &#x3D;&#x3D;&#x3D; &quot;ed&quot; &amp;&amp; p &#x3D;&#x3D;&#x3D; &quot;ed&quot;) return Promise.resolve(&#123; isAdmin: true &#125;); &#x2F;&#x2F; ç®¡ç†å‘˜  if (p &#x3D;&#x3D;&#x3D; &quot;ed&quot;) return Promise.resolve(&#123; isAdmin: false &#125;); &#x2F;&#x2F; éç®¡ç†å‘˜  return Promise.reject(new Error(&quot;invalid credentials&quot;)); &#x2F;&#x2F; æ¸¸å®¢æœªè®¤è¯&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; counter.tsimport &#123; acceptHMRUpdate, defineStore &#125; from &quot;pinia&quot;;const delay &#x3D; (t: number) &#x3D;&gt; new Promise((r) &#x3D;&gt; setTimeout(r, t));export const useCounter &#x3D; defineStore(&#123;  id: &quot;counter&quot;,  state: () &#x3D;&gt; (&#123;    n: 2,    incrementedTimes: 0,    decrementedTimes: 0,    numbers: [] as number[],  &#125;),  getters: &#123;    double: (state) &#x3D;&gt; state.n * 2,  &#125;,  actions: &#123;    increment(amount &#x3D; 1) &#123;      if (typeof amount !&#x3D;&#x3D; &quot;number&quot;) &#123;        amount &#x3D; 1;      &#125;      this.incrementedTimes++;      this.n +&#x3D; amount;    &#125;,    changeMe() &#123;      console.log(&quot;change me to test HMR&quot;);    &#125;,    async fail() &#123;      const n &#x3D; this.n;      await delay(1000);      this.numbers.push(n);      await delay(1000);      if (this.n !&#x3D;&#x3D; n) &#123;        throw new Error(&quot;Someone changed n!&quot;);      &#125;      return n;    &#125;,    async decrementToZero(interval: number &#x3D; 300, usePatch &#x3D; true) &#123;      if (this.n &lt;&#x3D; 0) return;      while (this.n &gt; 0) &#123;        if (usePatch) &#123;          this.$patch(&#123;            &#x2F;&#x2F; è¿™ä¸ªå°±æ¯”è¾ƒå¥‡æ€ªäº†ï¼Œæˆ‘ä¸¥é‡æ€€ç–‘è¿™é‡Œçš„(usePatch &#x3D; true ä¸ usePatch &#x3D; false)æ•°æ®ä¸ä¸€è‡´            n: this.n - 1,            decrementedTimes: this.decrementedTimes + 1,          &#125;);          &#x2F;&#x2F; this.$patch(state &#x3D;&gt; &#123;          &#x2F;&#x2F;   state.n--          &#x2F;&#x2F;   state.decrementedTimes++          &#x2F;&#x2F; &#125;)        &#125; else &#123;          this.n -&#x3D; 1;        &#125;        await delay(interval);      &#125;    &#125;,  &#125;,&#125;);&#x2F;&#x2F; è¿™ä¸ªåœ°æ–¹æ²¡çœ‹æ‡‚.if (import.meta.hot) &#123;  &#x2F;&#x2F; @link: https:&#x2F;&#x2F;www.jb51.net&#x2F;article&#x2F;244749.htm  &#x2F;&#x2F; import.meta æ˜¯ä¸€ä¸ªç»™ JavaScript æ¨¡å—æš´éœ²ç‰¹å®šä¸Šä¸‹æ–‡çš„å…ƒæ•°æ®å±æ€§çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†è¿™ä¸ªæ¨¡å—çš„ä¿¡æ¯ã€‚  &#x2F;&#x2F; Pinia æ˜¯ vuex æ–°æ›¿ä»£æ–¹æ¡ˆã€‚Pinia ä¸­çƒ­æ›´æ–°å®ç°ï¼Œå€ŸåŠ© import.metaã€‚  import.meta.hot.accept(acceptHMRUpdate(useCounter, import.meta.hot));&#125;</code></pre><p>counterSetup.ts ç»“åˆ vue åšäº†å¾ˆå¤šæ“ä½œï¼Œæœ€ååªè¿”å›äº†ä¸€ä¸ª state,æ²¡æœ‰ getters,actions<br>ä»¥ä¸‹ä¸º state ä¸Šçš„æ–¹æ³•</p><ul><li>double,</li><li>increment,</li><li>fail,</li><li>changeMe,</li><li>decrementToZero,</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; counterSetupimport &#123; computed, toRefs, reactive &#125; from &quot;vue&quot;;import &#123; acceptHMRUpdate, defineStore &#125; from &quot;pinia&quot;;const delay &#x3D; (t: number) &#x3D;&gt; new Promise((r) &#x3D;&gt; setTimeout(r, t));export const useCounter &#x3D; defineStore(&quot;counter-setup&quot;, () &#x3D;&gt; &#123;  const state &#x3D; reactive(&#123;    &#x2F;&#x2F; vue    n: 0,    incrementedTimes: 0,    decrementedTimes: 0,    numbers: [] as number[],  &#125;);  const double &#x3D; computed(() &#x3D;&gt; state.n * 2); &#x2F;&#x2F; vue  function increment(amount &#x3D; 1) &#123;    if (typeof amount !&#x3D;&#x3D; &quot;number&quot;) &#123;      amount &#x3D; 1;    &#125;    state.incrementedTimes++;    state.n +&#x3D; amount;  &#125;  function changeMe() &#123;    console.log(&quot;change me to test HMR&quot;);  &#125;  &#x2F;&#x2F;  async function fail() &#123;    const n &#x3D; state.n;    await delay(1000);    state.numbers.push(n);    await delay(1000);    if (state.n !&#x3D;&#x3D; n) &#123;      throw new Error(&quot;Someone changed n!&quot;);    &#125;    return n;  &#125;  &#x2F;&#x2F; å®šæ—¶å™¨ç›´åˆ°å‡å°‘åˆ°0  async function decrementToZero(interval: number &#x3D; 300) &#123;    if (state.n &lt;&#x3D; 0) return;    while (state.n &gt; 0) &#123;      state.n -&#x3D; 1;      state.decrementedTimes +&#x3D; 1;      await delay(interval);    &#125;  &#125;  return &#123;    ...toRefs(state), &#x2F;&#x2F; vueå°† state è½¬æ¢ä¸º refsï¼Œ TODOï¼štoRefsè¿™ä¸ªä¹‹åå¯ä»¥çœ‹ä¸‹æºç åšäº†æ€æ ·çš„å¤„ç†    double,    increment,    fail,    changeMe,    decrementToZero,  &#125;;&#125;);if (import.meta.hot) &#123;  import.meta.hot.accept(acceptHMRUpdate(useCounter, import.meta.hot));&#125;</code></pre><p>demo-counter.ts åªè¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°ç®€å†™çš„state</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; demo-counter.tsimport &#123; defineStore, acceptHMRUpdate &#125; from &#39;pinia&#39;const delay &#x3D; (t: number) &#x3D;&gt; new Promise((r) &#x3D;&gt; setTimeout(r, t))&#x2F;&#x2F; just to ignore the not used errordelay(0)export const useCounter &#x3D; defineStore(&#39;demo-counter&#39;, &#123;  state: () &#x3D;&gt; (&#123;    n: 0,  &#125;),&#125;)if (import.meta.hot) &#123;  import.meta.hot.accept(acceptHMRUpdate(useCounter, import.meta.hot))&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; jokes-swrv.tsimport &#123; ref, toRaw, watch &#125; from &#39;vue&#39;import &#123; acceptHMRUpdate, defineStore &#125; from &#39;pinia&#39;import &#123; getRandomJoke, Joke &#125; from &#39;..&#x2F;api&#x2F;jokes&#39;import useSWRV from &#39;swrv&#39; &#x2F;&#x2F; @link https:&#x2F;&#x2F;www.npmjs.com&#x2F;package&#x2F;swrvexport const useJokesSetup &#x3D; defineStore(&#39;jokes-swrv-setup&#39;, () &#x3D;&gt; &#123;  &#x2F;&#x2F; const current &#x3D; ref&lt;null | Joke&gt;(null)  const history &#x3D; ref&lt;Joke[]&gt;([])  &#x2F;&#x2F; useSWRV vueç»„åˆå¼ç½‘ç»œè¯·æ±‚ï¼Œä¹‹å‰äº†è§£ä»£ç &#96;pinia&#x2F;packages&#x2F;playground&#x2F;src&#x2F;api&#96; ä¸­ä½¿ç”¨äº†â€˜mandeâ€™ï¼Œåšç½‘ç»œè¯·æ±‚ï¼Œæˆ‘æƒ³è¿™åº”è¯¥æ˜¯ä½œè€…ä¸ºäº†ç»™å¼€å‘è€…æä¾›æ›´å¤šçš„åœºæ™¯æ¥å­¦ä¹ pinia  const &#123; data, error, mutate &#125; &#x3D; useSWRV(&#39;jokes&#39;, getRandomJoke)  &#x2F;&#x2F; ç›‘å¬dataå˜åŒ–  watch(data, (joke) &#x3D;&gt; &#123;    console.log(&#39;changed from within the store&#39;, joke)    if (joke) &#123;      &#x2F;&#x2F; å“åº”å¼æ•°æ®ï¼Œ  historyæ˜¯å“åº”å¼çš„ï¼Œéœ€è¦ç”¨.valueæ¥æ“ä½œ      history.value.push(toRaw(joke))    &#125;  &#125;)  return &#123; current: data, error, history, fetchJoke: mutate &#125;&#125;)if (import.meta.hot) &#123;  &#x2F;&#x2F; import.meta.hot.accept(acceptHMRUpdate(useJokes, import.meta.hot))  import.meta.hot.accept(acceptHMRUpdate(useJokesSetup, import.meta.hot))&#125;</code></pre><p> jokes.ts æ–‡ä»¶ä¸‹ï¼Œå†™äº†useJokes å’Œ useJokesSetup</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; jokes.tsimport &#123; ref, unref &#125; from &#39;vue&#39;import &#123; acceptHMRUpdate, defineStore &#125; from &#39;pinia&#39;import &#123; getRandomJoke, Joke &#125; from &#39;..&#x2F;api&#x2F;jokes&#39;export const useJokes &#x3D; defineStore(&#39;jokes&#39;, &#123;  state: () &#x3D;&gt; (&#123;    current: null as null | Joke,    jokes: [] as Joke[],    &#x2F;&#x2F; hello: true,  &#125;),  actions: &#123;    async fetchJoke() &#123;      if (        this.current &amp;&amp;        &#x2F;&#x2F; if the request below fails, avoid adding it twice        &#x2F;&#x2F; å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œå°±ä¸è¦æ·»åŠ è¿›å†å²è®°å½•        !this.jokes.includes(this.current)      ) &#123;        this.jokes.push(this.current)      &#125;      &#x2F;&#x2F; NOTE: Avoid patching an object because it&#39;s recursive      &#x2F;&#x2F; æ³¨æ„ï¼šä¸è¦æ›´æ–°ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸ºå®ƒæ˜¯é€’å½’çš„      &#x2F;&#x2F; this.$patch(&#123; current: await getRandomJoke() &#125;)      this.current &#x3D; await getRandomJoke()    &#125;,  &#125;,&#125;)export const useJokesSetup &#x3D; defineStore(&#39;jokes-setup&#39;, () &#x3D;&gt; &#123;  const current &#x3D; ref&lt;null | Joke&gt;(null)  const history &#x3D; ref&lt;Joke[]&gt;([])  async function fetchJoke() &#123;    const cur &#x3D; unref(current.value)    if (      cur &amp;&amp;      &#x2F;&#x2F; if the request below fails, avoid adding it twice      !history.value.find((joke) &#x3D;&gt; joke.id &#x3D;&#x3D;&#x3D; cur.id)    ) &#123;      history.value.push(cur)    &#125;    current.value &#x3D; await getRandomJoke()    return current.value  &#125;  return &#123; current, history, fetchJoke &#125;&#125;)if (import.meta.hot) &#123;  import.meta.hot.accept(acceptHMRUpdate(useJokes, import.meta.hot))  &#x2F;&#x2F; import.meta.hot.accept(acceptHMRUpdate(useJokesSetup, import.meta.hot))&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç  </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript event</title>
      <link href="//post/2022-06-13event.html"/>
      <url>//post/2022-06-13event.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç°è±¡æè¿°"><a href="#ç°è±¡æè¿°" class="headerlink" title="ç°è±¡æè¿°"></a>ç°è±¡æè¿°</h2><pre class="line-numbers language-none"><code class="language-none">react_devtools_backend.js:4026 Warning: This synthetic event is reused for performance reasons. If you&#39;re seeing this, you&#39;re accessing the property &#96;target&#96; on a released&#x2F;nullified synthetic event. This is set to null. If you must keep the original synthetic event around, use event.persist(). See https:&#x2F;&#x2F;fb.me&#x2F;react-event-pooling for more information.</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">event.persist();</code></pre><h2 id="ä»£ç æè¿°åŠä¿®æ”¹"><a href="#ä»£ç æè¿°åŠä¿®æ”¹" class="headerlink" title="ä»£ç æè¿°åŠä¿®æ”¹"></a>ä»£ç æè¿°åŠä¿®æ”¹</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++const handleConfirmUpload &#x3D; useCallback(async (event, index: number) &#x3D;&gt; &#123;  event.persist(); &#x2F;&#x2F; ä¸åŠ æ­¤å¤„ï¼Œå¯¼è‡´ä¸Šè¿°é—®é¢˜  setConfirmFileReplace(true);  fileReplaceCache.current &#x3D; &#123;    event,    index,  &#125;;&#125;, []);&#x2F;&#x2F; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++const handleCloseFileReplace &#x3D; useCallback(async () &#x3D;&gt; &#123;  setConfirmFileReplace(false);  fileReplaceCache.current &#x3D; null;&#125;, []);&#x2F;&#x2F; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++const handleConfirmFileReplace &#x3D; useCallback(async () &#x3D;&gt; &#123;  if (fileReplaceCache.current) &#123;    handleUploadChange(      fileReplaceCache.current?.event,      fileReplaceCache.current?.index    );  &#125;&#125;, [fileReplaceCache.current]);&#x2F;&#x2F; ä¸ºäº†ä¿è¯æ­¤å‡½æ•°å†…éƒ¨ä¸å˜const handleUploadChange &#x3D; useCallback(async (event, index: number) &#x3D;&gt; &#123;  const files &#x3D; event.target?.files;  if (!files || files?.length &#x3D;&#x3D;&#x3D; 0) return;&#125;, []);</code></pre><h2 id="åŸå› åˆ†æ"><a href="#åŸå› åˆ†æ" class="headerlink" title="åŸå› åˆ†æ"></a>åŸå› åˆ†æ</h2><p>ç‚¹å‡» <a href="https://fb.me/react-event-pooling" target="_blank" >æŸ¥çœ‹é“¾æ¥æç¤º</a></p><p><strong>Event Pooling</strong></p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>This page is only relevant for React 16 and earlier, and for React Native.<br>è¿™ä¸ªé¡µé¢åªé€‚ç”¨äº React 16 å’Œæ›´æ—©çš„ç‰ˆæœ¬ï¼Œä»¥åŠ React Nativeã€‚<br>React 17 on the web does not use event pooling.<br>React17 åœ¨webä¸­æ²¡æœ‰ä½¿ç”¨äº‹ä»¶å¾ªç¯<br>Read more about this change in React 17.</div><p>The SyntheticEvent objects are pooled. This means that the SyntheticEvent object will be reused and all properties will be nullified after the event handler has been called. For example, this wonâ€™t work:<br><em>SyntheticEventå¯¹è±¡è¢«åˆå¹¶ã€‚è¿™æ„å‘³ç€å°†é‡ç”¨SyntheticEventå¯¹è±¡ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºåï¼Œæ‰€æœ‰å±æ€§éƒ½å°†ä¸ºnullã€‚ä¾‹å¦‚ï¼Œè¿™å°†ä¸èµ·ä½œç”¨ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function handleChange(e) &#123;  &#x2F;&#x2F; This won&#39;t work because the event object gets reused.  &#x2F;&#x2F; è¿™ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºäº‹ä»¶å¯¹è±¡è¢«é‡ç”¨äº†ã€‚  setTimeout(() &#x3D;&gt; &#123;    console.log(e.target.value); &#x2F;&#x2F; Too late! å¤ªè¿Ÿäº†  &#125;, 100);&#125;</code></pre><p>If you need to access event objectâ€™s properties after the event handler has run, you need to call e.persist():<br><em>å¦‚æœéœ€è¦åœ¨äº‹ä»¶å¤„ç†ç¨‹åºè¿è¡Œåè®¿é—®äº‹ä»¶å¯¹è±¡çš„å±æ€§ï¼Œåˆ™éœ€è¦è°ƒç”¨<code>e.persist()</code>ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function handleChange(e) &#123;  &#x2F;&#x2F; Prevents React from resetting its properties:  &#x2F;&#x2F; é˜»æ­¢Reacté‡ç½®å…¶å±æ€§  e.persist();  setTimeout(() &#x3D;&gt; &#123;    console.log(e.target.value); &#x2F;&#x2F; Works æ²¡é—®é¢˜  &#125;, 100);&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue Pinia</title>
      <link href="//post/2022-06-10vue-pinia.html"/>
      <url>//post/2022-06-10vue-pinia.html</url>
      
        <content type="html"><![CDATA[<h2 id="Pinia-ç‰¹ç‚¹"><a href="#Pinia-ç‰¹ç‚¹" class="headerlink" title="Pinia ç‰¹ç‚¹"></a>Pinia ç‰¹ç‚¹</h2><p><strong>ğŸ’¡ Intuitive</strong><br><code>ç›´è§‚çš„</code><br>Stores are as familiar as components. API designed to let you write well organized stores.<br><code>å­˜å‚¨å’Œç»„ä»¶æ˜¯ä¸€æ ·çš„ã€‚APIè®¾è®¡äº†è®©ä½ å†™å¥½ç»„ç»‡çš„å­˜å‚¨ã€‚</code></p><p><strong>ğŸ”‘ Type Safe</strong><br><code>ç±»å‹å®‰å…¨çš„</code><br>Types are inferred, which means stores provide you with autocompletion even in JavaScript!<br><code>ç±»å‹å¯æ¨æµ‹ï¼Œè¿™æ„å‘³ç€å­˜å‚¨æä¾›äº†ä½ åœ¨JavaScriptä¸­è‡ªåŠ¨å®Œæˆçš„åŠŸèƒ½ï¼</code></p><p><strong>âš™ï¸ Devtools support</strong><br><code>å¼€å‘å·¥å…·æ”¯æŒ</code><br>Pinia hooks into Vue devtools to give you an enhanced development experience in both Vue 2 and Vue 3.<br><code>Piniaé’©å­è¿›å…¥Vueå¼€å‘å·¥å…·ï¼Œè®©ä½ åœ¨Vue 2å’ŒVue 3ä¸­è·å¾—å¼ºåŒ–å¼€å‘ç»éªŒã€‚</code></p><p><strong>ğŸ”Œ Extensible</strong><br><code>å¯æ‰©å±•çš„</code><br>React to store changes to extend Pinia with transactions, local storage synchronization, etc.<br><code>é€šè¿‡äº‹åŠ¡ã€æœ¬åœ°å­˜å‚¨åŒæ­¥ç­‰æ¥å“åº”å­˜å‚¨æ›´æ”¹ä»¥æ‰©å±•Piniaã€‚</code></p><p><strong>ğŸ— Modular by design</strong><br><code>è®¾è®¡æ¨¡å—åŒ–</code><br>Build multiple stores and let your bundler code split them automatically.<br><code>æ„å»ºå¤šä¸ªå­˜å‚¨ï¼Œè®©ä½ çš„bundlerä»£ç åˆ†å¼€å®ƒä»¬è‡ªåŠ¨ã€‚</code></p><p><strong>ğŸ“¦ Extremely light</strong><br><code>éå¸¸è½»é‡çš„</code><br>Pinia weighs around 1kb, you will forget itâ€™s even there!<br><code>Piniaçº¦1kbï¼Œä½ ä¼šå¿˜è®°å®ƒåœ¨é‚£é‡Œï¼</code></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><code>ä»‹ç»</code></p><p><VueSchoolLink  href="https://vueschool.io/lessons/introduction-to-pinia"  title="Get started with Pinia"/></p><p>Pinia <a href="https://github.com/vuejs/pinia/commit/06aeef54e2cad66696063c62829dac74e15fd19e">started</a> as an experiment to redesign what a Store for Vue could look like with the <a href="https://github.com/vuejs/composition-api">Composition API</a> around November 2019. Since then, the initial principles are still the same, but Pinia works for both Vue 2 and Vue 3 <strong>and doesnâ€™t require you to use the composition API</strong>. The API is the same for both except for <em>installation</em> and <em>SSR</em>, and these docs are targeted to Vue 3 <strong>with notes about Vue 2</strong> whenever necessary so it can be read by Vue 2 and Vue 3 users!</p><p><em>è¯‘ï¼šPinia ä» 2019 å¹´ 11 æœˆå·¦å³å¼€å§‹å°è¯•é‡æ–°è®¾è®¡ Vue store çš„åˆæˆ APIã€‚ä»é‚£æ—¶èµ·ï¼Œæœ€åˆçš„åŸåˆ™ä»ç„¶æ˜¯ä¸€æ ·çš„ï¼Œä½† Pinia åŒæ—¶é€‚ç”¨äº Vue 2 å’Œ Vue 3ï¼Œä¸éœ€è¦æ‚¨ä½¿ç”¨åˆæˆ APIã€‚é™¤äº†å®‰è£…å’Œ SSR ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ª API éƒ½æ˜¯ç›¸åŒçš„ï¼Œè¿™äº›æ–‡æ¡£é’ˆå¯¹ Vue 3ï¼Œå¹¶åœ¨å¿…è¦æ—¶æä¾›æœ‰å…³ Vue 2 çš„è¯´æ˜ï¼Œä»¥ä¾¿ Vue 2 å’Œ Vue 3 ç”¨æˆ·å¯ä»¥é˜…è¯»ï¼</em></p><p><strong>Why should I use Pinia?</strong></p><p><code>ä¸ºä»€ä¹ˆæˆ‘åº”è¯¥ä½¿ç”¨Piniaï¼Ÿ</code></p><p>Pinia is a store library for Vue, it allows you to share a state across components&#x2F;pages. If you are familiar with the Composition API, you might be thinking you can already share a global state with a simple <code>export const state = reactive(&#123;&#125;)</code>. This is true for single page applications but <strong>exposes your application to <a href="https://vuejs.org/guide/scaling-up/ssr.html#cross-request-state-pollution">security vulnerabilities</a></strong> if it is server side rendered. But even in small single page applications, you get a lot from using Pinia:</p><p><em>è¯‘ï¼šPinia æ˜¯ä¸€ä¸ª Vue çš„å­˜å‚¨åº“ï¼Œå®ƒå…è®¸ä½ åœ¨ç»„ä»¶&#x2F;é¡µé¢ä¹‹é—´å…±äº«çŠ¶æ€ã€‚å¦‚æœä½ ç†Ÿæ‚‰åˆæˆ APIï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºä½ å¯ä»¥é€šè¿‡ç®€å•çš„<code>export const state = reactive(&#123;&#125;)</code>å…±äº«å…¨å±€çŠ¶æ€ã€‚è¿™æ˜¯å¯¹äºå•é¡µåº”ç”¨çš„çœŸå®æƒ…å†µï¼Œä½†</em> **å¦‚æœå®ƒæ˜¯æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œå®ƒä¼šæš´éœ²æ‚¨çš„åº”ç”¨ç¨‹åºåˆ°<a href="https://vuejs.org/guide/scaling-up/ssr.html#cross-request-state-pollution">å®‰å…¨æ¼æ´</a>**ã€‚<em>ä½†å³ä½¿æ˜¯å°çš„å•é¡µåº”ç”¨ï¼Œä½¿ç”¨ Pinia ä¹Ÿå¾ˆå¤šï¼š</em></p><ul><li>Devtools support <em>å¼€å‘å·¥å…·æ”¯æŒ</em><ul><li>A timeline to track actions, mutations <em>è¿½è¸ªè¡ŒåŠ¨ã€çªå˜çš„æ—¶é—´è¡¨</em></li><li>Stores appear in components where they are used <em>å­˜å‚¨å‡ºç°åœ¨ä½¿ç”¨å®ƒä»¬çš„ç»„ä»¶ä¸­</em></li><li>Time travel and easier debugging <em>æ—¶é—´æ—…è¡Œå’Œæ›´å®¹æ˜“è°ƒè¯•</em></li></ul></li><li>Hot module replacement <em>å¿«é€Ÿæ›´æ–°</em><ul><li>Modify your stores without reloading your page <em>åœ¨ä¸é‡æ–°åŠ è½½é¡µé¢çš„æƒ…å†µä¸‹ä¿®æ”¹ä½ çš„å­˜å‚¨</em></li><li>Keep any existing state while developing <em>åœ¨å¼€å‘æ—¶ä¿æŒä»»ä½•ç°æœ‰çŠ¶æ€</em></li></ul></li><li>Plugins: extend Pinia features with plugins <em>åŠŸèƒ½æ‰©å±•ï¼šä½¿ç”¨æ’ä»¶æ‰©å±• Pinia åŠŸèƒ½</em></li><li>Proper TypeScript support or <strong>autocompletion</strong> for JS users *å¯¹äº JS ç”¨æˆ·çš„æ­£ç¡®çš„ TypeScript æ”¯æŒæˆ–<strong>è‡ªåŠ¨å®Œæˆ*</strong></li><li>Server Side Rendering Support <em>å®Œç¾çš„æœåŠ¡å™¨ç«¯æ¸²æŸ“æ”¯æŒ</em></li></ul><p><strong>Basic example</strong></p><p><code>åŸºæœ¬ç¤ºä¾‹</code><br>This is what using pinia looks like in terms of API (make sure to check the <a href="./getting-started.md">Getting Started</a> for complete instructions). You start by creating a store:<br><em>è¯‘ï¼šè¿™æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨ pinia çœ‹èµ·æ¥åƒ APIï¼ˆè¯·æ£€æŸ¥<a href="./getting-started.md">å¼€å§‹</a>ä»¥è·å–å®Œæ•´çš„æŒ‡ä»¤ï¼‰ã€‚ä½ é¦–å…ˆåˆ›å»ºä¸€ä¸ªå­˜å‚¨ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; stores&#x2F;counter.jsimport &#123; defineStore &#125; from &quot;pinia&quot;;export const useCounterStore &#x3D; defineStore(&quot;counter&quot;, &#123;  state: () &#x3D;&gt; &#123;    return &#123; count: 0 &#125;;  &#125;,  &#x2F;&#x2F; could also be defined as  &#x2F;&#x2F; state: () &#x3D;&gt; (&#123; count: 0 &#125;)  actions: &#123;    increment() &#123;      this.count++;    &#125;,  &#125;,&#125;);</code></pre><p>And then you <em>use</em> it in a component:<br><em>è¯‘ï¼šç„¶åä½ åœ¨ç»„ä»¶ä¸­<code>ä½¿ç”¨</code>å®ƒï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useCounterStore &#125; from &quot;@&#x2F;stores&#x2F;counter&quot;;export default &#123;  setup() &#123;    const counter &#x3D; useCounterStore();    counter.count++;    &#x2F;&#x2F; with autocompletion âœ¨    counter.$patch(&#123; count: counter.count + 1 &#125;);    &#x2F;&#x2F; or using an action instead    counter.increment();  &#125;,&#125;;</code></pre><p>You can even use a function (similar to a component <code>setup()</code>) to define a Store for more advanced use cases:<br><em>è¯‘ï¼šä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å‡½æ•°ï¼ˆä¸ç»„ä»¶<code>setup()</code>ç›¸ä¼¼ï¼‰æ¥å®šä¹‰ä¸€ä¸ªå­˜å‚¨ä»¥æ›´é«˜çº§çš„ä½¿ç”¨æƒ…å†µï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export const useCounterStore &#x3D; defineStore(&quot;counter&quot;, () &#x3D;&gt; &#123;  const count &#x3D; ref(0);  function increment() &#123;    count.value++;  &#125;  return &#123; count, increment &#125;;&#125;);</code></pre><p>If you are still not into <code>setup()</code> and Composition API, donâ€™t worry, Pinia also support a similar set of <a href="https://vuex.vuejs.org/guide/state.html#the-mapstate-helper"><em>map helpers</em> like Vuex</a>. You define stores the same way but then use <code>mapStores()</code>, <code>mapState()</code>, or <code>mapActions()</code>:<br><em>è¯‘ï¼šå¦‚æœä½ è¿˜ä¸æ˜¯<code>setup()</code>å’Œ Composition API çš„ç†Ÿæ‚‰ï¼Œä¸ç”¨æ‹…å¿ƒï¼ŒPinia ä¹Ÿæ”¯æŒ<a href="https://vuex.vuejs.org/guide/state.html#the-mapstate-helper">Vuex çš„<em>map helpers</em>ï¼ˆå¦‚ Vuexï¼‰</a>ã€‚ä½ å®šä¹‰å­˜å‚¨çš„æ–¹å¼ç›¸åŒï¼Œç„¶åä½¿ç”¨<code>mapStores()</code>, <code>mapState()</code>,æˆ–<code>mapActions()</code>ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const useCounterStore &#x3D; defineStore(&quot;counter&quot;, &#123;  state: () &#x3D;&gt; (&#123; count: 0 &#125;),  getters: &#123;    double: (state) &#x3D;&gt; state.count * 2,  &#125;,  actions: &#123;    increment() &#123;      this.count++;    &#125;,  &#125;,&#125;);const useUserStore &#x3D; defineStore(&quot;user&quot;, &#123;  &#x2F;&#x2F; ...&#125;);export default &#123;  computed: &#123;    &#x2F;&#x2F; other computed properties    &#x2F;&#x2F; ...    &#x2F;&#x2F; gives access to this.counterStore and this.userStore    ...mapStores(useCounterStore, useUserStore),    &#x2F;&#x2F; gives read access to this.count and this.double    ...mapState(useCounterStore, [&quot;count&quot;, &quot;double&quot;]),  &#125;,  methods: &#123;    &#x2F;&#x2F; gives access to this.increment()    ...mapActions(useCounterStore, [&quot;increment&quot;]),  &#125;,&#125;;</code></pre><p>You will find more information about each <em>map helper</em> in the core concepts.<br><em>è¯‘ï¼šä½ å°†æ‰¾åˆ°æ›´å¤šå…³äºæ¯ä¸ª<em>map helper</em>çš„ä¿¡æ¯ã€‚</em></p><p><strong>Why <em>Pinia</em></strong></p><p><em>ä¸ºä»€ä¹ˆå« Pinia</em></p><p>Pinia (pronounced <code>/piËnjÊŒ/</code>, like â€œpeenyaâ€ in English) is the closest word to <em>piÃ±a</em> (<em>pineapple</em> in Spanish) that is a valid package name. A pineapple is in reality a group of individual flowers that join together to create a multiple fruit. Similar to stores, each one is born individually, but they are all connected at the end. Itâ€™s also a delicious tropical fruit indigenous to South America.</p><p><em>Pinia å‘éŸ³ <code>/piËnjÊŒ/</code>ï¼Œç±»ä¼¼äºè‹±è¯­ä¸­çš„â€œæŸ æª¬â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„åŒ…åã€‚ä¸€ä¸ªæŸ æª¬æ˜¯å®é™…ä¸Šæ˜¯ä¸€ç»„å•ä¸ªèŠ±æœµç»“åˆåœ¨ä¸€èµ·ï¼Œä»¥åˆ›å»ºå¤šä¸ªæ°´æœã€‚ä¸å­˜å‚¨ç›¸ä¼¼ï¼Œæ¯ä¸€ä¸ªéƒ½æ˜¯å•ç‹¬å‡ºç”Ÿçš„ï¼Œä½†æ˜¯ä»–ä»¬éƒ½æ˜¯æœ€ç»ˆè¿æ¥åœ¨ä¸€èµ·çš„ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªåœ¨å—ç¾æ´²çš„ç¾é£Ÿã€‚</em></p><p><strong>A more realistic example</strong></p><p><em>è¯‘ï¼šæ›´çœŸå®çš„ä¾‹å­</em><br>Here is a more complete example of the API you will be using with Pinia <strong>with types even in JavaScript</strong>. For some people, this might be enough to get started without reading further but we still recommend checking the rest of the documentation or even skipping this example and coming back once you have read about all of the <em>Core Concepts</em>.<br><em>è¯‘ï¼šè¿™æ˜¯ä¸€ä¸ªæ›´å®Œæ•´çš„ä¾‹å­ï¼Œä½ å°†ä½¿ç”¨ Pinia<strong>ç±»å‹åœ¨ JavaScript</strong>ã€‚å¯¹äºä¸€äº›äººï¼Œè¿™å¯èƒ½æ˜¯è¶³å¤Ÿå¼€å§‹è€Œä¸éœ€è¦é˜…è¯»æ›´å¤šï¼Œä½†æˆ‘ä»¬ä»ç„¶å»ºè®®æ£€æŸ¥å…¶ä½™çš„æ–‡æ¡£æˆ–è·³è¿‡è¿™ä¸ªä¾‹å­ï¼Œç„¶åå›æ¥ä¸€æ¬¡ä½ å·²ç»é˜…è¯»äº†æ‰€æœ‰çš„<strong>æ ¸å¿ƒæ¦‚å¿µ</strong>ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; defineStore &#125; from &quot;pinia&quot;;export const todos &#x3D; defineStore(&quot;todos&quot;, &#123;  state: () &#x3D;&gt; (&#123;    &#x2F;** @type &#123;&#123; text: string, id: number, isFinished: boolean &#125;[]&#125; *&#x2F;    todos: [],    &#x2F;** @type &#123;&#39;all&#39; | &#39;finished&#39; | &#39;unfinished&#39;&#125; *&#x2F;    filter: &quot;all&quot;,    &#x2F;&#x2F; type will be automatically inferred to number    &#x2F;&#x2F; ç±»å‹å°†è‡ªåŠ¨æ¨æ–­ä¸ºnumber    nextId: 0,  &#125;),  getters: &#123;    finishedTodos(state) &#123;      &#x2F;&#x2F; autocompletion! âœ¨      &#x2F;&#x2F; è‡ªåŠ¨å®Œæˆ      return state.todos.filter((todo) &#x3D;&gt; todo.isFinished);    &#125;,    unfinishedTodos(state) &#123;      return state.todos.filter((todo) &#x3D;&gt; !todo.isFinished);    &#125;,    &#x2F;**     * @returns &#123;&#123; text: string, id: number, isFinished: boolean &#125;[]&#125;     *&#x2F;    filteredTodos(state) &#123;      if (this.filter &#x3D;&#x3D;&#x3D; &quot;finished&quot;) &#123;        &#x2F;&#x2F; call other getters with autocompletion âœ¨        &#x2F;&#x2F; è°ƒç”¨å…¶ä»–gettersè‡ªåŠ¨å®Œæˆ        return this.finishedTodos;      &#125; else if (this.filter &#x3D;&#x3D;&#x3D; &quot;unfinished&quot;) &#123;        return this.unfinishedTodos;      &#125;      return this.todos;    &#125;,  &#125;,  actions: &#123;    &#x2F;&#x2F; any amount of arguments, return a promise or not    &#x2F;&#x2F; ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªpromiseæˆ–ä¸    addTodo(text) &#123;      &#x2F;&#x2F; you can directly mutate the state      &#x2F;&#x2F; ä½ å¯ä»¥ç›´æ¥ä¿®æ”¹çŠ¶æ€      this.todos.push(&#123; text, id: this.nextId++, isFinished: false &#125;);    &#125;,  &#125;,&#125;);</code></pre><p><strong>Comparison with Vuex</strong></p><p><em>è¯‘ï¼šä¸ Vuex æ¯”è¾ƒ</em></p><p>Pinia started out as an exploration of what the next iteration of Vuex could look like, incorporating many ideas from core team discussions for Vuex 5. Eventually, we realized that Pinia already implements most of what we wanted in Vuex 5, and decided to make it the new recommendation instead.<br><em>è¯‘ï¼šPinia å¼€å§‹äº†ä¸€ä¸ªæ¢ç´¢ Vuex çš„ä¸‹ä¸€ä¸ªè¿­ä»£ï¼Œå¹¶ä¸”å°†å¤§é‡çš„æƒ³æ³•ä» Vuex 5 çš„æ ¸å¿ƒå›¢é˜Ÿè®¨è®ºä¸­æå–ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬è®¤ä¸º Pinia å·²ç»å®ç°äº†å¤§éƒ¨åˆ†æˆ‘ä»¬æƒ³è¦çš„ Vuex 5ï¼Œå¹¶ä¸”å†³å®šæ”¹å˜å®ƒçš„æ¨èã€‚</em><br>Compared to Vuex, Pinia provides a simpler API with less ceremony, offers Composition-API-style APIs, and most importantly, has solid type inference support when used with TypeScript.<br><em>è¯‘ï¼šä¸ Vuex æ¯”è¾ƒï¼ŒPinia æä¾›äº†æ›´ç®€å•çš„ APIï¼Œæä¾›äº†ç»„åˆ API çš„ APIï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨ TypeScript æ—¶æœ‰å®ä½“ç±»å‹æ”¯æŒã€‚</em></p><p><strong>RFCs</strong></p><p><em>è¯‘ï¼šRFCs</em></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>RFCs æ¶µç›–äº† Vue çš„æœ€åŸºæœ¬çš„å››ä¸ªéƒ¨åˆ†ï¼Œæˆªè‡³ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»æœ‰ 38 ä¸ª PR æäº¤ï¼ˆ26 ä¸ªä»åœ¨è®¨è®ºä¸­ï¼‰ï¼Œè¿™äº›æè®®ä¸­æ—¢æœ‰ Vue ä½œè€…è‡ªå·±çš„æè®®ï¼Œä¹Ÿæœ‰å¼€å‘è€…çš„æè®®ã€‚</p><ul><li>Vue core</li><li>Vue Router</li><li>Vuex</li><li>Vue CLI</li></ul></blockquote><p>Initially Pinia didnâ€™t go through any RFC. I tested out ideas based on my experience developing applications, reading other peopleâ€™s code, working for clients who use Pinia, and answering questions on Discord.<br>This allowed me to provide a solution that works and is adapted to a variety of cases and application sizes. I used to publish often and made the library evolve while keeping its core API the same.<br><em>è¯‘ï¼šåˆå§‹ Pinia æ²¡æœ‰é€šè¿‡ä»»ä½• RFCã€‚æˆ‘æµ‹è¯•äº†åŸºäºæˆ‘çš„ç»éªŒå¼€å‘åº”ç”¨ç¨‹åºï¼Œé˜…è¯»å…¶ä»–äººçš„ä»£ç ï¼Œä¸ºä½¿ç”¨ Pinia çš„å®¢æˆ·å·¥ä½œï¼Œå¹¶åœ¨ Discord ä¸Šå›ç­”é—®é¢˜ã€‚è¿™è®©æˆ‘æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒå·¥ä½œå¹¶é€‚åˆå„ç§æƒ…å†µå’Œåº”ç”¨ç¨‹åºå¤§å°ã€‚æˆ‘ç»å¸¸å‘å¸ƒï¼Œå¹¶åœ¨ä¿æŒæ ¸å¿ƒ API ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä½¿åº“å‘å±•ã€‚</em><br>Now that Pinia has become the default state management solution, it is subject to the same RFC process as other core libraries in the Vue ecosystem and its API has entered a stable state.<br><em>è¯‘ï¼šç°åœ¨ï¼ŒPinia å·²ç»æˆä¸º Vue çš„æ ¸å¿ƒçŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸ Vue ç¤¾åŒºä¸­å…¶ä»–æ ¸å¿ƒåº“çš„ RFC è¿›è¡Œäº†ç›¸åŒçš„å¤„ç†ï¼Œå¹¶ä¸”å®ƒçš„ API å·²ç»è¿›å…¥äº†ä¸€ä¸ªç¨³å®šçŠ¶æ€ã€‚</em></p><p><strong>Comparison with Vuex 3.x&#x2F;4.x</strong></p><p><em>è¯‘ï¼šä¸ Vuex 3.x&#x2F;4.x æ¯”è¾ƒ</em></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Vuex 3.x is Vuex for Vue 2 while Vuex 4.x is for Vue 3<br>Vuex 3.x æ˜¯ Vuex 2 çš„ Vuexï¼Œè€Œ Vuex 4.x æ˜¯ Vue 3 çš„ Vuex<br>Pinia API is very different from Vuex â‰¤4, namely:<br><em>è¯‘ï¼šPinia API ä¸ Vuex 3.x&#x2F;4.x æ¯”è¾ƒï¼Œä¸»è¦åŒºåˆ«æ˜¯ï¼š</em></p></blockquote><ul><li><em>mutations</em> no longer exist. They were very often perceived as <strong><em>extremely</em> verbose</strong>. They initially brought devtools integration but that is no longer an issue.<br><code>- mutations ä¸å†å­˜åœ¨ã€‚å®ƒä»¬åˆå§‹ä¸ŠæŠ›äº†å¼€å‘å·¥å…·é›†æˆï¼Œä½†è¿™ä¸å†æ˜¯é—®é¢˜ã€‚</code></li><li>No need to create custom complex wrappers to support TypeScript, everything is typed and the API is designed in a way to leverage TS type inference as much as possible.<br><code>- æ²¡æœ‰éœ€è¦åˆ›å»ºè‡ªå®šä¹‰å¤æ‚çš„åŒ…è£…æ¥æ”¯æŒTypeScriptï¼Œæ‰€æœ‰çš„éƒ½æ˜¯ç±»å‹åŒ–çš„ï¼ŒAPIè®¾è®¡äº†ä¸€ä¸ªè®©ä½ æœ€å¤§é™åº¦åœ°åˆ©ç”¨TSç±»å‹æ¨æ–­çš„æ–¹å¼ã€‚</code></li><li>No more magic strings to inject, import the functions, call them, enjoy autocompletion!<br><code>- æ²¡æœ‰æ›´å¤šçš„é­”æ³•å­—ç¬¦ä¸²æ³¨å…¥ï¼Œå¯¼å…¥å‡½æ•°ï¼Œè°ƒç”¨å®ƒä»¬ï¼Œäº«å—è‡ªåŠ¨å®Œæˆï¼</code></li><li>No need to dynamically add stores, they are all dynamic by default and you wonâ€™t even notice. Note you can still manually use a store to register it whenever you want but because it is automatic you donâ€™t need to worry about it.<br><code>- æ²¡æœ‰éœ€è¦åŠ¨æ€æ·»åŠ å­˜å‚¨ï¼Œå®ƒä»¬éƒ½æ˜¯é»˜è®¤çš„åŠ¨æ€çš„ï¼Œä½ ä¹Ÿä¸ä¼šå‘ç°ã€‚è¯·æ³¨æ„ï¼Œä½ ä»ç„¶å¯ä»¥æ‰‹åŠ¨ä½¿ç”¨å­˜å‚¨æ¥æ³¨å†Œå®ƒï¼Œä½†æ˜¯å› ä¸ºå®ƒæ˜¯è‡ªåŠ¨çš„ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒå®ƒã€‚</code></li><li>No more nested structuring of <em>modules</em>. You can still nest stores implicitly by importing and <em>using</em> a store inside another but Pinia offers a flat structuring by design while still enabling ways of cross composition among stores. <strong>You can even have circular dependencies of stores</strong>.<br><code>- æ²¡æœ‰æ›´å¤šçš„åµŒå¥—ç»“æ„çš„_æ¨¡å—_ã€‚ä½ ä»ç„¶å¯ä»¥åµŒå¥—å­˜å‚¨é€šè¿‡å¯¼å…¥å¹¶ä½¿ç”¨å­˜å‚¨åœ¨å¦ä¸€ä¸ªå­˜å‚¨ä¸­ï¼Œä½†Piniaæä¾›äº†ä¸€ä¸ªå¹³é¢çš„ç»“æ„ï¼Œè€Œä¸”è¿˜å…è®¸åœ¨å­˜å‚¨ä¹‹é—´è·¨è¶Šç»„åˆã€‚**ä½ è¿˜å¯ä»¥æœ‰åœ†å½¢ä¾èµ–çš„å­˜å‚¨**ã€‚</code></li><li>No <em>namespaced modules</em>. Given the flat architecture of stores, â€œnamespacingâ€ stores is inherent to how they are defined and you could say all stores are namespaced.<br><code>- æ²¡æœ‰_å‘½åç©ºé—´æ¨¡å—_ã€‚ç»™å®šå­˜å‚¨çš„å¹³é¢å»ºæ„ï¼Œâ€œå‘½åç©ºé—´â€å­˜å‚¨æ˜¯å› ä¸ºå®ƒä»¬å®šä¹‰çš„æ–¹å¼è€Œå…·æœ‰çš„ï¼Œä½ å¯ä»¥è¯´æ‰€æœ‰çš„å­˜å‚¨éƒ½æ˜¯å‘½åç©ºé—´ã€‚</code><br>For more detailed instructions on how to convert an existing Vuex â‰¤4 project to use Pinia, see the <a href="./cookbook/migration-vuex.md">Migration from Vuex Guide</a>.<br><em>è¯‘ï¼šä¸ºäº†æ›´åŠ è¯¦ç»†çš„æŒ‡å¯¼å¦‚ä½•å°†ç°æœ‰çš„ Vuex â‰¤4 é¡¹ç›®è½¬æ¢ä¸ºä½¿ç”¨ Piniaï¼Œè¯·å‚é˜…<a href="./cookbook/migration-vuex.md">Migration from Vuex Guide</a>ã€‚</em></li></ul><h2 id="èµ·æ­¥"><a href="#èµ·æ­¥" class="headerlink" title="èµ·æ­¥"></a><a href="https://pinia.vuejs.org/getting-started.html#installation">èµ·æ­¥</a></h2><h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>Install <code>pinia</code> with your favorite package manager:<br><em>è¯‘ï¼šä½¿ç”¨ä½ å–œæ¬¢çš„åŒ…ç®¡ç†å™¨å®‰è£… <code>pinia</code> ï¼š</em></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yarn add pinia# or with npmnpm install pinia</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>If your app is using Vue 2, you also need to install the composition api: <code>@vue/composition-api</code>. If you are using Nuxt, you should follow <a href="https://pinia.vuejs.org/ssr/nuxt.html">these instructions</a>.<br><em>è¯‘ï¼šå¦‚æœä½ çš„åº”ç”¨ä½¿ç”¨ Vue 2ï¼Œä½ è¿˜éœ€è¦å®‰è£…ç»„åˆ apiï¼š<code>@vue/composition-api</code>ã€‚å¦‚æœä½ ä½¿ç”¨ Nuxtï¼Œä½ åº”è¯¥éµå¾ª<a href="https://pinia.vuejs.org/ssr/nuxt.html">è¿™äº›æŒ‡å¯¼</a>ã€‚</em></p></div><p>If you are using the Vue CLI, you can instead give this <a href="https://github.com/wobsoriano/vue-cli-plugin-pinia"><strong>unofficial plugin</strong></a> a try.<br>_è¯‘ï¼šå¦‚æœä½ ä½¿ç”¨ Vue CLIï¼Œä½ å¯ä»¥è¯•è¯•è¿™ä¸ª [<strong>éå®˜æ–¹æ’ä»¶</strong>](</p><p>Create a pinia (the root store) and pass it to the app:<br><em>è¯‘ï¼šåˆ›å»ºä¸€ä¸ª pinia ï¼ˆæ ¹å­˜å‚¨ï¼‰å¹¶å°†å…¶ä¼ é€’ç»™åº”ç”¨ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; createPinia &#125; from &quot;pinia&quot;;app.use(createPinia());</code></pre><p>If you are using Vue 2, you also need to install a plugin and inject the created <code>pinia</code> at the root of the app:<br><em>è¯‘ï¼šå¦‚æœä½ ä½¿ç”¨ Vue 2ï¼Œä½ è¿˜éœ€è¦å®‰è£…ä¸€ä¸ªæ’ä»¶å¹¶å°†åˆ›å»ºçš„ <code>pinia</code> æ³¨å…¥åˆ°åº”ç”¨çš„æ ¹ä¸­ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; createPinia, PiniaVuePlugin &#125; from &quot;pinia&quot;;Vue.use(PiniaVuePlugin);const pinia &#x3D; createPinia();new Vue(&#123;  el: &quot;#app&quot;,  &#x2F;&#x2F; other options...  &#x2F;&#x2F; ...  &#x2F;&#x2F; note the same &#96;pinia&#96; instance can be used across multiple Vue apps on the same page  &#x2F;&#x2F; æ³¨æ„ï¼ŒåŒä¸€ä¸ª &#96;pinia&#96; å®ä¾‹å¯ä»¥åœ¨åŒä¸€ä¸ªé¡µé¢ä¸Šçš„å¤šä¸ª Vue åº”ç”¨ä¸­ä½¿ç”¨  pinia,&#125;);</code></pre><p>This will also add devtools support. In Vue 3, some features like time traveling and editing are still not supported because vue-devtools doesnâ€™t expose the necessary APIs yet but the devtools have way more features and the developer experience as a whole is far superior. In Vue 2, Pinia uses the existing interface for Vuex (and can therefore not be used alongside it).<br><em>è¯‘ï¼šè¿™ä¹Ÿä¼šæ·»åŠ  devtools æ”¯æŒã€‚åœ¨ Vue 3 ä¸­ï¼ŒæŸäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚æ—¶é—´æ—…è¡Œå’Œç¼–è¾‘ï¼‰ä»ç„¶ä¸æ”¯æŒï¼Œå› ä¸º vue-devtools ä¸æš´éœ²äº†å¿…è¦çš„ APIï¼Œä½†æ˜¯ devtools æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œå¼€å‘è€…ä½“éªŒæ•´ä½“æ›´ä¼˜ã€‚åœ¨ Vue 2 ä¸­ï¼ŒPinia ä½¿ç”¨ç°æœ‰çš„ Vuex æ¥å£ï¼ˆå› æ­¤ä¸èƒ½ä¸å®ƒä¸€èµ·ä½¿ç”¨ï¼‰ã€‚</em></p><h3 id="What-is-a-Store"><a href="#What-is-a-Store" class="headerlink" title="What is a Store?"></a>What is a Store?</h3><p>A Store (like Pinia) is an entity holding state and business logic that isnâ€™t bound to your Component tree. In other words, <strong>it hosts global state</strong>. Itâ€™s a bit like a component that is always there and that everybody can read off and write to. It has <strong>three concepts</strong>, the <a href="./core-concepts/state.md">state</a>, <a href="./core-concepts/getters.md">getters</a> and <a href="./core-concepts/actions.md">actions</a> and itâ€™s safe to assume these concepts are the equivalent of <code>data</code>, <code>computed</code> and <code>methods</code> in components.<br><em>è¯‘ï¼šä¸€ä¸ªå­˜å‚¨ï¼ˆåƒ Piniaï¼‰æ˜¯ä¸€ä¸ªæŒæœ‰çŠ¶æ€å’Œä¸šåŠ¡é€»è¾‘çš„å®ä½“ï¼Œå®ƒä¸æ˜¯ç»‘å®šåˆ°ä½ çš„ç»„ä»¶æ ‘ä¸Šçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å®ƒæŒæœ‰å…¨å±€çŠ¶æ€</strong>ã€‚å®ƒæ˜¯ä¸€ä¸ªæ€»æ˜¯å­˜åœ¨çš„ç»„ä»¶ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥è¯»å–å¹¶å†™å…¥ã€‚å®ƒæœ‰ <strong>ä¸‰ä¸ªæ¦‚å¿µ</strong>ï¼Œ<a href="./core-concepts/state.md">state</a>ï¼Œ<a href="./core-concepts/getters.md">getters</a> å’Œ <a href="./core-concepts/actions.md">actions</a>ï¼Œå¹¶ä¸”æˆ‘ä»¬å‡è®¾è¿™ä¸‰ä¸ªæ¦‚å¿µæ˜¯ç»„ä»¶çš„ <code>data</code>ï¼Œ<code>computed</code> å’Œ <code>methods</code> çš„ç­‰ä»·ã€‚</em></p><h3 id="When-should-I-use-a-Store"><a href="#When-should-I-use-a-Store" class="headerlink" title="When should I use a Store"></a>When should I use a Store</h3><p>A store should contain data that can be accessed throughout your application. This includes data that is used in many places, e.g. User information that is displayed in the navbar, as well as data that needs to be preserved through pages, e.g. a very complicated multi-step form.<br><em>è¯‘ï¼šä¸€ä¸ªå­˜å‚¨åº”è¯¥åŒ…å«å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­è®¿é—®çš„æ•°æ®ã€‚è¿™åŒ…æ‹¬åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨çš„æ•°æ®ï¼Œä¾‹å¦‚åœ¨å¯¼èˆªæ ä¸­æ˜¾ç¤ºçš„ç”¨æˆ·ä¿¡æ¯ï¼Œä»¥åŠéœ€è¦åœ¨é¡µé¢ä¸­ä¿ç•™çš„æ•°æ®ï¼Œä¾‹å¦‚ä¸€ä¸ªå¤æ‚çš„å¤šæ­¥éª¤è¡¨å•ã€‚</em><br>On the other hand, you should avoid including in the store local data that could be hosted in a component instead, e.g. the visibility of an element local to a page.<br><em>è¯‘ï¼šå¦ä¸€æ–¹é¢ï¼Œä½ åº”è¯¥é¿å…åœ¨å­˜å‚¨ä¸­åŒ…å«åœ¨ç»„ä»¶ä¸­å­˜å‚¨çš„æœ¬åœ°æ•°æ®ï¼Œä¾‹å¦‚é¡µé¢ä¸­çš„ä¸€ä¸ªå…ƒç´ çš„å¯è§æ€§ã€‚</em><br>Not all applications need access to a global state, but if yours need one, Pinia will make your life easier.<br><em>è¯‘ï¼šä¸æ˜¯æ‰€æœ‰åº”ç”¨éƒ½éœ€è¦è®¿é—®å…¨å±€çŠ¶æ€ï¼Œä½†å¦‚æœä½ çš„åº”ç”¨éœ€è¦ä¸€ä¸ªï¼ŒPinia å°†ä½¿ä½ çš„ç”Ÿæ´»æ›´åŠ æ–¹ä¾¿ã€‚</em></p><h2 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h2><h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p><strong>Defining a Store</strong></p><p><VueSchoolLink  href="https://vueschool.io/lessons/define-your-first-pinia-store"  title="Learn how to define and use stores in Pinia"/></p><p>Before diving into core concepts, we need to know that a store is defined using <code>defineStore()</code> and that it requires a <strong>unique</strong> name, passed as the first argument:<br><em>è¯‘ï¼šåœ¨æ·±å…¥æ ¸å¿ƒæ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªå­˜å‚¨ç”± <code>defineStore()</code> å®šä¹‰å¹¶ä¸”éœ€è¦ä¸€ä¸ª <strong>å”¯ä¸€çš„</strong> åç§°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; defineStore &#125; from &quot;pinia&quot;;&#x2F;&#x2F; useStore could be anything like useUser, useCart&#x2F;&#x2F; the first argument is a unique id of the store across your applicationexport const useStore &#x3D; defineStore(&quot;main&quot;, &#123;  &#x2F;&#x2F; other options...&#125;);</code></pre><p>This <em>name</em>, also referred as <em>id</em>, is necessary and is used by Pinia to connect the store to the devtools. Naming the returned function <em>useâ€¦</em> is a convention across composables to make its usage idiomatic.<br>_è¯‘ï¼šè¿™ä¸ªåç§°ï¼Œä¹Ÿç§°ä¸º <em>id_ï¼Œæ˜¯å¿…éœ€çš„å¹¶ä¸”ç”¨äºè¿æ¥å­˜å‚¨åˆ° devtoolsã€‚å‘½åè¿”å›çš„å‡½æ•° <em>useâ€¦</em> æ˜¯ä¸€ä¸ªç»„åˆä½¿ç”¨çš„æƒ¯ä¾‹ï¼Œä½¿ç”¨å®ƒçš„ç”¨æ³•ç®€å•æ˜“æ‡‚ã€‚</em><br><strong>Using the store</strong></p><p>We are <em>defining</em> a store because the store wonâ€™t be created until <code>useStore()</code> is called inside of <code>setup()</code>:<br><em>è¯‘ï¼šæˆ‘ä»¬æ­£åœ¨å®šä¹‰ä¸€ä¸ªå­˜å‚¨ï¼Œå› ä¸ºåªæœ‰åœ¨<code>setupï¼ˆï¼‰</code>å†…éƒ¨è°ƒç”¨<code>useStoreï¼ˆï¼‰</code>æ‰èƒ½åˆ›å»ºè¯¥å­˜å‚¨</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useStore &#125; from &quot;@&#x2F;stores&#x2F;counter&quot;;export default &#123;  setup() &#123;    const store &#x3D; useStore();    return &#123;      &#x2F;&#x2F; you can return the whole store instance to use it in the template      &#x2F;&#x2F; ä½ å¯ä»¥åœ¨æ¨¡æ¿ä¸­è¿”å›æ•´ä¸ªå­˜å‚¨å®ä¾‹æ¥ä½¿ç”¨å®ƒ      store,    &#125;;  &#125;,&#125;;</code></pre><p>You can define as many stores as you want and <strong>you should define each store in a different file</strong> to get the most out of pinia (like automatically allow your bundle to code split and TypeScript inference).<br><em>è¯‘ ï¼šä½ å¯ä»¥å®šä¹‰å¤šä¸ªå­˜å‚¨ï¼Œä½ åº”è¯¥åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­å®šä¹‰æ¯ä¸ªå­˜å‚¨æ¥è·å¾— pinia çš„æœ€å¤§æ•ˆç”¨ï¼ˆä¾‹å¦‚è‡ªåŠ¨å…è®¸ä½ çš„ bundle åˆ†å‰²å’Œ TypeScript æ¨æ–­ï¼‰ã€‚</em><br>If you are not using <code>setup</code> components yet, <a href="https://pinia.vuejs.org/cookbook/options-api.html">you can still use Pinia with <em>map helpers</em></a>.<br><em>è¯‘ï¼šå¦‚æœä½ è¿˜æ²¡æœ‰ä½¿ç”¨ <code>setup</code> ç»„ä»¶ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨ Pinia ä¸ [map åŠ©æ‰‹]ï¼ˆ<a href="https://pinia.vuejs.org/cookbook/options-api.html%EF%BC%89%E3%80%82">https://pinia.vuejs.org/cookbook/options-api.htmlï¼‰ã€‚</a></em><br>Once the store is instantiated, you can access any property defined in <code>state</code>, <code>getters</code>, and <code>actions</code> directly on the store. We will see these in detail in the next pages but autocompletion will help you.<br><em>è¯‘ï¼šä¸€æ—¦å­˜å‚¨è¢«å®ä¾‹åŒ–ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å­˜å‚¨ä¸Šè®¿é—® <code>state</code>ï¼Œ<code>getters</code> å’Œ <code>actions</code> ä¸­å®šä¹‰çš„å±æ€§ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€é¡µä¸­è¯¦ç»†è®²è§£ï¼Œä½†æ˜¯è‡ªåŠ¨è¡¥å…¨å°†å¸®åŠ©ä½ ã€‚</em><br>Note that <code>store</code> is an object wrapped with <code>reactive</code>, meaning there is no need to write <code>.value</code> after getters but, like <code>props</code> in <code>setup</code>, <strong>we cannot destructure it</strong>:<br><em>è¯‘ï¼šè¯·æ³¨æ„ï¼Œå­˜å‚¨æ˜¯ä¸€ä¸ª <code>reactive</code> åŒ…è£…çš„å¯¹è±¡ï¼Œå› æ­¤ä¸éœ€è¦å†™ <code>.value</code> åé¢çš„ gettersï¼Œä½†æ˜¯ï¼Œåƒ <code>setup</code> ä¸­çš„ <code>props</code>ï¼Œæˆ‘ä»¬ä¸èƒ½è§£æ„å®ƒ</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default defineComponent(&#123;  setup() &#123;    const store &#x3D; useStore();    &#x2F;&#x2F; âŒ This won&#39;t work because it breaks reactivity it&#39;s the same as destructuring from &#96;props&#96;    &#x2F;&#x2F; è¿™ä¸ä¼šå·¥ä½œï¼Œå› ä¸ºå®ƒä¼šç ´åå¯è§‚å¯Ÿæ€§ï¼Œå®ƒæ˜¯ç›¸åŒçš„ä¸º &#96;props&#96; æ„é€ çš„    const &#123; name, doubleCount &#125; &#x3D; store;    name; &#x2F;&#x2F; &quot;eduardo&quot;    doubleCount; &#x2F;&#x2F; 2    return &#123;      &#x2F;&#x2F; will always be &quot;eduardo&quot;      &#x2F;&#x2F; å°†å§‹ç»ˆæ˜¯ &quot;eduardo&quot;      name,      &#x2F;&#x2F; will always be 2      &#x2F;&#x2F; å°†å§‹ç»ˆæ˜¯ 2      doubleCount,      &#x2F;&#x2F; this one will be reactive      &#x2F;&#x2F; è¿™ä¸ªå°†æ˜¯å¯è§‚å¯Ÿçš„      doubleValue: computed(() &#x3D;&gt; store.doubleCount),    &#125;;  &#125;,&#125;);</code></pre><p>In order to extract properties from the store while keeping its reactivity, you need to use <code>storeToRefs()</code>. It will create refs for every reactive property. This is useful when you are only using state from the store but not calling any action. Note you can destructure actions directly from the store as they are bound to the store itself too:<br><em>è¯‘ï¼šä¸ºäº†ä»å­˜å‚¨ä¸­æå–å±æ€§è€Œä¿æŒå…¶å¯è§‚å¯Ÿæ€§ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>storeToRefs()</code>ã€‚å®ƒä¼šåˆ›å»ºæ¯ä¸ªå¯è§‚å¯Ÿå±æ€§çš„ refã€‚è¿™å¯¹äºåªä½¿ç”¨å­˜å‚¨ä¸­çš„çŠ¶æ€ä½†ä¸è°ƒç”¨ä»»ä½•è¡Œä¸ºæ—¶éå¸¸æœ‰ç”¨ã€‚è¯·æ³¨æ„ï¼Œä½ å¯ä»¥ç›´æ¥ä»å­˜å‚¨ä¸­è§£æ„ actionsï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ç»‘å®šåˆ°å­˜å‚¨æœ¬èº«çš„ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; storeToRefs &#125; from &quot;pinia&quot;;export default defineComponent(&#123;  setup() &#123;    const store &#x3D; useStore();    &#x2F;&#x2F; &#96;name&#96; and &#96;doubleCount&#96; are reactive refs    &#x2F;&#x2F; This will also create refs for properties added by plugins    &#x2F;&#x2F; but skip any action or non reactive (non ref&#x2F;reactive) property    const &#123; name, doubleCount &#125; &#x3D; storeToRefs(store);    &#x2F;&#x2F; the increment action can be just extracted    const &#123; increment &#125; &#x3D; store;    return &#123;      name,      doubleCount,      increment,    &#125;;  &#125;,&#125;);</code></pre><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p><VueSchoolLink  href="https://vueschool.io/lessons/access-state-from-a-pinia-store"  title="Learn all about state in Pinia"/></p><p>The state is, most of the time, the central part of your store. People often start by defining the state that represents their app. In Pinia the state is defined as a function that returns the initial state. This allows Pinia to work in both Server and Client Side.<br><em>å¤§å¤šæ•°æ—¶å€™ï¼Œstateæ˜¯ä½ storeçš„ä¸­å¿ƒã€‚äººä»¬é€šå¸¸ä»å®šä¹‰ä»£è¡¨å…¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€å¼€å§‹ã€‚åœ¨Piniaä¸­ï¼ŒçŠ¶æ€å®šä¹‰ä¸ºè¿”å›åˆå§‹çŠ¶æ€çš„å‡½æ•°ã€‚è¿™å…è®¸Piniaåœ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯éƒ½å·¥ä½œã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; defineStore &#125; from &quot;pinia&quot;;const useStore &#x3D; defineStore(&quot;storeId&quot;, &#123;  &#x2F;&#x2F; arrow function recommended for full type inference  state: () &#x3D;&gt; &#123;    return &#123;      &#x2F;&#x2F; all these properties will have their type inferred automatically      counter: 0,      name: &quot;Eduardo&quot;,      isAdmin: true,    &#125;;  &#125;,&#125;);</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>If you are using Vue 2, the data you create in <code>state</code> follows the same rules as the <code>data</code> in a Vue instance, ie the state object must be plain and you need to call <code>Vue.set()</code> when <strong>adding new</strong> properties to it. <strong>See also: <a href="https://v2.vuejs.org/v2/api/#data">Vue#data</a></strong>.<br><em>å¦‚æœä½ ä½¿ç”¨ Vue 2ï¼Œåœ¨ <code>state</code> ä¸­åˆ›å»ºçš„æ•°æ®éµå¾ª Vue å®ä¾‹ä¸­çš„ <code>data</code> çš„è§„åˆ™ï¼Œå³ state å¯¹è±¡å¿…é¡»æ˜¯çº¯ç²¹çš„ï¼Œå¹¶ä¸”éœ€è¦åœ¨ <strong>æ·»åŠ æ–°çš„</strong> å±æ€§æ—¶è°ƒç”¨ <code>Vue.set()</code>ã€‚è¯·å‚è§ <a href="https://v2.vuejs.org/v2/api/#data">Vue#data</a>ã€‚</em></p></div><p><strong>Accessing the <code>state</code></strong></p><p>By default, you can directly read and write to the state by accessing it through the <code>store</code> instance:<br><em>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç›´æ¥è¯»å–å’Œå†™å…¥çŠ¶æ€ï¼Œé€šè¿‡è®¿é—® <code>store</code> å®ä¾‹æ¥è®¿é—®å®ƒï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const store &#x3D; useStore();store.counter++;</code></pre><p><strong>Resetting the state</strong></p><p>You can <em>reset</em> the state to its initial value by calling the <code>$reset()</code> method on the store:<br><em>ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <code>$reset()</code> æ–¹æ³•æ¥é‡ç½®çŠ¶æ€ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const store &#x3D; useStore();store.$reset();</code></pre><p><strong>Usage with the Options API</strong></p><p><VueSchoolLink  href="https://vueschool.io/lessons/access-pinia-state-in-the-options-api"  title="Access Pinia State via the Options API"/></p><p>For the following examples, you can assume the following store was created:<br><em>ä¸ºäº†ä¸‹é¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥å‡è®¾ä»¥ä¸‹çš„å­˜å‚¨å·²åˆ›å»ºï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Example File Path:&#x2F;&#x2F; .&#x2F;src&#x2F;stores&#x2F;counterStore.jsimport &#123; defineStore &#125; from &quot;pinia&quot;;const useCounterStore &#x3D; defineStore(&quot;counterStore&quot;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0,  &#125;),&#125;);</code></pre><p>If you are not using the Composition API, and you are using <code>computed</code>, <code>methods</code>, â€¦, you can use the <code>mapState()</code> helper to map state properties as readonly computed properties:<br><em>å¦‚æœä½ ä¸ä½¿ç”¨ Composition APIï¼Œå¹¶ä¸”ä½¿ç”¨ <code>computed</code>ã€<code>methods</code> ç­‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>mapState()</code> å¸®åŠ©å™¨æ¥æ˜ å°„çŠ¶æ€å±æ€§ä¸ºåªè¯»çš„è®¡ç®—å±æ€§ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; mapState &#125; from &#39;pinia&#39;import &#123; useCounterStore &#125; from &#39;..&#x2F;stores&#x2F;counterStore&#39;export default &#123;  computed: &#123;    &#x2F;&#x2F; gives access to this.counter inside the component    &#x2F;&#x2F; same as reading from store.counter    ...mapState(useCounterStore, [&#39;counter&#39;])    &#x2F;&#x2F; same as above but registers it as this.myOwnName    ...mapState(useCounterStore, &#123;      myOwnName: &#39;counter&#39;,      &#x2F;&#x2F; you can also write a function that gets access to the store      double: store &#x3D;&gt; store.counter * 2,      &#x2F;&#x2F; it can have access to &#96;this&#96; but it won&#39;t be typed correctly...      magicValue(store) &#123;        return store.someGetter + this.counter + this.double      &#125;,    &#125;),  &#125;,&#125;</code></pre><p><strong>Modifiable state</strong></p><p>If you want to be able to write to these state properties (e.g. if you have a form), you can use <code>mapWritableState()</code> instead. Note you cannot pass a function like with <code>mapState()</code>:<br><em>å¦‚æœä½ æƒ³è¦å†™å…¥è¿™äº›çŠ¶æ€å±æ€§ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªè¡¨å•ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>mapWritableState()</code>ã€‚æ³¨æ„ï¼Œä½ ä¸èƒ½ä¼ é€’ä¸€ä¸ªå‡½æ•°ç±»ä¼¼äº <code>mapState()</code>ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; mapWritableState &#125; from &#39;pinia&#39;import &#123; useCounterStore &#125; from &#39;..&#x2F;stores&#x2F;counterStore&#39;export default &#123;  computed: &#123;    &#x2F;&#x2F; gives access to this.counter inside the component and allows setting it    &#x2F;&#x2F; this.counter++    &#x2F;&#x2F; same as reading from store.counter    ...mapWritableState(useCounterStore, [&#39;counter&#39;])    &#x2F;&#x2F; same as above but registers it as this.myOwnName    ...mapWritableState(useCounterStore, &#123;      myOwnName: &#39;counter&#39;,    &#125;),  &#125;,&#125;</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>You donâ€™t need <code>mapWritableState()</code> for collections like arrays unless you are replacing the whole array with <code>cartItems = []</code>, <code>mapState()</code> still allows you to call methods on your collections.<br><em>æ³¨æ„ï¼Œä½ ä¸éœ€è¦ <code>mapWritableState()</code> ä¸ºé›†åˆç±»å‹ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰ï¼Œé™¤éä½ æƒ³è¦æ›¿æ¢æ•´ä¸ªæ•°ç»„ä¸º <code>cartItems = []</code>ï¼Œ<code>mapState()</code> ä»ç„¶å…è®¸ä½ è°ƒç”¨é›†åˆçš„æ–¹æ³•ã€‚</em></p></div><p><strong>Mutating the state</strong></p><!-- TODO: disable this with `strictMode` --><p>Apart from directly mutating the store with <code>store.counter++</code>, you can also call the <code>$patch</code> method. It allows you to apply multiple changes at the same time with a partial <code>state</code> object:<br><em>é™¤äº†ç›´æ¥é€šè¿‡ <code>store.counter++</code> æ¥ä¿®æ”¹å­˜å‚¨ï¼Œä½ ä¹Ÿå¯ä»¥è°ƒç”¨ <code>$patch()</code> æ–¹æ³•ã€‚å®ƒå…è®¸ä½ åŒæ—¶ä½¿ç”¨ä¸€ä¸ªéƒ¨åˆ† <code>state</code> å¯¹è±¡æ¥åº”ç”¨å¤šä¸ªå˜æ›´ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">store.$patch(&#123;  counter: store.counter + 1,  name: &quot;Abalam&quot;,&#125;);</code></pre><p>However, some mutations are really hard or costly to apply with this syntax: any collection modification (e.g. pushing, removing, splicing an element from an array) requires you to create a new collection. Because of this, the <code>$patch</code> method also accepts a function to group this kind of mutations that are difficult to apply with a patch object:<br><em>ä½†æ˜¯ï¼Œä¸€äº›å˜æ›´éå¸¸éš¾æˆ–è€…æ˜‚è´µåœ°åº”ç”¨ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚å› æ­¤ï¼Œ<code>$patch</code> æ–¹æ³•ä¹Ÿæ¥å—ä¸€ä¸ªå‡½æ•°æ¥ç»„ç»‡è¿™ç§éš¾ä»¥åº”ç”¨çš„å˜æ›´ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">cartStore.$patch((state) &#x3D;&gt; &#123;  state.items.push(&#123; name: &quot;shoes&quot;, quantity: 1 &#125;);  state.hasChanged &#x3D; true;&#125;);</code></pre><!-- TODO: disable this with `strictMode`, `{ noDirectPatch: true }` --><p>The main difference here is that <code>$patch()</code> allows you to group multiple changes into one single entry in the devtools. Note <strong>both, direct changes to <code>state</code> and <code>$patch()</code> appear in the devtools</strong> and can be time travelled (not yet in Vue 3).<br>_ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œ<code>$patch()</code> å…è®¸ä½ å°†å¤šä¸ªå˜æ›´ç»„æˆä¸€ä¸ªå•ç‹¬çš„æ¡ç›®åœ¨ devtools ä¸­ã€‚æ³¨æ„ **ä¸¤è€…éƒ½ä¼šåœ¨ devtools ä¸­å‡ºç°ï¼Œå¹¶ä¸”å¯ä»¥è¢«æ—¶é—´è½´è¿½è¸ªï¼ˆå°šæœªåœ¨ Vue 3 ä¸­ï¼‰ã€‚_<br><strong>Replacing the <code>state</code></strong></p><p>You can replace the whole state of a store by setting its <code>$state</code> property to a new object:<br><em>ä½ å¯ä»¥é€šè¿‡è®¾ç½®å­˜å‚¨çš„ <code>$state</code> å±æ€§æ¥æ›¿æ¢å®ƒçš„çŠ¶æ€ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">store.$state &#x3D; &#123; counter: 666, name: &quot;Paimon&quot; &#125;;</code></pre><p>You can also replace the whole state of your application by changing the <code>state</code> of the <code>pinia</code> instance. This is used during <a href="../ssr/#state-hydration">SSR for hydration</a>.<br><em>ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ›´æ”¹ <code>pinia</code> å®ä¾‹çš„ <code>state</code> æ¥æ›¿æ¢æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€ã€‚è¿™ç”¨äº <a href="../ssr/#state-hydration">SSR for hydration</a>ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">pinia.state.value &#x3D; &#123;&#125;;</code></pre><p><strong>Subscribing to the state</strong></p><p>You can watch the state and its changes through the <code>$subscribe()</code> method of a store, similar to Vuexâ€™s <a href="https://vuex.vuejs.org/api/#subscribe">subscribe method</a>. The advantage of using <code>$subscribe()</code> over a regular <code>watch()</code> is that <em>subscriptions</em> will trigger only once after <em>patches</em> (e.g. when using the function version from above).<br><em>ä½ å¯ä»¥é€šè¿‡å­˜å‚¨çš„ <code>$subscribe()</code> æ–¹æ³•æ¥è®¢é˜…çŠ¶æ€ï¼Œä¸ Vuex çš„ <a href="https://vuex.vuejs.org/api/#subscribe">subscribe æ–¹æ³•</a> ç±»ä¼¼ã€‚ä½¿ç”¨ <code>$subscribe()</code> æ–¹æ³•æ¥è®¢é˜…çŠ¶æ€ï¼Œä¼˜åŠ¿åœ¨äºå®ƒä¼šåœ¨å˜æ›´ååªè§¦å‘ä¸€æ¬¡è®¢é˜…ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ä¸Šé¢çš„å‡½æ•°ç‰ˆæœ¬ï¼‰ã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">cartStore.$subscribe((mutation, state) &#x3D;&gt; &#123;  &#x2F;&#x2F; import &#123; MutationType &#125; from &#39;pinia&#39;  mutation.type; &#x2F;&#x2F; &#39;direct&#39; | &#39;patch object&#39; | &#39;patch function&#39;  &#x2F;&#x2F; same as cartStore.$id  mutation.storeId; &#x2F;&#x2F; &#39;cart&#39;  &#x2F;&#x2F; only available with mutation.type &#x3D;&#x3D;&#x3D; &#39;patch object&#39;  mutation.payload; &#x2F;&#x2F; patch object passed to cartStore.$patch()  &#x2F;&#x2F; persist the whole state to the local storage whenever it changes  localStorage.setItem(&quot;cart&quot;, JSON.stringify(state));&#125;);</code></pre><p>By default, <em>state subscriptions</em> are bound to the component where they are added (if the store is inside a componentâ€™s <code>setup()</code>). Meaning, they will be automatically removed when the component is unmounted. If you want to keep them after the component is unmounted, pass <code>&#123; detached: true &#125;</code> as the second argument to <em>detach</em> the <em>state subscription</em> from the current component:<br><em>é»˜è®¤æƒ…å†µä¸‹ï¼Œ_çŠ¶æ€è®¢é˜…_ä¼šç»‘å®šåˆ°æ·»åŠ å®ƒçš„ç»„ä»¶ï¼ˆå¦‚æœå­˜å‚¨åœ¨ç»„ä»¶çš„ <code>setup()</code> ä¸­ï¼‰ã€‚æ„å‘³ç€ï¼Œå®ƒä¼šåœ¨ç»„ä»¶å¸è½½åè‡ªåŠ¨åˆ é™¤ã€‚å¦‚æœä½ æƒ³è¦åœ¨ç»„ä»¶å¸è½½åä¿æŒå®ƒä»¬ï¼Œå¯ä»¥å°† <code>&#123; detached: true &#125;</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™ <em>detach</em> <em>çŠ¶æ€è®¢é˜…</em> ä»å½“å‰ç»„ä»¶ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default &#123;  setup() &#123;    const someStore &#x3D; useSomeStore();    &#x2F;&#x2F; this subscription will be kept after the component is unmounted    someStore.$subscribe(callback, &#123; detached: true &#125;);    &#x2F;&#x2F; ...  &#125;,&#125;;</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>You can watch the whole state on the <code>pinia</code> instance:<br>ä½ å¯ä»¥ç›‘å¬æ•´ä¸ªpiniaå®ä¾‹çš„çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„storeçš„çŠ¶æ€ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">watch(  pinia.state,  (state) &#x3D;&gt; &#123;    &#x2F;&#x2F; persist the whole state to the local storage whenever it changes    localStorage.setItem(&quot;piniaState&quot;, JSON.stringify(state));  &#125;,  &#123; deep: true &#125;);</code></pre></p></div><h2 id="Getters"><a href="#Getters" class="headerlink" title="Getters"></a>Getters</h2><p><VueSchoolLink  href="https://vueschool.io/lessons/getters-in-pinia"  title="Learn all about getters in Pinia"/></p><p>Getters are exactly the equivalent of <a href="https://v3.vuejs.org/guide/reactivity-computed-watchers.html#computed-values">computed values</a> for the state of a Store. They can be defined with the <code>getters</code> property in <code>defineStore()</code>. They receive the <code>state</code> as the first parameter <strong>to encourage</strong> the usage of arrow function:<br><em>è·å–å™¨æ˜¯çŠ¶æ€çš„è®¡ç®—å€¼ã€‚å®ƒä»¬å¯ä»¥é€šè¿‡ <code>defineStore()</code> ä¸­çš„ <code>getters</code> å±æ€§æ¥å®šä¹‰ã€‚å®ƒä»¬ä¼šæ¥æ”¶ <code>state</code>ï¼ˆä½¿ç”¨ç®­å¤´å‡½æ•°ï¼‰ ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0,  &#125;),  getters: &#123;    doubleCount: (state) &#x3D;&gt; state.counter * 2,  &#125;,&#125;)</code></pre><p>Most of the time, getters will only rely on the state, however, they might need to use other getters. Because of this, we can get access to the <em>whole store instance</em> through <code>this</code> when defining a regular function <strong>but it is necessary to define the type of the return type (in TypeScript)</strong>. This is due to a known limitation in TypeScript and <strong>doesnâ€™t affect getters defined with an arrow function nor getters not using <code>this</code></strong>:<br><em>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè·å–å™¨åªä¾èµ–äºçŠ¶æ€ï¼Œä½†å®ƒä»¬å¯èƒ½éœ€è¦ä½¿ç”¨å…¶ä»–è·å–å™¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>this</code> è®¿é—®åˆ°æ•´ä¸ªå­˜å‚¨å®ä¾‹ï¼ˆä½†æ˜¯éœ€è¦åœ¨TypeScriptä¸­å®šä¹‰è¿”å›ç±»å‹ï¼‰ï¼Œè¿™æ˜¯å› ä¸ºå·²çŸ¥çš„é™åˆ¶ï¼Œä¸å½±å“ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–ä¸ä½¿ç”¨<code>this</code>çš„è·å–å™¨ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0,  &#125;),  getters: &#123;    &#x2F;&#x2F; automatically infers the return type as a number    &#x2F;&#x2F; è‡ªåŠ¨æ¨æ–­è¿”å›ç±»å‹ä¸ºæ•°å­—    doubleCount(state) &#123;      return state.counter * 2    &#125;,    &#x2F;&#x2F; the return type **must** be explicitly set    &#x2F;&#x2F;  è¿”å›ç±»å‹ **å¿…é¡»** è¢«æ˜¾å¼è®¾ç½®    doublePlusOne(): number &#123;      &#x2F;&#x2F; autocompletion and typings for the whole store âœ¨      &#x2F;&#x2F; å¯¹äºæ•´ä¸ªstoreè‡ªåŠ¨å®Œæˆå’Œç±»å‹æ¨æ–­ âœ¨      return this.doubleCount + 1    &#125;,  &#125;,&#125;)</code></pre><p>Then you can access the getter directly on the store instance:<br><em>ç„¶åä½ å¯ä»¥ç›´æ¥åœ¨å­˜å‚¨å®ä¾‹ä¸Šè®¿é—®è·å–å™¨ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&lt;template&gt;  &lt;p&gt;Double count is &#123;&#123; store.doubleCount &#125;&#125;&lt;&#x2F;p&gt;&lt;&#x2F;template&gt;&lt;script&gt;export default &#123;  setup() &#123;    const store &#x3D; useStore()    return &#123; store &#125;  &#125;,&#125;&lt;&#x2F;script&gt;</code></pre><h2 id="Accessing-other-getters"><a href="#Accessing-other-getters" class="headerlink" title="Accessing other getters"></a>Accessing other getters</h2><p>As with computed properties, you can combine multiple getters. Access any other getter via <code>this</code>. Even if you are not using TypeScript, you can hint your IDE for types with the <a href="https://jsdoc.app/tags-returns.html">JSDoc</a>:<br><em>å¦‚åŒè®¡ç®—å±æ€§ï¼Œä½ å¯ä»¥å°†å¤šä¸ªè·å–å™¨ç»„åˆåœ¨ä¸€èµ·ã€‚é€šè¿‡ <code>this</code> è®¿é—®å…¶ä»–è·å–å™¨ã€‚å³ä½¿ä½ ä¸ä½¿ç”¨TypeScriptï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡<a href="https://jsdoc.app/tags-returns.html">JSDoc</a>æç¤ºä½ çš„IDEç±»å‹ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0,  &#125;),  getters: &#123;    &#x2F;&#x2F; type is automatically inferred because we are not using &#96;this&#96;    &#x2F;&#x2F; ç±»å‹è‡ªåŠ¨æ¨æ–­ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ä½¿ç”¨&#96;this&#96;    doubleCount: (state) &#x3D;&gt; state.counter * 2,    &#x2F;&#x2F; here we need to add the type ourselves (using JSDoc in JS). We can also    &#x2F;&#x2F; use this to document the getter    &#x2F;&#x2F; åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ·»åŠ ç±»å‹ï¼ˆä½¿ç”¨JSDocåœ¨JSï¼‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ¥æè¿°è·å–å™¨    &#x2F;**     * Returns the counter value times two plus one.     *     * @returns &#123;number&#125;     *&#x2F;    doubleCountPlusOne() &#123;      &#x2F;&#x2F; autocompletion âœ¨      return this.doubleCount + 1    &#125;,  &#125;,&#125;)</code></pre><h2 id="Passing-arguments-to-getters"><a href="#Passing-arguments-to-getters" class="headerlink" title="Passing arguments to getters"></a>Passing arguments to getters</h2><p><em>Getters</em> are just <em>computed</em> properties behind the scenes, so itâ€™s not possible to pass any parameters to them. However, you can return a function from the <em>getter</em> to accept any arguments:<br><em>è·å–å™¨æ˜¯ç»„ä»¶çš„è®¡ç®—å±æ€§ï¼Œå› æ­¤ä¸èƒ½ä¼ é€’ä»»ä½•å‚æ•°ã€‚ç„¶è€Œï¼Œä½ å¯ä»¥ä»è·å–å™¨è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä»»ä½•å‚æ•°ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  getters: &#123;    getUserById: (state) &#x3D;&gt; &#123;      return (userId) &#x3D;&gt; state.users.find((user) &#x3D;&gt; user.id &#x3D;&#x3D;&#x3D; userId)    &#125;,  &#125;,&#125;)</code></pre><p>and use in component:<br><em>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&lt;script&gt;export default &#123;  setup() &#123;    const store &#x3D; useStore()    return &#123; getUserById: store.getUserById &#125;  &#125;,&#125;&lt;&#x2F;script&gt;&lt;template&gt;  &lt;p&gt;User 2: &#123;&#123; getUserById(2) &#125;&#125;&lt;&#x2F;p&gt;&lt;&#x2F;template&gt;</code></pre><p>Note that when doing this, <strong>getters are not cached anymore</strong>, they are simply functions that you invoke. You can however cache some results inside of the getter itself, which is uncommon but should prove more performant:<br><em>æ³¨æ„ï¼Œå½“è¿™åšçš„æ—¶å€™ï¼Œ<strong>è·å–å™¨ä¸å†ç¼“å­˜äº†</strong>ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥åœ¨è·å–å™¨å†…éƒ¨ç¼“å­˜ä¸€äº›ç»“æœï¼Œè¿™æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„æƒ…å†µï¼Œä½†æ˜¯åº”è¯¥æ›´æœ‰æ•ˆç‡ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  getters: &#123;    getActiveUserById(state) &#123;      const activeUsers &#x3D; state.users.filter((user) &#x3D;&gt; user.active)      return (userId) &#x3D;&gt; activeUsers.find((user) &#x3D;&gt; user.id &#x3D;&#x3D;&#x3D; userId)    &#125;,  &#125;,&#125;)</code></pre><h2 id="Accessing-other-stores-getters"><a href="#Accessing-other-stores-getters" class="headerlink" title="Accessing other stores getters"></a>Accessing other stores getters</h2><p>To use another store getters, you can directly <em>use it</em> inside of the <em>getter</em>:<br><em>è¦ä½¿ç”¨å¦ä¸€ä¸ªå­˜å‚¨è·å–å™¨ï¼Œå¯ä»¥ç›´æ¥åœ¨è·å–å™¨ä¸­_ä½¿ç”¨å®ƒ_ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useOtherStore &#125; from &#39;.&#x2F;other-store&#39;export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  state: () &#x3D;&gt; (&#123;    &#x2F;&#x2F; ...  &#125;),  getters: &#123;    otherGetter(state) &#123;      const otherStore &#x3D; useOtherStore()      return state.localData + otherStore.data    &#125;,  &#125;,&#125;)</code></pre><h2 id="Usage-with-setup"><a href="#Usage-with-setup" class="headerlink" title="Usage with setup()"></a>Usage with <code>setup()</code></h2><p>You can directly access any getter as a property of the store (exactly like state properties):<br><em>ä½ å¯ä»¥ç›´æ¥åœ¨å­˜å‚¨ä¸­ä½œä¸ºå±æ€§è®¿é—®ä»»ä½•è·å–å™¨ï¼ˆç²¾å‡†åœ°å¦‚åŒçŠ¶æ€å±æ€§ï¼‰ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default &#123;  setup() &#123;    const store &#x3D; useStore()    store.counter &#x3D; 3    store.doubleCount &#x2F;&#x2F; 6  &#125;,&#125;</code></pre><h2 id="Usage-with-the-Options-API"><a href="#Usage-with-the-Options-API" class="headerlink" title="Usage with the Options API"></a>Usage with the Options API</h2><p><VueSchoolLink  href="https://vueschool.io/lessons/access-pinia-getters-in-the-options-api"  title="Access Pinia Getters via the Options API"/></p><p>For the following examples, you can assume the following store was created:<br><em>å¯¹äºä¸‹é¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥å‡è®¾ä»¥ä¸‹å­˜å‚¨å·²åˆ›å»ºï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Example File Path:&#x2F;&#x2F; .&#x2F;src&#x2F;stores&#x2F;counterStore.jsimport &#123; defineStore &#125; from &#39;pinia&#39;,const useCounterStore &#x3D; defineStore(&#39;counterStore&#39;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0  &#125;),  getters: &#123;    doubleCounter(state) &#123;      return state.counter * 2    &#125;  &#125;&#125;)</code></pre><h3 id="With-setup"><a href="#With-setup" class="headerlink" title="With setup()"></a>With <code>setup()</code></h3><p>While Composition API is not for everyone, the <code>setup()</code> hook can make using Pinia easier to work with in the Options API. No extra map helper functions needed!<br><em>è€Œä¸æ˜¯æ‰€æœ‰äººéƒ½éœ€è¦ä½¿ç”¨ç»„åˆAPIï¼Œ<code>setup()</code>é’©å­å¯ä»¥è®©Piniaæ›´å®¹æ˜“åœ°åœ¨Options APIä¸­ä½¿ç”¨ã€‚æ²¡æœ‰é¢å¤–çš„æ˜ å°„åŠ©æ‰‹å‡½æ•°éœ€è¦ï¼</em></p><h2 id="è¿™æ˜¯ä¸€ä¸ªä¼˜ç‚¹"><a href="#è¿™æ˜¯ä¸€ä¸ªä¼˜ç‚¹" class="headerlink" title="è¿™æ˜¯ä¸€ä¸ªä¼˜ç‚¹"></a>è¿™æ˜¯ä¸€ä¸ªä¼˜ç‚¹</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useCounterStore &#125; from &#39;..&#x2F;stores&#x2F;counterStore&#39;export default &#123;  setup() &#123;    const counterStore &#x3D; useCounterStore()    return &#123; counterStore &#125;  &#125;,  computed: &#123;    quadrupleCounter() &#123;      return this.counterStore.doubleCounter * 2    &#125;,  &#125;,&#125;</code></pre><h3 id="Without-setup"><a href="#Without-setup" class="headerlink" title="Without setup()"></a>Without <code>setup()</code></h3><p>You can use the same <code>mapState()</code> function used in the <a href="./state.md#options-api">previous section of state</a> to map to getters:<br><em>ä½ å¯ä»¥ä½¿ç”¨åœ¨<a href="./state.md#options-api">ä¸Šä¸€èŠ‚çŠ¶æ€</a>ä¸­ä½¿ç”¨çš„<code>mapState()</code>å‡½æ•°æ¥æ˜ å°„åˆ°è·å–å™¨ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; mapState &#125; from &#39;pinia&#39;import &#123; useCounterStore &#125; from &#39;..&#x2F;stores&#x2F;counterStore&#39;export default &#123;  computed: &#123;    &#x2F;&#x2F; gives access to this.doubleCounter inside the component    &#x2F;&#x2F; same as reading from store.doubleCounter    ...mapState(useCounterStore, [&#39;doubleCount&#39;])    &#x2F;&#x2F; same as above but registers it as this.myOwnName    ...mapState(useCounterStore, &#123;      myOwnName: &#39;doubleCounter&#39;,      &#x2F;&#x2F; you can also write a function that gets access to the store      double: store &#x3D;&gt; store.doubleCount,    &#125;),  &#125;,&#125;</code></pre><h1 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h1><p><VueSchoolLink  href="https://vueschool.io/lessons/synchronous-and-asynchronous-actions-in-pinia"  title="Learn all about actions in Pinia"/></p><p>Actions are the equivalent of <a href="https://v3.vuejs.org/guide/data-methods.html#methods">methods</a> in components. They can be defined with the <code>actions</code> property in <code>defineStore()</code> and <strong>they are perfect to define business logic</strong>:<br><em>åœ¨<code>defineStore()</code>ä¸­å®šä¹‰çš„<code>actions</code>å±æ€§æ˜¯ç»„ä»¶çš„æ–¹æ³•ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥å®šä¹‰ä¸šåŠ¡é€»è¾‘ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export const useStore &#x3D; defineStore(&#39;main&#39;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0,  &#125;),  actions: &#123;    increment() &#123;      this.counter++    &#125;,    randomizeCounter() &#123;      this.counter &#x3D; Math.round(100 * Math.random())    &#125;,  &#125;,&#125;)</code></pre><p>Like <a href="./getters.md">getters</a>, actions get access to the <em>whole store instance</em> through <code>this</code> with <strong>full typing (and autocompletion âœ¨) support</strong>. <strong>Unlike getters, <code>actions</code> can be asynchronous</strong>, you can <code>await</code> inside of actions any API call or even other actions! Here is an example using <a href="https://github.com/posva/mande">Mande</a>. Note the library you use doesnâ€™t matter as long as you get a <code>Promise</code>, you could even use the native <code>fetch</code> function (browser only):<br><em>åƒ<a href="./getters.md">è·å–å™¨</a>ä¸€æ ·ï¼Œactionså¯ä»¥é€šè¿‡<code>this</code>è®¿é—®æ•´ä¸ªå­˜å‚¨å®ä¾‹ï¼Œ<strong>å®ƒä»¬å¯ä»¥æ˜¯å¼‚æ­¥çš„</strong>ï¼Œä½ å¯ä»¥åœ¨actionsä¸­ä½¿ç”¨<code>await</code>ä»»ä½•APIè°ƒç”¨æˆ–è€…å¯ä»¥ä½¿ç”¨å…¶ä»–actionsï¼è¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨[Mande](</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; mande &#125; from &#39;mande&#39;const api &#x3D; mande(&#39;&#x2F;api&#x2F;users&#39;)export const useUsers &#x3D; defineStore(&#39;users&#39;, &#123;  state: () &#x3D;&gt; (&#123;    userData: null,    &#x2F;&#x2F; ...  &#125;),  actions: &#123;    async registerUser(login, password) &#123;      try &#123;        this.userData &#x3D; await api.post(&#123; login, password &#125;)        showTooltip(&#96;Welcome back $&#123;this.userData.name&#125;!&#96;)      &#125; catch (error) &#123;        showTooltip(error)        &#x2F;&#x2F; let the form component display the error        return error      &#125;    &#125;,  &#125;,&#125;)</code></pre><p>You are also completely free to set whatever arguments you want and return anything. When calling actions, everything will be automatically inferred!<br><em>ä½ å¯ä»¥è®¾ç½®ä»»ä½•å‚æ•°å’Œè¿”å›ä»»ä½•ä¸œè¥¿ï¼Œå½“è°ƒç”¨actionsæ—¶ï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½ä¼šè‡ªåŠ¨æ¨æ–­ï¼</em><br>Actions are invoked like methods:<br><em>actionsåƒæ–¹æ³•è¢«è°ƒç”¨ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default defineComponent(&#123;  setup() &#123;    const main &#x3D; useMainStore()    &#x2F;&#x2F; call the action as a method of the store    main.randomizeCounter()    return &#123;&#125;  &#125;,&#125;)</code></pre><h2 id="Accessing-other-stores-actions"><a href="#Accessing-other-stores-actions" class="headerlink" title="Accessing other stores actions"></a>Accessing other stores actions</h2><p>To use another store, you can directly <em>use it</em> inside of the <em>action</em>:<br><em>è¦ä½¿ç”¨å¦ä¸€ä¸ªå­˜å‚¨ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨_action_ä¸­ä½¿ç”¨å®ƒï¼š</em></p><h2 id="è¿™æ¯”reactå¥½ç”¨ï¼Œå¯ä»¥åµŒå¥—"><a href="#è¿™æ¯”reactå¥½ç”¨ï¼Œå¯ä»¥åµŒå¥—" class="headerlink" title="è¿™æ¯”reactå¥½ç”¨ï¼Œå¯ä»¥åµŒå¥—"></a>è¿™æ¯”reactå¥½ç”¨ï¼Œå¯ä»¥åµŒå¥—</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useAuthStore &#125; from &#39;.&#x2F;auth-store&#39;export const useSettingsStore &#x3D; defineStore(&#39;settings&#39;, &#123;  state: () &#x3D;&gt; (&#123;    preferences: null,    &#x2F;&#x2F; ...  &#125;),  actions: &#123;    async fetchUserPreferences() &#123;      const auth &#x3D; useAuthStore()      if (auth.isAuthenticated) &#123;        this.preferences &#x3D; await fetchPreferences()      &#125; else &#123;        throw new Error(&#39;User must be authenticated&#39;)      &#125;    &#125;,  &#125;,&#125;)</code></pre><h2 id="Usage-with-setup-1"><a href="#Usage-with-setup-1" class="headerlink" title="Usage with setup()"></a>Usage with <code>setup()</code></h2><p>You can directly call any action as a method of the store:<br><em>ä½ å¯ä»¥ç›´æ¥è°ƒç”¨ä»»ä½•actionä½œä¸ºstoreçš„æ–¹æ³•ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default &#123;  setup() &#123;    const store &#x3D; useStore()    store.randomizeCounter()  &#125;,&#125;</code></pre><h2 id="Usage-with-the-Options-API-1"><a href="#Usage-with-the-Options-API-1" class="headerlink" title="Usage with the Options API"></a>Usage with the Options API</h2><p><VueSchoolLink  href="https://vueschool.io/lessons/access-pinia-actions-in-the-options-api"  title="Access Pinia Getters via the Options API"/></p><p>For the following examples, you can assume the following store was created:<br><em>å¯¹äºä¸‹é¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥å‡è®¾ä»¥ä¸‹çš„å­˜å‚¨å·²ç»åˆ›å»ºï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Example File Path:&#x2F;&#x2F; .&#x2F;src&#x2F;stores&#x2F;counterStore.jsimport &#123; defineStore &#125; from &#39;pinia&#39;,const useCounterStore &#x3D; defineStore(&#39;counterStore&#39;, &#123;  state: () &#x3D;&gt; (&#123;    counter: 0  &#125;),  actions: &#123;    increment() &#123;      this.counter++    &#125;  &#125;&#125;)</code></pre><h3 id="With-setup-1"><a href="#With-setup-1" class="headerlink" title="With setup()"></a>With <code>setup()</code></h3><p>While Composition API is not for everyone, the <code>setup()</code> hook can make using Pinia easier to work with in the Options API. No extra map helper functions needed!<br><em>Composition APIä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½ç”¨ï¼Œä½†æ˜¯<code>setup()</code>é’©å­å¯ä»¥è®©Piniaæ›´åŠ ç®€å•åœ°ä½¿ç”¨åœ¨Options APIä¸­ï¼Œä¸éœ€è¦é¢å¤–çš„æ˜ å°„åŠŸèƒ½ï¼</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useCounterStore &#125; from &#39;..&#x2F;stores&#x2F;counterStore&#39;export default &#123;  setup() &#123;    const counterStore &#x3D; useCounterStore()    return &#123; counterStore &#125;  &#125;,  methods: &#123;    incrementAndPrint() &#123;      this.counterStore.increment()      console.log(&#39;New Count:&#39;, this.counterStore.count)    &#125;,  &#125;,&#125;</code></pre><h3 id="Without-setup-1"><a href="#Without-setup-1" class="headerlink" title="Without setup()"></a>Without <code>setup()</code></h3><p>If you would prefer not to use Composition API at all, you can use the <code>mapActions()</code> helper to map actions properties as methods in your component:<br><em>å¦‚æœä½ æƒ³ä¸ä½¿ç”¨Composition APIï¼Œä½ å¯ä»¥ä½¿ç”¨<code>mapActions()</code>åŠ©æ‰‹æ¥å°†actionså±æ€§æ˜ å°„ä¸ºç»„ä»¶çš„æ–¹æ³•ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; mapActions &#125; from &#39;pinia&#39;import &#123; useCounterStore &#125; from &#39;..&#x2F;stores&#x2F;counterStore&#39;export default &#123;  methods: &#123;    &#x2F;&#x2F; gives access to this.increment() inside the component    &#x2F;&#x2F; same as calling from store.increment()    ...mapActions(useCounterStore, [&#39;increment&#39;])    &#x2F;&#x2F; same as above but registers it as this.myOwnName()    ...mapActions(useCounterStore, &#123; myOwnName: &#39;doubleCounter&#39; &#125;),  &#125;,&#125;</code></pre><h2 id="Subscribing-to-actions"><a href="#Subscribing-to-actions" class="headerlink" title="Subscribing to actions"></a>Subscribing to actions</h2><p>It is possible to observe actions and their outcome with <code>store.$onAction()</code>. The callback passed to it is executed before the action itself. <code>after</code> handle promises and allows you to execute a function after the action resolves. In a similar way, <code>onError</code> allows you execute a function if the action throws or rejects. These are useful for tracking errors at runtime, similar to <a href="https://v3.vuejs.org/guide/tooling/deployment.html#tracking-runtime-errors">this tip in the Vue docs</a>.<br><em>å¯ä»¥ä½¿ç”¨<code>store.$onAction()</code>æ¥è§‚å¯Ÿactionså’Œå®ƒä»¬çš„ç»“æœã€‚ä¼ å…¥çš„å›è°ƒä¼šåœ¨actionè‡ªèº«ä¹‹å‰æ‰§è¡Œã€‚<code>after</code>å¤„ç†promisesï¼Œå…è®¸ä½ åœ¨actionè§£å†³ä¹‹åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚åŒæ ·ï¼Œ<code>onError</code>å…è®¸ä½ åœ¨actionæŠ›å‡ºæˆ–è€…rejectä¹‹åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚è¿™äº›æ˜¯ç”¨äºè·Ÿè¸ªè¿è¡Œæ—¶é”™è¯¯çš„å¥½æ–¹æ³•ï¼Œç±»ä¼¼äº<a href="https://v3.vuejs.org/guide/tooling/deployment.html#tracking-runtime-errors">è¿™ä¸ªæç¤ºåœ¨Vueæ–‡æ¡£</a>ã€‚</em><br>Here is an example that logs before running actions and after they resolve&#x2F;reject.<br><em>è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå®ƒä¼šåœ¨æ‰§è¡Œactionsä¹‹å‰å’Œä¹‹åè§£å†³&#x2F;rejectã€‚</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const unsubscribe &#x3D; someStore.$onAction(  (&#123;    name, &#x2F;&#x2F; name of the action    store, &#x2F;&#x2F; store instance, same as &#96;someStore&#96;    args, &#x2F;&#x2F; array of parameters passed to the action    after, &#x2F;&#x2F; hook after the action returns or resolves    onError, &#x2F;&#x2F; hook if the action throws or rejects  &#125;) &#x3D;&gt; &#123;    &#x2F;&#x2F; a shared variable for this specific action call    &#x2F;&#x2F; å…±äº«å˜é‡ï¼Œè¿™ä¸ªç‰¹å®šçš„actionè°ƒç”¨    const startTime &#x3D; Date.now()    &#x2F;&#x2F; this will trigger before an action on &#96;store&#96; is executed    &#x2F;&#x2F; è¿™å°†è§¦å‘åœ¨&#96;store&#96;ä¸Šæ‰§è¡Œactionä¹‹å‰    console.log(&#96;Start &quot;$&#123;name&#125;&quot; with params [$&#123;args.join(&#39;, &#39;)&#125;].&#96;)    &#x2F;&#x2F; this will trigger if the action succeeds and after it has fully run.    &#x2F;&#x2F; è¿™å°†è§¦å‘å¦‚æœactionæˆåŠŸå¹¶ä¸”å®Œæˆè¿è¡Œã€‚    &#x2F;&#x2F; it waits for any returned promised    &#x2F;&#x2F;  å®ƒç­‰å¾…ä»»ä½•è¿”å›çš„promised    after((result) &#x3D;&gt; &#123;      console.log(        &#96;Finished &quot;$&#123;name&#125;&quot; after $&#123;          Date.now() - startTime        &#125;ms.\nResult: $&#123;result&#125;.&#96;      )    &#125;)    &#x2F;&#x2F; this will trigger if the action throws or returns a promise that rejects    &#x2F;&#x2F;  è¿™å°†è§¦å‘å¦‚æœactionæŠ›å‡ºæˆ–è€…è¿”å›ä¸€ä¸ªpromiseï¼Œreject    onError((error) &#x3D;&gt; &#123;      console.warn(        &#96;Failed &quot;$&#123;name&#125;&quot; after $&#123;Date.now() - startTime&#125;ms.\nError: $&#123;error&#125;.&#96;      )    &#125;)  &#125;)&#x2F;&#x2F; manually remove the listener&#x2F;&#x2F; æ‰‹åŠ¨ç§»é™¤ç›‘å¬å™¨unsubscribe()</code></pre><p>By default, <em>action subscriptions</em> are bound to the component where they are added (if the store is inside a componentâ€™s <code>setup()</code>). Meaning, they will be automatically removed when the component is unmounted. If you want to keep them after the component is unmounted, pass <code>true</code> as the second argument to <em>detach</em> the <em>action subscription</em> from the current component:<br><em>é»˜è®¤æƒ…å†µä¸‹ï¼Œactionè®¢é˜…æ˜¯ç»‘å®šåˆ°æ·»åŠ å®ƒä»¬çš„ç»„ä»¶ï¼ˆå¦‚æœstoreåœ¨ç»„ä»¶çš„setupä¸­ï¼‰ã€‚æ„æ€æ˜¯ï¼Œå®ƒä»¬ä¼šåœ¨ç»„ä»¶è¢«å¸è½½åè‡ªåŠ¨ç§»é™¤ã€‚å¦‚æœä½ æƒ³è¦ä¿æŒå®ƒä»¬åœ¨ç»„ä»¶è¢«å¸è½½åï¼Œå°†ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™_detach_actionè®¢é˜…_ä»å½“å‰ç»„ä»¶ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default &#123;  setup() &#123;    const someStore &#x3D; useSomeStore()    &#x2F;&#x2F; this subscription will be kept after the component is unmounted    someStore.$onAction(callback, true)    &#x2F;&#x2F; ...  &#125;,&#125;</code></pre><h1 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h1><p>Pinia stores can be fully extended thanks to a low level API. Here is a list of things you can do:<br><em>Pinia storeså¯ä»¥å®Œå…¨æ‰©å±•ï¼Œé€šè¿‡ä¸€ä¸ªä½çº§APIã€‚è¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä½ å¯ä»¥åšçš„äº‹æƒ…ï¼š</em></p><ul><li>Add <code>new properties</code> to stores <em>ç»™storesæ·»åŠ æ–°çš„å±æ€§</em></li><li>Add <code>new options</code> when defining stores <em>åœ¨å®šä¹‰storesæ—¶æ·»åŠ æ–°çš„é€‰é¡¹</em></li><li>Add <code>new methods</code> to stores <em>ç»™storesæ·»åŠ æ–°çš„æ–¹æ³•</em></li><li>Wrap <code>existing methods</code> <em>åŒ…è£…ç°æœ‰çš„æ–¹æ³•</em></li><li>Change or even cancel <code>actions</code> <em>æ”¹å˜æˆ–å–æ¶ˆactions</em></li><li>Implement side effects like <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">Local Storage</a> <em>å®ç°å‰¯ä½œç”¨æ•ˆæœï¼Œä¾‹å¦‚localStorage</em></li><li>Apply <strong>only</strong> to specific stores <em>åªåº”ç”¨åˆ°ç‰¹å®šçš„stores</em></li></ul><p>Plugins are added to the pinia instance with <code>pinia.use()</code>. The simplest example is adding a static property to all stores by returning an object:<br><em>æ’ä»¶æ˜¯æ·»åŠ åˆ°piniaå®ä¾‹çš„<code>pinia.use()</code>ã€‚æœ€ç®€å•çš„ä¾‹å­æ˜¯æ·»åŠ ä¸€ä¸ªé™æ€å±æ€§åˆ°æ‰€æœ‰storesï¼Œé€šè¿‡è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; createPinia &#125; from &#39;pinia&#39;&#x2F;&#x2F; add a property named &#96;secret&#96; to every store that is created after this plugin is installed&#x2F;&#x2F; this could be in a different filefunction SecretPiniaPlugin() &#123;  return &#123; secret: &#39;the cake is a lie&#39; &#125;&#125;const pinia &#x3D; createPinia()&#x2F;&#x2F; give the plugin to piniapinia.use(SecretPiniaPlugin)&#x2F;&#x2F; in another fileconst store &#x3D; useStore()store.secret &#x2F;&#x2F; &#39;the cake is a lie&#39;</code></pre><p>This is useful to add global objects like the router, modal, or toast managers.<br><em>è¿™æ˜¯æœ‰ç”¨çš„ï¼Œä¾‹å¦‚routerã€modalæˆ–toastç®¡ç†å™¨</em></p><h2 id="Introduction-1"><a href="#Introduction-1" class="headerlink" title="Introduction"></a>Introduction</h2><p>A Pinia plugin is a function that optionally returns properties to be added to a store. It takes one optional argument, a <em>context</em>:<br><em>ä¸€ä¸ªPiniaæ’ä»¶æ˜¯ä¸€ä¸ªå¯é€‰çš„è¿”å›å±æ€§çš„å‡½æ•°ã€‚å®ƒåªæ¥å—ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œä¸€ä¸ª_context_ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">export function myPiniaPlugin(context) &#123;  context.pinia &#x2F;&#x2F; the pinia created with &#96;createPinia()&#96;   context.app &#x2F;&#x2F; the current app created with &#96;createApp()&#96; (Vue 3 only)  context.store &#x2F;&#x2F; the store the plugin is augmenting  context.options &#x2F;&#x2F; the options object defining the store passed to &#96;defineStore()&#96;  &#x2F;&#x2F; ...&#125;</code></pre><p>This function is then passed to <code>pinia</code> with <code>pinia.use()</code>:<br><em>è¿™ä¸ªå‡½æ•°æ˜¯é€šè¿‡<code>pinia.use()</code>ä¼ é€’ç»™<code>pinia</code>ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">pinia.use(myPiniaPlugin)</code></pre><p>Plugins are only applied to stores <strong>created after <code>pinia</code> is passed to the app</strong>, otherwise they wonâ€™t be applied.<br><em>æ’ä»¶åªåº”ç”¨åˆ°stores <strong>åœ¨<code>pinia</code>è¢«ä¼ é€’ç»™appååˆ›å»º</strong>ï¼Œå¦åˆ™å®ƒä»¬ä¸ä¼šåº”ç”¨</em></p><h2 id="Augmenting-a-Store"><a href="#Augmenting-a-Store" class="headerlink" title="Augmenting a Store"></a>Augmenting a Store</h2><p>You can add properties to every store by simply returning an object of them in a plugin:<br><em>ä½ å¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ªå¯¹è±¡æ¥ç»™æ¯ä¸ªstoreæ·»åŠ å±æ€§</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">pinia.use(() &#x3D;&gt; (&#123; hello: &#39;world&#39; &#125;))</code></pre><p>You can also set the property directly on the <code>store</code> but <strong>if possible use the return version so they can be automatically tracked by devtools</strong>:<br><em>ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç»™storeè®¾ç½®å±æ€§ï¼Œä½†æ˜¯<strong>å¦‚æœå¯èƒ½ï¼Œè¯·ä½¿ç”¨è¿”å›ç‰ˆæœ¬ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥è¢«è‡ªåŠ¨è¿½è¸ª</strong></em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  store.hello &#x3D; &#39;world&#39;&#125;)</code></pre><p>Any property <em>returned</em> by a plugin will be automatically tracked by devtools so in order to make <code>hello</code> visible in devtools, make sure to add it to <code>store._customProperties</code> <strong>in dev mode only</strong> if you want to debug it in devtools:<br>_ä»»ä½•æ’ä»¶è¿”å›çš„å±æ€§éƒ½ä¼šè¢«è‡ªåŠ¨è¿½è¸ªè¢«devtoolsè¿½è¸ªï¼Œæ‰€ä»¥è¦è®©helloå¯è§åœ¨devtoolsï¼Œè¯·åœ¨devæ¨¡å¼ä¸‹ï¼Œå¦‚æœä½ æƒ³è¦è°ƒè¯•å®ƒåœ¨devtoolsï¼Œè¯·åœ¨store.<em>customPropertiesä¸­æ·»åŠ å®ƒï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; from the example abovepinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  store.hello &#x3D; &#39;world&#39;  &#x2F;&#x2F; make sure your bundler handle this. webpack and vite should do it by default  &#x2F;&#x2F; ç¡®å®šä½ çš„bundlerå¤„ç†è¿™ä¸ªã€‚é»˜è®¤æƒ…å†µwebpackå’Œviteåº”è¯¥åšå®ƒ  if (process.env.NODE_ENV &#x3D;&#x3D;&#x3D; &#39;development&#39;) &#123;    &#x2F;&#x2F; add any keys you set on the store    &#x2F;&#x2F; åœ¨storeä¸Šæ·»åŠ ä»»ä½•ä½ è®¾ç½®çš„é”®    store._customProperties.add(&#39;hello&#39;)  &#125;&#125;)</code></pre><p>Note that every store is wrapped with <a href="https://v3.vuejs.org/api/basic-reactivity.html#reactive"><code>reactive</code></a>, automatically unwrapping any Ref (<code>ref()</code>, <code>computed()</code>, â€¦) it contains:<br><em>æ³¨æ„ï¼Œæ¯ä¸ªstoreéƒ½ä¼šè¢«åŒ…è£¹åœ¨<a href="https://v3.vuejs.org/api/basic-reactivity.html#reactive"><code>reactive</code></a>ï¼Œè‡ªåŠ¨è§£å¼€ä»»ä½•Refï¼ˆ<code>ref()</code>, <code>computed()</code>, â€¦ï¼‰å®ƒåŒ…å«ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const sharedRef &#x3D; ref(&#39;shared&#39;)pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  &#x2F;&#x2F; each store has its individual &#96;hello&#96; property  &#x2F;&#x2F; æ¯ä¸ªstoreéƒ½æœ‰å®ƒè‡ªå·±çš„&#96;hello&#96;å±æ€§  store.hello &#x3D; ref(&#39;secret&#39;)  &#x2F;&#x2F; it gets automatically unwrapped  &#x2F;&#x2F; è¿™ä¼šè¢«è‡ªåŠ¨è§£å¼€  store.hello &#x2F;&#x2F; &#39;secret&#39;  &#x2F;&#x2F; all stores are sharing the value &#96;shared&#96; property  &#x2F;&#x2F; æ‰€æœ‰storeå…±äº«&#96;shared&#96;å±æ€§  store.shared &#x3D; sharedRef  store.shared &#x2F;&#x2F; &#39;shared&#39;&#125;)</code></pre><p>This is why you can access all computed properties without <code>.value</code> and why they are reactive.<br><em>è¿™æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥ä¸ä½¿ç”¨<code>.value</code>æ¥è®¿é—®æ‰€æœ‰è®¡ç®—å±æ€§ï¼Œå¹¶ä¸”å®ƒä»¬æ˜¯ååº”æ€§çš„</em></p><h3 id="Adding-new-state"><a href="#Adding-new-state" class="headerlink" title="Adding new state"></a>Adding new state</h3><p>If you want to add new state properties to a store or properties that are meant to be used during hydration, <strong>you will have to add it in two places</strong>:<br><em>å¦‚æœä½ æƒ³è¦ç»™storeæˆ–è€…æƒ³è¦åœ¨åŒæ„æ—¶ä½¿ç”¨çš„å±æ€§ï¼Œä½ éœ€è¦åœ¨ä¸¤å¤„æ·»åŠ ï¼š</em></p><ul><li>On the <code>store</code> so you can access it with <code>store.myState</code> <em>åœ¨storeä¸Šä½ å¯ä»¥é€šè¿‡<code>store.myState</code>è®¿é—®å®ƒ</em></li><li>On <code>store.$state</code> so it can be used in devtools and, <strong>be serialized during SSR</strong>. <em>åœ¨store.$stateä¸Šä½ å¯ä»¥è®¿é—®å®ƒåœ¨devtoolså’Œï¼Œ<strong>åœ¨SSRæ—¶ä¼šè¢«åºåˆ—åŒ–</strong></em></li></ul><p>On top of that, you will certainly have to use a <code>ref()</code> (or other reactive API) in order to share the value across different accesses:<br><em>åœ¨é¡¶éƒ¨ï¼Œä½ å¿…é¡»ä½¿ç”¨<code>ref()</code>ï¼ˆæˆ–å…¶ä»–ååº”æ€§APIï¼‰æ¥å…±äº«å€¼ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; toRef, ref &#125; from &#39;vue&#39;pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  &#x2F;&#x2F; to correctly handle SSR, we need to make sure we are not overriding an  &#x2F;&#x2F; existing value  &#x2F;&#x2F; ä¸ºäº†æ­£ç¡®å¤„ç†SSRï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬ä¸ä¼šè¦†ç›–ç°æœ‰å€¼  if (!Object.prototype.hasOwnProperty(store.$state, &#39;hasError&#39;)) &#123;    &#x2F;&#x2F; hasError is defined within the plugin, so each store has their individual    &#x2F;&#x2F; state property    &#x2F;&#x2F; hasErroræ˜¯åœ¨æ’ä»¶ä¸­å®šä¹‰çš„ï¼Œæ‰€ä»¥æ¯ä¸ªstoreéƒ½æœ‰å®ƒè‡ªå·±çš„çŠ¶æ€å±æ€§    const hasError &#x3D; ref(false)    &#x2F;&#x2F; setting the variable on &#96;$state&#96;, allows it be serialized during SSR    &#x2F;&#x2F; è®¾ç½®å®ƒåœ¨&#96;$state&#96;ï¼Œè¿™æ ·å®ƒå¯ä»¥åœ¨SSRæ—¶è¢«åºåˆ—åŒ–    store.$state.hasError &#x3D; hasError  &#125;  &#x2F;&#x2F; we need to transfer the ref from the state to the store, this way  &#x2F;&#x2F; both accesses: store.hasError and store.$state.hasError will work  &#x2F;&#x2F; and share the same variable  &#x2F;&#x2F; æˆ‘ä»¬éœ€è¦å°†refä»çŠ¶æ€ä¼ é€’ç»™storeï¼Œè¿™æ ·ä¸¤ä¸ªè®¿é—®ï¼šstore.hasErrorå’Œstore.$state.hasErroréƒ½å¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸”å…±äº«ç›¸åŒçš„å˜é‡  &#x2F;&#x2F; See https:&#x2F;&#x2F;vuejs.org&#x2F;api&#x2F;reactivity-utilities.html#toref  store.hasError &#x3D; toRef(store.$state, &#39;hasError&#39;)  &#x2F;&#x2F; in this case it&#39;s better not to return &#96;hasError&#96; since it  &#x2F;&#x2F; will be displayed in the &#96;state&#96; section in the devtools  &#x2F;&#x2F; anyway and if we return it, devtools will display it twice.  &#x2F;&#x2F; åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸åº”è¯¥è¿”å›&#96;hasError&#96;ï¼Œå› ä¸ºå®ƒå°†åœ¨devtoolsçš„&#96;state&#96;éƒ¨åˆ†æ˜¾ç¤ºä¸¤æ¬¡&#125;)</code></pre><p>Note that state changes or additions that occur within a plugin (that includes calling <code>store.$patch()</code>) happen before the store is active and therefore <strong>do not trigger any subscriptions</strong>.<br><em>æ³¨æ„ï¼Œåœ¨æ’ä»¶ä¸­ï¼ˆåŒ…æ‹¬è°ƒç”¨<code>store.$patch()</code>ï¼‰å‘ç”Ÿçš„çŠ¶æ€å˜åŒ–æˆ–æ·»åŠ ï¼ˆåŒ…æ‹¬è°ƒç”¨<code>store.$patch()</code>ï¼‰<strong>ä¸ä¼šè§¦å‘ä»»ä½•è®¢é˜…</strong>ã€‚</em><br>:::warning<br>If you are using <strong>Vue 2</strong>, Pinia is subject to the <a href="https://vuejs.org/v2/guide/reactivity.html#Change-Detection-Caveats">same reactivity caveats</a> as Vue. You will need to use <code>set</code> from <code>@vue/composition-api</code> when creating new state properties like <code>secret</code> and <code>hasError</code>:<br><em>å¦‚æœä½ ä½¿ç”¨<strong>Vue 2</strong>ï¼ŒPiniaå°†å—åˆ°<a href="https://vuejs.org/v2/guide/reactivity.html#Change-Detection-Caveats">åŒç±»å‹ååº”æ€§é—®é¢˜</a>ã€‚ä½ éœ€è¦ä½¿ç”¨<code>set</code>æ¥åˆ›å»ºæ–°çš„çŠ¶æ€å±æ€§ï¼Œå¦‚<code>secret</code>å’Œ<code>hasError</code>ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; set, toRef &#125; from &#39;@vue&#x2F;composition-api&#39;pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  if (!Object.prototype.hasOwnProperty(store.$state, &#39;hello&#39;)) &#123;    const secretRef &#x3D; ref(&#39;secret&#39;)    &#x2F;&#x2F; If the data is meant to be used during SSR, you should    &#x2F;&#x2F; set it on the &#96;$state&#96; property so it is serialized and    &#x2F;&#x2F; picked up during hydration    &#x2F;&#x2F; å¦‚æœæ•°æ®æ˜¯åœ¨SSRæ—¶ä½¿ç”¨çš„ï¼Œä½ åº”è¯¥å°†å®ƒè®¾ç½®åœ¨&#96;$state&#96;å±æ€§ï¼Œè¿™æ ·å®ƒå°†è¢«åºåˆ—åŒ–å¹¶åœ¨åŒæ„æ—¶è¢«æå–    set(store.$state, &#39;secret&#39;, secretRef)  &#125;  &#x2F;&#x2F; set it directly on the store too so you can access it  &#x2F;&#x2F; both ways: &#96;store.$state.secret&#96; &#x2F; &#96;store.secret&#96;  &#x2F;&#x2F; åœ¨storeä¸Šç›´æ¥è®¾ç½®å®ƒï¼Œè¿™æ ·ä½ å¯ä»¥åœ¨ä¸¤ç§æ–¹å¼ï¼š&#96;store.$state.secret&#96; &#x2F; &#96;store.secret&#96;  set(store, &#39;secret&#39;, toRef(store.$state, &#39;secret&#39;))  store.secret &#x2F;&#x2F; &#39;secret&#39;&#125;)</code></pre><p>:::</p><h2 id="Adding-new-external-properties"><a href="#Adding-new-external-properties" class="headerlink" title="Adding new external properties"></a>Adding new external properties</h2><p>When adding external properties, class instances that come from other libraries, or simply things that are not reactive, you should wrap the object with <code>markRaw()</code> before passing it to pinia. Here is an example adding the router to every store:<br><em>å½“æ·»åŠ å¤–éƒ¨å±æ€§æ—¶ï¼Œç±»å®ä¾‹æ¥è‡ªå…¶ä»–åº“ï¼Œæˆ–è€…åªæ˜¯ä¸ååº”æ€§çš„ä¸œè¥¿ï¼Œä½ åº”è¯¥åœ¨ä¼ é€’ä¹‹å‰ä½¿ç”¨<code>markRaw()</code>ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå°†è·¯ç”±æ·»åŠ åˆ°æ¯ä¸ªstoreï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; markRaw &#125; from &#39;vue&#39;&#x2F;&#x2F; adapt this based on where your router is&#x2F;&#x2F; åŸºäºä½ çš„è·¯ç”±åœ¨è¿™é‡Œé€‚é…import &#123; router &#125; from &#39;.&#x2F;router&#39;pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  store.router &#x3D; markRaw(router)&#125;)</code></pre><h2 id="Calling-subscribe-inside-plugins"><a href="#Calling-subscribe-inside-plugins" class="headerlink" title="Calling $subscribe inside plugins"></a>Calling <code>$subscribe</code> inside plugins</h2><p>You can use <a href="./state.md#subscribing-to-the-state">store.$subscribe</a> and <a href="./actions.md#subscribing-to-actions">store.$onAction</a> inside plugins too:<br><em>ä½ å¯ä»¥åœ¨æ’ä»¶ä¸­ä½¿ç”¨<a href="./state.md#subscribing-to-the-state">store.$subscribe</a>å’Œ<a href="./actions.md#subscribing-to-actions">store.$onAction</a>ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  store.$subscribe(() &#x3D;&gt; &#123;    &#x2F;&#x2F; react to store changes    &#x2F;&#x2F; å“åº”storeå˜åŒ–  &#125;)  store.$onAction(() &#x3D;&gt; &#123;    &#x2F;&#x2F; react to store actions    &#x2F;&#x2F; å“åº”storeåŠ¨ä½œ  &#125;)&#125;)</code></pre><h2 id="Adding-new-options"><a href="#Adding-new-options" class="headerlink" title="Adding new options"></a>Adding new options</h2><p>It is possible to create new options when defining stores to later on consume them from plugins. For example, you could create a <code>debounce</code> option that allows you to debounce any action:<br><em>å¯ä»¥åœ¨å®šä¹‰storeæ—¶åˆ›å»ºæ–°çš„é€‰é¡¹ï¼Œä»¥ä¾¿ä»¥åä»æ’ä»¶ä¸­æ¶ˆè´¹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>debounce</code>é€‰é¡¹ï¼Œå…è®¸ä½ å°†ä»»ä½•åŠ¨ä½œdebounceï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">defineStore(&#39;search&#39;, &#123;  actions: &#123;    searchContacts() &#123;      &#x2F;&#x2F; ...    &#125;,  &#125;,  &#x2F;&#x2F; this will be read by a plugin later on  &#x2F;&#x2F; å°†è¢«æ’ä»¶åé¢è¯»å–  debounce: &#123;    &#x2F;&#x2F; debounce the action searchContacts by 300ms    &#x2F;&#x2F; å»¶è¿ŸåŠ¨ä½œsearchContacts 300ms    searchContacts: 300,  &#125;,&#125;)</code></pre><p>The plugin can then read that option to wrap actions and replace the original ones:<br><em>æ’ä»¶å¯ä»¥è¯»å–è¿™ä¸ªé€‰é¡¹ï¼Œä»¥ä¾¿åŒ…è£…åŠ¨ä½œå¹¶æ›¿æ¢åŸå§‹åŠ¨ä½œï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; use any debounce libraryimport debounce from &#39;lodash&#x2F;debounce&#39;pinia.use((&#123; options, store &#125;) &#x3D;&gt; &#123;  if (options.debounce) &#123;    &#x2F;&#x2F; we are overriding the actions with new ones    &#x2F;&#x2F; æˆ‘ä»¬è¦†ç›–äº†åŠ¨ä½œ compose    return Object.keys(options.debounce).reduce((debouncedActions, action) &#x3D;&gt; &#123;      debouncedActions[action] &#x3D; debounce(        store[action],        options.debounce[action]      )      return debouncedActions    &#125;, &#123;&#125;)  &#125;&#125;)</code></pre><p>Note that custom options are passed as the 3rd argument when using the setup syntax:<br><em>æ³¨æ„ï¼Œè‡ªå®šä¹‰é€‰é¡¹ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™setupè¯­æ³•ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">defineStore(  &#39;search&#39;,  () &#x3D;&gt; &#123;    &#x2F;&#x2F; ...  &#125;,  &#123;    &#x2F;&#x2F; this will be read by a plugin later on    &#x2F;&#x2F; å°†è¢«æ’ä»¶åé¢è¯»å–    debounce: &#123;      &#x2F;&#x2F; debounce the action searchContacts by 300ms      &#x2F;&#x2F; å»¶è¿ŸåŠ¨ä½œsearchContacts 300ms      searchContacts: 300,    &#125;,  &#125;)</code></pre><h2 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h2><p>Everything shown above can be done with typing support, so you donâ€™t ever need to use <code>any</code> or <code>@ts-ignore</code>.<br><em>æ‰€æœ‰ä¸Šé¢çš„éƒ½å¯ä»¥ä½¿ç”¨ç±»å‹æ”¯æŒï¼Œæ‰€ä»¥ä½ æ°¸è¿œä¸éœ€è¦ä½¿ç”¨<code>any</code>æˆ–<code>@ts-ignore</code>ã€‚</em></p><h3 id="Typing-plugins"><a href="#Typing-plugins" class="headerlink" title="Typing plugins"></a>Typing plugins</h3><p>A Pinia plugin can be typed as follows:<br><em>ä¸€ä¸ªPiniaæ’ä»¶å¯ä»¥å¦‚ä¸‹ç±»å‹ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; PiniaPluginContext &#125; from &#39;pinia&#39;export function myPiniaPlugin(context: PiniaPluginContext) &#123;  &#x2F;&#x2F; ...&#125;</code></pre><h3 id="Typing-new-store-properties"><a href="#Typing-new-store-properties" class="headerlink" title="Typing new store properties"></a>Typing new store properties</h3><p>When adding new properties to stores, you should also extend the <code>PiniaCustomProperties</code> interface.<br><em>å½“æ·»åŠ æ–°çš„å±æ€§åˆ°storeæ—¶ï¼Œä½ åº”è¯¥åŒæ—¶æ‰©å±•<code>PiniaCustomProperties</code>æ¥å£ã€‚</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#39;pinia&#39;declare module &#39;pinia&#39; &#123;  export interface PiniaCustomProperties &#123;    &#x2F;&#x2F; by using a setter we can allow both strings and refs    &#x2F;&#x2F; ä½¿ç”¨setterï¼Œæˆ‘ä»¬å¯ä»¥å…è®¸å­—ç¬¦ä¸²å’Œrefs    set hello(value: string | Ref&lt;string&gt;)    get hello(): string    &#x2F;&#x2F; you can define simpler values too    &#x2F;&#x2F; ä½ ä¹Ÿå¯ä»¥å®šä¹‰ç®€å•çš„å€¼    simpleNumber: number  &#125;&#125;</code></pre><p>It can then be written and read safely:<br><em>ç„¶åå¯ä»¥å®‰å…¨çš„å†™å’Œè¯»ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">pinia.use((&#123; store &#125;) &#x3D;&gt; &#123;  store.hello &#x3D; &#39;Hola&#39;  store.hello &#x3D; ref(&#39;Hola&#39;)  store.simpleNumber &#x3D; Math.random()  &#x2F;&#x2F; @ts-expect-error: we haven&#39;t typed this correctly  store.simpleNumber &#x3D; ref(Math.random())&#125;)</code></pre><p><code>PiniaCustomProperties</code> is a generic type that allows you to reference properties of a store. Imagine the following example where we copy over the initial options as <code>$options</code> (this would only work for option stores):<br><em><code>PiniaCustomProperties</code>æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå…è®¸ä½ å¼•ç”¨storeçš„å±æ€§ã€‚å‡è®¾æˆ‘ä»¬å°†åˆå§‹é€‰é¡¹å¤åˆ¶åˆ°<code>$options</code>ï¼ˆè¿™åªå¯¹é€‰é¡¹storeæœ‰æ•ˆï¼‰ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">pinia.use((&#123; options &#125;) &#x3D;&gt; (&#123; $options: options &#125;))</code></pre><p>We can properly type this by using the 4 generic types of <code>PiniaCustomProperties</code>:<br><em>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨<code>PiniaCustomProperties</code>çš„4ä¸ªæ³›å‹ç±»å‹æ¥ç¡®å®šç±»å‹ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#39;pinia&#39;declare module &#39;pinia&#39; &#123;  export interface PiniaCustomProperties&lt;Id, S, G, A&gt; &#123;    $options: &#123;      id: Id      state?: () &#x3D;&gt; S      getters?: G      actions?: A    &#125;  &#125;&#125;</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>When extending types in generics, they must be named <strong>exactly as in the source code</strong>. <code>Id</code> cannot be named <code>id</code> or <code>I</code>, and <code>S</code> cannot be named <code>State</code>. Here is what every letter stands for:<br><em>åœ¨æ³›å‹ä¸­æ‰©å±•ç±»å‹æ—¶ï¼Œå®ƒä»¬å¿…é¡»ä¸æºä»£ç ä¸­çš„åç§°å®Œå…¨ä¸€è‡´ã€‚<code>Id</code>ä¸èƒ½å‘½åä¸º<code>id</code>æˆ–<code>I</code>ï¼Œ<code>S</code>ä¸èƒ½å‘½åä¸º<code>State</code>ã€‚è¿™é‡Œæ˜¯æ¯ä¸ªå­—æ¯çš„å«ä¹‰ï¼š</em></p><ul><li>S: State</li><li>G: Getters</li><li>A: Actions</li><li>SS: Setup Store &#x2F; Store</li></ul></p></div><h3 id="Typing-new-state"><a href="#Typing-new-state" class="headerlink" title="Typing new state"></a>Typing new state</h3><p>When adding new state properties (to both, the <code>store</code> and <code>store.$state</code>), you need to add the type to <code>PiniaCustomStateProperties</code> instead. Differently from <code>PiniaCustomProperties</code>, it only receives the <code>State</code> generic:<br><em>å½“æ·»åŠ æ–°çš„çŠ¶æ€å±æ€§ï¼ˆåˆ°storeå’Œstore.$stateï¼‰æ—¶ï¼Œä½ éœ€è¦æ·»åŠ ç±»å‹åˆ°<code>PiniaCustomStateProperties</code>ï¼Œä¸åŒäº<code>PiniaCustomProperties</code>ï¼Œå®ƒåªæ¥æ”¶<code>State</code>æ³›å‹ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#39;pinia&#39;declare module &#39;pinia&#39; &#123;  export interface PiniaCustomStateProperties&lt;S&gt; &#123;    hello: string  &#125;&#125;</code></pre><h3 id="Typing-new-creation-options"><a href="#Typing-new-creation-options" class="headerlink" title="Typing new creation options"></a>Typing new creation options</h3><p>When creating new options for <code>defineStore()</code>, you should extend the <code>DefineStoreOptionsBase</code>. Differently from <code>PiniaCustomProperties</code>, it only exposes two generics: the State and the Store type, allowing you to limit what can be defined. For example, you can use the names of the actions:<br><em>å½“åˆ›å»ºæ–°çš„é€‰é¡¹for<code>defineStore()</code>æ—¶ï¼Œä½ åº”è¯¥æ‰©å±•<code>DefineStoreOptionsBase</code>ã€‚ä¸åŒäº<code>PiniaCustomProperties</code>ï¼Œå®ƒåªå…¬å¼€ä¸¤ä¸ªæ³›å‹ï¼šçŠ¶æ€å’Œstoreç±»å‹ï¼Œå…è®¸ä½ é™åˆ¶å¯ä»¥å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨actionsçš„åç§°ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#39;pinia&#39;declare module &#39;pinia&#39; &#123;  export interface DefineStoreOptionsBase&lt;S, Store&gt; &#123;    &#x2F;&#x2F; allow defining a number of ms for any of the actions    &#x2F;&#x2F; å…è®¸å®šä¹‰ä»»æ„çš„msçš„ä»»ä½•ä¸€ä¸ªactions    debounce?: Partial&lt;Record&lt;keyof StoreActions&lt;Store&gt;, number&gt;&gt;  &#125;&#125;</code></pre><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>There is also a <code>StoreGetters</code> type to extract the <em>getters</em> from a Store type. You can also extend the options of <em>setup stores</em> or <em>option stores</em> <strong>only</strong> by extending the types <code>DefineStoreOptions</code> and <code>DefineSetupStoreOptions</code> respectively.<br><em>æœ‰ä¸€ä¸ª<code>StoreGetters</code>ç±»å‹æ¥æå–storeçš„_getters_ã€‚ä½ ä¹Ÿå¯ä»¥æ‰©å±•_setup stores_æˆ–_option stores_çš„é€‰é¡¹ï¼Œåªéœ€æ‰©å±•types<code>DefineStoreOptions</code>å’Œ<code>DefineSetupStoreOptions</code>ã€‚</em></p></div><h2 id="Nuxt-js"><a href="#Nuxt-js" class="headerlink" title="Nuxt.js"></a>Nuxt.js</h2><p>When <a href="../ssr/nuxt.md">using pinia alongside Nuxt</a>, you will have to create a <a href="https://nuxtjs.org/docs/2.x/directory-structure/plugins">Nuxt plugin</a> first. This will give you access to the <code>pinia</code> instance:<br><em>å½“ä½¿ç”¨piniaä¸Nuxtä¸€èµ·ä½¿ç”¨ï¼ˆssr&#x2F;nuxt.mdï¼‰ï¼Œä½ éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª<a href="https://nuxtjs.org/docs/2.x/directory-structure/plugins">Nuxt plugin</a>ã€‚è¿™å°†ä¼šç»™ä½ è®¿é—®piniaå®ä¾‹ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; plugins&#x2F;myPiniaPlugin.jsimport &#123; PiniaPluginContext &#125; from &#39;pinia&#39;import &#123; Plugin &#125; from &#39;@nuxt&#x2F;types&#39;function MyPiniaPlugin(&#123; store &#125;: PiniaPluginContext) &#123;  store.$subscribe((mutation) &#x3D;&gt; &#123;    &#x2F;&#x2F; react to store changes    &#x2F;&#x2F; å“åº”storeå˜åŒ–    console.log(&#96;[ğŸ $&#123;mutation.storeId&#125;]: $&#123;mutation.type&#125;.&#96;)  &#125;)  &#x2F;&#x2F; Note this has to be typed if you are using TS  &#x2F;&#x2F; æ³¨æ„ï¼Œå¦‚æœä½ ä½¿ç”¨TSï¼Œè¿™å¿…é¡»æ˜¯ç±»å‹åŒ–çš„  return &#123; creationTime: new Date() &#125;&#125;const myPlugin: Plugin &#x3D; (&#123; $pinia &#125;) &#x3D;&gt; &#123;  $pinia.use(MyPiniaPlugin)&#125;export default myPlugin</code></pre><p>Note the above example is using TypeScript, you have to remove the type annotations <code>PiniaPluginContext</code> and <code>Plugin</code> as well as their imports if you are using a <code>.js</code> file.<br><em>æ³¨æ„ï¼Œä¸Šé¢çš„ä¾‹å­ä½¿ç”¨TypeScriptï¼Œå¦‚æœä½ ä½¿ç”¨äº†<code>.js</code>æ–‡ä»¶,ä½ éœ€è¦ç§»é™¤ç±»å‹æ ‡æ³¨<code>PiniaPluginContext</code>å’Œ<code>Plugin</code>ã€‚</em></p><h1 id="Using-a-store-outside-of-a-component"><a href="#Using-a-store-outside-of-a-component" class="headerlink" title="Using a store outside of a component"></a>Using a store outside of a component</h1><p>Pinia stores rely on the <code>pinia</code> instance to share the same store instance across all calls. Most of the time, this works out of the box by just calling your <code>useStore()</code> function. For example, in <code>setup()</code>, you donâ€™t need to do anything else. But things are a bit different outside of a component.<br>Behind the scenes, <code>useStore()</code> <em>injects</em> the <code>pinia</code> instance you gave to your <code>app</code>. This means that if the <code>pinia</code> instance cannot be automatically injected, you have to manually provide it to the <code>useStore()</code> function.<br>You can solve this differently depending on the kind of application you are writing.<br><em>Pinia å­˜å‚¨ä¾èµ–äºpiniaå®ä¾‹æ¥å…±äº«åŒä¸€ä¸ªstoreå®ä¾‹ã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œè¿™æ˜¯é€šè¿‡è°ƒç”¨ä½ çš„useStore()å‡½æ•°æ¥å®ç°çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨setup()ä¸­ï¼Œä½ ä¸éœ€è¦åšä»»ä½•å…¶ä»–äº‹æƒ…ã€‚ä½†æ˜¯ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶ä¹‹å¤–ï¼Œäº‹æƒ…æ˜¯æœ‰æ‰€ä¸åŒçš„ã€‚</em></p><h2 id="Single-Page-Applications"><a href="#Single-Page-Applications" class="headerlink" title="Single Page Applications"></a>Single Page Applications</h2><p>If you are not doing any SSR (Server Side Rendering), any call of <code>useStore()</code> after installing the pinia plugin with <code>app.use(pinia)</code> will work:<br><em>å¦‚æœä½ ä¸æ˜¯åšä»»ä½•SSRï¼ˆæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼‰ï¼Œåœ¨å®‰è£…piniaæ’ä»¶åè°ƒç”¨useStore()åï¼Œå®ƒå°†ä¼šå·¥ä½œï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useUserStore &#125; from &#39;@&#x2F;stores&#x2F;user&#39;import &#123; createApp &#125; from &#39;vue&#39;import App from &#39;.&#x2F;App.vue&#39;&#x2F;&#x2F; âŒ  fails because it&#39;s called before the pinia is created&#x2F;&#x2F; âŒ  å› ä¸ºå®ƒåœ¨piniaåˆ›å»ºä¹‹å‰è¢«è°ƒç”¨const userStore &#x3D; useUserStore()const pinia &#x3D; createPinia()const app &#x3D; createApp(App)app.use(pinia)&#x2F;&#x2F; âœ… works because the pinia instance is now active&#x2F;&#x2F; âœ… å› ä¸ºpiniaå®ä¾‹ç°åœ¨å·²ç»æ¿€æ´»const userStore &#x3D; useUserStore()</code></pre><p>The easiest way to ensure this is always applied is to <em>defer</em> calls of <code>useStore()</code> by placing them inside functions that will always run after pinia is installed.<br><em>æœ€ç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡å°†useStore()å‡½æ•°æ”¾åœ¨å‡½æ•°ä¸­ï¼Œæ¥ä¿è¯å®ƒæ€»æ˜¯åœ¨piniaå®‰è£…åæ‰è¢«è°ƒç”¨ã€‚</em><br>Letâ€™s take a look at this example of using a store inside of a navigation guard with Vue Router:<br><em>çœ‹ä¸€ä¸‹ä½¿ç”¨storeåœ¨å¯¼èˆªå®ˆå«ä¸­çš„ä¾‹å­ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; createRouter &#125; from &#39;vue-router&#39;const router &#x3D; createRouter(&#123;  &#x2F;&#x2F; ...&#125;)&#x2F;&#x2F; âŒ Depending on the order of imports this will fail&#x2F;&#x2F; âŒ å–å†³äºå¯¼å…¥çš„é¡ºåºï¼Œè¿™å°†ä¼šå¤±è´¥const store &#x3D; useStore()router.beforeEach((to, from, next) &#x3D;&gt; &#123;  &#x2F;&#x2F; we wanted to use the store here  &#x2F;&#x2F; æˆ‘ä»¬æƒ³è¦ä½¿ç”¨storeè¿™é‡Œ  if (store.isLoggedIn) next()  else next(&#39;&#x2F;login&#39;)&#125;)router.beforeEach((to) &#x3D;&gt; &#123;  &#x2F;&#x2F; âœ… This will work because the router starts its navigation after  &#x2F;&#x2F; the router is installed and pinia will be installed too  &#x2F;&#x2F; âœ… è¿™å°†ä¼šå·¥ä½œï¼Œå› ä¸ºè·¯ç”±å¼€å§‹å¯¼èˆªä¹‹åï¼Œpiniaä¹Ÿä¼šè¢«å®‰è£…  const store &#x3D; useStore()  if (to.meta.requiresAuth &amp;&amp; !store.isLoggedIn) return &#39;&#x2F;login&#39;&#125;)</code></pre><h2 id="SSR-Apps"><a href="#SSR-Apps" class="headerlink" title="SSR Apps"></a>SSR Apps</h2><p>When dealing with Server Side Rendering, you will have to pass the <code>pinia</code> instance to <code>useStore()</code>. This prevents pinia from sharing global state between different application instances.<br><em>åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„åº”ç”¨ä¸­ï¼Œä½ éœ€è¦ä¼ é€’piniaå®ä¾‹ç»™useStore()ã€‚è¿™å°†é˜»æ­¢piniaåœ¨ä¸åŒåº”ç”¨å®ä¾‹ä¹‹é—´å…±äº«å…¨å±€çŠ¶æ€ã€‚</em><br>There is a whole section dedicated to it in the <a href="/ssr/index.md">SSR guide</a>, this is just a short explanation:<br><em>åœ¨<a href="/ssr/index.md">SSRæŒ‡å—</a>ä¸­æœ‰ä¸€ä¸ªä¸“é—¨çš„ç« èŠ‚ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€çŸ­çš„è¯´æ˜ï¼š</em></p><h1 id="æ‰‹å†Œ"><a href="#æ‰‹å†Œ" class="headerlink" title="æ‰‹å†Œ"></a>æ‰‹å†Œ</h1><h1 id="Usage-without-setup"><a href="#Usage-without-setup" class="headerlink" title="Usage without setup()"></a>Usage without <code>setup()</code></h1><p>Pinia can be used even if you are not using the composition API (if you are using Vue 2, you still need to install the <code>@vue/composition-api</code> plugin though). While we recommend you to give the Composition API a try and learn it, it might not be the time for you and your team yet, you might be in the process of migrating an application, or any other reason. There are a few functions:<br><em>Piniaå¯ä»¥è¢«ä½¿ç”¨ï¼Œå³ä½¿ä½ ä¸ä½¿ç”¨ç»„åˆAPIï¼ˆå¦‚æœä½ ä½¿ç”¨Vue 2ï¼Œä½ ä»ç„¶éœ€è¦å®‰è£…<code>@vue/composition-api</code>æ’ä»¶ï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬å»ºè®®ä½ è¯•ä¸€è¯•ç»„åˆAPIï¼Œç„¶åå­¦ä¹ å®ƒï¼Œéå›¢é˜Ÿåˆä½œï¼Œä½ å¯èƒ½æ­£åœ¨è¿ç§»ä¸€ä¸ªåº”ç”¨ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•åŸå› ã€‚æœ‰ä¸€äº›å‡½æ•°ï¼š</em></p><ul><li><a href="#giving-access-to-the-whole-store">mapStores</a></li><li><a href="../core-concepts/state.md#options-api">mapState</a></li><li><a href="../core-concepts/state.md#modifiable-state">mapWritableState</a></li><li>âš ï¸ <a href="../core-concepts/getters.md#options-api">mapGetters</a> (just for migration convenience, use <code>mapState()</code> instead)</li><li><a href="../core-concepts/actions.md#options-api">mapActions</a></li></ul><h2 id="Giving-access-to-the-whole-store"><a href="#Giving-access-to-the-whole-store" class="headerlink" title="Giving access to the whole store"></a>Giving access to the whole store</h2><p>If you need to access pretty much everything from the store, it might be too much to map every single property of the storeâ€¦ Instead you can get access to the whole store with <code>mapStores()</code>:<br><em>å¦‚æœä½ éœ€è¦è®¿é—®æ•´ä¸ªstoreï¼Œå¯èƒ½ä¼šå¤ªå¤šäº†ï¼Œå¯ä»¥ä½¿ç”¨mapStores()æ¥è®¿é—®æ•´ä¸ªstoreï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; mapStores &#125; from &#39;pinia&#39;&#x2F;&#x2F; given two stores with the following ids&#x2F;&#x2F; ç»™å®šä¸¤ä¸ªstoreï¼Œå…¶idä¸ºï¼šconst useUserStore &#x3D; defineStore(&#39;user&#39;, &#123;  &#x2F;&#x2F; ...&#125;)const useCartStore &#x3D; defineStore(&#39;cart&#39;, &#123;  &#x2F;&#x2F; ...&#125;)export default &#123;  computed: &#123;    &#x2F;&#x2F; note we are not passing an array, just one store after the other    &#x2F;&#x2F; each store will be accessible as its id + &#39;Store&#39;    &#x2F;&#x2F; æ³¨æ„æˆ‘ä»¬ä¸ä¼ é€’æ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªstoreä¸€ä¸ªstore    ...mapStores(useCartStore, useUserStore)  &#125;,  methods: &#123;    async buyStuff() &#123;      &#x2F;&#x2F; use them anywhere!      &#x2F;&#x2F; ä½¿ç”¨å®ƒä»¬ä»»ä½•åœ°æ–¹ï¼      if (this.userStore.isAuthenticated()) &#123;        await this.cartStore.buy()        this.$router.push(&#39;&#x2F;purchased&#39;)      &#125;    &#125;,  &#125;,&#125;</code></pre><p>By default, Pinia will add the <code>&quot;Store&quot;</code> suffix to the <code>id</code> of each store. You can customize this behavior by calling the <code>setMapStoreSuffix()</code>:<br><em>é»˜è®¤æƒ…å†µä¸‹ï¼ŒPiniaå°†æ·»åŠ â€œStoreâ€åç¼€åˆ°æ¯ä¸ªstoreçš„idã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨setMapStoreSuffix()æ¥è‡ªå®šä¹‰è¿™ä¸ªè¡Œä¸ºï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; createPinia, setMapStoreSuffix &#125; from &#39;pinia&#39;&#x2F;&#x2F; completely remove the suffix: this.user, this.cart&#x2F;&#x2F; å®Œå…¨åˆ é™¤åç¼€ï¼šthis.user, this.cartsetMapStoreSuffix(&#39;&#39;)&#x2F;&#x2F; this.user_store, this.cart_store (it&#39;s okay, I won&#39;t judge you)&#x2F;&#x2F; è¿™ä¸ªuser_store, this.cart_storeï¼ˆä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰setMapStoreSuffix(&#39;_store&#39;)export const pinia &#x3D; createPinia()</code></pre><h2 id="TypeScript-1"><a href="#TypeScript-1" class="headerlink" title="TypeScript"></a>TypeScript</h2><p>By default, all map helpers support autocompletion and you donâ€™t need to do anything. If you call <code>setMapStoreSuffix()</code> to change the <code>&quot;Store&quot;</code> suffix, you will need to also add it somewhere in a TS file or your <code>global.d.ts</code> file. The most convenient place would be the same place where you call <code>setMapStoreSuffix()</code>:<br><em>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰map helperséƒ½æ”¯æŒè‡ªåŠ¨å®Œæˆï¼Œä½ ä¸éœ€è¦åšä»»ä½•äº‹æƒ…ã€‚å¦‚æœä½ è°ƒç”¨setMapStoreSuffix()æ¥æ”¹å˜â€œStoreâ€åç¼€ï¼Œä½ è¿˜éœ€è¦åœ¨TSæ–‡ä»¶æˆ–ä½ çš„global.d.tsæ–‡ä»¶ä¸­æ·»åŠ å®ƒã€‚æœ€æ–¹ä¾¿çš„åœ°æ–¹å°±æ˜¯åœ¨ä½ è°ƒç”¨setMapStoreSuffix()çš„åœ°æ–¹ï¼š</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; createPinia, setMapStoreSuffix &#125; from &#39;pinia&#39;&#x2F;&#x2F; completely remove the suffix&#x2F;&#x2F; å®Œå…¨åˆ é™¤åç¼€setMapStoreSuffix(&#39;&#39;) export const pinia &#x3D; createPinia()declare module &#39;pinia&#39; &#123;  export interface MapStoresCustomization &#123;    &#x2F;&#x2F; set it to the same value as above    &#x2F;&#x2F; è®¾ç½®ä¸ºä¸Šé¢çš„å€¼    suffix: &#39;&#39;  &#125;&#125;</code></pre><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>If you are using a TypeScript declaration file (like <code>global.d.ts</code>), make sure to <code>import &#39;pinia&#39;</code> at the top of it to expose all existing types.<br><em>å¦‚æœä½ ä½¿ç”¨äº†ä¸€ä¸ªTypeScriptå£°æ˜æ–‡ä»¶ï¼ˆä¾‹å¦‚<code>global.d.ts</code>ï¼‰ï¼Œè¯·åœ¨å®ƒçš„é¡¶éƒ¨å¯¼å…¥<code>pinia</code>æ¥å¯¹æ‰€æœ‰ç°æœ‰ç±»å‹è¿›è¡Œæš´éœ²ã€‚</em></p></div><h1 id="Composing-Stores"><a href="#Composing-Stores" class="headerlink" title="Composing Stores"></a>Composing Stores</h1><p>Composing stores is about having stores that use each other and there is one rule to follow:<br><em>ç»„åˆstoreæ˜¯å…³äºæœ‰storeä½¿ç”¨å¦ä¸€ä¸ªstoreçš„äº‹æƒ…ï¼Œæœ‰ä¸€æ¡è§„åˆ™è¦éµå®ˆï¼š</em><br>If <strong>two or more stores use each other</strong>, they cannot create an infinite loop through <em>getters</em> or <em>actions</em>. They cannot <strong>both</strong> directly read each other state in their setup function:<br><em>å¦‚æœä¸¤ä¸ªæˆ–å¤šä¸ªstoreä½¿ç”¨äº†å¦ä¸€ä¸ªstoreï¼Œé‚£ä¹ˆå®ƒä»¬ä¸èƒ½é€šè¿‡_getters_æˆ–_actions_åˆ›å»ºæ— é™å¾ªç¯ã€‚å®ƒä»¬ä¸èƒ½åŒæ—¶ç›´æ¥è¯»å–å¦ä¸€ä¸ªstoreçš„çŠ¶æ€ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const useX &#x3D; defineStore(&#39;x&#39;, () &#x3D;&gt; &#123;  const y &#x3D; useY()  &#x2F;&#x2F; âŒ This is not possible because y also tries to read x.name  &#x2F;&#x2F; âŒ è¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºyä¹Ÿè¯•å›¾è¯»å–xçš„name  y.name  function doSomething() &#123;    &#x2F;&#x2F; âœ… Read y properties in computed or actions    &#x2F;&#x2F; âœ… è¯»å–yå±æ€§åœ¨computedæˆ–actions    const yName &#x3D; y.name    &#x2F;&#x2F; ...  &#125;  return &#123;    name: ref(&#39;I am X&#39;),  &#125;&#125;)const useY &#x3D; defineStore(&#39;y&#39;, () &#x3D;&gt; &#123;  const x &#x3D; useX()  &#x2F;&#x2F; âŒ This is not possible because x also tries to read y.name  &#x2F;&#x2F; âŒ è¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºxä¹Ÿè¯•å›¾è¯»å–yçš„name  x.name  function doSomething() &#123;    &#x2F;&#x2F; âœ… Read x properties in computed or actions    &#x2F;&#x2F; âœ… è¯»å–xå±æ€§åœ¨computedæˆ–actions    const xName &#x3D; x.name    &#x2F;&#x2F; ...  &#125;  return &#123;    name: ref(&#39;I am Y&#39;),  &#125;&#125;)</code></pre><h2 id="Nested-stores"><a href="#Nested-stores" class="headerlink" title="Nested stores"></a>Nested stores</h2><p>Note that if one store uses another store, <strong>there is no need to create a new store in a separate file</strong>, you can directly import it. Think of it as nesting.<br><em>å¦‚æœä¸€ä¸ªstoreä½¿ç”¨å¦ä¸€ä¸ªstoreï¼Œ<strong>ä¸éœ€è¦åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„store</strong>ï¼Œä½ å¯ä»¥ç›´æ¥å¯¼å…¥å®ƒã€‚è®°ä½å®ƒæ˜¯åµŒå¥—çš„ã€‚</em><br>You can call <code>useOtherStore()</code> at the top of any getter or action:<br><em>ä½ å¯ä»¥åœ¨ä»»ä½•getteræˆ–actionçš„é¡¶éƒ¨è°ƒç”¨useOtherStore()ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; useUserStore &#125; from &#39;.&#x2F;user&#39;export const cartStore &#x3D; defineStore(&#39;cart&#39;, &#123;  getters: &#123;    &#x2F;&#x2F; ... other getters    summary(state) &#123;      const user &#x3D; useUserStore()      return &#96;Hi $&#123;user.name&#125;, you have $&#123;state.list.length&#125; items in your cart. It costs $&#123;state.price&#125;.&#96;    &#125;,  &#125;,  actions: &#123;    purchase() &#123;      const user &#x3D; useUserStore()      return apiPurchase(user.id, this.list)    &#125;,  &#125;,&#125;)</code></pre><h2 id="Shared-Getters"><a href="#Shared-Getters" class="headerlink" title="Shared Getters"></a>Shared Getters</h2><p>You can simply call <code>useOtherStore()</code> inside a <em>getter</em>:<br><em>ä½ å¯ä»¥åœ¨_getter_ä¸­ç›´æ¥è°ƒç”¨useOtherStore()ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; defineStore &#125; from &#39;pinia&#39;import &#123; useUserStore &#125; from &#39;.&#x2F;user&#39;export const useCartStore &#x3D; defineStore(&#39;cart&#39;, &#123;  getters: &#123;    summary(state) &#123;      const user &#x3D; useUserStore()      return &#96;Hi $&#123;user.name&#125;, you have $&#123;state.list.length&#125; items in your cart. It costs $&#123;state.price&#125;.&#96;    &#125;,  &#125;,&#125;)</code></pre><h2 id="Shared-Actions"><a href="#Shared-Actions" class="headerlink" title="Shared Actions"></a>Shared Actions</h2><p>The same applies to <em>actions</em>:<br><em>åŒæ ·é€‚ç”¨äº_actions_ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; defineStore &#125; from &#39;pinia&#39;import &#123; useUserStore &#125; from &#39;.&#x2F;user&#39;export const useCartStore &#x3D; defineStore(&#39;cart&#39;, &#123;  actions: &#123;    async orderCart() &#123;      const user &#x3D; useUserStore()      try &#123;        await apiOrderCart(user.token, this.items)        &#x2F;&#x2F; another action        this.emptyCart()      &#125; catch (err) &#123;        displayError(err)      &#125;    &#125;,  &#125;,&#125;)</code></pre>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€- æ•°ç»„å¯¹è±¡æ–¹æ³•å®ç°åŸç†</title>
      <link href="//post/2022-06-10js-arr.html"/>
      <url>//post/2022-06-10js-arr.html</url>
      
        <content type="html"><![CDATA[<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p><strong>å®šä¹‰</strong></p><ul><li>map()æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ä¸ºåŸå§‹æ•°ç»„å…ƒç´ è°ƒç”¨å‡½æ•°å¤„ç†åçš„å€¼</li><li>map()æ–¹æ³•æŒ‰ç…§åŸå§‹æ•°ç»„å…ƒç´ é¡ºåºä¸€æ¬¡å¤„ç†å…ƒç´ </li></ul><p><strong>æ³¨æ„</strong></p><ul><li>map()ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œæ£€æµ‹</li><li>map()æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°æ•°ç»„ï¼Œè€Œä¸æ˜¯åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.proptotype.myMap &#x3D; function (fn) &#123;  let arr &#x3D; [];  for (let i &#x3D; 0; i &lt; this.length; i++) &#123;    arr.push(fn(this[i], i, this));  &#125;  return arr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myMap((item, index, arr) &#x3D;&gt; &#123;  console.log(item, index, arr);  return item * 2;&#125;);&#x2F;&#x2F; 1 0 Â [1, 2, 3]&#x2F;&#x2F; 2 1 Â [1, 2, 3]&#x2F;&#x2F; 3 2 Â [1, 2, 3]&#x2F;&#x2F; [2, 4, 6]</code></pre><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><p><strong>å®šä¹‰</strong></p><ul><li>filter()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ–°æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯é€šè¿‡æ£€æŸ¥æŒ‡å®šæ•°ç»„ä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å…ƒç´ </li></ul><p><strong>æ³¨æ„</strong></p><ul><li>filter()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œéå†</li><li>filter()æ–¹æ³•ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myFilter &#x3D; function (fn) &#123;  let arr &#x3D; [];  for (let i &#x3D; 0; i &lt; this.length; i++) &#123;    if (fn(this[i], i, this)) &#123;      arr.push(this[i]);    &#125;  &#125;  return arr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myFilter((item, index, arr) &#x3D;&gt; &#123;  console.log(item, index, arr);  return item &gt; 1;&#125;);&#x2F;&#x2F; 1 0 Â [1, 2, 3]&#x2F;&#x2F; 2 1 Â [1, 2, 3]&#x2F;&#x2F; 3 2 Â [1, 2, 3]&#x2F;&#x2F; [2, 3]</code></pre><h2 id="some"><a href="#some" class="headerlink" title="some"></a>some</h2><p><strong>å®šä¹‰</strong></p><ul><li>some()æ–¹æ³•ç”¨äºæ£€æµ‹æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶</li><li>some()æ–¹æ³•ä¼šä¸€æ¬¡æ‰§è¡Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä¸ºæ­¢<ul><li>å¦‚æœæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œsome()æ–¹æ³•å°±ä¼šç«‹å³è¿”å› trueï¼Œå‰©ä½™çš„å…ƒç´ ä¸ä¼šå†æ‰§è¡Œ</li><li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œsome()æ–¹æ³•å°±ä¼šè¿”å› false</li></ul></li></ul><p><strong>æ³¨æ„</strong></p><ul><li>some()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œéå†</li><li>some()æ–¹æ³•ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><ul><li>some æˆ‘ä»¬çŸ¥é“æ˜¯å¦‚æœæ‰¾åˆ°å°±è¿”å› trueï¼Œæ²¡æœ‰è¿”å› false,é‚£ä¹ˆåœ¨ filter ä¸Šå†æ”¹é€ ä¸€ä¸‹ï¼Œå®šä¹‰ä¸€ä¸ªéå†ä¸º false,å½“æœ‰ä¸€æ¬¡ä¼šå›è°ƒå‡½æ•°æ‰§è¡Œçš„æ—¶å€™è¿”å› true,é‚£ä¹ˆå°±è·³å‡ºå¾ªç¯ï¼Œç›´æ¥è¿”å›ã€‚</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.mySome &#x3D; function (fn) &#123;  for (let i &#x3D; 0; i &lt; this.length; i++) &#123;    if (fn(this[i], i, this)) &#123;      return true;    &#125;  &#125;  return false;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].mySome((item, index, arr) &#x3D;&gt; &#123;  console.log(item, index, arr);  return item &gt; 1;&#125;);</code></pre><h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p><strong>å®šä¹‰</strong></p><ul><li>find()æ–¹æ³•è¿”å›æ•°ç»„ä¸­æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>find()æ–¹æ³•ä¼šä¸€æ¬¡æ‰§è¡Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä¸ºæ­¢<ul><li>å¦‚æœæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œfind()æ–¹æ³•å°±ä¼šç«‹å³è¿”å›è¯¥å…ƒç´ ï¼Œå‰©ä½™çš„å…ƒç´ ä¸ä¼šå†æ‰§è¡Œ</li><li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œfind()æ–¹æ³•å°±ä¼šè¿”å› undefined</li></ul></li></ul><p><strong>æ³¨æ„</strong></p><ul><li>find()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œéå†</li><li>find()æ–¹æ³•ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><ul><li>å½“å›è°ƒå‡½æ•°æœ‰ä¸€ä¸ªè¿”å› tureï¼Œåˆ™èµ‹å€¼å¹¶ä¸”è¿”å›ï¼Œå¦åˆ™ä¼šè¿”å›ä¸€ä¸ªæœªå®šä¹‰çš„å€¼ï¼Œundefinedã€‚</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myFind &#x3D; function (fn) &#123;  for (let i &#x3D; 0; i &lt; this.length; i++) &#123;    if (fn(this[i], i, this)) &#123;      return this[i];    &#125;  &#125;  return undefined;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myFind((item, index, arr) &#x3D;&gt; &#123;  console.log(item, index, arr);  return item &gt; 1;&#125;);</code></pre><h2 id="every"><a href="#every" class="headerlink" title="every"></a>every</h2><p><strong>å®šä¹‰</strong></p><ul><li>every()æ–¹æ³•ç”¨äºæ£€æµ‹æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½æ»¡è¶³æŒ‡å®šæ¡ä»¶</li><li>every()æ–¹æ³•ä¼šä¸€æ¬¡æ‰§è¡Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä¸ºæ­¢<ul><li>å¦‚æœæ‰¾åˆ°ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œevery()æ–¹æ³•å°±ä¼šè¿”å› falseï¼Œå‰©ä½™çš„å…ƒç´ ä¸ä¼šå†æ‰§è¡Œ</li><li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œevery()æ–¹æ³•å°±ä¼šè¿”å› true</li></ul></li></ul><p><strong>æ³¨æ„</strong></p><ul><li>every()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œéå†</li><li>every()æ–¹æ³•ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><ul><li>è¿™ä¸ªè·Ÿ some å…¶å®åªæ˜¯åç€æ¥ï¼Œåˆå§‹åŒ–ä¸€ä¸ªå€¼ä¸º trueï¼Œåªè¦å›è°ƒå‡½æ•°æœ‰ä¸€ä¸ªå€¼è¿”å› falseï¼Œé‚£ä¹ˆå°±ä¼šæˆç«‹ä»è€Œæ¨å‡ºå¾ªç¯å¹¶ä¸”è¿”å›ã€‚</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myEvery &#x3D; function (fn) &#123;  for (let i &#x3D; 0; i &lt; this.length; i++) &#123;    if (!fn(this[i], i, this)) &#123;      return false;    &#125;  &#125;  return true;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myEvery((item, index, arr) &#x3D;&gt; &#123;  console.log(item, index, arr);  return item &gt; 1;&#125;);</code></pre><h2 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h2><p><strong>å®šä¹‰</strong></p><ul><li>forEach()æ–¹æ³•ç”¨äºéå†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ </li></ul><p><strong>æ³¨æ„</strong></p><ul><li>forEach()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„æ‰§è¡Œå›è°ƒå‡½æ•°</li></ul><p><strong>åŸç†</strong></p><ul><li>ä¹Ÿæ˜¯åˆ©ç”¨ for å¾ªç¯ç›´æ¥éå†å¾ªç¯æ‰§è¡Œå›è°ƒå‡½æ•°å³å¯ã€‚</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myForEach &#x3D; function (fn) &#123;  for (let i &#x3D; 0; i &lt; this.length; i++) &#123;    fn(this[i], i, this);  &#125;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myForEach((item, index, arr) &#x3D;&gt; &#123;  console.log(item, index, arr);&#125;);</code></pre><h2 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h2><p><strong>å®šä¹‰</strong></p><ul><li>concat()æ–¹æ³•ç”¨äºè¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„</li><li>concat()æ–¹æ³•ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>æ³¨æ„</strong></p><p><strong>åŸç†</strong></p><ul><li>å…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯æ•°ç»„ï¼Œæ˜¯çš„è¯éå† pushï¼Œä¸æ˜¯çš„è¯ç›´æ¥ pushï¼Œæœ€åè¿”å›å¤åˆ¶çš„æ•°ç»„å³å¯ã€‚</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myConcat &#x3D; function (...args) &#123;  let arr &#x3D; [...this];  for (let i &#x3D; 0; i &lt; args.length; i++) &#123;    if (Array.isArray(args[i])) &#123;      arr &#x3D; arr.concat(args[i]);    &#125; else &#123;      arr.push(args[i]);    &#125;  &#125;  return arr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myConcat([4, 5, 6]);</code></pre><h2 id="copyWithin"><a href="#copyWithin" class="headerlink" title="copyWithin"></a>copyWithin</h2><p><strong>å®šä¹‰</strong></p><ul><li>copyWithin()æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªæ•°ç»„çš„å…ƒç´ å¤åˆ¶åˆ°å…¶ä»–ä½ç½®</li><li>copyWithin()æ–¹æ³•ä¼šä¿®æ”¹åŸå§‹æ•°ç»„</li></ul><p><strong>æ³¨æ„</strong></p><ul><li>copyWithin()æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><ul><li>startã€ end å…ƒç´ æ‹·è´åˆ° target å…ƒç´ ï¼ˆend - start æœ‰å‡ ä½ï¼Œä¼šæ”¹å˜ target åŠä¹‹åçš„å‡ ä½ï¼‰</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myCopyWithin &#x3D; function (target, start &#x3D; 0, end &#x3D; this.length) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  target &#x3D; target &lt; 0 ? len + target : target;  start &#x3D; start &lt; 0 ? len + start : start;  end &#x3D; end &lt; 0 ? len + end : end;  for (let i &#x3D; start; i &lt; end; i++) &#123;    arr[target + i - start] &#x3D; arr[i];  &#125;  return arr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3, 4, 5].myCopyWithin(0, 3);&#x2F;&#x2F; æ‹·è´ 4, 5ï¼Œä»0å¼€å§‹è¦†ç›–&#x2F;&#x2F; [4, 5, 3, 4, 5]</code></pre><h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h2><p><strong>å®šä¹‰</strong></p><ul><li>reduce()æ–¹æ³•ç”¨äºä»ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æ±‚å’Œ</li><li>reduce()å¯ä»¥ä½œä¸ºä¸€ä¸ªé«˜é˜¶å‡½æ•°ä½¿ç”¨ï¼Œç”¨äºå‡½æ•°çš„ compose</li></ul><p><strong>æ³¨æ„</strong></p><ul><li>reduce()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„æ‰§è¡Œå›è°ƒå‡½æ•°</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myReduce &#x3D; function (fn, init) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  let i &#x3D; 0;  if (init &#x3D;&#x3D;&#x3D; undefined) &#123;    init &#x3D; arr[0];    i &#x3D; 1;  &#125;  for (; i &lt; len; i++) &#123;    init &#x3D; fn(init, arr[i], i, arr);  &#125;  return init;&#125;;</code></pre><p>ä½¿ç”¨</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myReduce((prev, curr) &#x3D;&gt; &#123;  return prev + curr;&#125;, 0);</code></pre><h2 id="reduceRight"><a href="#reduceRight" class="headerlink" title="reduceRight"></a>reduceRight</h2><p><strong>å®šä¹‰</strong></p><ul><li>reduceRight()æ–¹æ³•ç”¨äºä»ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æ±‚å’Œ</li><li>reduceRight()å¯ä»¥ä½œä¸ºä¸€ä¸ªé«˜é˜¶å‡½æ•°ä½¿ç”¨ï¼Œç”¨äºå‡½æ•°çš„ compose<br><strong>æ³¨æ„</strong></li><li>reduceRight()æ–¹æ³•ä¸ä¼šå¯¹ç©ºæ•°ç»„æ‰§è¡Œå›è°ƒå‡½æ•°<br><strong>åŸç†</strong></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myReduceRight &#x3D; function (fn, init) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  let i &#x3D; len - 1;  if (init &#x3D;&#x3D;&#x3D; undefined) &#123;    init &#x3D; arr[len - 1];    i &#x3D; len - 2;  &#125;  for (; i &gt;&#x3D; 0; i--) &#123;    init &#x3D; fn(init, arr[i], i, arr);  &#125;  return init;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3].myReduceRight((prev, curr) &#x3D;&gt; &#123;  return prev + curr;&#125;, 0);</code></pre><h2 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h2><p><strong>å®šä¹‰</strong></p><ul><li>splice()æ–¹æ³•ç”¨äºåˆ é™¤æ•°ç»„ä¸­çš„ä¸€æ®µï¼Œå¹¶ç”¨æ–°å…ƒç´ æ›¿ä»£åŸæ¥çš„å…ƒç´ </li><li>splice()æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li><li>splice()æ–¹æ³•ä¼šè¿”å›è¢«åˆ é™¤çš„å…ƒç´ </li><li>splice()æ–¹æ³•ä¼šè¿”å›è¢«åˆ é™¤çš„å…ƒç´ ï¼Œå¹¶ä¸”è¿”å›è¢«åˆ é™¤çš„å…ƒç´ çš„æ•°ç»„</li></ul><p><strong>æ³¨æ„</strong></p><ul><li>splice()æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.mySplice &#x3D; function (start, deleteCount, ...args) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  &#x2F;&#x2F; æ‰¾å¼€å§‹çš„ä½ç½®  start &#x3D; start &lt; 0 ? len + start : start;  &#x2F;&#x2F; æ‰¾åˆ é™¤çš„æ•°é‡  &#x2F;&#x2F; å¦‚æœdeleteCountï¼Œæ²¡æœ‰å€¼ï¼Œåˆ™ä»startå¼€å§‹åˆ é™¤ï¼Œç›´åˆ°æ•°ç»„ç»“æŸ  deleteCount &#x3D; deleteCount &#x3D;&#x3D;&#x3D; undefined ? len - start : deleteCount;  let newArr &#x3D; arr.slice(0, start); &#x2F;&#x2F; å·¦  newArr &#x3D; newArr.concat(args); &#x2F;&#x2F; æ–°  newArr &#x3D; newArr.concat(arr.slice(start + deleteCount)); &#x2F;&#x2F; å³  return newArr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3, 4, 5].mySplice(2, 2, 6, 7);</code></pre><h2 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h2><p><strong>å®šä¹‰</strong></p><ul><li>slice()æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ªæ•°ç»„çš„ä¸€æ®µï¼Œå¹¶ä¸”ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li><li>slice()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.mySlice &#x3D; function (start &#x3D; 0, end &#x3D; this.length) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  &#x2F;&#x2F; æ‰¾å¼€å§‹çš„ä½ç½®  start &#x3D; start &lt; 0 ? len + start : start;  &#x2F;&#x2F; æ‰¾ç»“æŸçš„ä½ç½®  end &#x3D; end &lt; 0 ? len + end : end;  return arr.slice(start, end);&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a &#x3D; [1, 2, 3, 4, 5];var b &#x3D; a.splice(2, 2, 6, 7);a;&#x2F;&#x2F; [1, 2, 6, 7, 5]b;&#x2F;&#x2F; [3, 4]</code></pre><h2 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h2><p><strong>å®šä¹‰</strong></p><ul><li>sort()æ–¹æ³•ç”¨äºå¯¹æ•°ç»„è¿›è¡Œæ’åº</li><li>sort()æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li><li>sort()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.mySort &#x3D; function (fn) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  &#x2F;&#x2F; å†’æ³¡æ’åº  for (let i &#x3D; 0; i &lt; len; i++) &#123;    for (let j &#x3D; i + 1; j &lt; len; j++) &#123;      if (fn(arr[i], arr[j]) &gt; 0) &#123;        &#x2F;&#x2F; ä½¿ç”¨äº†è§£æ„èµ‹å€¼        [arr[i], arr[j]] &#x3D; [arr[j], arr[i]];      &#125;    &#125;  &#125;  return arr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3, 4, 5].mySort((a, b) &#x3D;&gt; &#123;  return a - b;&#125;);</code></pre><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><p><strong>å®šä¹‰</strong></p><ul><li>reverse()æ–¹æ³•ç”¨äºåè½¬æ•°ç»„</li><li>reverse()æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„</li></ul><p><strong>åŸç†</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myReverse &#x3D; function () &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  let i &#x3D; 0;  let j &#x3D; len - 1;  while (i &lt; j) &#123;    &#x2F;&#x2F; ä½¿ç”¨äº†è§£æ„èµ‹å€¼    [arr[i], arr[j]] &#x3D; [arr[j], arr[i]];    i++;    j--;  &#125;  return arr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3, 4, 5].myReverse();</code></pre><h2 id="includes"><a href="#includes" class="headerlink" title="includes"></a>includes</h2><p><strong>å®šä¹‰</strong></p><ul><li>includes()æ–¹æ³•ç”¨äºåˆ¤æ–­æ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªå€¼</li><li>includes()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼</li><li>includes()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœæ•°ç»„åŒ…å«æŸä¸ªå€¼ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› false<br><strong>åŸç†</strong></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myIncludes &#x3D; function (value) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  for (let i &#x3D; 0; i &lt; len; i++) &#123;    if (arr[i] &#x3D;&#x3D;&#x3D; value) &#123;      return true;    &#125;  &#125;  return false;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3, 4, 5].myIncludes(3);</code></pre><h2 id="flat"><a href="#flat" class="headerlink" title="flat"></a>flat</h2><p><strong>å®šä¹‰</strong></p><ul><li>flat()æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªæ•°ç»„å±•å¼€ä¸ºå¤šä¸ªæ•°ç»„</li><li>flat()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„</li><li>flat()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¦‚æœæ•°ç»„ä¸­çš„å…ƒç´ æ˜¯æ•°ç»„ï¼Œåˆ™å°†æ•°ç»„ä¸­çš„å…ƒç´ å±•å¼€ä¸ºä¸€ä¸ªæ•°ç»„<br><strong>åŸç†</strong></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">Array.prototype.myFlat &#x3D; function (depth &#x3D; 1) &#123;  let arr &#x3D; [...this];  let len &#x3D; arr.length;  let newArr &#x3D; [];  if (depth &#x3D;&#x3D; 0) return arr; &#x2F;&#x2F; Copilot è¿™é‡Œå†™çš„ä¸å¯¹  for (let i &#x3D; 0; i &lt; len; i++) &#123;    if (Array.isArray(arr[i])) &#123;      newArr &#x3D; newArr.concat(&#x2F;**&#x2F; arr[i].myFlat(depth - 1) &#x2F;*é€’å½’*&#x2F;);    &#125; else &#123;      newArr.push(arr[i]);    &#125;  &#125;  return newArr;&#125;;</code></pre><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">[1, 2, 3, 4, 5].myFlat();</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/lin_fightin/article/details/118885988" target="_blank" >js ä¸€äº›æ•°ç»„å¯¹è±¡æ–¹æ³•åŸç†å®ç°(æ‰‹æ’• map,filter,every,flat ç­‰)</a> <code>å½“å‰æ–‡ç« æ¯”æ­¤é“¾æ¥ä»£ç æ›´ç²¾ç®€</code></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-åŠ«æŒ(å‡½æ•°/æ•°æ®)</title>
      <link href="//post/2022-06-10js-%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81.html"/>
      <url>//post/2022-06-10js-%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‡½æ•°åŠ«æŒ"><a href="#å‡½æ•°åŠ«æŒ" class="headerlink" title="å‡½æ•°åŠ«æŒ"></a>å‡½æ•°åŠ«æŒ</h2><p>å‡½æ•°åŠ«æŒï¼Œåœ¨ä¸€ä¸ªå‡½æ•°è¿è¡Œä¹‹å‰å°±æŠŠå®ƒåŠ«æŒä¸‹æ¥ï¼Œæ·»åŠ æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ã€‚ åœ¨å‡½æ•°è¿è¡Œä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å‡½æ•°çš„å‚æ•°ï¼Œæˆ–è€…æ”¹å˜å‡½æ•°çš„è¿”å›å€¼ã€‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>JavaScript ä¸­çš„å‡½æ•°åŠ«æŒæ˜¯ä¸€ä¸ªå¢å¼ºåŸæœ‰å‡½æ•°çš„æŠ€å·§ï¼Œä¸€èˆ¬æˆ‘ä»¬ç”¨æ¥å¯¹åŸæœ‰çš„ JavaScript å…¨å±€æ–¹æ³•åšä¸€äº›èƒ½åŠ›çš„å¢å¼ºã€‚</p></blockquote><p><strong>å‡½æ•°åŠ«æŒåŸç†</strong></p><p>å‡½æ•°åŠ«æŒåŸç†ï¼Œæ˜¯åœ¨å‡½æ•°è¿è¡Œä¹‹å‰ï¼ŒæŠŠå‡½æ•°çš„åŸå‹æ”¹å˜ä¸ºæ–°çš„å‡½æ•°ï¼Œå¹¶ä¸”æŠŠåŸå‡½æ•°çš„æ‰§è¡Œä»£ç æ”¾åˆ°æ–°å‡½æ•°çš„æ‰§è¡Œä»£ç ä¹‹å‰ã€‚</p><p><strong>å‡½æ•°åŠ«æŒå®ç°</strong></p><ul><li>ä½¿ç”¨<code>æ–°çš„å˜é‡</code>ä¿å­˜è¢«åŠ«æŒå‡½æ•°</li><li><code>æ–°å‡½æ•°ä¸­</code>æ”¹<code>å†™è¢«åŠ«æŒå‡½æ•°</code></li><li><code>æ–°å‡½æ•°ä¸­</code> <code>è°ƒç”¨åŸæœ‰çš„å‡½æ•°</code>ï¼ˆä¿å­˜åœ¨å˜é‡ä¸­çš„å‡½æ•°ï¼‰</li></ul><p><strong>åŸºç¡€ï¼šä¸¤ä¸ªå¯¹è±¡æŒ‡å‘åŒä¸€ä¸ªåœ°å€çš„æ—¶å€™ï¼Œä¿®æ”¹æŸä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå¦å¤–ä¸€ä¸ªå¯¹è±¡ä¹Ÿä¼šéšä¹‹å˜åŒ–</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let a &#x3D; &#123;&#125;;let b &#x3D; a;a.name &#x3D; &quot;Gopal&quot;;&#x2F;&#x2F; ture &#123;name: &#39;Gopal&#39;&#125;  &#123;name: &#39;Gopal&#39;&#125;console.log(b &#x3D;&#x3D;&#x3D; a, a, b);</code></pre><p><strong>åŸºç¡€ï¼šå°†æ–°çš„å¯¹è±¡èµ‹å€¼ç»™å¯¹è±¡å˜é‡çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡å˜é‡å°±æŒ‡å‘äº†æ–°å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼Œè·Ÿæ—§å¼•ç”¨åˆ‡æ–­å…³è”</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">let a &#x3D; &#123;&#125;;let b &#x3D; a;a &#x3D; &#123; name: &quot;Gopal&quot; &#125;;&#x2F;&#x2F; false &#123;name: &#39;Gopal&#39;&#125; &#123;&#125;console.log(b &#x3D;&#x3D;&#x3D; a, a, b);</code></pre><p><strong>åº”ç”¨åœºæ™¯</strong></p><ul><li>å¢å¼ºä½ çš„å‡½æ•°åŠŸèƒ½<ul><li>å¦‚ä¸Šé¢çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œåœ¨åŸæœ‰çš„å‡½æ•°ä¹‹ä¸Šï¼Œå®ç°ç‰¹å®šçš„é€»è¾‘ã€‚</li></ul></li><li>è¿½è¸ª XSS æ”»å‡»<ul><li>ä¸€èˆ¬ XSS æ”»å‡»ä¼šå…ˆåˆ©ç”¨ alert() ç­‰æ–¹æ³•è¾“å‡ºä¿¡æ¯è¿›è¡Œæµ‹è¯•ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹åŸå…ˆçš„ alert() è¿›è¡ŒåŠ«æŒï¼Œå‘å…¶è¾“å…¥è¿½è¸ªä¿¡æ¯çš„ä»£ç ï¼Œæœ€åæ‰æŠŠåŸå‡½æ•°æ‰§è¡Œã€‚<pre class="line-numbers language-js" data-language="js"><code class="language-js">function report(caller) &#123;  var img &#x3D; new Image();  img.src &#x3D; &#96;http:&#x2F;&#x2F;www.site.com&#x2F;getReport.php?caller&#x3D;$&#123;encodeURIComponent(    caller  )&#125;&#96;;&#125;var _alert &#x3D; window.alert;window.alert &#x3D; function (s) &#123;  &#x2F;&#x2F; æ‹¿åˆ°æ”»å‡»è€…ç›¸å…³ä¿¡æ¯ï¼Œå¹¶ä¸ŠæŠ¥  report(alert.caller);  _alert(s);&#125;;alert(&quot;test&quot;);</code></pre></li></ul></li></ul><p><strong>åŠ«æŒ ajax è¯·æ±‚ï¼Œå®ç° mock åŠŸèƒ½</strong></p><ul><li>mock.js ä¸­ï¼Œå°±æ˜¯é€šè¿‡å¯¹åŸç”Ÿçš„ XMLHttpRequestï¼ˆæˆ– ActiveXObjectï¼‰è¿›è¡ŒåŠ«æŒï¼Œåˆ¤æ–­æœ‰æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ•°æ®æ¨¡æ¿ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™æ‹¦æˆª XHR è¯·æ±‚é€»è¾‘ï¼Œæ‰§è¡Œè‡ªèº«è§„åˆ™å¯¹åº”çš„é€»è¾‘ã€‚å¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„æ•°æ®æ¨¡æ¿ï¼Œåˆ™é‡‡ç”¨åŸç”Ÿ XHR å‘é€è¯·æ±‚ã€‚è¯¦ç»†ä»£ç çœ‹ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fnuysoft%2FMock%2Fblob%2Frefactoring%2Fsrc%2Fmock%2Fxhr%2Fxhr.js" target="_blank" >è¿™é‡Œ</a> ã€‚</li></ul><h2 id="æ•°æ®åŠ«æŒ-defineProperty"><a href="#æ•°æ®åŠ«æŒ-defineProperty" class="headerlink" title="æ•°æ®åŠ«æŒ defineProperty"></a>æ•°æ®åŠ«æŒ defineProperty</h2><h2 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty()"></a>Object.defineProperty()</h2><p>é€šè¿‡è®¾ç½®å¯¹è±¡å±æ€§ getter å’Œ setter æ¥ç›‘å¬å±æ€§çš„å˜åŒ–ï¼Œå¯ä»¥å®ç°æ•°æ®åŠ«æŒã€‚getter æ—¶å€™è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œsetter æ—¶å€™è¿›è¡Œæ•°æ®å˜æ›´æ—¶é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function defineReactive(obj, key, value) &#123;  observe(value); &#x2F;&#x2F; é€’å½’å­å±æ€§  Object.defineProperty(obj, key, &#123;    enumerable: true,    configurable: true,    get: function reactiveGetter() &#123;      collectDeps(); &#x2F;&#x2F; æ”¶é›†ä¾èµ–      return value;    &#125;,    set: function reactiveSetter(newVal) &#123;      observe(newVal); &#x2F;&#x2F; è‹¥æ˜¯æ–°å€¼æ˜¯å¯¹è±¡ï¼Œåˆ™é€’å½’å­å±æ€§      if (value !&#x3D;&#x3D; newVal) &#123;        notify(); &#x2F;&#x2F; é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾        console.log(&quot;æ•°æ®å˜æ›´äº†&quot;);        value &#x3D; newVal;      &#125;    &#125;,  &#125;);&#125;function observe(obj) &#123;  if (!obj || typeof obj !&#x3D;&#x3D; &quot;object&quot;) &#123;    return;  &#125;  Object.keys(obj).forEach((key) &#x3D;&gt; &#123;    &#x2F;&#x2F; æœ‰é€’å½’    defineReactive(obj, key, obj[key]);  &#125;);&#125;var data &#x3D; &#123;  name: &quot;Gopal&quot;,  sex: &quot;male&quot;,&#125;;</code></pre><p><strong>ç¼ºç‚¹</strong></p><ul><li>æ— æ³•æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„æ–°å¢æˆ–åˆ é™¤</li></ul><p>ç”±äº js çš„åŠ¨æ€æ€§ï¼Œå¯ä»¥ä¸ºå¯¹è±¡è¿½åŠ æ–°çš„å±æ€§æˆ–è€…åˆ é™¤å…¶ä¸­æŸä¸ªå±æ€§ï¼Œè¿™ç‚¹å¯¹ç»è¿‡ Object.defineProperty æ–¹æ³•å»ºç«‹çš„å“åº”å¼å¯¹è±¡æ¥è¯´ï¼Œåªèƒ½è¿½è¸ªå¯¹è±¡å·²æœ‰æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹ï¼Œæ— æ³•è¿½è¸ªæ–°å¢å±æ€§ æˆ–åˆ é™¤å±æ€§ï¼Œè¿™å°±éœ€è¦å¦å¤–å¤„ç†ã€‚</p><ul><li>æ— æ³•ç›‘å¬æ•°ç»„çš„å˜åŒ–</li></ul><p>vue åœ¨å®ç°æ•°ç»„çš„å“åº”å¼æ—¶ï¼Œä½¿ç”¨äº†ä¸€äº› hack,æŠŠæ— æ³•ç›‘å¬æ•°ç»„çš„æƒ…å†µé€šè¿‡é‡å†™æ•°ç»„çš„éƒ¨åˆ†æ–¹æ³•æ¥å®ç°å“åº”å¼ï¼Œè¿™ä¹Ÿåªé™åˆ¶åœ¨æ•°ç»„çš„ push&#x2F;pop&#x2F;shift&#x2F;unshift&#x2F;splice&#x2F;sort&#x2F;reverse 7 ä¸ªæ–¹æ³•ä¸Šï¼Œå…¶ä»–æ–¹æ³•æ— æ³•ç›‘å¬ã€‚<code>ç›®å‰æ²¡è¯»è¿‡æºç ï¼Œä¸æ™“å¾—è¿™æ¬æ¥æ–‡ç« å†…å®¹æ˜¯å¦æ­£ç¡®</code></p><h2 id="æ•°æ®åŠ«æŒ-Proxy"><a href="#æ•°æ®åŠ«æŒ-Proxy" class="headerlink" title="æ•°æ®åŠ«æŒ Proxy"></a>æ•°æ®åŠ«æŒ Proxy</h2><p>Proxy,å­—é¢æ„æ€æ˜¯ä»£ç†ï¼Œæ˜¯ ES6 æä¾›çš„ä¸€ä¸ªæ–°çš„ API,ç”¨äºä¿®æ”¹æŸäº›æ“ä½œçš„é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥ç†è§£ä¸ºåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰åšä¸€å±‚æ‹¦æˆªï¼Œå¤–éƒ¨æ‰€æœ‰çš„è®¿é—®éƒ½å¿…é¡»é€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œé€šè¿‡è¿™å±‚æ‹¦æˆªå¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ã€ä¿®æ”¹æˆ–è€…æ”¶é›†ä¿¡æ¯ä¹‹ç±»</p><p>ES6 åŸç”Ÿæä¾›çš„ Proxy æ„é€ å‡½æ•°ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var proxy &#x3D; new Proxy(target, handler);</code></pre><p>å…¶ä¸­ obj ä¸º Proxy è¦æ‹¦æˆªçš„å¯¹è±¡ï¼Œhandler ç”¨æ¥å®šåˆ¶æ‹¦æˆªçš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ä»£ç†å¯¹è±¡ proxyï¼›Proxy ä»£ç†ç‰¹ç‚¹ï¼š</p><ul><li>Proxy çš„ä»£ç†é’ˆå¯¹çš„æ˜¯æ•´ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯åƒ Object.defineProperty é’ˆå¯¹æŸä¸ªå±æ€§ã€‚åªéœ€åšä¸€å±‚ä»£ç†å°±å¯ä»¥ç›‘å¬åŒçº§ç»“æ„ä¸‹çš„æ‰€æœ‰å±æ€§å˜åŒ–ï¼ŒåŒ…æ‹¬æ–°å¢å±æ€§å’Œåˆ é™¤å±æ€§ã€‚</li><li>Proxy ä¹Ÿå¯ä»¥ç›‘å¬æ•°ç»„çš„å˜åŒ–ã€‚</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">var proxy &#x3D; new Proxy([1, 2, 3], &#123;  get: function (target, property) &#123;    console.log(target, property);    return target[property];  &#125;,&#125;);proxy[0] &#x3D; 4;proxy.push(5);proxy.length;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">let handler &#x3D; &#123;  get: function (target, key) &#123;    if (target[key] &#x3D;&#x3D;&#x3D; &quot;object&quot; &amp;&amp; target[key] !&#x3D;&#x3D; null) &#123;      return new Proxy(target[key], handler);    &#125;    collectDeps(); &#x2F;&#x2F; æ”¶é›†ä¾èµ–    return Reflect.get(target, key);  &#125;,  set(target, key, value) &#123;    if (key &#x3D;&#x3D;&#x3D; &quot;length&quot;) return true;    notifyRender(); &#x2F;&#x2F; é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾    return Reflect.set(target, key, value);  &#125;,&#125;;let proxy &#x3D; new Proxy(data, handler);proxy.age &#x3D; 18; &#x2F;&#x2F; æ”¯æŒæ–°å¢å±æ€§let proxy1 &#x3D; new Proxy(&#123; arr: [] &#125;, handler);proxy1.arr[0] &#x3D; &quot;proxy&quot;;</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://juejin.cn/post/7103837916274622494" target="_blank" >ä½ è¿˜ä¸çŸ¥é“ JavaScript ä¸­çš„å‡½æ•°åŠ«æŒä¹ˆï¼Ÿ</a><br><a href="https://wenku.baidu.com/view/a78cb667fd4733687e21af45b307e87101f6f8ea.html" target="_blank" >æ•°æ®åŠ«æŒ</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®è¡¥node_modulesä¸‹æºç </title>
      <link href="//post/2022-06-09patch-package.html"/>
      <url>//post/2022-06-09patch-package.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä¹‹å‰åœ¨ç®€ä¹¦ä¸Šè®°å½•è¿‡ï¼Œæ²¡è¿ç§»ç®€ä¹¦æ–‡ç« ï¼Œæ‰€ä»¥é‡æ–°è®°å½•</p><p>ç”±äº<code>hexo-theme-aurora</code>ä»£ç é…è‰²ä¸æ˜¯å¾ˆå‹å¥½ï¼Œéœ€è¦è‡ªå®šä¹‰é…è‰²ï¼Œåˆä¸æƒ³æ”¹å…¶ github ä¸Šä»£ç ï¼Œç›´æ¥å¤„ç†<code>node_modules</code>ä¸‹çš„é…è‰²æ–‡ä»¶</p><h2 id="å®‰è£…-patch-package"><a href="#å®‰è£…-patch-package" class="headerlink" title="å®‰è£… patch-package"></a>å®‰è£… patch-package</h2><p>patch-package åŒ…å¯ä»¥é€šè¿‡ npm è¿›è¡Œå®‰è£…ã€‚</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i patch-package --save-dev</code></pre><p>æˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡ yarn è¿›è¡Œå®‰è£…ã€‚</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yarn add patch-package -D</code></pre><h2 id="ä¿®æ”¹åŒ…ä»£ç "><a href="#ä¿®æ”¹åŒ…ä»£ç " class="headerlink" title="ä¿®æ”¹åŒ…ä»£ç "></a>ä¿®æ”¹åŒ…ä»£ç </h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">&#x2F;node_modules&#x2F;æŸåŒ…åä¸‹ï¼ŒæŒ‰éœ€ä¿®æ”¹</code></pre><h2 id="åˆ›å»ºè¡¥ä¸"><a href="#åˆ›å»ºè¡¥ä¸" class="headerlink" title="åˆ›å»ºè¡¥ä¸"></a>åˆ›å»ºè¡¥ä¸</h2><p>åœ¨ä¿®æ”¹ä¾èµ–åŒ…å†…å®¹åï¼Œå°±å¯ä»¥è¿è¡Œ patch-package åˆ›å»º patch æ–‡ä»¶äº†ã€‚</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yarn patch-package åŒ…å # ä½¿ç”¨ yarn</code></pre><p>è¿è¡Œåé€šå¸¸ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ patches ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º åŒ…å+version.patch çš„æ–‡ä»¶ã€‚å°†è¯¥ patch æ–‡ä»¶æäº¤è‡³ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œå³å¯åœ¨ä¹‹ååº”ç”¨è¯¥è¡¥ä¸äº†ã€‚<br>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ğŸ‘‘ ~&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog git:(main) âœ— $ yarn patch-package hexo-theme-aurorayarn run v1.4.0$ &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog&#x2F;node_modules&#x2F;.bin&#x2F;patch-package hexo-theme-aurorapatch-package 6.4.7â€¢ Creating temporary folderâ€¢ Installing hexo-theme-aurora@1.5.5 with yarnâ€¢ Diffing your files with clean filesâœ” Created file patches&#x2F;hexo-theme-aurora+1.5.5.patchğŸ’¡ hexo-theme-aurora is on GitHub! To draft an issue based on your patch run    yarn patch-package hexo-theme-aurora --create-issueâœ¨  Done in 5.48s.</code></pre><h2 id="é…ç½®-npm-è„šæœ¬é’©å­"><a href="#é…ç½®-npm-è„šæœ¬é’©å­" class="headerlink" title="é…ç½® npm è„šæœ¬é’©å­"></a>é…ç½® npm è„šæœ¬é’©å­</h2><p>å®Œæˆä¸Šè¿°æ“ä½œåï¼Œæœ€åè¿˜éœ€è¦ä¿®æ”¹ package.json çš„å†…å®¹ï¼Œåœ¨ scripts ä¸­åŠ å…¥â€postinstallâ€: â€œpatch-packageâ€ã€‚</p><pre class="line-numbers language-none"><code class="language-none">&quot;scripts&quot;: &#123;  &quot;postinstall&quot;: &quot;patch-package&quot;&#125;</code></pre><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><h2 id="æ¸…ç†-node-modules"><a href="#æ¸…ç†-node-modules" class="headerlink" title="æ¸…ç† node_modules"></a>æ¸…ç† node_modules</h2><p><strong>é¡¹ç›®æ ¹ç›®å½•</strong>åˆ«æé”™äº†,ç®€å•ç²—æš´ç‚¹ï¼Œç›´æ¥å…¨æ¸…æ‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">rm -rf node_modules &amp;&amp; yarn</code></pre><h2 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ğŸ‘‘ ~&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog git:(main) âœ— $ yarnyarn install v1.4.0[1&#x2F;4] ğŸ”  Resolving packages...[2&#x2F;4] ğŸšš  Fetching packages...[3&#x2F;4] ğŸ”—  Linking dependencies...warning &quot;hexo &gt; nunjucks@3.2.3&quot; has unmet peer dependency &quot;chokidar@^3.3.0&quot;.warning &quot;hexo-browsersync &gt; browser-sync &gt; socket.io &gt; engine.io &gt; ws@8.2.3&quot; has unmet peer dependency &quot;bufferutil@^4.0.1&quot;.warning &quot;hexo-browsersync &gt; browser-sync &gt; socket.io &gt; engine.io &gt; ws@8.2.3&quot; has unmet peer dependency &quot;utf-8-validate@^5.0.2&quot;.warning &quot;hexo-renderer-marked &gt; jsdom@19.0.0&quot; has unmet peer dependency &quot;canvas@^2.5.0&quot;.warning &quot;hexo-renderer-marked &gt; jsdom &gt; ws@8.5.0&quot; has unmet peer dependency &quot;bufferutil@^4.0.1&quot;.warning &quot;hexo-renderer-marked &gt; jsdom &gt; ws@8.5.0&quot; has unmet peer dependency &quot;utf-8-validate@^5.0.2&quot;.warning &quot;hexo-theme-aurora &gt; pinia@2.0.13&quot; has unmet peer dependency &quot;@vue&#x2F;composition-api@^1.4.0&quot;.warning &quot;hexo-theme-aurora &gt; pinia@2.0.13&quot; has unmet peer dependency &quot;typescript@&gt;&#x3D;4.4.4&quot;.warning &quot;hexo-theme-aurora &gt; pinia &gt; vue-demi@0.12.5&quot; has unmet peer dependency &quot;@vue&#x2F;composition-api@^1.0.0-rc.1&quot;.[4&#x2F;4] ğŸ“ƒ  Building fresh packages...$ yarn patch-package # çœ‹è¿™é‡Œï¼Œåœ¨è¿è¡Œä¿®è¡¥yarn run v1.4.0$ &#x2F;Users&#x2F;haotian&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog&#x2F;node_modules&#x2F;.bin&#x2F;patch-packagepatch-package 6.4.7Applying patches...hexo-theme-aurora@1.5.5 âœ”âœ¨  Done in 1.00s.âœ¨  Done in 13.93s.</code></pre><h2 id="æäº¤ä»£ç "><a href="#æäº¤ä»£ç " class="headerlink" title="æäº¤ä»£ç "></a>æäº¤ä»£ç </h2><p>å°† patches æäº¤åˆ°ä»£ç ä»“åº“ï¼Œä»¥ååœ¨å…¶ä»–æœºå™¨ä¸Šï¼Œç›´æ¥å®‰è£…ä¾èµ–åŒ…å³å¯ã€‚</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx patch-package hexo-theme-aurora</code></pre><p>è¿™ä¸ªå‘½ä»¤ä½¿ç”¨ npm è¿è¡Œçš„ï¼Œå¯èƒ½ä¸ä¼šæˆåŠŸï¼Œä½¿ç”¨<code>yarn patch-package hexo-theme-aurora</code></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ğŸ‘‘ ~&#x2F;Desktop&#x2F;other&#x2F;blog&#x2F;technology-blog git:(main) âœ— $ npx patch-package  hexo-theme-aurorapatch-package 6.4.7â€¢ Creating temporary folderâ€¢ Installing hexo-theme-aurora@1.5.5 with yarnwarning package.json: No license fieldwarning No license fielderror An unexpected error occurred: &quot;https:&#x2F;&#x2F;registry.npmjs.org&#x2F;axios: ETIMEDOUT&quot;.Error: https:&#x2F;&#x2F;registry.npmjs.org&#x2F;core-js: ETIMEDOUT    at Timeout._onTimeout (&#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;yarn&#x2F;lib&#x2F;cli.js:132130:19)    at listOnTimeout (node:internal&#x2F;timers:557:17)</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://github.com/auroral-ui/hexo-theme-aurora/issues/168">hexo-theme-aurora&#x2F;issues&#x2F;168</a><br><a href="https://www.npmjs.com/package/patch-package">patch-package</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.Typescript å·¥å…·ç±»å‹</title>
      <link href="//post/2022-06-09ts-util-type.html"/>
      <url>//post/2022-06-09ts-util-type.html</url>
      
        <content type="html"><![CDATA[<p>TypeScript provides several utility types to facilitate common type transformations. These utilities are available globally.<br><code>Typescriptæä¾›äº†ä¸€äº›å¸®åŠ©ç±»å‹è½¬æ¢çš„å·¥å…·ç±»å‹ï¼Œè¿™äº›å·¥å…·ç±»å‹å¯ä»¥åœ¨å…¨å±€èŒƒå›´å†…ä½¿ç”¨ã€‚</code></p><h2 id="Partial"><a href="#Partial" class="headerlink" title="Partial"></a>Partial<Type></h2><p>Released: 2.1</p><p>Constructs a type with all properties of Type set to optional. This utility will return a type that represents all subsets of a given type.<br><code>æ„é€ ä¸€ä¸ªå…·æœ‰æ‰€æœ‰å±æ€§ç±»å‹çš„å¯é€‰å±æ€§çš„ç±»å‹ã€‚è¿™ä¸ªå·¥å…·å°†è¿”å›ä¸€ä¸ªè¡¨ç¤ºç»™å®šç±»å‹çš„æ‰€æœ‰å­é›†çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleinterface Todo &#123;  title: string;  description: string;&#125;function updateTodo(todo: Todo, fieldsToUpdate: Partial&lt;Todo&gt;) &#123;  return &#123; ...todo, ...fieldsToUpdate &#125;;&#125;const todo1 &#x3D; &#123;  title: &quot;organize desk&quot;,  description: &quot;clear clutter&quot;,&#125;;const todo2 &#x3D; updateTodo(todo1, &#123;  description: &quot;throw out trash&quot;,&#125;);</code></pre><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><strong>ä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰</strong></p><ul><li>é¦–å…ˆé€šè¿‡ keyof Tï¼Œéå†å‡ºç±»å‹ T çš„æ‰€æœ‰å±æ€§ï¼Œç„¶åé€šè¿‡ in æ“ä½œç¬¦è¿›è¡Œéå†ï¼Œæœ€ååœ¨å±æ€§ååŠ ä¸Š?ï¼Œå°†å±æ€§å˜ä¸ºå¯é€‰å±æ€§ã€‚</li><li>æ³¨æ„ è¿™ä¸ª <code>in</code> ä¸æ˜¯<code>æ”¶ç¼©ç±»å‹æ“ä½œç¬¦in</code> ,è€Œæ˜¯<code>æ˜ å°„ç±»å‹</code>ä¸­çš„<code>in</code></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;TypeScript&#x2F;blob&#x2F;HEAD&#x2F;src&#x2F;lib&#x2F;es5.d.ts#L1517type Partial&lt;T&gt; &#x3D; &#123;  [P in keyof T]?: T[P];&#125;;</code></pre><h2 id="Required"><a href="#Required" class="headerlink" title="Required"></a>Required<Type></h2><p>Released:2.8</p><p>Constructs a type consisting of all properties of Type set to required. The opposite of Partial.<br><code>æ„é€ ä¸€ä¸ªå…·æœ‰æ‰€æœ‰å±æ€§ç±»å‹çš„å¿…éœ€å±æ€§çš„ç±»å‹ã€‚ä¸Partialç›¸åã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleinterface Props &#123;a?: number;b?: string;&#125;const obj: Props &#x3D; &#123; a: 5 &#125;;const obj2: Required&lt;Props&gt; &#x3D; &#123; a: 5 &#125;;Property &#39;b&#39; is missing in type &#39;&#123; a: number; &#125;&#39; but required in type &#39;Required&lt;Props&gt;&#39;.</code></pre><h2 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>åŸç†ï¼š<strong>ä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰</strong> ç”¨äºå°† T ç±»å‹çš„æ‰€æœ‰å±æ€§è®¾ç½®ä¸ºå¿…é€‰çŠ¶æ€ï¼Œé¦–å…ˆé€šè¿‡ keyof Tï¼Œå–å‡ºç±»å‹ T çš„æ‰€æœ‰å±æ€§ï¼Œ ç„¶åé€šè¿‡ in æ“ä½œç¬¦è¿›è¡Œéå†ï¼Œæœ€ååœ¨å±æ€§åçš„ ? å‰åŠ ä¸Š -ï¼Œå°†å±æ€§å˜ä¸ºå¿…é€‰å±æ€§ã€‚</p><p>è¿™é‡Œé¡ºä¾¿è®²ä¸‹-è¿™ä¸ªç¬¦å·çš„ä½œç”¨ï¼Œè¿™æ˜¯ TypeScript 2.8 ä¸ºæ˜ å°„ç±»å‹å¢åŠ äº†æ·»åŠ æˆ–åˆ é™¤ç‰¹å®šä¿®é¥°ç¬¦çš„èƒ½åŠ›ã€‚å…·ä½“æ¥è¯´ï¼Œreadonly å’Œ?æ˜ å°„ç±»å‹ä¸­çš„å±æ€§ä¿®é¥°ç¬¦ç°åœ¨å¯ä»¥åŠ ä¸Š+æˆ–-å‰ç¼€ï¼Œä»¥æŒ‡ç¤ºåº”è¯¥æ·»åŠ æˆ–åˆ é™¤è¯¥ä¿®é¥°ç¬¦ï¼Œå½“ç„¶ä¸€èˆ¬+å·æ˜¯å¯ä»¥çœç•¥çš„ã€‚<a href="https://www.typescriptlang.org/docs/handbook/2/mapped-types.html#mapping-modifiers:~:text=You%20can%20remove%20or%20add%20these%20modifiers%20by%20prefixing%20with%20%2D%20or%20%2B.%20If%20you%20don%E2%80%99t%20add%20a%20prefix%2C%20then%20%2B%20is%20assumed.">ts å®˜ç½‘ ç±»å‹æ“ä½œç¬¦&#x2F;æ˜ å°„ç±»å‹</a></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Required&lt;T&gt; &#x3D; &#123;  [P in keyof T]-?: T[P];&#125;;</code></pre><h2 id="Readonly"><a href="#Readonly" class="headerlink" title="Readonly"></a>Readonly<Type></h2><p>Released:2.1</p><p>Constructs a type with all properties of Type set to readonly, meaning the properties of the constructed type cannot be reassigned.<br><code>æ„é€ ä¸€ä¸ªå…·æœ‰æ‰€æœ‰å±æ€§ç±»å‹çš„åªè¯»å±æ€§çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleinterface Todo &#123;  title: string;&#125;const todo: Readonly&lt;Todo&gt; &#x3D; &#123;  title: &quot;Delete inactive users&quot;,&#125;;todo.title &#x3D; &quot;Hello&quot;;&#x2F;&#x2F; Cannot assign to &#39;title&#39; because it is a read-only property.</code></pre><p>This utility is useful for representing assignment expressions that will fail at runtime (i.e. when attempting to reassign properties of a frozen object).<br><code>è¿™ä¸ªå·¥å…·æ˜¯ç”¨æ¥è¡¨ç¤ºåœ¨è¿è¡Œæ—¶å°†å¤±è´¥çš„èµ‹å€¼è¡¨è¾¾å¼çš„ç”¨é€”ï¼ˆå³å°è¯•é‡æ–°åˆ†é…ä¸€ä¸ªå†»ç»“å¯¹è±¡çš„å±æ€§ï¼‰ã€‚</code><br><strong>Object.freeze</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function freeze&lt;Type&gt;(obj: Type): Readonly&lt;Type&gt;;</code></pre><h2 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>åŸç†ï¼š<strong>ä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰</strong> æ¥æ”¶ä¸¤ä¸ªæ³›å‹ï¼ŒK ä¸º string | number | symbol å¯ä»¥ç»§æ‰¿çš„ç±»å‹ï¼Œè¿™ä¸‰ä¸ªä¹Ÿæ˜¯å¯¹è±¡ key æ‰€æ”¯æŒçš„åŸºç¡€ç±»å‹ï¼Œç„¶åé€šè¿‡ in æ“ä½œç¬¦å¯¹ K è¿›è¡Œéå†ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„ç±»å‹ä¸º T ç±»å‹ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Record&lt;K extends string | number | symbol, T&gt; &#x3D; &#123;  [P in K]: T;&#125;;</code></pre><h2 id="Record-lt-Keys-Type-gt"><a href="#Record-lt-Keys-Type-gt" class="headerlink" title="Record&lt;Keys, Type&gt;"></a>Record&lt;Keys, Type&gt;</h2><p>Released:2.1</p><p>Constructs an object type whose property keys are Keys and whose property values are Type. This utility can be used to map the properties of a type to another type.<br><code>ç”¨äºæ„é€ ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„key(é”®)éƒ½æ˜¯Keysç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„value(å€¼)éƒ½æ˜¯Typeç±»å‹ã€‚è¿™ä¸ªå·¥å…·ç±»å‹å¯ä»¥è¢«ç”¨äºæ˜ å°„ä¸€ä¸ªç±»å‹çš„å±æ€§åˆ°å¦ä¸€ä¸ªç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleinterface CatInfo &#123;  age: number;  breed: string;&#125;type CatName &#x3D; &quot;miffy&quot; | &quot;boris&quot; | &quot;mordred&quot;;const cats: Record&lt;CatName, CatInfo&gt; &#x3D; &#123;  miffy: &#123; age: 10, breed: &quot;Persian&quot; &#125;,  boris: &#123; age: 5, breed: &quot;Maine Coon&quot; &#125;,  mordred: &#123; age: 16, breed: &quot;British Shorthair&quot; &#125;,&#125;;cats.boris;const cats: Record&lt;CatName, CatInfo&gt;;</code></pre><h2 id="åŸç†-3"><a href="#åŸç†-3" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><strong>ä½¿ç”¨æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰</strong></p><p>æ¥æ”¶ä¸¤ä¸ªæ³›å‹ï¼ŒK ä¸º string | number | symbol å¯ä»¥ç»§æ‰¿çš„ç±»å‹ï¼Œè¿™ä¸‰ä¸ªä¹Ÿæ˜¯å¯¹è±¡ key æ‰€æ”¯æŒçš„åŸºç¡€ç±»å‹ï¼Œç„¶åé€šè¿‡ in æ“ä½œç¬¦å¯¹ K è¿›è¡Œéå†ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„ç±»å‹ä¸º T ç±»å‹ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Record&lt;K extends string | number | symbol, T&gt; &#x3D; &#123;  [P in K]: T;&#125;;</code></pre><h2 id="Pick-lt-Type-Keys-gt"><a href="#Pick-lt-Type-Keys-gt" class="headerlink" title="Pick&lt;Type, Keys&gt;"></a>Pick&lt;Type, Keys&gt;</h2><p>Released:2.1</p><p>Constructs a type by picking the set of properties Keys (string literal or union of string literals) from Type.<br><code>ç”¨äºæ„é€ ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„key(é”®)éƒ½æ˜¯Keysç±»å‹ï¼Œå®ƒæ‰€æœ‰çš„value(å€¼)éƒ½æ˜¯Typeç±»å‹ã€‚è¿™ä¸ªå·¥å…·ç±»å‹å¯ä»¥è¢«ç”¨äºæ˜ å°„ä¸€ä¸ªç±»å‹çš„å±æ€§åˆ°å¦ä¸€ä¸ªç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleinterface Todo &#123;  title: string;  description: string;  completed: boolean;&#125;type TodoPreview &#x3D; Pick&lt;Todo, &quot;title&quot; | &quot;completed&quot;&gt;;const todo: TodoPreview &#x3D; &#123;  title: &quot;Clean room&quot;,  completed: false,&#125;;todo;&#x2F;&#x2F; const todo: TodoPreview;</code></pre><h2 id="åŸç†-4"><a href="#åŸç†-4" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ä» T ç±»å‹ä¸­æå–éƒ¨åˆ†å±æ€§ï¼Œä½œä¸ºæ–°çš„è¿”å›ç±»å‹ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Pick&lt;T, K extends keyof T&gt; &#x3D; &#123;  [P in K]: T[P];&#125;;</code></pre><h2 id="Omit-lt-Type-Keys-gt"><a href="#Omit-lt-Type-Keys-gt" class="headerlink" title="Omit&lt;Type, Keys&gt;"></a>Omit&lt;Type, Keys&gt;</h2><p>Released:3.5</p><p>Constructs a type by picking all properties from Type and then removing Keys (string literal or union of string literals).<br><code>ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œå®ƒæ˜¯ä»Typeç±»å‹é‡Œé¢è¿‡æ»¤äº†ä¸€äº›å±æ€§Keys(Keysæ˜¯å­—ç¬¦ä¸²å­—é¢é‡ æˆ–è€… å­—ç¬¦ä¸²å­—é¢é‡çš„è”åˆç±»å‹)</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleinterface Todo &#123;  title: string;  description: string;  completed: boolean;  createdAt: number;&#125;type TodoPreview &#x3D; Omit&lt;Todo, &quot;description&quot;&gt;;const todo: TodoPreview &#x3D; &#123;  title: &quot;Clean room&quot;,  completed: false,  createdAt: 1615544252770,&#125;;todo;&#x2F;&#x2F; const todo: TodoPreview;type TodoInfo &#x3D; Omit&lt;Todo, &quot;completed&quot; | &quot;createdAt&quot;&gt;;const todoInfo: TodoInfo &#x3D; &#123;  title: &quot;Pick up kids&quot;,  description: &quot;Kindergarten closes at 5pm&quot;,&#125;;todoInfo;&#x2F;&#x2F; const todoInfo: TodoInfo</code></pre><h2 id="åŸç†-5"><a href="#åŸç†-5" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ä½¿ç”¨ <strong>keyof ç±»å‹æ“ä½œç¬¦å·</strong>ã€<strong>extends</strong>ã€<strong>ç±»å‹æ“ä½œç¬¦ Exclude</strong>ã€ <strong>ç±»å‹æ“ä½œç¬¦ Pick</strong></p><ul><li>ç»“åˆ Pick å’Œ Exclude æ–¹æ³•ï¼Œæå–å‡ºä¸å« K å±æ€§çš„ç±»å‹ã€‚</li><li>1.keyof T è¿”å›çš„æ˜¯è”åˆç±»å‹</li><li>2.<a href="https://www.typescriptlang.org/docs/handbook/2/conditional-types.html">extends</a></li><li>3.Exclude&lt;T, K&gt; è¿”å›çš„æ˜¯è”åˆç±»å‹ï¼Œ å¯ä»¥æ¥æ”¶ä¸€ä¸ªè”åˆç±»å‹å’Œä¸€ä¸ªè”åˆç±»å‹ï¼Œè¿”å›ä¸€ä¸ªè”åˆç±»å‹</li><li>4.æŠŠ K ä¸­çš„ key, ä» T ä¸­æ’é™¤æ‰ï¼Œå‰©ä¸‹çš„å°±æ˜¯ Omit çš„ç±»å‹ã€‚</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Omit&lt;T, K extends keyof T&gt; &#x3D; Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt;;</code></pre><h2 id="Exclude-lt-UnionType-ExcludedMembers-gt"><a href="#Exclude-lt-UnionType-ExcludedMembers-gt" class="headerlink" title="Exclude&lt;UnionType, ExcludedMembers&gt;"></a>Exclude&lt;UnionType, ExcludedMembers&gt;</h2><p>Released:2.8</p><p>Constructs a type by excluding from UnionType all union members that are assignable to ExcludedMembers.<br><code>ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œå®ƒæ˜¯ä»UnionTypeè”åˆç±»å‹é‡Œé¢æ’é™¤äº†æ‰€æœ‰å¯ä»¥èµ‹ç»™ExcludedMembersçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Example;type T0 &#x3D; Exclude&lt;&quot;a&quot; | &quot;b&quot; | &quot;c&quot;, &quot;a&quot;&gt;;&#x2F;&#x2F; type T0 &#x3D; &quot;b&quot; | &quot;c&quot;;type T1 &#x3D; Exclude&lt;&quot;a&quot; | &quot;b&quot; | &quot;c&quot;, &quot;a&quot; | &quot;b&quot;&gt;;&#x2F;&#x2F; type T1 &#x3D; &quot;c&quot;;type T2 &#x3D; Exclude&lt;string | number | (() &#x3D;&gt; void), Function&gt;;&#x2F;&#x2F; type T2 &#x3D; string | number;</code></pre><h2 id="extends-å…³é”®å­—"><a href="#extends-å…³é”®å­—" class="headerlink" title="extends å…³é”®å­—"></a>extends å…³é”®å­—</h2><p>ä¸å­¦ extendsï¼ŒExclude å’Œ Extractï¼Œå¾ˆéš¾ç†è§£</p><p>extends å…³é”®å­—åœ¨ TS ç¼–ç¨‹ä¸­å‡ºç°çš„é¢‘ç‡æŒºé«˜çš„ï¼Œè€Œä¸”<code>ä¸åŒåœºæ™¯ä¸‹ä»£è¡¨çš„å«ä¹‰ä¸ä¸€æ ·</code>ï¼Œç‰¹æ­¤æ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li><p>è¡¨ç¤ºç»§æ‰¿&#x2F;æ‹“å±•çš„å«ä¹‰</p></li><li><p>è¡¨ç¤ºçº¦æŸçš„å«ä¹‰</p></li><li><p>è¡¨ç¤ºåˆ†é…çš„å«ä¹‰</p></li></ul><hr/><h3 id="è¡¨ç¤ºç»§æ‰¿-x2F-æ‹“å±•"><a href="#è¡¨ç¤ºç»§æ‰¿-x2F-æ‹“å±•" class="headerlink" title="è¡¨ç¤ºç»§æ‰¿&#x2F;æ‹“å±•"></a><strong>è¡¨ç¤ºç»§æ‰¿&#x2F;æ‹“å±•</strong></h3><p>extends æ˜¯ ts é‡Œä¸€ä¸ªå¾ˆå¸¸è§çš„å…³é”®å­—ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ es6 é‡Œå¼•å…¥çš„ä¸€ä¸ªæ–°çš„å…³é”®å­—ã€‚åœ¨ js é‡Œï¼Œextends ä¸€èˆ¬å’Œ class ä¸€èµ·ä½¿ç”¨</p><ul><li>es6 ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">class Animal &#123;  kind &#x3D; &quot;animal&quot;;  constructor(kind) &#123;    this.kind &#x3D; kind;  &#125;  sayHello() &#123;    console.log(&#96;Hello, I am a $&#123;this.kind&#125;!&#96;);  &#125;&#125;class Dog extends Animal &#123;  constructor(kind) &#123;    super(kind);  &#125;  bark() &#123;    console.log(&quot;wang wang&quot;);  &#125;&#125;const dog &#x3D; new Dog(&quot;dog&quot;);dog.name; &#x2F;&#x2F;  &#x3D;&gt; &#39;dog&#39;dog.sayHello(); &#x2F;&#x2F; &#x3D;&gt; Hello, I am a dog!</code></pre><p>è¿™é‡Œ Dog ç»§æ‰¿äº†çˆ¶ç±»çš„ sayHello æ–¹æ³•ï¼Œå› ä¸ºå¯ä»¥åœ¨ Dog å®ä¾‹ dog ä¸Šè°ƒç”¨ã€‚</p><ul><li>ts ç»§æ‰¿æŸä¸ªç±»å‹<br>åœ¨ ts é‡Œï¼Œextends é™¤äº†å¯ä»¥åƒ js ç»§æ‰¿å€¼ï¼Œè¿˜å¯ä»¥ç»§æ‰¿&#x2F;æ‰©å±•ç±»å‹ï¼š</li></ul><pre class="line-numbers language-none"><code class="language-none">interface Animal &#123;  kind: string;&#125;interface Dog extends Animal &#123;  bark(): void;&#125;&#x2F;&#x2F; Dog &#x3D;&gt; &#123; name: string; bark(): void &#125;</code></pre><hr/><h3 id="æ³›å‹çº¦æŸ"><a href="#æ³›å‹çº¦æŸ" class="headerlink" title="æ³›å‹çº¦æŸ"></a>æ³›å‹çº¦æŸ</h3><p>åœ¨ä¹¦å†™æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å¯¹ç±»å‹å‚æ•°ä½œä¸€å®šçš„é™åˆ¶ï¼Œæ¯”å¦‚å¸Œæœ›ä¼ å…¥çš„å‚æ•°éƒ½æœ‰ name å±æ€§çš„æ•°ç»„æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getCnames&lt;T extends &#123; name: string &#125;&gt;(entities: T[]): string[] &#123;  return entities.map((entity) &#x3D;&gt; entity.cname);&#125;</code></pre><p>è¿™é‡Œ extends å¯¹ä¼ å…¥çš„å‚æ•°ä½œäº†ä¸€ä¸ªé™åˆ¶ï¼Œå°±æ˜¯ entities çš„æ¯ä¸€é¡¹å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¿…é¡»å«æœ‰ç±»å‹ä¸º string çš„ cname å±æ€§ã€‚</p><p>å†æ¯”å¦‚ï¼Œredux é‡Œ dispatch ä¸€ä¸ª actionï¼Œå¿…é¡»åŒ…å« type å±æ€§ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;841660202&#x2F;redux&#x2F;blob&#x2F;2edd0363271af46e327e118f3d92e78e258bf0cd&#x2F;src&#x2F;types&#x2F;store.ts#L83&#x2F;&#x2F; Dispatchexport interface Dispatch&lt;A extends Action &#x3D; AnyAction&gt; &#123;  &lt;T extends A&gt;(action: T, ...extraArgs: any[]): T;&#125;&#x2F;&#x2F; AnyActionexport interface AnyAction extends Action &#123;  &#x2F;&#x2F; Allows any extra properties to be defined in an action.  [extraProps: string]: any;&#125;&#x2F;&#x2F; Actionexport interface Action&lt;T &#x3D; any&gt; &#123;  type: T;&#125;&#x2F;&#x2F; ä¸Šè¿°ä»£ç  ç®€åŒ–interface Dispatch&lt;T extends &#123; type: string &#125;&gt; &#123;  (action: T): T;&#125;</code></pre><h3 id="æ¡ä»¶ç±»å‹ä¸é«˜é˜¶ç±»å‹"><a href="#æ¡ä»¶ç±»å‹ä¸é«˜é˜¶ç±»å‹" class="headerlink" title="æ¡ä»¶ç±»å‹ä¸é«˜é˜¶ç±»å‹"></a>æ¡ä»¶ç±»å‹ä¸é«˜é˜¶ç±»å‹</h3><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">SomeType extends OtherType ? TrueType : FalseType;</code></pre><p>When the type on the left of the extendsis assignable to the one on the right, then youâ€™ll get the type in the first branch (the â€œtrueâ€ branch); otherwise youâ€™ll get the type in the latter branch (the â€œfalseâ€ branch).<br><code>å½“å·¦è¾¹çš„ç±»å‹å¯ä»¥èµ‹å€¼ç»™å³è¾¹çš„ç±»å‹ï¼Œé‚£ä¹ˆä½ å°±ä¼šå¾—åˆ°ç¬¬ä¸€ä¸ªåˆ†æ”¯çš„ç±»å‹ï¼Œå¦åˆ™ä½ å°±ä¼šå¾—åˆ°ç¬¬äºŒä¸ªåˆ†æ”¯çš„ç±»å‹ã€‚</code></p><p>extends è¿˜æœ‰ä¸€å¤§ç”¨é€”å°±æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªç±»å‹æ˜¯ä¸æ˜¯å¯ä»¥åˆ†é…ç»™å¦ä¸€ä¸ªç±»å‹ï¼Œè¿™åœ¨å†™é«˜çº§ç±»å‹çš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œä¸¾ä¸ª ????ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Human &#x3D; &#123;  name: string;&#125;;type Duck &#x3D; &#123;  name: string;&#125;;type Bool &#x3D; Duck extends Human ? &quot;yes&quot; : &quot;no&quot;; &#x2F;&#x2F; Bool &#x3D;&gt; &#39;yes&#39;</code></pre><p>åœ¨ vscode é‡Œæˆ–è€… ts playground é‡Œè¾“å…¥è¿™æ®µä»£ç ï¼Œä½ ä¼šå‘ç° Bool çš„ç±»å‹æ˜¯â€™yesâ€™ã€‚è¿™æ˜¯å› ä¸º Human å’Œ Duck çš„ç±»å‹å®Œå…¨ç›¸åŒï¼Œæˆ–è€…è¯´ Human ç±»å‹çš„ä¸€åˆ‡çº¦æŸæ¡ä»¶ï¼ŒDuck éƒ½å…·å¤‡ï¼›æ¢è¨€ä¹‹ï¼Œç±»å‹ä¸º Human çš„å€¼å¯ä»¥åˆ†é…ç»™ç±»å‹ä¸º Duck çš„å€¼ï¼ˆåˆ†é…æˆåŠŸçš„å‰ææ˜¯ï¼ŒDuck é‡Œé¢å¾—çš„ç±»å‹å¾—æœ‰ä¸€æ ·çš„ï¼‰ï¼Œåä¹‹äº¦ç„¶ã€‚éœ€è¦ç†è§£çš„æ˜¯ï¼Œè¿™é‡Œ A extends Bï¼Œæ˜¯æŒ‡ç±»å‹ A å¯ä»¥åˆ†é…ç»™ç±»å‹ Bï¼Œè€Œä¸æ˜¯è¯´ç±»å‹ A æ˜¯ç±»å‹ B çš„å­é›†ã€‚ç¨å¾®æ‰©å±•ä¸‹æ¥è¯¦ç»†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Human &#x3D; &#123;  name: string;  occupation: string;&#125;;type Duck &#x3D; &#123;  name: string;&#125;;type Bool &#x3D; Duck extends Human ? &quot;yes&quot; : &quot;no&quot;; &#x2F;&#x2F; Bool &#x3D;&gt; &#39;no&#39;</code></pre><p>å½“æˆ‘ä»¬ç»™ Human åŠ ä¸Šä¸€ä¸ª occupation å±æ€§ï¼Œå‘ç°æ­¤æ—¶ Bool æ˜¯â€™noâ€™ï¼Œè¿™æ˜¯å› ä¸º Duck æ²¡æœ‰ç±»å‹ä¸º string çš„ occupation å±æ€§ï¼Œç±»å‹ Duck ä¸æ»¡è¶³ç±»å‹ Human çš„ç±»å‹çº¦æŸã€‚å› æ­¤ï¼ŒA extends Bï¼Œæ˜¯æŒ‡ç±»å‹ A å¯ä»¥åˆ†é…ç»™ç±»å‹ Bï¼Œè€Œä¸æ˜¯è¯´ç±»å‹ A æ˜¯ç±»å‹ B çš„å­é›†ï¼Œç†è§£ extends åœ¨ç±»å‹ä¸‰å…ƒè¡¨è¾¾å¼é‡Œçš„ç”¨æ³•éå¸¸é‡è¦ã€‚</p><p>ç»§ç»­çœ‹ç¤ºä¾‹</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type A1 &#x3D; &quot;x&quot; extends &quot;x&quot; ? string : number; &#x2F;&#x2F; stringtype A2 &#x3D; &quot;x&quot; | &quot;y&quot; extends &quot;x&quot; ? string : number; &#x2F;&#x2F; numbertype P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;type A3 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; ?</code></pre><p>A1 å’Œ A2 æ˜¯ extends æ¡ä»¶åˆ¤æ–­çš„æ™®é€šç”¨æ³•ï¼Œå’Œä¸Šé¢çš„åˆ¤æ–­æ–¹æ³•ä¸€æ ·ã€‚</p><p>P æ˜¯å¸¦å‚æ•° T çš„æ³›å‹ç±»å‹ï¼Œå…¶è¡¨è¾¾å¼å’Œ A1ï¼ŒA2 çš„å½¢å¼å®Œå…¨ç›¸åŒï¼ŒA3 æ˜¯æ³›å‹ç±»å‹ P ä¼ å…¥å‚æ•°â€™xâ€™ | â€˜yâ€™å¾—åˆ°çš„ç±»å‹ï¼Œå¦‚æœå°†â€™xâ€™ | â€˜yâ€™å¸¦å…¥æ³›å‹ç±»çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥çœ‹åˆ°å’Œ A2 ç±»å‹çš„å½¢å¼æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œé‚£æ˜¯ä¸æ˜¯è¯´æ˜ï¼ŒA3 å’Œ A2 çš„ç±»å‹å°±æ˜¯å®Œå…¨ä¸€æ ·çš„å‘¢ï¼Ÿ</p><p>æœ‰å…´è¶£å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼Œè¿™é‡Œå°±ç›´æ¥ç»™ç»“è®ºäº†</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;type A3 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; A3 çš„ç±»å‹æ˜¯ string | number</code></pre><p>æ˜¯ä¸æ˜¯å¾ˆåç›´è§‰ï¼Ÿè¿™ä¸ªåç›´è§‰ç»“æœçš„åŸå› å°±æ˜¯æ‰€è°“çš„åˆ†é…æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰</p><p>When conditional types act on a generic type, they become distributive when given a union type<br><code>å½“æ¡ä»¶ç±»å‹ä½œç”¨äºæ³›å‹ç±»å‹æ—¶ï¼Œå®ƒä»¬å˜æˆåˆ†é…æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰</code></p><p>è¿™å¥è¯ç¿»è¯‘è¿‡æ¥ä¹Ÿè¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Œå¤§ç™½è¯</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¯¹äºä½¿ç”¨ extends å…³é”®å­—çš„æ¡ä»¶ç±»å‹ï¼ˆå³ä¸Šé¢çš„ä¸‰å…ƒè¡¨è¾¾å¼ç±»å‹ï¼‰ï¼Œ<strong>å¦‚æœ extends å‰é¢çš„å‚æ•°æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå½“ä¼ å…¥è¯¥å‚æ•°çš„æ˜¯è”åˆç±»å‹ï¼Œåˆ™ä½¿ç”¨åˆ†é…å¾‹è®¡ç®—æœ€ç»ˆçš„ç»“æœã€‚åˆ†é…å¾‹æ˜¯æŒ‡ï¼Œå°†è”åˆç±»å‹çš„è”åˆé¡¹æ‹†æˆå•é¡¹ï¼Œåˆ†åˆ«ä»£å…¥æ¡ä»¶ç±»å‹ï¼Œç„¶åå°†æ¯ä¸ªå•é¡¹ä»£å…¥å¾—åˆ°çš„ç»“æœå†è”åˆèµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ¤æ–­ç»“æœã€‚</strong></p></blockquote><p>If we plug a union type into ToArray, then the conditional type will be applied to each member of that union.<br><code>å¦‚æœå°†è”åˆç±»å‹ä¼ å…¥ ToArrayï¼Œåˆ™æ¡ä»¶ç±»å‹å°†ä¼šåº”ç”¨åˆ°è”åˆç±»å‹çš„æ¯ä¸€ä¸ªæˆå‘˜ã€‚</code></p><p>è¿˜æ˜¯ç”¨ä¸Šé¢çš„ä¾‹å­è¯´æ˜</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;type A3 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; A3 çš„ç±»å‹æ˜¯ string | number</code></pre><p>è¯¥ä¾‹ä¸­ï¼Œextends çš„å‰å‚ä¸º Tï¼ŒT æ˜¯ä¸€ä¸ªæ³›å‹å‚æ•°ã€‚åœ¨ A3 çš„å®šä¹‰ä¸­ï¼Œç»™ T ä¼ å…¥çš„æ˜¯â€™xâ€™å’Œâ€™yâ€™çš„è”åˆç±»å‹â€™xâ€™ | â€˜yâ€™ï¼Œæ»¡è¶³åˆ†é…å¾‹ï¼Œäºæ˜¯â€™xâ€™å’Œâ€™yâ€™è¢«æ‹†å¼€ï¼Œåˆ†åˆ«ä»£å…¥ P<T></p><pre class="line-numbers language-none"><code class="language-none">P&lt;&#39;x&#39; | &#39;y&#39;&gt; &#x3D;&gt; P&lt;&#39;x&#39;&gt; | P&lt;&#39;y&#39;&gt;&#39;x&#39;ä»£å…¥å¾—åˆ°&#39;x&#39; extends &#39;x&#39; ? string : number &#x3D;&gt; string&#39;y&#39;ä»£å…¥å¾—åˆ°&#39;y&#39; extends &#39;x&#39; ? string : number &#x3D;&gt; numberç„¶åå°†æ¯ä¸€é¡¹ä»£å…¥å¾—åˆ°çš„ç»“æœè”åˆèµ·æ¥ï¼Œå¾—åˆ° string | number</code></pre><p>æ€»ä¹‹ï¼Œæ»¡è¶³ä¸¤ä¸ªè¦ç‚¹å³å¯é€‚ç”¨åˆ†é…å¾‹ï¼šç¬¬ä¸€ï¼Œå‚æ•°æ˜¯æ³›å‹ç±»å‹ï¼Œç¬¬äºŒï¼Œä»£å…¥å‚æ•°çš„æ˜¯è”åˆç±»å‹</p><p>ç‰¹æ®Šçš„ never</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; never æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹type A1 &#x3D; never extends &quot;x&quot; ? string : number; &#x2F;&#x2F; stringtype P&lt;T&gt; &#x3D; T extends &quot;x&quot; ? string : number;type A2 &#x3D; P&lt;never&gt;; &#x2F;&#x2F; never</code></pre><p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒA2 å’Œ A1 çš„ç»“æœç«Ÿç„¶ä¸ä¸€æ ·ï¼Œçœ‹èµ·æ¥ never å¹¶ä¸æ˜¯ä¸€ä¸ªè”åˆç±»å‹ï¼Œæ‰€ä»¥ç›´æ¥ä»£å…¥æ¡ä»¶ç±»å‹çš„å®šä¹‰å³å¯ï¼Œè·å–çš„ç»“æœåº”è¯¥å’Œ A1 ä¸€ç›´æ‰å¯¹å•Šï¼Ÿ</p><p>å®é™…ä¸Šï¼Œè¿™é‡Œè¿˜æ˜¯æ¡ä»¶åˆ†é…ç±»å‹åœ¨èµ·ä½œç”¨ã€‚never è¢«è®¤ä¸ºæ˜¯ç©ºçš„è”åˆç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰è”åˆé¡¹çš„è”åˆç±»å‹ï¼Œæ‰€ä»¥è¿˜æ˜¯æ»¡è¶³ä¸Šé¢çš„åˆ†é…å¾‹ï¼Œç„¶è€Œå› ä¸ºæ²¡æœ‰è”åˆé¡¹å¯ä»¥åˆ†é…ï¼Œæ‰€ä»¥ P<T>çš„è¡¨è¾¾å¼å…¶å®æ ¹æœ¬å°±æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€ä»¥ A2 çš„å®šä¹‰ä¹Ÿå°±ç±»ä¼¼äºæ°¸è¿œæ²¡æœ‰è¿”å›çš„å‡½æ•°ä¸€æ ·ï¼Œæ˜¯ never ç±»å‹çš„ã€‚</p><p>é˜²æ­¢æ¡ä»¶åˆ¤æ–­ä¸­çš„åˆ†é…</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type P&lt;T&gt; &#x3D; [T] extends [&quot;x&quot;] ? string : number;type A1 &#x3D; P&lt;&quot;x&quot; | &quot;y&quot;&gt;; &#x2F;&#x2F; numbertype A2 &#x3D; P&lt;never&gt;; &#x2F;&#x2F; string</code></pre><p>åœ¨æ¡ä»¶åˆ¤æ–­ç±»å‹çš„å®šä¹‰ä¸­ï¼Œå°†æ³›å‹å‚æ•°ä½¿ç”¨[]æ‹¬èµ·æ¥ï¼Œå³å¯é˜»æ–­æ¡ä»¶åˆ¤æ–­ç±»å‹çš„åˆ†é…ï¼Œæ­¤æ—¶ï¼Œä¼ å…¥å‚æ•° T çš„ç±»å‹å°†è¢«å½“åšä¸€ä¸ªæ•´ä½“ï¼Œä¸å†åˆ†é…ã€‚</p><hr/><h2 id="åŸç†-æ³¨æ„"><a href="#åŸç†-æ³¨æ„" class="headerlink" title="åŸç†(æ³¨æ„)"></a>åŸç†(æ³¨æ„)</h2><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>éœ€å‰ç½®å­¦ä¹  extends å…³é”®å­—</p></div><ul><li>æºç å¾ˆç®€å•ï¼Œåˆ¤æ–­è”åˆç±»å‹ T æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™è”åˆç±»å‹ Uï¼Œæ˜¯åˆ™è¿”å› neverï¼Œå¦åˆ™è¿”å› T</li><li>never æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ï¼Œåœ¨è¿™é‡Œå¯ä»¥è¡¨ç¤ºä¸ºç©ºçš„è”åˆç±»å‹ï¼Œåœ¨äºä¸å…¶ä»–ç±»å‹çš„è”åˆåï¼Œç»“æœä¸ºå…¶ä»–ç±»å‹ã€‚</li><li>æ²¡æœ‰éå†ï¼Œæ€ä¹ˆä¹Ÿèƒ½å®ç°å‘¢? <code>è¿™é‡Œè¿˜æ¶‰åŠåˆ°extendsæ¡ä»¶ç±»å‹çš„ç‰¹æ®Šæƒ…å†µï¼Œextendsçš„å‰å‚Tå¦‚æœæ˜¯ä¸€ä¸ªæ³›å‹å‚æ•°ã€‚å¯¹äºä½¿ç”¨extendså…³é”®å­—çš„æ¡ä»¶ç±»å‹ï¼ˆå³ä¸Šé¢çš„ä¸‰å…ƒè¡¨è¾¾å¼ç±»å‹ï¼‰ï¼Œå¦‚æœextendså‰é¢çš„å‚æ•°æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå½“ä¼ å…¥è¯¥å‚æ•°çš„æ˜¯è”åˆç±»å‹ï¼Œä¸¤ä¸ªç±»å‹ä¼šæˆä¸ºåˆ†é…æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰ã€‚åˆ†é…æ¡ä»¶ç±»å‹æ˜¯æŒ‡ï¼Œå°†è”åˆç±»å‹çš„è”åˆé¡¹æ‹†æˆå•é¡¹ï¼Œåˆ†åˆ«ä»£å…¥æ¡ä»¶ç±»å‹ï¼Œç„¶åå°†æ¯ä¸ªå•é¡¹ä»£å…¥å¾—åˆ°çš„ç»“æœå†è”åˆèµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ¤æ–­ç»“æœã€‚</code></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Exclude&lt;T, U&gt; &#x3D; T extends U ? never : T;</code></pre><h2 id="Extract-lt-Type-Union-gt"><a href="#Extract-lt-Type-Union-gt" class="headerlink" title="Extract&lt;Type, Union&gt;"></a>Extract&lt;Type, Union&gt;</h2><p>Released:2.8</p><p>Constructs a type by extracting from Type all union members that are assignable to Union.<br><code>ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œå®ƒæ˜¯ä»Typeç±»å‹é‡Œé¢æå–äº†æ‰€æœ‰å¯ä»¥èµ‹ç»™Unionçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampletype T0 &#x3D; Extract&lt;&quot;a&quot; | &quot;b&quot; | &quot;c&quot;, &quot;a&quot; | &quot;f&quot;&gt;;&#x2F;&#x2F; type T0 &#x3D; &quot;a&quot;;type T1 &#x3D; Extract&lt;string | number | (() &#x3D;&gt; void), Function&gt;;&#x2F;&#x2F; type T1 &#x3D; () &#x3D;&gt; void;</code></pre><h2 id="åŸç†-æ³¨æ„-1"><a href="#åŸç†-æ³¨æ„-1" class="headerlink" title="åŸç†(æ³¨æ„)"></a>åŸç†(æ³¨æ„)</h2><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p><p>éœ€å‰ç½®å­¦ä¹  extends å…³é”®å­—</p></p></div><p>åŸç†ï¼šä¸ Exclude ç›¸åï¼Œåˆ¤æ–­è”åˆç±»å‹ T æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™è”åˆç±»å‹ Uï¼Œæ˜¯åˆ™è¿”å› Tï¼Œå¦åˆ™è¿”å› neverã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Extract&lt;T, U&gt; &#x3D; T extends U ? T : never;</code></pre><h2 id="NonNullable"><a href="#NonNullable" class="headerlink" title="NonNullable"></a>NonNullable<Type></h2><p>Released:2.8</p><p>Constructs a type by excluding null and undefined from Type.<br><code>ç”¨äºæ„é€ ä¸€ä¸ªç±»å‹ï¼Œè¿™ä¸ªç±»å‹ä»Typeä¸­æ’é™¤äº†æ‰€æœ‰çš„nullã€undefinedçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampletype T0 &#x3D; NonNullable&lt;string | number | undefined&gt;;&#x2F;&#x2F; type T0 &#x3D; string | number;type T1 &#x3D; NonNullable&lt;string[] | null | undefined&gt;;&#x2F;&#x2F; type T1 &#x3D; string[];</code></pre><h2 id="åŸç†-6"><a href="#åŸç†-6" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>åˆ¤æ–­ T æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™ null æˆ–è€… undefined ç±»å‹ï¼Œæ˜¯åˆ™è¿”å› neverï¼Œå¦åˆ™è¿”å› Tï¼Œå¦‚æœè¿™æ®µçœ‹ä¸æ˜ç™½çš„å¯ä»¥å†çœ‹ä¸‹ Exclude é‚£æ®µå…³äº extends çš„è¡¥å……è¯´æ˜ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type NonNullable&lt;T&gt; &#x3D; T extends null | undefined ? never : T;</code></pre><h2 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters<Type></h2><p>Released:3.1</p><p>Constructs a tuple type from the types used in the parameters of a function type Type.<br><code>ç”¨äºæ ¹æ®æ‰€æœ‰Typeä¸­å‡½æ•°ç±»å‹çš„å‚æ•°æ„é€ ä¸€ä¸ªå…ƒç¥–ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampledeclare function f1(arg: &#123; a: number; b: string &#125;): void;type T0 &#x3D; Parameters&lt;() &#x3D;&gt; string&gt;;&#x2F;&#x2F; type T0 &#x3D; []type T1 &#x3D; Parameters&lt;(s: string) &#x3D;&gt; void&gt;;&#x2F;&#x2F; type T1 &#x3D; [s: string]type T2 &#x3D; Parameters&lt;&lt;T&gt;(arg: T) &#x3D;&gt; T&gt;;&#x2F;&#x2F; type T2 &#x3D; [arg: unknown]type T3 &#x3D; Parameters&lt;typeof f1&gt;;&#x2F;&#x2F; type T3 &#x3D; [arg: &#123;&#x2F;&#x2F;   a: number;&#x2F;&#x2F;   b: string;&#x2F;&#x2F; &#125;]type T4 &#x3D; Parameters&lt;any&gt;;&#x2F;&#x2F; type T4 &#x3D; unknown[]type T5 &#x3D; Parameters&lt;never&gt;;&#x2F;&#x2F; type T5 &#x3D; nevertype T6 &#x3D; Parameters&lt;string&gt;;&#x2F;&#x2F; Type &#39;string&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; type T6 &#x3D; nevertype T7 &#x3D; Parameters&lt;Function&gt;;&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;(...args: any): any&#39;.type T7 &#x3D; never;</code></pre><h2 id="åŸç†ï¼š"><a href="#åŸç†ï¼š" class="headerlink" title="åŸç†ï¼š"></a>åŸç†ï¼š</h2><ul><li><code>Parameters</code> é¦–å…ˆçº¦æŸå‚æ•° <code>T </code>å¿…é¡»æ˜¯ä¸ªå‡½æ•°ç±»å‹</li><li>åˆ¤æ–­ <code>T</code> æ˜¯å¦æ˜¯å‡½æ•°ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™ä½¿ç”¨ <code>infer P</code> æš‚æ—¶å­˜ä¸€ä¸‹å‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œç›´æ¥ç”¨ P å³å¯å¾—åˆ°è¿™ä¸ªç±»å‹å¹¶è¿”å›ï¼Œå¦åˆ™å°±è¿”å› <code>never</code></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Parameters&lt;T extends (...args: any) &#x3D;&gt; any&gt; &#x3D; T extends (  ...args: infer P) &#x3D;&gt; any  ? P  : never;</code></pre><p>è¿™é‡Œç”¨åˆ°äº†<code>infer</code>ï¼Œ<code>infer P</code>æ ‡è®°ä¸€ä¸ªæ³›å‹ï¼Œè¡¨ç¤ºè¿™ä¸ªæ³›å‹æ˜¯ä¸€ä¸ªå¾…æ¨æ–­çš„ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><h2 id="ConstructorParameters"><a href="#ConstructorParameters" class="headerlink" title="ConstructorParameters"></a>ConstructorParameters<Type></h2><p><code>æ„é€ å‚æ•°ç±»å‹</code><br>Released:3.1</p><p>Constructs a tuple or array type from the types of a constructor function type. It produces a tuple type with all the parameter types (or the type never if Type is not a function).<br><code>æ„é€ ä¸€ä¸ªä»æ„é€ å‡½æ•°ç±»å‹Typeä¸­æå–çš„å…ƒç»„æˆ–æ•°ç»„ç±»å‹ã€‚å¦‚æœTypeä¸æ˜¯å‡½æ•°ï¼Œåˆ™ç”Ÿæˆneverç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampletype T0 &#x3D; ConstructorParameters&lt;ErrorConstructor&gt;;&#x2F;&#x2F; type T0 &#x3D; [message?: string]type T1 &#x3D; ConstructorParameters&lt;FunctionConstructor&gt;;&#x2F;&#x2F; type T1 &#x3D; string[]type T2 &#x3D; ConstructorParameters&lt;RegExpConstructor&gt;;&#x2F;&#x2F; type T2 &#x3D; [pattern: string | RegExp, flags?: string]type T3 &#x3D; ConstructorParameters&lt;any&gt;;&#x2F;&#x2F; type T3 &#x3D; unknown[]type T4 &#x3D; ConstructorParameters&lt;Function&gt;;&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;abstract new (...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;new (...args: any): any&#39;.&#x2F;&#x2F; type T4 &#x3D; never</code></pre><h2 id="ReturnType"><a href="#ReturnType" class="headerlink" title="ReturnType"></a>ReturnType<Type></h2><p>Released:2.8</p><p>Constructs a type consisting of the return type of function Type.<br><code>ç”¨äºæ„é€ ä¸€ä¸ªå«æœ‰Typeå‡½æ•°çš„è¿”å›å€¼çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampledeclare function f1(): &#123; a: number; b: string &#125;;type T0 &#x3D; ReturnType&lt;() &#x3D;&gt; string&gt;;&#x2F;&#x2F; type T0 &#x3D; stringtype T1 &#x3D; ReturnType&lt;(s: string) &#x3D;&gt; void&gt;;&#x2F;&#x2F; type T1 &#x3D; voidtype T2 &#x3D; ReturnType&lt;&lt;T&gt;() &#x3D;&gt; T&gt;;&#x2F;&#x2F; type T2 &#x3D; unknowntype T3 &#x3D; ReturnType&lt;&lt;T extends U, U extends number[]&gt;() &#x3D;&gt; T&gt;;&#x2F;&#x2F; type T3 &#x3D; number[]type T4 &#x3D; ReturnType&lt;typeof f1&gt;;&#x2F;&#x2F; type T4 &#x3D; &#123;&#x2F;&#x2F; a: number;&#x2F;&#x2F; b: string;&#x2F;&#x2F; &#125;type T5 &#x3D; ReturnType&lt;any&gt;;&#x2F;&#x2F; type T5 &#x3D; anytype T6 &#x3D; ReturnType&lt;never&gt;;&#x2F;&#x2F; type T6 &#x3D; nevertype T7 &#x3D; ReturnType&lt;string&gt;;&#x2F;&#x2F; Type &#39;string&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; type T7 &#x3D; anytype T8 &#x3D; ReturnType&lt;Function&gt;;&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;(...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;(...args: any): any&#39;.&#x2F;&#x2F; type T8 &#x3D; any</code></pre><h2 id="åŸç†-7"><a href="#åŸç†-7" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ä¸ Parameters ç±»ä¼¼</p><p>ReturnType é¦–å…ˆçº¦æŸå‚æ•° T å¿…é¡»æ˜¯ä¸ªå‡½æ•°ç±»å‹<br>åˆ¤æ–­ T æ˜¯å¦æ˜¯å‡½æ•°ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™ä½¿ç”¨ infer R æš‚æ—¶å­˜ä¸€ä¸‹å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼Œåé¢çš„è¯­å¥ç›´æ¥ç”¨ R å³å¯å¾—åˆ°è¿™ä¸ªç±»å‹å¹¶è¿”å›ï¼Œå¦åˆ™å°±è¿”å› any</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type ReturnType&lt;T extends (...args: any) &#x3D;&gt; any&gt; &#x3D; T extends (  ...args: any) &#x3D;&gt; infer R  ? R  : any;</code></pre><h2 id="InstanceType"><a href="#InstanceType" class="headerlink" title="InstanceType"></a>InstanceType<Type></h2><p>Released:2.8</p><p>Constructs a type consisting of the instance type of a constructor function in Type.<br><code>è¿”å›æ„é€ å‡½æ•°ç±»å‹Tçš„å®ä¾‹ç±»å‹</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampleclass C &#123;  x &#x3D; 0;  y &#x3D; 0;&#125;type T0 &#x3D; InstanceType&lt;typeof C&gt;;&#x2F;&#x2F; type T0 &#x3D; Ctype T1 &#x3D; InstanceType&lt;any&gt;;&#x2F;&#x2F; type T1 &#x3D; anytype T2 &#x3D; InstanceType&lt;never&gt;;&#x2F;&#x2F; type T2 &#x3D; nevertype T3 &#x3D; InstanceType&lt;string&gt;;&#x2F;&#x2F; Type &#39;string&#39; does not satisfy the constraint &#39;abstract new (...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; type T3 &#x3D; anytype T4 &#x3D; InstanceType&lt;Function&gt;;&#x2F;&#x2F; Type &#39;Function&#39; does not satisfy the constraint &#39;abstract new (...args: any) &#x3D;&gt; any&#39;.&#x2F;&#x2F; Type &#39;Function&#39; provides no match for the signature &#39;new (...args: any): any&#39;.&#x2F;&#x2F; type T4 &#x3D; any</code></pre><h2 id="åŸç†-8"><a href="#åŸç†-8" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><code>type InstanceType&lt;T extends abstract new (...args: any) =&gt; any&gt; = T extends abstract new (...args: any) =&gt; infer R ? R : any</code><br>ä¸ResultType ç±»ä¼¼<br><code>type ReturnType&lt;T extends (...args: any) =&gt; any&gt; = T extends (...args: any) =&gt; infer R ? R : any;</code></p><h2 id="ThisParameterType"><a href="#ThisParameterType" class="headerlink" title="ThisParameterType"></a>ThisParameterType<Type></h2><p>Released:3.3</p><p>Extracts the type of the this parameter for a function type, or unknown if the function type has no this parameter.<br><code>ç”¨äºæå–ä¸€ä¸ªå‡½æ•°ç±»å‹Typeçš„this (opens new window)å‚æ•°ç±»å‹ï¼Œè¿”å›unknown (opens new window)å¦‚æœè¿™ä¸ªå‡½æ•°ç±»å‹æ²¡æœ‰thiså‚æ•°ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Examplefunction toHex(this: Number) &#123;  return this.toString(16);&#125;function numberToString(n: ThisParameterType&lt;typeof toHex&gt;) &#123;  return toHex.apply(n);&#125;</code></pre><h2 id="OmitThisParameter"><a href="#OmitThisParameter" class="headerlink" title="OmitThisParameter"></a>OmitThisParameter<Type></h2><p>Released:3.3</p><p>Removes the this parameter from Type. If Type has no explicitly declared this parameter, the result is simply Type. Otherwise, a new function type with no this parameter is created from Type. Generics are erased and only the last overload signature is propagated into the new function type.<br><code>ç”¨äºç§»é™¤ä¸€ä¸ªå‡½æ•°ç±»å‹Typeçš„this (opens new window)å‚æ•°ç±»å‹ã€‚å¦‚æœTypeæ²¡æœ‰æ˜ç¡®çš„å£°æ˜this ç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿”å›çš„ç»“æœå°±æ˜¯Typeï¼Œä¸ç„¶çš„è¯ï¼Œå°±è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ç±»å‹ï¼ŒåŸºäºTypeï¼Œä½†ä¸å†æœ‰thiså‚æ•°ã€‚èŒƒå‹ä¼šè¢«æŠ¹å»ï¼Œåªæœ‰æœ€åé‡è½½çš„ç­¾åè¢«ä¼ æ’­è¿›äº†è¿”å›çš„æ–°çš„å‡½æ•°ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Examplefunction toHex(this: Number) &#123;  return this.toString(16);&#125;const fiveToHex: OmitThisParameter&lt;typeof toHex&gt; &#x3D; toHex.bind(5);console.log(fiveToHex());</code></pre><h2 id="ThisType"><a href="#ThisType" class="headerlink" title="ThisType"></a>ThisType<Type></h2><p>Released:2.3</p><p>This utility does not return a transformed type. Instead, it serves as a marker for a contextual this type. Note that the noImplicitThis flag must be enabled to use this utility.<br><code>è¿™ä¸ªç±»å‹ä¸è¿”å›ä¸€ä¸ªè½¬æ¢è¿‡çš„ç±»å‹ï¼Œå®ƒè¢«ç”¨ä½œæ ‡è®°ä¸€ä¸ªä¸Šä¸‹æ–‡çš„thisç±»å‹ã€‚æ³¨æ„ä¸‹å¦‚æœæƒ³ä½¿ç”¨è¿™ä¸ªå·¥å…·ç±»å‹ï¼ŒnoImplicitThis (opens new window)çš„flagå¿…é¡»å¯ç”¨ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Exampletype ObjectDescriptor&lt;D, M&gt; &#x3D; &#123;  data?: D;  methods?: M &amp; ThisType&lt;D &amp; M&gt;; &#x2F;&#x2F; Type of &#39;this&#39; in methods is D &amp; M&#125;;function makeObject&lt;D, M&gt;(desc: ObjectDescriptor&lt;D, M&gt;): D &amp; M &#123;  let data: object &#x3D; desc.data || &#123;&#125;;  let methods: object &#x3D; desc.methods || &#123;&#125;;  return &#123; ...data, ...methods &#125; as D &amp; M;&#125;let obj &#x3D; makeObject(&#123;  data: &#123; x: 0, y: 0 &#125;,  methods: &#123;    moveBy(dx: number, dy: number) &#123;      this.x +&#x3D; dx; &#x2F;&#x2F; Strongly typed this      this.y +&#x3D; dy; &#x2F;&#x2F; Strongly typed this    &#125;,  &#125;,&#125;);obj.x &#x3D; 10;obj.y &#x3D; 20;obj.moveBy(5, 5);</code></pre><p>In the example above, the methods object in the argument to makeObject has a contextual type that includes ThisType&lt;D &amp; M&gt; and therefore the type of this in methods within the methods object is { x: number, y: number } &amp; { moveBy(dx: number, dy: number): number }. Notice how the type of the methods property simultaneously is an inference target and a source for the this type in methods.<br><code>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒmakeObjectçš„å‚æ•°ä¸­çš„methodså¯¹è±¡åŒ…å«äº†ä¸€ä¸ªä¸Šä¸‹æ–‡ç±»å‹ï¼Œè¯¥ç±»å‹åŒ…å«äº†ThisType&lt;D &amp; M&gt;ï¼Œå› æ­¤methodså¯¹è±¡ä¸­çš„thisç±»å‹æ˜¯&#123; x: number, y: number &#125; &amp; &#123; moveBy(dx: number, dy: number): number &#125;ã€‚è¯·æ³¨æ„ï¼Œmethodså±æ€§çš„ç±»å‹åŒæ—¶æ˜¯ä¸€ä¸ªæ¨æ–­ç›®æ ‡å’Œä¸€ä¸ªmethodså¯¹è±¡ä¸­çš„thisç±»å‹çš„æºã€‚</code><br>The ThisType<T> marker interface is simply an empty interface declared in lib.d.ts. Beyond being recognized in the contextual type of an object literal, the interface acts like any empty interface.<br><code>ThisType&lt;T&gt;æ ‡è®°æ¥å£æ˜¯åœ¨lib.d.tsä¸­å£°æ˜çš„ç©ºæ¥å£ã€‚å®ƒåªæ˜¯åœ¨å¯¹è±¡å­—é¢é‡çš„ä¸Šä¸‹æ–‡ç±»å‹ä¸­è¢«è¯†åˆ«è€Œå·²ï¼Œè¯¥æ¥å£çš„è¡Œä¸ºä¸ç©ºæ¥å£ä¸€æ ·ã€‚</code></p><h2 id="Intrinsic-String-Manipulation-Types"><a href="#Intrinsic-String-Manipulation-Types" class="headerlink" title="Intrinsic String Manipulation Types"></a>Intrinsic String Manipulation Types</h2><p><code>å†…éƒ¨å­—ç¬¦ä¸²æ“ä½œç±»å‹</code><br>Uppercase<StringType><br>Lowercase<StringType><br>Capitalize<StringType><br>Uncapitalize<StringType></p><p>To help with string manipulation around template string literals, TypeScript includes a set of types which can be used in string manipulation within the type system. You can find those in the Template Literal Types documentation.<br><code>ä¸ºäº†å¸®åŠ©æ¨¡æ¿å­—ç¬¦ä¸²æ“ä½œï¼ŒTypeScriptåŒ…å«ä¸€ç»„å¯ä»¥åœ¨å­—ç¬¦ä¸²æ“ä½œä¸­ä½¿ç”¨çš„ç±»å‹ã€‚ä½ å¯ä»¥åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹æ–‡æ¡£ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚</code></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.typescriptlang.org/docs/handbook/utility-types.html">typescript handbook utility-types</a><br><a href="https://ts.yayujs.com/reference/UtilityTypes.html#intrinsic-string-manipulation-types">å·¥å…·ç±»å‹</a><br><a href="https://blog.csdn.net/qq_34998786/article/details/120300361">Typescript ä¸­çš„ extends å…³é”®å­—</a>Exclude ä¸ Extract å‰ç½®å­¦ä¹ é¡¹<br><a href="https://www.typescriptlang.org/docs/handbook/2/classes.html#extends-clauses">Typescript Classes extends-clauses</a><br><a href="https://blog.csdn.net/qq_32438227/article/details/125058423">å½»åº•ææ‡‚ typescript å·¥å…·ç±»å‹åŠå…¶åŸç†</a> è¯¥æ–‡æœ‰é”™è¯¯å†…å®¹ï¼Œè¦æ³¨æ„å“¦<br><a href="https://juejin.cn/post/6844904066485583885">TypeScript çš„ extends æ¡ä»¶ç±»å‹</a></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.Typescriptæ‰‹å†Œ æ¨¡å—</title>
      <link href="//post/2022-06-08ts-modules.html"/>
      <url>//post/2022-06-08ts-modules.html</url>
      
        <content type="html"><![CDATA[<p>JavaScript has a long history of different ways to handle modularizing code. TypeScript having been around since 2012, has implemented support for a lot of these formats, but over time the community and the JavaScript specification has converged on a format called ES Modules (or ES6 modules). You might know it as the import&#x2F;export syntax.<br><code>JavaScript æœ‰å¾ˆé•¿çš„å†å²ï¼Œä¸åŒçš„æ–¹å¼æ¥å¤„ç†ä»£ç çš„æ¨¡å—åŒ–ã€‚TypeScript ä» 2012 å¹´å¼€å§‹ï¼Œå°±æ”¯æŒäº†å¤§é‡çš„æ¨¡å—åŒ–æ ¼å¼ï¼Œä½†æ˜¯ï¼Œåœ¨è¿‡å»çš„æ—¶é—´ï¼Œç¤¾åŒºå’Œ JavaScript è§„èŒƒä¸€è‡´åœ°èšåˆäº†ä¸€ä¸ªæ¨¡å—åŒ–æ ¼å¼ï¼Œå«åš ES Modulesï¼ˆæˆ– ES6 æ¨¡å—ï¼‰ã€‚ä½ å¯èƒ½ä¼šçŸ¥é“å®ƒå«åš import/export è¯­æ³•ã€‚</code></p><p>ES Modules was added to the JavaScript spec in 2015, and by 2020 had broad support in most web browsers and JavaScript runtimes.<br><code>ES Modules åœ¨ 2015 å¹´æ·»åŠ åˆ° JavaScript è§„èŒƒï¼Œ2020 å¹´å·²ç»æœ‰å¹¿æ³›çš„æ”¯æŒåœ¨å¤§éƒ¨åˆ†çš„ web æµè§ˆå™¨å’Œ JavaScript è¿è¡Œæ—¶ã€‚</code><br>For focus, the handbook will cover both ES Modules and its popular pre-cursor CommonJS module.exports &#x3D; syntax, and you can find information about the other module patterns in the reference section under Modules.<br><code>ä¸ºäº†è·å¾—ç„¦ç‚¹ï¼Œæœ¬æ‰‹å†Œå°†ä»‹ç» ES Modules å’Œå…¶å¸¸ç”¨çš„å…ˆè¡Œæ¨¡å— CommonJS module.exports = åŒä¹‰è¯ï¼Œå¹¶ä¸”ä½ å¯ä»¥åœ¨ Modules ä¸‹çš„å‚è€ƒèŠ‚ä¸­æ‰¾åˆ°å…¶ä»–æ¨¡å—æ¨¡å¼çš„ä¿¡æ¯ã€‚</code></p><h2 id="How-JavaScript-Modules-are-Defined"><a href="#How-JavaScript-Modules-are-Defined" class="headerlink" title="How JavaScript Modules are Defined"></a>How JavaScript Modules are Defined</h2><p>In TypeScript, just as in ECMAScript 2015, any file containing a top-level import or export is considered a module.<br><code>åœ¨ TypeScript ä¸­ï¼Œåªè¦æ–‡ä»¶åŒ…å«ä¸€ä¸ªé¡¶å±‚çš„ import æˆ– export å°±è¢«è§†ä¸ºä¸€ä¸ªæ¨¡å—ã€‚</code><br>Conversely, a file without any top-level import or export declarations is treated as a script whose contents are available in the global scope (and therefore to modules as well).<br><code>åä¹‹ï¼Œä¸€ä¸ªæ²¡æœ‰é¡¶å±‚çš„ import æˆ– export å£°æ˜çš„æ–‡ä»¶å°±è¢«è§†ä¸ºä¸€ä¸ªè„šæœ¬ï¼Œå…¶å†…å®¹å¯ä»¥åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ä½¿ç”¨ï¼ˆå¹¶ä¸”ä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡å—ä½¿ç”¨ï¼‰ã€‚</code><br>Modules are executed within their own scope, not in the global scope. This means that variables, functions, classes, etc. declared in a module are not visible outside the module unless they are explicitly exported using one of the export forms. Conversely, to consume a variable, function, class, interface, etc. exported from a different module, it has to be imported using one of the import forms.<br><code>æ¨¡å—æ˜¯åœ¨è‡ªå·±çš„ä½œç”¨åŸŸä¸­æ‰§è¡Œçš„ï¼Œä¸æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­æ‰§è¡Œçš„ã€‚è¿™æ„å‘³ç€åœ¨æ¨¡å—ä¸­å£°æ˜çš„å˜é‡ï¼Œå‡½æ•°ï¼Œç±»ï¼Œæ¥å£ç­‰ç­‰ï¼Œåªæœ‰åœ¨æ˜¾å¼çš„ä½¿ç”¨ export å£°æ˜çš„æ—¶å€™æ‰èƒ½åœ¨æ¨¡å—å¤–è¢«è®¿é—®ã€‚åä¹‹ï¼Œè¦ä»å…¶ä»–æ¨¡å—ä¸­æ¶ˆè´¹ä¸€ä¸ªå˜é‡ï¼Œå‡½æ•°ï¼Œç±»ï¼Œæ¥å£ç­‰ç­‰ï¼Œå¿…é¡»ä½¿ç”¨ import å£°æ˜æ¥å¯¼å…¥ã€‚</code></p><h2 id="Non-modules"><a href="#Non-modules" class="headerlink" title="Non-modules"></a>Non-modules</h2><p><code>éæ¨¡å—</code><br>Before we start, itâ€™s important to understand what TypeScript considers a module. The JavaScript specification declares that any JavaScript files without an export or top-level await should be considered a script and not a module.<br><code>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½ TypeScript è®¤ä¸ºä»€ä¹ˆæ˜¯æ¨¡å—ã€‚JavaScript è§„èŒƒå®šä¹‰äº†ä»»ä½•æ²¡æœ‰ export æˆ– top-level await çš„ JavaScript æ–‡ä»¶éƒ½è¢«è§†ä¸ºè„šæœ¬è€Œä¸æ˜¯æ¨¡å—ã€‚</code><br>Inside a script file variables and types are declared to be in the shared global scope, and itâ€™s assumed that youâ€™ll either use the outFile compiler option to join multiple input files into one output file, or use multiple <script> tags in your HTML to load these files (in the correct order!).<br><code>åœ¨è„šæœ¬æ–‡ä»¶ä¸­ï¼Œå˜é‡å’Œç±»å‹è¢«å£°æ˜ä¸ºå…±äº«çš„å…¨å±€ä½œç”¨åŸŸï¼Œå¹¶ä¸”æˆ‘ä»¬å‡è®¾ä½ ä¼šä½¿ç”¨ outFile ç¼–è¯‘é€‰é¡¹å°†å¤šä¸ªè¾“å…¥æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨å¤šä¸ª &lt;script&gt; æ ‡ç­¾åœ¨ä½ çš„ HTML ä¸­åŠ è½½è¿™äº›æ–‡ä»¶ï¼ˆæŒ‰ç…§æ­£ç¡®çš„é¡ºåºï¼‰ã€‚</code><br>If you have a file that doesnâ€™t currently have any imports or exports, but you want to be treated as a module, add the line:<br><code>å¦‚æœä½ æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒç›®å‰æ²¡æœ‰ä»»ä½• import æˆ– export å£°æ˜ï¼Œä½†æ˜¯ä½ æƒ³è¢«è§†ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œé‚£ä¹ˆæ·»åŠ è¿™ä¸€è¡Œï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export &#123;&#125;;</code></pre><p>which will change the file to be a module exporting nothing. This syntax works regardless of your module target.<br><code>è¿™ç§è¯­æ³•å¯¹äºä½ çš„æ¨¡å—ç›®æ ‡æ— è®ºå¦‚ä½•éƒ½æ˜¯å¯è¡Œçš„ã€‚</code></p><h2 id="Modules-in-TypeScript"><a href="#Modules-in-TypeScript" class="headerlink" title="Modules in TypeScript"></a>Modules in TypeScript</h2><p><code>TypeScript ä¸­çš„æ¨¡å—</code><br>Additional Reading:<br><code>é™„åŠ é˜…è¯»ï¼š</code><br>Impatient JS (Modules)<br><code>ä¸çŸ¥é“æ¨¡å—çš„ TypeScript</code><br>MDN: JavaScript Modules<br><code>MDNï¼šJavaScript æ¨¡å—</code><br>There are three main things to consider when writing module-based code in TypeScript:<br><code>åœ¨ TypeScript ä¸­å†™æ¨¡å—åŸºç¡€çš„ä»£ç æ—¶ï¼Œè¦è€ƒè™‘ä¸‰ä¸ªä¸»è¦é—®é¢˜ï¼š</code><br>Syntax: What syntax do I want to use to import and export things?<br><code>è¯­æ³•ï¼šæˆ‘æƒ³è¦ä½¿ç”¨ä»€ä¹ˆè¯­æ³•æ¥å¯¼å…¥å’Œå¯¼å‡ºä¸œè¥¿ï¼Ÿ</code><br>Module Resolution: What is the relationship between module names (or paths) and files on disk?<br><code>æ¨¡å—è§£æï¼šæ¨¡å—åï¼ˆæˆ–è·¯å¾„ï¼‰å’Œç£ç›˜ä¸Šçš„æ–‡ä»¶ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ</code><br>Module Output Target: What should my emitted JavaScript module look like?<br><code>æ¨¡å—è¾“å‡ºç›®æ ‡ï¼šæˆ‘çš„è¾“å‡ºçš„ JavaScript æ¨¡å—åº”è¯¥æ€æ ·çœ‹ï¼Ÿ</code></p><h2 id="ES-Module-Syntax"><a href="#ES-Module-Syntax" class="headerlink" title="ES Module Syntax"></a>ES Module Syntax</h2><p><code>ES æ¨¡å—è¯­æ³•</code><br>A file can declare a main export via export default:<br><code>ä¸€ä¸ªæ–‡ä»¶å¯ä»¥é€šè¿‡ export default å£°æ˜ä¸€ä¸ªä¸»è¦çš„å¯¼å‡ºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: hello.tsexport default function helloWorld() &#123;  console.log(&quot;Hello, world!&quot;);&#125;</code></pre><p>This is then imported via:<br><code>è¿™æ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯¼å…¥çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import helloWorld from &quot;.&#x2F;hello.js&quot;;helloWorld();</code></pre><p>In addition to the default export, you can have more than one export of variables and functions via the export by omitting default:<br><code>é™¤äº†é»˜è®¤å¯¼å‡ºï¼Œä½ è¿˜å¯ä»¥æœ‰å¤šä¸ªå¯¼å‡ºçš„å˜é‡å’Œå‡½æ•°ï¼Œé€šè¿‡å°† default å»æ‰ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: maths.tsexport var pi &#x3D; 3.14;export let squareTwo &#x3D; 1.41;export const phi &#x3D; 1.61;export class RandomNumberGenerator &#123;&#125;export function absolute(num: number) &#123;if (num &lt; 0) return num \* -1;  return num;&#125;</code></pre><p>These can be used in another file via the import syntax:<br><code>è¿™äº›å¯ä»¥åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­é€šè¿‡å¯¼å…¥è¯­æ³•ä½¿ç”¨ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; pi, phi, absolute &#125; from &quot;.&#x2F;maths.js&quot;;console.log(pi);const absPhi &#x3D; absolute(phi);&#x2F;&#x2F; const absPhi: number;</code></pre><h2 id="Additional-Import-Syntax"><a href="#Additional-Import-Syntax" class="headerlink" title="Additional Import Syntax"></a>Additional Import Syntax</h2><p><code>é™„åŠ å¯¼å…¥è¯­æ³•</code><br>An import can be renamed using a format like import {old as new}:<br><code>ä¸€ä¸ªå¯¼å…¥å¯ä»¥é€šè¿‡è¿™æ ·çš„æ ¼å¼ï¼šimport &#123;old as new&#125;ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; pi as Ï€ &#125; from &quot;.&#x2F;maths.js&quot;;console.log(Ï€);&#x2F;&#x2F; (alias) var Ï€: number&#x2F;&#x2F; import Ï€</code></pre><p>You can mix and match the above syntax into a single import:<br><code>ä½ å¯ä»¥æ··åˆè¿™äº›è¯­æ³•åˆ°ä¸€ä¸ªå•ç‹¬çš„å¯¼å…¥ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: maths.tsexport const pi &#x3D; 3.14;export default class RandomNumberGenerator &#123;&#125;&#x2F;&#x2F; @filename: app.tsimport RandomNumberGenerator, &#123; pi as Ï€ &#125; from &quot;.&#x2F;maths.js&quot;;RandomNumberGenerator;&#x2F;&#x2F; (alias) class RandomNumberGenerator&#x2F;&#x2F; import RandomNumberGeneratorconsole.log(Ï€);&#x2F;&#x2F; (alias) const Ï€: 3.14&#x2F;&#x2F; import Ï€</code></pre><p>You can take all of the exported objects and put them into a single namespace using * as name:<br><code>ä½ å¯ä»¥å°†æ‰€æœ‰å¯¼å‡ºçš„å¯¹è±¡æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„å‘½åç©ºé—´ï¼Œä½¿ç”¨ \* as nameï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: app.tsimport \* as math from &quot;.&#x2F;maths.js&quot;;console.log(math.pi);const positivePhi &#x3D; math.absolute(math.phi);&#x2F;&#x2F; const positivePhi: number</code></pre><p>You can import a file and not include any variables into your current module via import "./file":<br><code>ä½ å¯ä»¥é€šè¿‡ import &quot;./file&quot; å¯¼å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸åŒ…å«ä»»ä½•å˜é‡åˆ°å½“å‰æ¨¡å—ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: app.tsimport &quot;.&#x2F;maths.js&quot;;console.log(&quot;3.14&quot;);</code></pre><p>In this case, the import does nothing. However, all of the code in maths.ts was evaluated, which could trigger side-effects which affect other objects.<br><code>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¼å…¥å¹¶æ²¡æœ‰ä»€ä¹ˆäº‹æƒ…ã€‚ä½†æ˜¯ï¼Œmaths.ts ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ä¼šè¢«è¯„ä¼°ï¼Œè¿™å¯èƒ½ä¼šè§¦å‘å…¶ä»–å¯¹è±¡çš„å‰¯ä½œç”¨ã€‚</code></p><h2 id="TypeScript-Specific-ES-Module-Syntax"><a href="#TypeScript-Specific-ES-Module-Syntax" class="headerlink" title="TypeScript Specific ES Module Syntax"></a>TypeScript Specific ES Module Syntax</h2><p><code>TypeScript ç‰¹å®šçš„ ES æ¨¡å—è¯­æ³•</code><br>Types can be exported and imported using the same syntax as JavaScript values:<br><code>ç±»å‹å¯ä»¥ä½¿ç”¨ç›¸åŒçš„è¯­æ³•æ¥å¯¼å‡ºå’Œå¯¼å…¥ JavaScript å€¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: animal.tsexport type Cat &#x3D; &#123; breed: string; yearOfBirth: number &#125;;export interface Dog &#123;  breeds: string[];  yearOfBirth: number;&#125;&#x2F;&#x2F; @filename: app.tsimport &#123; Cat, Dog &#125; from &quot;.&#x2F;animal.js&quot;;type Animals &#x3D; Cat | Dog;</code></pre><p>TypeScript has extended the import syntax with two concepts for declaring an import of a type:<br><code>TypeScript å·²ç»æ‰©å±•äº†å¯¼å…¥ç±»å‹çš„è¯­æ³•ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ¦‚å¿µæ¥å£°æ˜å¯¼å…¥ç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import type&#x2F;&#x2F; Which is an import statement which can only import types:&#x2F;&#x2F; åªèƒ½å¯¼å…¥ç±»å‹çš„å¯¼å…¥è¯­å¥ï¼š&#x2F;&#x2F; @filename: animal.tsexport type Cat &#x3D; &#123; breed: string; yearOfBirth: number &#125;;&#x2F;&#x2F; &#39;createCatName&#39; cannot be used as a value because it was imported using &#39;import type&#39;.&#x2F;&#x2F; &#39;createCatName&#39; ä¸èƒ½è¢«ç”¨ä½œå€¼ï¼Œå› ä¸ºå®ƒè¢«å¯¼å…¥ä½¿ç”¨äº† &#39;import type&#39;ã€‚export type Dog &#x3D; &#123; breeds: string[]; yearOfBirth: number &#125;;export const createCatName &#x3D; () &#x3D;&gt; &quot;fluffy&quot;;&#x2F;&#x2F; @filename: valid.tsimport type &#123; Cat, Dog &#125; from &quot;.&#x2F;animal.js&quot;;export type Animals &#x3D; Cat | Dog;&#x2F;&#x2F; @filename: app.tsimport type &#123; createCatName &#125; from &quot;.&#x2F;animal.js&quot;;const name &#x3D; createCatName();</code></pre><p>Inline type imports<br><code>å†…è”ç±»å‹å¯¼å…¥</code></p><p>TypeScript 4.5 also allows for individual imports to be prefixed with type to indicate that the imported reference is a type:<br><code>TypeScript 4.5 å¯ä»¥ä½¿ç”¨ type å‰ç¼€æ¥å£°æ˜å¯¼å…¥çš„å¼•ç”¨æ˜¯ä¸€ä¸ªç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: app.tsimport &#123; createCatName, type Cat, type Dog &#125; from &quot;.&#x2F;animal.js&quot;;export type Animals &#x3D; Cat | Dog;const name &#x3D; createCatName();</code></pre><p>Together these allow a non-TypeScript transpiler like Babel, swc or esbuild to know what imports can be safely removed.<br><code>è¿™äº›åŒæ—¶å…è®¸ä¸€ä¸ªé TypeScript ç¼–è¯‘å™¨ï¼Œå¦‚ Babelã€swc æˆ– esbuild çŸ¥é“å“ªäº›å¯¼å…¥å¯ä»¥å®‰å…¨åœ°ç§»é™¤ã€‚</code></p><h2 id="ES-Module-Syntax-with-CommonJS-Behavior"><a href="#ES-Module-Syntax-with-CommonJS-Behavior" class="headerlink" title="ES Module Syntax with CommonJS Behavior"></a>ES Module Syntax with CommonJS Behavior</h2><p><code>ES æ¨¡å—è¯­æ³•ä¸ CommonJS è¡Œä¸º</code><br>TypeScript has ES Module syntax which directly correlates to a CommonJS and AMD require. Imports using ES Module are for most cases the same as the require from those environments, but this syntax ensures you have a 1 to 1 match in your TypeScript file with the CommonJS output:<br><code>TypeScript æœ‰ ES æ¨¡å—è¯­æ³•ï¼Œå®ƒç›¸å¯¹äº CommonJS å’Œ AMD requireã€‚ä½¿ç”¨ ES Module çš„å¯¼å…¥æ˜¯ä¸ºäº†å¤§å¤šæ•°æƒ…å†µä¸‹ä¸è¿™äº›ç¯å¢ƒçš„ require ä¸€è‡´ï¼Œä½†è¿™ç§è¯­æ³•ç¡®ä¿äº†ä½ çš„ TypeScript æ–‡ä»¶ä¸ CommonJS è¾“å‡ºæœ‰ä¸€ä¸ª 1 åˆ° 1 çš„åŒ¹é…ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import fs &#x3D; require(&quot;fs&quot;);const code &#x3D; fs.readFileSync(&quot;hello.ts&quot;, &quot;utf8&quot;);</code></pre><p>You can learn more about this syntax in the modules reference page.<br><code>ä½ å¯ä»¥åœ¨æ¨¡å—å‚è€ƒé¡µé¢äº†è§£æ›´å¤šå…³äºè¿™ç§è¯­æ³•ã€‚</code></p><h2 id="CommonJS-Syntax"><a href="#CommonJS-Syntax" class="headerlink" title="CommonJS Syntax"></a>CommonJS Syntax</h2><p><code>CommonJS è¯­æ³•</code></p><p>CommonJS is the format which most modules on npm are delivered in. Even if you are writing using the ES Modules syntax above, having a brief understanding of how CommonJS syntax works will help you debug easier.<br><code>CommonJS æ˜¯ npm ä¸Šå¤§å¤šæ•°æ¨¡å—çš„æ ¼å¼ã€‚å³ä½¿ä½ æ­£åœ¨ä½¿ç”¨ä¸Šé¢çš„ ES æ¨¡å—è¯­æ³•ï¼Œä¹Ÿä¼šæœ‰ä¸€ä¸ªç®€å•çš„äº†è§£ CommonJS è¯­æ³•çš„æ–¹å¼å¸®åŠ©ä½ è°ƒè¯•æ›´å®¹æ˜“ã€‚</code></p><h2 id="Exporting"><a href="#Exporting" class="headerlink" title="Exporting"></a>Exporting</h2><p><code>å¯¼å‡º</code></p><p>Identifiers are exported via setting the exports property on a global called module.<br><code>æ ‡è¯†ç¬¦é€šè¿‡è®¾ç½® module.exports å±æ€§æ¥å¯¼å‡ºã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function absolute(num: number) &#123;    if (num &lt; 0) return num \* -1;    return num;&#125;module.exports &#x3D; &#123;  pi: 3.14,  squareTwo: 1.41,  phi: 1.61,  absolute,&#125;;</code></pre><p>Then these files can be imported via a require statement:<br><code>ç„¶åï¼Œè¿™äº›æ–‡ä»¶å¯ä»¥é€šè¿‡ require è¯­å¥æ¥å¯¼å…¥ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const maths &#x3D; require(&quot;maths&quot;);maths.pi;&#x2F;&#x2F; any;</code></pre><p>Or you can simplify a bit using the destructuring feature in JavaScript:<br><code>æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ JavaScript çš„è§£æ„ç‰¹æ€§æ¥ç®€åŒ–ä¸€äº›ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const &#123; squareTwo &#125; &#x3D; require(&quot;maths&quot;);squareTwo;&#x2F;&#x2F; const squareTwo: any;</code></pre><h2 id="CommonJS-and-ES-Modules-interop"><a href="#CommonJS-and-ES-Modules-interop" class="headerlink" title="CommonJS and ES Modules interop"></a>CommonJS and ES Modules interop</h2><p><code>CommonJS å’Œ ES æ¨¡å—çš„äº’æ“ä½œ</code></p><p>There is a mis-match in features between CommonJS and ES Modules regarding the distinction between a default import and a module namespace object import. TypeScript has a compiler flag to reduce the friction between the two different sets of constraints with esModuleInterop.<br><code>åœ¨ CommonJS å’Œ ES æ¨¡å—ä¹‹é—´å­˜åœ¨ä¸åŒ¹é…çš„ç‰¹æ€§ï¼Œå…³äºé»˜è®¤å¯¼å…¥å’Œæ¨¡å—å‘½åç©ºé—´å¯¹è±¡å¯¼å…¥çš„åŒºåˆ«ã€‚TypeScript æœ‰ä¸€ä¸ªç¼–è¯‘å™¨æ ‡å¿—æ¥å‡å°‘ CommonJS å’Œ ES æ¨¡å—ä¹‹é—´çš„æ‘©æ“¦ã€‚</code></p><h2 id="TypeScriptâ€™s-Module-Resolution-Options"><a href="#TypeScriptâ€™s-Module-Resolution-Options" class="headerlink" title="TypeScriptâ€™s Module Resolution Options"></a>TypeScriptâ€™s Module Resolution Options</h2><p><code>TypeScript çš„æ¨¡å—è§£æé€‰é¡¹</code></p><p>Module resolution is the process of taking a string from the import or require statement, and determining what file that string refers to.<br><code>æ¨¡å—è§£ææ˜¯ä» import æˆ– require è¯­å¥ä¸­è·å–å­—ç¬¦ä¸²ï¼Œå¹¶ç¡®å®šè¯¥å­—ç¬¦ä¸²æ‰€å¼•ç”¨çš„æ–‡ä»¶ã€‚</code></p><p>TypeScript includes two resolution strategies: Classic and Node. Classic, the default when the compiler option module is not commonjs, is included for backwards compatibility. The Node strategy replicates how Node.js works in CommonJS mode, with additional checks for .ts and .d.ts.<br><code>TypeScript åŒ…å«ä¸¤ç§è§£æç­–ç•¥ï¼šç»å…¸å’Œ Nodeã€‚ç»å…¸ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç¼–è¯‘å™¨é€‰é¡¹ module ä¸æ˜¯ commonjs æ—¶ï¼ŒåŒ…å«äº†å‘åå…¼å®¹æ€§ã€‚Node ç­–ç•¥é‡å¤äº† Node.js åœ¨ CommonJS æ¨¡å¼ä¸‹å·¥ä½œçš„æ–¹å¼ï¼Œå¹¶ä¸”æ·»åŠ äº† .ts å’Œ .d.ts çš„æ£€æŸ¥ã€‚</code><br>There are many TSConfig flags which influence the module strategy within TypeScript: moduleResolution, baseUrl, paths, rootDirs.<br><code>åœ¨ TypeScript ä¸­ï¼Œæœ‰å¾ˆå¤š TSConfig æ ‡å¿—å½±å“æ¨¡å—ç­–ç•¥ï¼šmoduleResolutionã€baseUrlã€pathsã€rootDirsã€‚</code><br>For the full details on how these strategies work, you can consult the Module Resolution.<br><code>å…³äºå¦‚ä½•å·¥ä½œçš„è¯¦ç»†ä¿¡æ¯ï¼Œä½ å¯ä»¥å‚è€ƒæ¨¡å—è§£æã€‚</code></p><h2 id="TypeScriptâ€™s-Module-Output-Options"><a href="#TypeScriptâ€™s-Module-Output-Options" class="headerlink" title="TypeScriptâ€™s Module Output Options"></a>TypeScriptâ€™s Module Output Options</h2><p><code>TypeScript çš„æ¨¡å—è¾“å‡ºé€‰é¡¹</code><br>There are two options which affect the emitted JavaScript output:<br><code>æœ‰ä¸¤ä¸ªå½±å“è¾“å‡ºçš„ JavaScript çš„é€‰é¡¹ï¼š</code></p><ul><li>target which determines which JS features are downleveled (converted to run in older JavaScript runtimes) and which are left intact<br><code>target æ˜¯æŒ‡å®šå“ªäº› JS ç‰¹æ€§è¢«ä¸‹æ¸¸ï¼ˆè½¬æ¢ä¸ºåœ¨æ—§çš„ JavaScript è¿è¡Œæ—¶è¿è¡Œï¼‰ï¼Œå“ªäº›è¢«ä¿ç•™ã€‚</code></li><li>module which determines what code is used for modules to interact with each other<br><code>module æ˜¯æŒ‡å®šå“ªäº›ä»£ç ç”¨äºæ¨¡å—äº¤äº’ã€‚</code></li></ul><p>Which target you use is determined by the features available in the JavaScript runtime you expect to run the TypeScript code in. That could be: the oldest web browser you support, the lowest version of Node.js you expect to run on or could come from unique constraints from your runtime - like Electron for example.<br><code>å“ªä¸ªç›®æ ‡ä½ ä½¿ç”¨æ˜¯ç”±ä½ æœŸæœ›åœ¨ JavaScript è¿è¡Œæ—¶è¿è¡Œ TypeScript ä»£ç çš„åŠŸèƒ½å†³å®šçš„ã€‚è¿™å¯èƒ½æ˜¯ï¼šæœ€æ—§çš„ web æµè§ˆå™¨ï¼Œæœ€ä½ç‰ˆæœ¬çš„ Node.jsï¼Œæˆ–è€…æ¥è‡ªä½ è¿è¡Œæ—¶çš„å”¯ä¸€çº¦æŸ - ä¾‹å¦‚ï¼ŒElectronã€‚</code><br>All communication between modules happens via a module loader, the compiler option module determines which one is used. At runtime the module loader is responsible for locating and executing all dependencies of a module before executing it.<br><code>æ¨¡å—ä¹‹é—´çš„é€šä¿¡éƒ½æ˜¯é€šè¿‡æ¨¡å—åŠ è½½å™¨æ¥å®Œæˆçš„ï¼Œç¼–è¯‘å™¨é€‰é¡¹ module æ˜¯æŒ‡å®šå“ªä¸ªè¢«ä½¿ç”¨ã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ¨¡å—åŠ è½½å™¨è´Ÿè´£å®šä½å¹¶æ‰§è¡Œæ‰€æœ‰æ¨¡å—çš„ä¾èµ–ä¹‹å‰æ‰§è¡Œå®ƒã€‚</code><br>For example, here is a TypeScript file using ES Modules syntax, showcasing a few different options for module:<br><code>ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨ ES Modules è¯­æ³•çš„ TypeScript æ–‡ä»¶ï¼Œå±•ç¤ºäº†ä¸€äº›æ¨¡å—çš„é€‰é¡¹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; valueOfPi &#125; from &quot;.&#x2F;constants.js&quot;;export const twoPi &#x3D; valueOfPi _ 2;</code></pre><h2 id="ES2020"><a href="#ES2020" class="headerlink" title="ES2020"></a>ES2020</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; valueOfPi &#125; from &quot;.&#x2F;constants.js&quot;;export const twoPi &#x3D; valueOfPi _ 2;</code></pre><h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&quot;use strict&quot;;Object.defineProperty(exports, &quot;\_\_esModule&quot;, &#123; value: true &#125;);exports.twoPi &#x3D; void 0;const constants_js_1 &#x3D; require(&quot;.&#x2F;constants.js&quot;);exports.twoPi &#x3D; constants_js_1.valueOfPi \* 2;</code></pre><h2 id="UMD"><a href="#UMD" class="headerlink" title="UMD"></a>UMD</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">(function (factory) &#123;  if (typeof module &#x3D;&#x3D;&#x3D; &quot;object&quot; &amp;&amp; typeof module.exports &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;    var v &#x3D; factory(require, exports);    if (v !&#x3D;&#x3D; undefined) module.exports &#x3D; v;  &#125;  else if (typeof define &#x3D;&#x3D;&#x3D; &quot;function&quot; &amp;&amp; define.amd) &#123;    define([&quot;require&quot;, &quot;exports&quot;, &quot;.&#x2F;constants.js&quot;], factory);  &#125;&#125;)(function (require, exports) &#123;  &quot;use strict&quot;;  Object.defineProperty(exports, &quot;\_\_esModule&quot;, &#123; value: true &#125;);  exports.twoPi &#x3D; void 0;  const constants_js_1 &#x3D; require(&quot;.&#x2F;constants.js&quot;);  exports.twoPi &#x3D; constants_js_1.valueOfPi \* 2;&#125;);</code></pre><p>Note that ES2020 is effectively the same as the original index.ts.<br><code>ES2020 æ˜¯ä¸€æ ·çš„äºåŸå§‹ index.tsã€‚</code><br>You can see all of the available options and what their emitted JavaScript code looks like in the TSConfig Reference for module.<br><code>ä½ å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯ç”¨çš„é€‰é¡¹å’Œä»–ä»¬çš„è¾“å‡º JavaScript ä»£ç çš„æ ·å­åœ¨ module çš„ TSConfig å‚è€ƒä¸­ã€‚</code></p><h2 id="TypeScript-namespaces"><a href="#TypeScript-namespaces" class="headerlink" title="TypeScript namespaces"></a>TypeScript namespaces</h2><p><code>TypeScript å‘½åç©ºé—´</code><br>TypeScript has its own module format called namespaces which pre-dates the ES Modules standard. This syntax has a lot of useful features for creating complex definition files, and still sees active use in DefinitelyTyped. While not deprecated, the majority of the features in namespaces exist in ES Modules and we recommend you use that to align with JavaScriptâ€™s direction. You can learn more about namespaces in the namespaces reference page.<br><code>TypeScript æœ‰è‡ªå·±çš„æ¨¡å—æ ¼å¼å‘½åç©ºé—´ï¼Œå®ƒæ˜¯å…ˆæœŸçš„ ES Modules æ ‡å‡†ã€‚è¿™ç§è¯­æ³•å…·æœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½åˆ›å»ºå¤æ‚çš„å®šä¹‰æ–‡ä»¶ï¼Œä»ç„¶åœ¨ DefinitelyTyped ä¸­æœ‰æ´»è·ƒä½¿ç”¨ã€‚å°½ç®¡ä¸è¢«å¼ƒç”¨ï¼Œå¤§å¤šæ•°çš„åŠŸèƒ½åœ¨å‘½åç©ºé—´ä¸­å­˜åœ¨äº ES Modulesï¼Œæˆ‘ä»¬å»ºè®®ä½ ä½¿ç”¨å®ƒä¸ JavaScript çš„æ–¹å‘å¯¹é½ã€‚ä½ å¯ä»¥åœ¨å‘½åç©ºé—´å‚è€ƒé¡µé¢ä¸Šäº†è§£æ›´å¤šå…³äºå‘½åç©ºé—´ã€‚</code></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8.Typescriptæ‰‹å†Œ ç±»</title>
      <link href="//post/2022-06-08ts-classes.html"/>
      <url>//post/2022-06-08ts-classes.html</url>
      
        <content type="html"><![CDATA[<p>Background Reading:<br><code>èƒŒæ™¯é˜…è¯»</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">Classes (MDN)</a></p><p>TypeScript offers full support for the class keyword introduced in ES2015.<br><code>typescript æ”¯æŒ ES2015 çš„ class å…³é”®å­—ã€‚</code></p><p>As with other JavaScript language features, TypeScript adds type annotations and other syntax to allow you to express relationships between classes and other types.<br><code> åƒå…¶ä»– JavaScript è¯­è¨€ç‰¹æ€§ä¸€æ ·ï¼ŒTypeScript æ·»åŠ äº†ç±»å‹æ³¨è§£å’Œå…¶ä»–è¯­æ³•ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è¡¨è¾¾ç±»å’Œå…¶ä»–ç±»å‹ä¹‹é—´çš„å…³ç³»ã€‚</code></p><h2 id="Class-Members"><a href="#Class-Members" class="headerlink" title="Class Members"></a>Class Members</h2><p><code>ç±»æˆå‘˜</code><br>Hereâ€™s the most basic class - an empty one:<br><code>è¿™æ˜¯æœ€åŸºæœ¬çš„ç±» - ç©ºçš„ä¸€ä¸ªï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Point &#123;&#125;</code></pre><p>This class isnâ€™t very useful yet, so letâ€™s start adding some members.<br><code>è¿™ä¸ªç±»è¿˜ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹æ·»åŠ ä¸€äº›æˆå‘˜ã€‚</code></p><h2 id="Fields"><a href="#Fields" class="headerlink" title="Fields"></a>Fields</h2><p><code>å­—æ®µ</code><br>A field declaration creates a public writeable property on a class:<br><code>å­—æ®µå£°æ˜åˆ›å»ºä¸€ä¸ªå…¬å…±å¯å†™å±æ€§åœ¨ç±»ä¸Šï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Point &#123;  x: number;  y: number;&#125;const pt &#x3D; new Point();pt.x &#x3D; 0;pt.y &#x3D; 0;</code></pre><p>As with other locations, the type annotation is optional, but will be an implicit any if not specified.<br><code>ä¸å…¶ä»–åœ°æ–¹ä¸€æ ·ï¼Œç±»å‹æ³¨è§£æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œå°†ä¼šæ˜¯ä»»æ„ç±»å‹ã€‚</code><br>Fields can also have initializers; these will run automatically when the class is instantiated:<br><code>å­—æ®µä¹Ÿå¯ä»¥æœ‰åˆå§‹å€¼ï¼Œè¿™ä¼šåœ¨ç±»è¢«å®ä¾‹åŒ–æ—¶è‡ªåŠ¨è¿è¡Œï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Point &#123;  x &#x3D; 0;  y &#x3D; 0;&#125;const pt &#x3D; new Point();&#x2F;&#x2F; Prints 0, 0console.log(&#96;$&#123;pt.x&#125;, $&#123;pt.y&#125;&#96;);</code></pre><p>Just like with const, let, and var, the initializer of a class property will be used to infer its type:<br><code>å’Œ constï¼Œletï¼Œvar ç±»å‹æ¨æ–­çš„åˆå§‹å€¼ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">const pt &#x3D; new Point();pt.x &#x3D; &quot;0&quot;;&#x2F;&#x2F; Type &#39;string&#39; is not assignable to type &#39;number&#39;.</code></pre><h2 id="â€“strictPropertyInitialization"><a href="#â€“strictPropertyInitialization" class="headerlink" title="â€“strictPropertyInitialization"></a>â€“strictPropertyInitialization</h2><p>The strictPropertyInitialization setting controls whether class fields need to be initialized in the constructor.<br><code>strictPropertyInitialization è®¾ç½®æ§åˆ¶ç±»å­—æ®µæ˜¯å¦éœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class BadGreeter &#123;  name: string;  &#x2F;&#x2F; Property &#39;name&#39; has no initializer and is not definitely assigned in the constructor.&#125;class GoodGreeter &#123;  name: string;  constructor() &#123;    this.name &#x3D; &quot;hello&quot;;  &#125;&#125;</code></pre><p>Note that the field needs to be initialized in the constructor itself. TypeScript does not analyze methods you invoke from the constructor to detect initializations, because a derived class might override those methods and fail to initialize the members.<br><code>æ³¨æ„ï¼Œå­—æ®µéœ€è¦åœ¨æ„é€ å‡½æ•°æœ¬èº«ä¸­åˆå§‹åŒ–ã€‚TypeScript ä¸ä¼šåˆ†æè°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•æ¥æ£€æµ‹åˆå§‹åŒ–ï¼Œå› ä¸ºç»§æ‰¿çš„å­ç±»å¯èƒ½è¦†ç›–è¿™äº›æ–¹æ³•å¹¶ä¸”å¤±è´¥åˆå§‹åŒ–æˆå‘˜ã€‚</code><br>If you intend to definitely initialize a field through means other than the constructor (for example, maybe an external library is filling in part of your class for you), you can use the definite assignment assertion operator, !:<br><code>å¦‚æœæ‚¨æ„¿æ„é€šè¿‡å…¶ä»–æ–¹å¼æ¥ç¡®å®šåˆå§‹åŒ–ä¸€ä¸ªå­—æ®µï¼ˆä¾‹å¦‚ï¼Œå¯èƒ½æ˜¯å¤–éƒ¨åº“å¡«å……æ‚¨çš„ç±»çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç¡®å®šèµ‹å€¼æ–­è¨€è¿ç®—ç¬¦ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class OKGreeter &#123;  &#x2F;&#x2F; Not initialized, but no error  name!: string;&#125;</code></pre><h2 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h2><p>Fields may be prefixed with the readonly modifier. This prevents assignments to the field outside of the constructor.<br><code>å­—æ®µå¯ä»¥ä½¿ç”¨ readonly å‰ç¼€ã€‚è¿™å°†é˜»æ­¢åœ¨æ„é€ å‡½æ•°ä¹‹å¤–èµ‹å€¼ç»™å­—æ®µã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Greeter &#123;  readonly name: string &#x3D; &quot;world&quot;;  constructor(otherName?: string) &#123;    if (otherName !&#x3D;&#x3D; undefined) &#123;      this.name &#x3D; otherName;    &#125;  &#125;  err() &#123;    this.name &#x3D; &quot;not ok&quot;;    &#x2F;&#x2F; Cannot assign to &#39;name&#39; because it is a read-only property.  &#125;&#125;const g &#x3D; new Greeter();g.name &#x3D; &quot;also not ok&quot;;&#x2F;&#x2F; Cannot assign to &#39;name&#39; because it is a read-only property.</code></pre><h2 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h2><p><code>æ„é€ å‡½æ•°</code><br>Background Reading:<br><code>èƒŒæ™¯é˜…è¯»ï¼š</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/constructor">Constructor (MDN)</a></p><p>Class constructors are very similar to functions. You can add parameters with type annotations, default values, and overloads:<br><code>ç±»æ„é€ å‡½æ•°å’Œå‡½æ•°å¾ˆç›¸ä¼¼ã€‚æ‚¨å¯ä»¥æ·»åŠ å‚æ•°ï¼Œç±»å‹æ³¨è§£ï¼Œé»˜è®¤å€¼å’Œé‡è½½ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Point &#123;  x: number;  y: number;  &#x2F;&#x2F; Normal signature with defaults  constructor(x &#x3D; 0, y &#x3D; 0) &#123;    this.x &#x3D; x;    this.y &#x3D; y;  &#125;&#125;</code></pre><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Point &#123;  &#x2F;&#x2F; Overloads  constructor(x: number, y: string);  constructor(s: string);  constructor(xs: any, y?: any) &#123;    &#x2F;&#x2F; TBD  &#125;&#125;</code></pre><p>There are just a few differences between class constructor signatures and function signatures:<br><code>ç±»æ„é€ å‡½æ•°å’Œå‡½æ•°ç­¾åæœ‰ä¸€äº›ä¸åŒï¼š</code></p><ul><li>Constructors canâ€™t have type parameters - these belong on the outer class declaration, which weâ€™ll learn about later<br><code>- æ„é€ å‡½æ•°ä¸èƒ½æœ‰ç±»å‹å‚æ•°ï¼Œè¿™äº›å±äºå¤–éƒ¨ç±»å£°æ˜ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ å…¶ä»–å†…å®¹</code></li><li>Constructors canâ€™t have return type annotations - the class instance type is always whatâ€™s returned<br><code>- æ„é€ å‡½æ•°ä¸èƒ½æœ‰è¿”å›ç±»å‹æ³¨è§£ï¼Œè¿”å›çš„ç±»å®ä¾‹ç±»å‹å§‹ç»ˆæ˜¯è¿”å›çš„</code></li></ul><h2 id="Super-Calls"><a href="#Super-Calls" class="headerlink" title="Super Calls"></a>Super Calls</h2><p><code>è¶…ç±»è°ƒç”¨</code><br>Just as in JavaScript, if you have a base class, youâ€™ll need to call super(); in your constructor body before using any this. members:<br><code>åœ¨ JavaScript ä¸­ï¼Œå¦‚æœæ‚¨æœ‰åŸºç±»ï¼Œæ‚¨éœ€è¦åœ¨æ„é€ å‡½æ•°ä½“ä¸­è°ƒç”¨ super(); åœ¨ä½¿ç”¨ä»»ä½• this. æˆå‘˜ä¹‹å‰ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Base &#123;k &#x3D; 4;&#125;class Derived extends Base &#123;constructor() &#123;&#x2F;&#x2F; Prints a wrong value in ES5; throws exception in ES6console.log(this.k);&#39;super&#39; must be called before accessing &#39;this&#39; in the constructor of a derived class.super();&#125;&#125;</code></pre><p>Forgetting to call super is an easy mistake to make in JavaScript, but TypeScript will tell you when itâ€™s necessary.<br><code>åœ¨ JavaScript ä¸­ï¼Œå¿˜è®°è°ƒç”¨ super() å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é”™è¯¯ï¼Œä½† TypeScript å°†å‘Šè¯‰æ‚¨å½“å¿…è¦æ—¶ã€‚</code></p><h2 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h2><p><code>æ–¹æ³•</code><br>Background Reading:<br><code>èƒŒæ™¯é˜…è¯»ï¼š</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/method">Method (MDN)</a></p><p>A function property on a class is called a method. Methods can use all the same type annotations as functions and constructors:<br><code>ç±»ä¸­çš„å‡½æ•°å±æ€§è¢«ç§°ä¸ºæ–¹æ³•ã€‚æ–¹æ³•å¯ä»¥ä½¿ç”¨å’Œå‡½æ•°å’Œæ„é€ å‡½æ•°ä¸€æ ·çš„ç±»å‹æ³¨è§£ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Point &#123;  x &#x3D; 10;  y &#x3D; 10;  scale(n: number): void &#123;    this.x *&#x3D; n;    this.y *&#x3D; n;  &#125;&#125;</code></pre><p>Other than the standard type annotations, TypeScript doesnâ€™t add anything else new to methods.<br><code>é™¤äº†æ ‡å‡†ç±»å‹æ³¨è§£ä¹‹å¤–ï¼ŒTypeScript ä¸ä¼šæ·»åŠ ä»»ä½•å…¶ä»–ä¸œè¥¿åˆ°æ–¹æ³•ã€‚</code><br>Note that inside a method body, it is still mandatory to access fields and other methods via this.. An unqualified name in a method body will always refer to something in the enclosing scope:<br><code>åœ¨æ–¹æ³•ä½“ä¸­ï¼Œåœ¨æ–¹æ³•ä½“å†…éƒ¨ï¼Œæ‚¨ä»ç„¶å¿…é¡»é€šè¿‡ this è®¿é—®å­—æ®µå’Œå…¶ä»–æ–¹æ³•ã€‚åœ¨æ–¹æ³•ä½“å†…éƒ¨ï¼Œæœªå‘½åçš„åç§°å°†å§‹ç»ˆæŒ‡å‘åŒ…å«å®ƒçš„ä½œç”¨åŸŸå†…çš„ä¸œè¥¿ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">let x: number &#x3D; 0;class C &#123;x: string &#x3D; &quot;hello&quot;;  m() &#123;    &#x2F;&#x2F; This is trying to modify &#39;x&#39; from line 1, not the class property    &#x2F;&#x2F; è¿™æ˜¯å°è¯•ä»è¡Œ 1 ä¿®æ”¹ &#39;x&#39;ï¼Œè€Œä¸æ˜¯ç±»å±æ€§    x &#x3D; &quot;world&quot;;    Type &#39;string&#39; is not assignable to type &#39;number&#39;.  &#125;&#125;</code></pre><h2 id="Getters-x2F-Setters"><a href="#Getters-x2F-Setters" class="headerlink" title="Getters &#x2F; Setters"></a>Getters &#x2F; Setters</h2><p><code>è·å–å™¨/è®¾ç½®å™¨</code><br>Classes can also have accessors:<br><code>ç±»ä¹Ÿå¯ä»¥æœ‰è®¿é—®å™¨ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class C &#123;  _length &#x3D; 0;  get length() &#123;    return this._length;  &#125;  set length(value) &#123;    this._length &#x3D; value;  &#125;&#125;</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Note that a field-backed get&#x2F;set pair with no extra logic is very rarely useful in JavaScript. Itâ€™s fine to expose public fields if you donâ€™t need to add additional logic during the get&#x2F;set operations.<br><code>&gt;æ³¨æ„ï¼Œæ²¡æœ‰é¢å¤–é€»è¾‘çš„å­—æ®µ-è·å–/è®¾ç½®-å¯¹å¶åœ¨ JavaScript ä¸­å¾ˆå°‘æ˜¯æœ‰ç”¨çš„ã€‚å¦‚æœæ‚¨ä¸éœ€è¦åœ¨è·å–/è®¾ç½®æ“ä½œæœŸé—´æ·»åŠ é¢å¤–é€»è¾‘ï¼Œåˆ™å¯ä»¥æš´éœ²å…¬å…±å­—æ®µã€‚</code></p></blockquote><p>TypeScript has some special inference rules for accessors:<br><code>TypeScript æœ‰ä¸€äº›ç‰¹æ®Šçš„æ¨æ–­è§„åˆ™ä¸ºè®¿é—®å™¨ï¼š</code></p><ul><li>If get exists but no set, the property is automatically readonly<br><code>- å¦‚æœ get å­˜åœ¨ä½†æ²¡æœ‰ setï¼Œå±æ€§æ˜¯è‡ªåŠ¨åªè¯»çš„</code></li><li>If the type of the setter parameter is not specified, it is inferred from the return type of the getter<br><code>- å¦‚æœè®¾ç½®å™¨å‚æ•°çš„ç±»å‹æ²¡æœ‰æŒ‡å®šï¼Œå®ƒä¼šä» getter çš„è¿”å›ç±»å‹æ¨æ–­</code></li><li>Getters and setters must have the same Member Visibility<br><code>- è·å–å™¨å’Œè®¾ç½®å™¨å¿…é¡»å…·æœ‰ç›¸åŒçš„æˆå‘˜å¯è§æ€§</code><br>Since TypeScript 4.3, it is possible to have accessors with different types for getting and setting.<br><code>ä» TypeScript 4.3 å¼€å§‹ï¼Œå¯ä»¥æœ‰ä¸åŒç±»å‹çš„è®¿é—®å™¨è·å–å’Œè®¾ç½®ã€‚</code></li></ul><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Thing &#123;  _size &#x3D; 0;  get size(): number &#123;    return this._size;  &#125;  set size(value: string | number | boolean) &#123;    let num &#x3D; Number(value);    &#x2F;&#x2F; Don&#39;t allow NaN, Infinity, etc    if (!Number.isFinite(num)) &#123;      this._size &#x3D; 0;      return;    &#125;    this._size &#x3D; num;  &#125;&#125;</code></pre><h2 id="Index-Signatures"><a href="#Index-Signatures" class="headerlink" title="Index Signatures"></a>Index Signatures</h2><p><code>ç´¢å¼•ç­¾å</code><br>Classes can declare index signatures; these work the same as Index Signatures for other object types:<br><code>ç±»å¯ä»¥å£°æ˜ç´¢å¼•ç­¾åï¼›è¿™ç±»ä¼¼äºå…¶ä»–å¯¹è±¡ç±»å‹çš„ç´¢å¼•ç­¾åï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class MyClass &#123;  [s: string]: boolean | ((s: string) &#x3D;&gt; boolean);  check(s: string) &#123;    return this[s] as boolean;  &#125;&#125;</code></pre><p>Because the index signature type needs to also capture the types of methods, itâ€™s not easy to usefully use these types. Generally itâ€™s better to store indexed data in another place instead of on the class instance itself.<br><code>å› ä¸ºç´¢å¼•ç­¾åç±»å‹ä¹Ÿéœ€è¦æ•è·æ–¹æ³•çš„ç±»å‹ï¼Œè¿™ä½¿å¾—å¹¶ä¸å®¹æ˜“æœ‰æ•ˆçš„ä½¿ç”¨è¿™äº›ç±»å‹ã€‚é€šå¸¸çš„æ¥è¯´ï¼Œåœ¨å…¶ä»–åœ°æ–¹å­˜å‚¨ç´¢å¼•æ•°æ®è€Œä¸æ˜¯åœ¨ç±»å®ä¾‹æœ¬èº«ï¼Œä¼šæ›´å¥½ä¸€äº›ã€‚</code></p><h2 id="Class-Heritage"><a href="#Class-Heritage" class="headerlink" title="Class Heritage"></a>Class Heritage</h2><p><code>ç±»ç»§æ‰¿</code><br>Like other languages with object-oriented features, classes in JavaScript can inherit from base classes.<br><code>åœ¨ JavaScript ä¸­ï¼Œç±»å¯ä»¥ä»åŸºç±»ç»§æ‰¿ã€‚</code></p><h2 id="implements-Clauses"><a href="#implements-Clauses" class="headerlink" title="implements Clauses"></a>implements Clauses</h2><p><code>implements è¯­å¥</code><br>You can use an implements clause to check that a class satisfies a particular interface. An error will be issued if a class fails to correctly implement it:<br><code>ä½ å¯ä»¥ä½¿ç”¨ implements è¯­å¥æ£€æŸ¥ä¸€ä¸ªç±»æ˜¯å¦æ»¡è¶³ä¸€ä¸ªç‰¹å®šçš„ interfaceã€‚å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æ­£ç¡®çš„å®ç°(implement)å®ƒï¼ŒTypeScript ä¼šæŠ¥é”™ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Pingable &#123;  ping(): void;&#125;class Sonar implements Pingable &#123;  ping() &#123;    console.log(&quot;ping!&quot;);  &#125;&#125;class Ball implements Pingable &#123;  &#x2F;&#x2F; Class &#39;Ball&#39; incorrectly implements interface &#39;Pingable&#39;.  &#x2F;&#x2F; ç±» &#39;Ball&#39; é”™è¯¯åœ°å®ç°äº†æ¥å£ &#39;Pingable&#39;ã€‚  &#x2F;&#x2F; Property &#39;ping&#39; is missing in type &#39;Ball&#39; but required in type &#39;Pingable&#39;.  &#x2F;&#x2F; åœ¨ç±»å‹ &#39;Ball&#39; ä¸­ç¼ºå°‘å±æ€§ &#39;ping&#39;ï¼Œä½†æ˜¯åœ¨ç±»å‹ &#39;Pingable&#39; ä¸­æ˜¯å¿…éœ€çš„ã€‚  pong() &#123;    console.log(&quot;pong!&quot;);  &#125;&#125;</code></pre><p>Classes may also implement multiple interfaces, e.g. class C implements A, B {.<br><code>ç±»ä¹Ÿå¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œæ¯”å¦‚ class C implements A, B &#123;</code></p><p><strong>Cautions</strong></p><p><code>æ³¨æ„äº‹é¡¹</code></p><p><strong>å¤§æ¦‚æ„æ€ï¼šè¿™æ˜¯ç±»å‹ï¼Œä¸æ˜¯ java ä¸­çš„æ¥å£ï¼Œä¸èƒ½å½“ js ç±»å»ç”¨,ä¸ js çš„ç±»ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µ</strong></p><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>Itâ€™s important to understand that an implements clause is only a check that the class can be treated as the interface type. It doesnâ€™t change the type of the class or its methods at all. A common source of error is to assume that an implements clause will change the class type - it doesnâ€™t!<br><code>implements è¯­å¥ä»…ä»…æ£€æŸ¥ç±»æ˜¯å¦æŒ‰ç…§æ¥å£ç±»å‹å®ç°ï¼Œä½†å®ƒå¹¶ä¸ä¼šæ”¹å˜ç±»çš„ç±»å‹æˆ–è€…æ–¹æ³•çš„ç±»å‹ã€‚ä¸€ä¸ªå¸¸è§çš„é”™è¯¯å°±æ˜¯ä»¥ä¸º implements è¯­å¥ä¼šæ”¹å˜ç±»çš„ç±»å‹,â€”â€”ç„¶è€Œå®é™…ä¸Šå®ƒå¹¶ä¸ä¼šï¼š</code></p></div><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Checkable &#123;  check(name: string): boolean;&#125;class NameChecker implements Checkable &#123;  check(s) &#123;    &#x2F;&#x2F; Parameter &#39;s&#39; implicitly has an &#39;any&#39; type.    &#x2F;&#x2F; Notice no error here    return s.toLowercse() &#x3D;&#x3D;&#x3D; &quot;ok&quot;;    &#x2F;&#x2F; any;  &#125;&#125;</code></pre><p>In this example, we perhaps expected that sâ€™s type would be influenced by the name: string parameter of check. It is not - implements clauses donâ€™t change how the class body is checked or its type inferred.<br><code>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä»¥ä¸º s çš„ç±»å‹ä¼šè¢« check çš„ name: string å‚æ•°å½±å“ã€‚å®é™…ä¸Šå¹¶æ²¡æœ‰ï¼Œimplements è¯­å¥å¹¶ä¸ä¼šå½±å“ç±»çš„å†…éƒ¨æ˜¯å¦‚ä½•æ£€æŸ¥æˆ–è€…ç±»å‹æ¨æ–­çš„ã€‚</code><br>Similarly, implementing an interface with an optional property doesnâ€™t create that property:<br><code>ç±»ä¼¼çš„ï¼Œå®ç°ä¸€ä¸ªæœ‰å¯é€‰å±æ€§çš„æ¥å£ï¼Œå¹¶ä¸ä¼šåˆ›å»ºè¿™ä¸ªå±æ€§ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface A &#123;  x: number;  y?: number;&#125;class C implements A &#123;  x &#x3D; 0;&#125;const c &#x3D; new C();c.y &#x3D; 10;&#x2F;&#x2F; Property &#39;y&#39; does not exist on type &#39;C&#39;.</code></pre><h2 id="extends-Clauses"><a href="#extends-Clauses" class="headerlink" title="extends Clauses"></a>extends Clauses</h2><p><code>extends è¯­å¥</code></p><p>Background Reading: <a href="https://www.typescriptlang.org/docs/handbook/classes.html#class-inheritance">Class Inheritance</a></p><p><code>èƒŒæ™¯é˜…è¯»ï¼š[ç±»ç»§æ‰¿](https://www.typescriptlang.org/docs/handbook/classes.html#class-inheritance)</code></p><p>Classes may extend from a base class. A derived class has all the properties and methods of its base class, and also define additional members.<br><code>ç±»å¯ä»¥ä»åŸºç±»ç»§æ‰¿ã€‚ä¸€ä¸ªæ´¾ç”Ÿç±»å…·æœ‰åŸºç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”è¿˜å®šä¹‰äº†ä¸€äº›é¢å¤–çš„æˆå‘˜ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Animal &#123;  move() &#123;    console.log(&quot;Moving along!&quot;);  &#125;&#125;class Dog extends Animal &#123;  woof(times: number) &#123;    for (let i &#x3D; 0; i &lt; times; i++) &#123;      console.log(&quot;woof!&quot;);    &#125;  &#125;&#125;const d &#x3D; new Dog();&#x2F;&#x2F; Base class methodd.move();&#x2F;&#x2F; Derived class methodd.woof(3);</code></pre><h3 id="Overriding-Methods"><a href="#Overriding-Methods" class="headerlink" title="Overriding Methods"></a>Overriding Methods</h3><p><code>è¦†å†™æ–¹æ³•</code></p><p>Background Reading: <a href="https://www.typescriptlang.org/docs/handbook/classes.html#overriding-methods">Overriding Methods</a></p><p>A derived class can also override a base class field or property. You can use the super. syntax to access base class methods. Note that because JavaScript classes are a simple lookup object, there is no notion of a â€œsuper fieldâ€.<br><code>æ´¾ç”Ÿç±»å¯ä»¥è¦†å†™åŸºç±»çš„å±æ€§æˆ–æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨ super. è¯­å¥è®¿é—®åŸºç±»çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œå› ä¸º JavaScript çš„ç±»æ˜¯ç®€å•çš„æŸ¥æ‰¾å¯¹è±¡ï¼Œæ‰€ä»¥æ²¡æœ‰åŸºç±»çš„â€œsuper å­—æ®µâ€ã€‚</code><br>TypeScript enforces that a derived class is always a subtype of its base class.<br><code>TypeScript å¼ºåˆ¶æ‰€æœ‰æ´¾ç”Ÿç±»éƒ½æ˜¯åŸºç±»çš„å­ç±»ã€‚</code><br>For example, hereâ€™s a legal way to override a method:<br><code>è¿™é‡Œæ˜¯ä¸€ç§åˆæ³•çš„æ–¹å¼è¦†å†™æ–¹æ³•ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Base &#123;  greet() &#123;    console.log(&quot;Hello, world!&quot;);  &#125;&#125;class Derived extends Base &#123;  greet(name?: string) &#123;    if (name &#x3D;&#x3D;&#x3D; undefined) &#123;      super.greet();    &#125; else &#123;      console.log(&#96;Hello, $&#123;name.toUpperCase()&#125;&#96;);    &#125;  &#125;&#125;const d &#x3D; new Derived();d.greet();d.greet(&quot;reader&quot;);</code></pre><p>Itâ€™s important that a derived class follow its base class contract. Remember that itâ€™s very common (and always legal!) to refer to a derived class instance through a base class reference:<br><code>æ´¾ç”Ÿç±»éœ€è¦éµå¾ªç€å®ƒçš„åŸºç±»çš„å®ç°ã€‚è€Œä¸”é€šè¿‡ä¸€ä¸ªåŸºç±»å¼•ç”¨æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»å®ä¾‹ï¼Œè¿™æ˜¯éå¸¸å¸¸è§å¹¶åˆæ³•çš„ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">&#x2F;&#x2F; Alias the derived instance through a base class reference&#x2F;&#x2F; åŸºç±»å¼•ç”¨æ¥è®¿é—®æ´¾ç”Ÿç±»çš„å®ä¾‹const b: Base &#x3D; d;&#x2F;&#x2F; No problem&#x2F;&#x2F; æ²¡æœ‰é—®é¢˜b.greet();</code></pre><p>What if Derived didnâ€™t follow Baseâ€™s contract?<br><code>ä½†æ˜¯å¦‚æœ Derived ä¸éµå¾ª Base çš„çº¦å®šå®ç°å‘¢ï¼Ÿ</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Base &#123;  greet() &#123;    console.log(&quot;Hello, world!&quot;);  &#125;&#125;class Derived extends Base &#123;  &#x2F;&#x2F; Make this parameter required  greet(name: string) &#123;    &#x2F;&#x2F; Property &#39;greet&#39; in type &#39;Derived&#39; is not assignable to the same property in base type &#39;Base&#39;.    &#x2F;&#x2F; Type &#39;(name: string) &#x3D;&gt; void&#39; is not assignable to type &#39;() &#x3D;&gt; void&#39;.    console.log(&#96;Hello, $&#123;name.toUpperCase()&#125;&#96;);  &#125;&#125;</code></pre><p>If we compiled this code despite the error, this sample would then crash:<br><code>å¦‚æœæˆ‘ä»¬ç¼–è¯‘è¿™æ®µä»£ç ï¼Œå´æ²¡æœ‰æŠ¥é”™ï¼Œé‚£ä¹ˆè¿™ä¸ªä¾‹å­å°±ä¼šå´©æºƒï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">const b: Base &#x3D; new Derived();&#x2F;&#x2F; Crashes because &quot;name&quot; will be undefinedb.greet();</code></pre><h3 id="Type-only-Field-Declarations"><a href="#Type-only-Field-Declarations" class="headerlink" title="Type-only Field Declarations"></a>Type-only Field Declarations</h3><p><code>åªæœ‰å­—æ®µç”³æ˜çš„ç±»å‹</code><br>When target &gt;&#x3D; ES2022 or useDefineForClassFields is true, class fields are initialized after the parent class constructor completes, overwriting any value set by the parent class. This can be a problem when you only want to re-declare a more accurate type for an inherited field. To handle these cases, you can write declare to indicate to TypeScript that there should be no runtime effect for this field declaration.<br><code>å½“ç›®æ ‡ç‰ˆæœ¬ &gt;= ES2022 æˆ–è€… useDefineForClassFields ä¸º true æ—¶ï¼Œç±»å­—æ®µåœ¨çˆ¶ç±»æ„é€ å‡½æ•°å®Œæˆååˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¼šè¦†ç›–çˆ¶ç±»çš„è®¾ç½®ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½ åªæƒ³é‡æ–°å®šä¹‰ä¸€ä¸ªæ›´åŠ å‡†ç¡®çš„ç±»å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ declare æ¥æŒ‡ç¤ºç»™ TypeScriptã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Animal &#123;  dateOfBirth: any;&#125;interface Dog extends Animal &#123;  breed: any;&#125;class AnimalHouse &#123;  resident: Animal;  constructor(animal: Animal) &#123;    this.resident &#x3D; animal;  &#125;&#125;class DogHouse extends AnimalHouse &#123;  &#x2F;&#x2F; Does not emit JavaScript code,  &#x2F;&#x2F; ä¸èƒ½ç”Ÿæˆ JavaScript ä»£ç   &#x2F;&#x2F; only ensures the types are correct  &#x2F;&#x2F; åªæ˜¯ç¡®ä¿ç±»å‹æ­£ç¡®  declare resident: Dog;  constructor(dog: Dog) &#123;    super(dog);  &#125;&#125;</code></pre><p><strong>è¾“å‡º</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; .d.tsinterface Animal &#123;  dateOfBirth: any;&#125;interface Dog extends Animal &#123;  breed: any;&#125;declare class AnimalHouse &#123;  resident: Animal;  constructor(animal: Animal);&#125;declare class DogHouse extends AnimalHouse &#123;  resident: Dog;  constructor(dog: Dog);&#125;</code></pre><h3 id="Initialization-Order"><a href="#Initialization-Order" class="headerlink" title="Initialization Order"></a>Initialization Order</h3><p><code>åˆå§‹åŒ–é¡ºåº</code><br>The order that JavaScript classes initialize can be surprising in some cases. Letâ€™s consider this code:<br><code>è¿™æ®µä»£ç çš„åˆå§‹åŒ–é¡ºåºå¯èƒ½ä¼šæœ‰äº›ä¸åŒã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">class Base &#123;  name &#x3D; &quot;base&quot;;  constructor() &#123;    console.log(&quot;My name is &quot; + this.name);  &#125;&#125;class Derived extends Base &#123;  name &#x3D; &quot;derived&quot;;&#125;&#x2F;&#x2F; Prints &quot;base&quot;, not &quot;derived&quot;const d &#x3D; new Derived();</code></pre><h3 id="What-happened-here"><a href="#What-happened-here" class="headerlink" title="What happened here?"></a>What happened here?</h3><p><code>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</code> å…ˆæ‰§è¡ŒåŸºç±»æ„é€ ï¼Œthis.name å€¼æ˜¯â€œbaseâ€<br>The order of class initialization, as defined by JavaScript, is:<br><code>JavaScript çš„åˆå§‹åŒ–é¡ºåºï¼š</code></p><ul><li>The base class fields are initialized<br><code>åŸºç±»å­—æ®µåˆå§‹åŒ–</code></li><li>The base class constructor runs<br><code>åŸºç±»æ„é€ å‡½æ•°è¿è¡Œ</code></li><li>The derived class fields are initialized<br><code>æ´¾ç”Ÿç±»å­—æ®µåˆå§‹åŒ–</code></li><li>The derived class constructor runs<br><code>æ´¾ç”Ÿç±»æ„é€ å‡½æ•°è¿è¡Œ</code><br>This means that the base class constructor saw its own value for name during its own constructor, because the derived class field initializations hadnâ€™t run yet.</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Base &#123;  name &#x3D; &quot;base&quot;;  constructor() &#123;    console.log(&quot;My name is &quot; + this.name);  &#125;&#125;class Derived extends Base &#123;  name &#x3D; &quot;derived&quot;;&#125;&#x2F;&#x2F; Prints &quot;base&quot;, not &quot;derived&quot;const d &#x3D; new Derived();console.log(d.name); &#x2F;&#x2F; åŠ ä¸ªæ—¥å¿—çœ‹çœ‹</code></pre><p>ç‚¹å‡» run åï¼Œè¿”å›</p><pre class="line-numbers language-none"><code class="language-none">[LOG]: &quot;My name is base&quot;[LOG]: &quot;derived&quot;</code></pre><h3 id="Inheriting-Built-in-Types"><a href="#Inheriting-Built-in-Types" class="headerlink" title="Inheriting Built-in Types"></a>Inheriting Built-in Types</h3><p><code>ç»§æ‰¿å†…ç½®ç±»å‹</code></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Note: If you donâ€™t plan to inherit from built-in types like Array, Error, Map, etc. or your compilation target is explicitly set to ES6&#x2F;ES2015 or above, you may skip this section<br><code>æ³¨æ„ï¼šå¦‚æœä½ ä¸æ‰“ç®—ç»§æ‰¿å†…ç½®çš„ç±»å‹æ¯”å¦‚ Arrayã€Errorã€Map ç­‰æˆ–è€…ä½ çš„ç¼–è¯‘ç›®æ ‡æ˜¯ ES6/ES2015 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬ï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸ªç« èŠ‚ã€‚</code></p></blockquote><p>In ES2015, constructors which return an object implicitly substitute the value of this for any callers of super(â€¦). It is necessary for generated constructor code to capture any potential return value of super(â€¦) and replace it with this.<br><code>åœ¨ ES2015 ä¸­ï¼Œå½“è°ƒç”¨ super(...) çš„æ—¶å€™ï¼Œå¦‚æœæ„é€ å‡½æ•°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä¼šéšå¼æ›¿æ¢ this çš„å€¼ã€‚æ‰€ä»¥æ•è· super() å¯èƒ½çš„è¿”å›å€¼å¹¶ç”¨ this æ›¿æ¢å®ƒæ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</code><br>As a result, subclassing Error, Array, and others may no longer work as expected. This is due to the fact that constructor functions for Error, Array, and the like use ECMAScript 6â€™s new.target to adjust the prototype chain; however, there is no way to ensure a value for new.target when invoking a constructor in ECMAScript 5. Other downlevel compilers generally have the same limitation by default.<br><code>è¿™å°±å¯¼è‡´ï¼Œåƒ Errorã€Array ç­‰å­ç±»ï¼Œä¹Ÿè®¸ä¸ä¼šå†å¦‚ä½ æœŸæœ›çš„é‚£æ ·è¿è¡Œã€‚è¿™æ˜¯å› ä¸º Errorã€Array ç­‰ç±»ä¼¼å†…ç½®å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œä¼šä½¿ç”¨ ECMAScript 6 çš„ new.target è°ƒæ•´åŸå‹é“¾ã€‚ç„¶è€Œï¼Œåœ¨ ECMAScript 5 ä¸­ï¼Œå½“è°ƒç”¨ä¸€ä¸ªæ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æ–¹æ³•å¯ä»¥ç¡®ä¿ new.target çš„å€¼ã€‚ å…¶ä»–çš„é™çº§ç¼–è¯‘å™¨é»˜è®¤ä¹Ÿä¼šæœ‰åŒæ ·çš„é™åˆ¶ã€‚</code><br>For a subclass like the following:<br><code>ä¸‹é¢çš„å­ç±»ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MsgError extends Error &#123;  constructor(m: string) &#123;    super(m);  &#125;  sayHello() &#123;    return &quot;hello &quot; + this.message;  &#125;&#125;</code></pre><p>you may find that:<br><code>ä½ ä¹Ÿè®¸å¯ä»¥å‘ç°ï¼š</code><br>methods may be undefined on objects returned by constructing these subclasses, so calling sayHello will result in an error.<br><code>å¯¹è±¡çš„æ–¹æ³•å¯èƒ½æ˜¯ undefined ï¼Œæ‰€ä»¥è°ƒç”¨ sayHello ä¼šå¯¼è‡´é”™è¯¯</code><br>instanceof will be broken between instances of the subclass and their instances, so (new MsgError()) instanceof MsgError will return false.<br><code>instanceof å¤±æ•ˆï¼Œ (new MsgError()) instanceof MsgError ä¼šè¿”å› falseã€‚</code><br>As a recommendation, you can manually adjust the prototype immediately after any super(â€¦) calls.<br><code>æˆ‘ä»¬æ¨èï¼Œæ‰‹åŠ¨çš„åœ¨ super(...) è°ƒç”¨åè°ƒæ•´åŸå‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MsgError extends Error &#123;  constructor(m: string) &#123;    super(m);    &#x2F;&#x2F; Set the prototype explicitly.    Object.setPrototypeOf(this, MsgError.prototype);  &#125;  sayHello() &#123;    return &quot;hello &quot; + this.message;  &#125;&#125;</code></pre><p>However, any subclass of MsgError will have to manually set the prototype as well. For runtimes that donâ€™t support Object.setPrototypeOf, you may instead be able to use <code>__proto__</code>.<br><code>ä¸è¿‡ï¼Œä»»ä½• MsgError çš„å­ç±»ä¹Ÿä¸å¾—ä¸æ‰‹åŠ¨è®¾ç½®åŸå‹ã€‚å¦‚æœè¿è¡Œæ—¶ä¸æ”¯æŒ Object.setPrototypeOfï¼Œä½ ä¹Ÿè®¸å¯ä»¥ä½¿ç”¨ __proto__ </code></p><p>Unfortunately, these workarounds will not work on Internet Explorer 10 and prior. One can manually copy methods from the prototype onto the instance itself (i.e. MsgError.prototype onto this), but the prototype chain itself cannot be fixed.<br><code>ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›æ–¹æ¡ˆå¹¶ä¸ä¼šèƒ½åœ¨ IE 10 æˆ–è€…ä¹‹å‰çš„ç‰ˆæœ¬æ­£å¸¸è¿è¡Œã€‚è§£å†³çš„ä¸€ä¸ªæ–¹æ³•æ˜¯æ‰‹åŠ¨æ‹·è´åŸå‹ä¸­çš„æ–¹æ³•åˆ°å®ä¾‹ä¸­ï¼ˆå°±æ¯”å¦‚ MsgError.prototype åˆ° thisï¼‰ï¼Œä½†æ˜¯å®ƒè‡ªå·±çš„åŸå‹é“¾ä¾ç„¶æ²¡æœ‰è¢«ä¿®å¤</code></p><h2 id="Member-Visibility"><a href="#Member-Visibility" class="headerlink" title="Member Visibility"></a>Member Visibility</h2><p><code>æˆå‘˜å¯è§æ€§</code><br>You can use TypeScript to control whether certain methods or properties are visible to code outside the class.<br><code>ä½ å¯ä»¥ä½¿ç”¨ TypeScript æ§åˆ¶æŸä¸ªæ–¹æ³•æˆ–è€…å±æ€§æ˜¯å¦å¯¹ç±»ä»¥å¤–çš„ä»£ç å¯è§ã€‚</code></p><h3 id="public"><a href="#public" class="headerlink" title="public"></a>public</h3><p>The default visibility of class members is public. A public member can be accessed anywhere:<br><code>å› ä¸º public æ˜¯é»˜è®¤çš„å¯è§æ€§ä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦å†™å®ƒï¼Œé™¤éå¤„äºæ ¼å¼æˆ–è€…å¯è¯»æ€§çš„åŸå› ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Greeter &#123;  public greet() &#123;    console.log(&quot;hi!&quot;);  &#125;&#125;const g &#x3D; new Greeter();g.greet();</code></pre><p>Because public is already the default visibility modifier, you donâ€™t ever need to write it on a class member, but might choose to do so for style&#x2F;readability reasons.<br><code>å› ä¸º public æ˜¯é»˜è®¤çš„å¯è§æ€§ä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦å†™å®ƒï¼Œé™¤éå¤„äºæ ¼å¼æˆ–è€…å¯è¯»æ€§çš„åŸå› ã€‚</code></p><h3 id="protected"><a href="#protected" class="headerlink" title="protected"></a>protected</h3><p>protected members are only visible to subclasses of the class theyâ€™re declared in.<br><code>protected æˆå‘˜ä»…ä»…å¯¹å­ç±»å¯è§</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Greeter &#123;  public greet() &#123;    console.log(&quot;Hello, &quot; + this.getName());  &#125;  protected getName() &#123;    return &quot;hi&quot;;  &#125;&#125;class SpecialGreeter extends Greeter &#123;  public howdy() &#123;    &#x2F;&#x2F; OK to access protected member here    console.log(&quot;Howdy, &quot; + this.getName());  &#125;&#125;const g &#x3D; new SpecialGreeter();g.greet(); &#x2F;&#x2F; OKg.getName();&#x2F;&#x2F; Property &#39;getName&#39; is protected and only accessible within class &#39;Greeter&#39; and its subclasses.</code></pre><h3 id="Exposure-of-protected-members"><a href="#Exposure-of-protected-members" class="headerlink" title="Exposure of protected members"></a>Exposure of protected members</h3><p><code>å—ä¿æŠ¤æˆå‘˜çš„å…¬å¼€</code></p><p>Derived classes need to follow their base class contracts, but may choose to expose a subtype of base class with more capabilities. This includes making protected members public:<br><code>æ´¾ç”Ÿç±»éœ€è¦éµå¾ªåŸºç±»çš„å®ç°ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥é€‰æ‹©å…¬å¼€æ‹¥æœ‰æ›´å¤šèƒ½åŠ›çš„åŸºç±»å­ç±»å‹ï¼Œè¿™å°±åŒ…æ‹¬è®©ä¸€ä¸ª protected æˆå‘˜å˜æˆ publicï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Base &#123;  protected m &#x3D; 10;&#125;class Derived extends Base &#123;  &#x2F;&#x2F; No modifier, so default is &#39;public&#39;  m &#x3D; 15;&#125;const d &#x3D; new Derived();console.log(d.m); &#x2F;&#x2F; OK</code></pre><p>Note that Derived was already able to freely read and write m, so this doesnâ€™t meaningfully alter the â€œsecurityâ€ of this situation. The main thing to note here is that in the derived class, we need to be careful to repeat the protected modifier if this exposure isnâ€™t intentional.<br><code>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå…¬å¼€ä¸æ˜¯æ•…æ„çš„ï¼Œåœ¨è¿™ä¸ªæ´¾ç”Ÿç±»ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°å¿ƒçš„æ‹·è´ protected ä¿®é¥°ç¬¦ã€‚</code></p><h3 id="Cross-hierarchy-protected-access"><a href="#Cross-hierarchy-protected-access" class="headerlink" title="Cross-hierarchy protected access"></a>Cross-hierarchy protected access</h3><p><code>äº¤å‰ç­‰çº§å—ä¿æŠ¤æˆå‘˜è®¿é—®</code></p><p>Different OOP languages disagree about whether itâ€™s legal to access a protected member through a base class reference:</p><p><code>ä¸åŒçš„ OOP è¯­è¨€åœ¨é€šè¿‡ä¸€ä¸ªåŸºç±»å¼•ç”¨æ˜¯å¦å¯ä»¥åˆæ³•çš„è·å–ä¸€ä¸ª protected æˆå‘˜æ˜¯æœ‰äº‰è®®çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Base &#123;  protected x: number &#x3D; 1;&#125;class Derived1 extends Base &#123;  protected x: number &#x3D; 5;&#125;class Derived2 extends Base &#123;  f1(other: Derived2) &#123;    other.x &#x3D; 10;  &#125;  f2(other: Base) &#123;    other.x &#x3D; 10;    &#x2F;&#x2F; Property &#39;x&#39; is protected and only accessible through an instance of class &#39;Derived2&#39;. This is an instance of class &#39;Base&#39;.    &#x2F;&#x2F; å±æ€§ &#39;x&#39; å—ä¿æŠ¤å¹¶ä¸”åªèƒ½é€šè¿‡ç±» &#39;Derived2&#39; çš„å®ä¾‹è®¿é—®ã€‚è¿™æ˜¯ä¸€ä¸ªç±» &#39;Base&#39; çš„å®ä¾‹ã€‚  &#125;&#125;</code></pre><p>Java, for example, considers this to be legal. On the other hand, C# and C++ chose that this code should be illegal.<br><code>åœ¨ Java ä¸­ï¼Œè¿™æ˜¯åˆæ³•çš„ï¼Œè€Œ C# å’Œ C++ è®¤ä¸ºè¿™æ®µä»£ç æ˜¯ä¸åˆæ³•çš„ã€‚</code><br>TypeScript sides with C# and C++ here, because accessing x in Derived2 should only be legal from Derived2â€™s subclasses, and Derived1 isnâ€™t one of them. Moreover, if accessing x through a Derived1 reference is illegal (which it certainly should be!), then accessing it through a base class reference should never improve the situation.<br><code>TypeScript ç«™åœ¨ C# å’Œ C++ è¿™è¾¹ã€‚å› ä¸º Derived2 çš„ x åº”è¯¥åªæœ‰ä» Derived2 çš„å­ç±»è®¿é—®æ‰æ˜¯åˆæ³•çš„ï¼Œè€Œ Derived1 å¹¶ä¸æ˜¯å®ƒä»¬ä¸­çš„ä¸€ä¸ªã€‚æ­¤å¤–ï¼Œå¦‚æœé€šè¿‡ Derived1 è®¿é—® x æ˜¯ä¸åˆæ³•çš„ï¼Œé€šè¿‡ä¸€ä¸ªåŸºç±»å¼•ç”¨è®¿é—®ä¹Ÿåº”è¯¥æ˜¯ä¸åˆæ³•çš„ã€‚</code><br>See also Why Canâ€™t I Access A Protected Member From A Derived Class? which explains more of C#â€˜s reasoning.<br><code>çœ‹è¿™ç¯‡ã€ŠWhy Canâ€™t I Access A Protected Member From A Derived Class?ã€‹ (opens new window)ï¼Œè§£é‡Šäº†æ›´å¤š C# è¿™æ ·åšçš„åŸå› ã€‚</code></p><h3 id="private"><a href="#private" class="headerlink" title="private"></a>private</h3><p>private is like protected, but doesnâ€™t allow access to the member even from subclasses:<br><code>private æœ‰ç‚¹åƒ protected ï¼Œä½†æ˜¯ä¸å…è®¸è®¿é—®æˆå‘˜ï¼Œå³ä¾¿æ˜¯å­ç±»ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Base &#123;  private x &#x3D; 0;&#125;const b &#x3D; new Base();&#x2F;&#x2F; Can&#39;t access from outside the class&#x2F;&#x2F; ä¸èƒ½ä»å¤–éƒ¨è®¿é—®console.log(b.x);&#x2F;&#x2F; Property &#39;x&#39; is private and only accessible within class &#39;Base&#39;.&#x2F;&#x2F; å±æ€§ &#39;x&#39; æ˜¯ç§æœ‰çš„ï¼Œåªèƒ½åœ¨ç±» &#39;Base&#39; ä¸­è®¿é—®ã€‚</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Derived extends Base &#123;  showX() &#123;    &#x2F;&#x2F; Can&#39;t access in subclasses    console.log(this.x);    &#x2F;&#x2F; Property &#39;x&#39; is private and only accessible within class &#39;Base&#39;.    &#x2F;&#x2F; å±æ€§ &#39;x&#39; æ˜¯ç§æœ‰çš„ï¼Œåªèƒ½åœ¨ç±» &#39;Base&#39; ä¸­è®¿é—®ã€‚  &#125;&#125;</code></pre><p>Because private members arenâ€™t visible to derived classes, a derived class canâ€™t increase its visibility:<br><code>å› ä¸º private æˆå‘˜å¯¹æ´¾ç”Ÿç±»å¹¶ä¸å¯è§ï¼Œæ‰€ä»¥ä¸€ä¸ªæ´¾ç”Ÿç±»ä¹Ÿä¸èƒ½å¢åŠ å®ƒçš„å¯è§æ€§ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Base &#123;  private x &#x3D; 0;&#125;class Derived extends Base &#123;  &#x2F;&#x2F; Class &#39;Derived&#39; incorrectly extends base class &#39;Base&#39;.  &#x2F;&#x2F; ç±» &#39;Derived&#39; é”™è¯¯åœ°ç»§æ‰¿äº†åŸºç±» &#39;Base&#39;ã€‚  &#x2F;&#x2F; Property &#39;x&#39; is private in type &#39;Base&#39; but not in type &#39;Derived&#39;.  &#x2F;&#x2F; å±æ€§ &#39;x&#39; åœ¨ç±» &#39;Base&#39; ä¸­ï¼Œä½†ä¸åœ¨ç±» &#39;Derived&#39; ä¸­ã€‚  x &#x3D; 1;&#125;</code></pre><h3 id="Cross-instance-private-access"><a href="#Cross-instance-private-access" class="headerlink" title="Cross-instance private access"></a>Cross-instance private access</h3><p><code>äº¤å‰ç­‰çº§å—ä¿æŠ¤æˆå‘˜è®¿é—®</code><br>Different OOP languages disagree about whether different instances of the same class may access each othersâ€™ private members. While languages like Java, C#, C++, Swift, and PHP allow this, Ruby does not.<br><code>ä¸åŒçš„ OOP è¯­è¨€åœ¨é€šè¿‡ä¸€ä¸ªåŸºç±»å¼•ç”¨æ˜¯å¦å¯ä»¥åˆæ³•çš„è·å–ä¸€ä¸ª protected æˆå‘˜æ˜¯æœ‰äº‰è®®çš„ã€‚åœ¨ Java, C#, C++, Swift, and PHP ä¸­ï¼Œè¿™æ˜¯åˆæ³•çš„ï¼Œè€Œ Ruby è®¤ä¸ºè¿™æ®µä»£ç æ˜¯ä¸åˆæ³•çš„ã€‚</code><br>TypeScript does allow cross-instance private access:<br><code>å…è®¸äº¤å‰å®ä¾‹ç§æœ‰è®¿é—®</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class A &#123;  private x &#x3D; 10;  public sameAs(other: A) &#123;    &#x2F;&#x2F; No error    return other.x &#x3D;&#x3D;&#x3D; this.x;  &#125;&#125;</code></pre><h3 id="Caveats"><a href="#Caveats" class="headerlink" title="Caveats"></a>Caveats</h3><p><code>è­¦å‘Š</code></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Like other aspects of TypeScriptâ€™s type system, private and protected are only enforced during type checking.<br><code>ç±»å‹æ£€æŸ¥ä¸­ï¼Œprivate å’Œ protected åªæ˜¯ç±»å‹æ£€æŸ¥çš„ä¸€éƒ¨åˆ†ã€‚</code></p></blockquote><p>This means that JavaScript runtime constructs like in or simple property lookup can still access a private or protected member:<br><code>è¿™æ„å‘³ç€åœ¨ JavaScript è¿è¡Œæ—¶ï¼Œåƒ in æˆ–è€…ç®€å•çš„å±æ€§æŸ¥æ‰¾ï¼Œä¾ç„¶å¯ä»¥è·å– private æˆ–è€… protected æˆå‘˜ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MySafe &#123;  private secretKey &#x3D; 12345;&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; In a JavaScript file...const s &#x3D; new MySafe();&#x2F;&#x2F; Will print 12345console.log(s.secretKey);</code></pre><p>private also allows access using bracket notation during type checking. This makes private-declared fields potentially easier to access for things like unit tests, with the drawback that these fields are soft private and donâ€™t strictly enforce privacy.<br><code>private ä¹Ÿå…è®¸ä½¿ç”¨æ–¹æ‹¬å·æ¥è®¿é—®ï¼Œè¿™ä½¿å¾— private-declared å­—æ®µå¯ä»¥è½»æ¾åœ°è®¿é—®ï¼Œä½†æ˜¯è¿™äº›å­—æ®µæ˜¯è½¯ç§æœ‰çš„ï¼Œå¹¶ä¸å¼ºåˆ¶ç§å¯†ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MySafe &#123;private secretKey &#x3D; 12345;&#125;const s &#x3D; new MySafe();&#x2F;&#x2F; Not allowed during type checkingconsole.log(s.secretKey);Property &#39;secretKey&#39; is private and only accessible within class &#39;MySafe&#39;.&#x2F;&#x2F; OKconsole.log(s[&quot;secretKey&quot;]);</code></pre><p>Unlike TypeScriptsâ€™s private, JavaScriptâ€™s private fields (#) remain private after compilation and do not provide the previously mentioned escape hatches like bracket notation access, making them hard private.<br><code>ä¸åƒ TypeScript çš„ privateï¼ŒJavaScript çš„ç§æœ‰å­—æ®µ (opens new window)ï¼ˆ#ï¼‰å³ä¾¿æ˜¯ç¼–è¯‘åä¾ç„¶ä¿ç•™ç§æœ‰æ€§ï¼Œå¹¶ä¸”ä¸ä¼šæä¾›åƒä¸Šé¢è¿™ç§æ–¹æ‹¬å·è·å–çš„æ–¹æ³•ï¼Œè¿™è®©å®ƒä»¬å˜å¾—å¼ºç§æœ‰ï¼ˆhard privateï¼‰ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Dog &#123;  #barkAmount &#x3D; 0;  personality &#x3D; &quot;happy&quot;;  constructor() &#123;&#125;&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&quot;use strict&quot;;class Dog &#123;  #barkAmount &#x3D; 0;  personality &#x3D; &quot;happy&quot;;  constructor() &#123;&#125;&#125;</code></pre><p>When compiling to ES2021 or less, TypeScript will use WeakMaps in place of #.<br><code>åœ¨ç¼–è¯‘åˆ° ES2021 æˆ–æ›´ä½ç‰ˆæœ¬æ—¶ï¼ŒTypeScript ä¼šä½¿ç”¨ WeakMaps æ›¿ä»£ #ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&quot;use strict&quot;;var _Dog_barkAmount;class Dog &#123;  constructor() &#123;    _Dog_barkAmount.set(this, 0);    this.personality &#x3D; &quot;happy&quot;;  &#125;&#125;_Dog_barkAmount &#x3D; new WeakMap();</code></pre><p>If you need to protect values in your class from malicious actors, you should use mechanisms that offer hard runtime privacy, such as closures, WeakMaps, or private fields. Note that these added privacy checks during runtime could affect performance.<br><code>å¦‚æœä½ éœ€è¦é˜²æ­¢æ¶æ„æ”»å‡»ï¼Œä¿æŠ¤ç±»ä¸­çš„å€¼ï¼Œä½ åº”è¯¥ä½¿ç”¨å¼ºç§æœ‰çš„æœºåˆ¶æ¯”å¦‚é—­åŒ…ï¼ŒWeakMaps ï¼Œæˆ–è€…ç§æœ‰å­—æ®µã€‚ä½†æ˜¯æ³¨æ„ï¼Œè¿™ä¹Ÿä¼šåœ¨è¿è¡Œæ—¶å½±å“æ€§èƒ½ã€‚</code></p><h2 id="Static-Members"><a href="#Static-Members" class="headerlink" title="Static Members"></a>Static Members</h2><p><code>é™æ€æˆå‘˜</code></p><p>Background Reading: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static">Static Members (MDN)</a></p><p>Classes may have static members. These members arenâ€™t associated with a particular instance of the class. They can be accessed through the class constructor object itself:<br><code>ç±»å¯ä»¥æœ‰é™æ€æˆå‘˜ï¼Œé™æ€æˆå‘˜è·Ÿç±»å®ä¾‹æ²¡æœ‰å…³ç³»ï¼Œå¯ä»¥é€šè¿‡ç±»æœ¬èº«è®¿é—®åˆ°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MyClass &#123;  static x &#x3D; 0;  static printX() &#123;    console.log(MyClass.x);  &#125;&#125;console.log(MyClass.x);MyClass.printX();</code></pre><p>Static members can also use the same public, protected, and private visibility modifiers:<br><code>ç±»å¯ä»¥æœ‰é™æ€æˆå‘˜ï¼Œé™æ€æˆå‘˜è·Ÿç±»å®ä¾‹æ²¡æœ‰å…³ç³»ï¼Œå¯ä»¥é€šè¿‡ç±»æœ¬èº«è®¿é—®åˆ°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MyClass &#123;  private static x &#x3D; 0;&#125;console.log(MyClass.x);&#x2F;&#x2F; Property &#39;x&#39; is private and only accessible within class &#39;MyClass&#39;.</code></pre><h3 id="Static-members-are-also-inherited"><a href="#Static-members-are-also-inherited" class="headerlink" title="Static members are also inherited:"></a>Static members are also inherited:</h3><p><code>é™æ€æˆå‘˜ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Base &#123;  static getGreeting() &#123;    return &quot;Hello world&quot;;  &#125;&#125;class Derived extends Base &#123;  myGreeting &#x3D; Derived.getGreeting();&#125;</code></pre><h3 id="Special-Static-Names"><a href="#Special-Static-Names" class="headerlink" title="Special Static Names"></a>Special Static Names</h3><p><code>ç‰¹æ®Šé™æ€ç±»</code><br>Itâ€™s generally not safe&#x2F;possible to overwrite properties from the Function prototype. Because classes are themselves functions that can be invoked with new, certain static names canâ€™t be used. Function properties like name, length, and call arenâ€™t valid to define as static members:<br><code>ç±»æœ¬èº«æ˜¯å‡½æ•°ï¼Œè€Œè¦†å†™ Function åŸå‹ä¸Šçš„å±æ€§é€šå¸¸è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨ä¸€äº›å›ºå®šçš„é™æ€åç§°ï¼Œå‡½æ•°å±æ€§åƒ nameã€lengthã€call ä¸èƒ½è¢«ç”¨æ¥å®šä¹‰ static æˆå‘˜ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class S &#123;  static name &#x3D; &quot;S!&quot;;  &#x2F;&#x2F; Static property &#39;name&#39; conflicts with built-in property &#39;Function.name&#39; of constructor function &#39;S&#39;.&#125;</code></pre><h3 id="Why-No-Static-Classes"><a href="#Why-No-Static-Classes" class="headerlink" title="Why No Static Classes?"></a>Why No Static Classes?</h3><p><code>ä¸ºä»€ä¹ˆæ²¡æœ‰é™æ€ç±»ï¼Ÿ</code></p><p>TypeScript (and JavaScript) donâ€™t have a construct called static class the same way as, for example, C# does.<br><code>TypeScriptï¼ˆå’Œ JavaScriptï¼‰ å¹¶æ²¡æœ‰åä¸ºé™æ€ç±»ï¼ˆstatic classï¼‰çš„ç»“æ„ï¼Œä½†æ˜¯åƒ C# å’Œ Java æœ‰ã€‚</code><br>Those constructs only exist because those languages force all data and functions to be inside a class; because that restriction doesnâ€™t exist in TypeScript, thereâ€™s no need for them. A class with only a single instance is typically just represented as a normal object in JavaScript&#x2F;TypeScript.<br><code>æ‰€è°“é™æ€ç±»ï¼ŒæŒ‡çš„æ˜¯ä½œä¸ºç±»çš„é™æ€æˆå‘˜å­˜åœ¨äºæŸä¸ªç±»çš„å†…éƒ¨çš„ç±»ã€‚æ¯”å¦‚è¿™ç§ï¼š</code><br>For example, we donâ€™t need a â€œstatic classâ€ syntax in TypeScript because a regular object (or even top-level function) will do the job just as well:<br><code>é™æ€ç±»ä¹‹æ‰€ä»¥å­˜åœ¨æ˜¯å› ä¸ºè¿™äº›è¯­è¨€å¼ºè¿«æ‰€æœ‰çš„æ•°æ®å’Œå‡½æ•°éƒ½è¦åœ¨ä¸€ä¸ªç±»å†…éƒ¨ï¼Œä½†è¿™ä¸ªé™åˆ¶åœ¨ TypeScript ä¸­å¹¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰é™æ€ç±»çš„éœ€è¦ã€‚ä¸€ä¸ªåªæœ‰ä¸€ä¸ªå•ç‹¬å®ä¾‹çš„ç±»ï¼Œåœ¨ JavaScript/TypeScript ä¸­ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨æ™®é€šçš„å¯¹è±¡æ›¿ä»£ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Unnecessary &quot;static&quot; classclass MyStaticClass &#123;  static doSomething() &#123;&#125;&#125;&#x2F;&#x2F; Preferred (alternative 1)function doSomething() &#123;&#125;&#x2F;&#x2F; Preferred (alternative 2)const MyHelperObject &#x3D; &#123;  dosomething() &#123;&#125;,&#125;;</code></pre><h2 id="static-Blocks-in-Classes"><a href="#static-Blocks-in-Classes" class="headerlink" title="static Blocks in Classes"></a>static Blocks in Classes</h2><p><code>ç±»é™æ€å—</code><br>Static blocks allow you to write a sequence of statements with their own scope that can access private fields within the containing class. This means that we can write initialization code with all the capabilities of writing statements, no leakage of variables, and full access to our classâ€™s internals.<br><code>é™æ€å—å…è®¸ä½ å†™ä¸€ç³»åˆ—æœ‰è‡ªå·±ä½œç”¨åŸŸçš„è¯­å¥ï¼Œä¹Ÿå¯ä»¥è·å–ç±»é‡Œçš„ç§æœ‰å­—æ®µã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å®‰å¿ƒçš„å†™åˆå§‹åŒ–ä»£ç ï¼šæ­£å¸¸ä¹¦å†™è¯­å¥ï¼Œæ— å˜é‡æ³„æ¼ï¼Œè¿˜å¯ä»¥å®Œå…¨è·å–ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Foo &#123;  static #count &#x3D; 0;  get count() &#123;    return Foo.#count;  &#125;  static &#123;    try &#123;      const lastInstances &#x3D; loadLastInstances();      Foo.#count +&#x3D; lastInstances.length;    &#125; catch &#123;&#125;  &#125;&#125;</code></pre><h3 id="Generic-Classes"><a href="#Generic-Classes" class="headerlink" title="Generic Classes"></a>Generic Classes</h3><p><code>èŒƒå‹ç±»</code></p><p>Classes, much like interfaces, can be generic. When a generic class is instantiated with new, its type parameters are inferred the same way as in a function call:<br><code>ç±»è·Ÿæ¥å£ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å†™æ³›å‹ã€‚å½“ä½¿ç”¨ new å®ä¾‹åŒ–ä¸€ä¸ªæ³›å‹ç±»ï¼Œå®ƒçš„ç±»å‹å‚æ•°çš„æ¨æ–­è·Ÿå‡½æ•°è°ƒç”¨æ˜¯åŒæ ·çš„æ–¹å¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Box&lt;Type&gt; &#123;  contents: Type;  constructor(value: Type) &#123;    this.contents &#x3D; value;  &#125;&#125;const b &#x3D; new Box(&quot;hello!&quot;);const b: Box&lt;string&gt;;</code></pre><p>Classes can use generic constraints and defaults the same way as interfaces.<br><code>ç±»è·Ÿæ¥å£ä¸€æ ·ä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å‹çº¦æŸä»¥åŠé»˜è®¤å€¼ã€‚</code></p><h3 id="Type-Parameters-in-Static-Members"><a href="#Type-Parameters-in-Static-Members" class="headerlink" title="Type Parameters in Static Members"></a>Type Parameters in Static Members</h3><p><code>é™æ€æˆå‘˜ä¸­çš„ç±»å‹å‚æ•°</code><br>This code isnâ€™t legal, and it may not be obvious why:<br><code>è¿™æ®µä»£ç ä¸åˆæ³•ï¼Œå¹¶ä¸”å¯èƒ½ä¸æ˜ç™½ä¸ºä»€ä¹ˆï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Box&lt;Type&gt; &#123;static defaultValue: Type;Static members cannot reference class type parameters.&#125;</code></pre><p>Remember that types are always fully erased! At runtime, thereâ€™s only one Box.defaultValue property slot. This means that setting Box<string>.defaultValue (if that were possible) would also change Box<number>.defaultValue - not good. The static members of a generic class can never refer to the classâ€™s type parameters.<br><code>è®°ä½ç±»å‹ä¼šè¢«å®Œå…¨æŠ¹é™¤ï¼Œè¿è¡Œæ—¶ï¼Œåªæœ‰ä¸€ä¸ª Box.defaultValue å±æ€§æ§½ã€‚è¿™ä¹Ÿæ„å‘³ç€å¦‚æœè®¾ç½® Box&lt;string&gt;.defaultValue æ˜¯å¯ä»¥çš„è¯ï¼Œè¿™ä¹Ÿä¼šæ”¹å˜ Box&lt;number&gt;.defaultValueï¼Œè€Œè¿™æ ·æ˜¯ä¸å¥½çš„ã€‚</code></p><h3 id="this-at-Runtime-in-Classes"><a href="#this-at-Runtime-in-Classes" class="headerlink" title="this at Runtime in Classes"></a>this at Runtime in Classes</h3><p>Background Reading:<br><code>èƒŒæ™¯é˜…è¯»ï¼š</code><br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this">this keyword (MDN)</a><br>Itâ€™s important to remember that TypeScript doesnâ€™t change the runtime behavior of JavaScript, and that JavaScript is somewhat famous for having some peculiar runtime behaviors.<br><code>TypeScript å¹¶ä¸ä¼šæ›´æ”¹ JavaScript è¿è¡Œæ—¶çš„è¡Œä¸ºï¼Œå¹¶ä¸” JavaScript æœ‰æ—¶ä¼šå‡ºç°ä¸€äº›å¥‡æ€ªçš„è¿è¡Œæ—¶è¡Œä¸ºã€‚</code><br>JavaScriptâ€™s handling of this is indeed unusual:<br><code>å°±æ¯”å¦‚ JavaScript å¤„ç† this å°±å¾ˆå¥‡æ€ªï¼š</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">class MyClass &#123;  name &#x3D; &quot;MyClass&quot;;  getName() &#123;    return this.name;  &#125;&#125;const c &#x3D; new MyClass();const obj &#x3D; &#123;  name: &quot;obj&quot;,  getName: c.getName,&#125;;&#x2F;&#x2F; Prints &quot;obj&quot;, not &quot;MyClass&quot;console.log(obj.getName());</code></pre><p>Long story short, by default, the value of this inside a function depends on how the function was called. In this example, because the function was called through the obj reference, its value of this was obj rather than the class instance.<br><code>é•¿ç¯‡å¤§è®ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨çš„ this å€¼å–å†³äºå‡½æ•°è¢«è°ƒç”¨çš„æ–¹å¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå› ä¸ºå‡½æ•°è¢« obj å¼•ç”¨è°ƒç”¨ï¼Œå®ƒçš„ this å€¼æ˜¯ objï¼Œè€Œä¸æ˜¯ç±»å®ä¾‹ã€‚</code><br>This is rarely what you want to happen! TypeScript provides some ways to mitigate or prevent this kind of error.<br><code>è¿™å¾ˆå°‘æ˜¯ä½ æƒ³è¦çš„ï¼TypeScript æä¾›äº†ä¸€äº›æ–¹æ³•æ¥è§£å†³è¿™ç§é”™è¯¯ã€‚</code></p><h3 id="Arrow-Functions"><a href="#Arrow-Functions" class="headerlink" title="Arrow Functions"></a>Arrow Functions</h3><p>Background Reading:<br><code>èƒŒæ™¯é˜…è¯»ï¼š</code><br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">Arrow functions (MDN)</a></p><p>If you have a function that will often be called in a way that loses its this context, it can make sense to use an arrow function property instead of a method definition:<br><code>å¦‚æœä½ æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œç»å¸¸åœ¨è¢«è°ƒç”¨çš„æ—¶å€™ä¸¢å¤± this ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ä¸€ä¸ªç®­å¤´å‡½æ•°æˆ–è®¸æ›´å¥½äº›ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MyClass &#123;  name &#x3D; &quot;MyClass&quot;;  getName &#x3D; () &#x3D;&gt; &#123;    return this.name;  &#125;;&#125;const c &#x3D; new MyClass();const g &#x3D; c.getName;&#x2F;&#x2F; Prints &quot;MyClass&quot; instead of crashingconsole.log(g());</code></pre><p>This has some trade-offs:<br><code>è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ä¸‹ï¼š</code></p><ul><li>The this value is guaranteed to be correct at runtime, even for code not checked with TypeScript<br><code>- è¿™ä¸ª this å€¼åœ¨è¿è¡Œæ—¶æ˜¯ä¸€å®šçš„ï¼Œå³ä½¿æ²¡æœ‰ TypeScript çš„æ£€æŸ¥</code></li><li>This will use more memory, because each class instance will have its own copy of each function defined this way<br><code>- è¿™ä¼šä½¿ç”¨æ›´å¤šçš„å†…å­˜ï¼Œå› ä¸ºæ¯ä¸ªç±»å®ä¾‹éƒ½ä¼šæœ‰è‡ªå·±çš„æ‹·è´</code></li><li>You canâ€™t use super.getName in a derived class, because thereâ€™s no entry in the prototype chain to fetch the base class method from<br><code>- ä½ ä¸èƒ½åœ¨å­ç±»ä¸­ä½¿ç”¨ super.getNameï¼Œå› ä¸ºæ²¡æœ‰åŸºç±»åŸå‹é“¾æ¥è·å–åŸºç±»æ–¹æ³•</code></li></ul><h3 id="this-parameters"><a href="#this-parameters" class="headerlink" title="this parameters"></a>this parameters</h3><p>In a method or function definition, an initial parameter named this has special meaning in TypeScript. These parameters are erased during compilation:<br><code>åœ¨æ–¹æ³•æˆ–å‡½æ•°å®šä¹‰ä¸­ï¼Œä¸€ä¸ªåˆå§‹å‚æ•°åä¸º this çš„ç‰¹æ®Šæ„ä¹‰åœ¨ TypeScript ä¸­ã€‚è¿™äº›å‚æ•°åœ¨ç¼–è¯‘æœŸé—´ä¼šè¢«æŠ¹é™¤ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; TypeScript input with &#39;this&#39; parameterfunction fn(this: SomeType, x: number) &#123;  &#x2F;* ... *&#x2F;&#125;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; JavaScript outputfunction fn(x) &#123;  &#x2F;* ... *&#x2F;&#125;</code></pre><p>TypeScript checks that calling a function with a this parameter is done so with a correct context. Instead of using an arrow function, we can add a this parameter to method definitions to statically enforce that the method is called correctly:<br><code>TypeScript ä¼šæ£€æŸ¥ä¸€ä¸ªæœ‰ this å‚æ•°çš„å‡½æ•°åœ¨è°ƒç”¨æ—¶æ˜¯å¦æœ‰ä¸€ä¸ªæ­£ç¡®çš„ä¸Šä¸‹æ–‡ã€‚ä¸åƒä¸Šä¸ªä¾‹å­ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ–¹æ³•å®šä¹‰æ·»åŠ ä¸€ä¸ª this å‚æ•°ï¼Œé™æ€å¼ºåˆ¶æ–¹æ³•è¢«æ­£ç¡®è°ƒç”¨ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class MyClass &#123;  name &#x3D; &quot;MyClass&quot;;  getName(this: MyClass) &#123;    return this.name;  &#125;&#125;const c &#x3D; new MyClass();&#x2F;&#x2F; OKc.getName();&#x2F;&#x2F; Error, would crashconst g &#x3D; c.getName;console.log(g());&#x2F;&#x2F; The &#39;this&#39; context of type &#39;void&#39; is not assignable to method&#39;s &#39;this&#39; of type &#39;MyClass&#39;.</code></pre><p>This method makes the opposite trade-offs of the arrow function approach:<br><code>è¿™ä¸ªæ–¹æ³•ä¹Ÿæœ‰ä¸€äº›æ³¨æ„ç‚¹ï¼Œæ­£å¥½è·Ÿç®­å¤´å‡½æ•°ç›¸åï¼š</code></p><ul><li>JavaScript callers might still use the class method incorrectly without realizing it<br><code>JavaScript è°ƒç”¨è€…ä¾ç„¶å¯èƒ½åœ¨æ²¡æœ‰æ„è¯†åˆ°å®ƒçš„æ—¶å€™é”™è¯¯ä½¿ç”¨ç±»æ–¹æ³•</code></li><li>Only one function per class definition gets allocated, rather than one per class instance<br><code>æ¯ä¸ªç±»ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯æ¯ä¸€ä¸ªç±»å®ä¾‹ä¸€ä¸ªå‡½æ•°</code></li><li>Base method definitions can still be called via super.<br><code>åŸºç±»æ–¹æ³•å®šä¹‰ä¾ç„¶å¯ä»¥é€šè¿‡ super è°ƒç”¨</code></li></ul><h3 id="this-Types"><a href="#this-Types" class="headerlink" title="this Types"></a>this Types</h3><p>In classes, a special type called this refers dynamically to the type of the current class. Letâ€™s see how this is useful:<br><code>åœ¨ç±»ä¸­ï¼Œä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹å«åš thisï¼Œå®ƒå¯ä»¥åŠ¨æ€æŒ‡å‘å½“å‰ç±»çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Box &#123;  contents: string &#x3D; &quot;&quot;;  set(value: string) &#123;    &#x2F;&#x2F; (method) Box.set(value: string): this    this.contents &#x3D; value;    return this;  &#125;&#125;</code></pre><p>Here, TypeScript inferred the return type of set to be this, rather than Box. Now letâ€™s make a subclass of Box:<br><code>è¿™é‡Œï¼ŒTypeScript æ¨æ–­ set çš„è¿”å›ç±»å‹ä¸º thisï¼Œè€Œä¸æ˜¯ Boxã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class ClearableBox extends Box &#123;  clear() &#123;    this.contents &#x3D; &quot;&quot;;  &#125;&#125;const a &#x3D; new ClearableBox();const b &#x3D; a.set(&quot;hello&quot;);&#x2F;&#x2F; const b: ClearableBox</code></pre><p>You can also use this in a parameter type annotation:<br><code>ä½ ä¹Ÿå¯ä»¥åœ¨å‚æ•°ç±»å‹æ³¨è§£ä¸­ä½¿ç”¨ thisï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Box &#123;  content: string &#x3D; &quot;&quot;;  sameAs(other: this) &#123;    return other.content &#x3D;&#x3D;&#x3D; this.content;  &#125;&#125;</code></pre><p>This is different from writing other: Box â€” if you have a derived class, its sameAs method will now only accept other instances of that same derived class:<br><code>è¿™ä¸å†™å…¶ä»–ï¼šBox â€” å¦‚æœä½ æœ‰ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œå®ƒçš„ sameAs æ–¹æ³•å°†åªæ¥å—æ¥è‡ªåŒä¸€æ´¾ç”Ÿç±»çš„å…¶ä»–å®ä¾‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Box &#123;  content: string &#x3D; &quot;&quot;;  sameAs(other: this) &#123;    return other.content &#x3D;&#x3D;&#x3D; this.content;  &#125;&#125;class DerivedBox extends Box &#123;  otherContent: string &#x3D; &quot;?&quot;;&#125;const base &#x3D; new Box();const derived &#x3D; new DerivedBox();derived.sameAs(base);&#x2F;&#x2F; Argument of type &#39;Box&#39; is not assignable to parameter of type &#39;DerivedBox&#39;.&#x2F;&#x2F; Property &#39;otherContent&#39; is missing in type &#39;Box&#39; but required in type &#39;DerivedBox&#39;.</code></pre><h3 id="this-based-type-guards"><a href="#this-based-type-guards" class="headerlink" title="this -based type guards"></a>this -based type guards</h3><p>You can use this is Type in the return position for methods in classes and interfaces. When mixed with a type narrowing (e.g. if statements) the type of the target object would be narrowed to the specified Type.<br><code>ä½ å¯ä»¥åœ¨ç±»å’Œæ¥å£ä¸­çš„æ–¹æ³•çš„è¿”å›ä½ç½®ä½¿ç”¨ thisã€‚å½“æ··å…¥ä¸€ä¸ªç±»å‹ç¼©å°ï¼ˆå¦‚ if è¯­å¥ï¼‰çš„æ—¶å€™ï¼Œç›®æ ‡å¯¹è±¡çš„ç±»å‹å°†è¢«ç¼©å°åˆ°æŒ‡å®šçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class FileSystemObject &#123;  isFile(): this is FileRep &#123;    return this instanceof FileRep;  &#125;  isDirectory(): this is Directory &#123;    return this instanceof Directory;  &#125;  isNetworked(): this is Networked &amp; this &#123;    return this.networked;  &#125;  constructor(public path: string, private networked: boolean) &#123;&#125;&#125;class FileRep extends FileSystemObject &#123;  constructor(path: string, public content: string) &#123;    super(path, false);  &#125;&#125;class Directory extends FileSystemObject &#123;  children: FileSystemObject[];&#125;interface Networked &#123;  host: string;&#125;const fso: FileSystemObject &#x3D; new FileRep(&quot;foo&#x2F;bar.txt&quot;, &quot;foo&quot;);if (fso.isFile()) &#123;  fso.content;  &#x2F;&#x2F; const fso: FileRep;&#125; else if (fso.isDirectory()) &#123;  fso.children;  &#x2F;&#x2F; const fso: Directory;&#125; else if (fso.isNetworked()) &#123;  fso.host;  &#x2F;&#x2F; const fso: Networked &amp; FileSystemObject;&#125;</code></pre><p>A common use-case for a this-based type guard is to allow for lazy validation of a particular field. For example, this case removes an undefined from the value held inside box when hasValue has been verified to be true:<br><code>ä¸€ä¸ªå¸¸è§çš„åŸºäº this çš„ç±»å‹ä¿æŠ¤çš„ä½¿ç”¨ä¾‹å­ï¼Œä¼šå¯¹ä¸€ä¸ªç‰¹å®šçš„å­—æ®µè¿›è¡Œæ‡’æ ¡éªŒï¼ˆlazy validationï¼‰ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ hasValue è¢«éªŒè¯ä¸º true æ—¶ï¼Œä¼šä»ç±»å‹ä¸­ç§»é™¤ undefinedï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Box&lt;T&gt; &#123;value?: T;hasValue(): this is &#123; value: T &#125; &#123;return this.value !&#x3D;&#x3D; undefined;&#125;&#125;const box &#x3D; new Box();box.value &#x3D; &quot;Gameboy&quot;;box.value;(property) Box&lt;unknown&gt;.value?: unknownif (box.hasValue()) &#123;box.value;(property) value: unknown&#125;</code></pre><h2 id="Parameter-Properties"><a href="#Parameter-Properties" class="headerlink" title="Parameter Properties"></a>Parameter Properties</h2><p><code>å‚æ•°å±æ€§</code><br>TypeScript offers special syntax for turning a constructor parameter into a class property with the same name and value. These are called parameter properties and are created by prefixing a constructor argument with one of the visibility modifiers public, private, protected, or readonly. The resulting field gets those modifier(s):<br><code>TypeScript æä¾›äº†ç‰¹æ®Šçš„è¯­æ³•ï¼Œå¯ä»¥æŠŠä¸€ä¸ªæ„é€ å‡½æ•°å‚æ•°è½¬æˆä¸€ä¸ªåŒååŒå€¼çš„ç±»å±æ€§ã€‚è¿™äº›å°±è¢«ç§°ä¸ºå‚æ•°å±æ€§ï¼ˆparameter propertiesï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨æ„é€ å‡½æ•°å‚æ•°å‰æ·»åŠ ä¸€ä¸ªå¯è§æ€§ä¿®é¥°ç¬¦ public private protected æˆ–è€… readonly æ¥åˆ›å»ºå‚æ•°å±æ€§ï¼Œæœ€åè¿™äº›ç±»å±æ€§å­—æ®µä¹Ÿä¼šå¾—åˆ°è¿™äº›ä¿®é¥°ç¬¦ï¼š</code></p><p><strong>ä¹‹åæˆ‘ä»¬ look ä¸€ä¸‹ flutter,å¤ªåƒ</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Params &#123;  constructor(    public readonly x: number,    protected y: number,    private z: number  ) &#123;    &#x2F;&#x2F; No body necessary  &#125;&#125;const a &#x3D; new Params(1, 2, 3);console.log(a.x);&#x2F;&#x2F; (property) Params.x: numberconsole.log(a.z);&#x2F;&#x2F; Property &#39;z&#39; is private and only accessible within class &#39;Params&#39;.</code></pre><h2 id="Class-Expressions"><a href="#Class-Expressions" class="headerlink" title="Class Expressions"></a>Class Expressions</h2><p><code>ç±»è¡¨è¾¾å¼</code></p><p>Background Reading:<br><code>èƒŒæ™¯é˜…è¯»ï¼š</code><br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/class">Class expressions (MDN)</a></p><p>Class expressions are very similar to class declarations. The only real difference is that class expressions donâ€™t need a name, though we can refer to them via whatever identifier they ended up bound to:<br><code>ç±»è¡¨è¾¾å¼è·Ÿç±»å£°æ˜éå¸¸ç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ç±»è¡¨è¾¾å¼ä¸éœ€è¦ä¸€ä¸ªåå­—ï¼Œå°½ç®¡æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»‘å®šçš„æ ‡è¯†ç¬¦è¿›è¡Œå¼•ç”¨ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const someClass &#x3D; class&lt;Type&gt; &#123;  content: Type;  constructor(value: Type) &#123;    this.content &#x3D; value;  &#125;&#125;;const m &#x3D; new someClass(&quot;Hello, world&quot;);&#x2F;&#x2F; const m: someClass&lt;string&gt;;</code></pre><h3 id="abstract-Classes-and-Members"><a href="#abstract-Classes-and-Members" class="headerlink" title="abstract Classes and Members"></a>abstract Classes and Members</h3><p><code>æŠ½è±¡ç±»å’Œæˆå‘˜</code><br>Classes, methods, and fields in TypeScript may be abstract.<br><code>TypeScript ä¸­ï¼Œç±»ã€æ–¹æ³•ã€å­—æ®µéƒ½å¯ä»¥æ˜¯æŠ½è±¡çš„ï¼ˆabstractï¼‰ã€‚</code><br>An abstract method or abstract field is one that hasnâ€™t had an implementation provided. These members must exist inside an abstract class, which cannot be directly instantiated.<br><code>æŠ½è±¡æ–¹æ³•æˆ–è€…æŠ½è±¡å­—æ®µæ˜¯ä¸æä¾›å®ç°çš„ã€‚è¿™äº›æˆå‘˜å¿…é¡»å­˜åœ¨åœ¨ä¸€ä¸ªæŠ½è±¡ç±»ä¸­ï¼Œè¿™ä¸ªæŠ½è±¡ç±»ä¹Ÿä¸èƒ½ç›´æ¥è¢«å®ä¾‹åŒ–ã€‚</code><br>The role of abstract classes is to serve as a base class for subclasses which do implement all the abstract members. When a class doesnâ€™t have any abstract members, it is said to be concrete.<br><code>æŠ½è±¡ç±»çš„ä½œç”¨æ˜¯ä½œä¸ºå­ç±»çš„åŸºç±»ï¼Œè®©å­ç±»å®ç°æ‰€æœ‰çš„æŠ½è±¡æˆå‘˜ã€‚å½“ä¸€ä¸ªç±»æ²¡æœ‰ä»»ä½•æŠ½è±¡æˆå‘˜ï¼Œä»–å°±ä¼šè¢«è®¤ä¸ºæ˜¯å…·ä½“çš„ï¼ˆconcreteï¼‰ã€‚</code><br>Letâ€™s look at an example:<br><code>è®©æˆ‘ä»¬çœ‹ä¸ªä¾‹å­ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">abstract class Base &#123;  abstract getName(): string;  printName() &#123;    console.log(&quot;Hello, &quot; + this.getName());  &#125;&#125;const b &#x3D; new Base();&#x2F;&#x2F; Cannot create an instance of an abstract class.</code></pre><p>We canâ€™t instantiate Base with new because itâ€™s abstract. Instead, we need to make a derived class and implement the abstract members:<br><code>æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ new å®ä¾‹ Base å› ä¸ºå®ƒæ˜¯æŠ½è±¡ç±»ã€‚æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œå¹¶ä¸”å®ç°æŠ½è±¡æˆå‘˜ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Derived extends Base &#123;  getName() &#123;    return &quot;world&quot;;  &#125;&#125;const d &#x3D; new Derived();d.printName();</code></pre><p>Notice that if we forget to implement the base classâ€™s abstract members, weâ€™ll get an error:<br><code>æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬å¿˜è®°å®ç°åŸºç±»çš„æŠ½è±¡æˆå‘˜ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæŠ¥é”™ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Derived extends Base &#123;  &#x2F;&#x2F; Non-abstract class &#39;Derived&#39; does not implement inherited abstract member &#39;getName&#39; from class &#39;Base&#39;.  &#x2F;&#x2F; forgot to do anything&#125;</code></pre><h2 id="Abstract-Construct-Signatures"><a href="#Abstract-Construct-Signatures" class="headerlink" title="Abstract Construct Signatures"></a>Abstract Construct Signatures</h2><p><code>æŠ½è±¡æ„é€ ç­¾å</code></p><p>Sometimes you want to accept some class constructor function that produces an instance of a class which derives from some abstract class.<br><code>æœ‰çš„æ—¶å€™ï¼Œä½ å¸Œæœ›æ¥å—ä¼ å…¥å¯ä»¥ç»§æ‰¿ä¸€äº›æŠ½è±¡ç±»äº§ç”Ÿä¸€ä¸ªç±»çš„å®ä¾‹çš„ç±»æ„é€ å‡½æ•°ã€‚</code><br>For example, you might want to write this code:<br><code>ä¸¾ä¸ªä¾‹å­ï¼Œä½ ä¹Ÿè®¸ä¼šå†™è¿™æ ·çš„ä»£ç ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(ctor: typeof Base) &#123;  const instance &#x3D; new ctor();  &#x2F;&#x2F; Cannot create an instance of an abstract class.  instance.printName();&#125;</code></pre><p>TypeScript is correctly telling you that youâ€™re trying to instantiate an abstract class. After all, given the definition of greet, itâ€™s perfectly legal to write this code, which would end up constructing an abstract class:<br><code>TypeScript ä¼šæŠ¥é”™ï¼Œå‘Šè¯‰ä½ æ­£åœ¨å°è¯•å®ä¾‹åŒ–ä¸€ä¸ªæŠ½è±¡ç±»ã€‚æ¯•ç«Ÿï¼Œæ ¹æ® greet çš„å®šä¹‰ï¼Œè¿™æ®µä»£ç åº”è¯¥æ˜¯åˆæ³•çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Bad!greet(Base);</code></pre><p>Instead, you want to write a function that accepts something with a construct signature:<br><code>ä½†å¦‚æœä½ å†™ä¸€ä¸ªå‡½æ•°æ¥å—ä¼ å…¥ä¸€ä¸ªæ„é€ ç­¾åï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(ctor: new () &#x3D;&gt; Base) &#123;  const instance &#x3D; new ctor();  instance.printName();&#125;greet(Derived);greet(Base);&#x2F;&#x2F; Argument of type &#39;typeof Base&#39; is not assignable to parameter of type &#39;new () &#x3D;&gt; Base&#39;.&#x2F;&#x2F; å‚æ•°ç±»å‹ &#39;typeof Base&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;new () &#x3D;&gt; Base&#39;ã€‚&#x2F;&#x2F; Cannot assign an abstract constructor type to a non-abstract constructor type.&#x2F;&#x2F; ä¸èƒ½å°†ä¸€ä¸ªæŠ½è±¡æ„é€ ç±»å‹èµ‹å€¼ç»™ä¸€ä¸ªéæŠ½è±¡æ„é€ ç±»å‹ã€‚</code></pre><p>Now TypeScript correctly tells you about which class constructor functions can be invoked - Derived can because itâ€™s concrete, but Base cannot.<br><code>ç°åœ¨ TypeScript ä¼šæ­£ç¡®çš„å‘Šè¯‰ä½ ï¼Œå“ªä¸€ä¸ªç±»æ„é€ å‡½æ•°å¯ä»¥è¢«è°ƒç”¨ï¼ŒDerived å¯ä»¥ï¼Œå› ä¸ºå®ƒæ˜¯å…·ä½“çš„ï¼Œè€Œ Base æ˜¯ä¸èƒ½çš„ã€‚</code></p><h2 id="Relationships-Between-Classes"><a href="#Relationships-Between-Classes" class="headerlink" title="Relationships Between Classes"></a>Relationships Between Classes</h2><p><code>ç±»ä¹‹é—´çš„å…³ç³»</code><br>In most cases, classes in TypeScript are compared structurally, the same as other types.<br><code>å¤§éƒ¨åˆ†æ—¶å€™ï¼ŒTypeScript çš„ç±»è·Ÿå…¶ä»–ç±»å‹ä¸€æ ·ï¼Œä¼šè¢«ç»“æ„æ€§æ¯”è¾ƒã€‚</code><br>For example, these two classes can be used in place of each other because theyâ€™re identical:<br><code>ä¸¾ä¸ªä¾‹å­ï¼Œè¿™ä¸¤ä¸ªç±»å¯ä»¥ç”¨äºæ›¿ä»£å½¼æ­¤ï¼Œå› ä¸ºå®ƒä»¬ç»“æ„æ˜¯ç›¸ç­‰çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Point1 &#123;  x &#x3D; 0;  y &#x3D; 0;&#125;class Point2 &#123;  x &#x3D; 0;  y &#x3D; 0;&#125;&#x2F;&#x2F; OKconst p: Point1 &#x3D; new Point2();</code></pre><p>Similarly, subtype relationships between classes exist even if thereâ€™s no explicit inheritance:<br><code>ç±»ä¼¼çš„è¿˜æœ‰ï¼Œç±»çš„å­ç±»å‹ä¹‹é—´å¯ä»¥å»ºç«‹å…³ç³»ï¼Œå³ä½¿æ²¡æœ‰æ˜æ˜¾çš„ç»§æ‰¿ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Person &#123;  name: string;  age: number;&#125;class Employee &#123;  name: string;  age: number;  salary: number;&#125;&#x2F;&#x2F; OKconst p: Person &#x3D; new Employee();</code></pre><p>This sounds straightforward, but there are a few cases that seem stranger than others.<br><code>è¿™å¬èµ·æ¥æœ‰äº›ç®€å•ï¼Œä½†è¿˜æœ‰ä¸€äº›ä¾‹å­å¯ä»¥çœ‹å‡ºå¥‡æ€ªçš„åœ°æ–¹ã€‚</code></p><p>Empty classes have no members. In a structural type system, a type with no members is generally a supertype of anything else. So if you write an empty class (donâ€™t!), anything can be used in place of it:</p><p><code>ç©ºç±»æ²¡æœ‰ä»»ä½•æˆå‘˜ã€‚åœ¨ä¸€ä¸ªç»“æ„åŒ–ç±»å‹ç³»ç»Ÿä¸­ï¼Œæ²¡æœ‰æˆå‘˜çš„ç±»å‹é€šå¸¸æ˜¯ä»»ä½•å…¶ä»–ç±»å‹çš„çˆ¶ç±»å‹ã€‚æ‰€ä»¥å¦‚æœä½ å†™ä¸€ä¸ªç©ºç±»ï¼ˆåªæ˜¯ä¸¾ä¾‹ï¼Œä½ å¯ä¸è¦è¿™æ ·åšï¼‰ï¼Œä»»ä½•ä¸œè¥¿éƒ½å¯ä»¥ç”¨æ¥æ›¿æ¢å®ƒï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class Empty &#123;&#125;function fn(x: Empty) &#123;  &#x2F;&#x2F; can&#39;t do anything with &#39;x&#39;, so I won&#39;t&#125;&#x2F;&#x2F; All OK!fn(window);fn(&#123;&#125;);fn(fn);</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.typescriptlang.org/docs/handbook/2/classes.html#class-members">typescriptå®˜ç½‘ ç±»</a><br><a href="https://ts.yayujs.com/handbook/Class.html#%E7%B1%BB-classes">ç±»ï¼ˆClassesï¼‰</a></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7.Typescriptæ‰‹å†Œ ç±»å‹æ“ä½œ</title>
      <link href="//post/2022-06-07ts-type-manipulation.html"/>
      <url>//post/2022-06-07ts-type-manipulation.html</url>
      
        <content type="html"><![CDATA[<h2 id="ts-ç±»å‹å¦‚ä½•è°ƒè¯•"><a href="#ts-ç±»å‹å¦‚ä½•è°ƒè¯•" class="headerlink" title="ts ç±»å‹å¦‚ä½•è°ƒè¯•"></a>ts ç±»å‹å¦‚ä½•è°ƒè¯•</h2><ul><li>ä¸æ˜¯ä»£ç é€»è¾‘å¦‚ä½•è°ƒè¯•ï¼Œæ²¡æƒ³åˆ°</li></ul><h2 id="ts-è‡ªå®šä¹‰ç±»å‹å¦‚ä½•æ‰“å°"><a href="#ts-è‡ªå®šä¹‰ç±»å‹å¦‚ä½•æ‰“å°" class="headerlink" title="ts è‡ªå®šä¹‰ç±»å‹å¦‚ä½•æ‰“å°"></a>ts è‡ªå®šä¹‰ç±»å‹å¦‚ä½•æ‰“å°</h2><ul><li>ä¸æ˜¯ js çš„ç»“æœå¦‚ä½•æ‰“å°ï¼Œæ²¡æƒ³åˆ°</li></ul><h2 id="Creating-Types-from-Types"><a href="#Creating-Types-from-Types" class="headerlink" title="Creating Types from Types"></a>Creating Types from Types</h2><p>ä»å·²æœ‰ç±»å‹ä¸­åˆ›å»ºç±»å‹</p><p>TypeScript çš„ç±»å‹ç³»ç»Ÿéå¸¸å¼ºå¤§ï¼Œå› ä¸ºå®ƒå…è®¸è¡¨è¾¾ç±»å‹çš„å¦ä¸€ç§è¡¨è¾¾æ–¹å¼ã€‚<br>æœ€ç®€å•çš„æ–¹å¼æ˜¯æ³›å‹ï¼Œæˆ‘ä»¬å®é™…ä¸Šæœ‰ä¸€å¤§å †çš„ç±»å‹æ“ä½œç¬¦å¯ç”¨ã€‚è¿˜å¯ä»¥è¡¨è¾¾ç±»å‹çš„å¦ä¸€ç§è¡¨è¾¾æ–¹å¼ï¼Œå°±æ˜¯æŠŠå·²æœ‰çš„å€¼ä½œä¸ºç±»å‹ã€‚<br>é€šè¿‡åˆå¹¶å¤šç§ç±»å‹æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥è¡¨è¾¾å¤æ‚çš„æ“ä½œå’Œå€¼ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ä»‹ç»ä»¥å¦ä¸€ä¸ªç±»å‹æˆ–å€¼ä¸ºåŸºç¡€å¦‚ä½•è¡¨è¾¾ä¸€ä¸ªæ–°ç±»å‹ã€‚</p><p><code>ç®€å•æ¥è¯´ï¼šä½¿ç”¨ èŒƒå‹ æˆ– 6ç§è¡¨è¾¾å¼ æ¥åˆ›å»ºæ–°ç±»å‹</code></p><ul><li><p>èŒƒå‹ - ç±»å‹éœ€è¦å‚æ•°</p></li><li><p>Keyof Type Operator - ç”¨ keyof æ“ä½œå»åˆ›å»ºæ–°ç±»å‹</p></li><li><p>Typeof Type Operator - ç”¨ typeof æ“ä½œå»åˆ›å»ºæ–°ç±»å‹</p></li><li><p>Indexed Access Types - ä½¿ç”¨ Type[â€˜aâ€™]è¯­æ³•å»è®¿é—®ä¸€ä¸ªç±»å‹çš„ä¸€éƒ¨åˆ†</p></li><li><p>Conditional Types - ç±»å‹è¡Œä¸ºåƒ if è¯­å¥ä¸€æ ·</p></li><li><p>Mapped Types - é€šè¿‡æ˜ å°„å·²æœ‰ç±»å‹çš„æ¯ä¸ªå±æ€§æ¥åˆ›å»ºæ–°ç±»å‹</p></li><li><p>Template Literal Types - é€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²æ¥æ”¹å˜å±æ€§çš„æ˜ å°„ç±»å‹</p></li></ul><h2 id="Keyof-Type-Operator"><a href="#Keyof-Type-Operator" class="headerlink" title="Keyof Type Operator"></a>Keyof Type Operator</h2><ul><li>è¿™ä¸ªæ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰ keyï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°å­—çš„è”åˆç±»å‹ï¼Œæ¥ä¸‹æ¥çš„ç±»å‹ P æ˜¯è¿™ä¸ªç±»å‹çš„ç±»å‹ï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type P1 &#x3D; keyof any; &#x2F;&#x2F; æç¤ºï¼štype P1 &#x3D; string | number | symbol</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Point &#x3D; &#123; x: number; y: number &#125;;type P &#x3D; keyof Point; &#x2F;&#x2F; æç¤ºï¼štype P &#x3D; keyof Pointï¼Œè¿™ä¸ªæç¤ºç­‰äºæ²¡æç¤º</code></pre><ul><li>å¦‚æœè¿™ä¸ªç±»å‹æœ‰å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ç´¢å¼•ï¼Œkeyof å°±ä¼šè¿”å›è¿™ä¸ªç±»å‹ï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Arrayish &#x3D; &#123; [n: number]: unknown &#125;;type A &#x3D; keyof Arrayish; &#x2F;&#x2F;æç¤ºï¼štype A &#x3D; numbertype Mapish &#x3D; &#123; [k: string]: boolean &#125;;type M &#x3D; keyof Mapish; &#x2F;&#x2F; æç¤ºï¼štype M &#x3D; string | number&#x2F;&#x2F; --------------------------------------------------------------&#x2F;&#x2F; å¯¹äºArrayish&#x2F;&#x2F; å®ä¾‹1:okvar a: Arrayish &#x3D; &#123;  1: &quot;string&quot;,  2: false,&#125;;&#x2F;&#x2F; å®ä¾‹2: okvar a1: Arrayish &#x3D; [1, 2, 3, 4];&#x2F;&#x2F; å¯¹äº Mapishvar b: Mapish &#x3D; &#123;  name: true,  age: false,&#125;;</code></pre><p>æ³¨æ„ï¼Œè¿™ä¸ªä¾‹å­ä¸­ï¼ŒM æ˜¯ string | number â€” è¿™æ˜¯å› ä¸º JavaScript å¯¹è±¡é”®æ˜¯æ€»æ˜¯è¢«å¼ºåˆ¶ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ obj[0] æ€»æ˜¯å’Œ obj[â€œ0â€] ç›¸åŒã€‚</p><p>keyof ç±»å‹æ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰ keyï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°å­—çš„è”åˆç±»å‹ï¼Œæ¥ä¸‹æ¥çš„ç±»å‹ P æ˜¯è¿™ä¸ªç±»å‹çš„ç±»å‹ï¼š</p><h2 id="Typeof-type-operator"><a href="#Typeof-type-operator" class="headerlink" title="Typeof type operator"></a>Typeof type operator</h2><p>JavaScript ä¹Ÿæœ‰ä¸€ä¸ª typeof æ“ä½œç¬¦ï¼Œå¯ä»¥ç”¨åœ¨è¡¨è¾¾å¼ä¸­ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; Prints &quot;string&quot;console.log(typeof &quot;Hello world&quot;);</code></pre><p>TypeScript å¢åŠ äº†ä¸€ä¸ª typeof æ“ä½œç¬¦ï¼Œå¯ä»¥ç”¨åœ¨ç±»å‹ä¸Šï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let s &#x3D; &quot;hello&quot;;let n: typeof s; &#x2F;&#x2F; æç¤ºï¼šlet n: string</code></pre><h2 id="ReturnType"><a href="#ReturnType" class="headerlink" title="ReturnType"></a>ReturnType</h2><p>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œtypeof æ“ä½œç¬¦æ²¡æœ‰æ„ä¹‰ï¼Œä½†æ˜¯ä¸å…¶ä»–ç±»å‹æ“ä½œç¬¦ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥ç”¨ typeof æ“ä½œç¬¦æ¥å®ç°ä¸€äº›æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¼€å§‹ç”¨ ReturnType<T> æ¥è¡¨ç¤ºå‡½æ•°çš„è¿”å›ç±»å‹ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Predicate &#x3D; (x: unknown) &#x3D;&gt; boolean;type K &#x3D; ReturnType&lt;Predicate&gt;; &#x2F;&#x2F; æç¤º type K &#x3D; boolean</code></pre><p>å¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨ ReturnType åœ¨å‡½æ•°åä¸Šï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªæŒ‡ç¤ºæ€§çš„é”™è¯¯ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function f() &#123;  return &#123; x: 10, y: 3 &#125;;&#125;type P &#x3D; ReturnType&lt;f&gt;;&#x2F;&#x2F; æç¤ºï¼š&#39;f&#39; refers to a value, but is being used as a type here. Did you mean &#39;typeof f&#39;?&#x2F;&#x2F; æç¤ºï¼š&#39;f&#39; æ¶‰åŠåˆ°ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯åœ¨è¿™é‡Œè¢«ä½¿ç”¨ä½œä¸ºç±»å‹ã€‚ä½ æ˜¯å¦æƒ³ä½¿ç”¨ &#39;typeof f&#39; æ¥ä»£æ›¿ &#39;f&#39;ï¼Ÿ</code></pre><p>è®°ä½ï¼Œå€¼å’Œç±»å‹ä¸æ˜¯ä¸€å›äº‹ã€‚è¦å¼•ç”¨å€¼ f æ‰€æ‹¥æœ‰çš„ç±»å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ typeofï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function f() &#123;  return &#123; x: 10, y: 3 &#125;;&#125;type P &#x3D; ReturnType&lt;typeof f&gt;;&#x2F;** * æç¤º * type P &#x3D; &#123;    x: number;    y: number;&#125;**&#x2F;</code></pre><p><strong>é™åˆ¶</strong></p><p>typescript é€šå¸¸é™åˆ¶äº† typeof çš„è¡¨è¾¾å¼çš„ç±»å‹ã€‚<br>ç‰¹æ®Šçš„ï¼Œtypeof çš„è¡¨è¾¾å¼<code>åªèƒ½ç”¨äºæ ‡è¯†ç¬¦ï¼ˆå³å˜é‡åï¼‰å…¶å±æ€§</code>ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ä¸ºäº†é¿å…å†™ä¸€äº›ä½ è®¤ä¸ºæ˜¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†å®é™…ä¸Šå¹¶ä¸æ˜¯çš„ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Meant to use &#x3D; ReturnType&lt;typeof msgbox&gt;let shouldContinue: typeof msgbox(&quot;Are you sure you want to continue?&quot;);&#x2F;&#x2F; &#39;,&#39; expected.</code></pre><h2 id="Indexed-Access-Types"><a href="#Indexed-Access-Types" class="headerlink" title="Indexed Access Types"></a>Indexed Access Types</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®ç±»å‹æ¥æŸ¥æ‰¾ä¸€ä¸ªç±»å‹çš„ç‰¹å®šå±æ€§ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Person &#x3D; &#123; age: number; name: string; alive: boolean &#125;;type Age &#x3D; Person[&quot;age&quot;]; &#x2F;&#x2F; æç¤ºï¼štype Age &#x3D; number</code></pre><p>è¿™ä¸ªç´¢å¼•ç±»å‹æœ¬èº«æ˜¯ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è”åˆï¼Œkeyof æˆ–è€…å…¶ä»–ç±»å‹ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type I1 &#x3D; Person[&quot;age&quot; | &quot;name&quot;]; &#x2F;&#x2F; æç¤ºï¼štype I1 &#x3D; string | numbertype I2 &#x3D; Person[keyof Person]; &#x2F;&#x2F; æç¤ºï¼štype I2 &#x3D; string | number | booleantype AliveOrName &#x3D; &quot;alive&quot; | &quot;name&quot;;type I3 &#x3D; Person[AliveOrName]; &#x2F;&#x2F; æç¤ºï¼štype I3 &#x3D; string | boolean</code></pre><p>ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå¦‚æœä½ å°è¯•ç´¢å¼•ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type I1 &#x3D; Person[&quot;alve&quot;];Property &#39;alve&#39; does not exist on type &#39;Person&#39;.</code></pre><p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ä½¿ç”¨ number æ¥è·å–æ•°ç»„çš„å…ƒç´ ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ typeof æ¥æ–¹ä¾¿åœ°æ•è·æ•°ç»„å­—é¢é‡çš„å…ƒç´ ç±»å‹ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const MyArray &#x3D; [  &#123; name: &quot;Alice&quot;, age: 15 &#125;,  &#123; name: &quot;Bob&quot;, age: 23 &#125;,  &#123; name: &quot;Eve&quot;, age: 38 &#125;,];type Person &#x3D; typeof MyArray[number];&#x2F;&#x2F; æç¤ºï¼štype Person &#x3D; &#123; name: string; age: number; &#125;type Age &#x3D; typeof MyArray[number][&quot;age&quot;]; &#x2F;&#x2F; æç¤º type Age &#x3D; number;&#x2F;&#x2F; Ortype Age2 &#x3D; Person[&quot;age&quot;]; &#x2F;&#x2F; æç¤º type Age2 &#x3D; number;</code></pre><p>ä½ åªèƒ½ä½¿ç”¨ç±»å‹æ¥ç´¢å¼•ï¼Œæ„å‘³ç€ä½ ä¸èƒ½ä½¿ç”¨ const æ¥åˆ›å»ºä¸€ä¸ªå˜é‡å¼•ç”¨ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const key &#x3D; &quot;age&quot;;type Age &#x3D; Person[key];&#x2F;&#x2F; Type &#39;key&#39; cannot be used as an index type.&#x2F;&#x2F; è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸º key æ˜¯ä¸€ä¸ªå­—é¢é‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå˜é‡ã€‚&#x2F;&#x2F; &#39;key&#39; refers to a value, but is being used as a type here. Did you mean &#39;typeof key&#39;?&#x2F;&#x2F; è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸º key æ¶‰åŠåˆ°ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯åœ¨è¿™é‡Œè¢«ä½¿ç”¨ä½œä¸ºç±»å‹ã€‚ä½ æ˜¯å¦æƒ³ä½¿ç”¨ &#39;typeof key&#39; æ¥ä»£æ›¿ &#39;key&#39;ï¼Ÿ</code></pre><p>ç„¶è€Œï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç±»å‹åˆ«åæ¥æ›¿æ¢ç›¸åŒçš„é£æ ¼çš„é‡æ„ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type key &#x3D; &quot;age&quot;;type Age &#x3D; Person[key];</code></pre><h2 id="Conditional-Types"><a href="#Conditional-Types" class="headerlink" title="Conditional Types"></a>Conditional Types</h2><p>At the heart of most useful programs, we have to make decisions based on input. JavaScript programs are no different, but given the fact that values can be easily introspected, those decisions are also based on the types of the inputs. Conditional types help describe the relation between the types of inputs and outputs.<br>åœ¨æœ€å¸¸è§çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¾“å…¥æ¥åšå†³ç­–ã€‚ JavaScript ç¨‹åºæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ç»™å®šäº†è¿™ä¸ªäº‹å®ï¼Œé‚£äº›å†³ç­–æ˜¯æ ¹æ®è¾“å…¥çš„ç±»å‹æ¥åšçš„ã€‚æ¡ä»¶ç±»å‹å¸®åŠ©æè¿°è¾“å…¥å’Œè¾“å‡ºç±»å‹ä¹‹é—´çš„å…³ç³»ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Animal &#123;  live(): void;&#125;interface Dog extends Animal &#123;  woof(): void;&#125;type Example1 &#x3D; Dog extends Animal ? number : string; &#x2F;&#x2F; æç¤ºï¼štype Example1 &#x3D; numbertype Example2 &#x3D; RegExp extends Animal ? number : string; &#x2F;&#x2F; æç¤ºï¼štype Example2 &#x3D; string</code></pre><p>æ¡ä»¶ç±»å‹çš„è¡¨è¾¾å¼åƒ JavaScript ä¸­çš„æ¡ä»¶è¡¨è¾¾å¼ä¸€æ ·ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">SomeType extends OtherType ? TrueType : FalseType;</code></pre><p><strong>æ­¤æ®µå†…å®¹ï¼ŒåŸæ–‡ä¿ç•™</strong><br>When the type on the left of the extends is assignable to the one on the right, then youâ€™ll get the type in the first branch (the â€œtrueâ€ branch); otherwise youâ€™ll get the type in the latter branch (the â€œfalseâ€ branch).</p><p>å½“ extends å·¦è¾¹çš„ç±»å‹å¯ä»¥èµ‹å€¼ç»™å³è¾¹çš„ç±»å‹æ—¶ï¼Œä½ ä¼šå¾—åˆ°ç¬¬ä¸€ä¸ªåˆ†æ”¯çš„ç±»å‹ï¼ˆâ€œtrueâ€åˆ†æ”¯ï¼‰ï¼›å¦åˆ™ä½ ä¼šå¾—åˆ°ç¬¬äºŒä¸ªåˆ†æ”¯çš„ç±»å‹ï¼ˆâ€œfalseâ€åˆ†æ”¯ï¼‰ã€‚</p><p>From the examples above, conditional types might not immediately seem useful - we can tell ourselves whether or not Dog extends Animal and pick number or string! But the power of conditional types comes from using them with generics.<br>ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°æ¡ä»¶ç±»å‹å¯èƒ½ä¸ä¼šç«‹å³çœ‹èµ·æ¥å¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘Šè¯‰è‡ªå·± Dog æ˜¯å¦ç»§æ‰¿äº† Animalï¼Œç„¶åé€‰æ‹© number æˆ– stringï¼ä½†æ˜¯æ¡ä»¶ç±»å‹çš„åŠ›é‡æ¥è‡ªäºä½¿ç”¨å®ƒä»¬ä¸æ³›å‹ã€‚</p><p>For example, letâ€™s take the following createLabel function:<br>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸‹é¢çš„ createLabel å‡½æ•°æ‹¿æ¥è¯´è¯´ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface IdLabel &#123;  id: number &#x2F;* some fields *&#x2F;;&#125;interface NameLabel &#123;  name: string &#x2F;* other fields *&#x2F;;&#125;function createLabel(id: number): IdLabel;function createLabel(name: string): NameLabel;function createLabel(nameOrId: string | number): IdLabel | NameLabel;function createLabel(nameOrId: string | number): IdLabel | NameLabel &#123;  throw &quot;unimplemented&quot;;&#125;</code></pre><p>These overloads for createLabel describe a single JavaScript function that makes a choice based on the types of its inputs. Note a few things:<br>è¿™äº› createLabel çš„é‡è½½æè¿°äº†ä¸€ä¸ªå•ä¸€çš„ JavaScript å‡½æ•°ï¼Œå®ƒæ ¹æ®è¾“å…¥çš„ç±»å‹æ¥åšå†³ç­–ã€‚è¯·æ³¨æ„ä¸€äº›äº‹æƒ…ï¼š</p><p>If a library has to make the same sort of choice over and over throughout its API, this becomes cumbersome.<br>We have to create three overloads: one for each case when weâ€™re sure of the type (one for string and one for number), and one for the most general case (taking a string | number). For every new type createLabel can handle, the number of overloads grows exponentially.<br>å¦‚æœä¸€ä¸ªåº“éœ€è¦åœ¨å…¶ API ä¸­é‡å¤ä½¿ç”¨ç›¸åŒçš„é€‰æ‹©ï¼Œè¿™å°±å˜å¾—éå¸¸éº»çƒ¦ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸‰ä¸ªé‡è½½ï¼šä¸€ä¸ªå½“æˆ‘ä»¬çŸ¥é“ç±»å‹æ—¶ï¼Œä¸€ä¸ªå½“æˆ‘ä»¬çŸ¥é“ç±»å‹æ—¶ï¼Œä¸€ä¸ªå½“æˆ‘ä»¬ä¸çŸ¥é“ç±»å‹æ—¶ã€‚å¯¹äºæ¯ä¸ªæ–°çš„ç±»å‹ createLabel å¯ä»¥å¤„ç†ï¼Œé‡è½½çš„æ•°é‡å°±ä¼šæŒ‡æ•°å¢é•¿ã€‚<br>Instead, we can encode that logic in a conditional type:<br>åä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡ä»¶ç±»å‹æ¥è¡¨ç¤ºé€»è¾‘ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type NameOrId&lt;T extends number | string&gt; &#x3D; T extends number  ? IdLabel  : NameLabel;</code></pre><p>We can then use that conditional type to simplify our overloads down to a single function with no overloads.<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¡ä»¶ç±»å‹æ¥ç®€åŒ–æˆ‘ä»¬çš„é‡è½½ï¼Œåªæœ‰ä¸€ä¸ªå‡½æ•°ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function createLabel&lt;T extends number | string&gt;(idOrName: T): NameOrId&lt;T&gt; &#123;  throw &quot;unimplemented&quot;;&#125;let a &#x3D; createLabel(&quot;typescript&quot;);&#x2F;&#x2F; æç¤ºï¼šlet a: NameLabel;let b &#x3D; createLabel(2.8);&#x2F;&#x2F; æç¤ºï¼šlet b: IdLabel;let c &#x3D; createLabel(Math.random() ? &quot;hello&quot; : 42);&#x2F;&#x2F; æç¤ºï¼šlet c: NameLabel | IdLabel;</code></pre><ul><li>Conditional Type Constraints</li></ul><p>æ¡ä»¶ç±»å‹çº¦æŸ</p><p>Often, the checks in a conditional type will provide us with some new information. Just like with narrowing with type guards can give us a more specific type, the true branch of a conditional type will further constrain generics by the type we check against.<br>é€šå¸¸ï¼Œåœ¨æ¡ä»¶ç±»å‹ä¸­çš„æ£€æŸ¥ä¼šæä¾›æˆ‘ä»¬ä¸€äº›æ–°çš„ä¿¡æ¯ã€‚åƒç±»å‹æ£€æŸ¥ä¸€æ ·ï¼Œé€šè¿‡ç±»å‹çº¦æŸå¯ä»¥ç»™æˆ‘ä»¬æ›´å…·ä½“çš„ç±»å‹ï¼Œæ¡ä»¶ç±»å‹çš„ true åˆ†æ”¯å°†é€šè¿‡æˆ‘ä»¬æ£€æŸ¥çš„ç±»å‹æ¥çº¦æŸæ³›å‹ã€‚<br>For example, letâ€™s take the following:<br>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸‹é¢çš„å‡½æ•°æ‹¿æ¥è¯´è¯´ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type MessageOf&lt;T&gt; &#x3D; T[&quot;message&quot;];&#x2F;&#x2F; Type &#39;&quot;message&quot;&#39; cannot be used to index type &#39;T&#39;.</code></pre><p>In this example, TypeScript errors because T isnâ€™t known to have a property called message. We could constrain T, and TypeScript would no longer complain:</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒTypeScript é”™è¯¯ï¼Œå› ä¸º T æ²¡æœ‰ä¸€ä¸ªå±æ€§å« messageã€‚æˆ‘ä»¬å¯ä»¥çº¦æŸ Tï¼ŒTypeScript ä¸ä¼šå†æŠ¥é”™äº†ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type MessageOf&lt;T extends &#123; message: unknown &#125;&gt; &#x3D; T[&quot;message&quot;];interface Email &#123;  message: string;&#125;type EmailMessageContents &#x3D; MessageOf&lt;Email&gt;;&#x2F;&#x2F; æç¤ºï¼štype EmailMessageContents &#x3D; string</code></pre><p>However, what if we wanted MessageOf to take any type, and default to something like never if a message property isnâ€™t available? We can do this by moving the constraint out and introducing a conditional type:<br>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ MessageOf å–ä»»æ„ç±»å‹ï¼Œå¹¶ä¸”é»˜è®¤ä¸ºæ²¡æœ‰ message å±æ€§çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type MessageOf&lt;T&gt; &#x3D; T extends &#123; message: unknown &#125; ? T[&quot;message&quot;] : never;interface Email &#123;  message: string;&#125;interface Dog &#123;  bark(): void;&#125;type EmailMessageContents &#x3D; MessageOf&lt;Email&gt;;&#x2F;&#x2F; æç¤ºï¼štype EmailMessageContents &#x3D; string;type DogMessageContents &#x3D; MessageOf&lt;Dog&gt;;&#x2F;&#x2F; æç¤ºï¼štype DogMessageContents &#x3D; never;</code></pre><p>Within the true branch, TypeScript knows that T will have a message property.<br>åœ¨ true åˆ†æ”¯ä¸­ï¼ŒTypeScript çŸ¥é“ T æœ‰ä¸€ä¸ª message å±æ€§ã€‚</p><p>As another example, we could also write a type called Flatten that flattens array types to their element types, but leaves them alone otherwise:<br>ä½œä¸ºå¦ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç¼–å†™ä¸€ä¸ªåä¸º Flatten çš„ç±»å‹ï¼Œè¯¥ç±»å‹å°†æ•°ç»„ç±»å‹å±•å¹³ä¸ºå…¶å…ƒç´ ç±»å‹ï¼Œä½†åœ¨å…¶ä»–æƒ…å†µä¸‹ä¸ä½¿ç”¨å®ƒä»¬ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Flatten&lt;T&gt; &#x3D; T extends any[] ? T[number] : T;&#x2F;&#x2F; Extracts out the element type. æå–å…ƒç´ ç±»å‹ã€‚type Str &#x3D; Flatten&lt;string[]&gt;;type Str &#x3D; string;&#x2F;&#x2F; Leaves the type alone. ä¿ç•™è¯¥ç±»å‹ã€‚type Num &#x3D; Flatten&lt;number&gt;;type Num &#x3D; number;</code></pre><p>When Flatten is given an array type, it uses an indexed access with number to fetch out string[]â€™s element type. Otherwise, it just returns the type it was given.<br>å½“ Flatten ç»™å®šä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œå®ƒä½¿ç”¨ number ä¸‹æ ‡å¾—åˆ° string[]å…ƒç´ ç±»å‹ï¼Œå¦åˆ™ï¼Œä»…è¿”å›æ‰€ç»™ç±»å‹</p><p>Inferring Within Conditional Types<br>åœ¨æ¡ä»¶ç±»å‹å†…æ¨æ–­</p><p>We just found ourselves using conditional types to apply constraints and then extract out types. This ends up being such a common operation that conditional types make it easier.</p><p>æˆ‘ä»¬åªæ˜¯å‘ç°è‡ªå·±ä½¿ç”¨æ¡ä»¶ç±»å‹æ¥åº”ç”¨çº¦æŸï¼Œç„¶åæå–å‡ºç±»å‹ã€‚è¿™æœ€ç»ˆæ˜¯ä¸€ç§å¸¸è§çš„æ“ä½œï¼Œæ¡ä»¶ç±»å‹ä½¿å…¶æ›´å®¹æ˜“å®ç°ã€‚</p><p>Conditional types provide us with a way to infer from types we compare against in the true branch using the infer keyword. For example, we could have inferred the element type in Flatten instead of fetching it out â€œmanuallyâ€ with an indexed access type:</p><p>æ¡ä»¶ç±»å‹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä½¿ç”¨ infer å…³é”®å­—ä» true åˆ†æ”¯ä¸­æ¯”è¾ƒçš„ç±»å‹æ¨æ–­çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Flatten ä¸­æ¨æ–­å…ƒç´ ç±»å‹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç´¢å¼•è®¿é—®ç±»å‹â€œæ‰‹åŠ¨â€æå–å®ƒï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Flatten&lt;Type&gt; &#x3D; Type extends Array&lt;infer Item&gt; ? Item : Type;</code></pre><p>Here, we used the infer keyword to declaratively introduce a new generic type variable named Item instead of specifying how to retrieve the element type of T within the true branch. This frees us from having to think about how to dig through and probing apart the structure of the types weâ€™re interested in.</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ infer å…³é”®å­—å£°æ˜æ€§åœ°å¼•å…¥ä¸€ä¸ªåä¸º Item çš„æ–°æ³›å‹ç±»å‹å˜é‡ï¼Œè€Œä¸æ˜¯æŒ‡å®šå¦‚ä½•åœ¨ true åˆ†æ”¯ä¸­æ£€ç´¢ T çš„å…ƒç´ ç±»å‹ã€‚è¿™ä½¿æˆ‘ä»¬ä¸å¿…æ€è€ƒå¦‚ä½•æŒ–æ˜å’Œæ¢ç´¢æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç±»å‹çš„ç»“æ„ã€‚</p><p>We can write some useful helper type aliases using the infer keyword. For example, for simple cases, we can extract the return type out from function types:</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ infer å…³é”®å­—ç¼–å†™ä¸€äº›æœ‰ç”¨çš„åŠ©æ‰‹ç±»å‹åˆ«åã€‚ä¾‹å¦‚ï¼Œå¯¹äºç®€å•çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä»å‡½æ•°ç±»å‹ä¸­æå–è¿”å›ç±»å‹ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type GetReturnType&lt;Type&gt; &#x3D; Type extends (...args: never[]) &#x3D;&gt; infer Return  ? Return  : never;type Num &#x3D; GetReturnType&lt;() &#x3D;&gt; number&gt;;&#x2F;&#x2F; æç¤ºï¼š type Num &#x3D; numbertype Str &#x3D; GetReturnType&lt;(x: string) &#x3D;&gt; string&gt;;&#x2F;&#x2F; æç¤ºï¼štype Str &#x3D; stringtype Bools &#x3D; GetReturnType&lt;(a: boolean, b: boolean) &#x3D;&gt; boolean[]&gt;;&#x2F;&#x2F; æç¤ºï¼š type Bools &#x3D; boolean[]</code></pre><p>When inferring from a type with multiple call signatures (such as the type of an overloaded function), inferences are made from the last signature (which, presumably, is the most permissive catch-all case). It is not possible to perform overload resolution based on a list of argument types.<br>å½“ä»å…·æœ‰å¤šä¸ªè°ƒç”¨ç­¾åçš„ç±»å‹ï¼ˆä¾‹å¦‚é‡è½½å‡½æ•°çš„ç±»å‹ï¼‰è¿›è¡Œæ¨æ–­æ—¶ï¼Œå°†ä»æœ€åä¸€ä¸ªç­¾åè¿›è¡Œæ¨æ–­ï¼ˆè¿™å¯èƒ½æ˜¯æœ€å…è®¸çš„ä¸€ç½‘æ‰“å°½çš„æƒ…å†µï¼‰ã€‚æ— æ³•åŸºäºå‚æ•°ç±»å‹åˆ—è¡¨æ‰§è¡Œé‡è½½è§£æã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare function stringOrNum(x: string): number;declare function stringOrNum(x: number): string;declare function stringOrNum(x: string | number): string | number;type T1 &#x3D; ReturnType&lt;typeof stringOrNum&gt;;&#x2F;&#x2F; æç¤ºï¼štype T1 &#x3D; string | number;</code></pre><h2 id="Distributive-Conditional-Types"><a href="#Distributive-Conditional-Types" class="headerlink" title="Distributive Conditional Types"></a>Distributive Conditional Types</h2><p>åˆ†å¸ƒæ¡ä»¶ç±»å‹</p><p>When conditional types act on a generic type, they become distributive when given a union type. For example, take the following:<br>å½“æ¡ä»¶ç±»å‹ä½œç”¨äºæ³›å‹ç±»å‹æ—¶ï¼Œå½“ç»™å®šä¸€ä¸ªè”åˆç±»å‹æ—¶ï¼Œå®ƒä»¬å°†æˆä¸ºåˆ†å¸ƒå¼çš„ã€‚ä¾‹å¦‚ï¼Œä»¥ä»¥ä¸‹å†…å®¹ä¸ºä¾‹ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type ToArray&lt;Type&gt; &#x3D; Type extends any ? Type[] : never;</code></pre><p>If we plug a union type into ToArray, then the conditional type will be applied to each member of that union.<br>å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªè”åˆç±»å‹æ’å…¥ ToArrayï¼Œé‚£ä¹ˆæ¡ä»¶ç±»å‹å°†åº”ç”¨äºè¯¥è”åˆçš„æ¯ä¸ªæˆå‘˜ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type ToArray&lt;Type&gt; &#x3D; Type extends any ? Type[] : never;type StrArrOrNumArr &#x3D; ToArray&lt;string | number&gt;;&#x2F;&#x2F; æç¤ºï¼štype StrArrOrNumArr &#x3D; string[] | number[];</code></pre><p>What happens here is that StrArrOrNumArr distributes on:<br>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">string | number;</code></pre><p>and maps over each member type of the union, to what is effectively:<br>å¹¶æ˜ å°„åˆ°è”åˆç±»å‹æ¯ä¸ªæˆå‘˜ç±»å‹</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">ToArray&lt;string&gt; | ToArray&lt;number&gt;;</code></pre><p>which leaves us with:<br>è¿™ç»™æˆ‘ä»¬ç•™ä¸‹äº†ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">string[] | number[];</code></pre><p>Typically, distributivity is the desired behavior. To avoid that behavior, you can surround each side of the extends keyword with square brackets.<br>é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼æ˜¯æ‰€éœ€çš„è¡Œä¸ºã€‚è¦é¿å…è¿™ç§è¡Œä¸ºï¼Œä½ å¯ä»¥åœ¨æ¯è¾¹ extends å…³é”®å­—ä¹‹å‰ä½¿ç”¨æ–¹æ‹¬å·ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type ToArrayNonDist&lt;Type&gt; &#x3D; [Type] extends [any] ? Type[] : never;&#x2F;&#x2F; &#39;StrArrOrNumArr&#39; is no longer a union.type StrArrOrNumArr &#x3D; ToArrayNonDist&lt;string | number&gt;;&#x2F;&#x2F; æç¤ºï¼štype StrArrOrNumArr &#x3D; (string | number)[];</code></pre><h2 id="Return"><a href="#Return" class="headerlink" title="Return"></a>Return</h2><h2 id="æ¨¡æ¿å­—é¢é‡ç±»å‹ï¼ˆTemplate-Literal-Typesï¼‰"><a href="#æ¨¡æ¿å­—é¢é‡ç±»å‹ï¼ˆTemplate-Literal-Typesï¼‰" class="headerlink" title="æ¨¡æ¿å­—é¢é‡ç±»å‹ï¼ˆTemplate Literal Typesï¼‰"></a>æ¨¡æ¿å­—é¢é‡ç±»å‹ï¼ˆTemplate Literal Typesï¼‰</h2><p>æ¨¡æ¿å­—é¢é‡ç±»å‹ä»¥å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹ä¸ºåŸºç¡€ï¼Œå¯ä»¥é€šè¿‡è”åˆç±»å‹æ‰©å±•æˆå¤šä¸ªå­—ç¬¦ä¸²ã€‚</p><p>å®ƒä»¬è·Ÿ JavaScript çš„æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„è¯­æ³•ï¼Œä½†æ˜¯åªèƒ½ç”¨åœ¨ç±»å‹æ“ä½œä¸­ã€‚å½“ä½¿ç”¨æ¨¡æ¿å­—é¢é‡ç±»å‹æ—¶ï¼Œå®ƒä¼šæ›¿æ¢æ¨¡æ¿ä¸­çš„å˜é‡ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type World &#x3D; &quot;world&quot;;type Greeting &#x3D; &#96;hello $&#123;World&#125;&#96;;&#x2F;&#x2F; type Greeting &#x3D; &quot;hello world&quot;</code></pre><ul><li>å½“æ¨¡æ¿ä¸­çš„å˜é‡æ˜¯ä¸€ä¸ªè”åˆç±»å‹æ—¶ï¼Œæ¯ä¸€ä¸ªå¯èƒ½çš„å­—ç¬¦ä¸²å­—é¢é‡éƒ½ä¼šè¢«è¡¨ç¤ºï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type EmailLocaleIDs &#x3D; &quot;welcome_email&quot; | &quot;email_heading&quot;;type FooterLocaleIDs &#x3D; &quot;footer_title&quot; | &quot;footer_sendoff&quot;;type AllLocaleIDs &#x3D; &#96;$&#123;EmailLocaleIDs | FooterLocaleIDs&#125;_id&#96;;&#x2F;&#x2F; type AllLocaleIDs &#x3D; &quot;welcome*email_id&quot; | &quot;email_heading_id&quot; | &quot;footer_title_id&quot; | &quot;footer_sendoff_id&quot;</code></pre><ul><li>å¦‚æœæ¨¡æ¿å­—é¢é‡é‡Œçš„å¤šä¸ªå˜é‡éƒ½æ˜¯è”åˆç±»å‹ï¼Œç»“æœä¼šäº¤å‰ç›¸ä¹˜ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°±æœ‰ 2 * 2 _ 3 ä¸€å…± 12 ç§ç»“æœï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type AllLocaleIDs &#x3D; &#96;$&#123;EmailLocaleIDs | FooterLocaleIDs&#125;_id&#96;;type Lang &#x3D; &quot;en&quot; | &quot;ja&quot; | &quot;pt&quot;;type LocaleMessageIDs &#x3D; &#96;$&#123;Lang&#125;_$&#123;AllLocaleIDs&#125;&#96;;&#x2F;&#x2F; type LocaleMessageIDs &#x3D; &quot;en_welcome_email_id&quot; | &quot;en_email_heading_id&quot; | &quot;en_footer_title_id&quot; | &quot;en_footer_sendoff_id&quot; | &quot;ja_welcome_email_id&quot; | &quot;ja_email_heading_id&quot; | &quot;ja_footer_title_id&quot; | &quot;ja_footer_sendoff_id&quot; | &quot;pt_welcome_email_id&quot; | &quot;pt_email_heading_id&quot; | &quot;pt_footer_title_id&quot; | &quot;pt_footer_sendoff_id&quot;</code></pre><ul><li>å¦‚æœçœŸçš„æ˜¯éå¸¸é•¿çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼Œæ¨èæå‰ç”Ÿæˆï¼Œè¿™ç§è¿˜æ˜¯é€‚ç”¨äºçŸ­ä¸€äº›çš„æƒ…å†µã€‚</li></ul><h2 id="ç±»å‹ä¸­çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼ˆString-Unions-in-Typesï¼‰"><a href="#ç±»å‹ä¸­çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼ˆString-Unions-in-Typesï¼‰" class="headerlink" title="ç±»å‹ä¸­çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼ˆString Unions in Typesï¼‰"></a>ç±»å‹ä¸­çš„å­—ç¬¦ä¸²è”åˆç±»å‹ï¼ˆString Unions in Typesï¼‰</h2><p>æ¨¡æ¿å­—é¢é‡æœ€æœ‰ç”¨çš„åœ°æ–¹åœ¨äºä½ å¯ä»¥åŸºäºä¸€ä¸ªç±»å‹å†…éƒ¨çš„ä¿¡æ¯ï¼Œå®šä¹‰ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š</p><p>æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•° makeWatchedObjectï¼Œ å®ƒä¼šç»™ä¼ å…¥çš„å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ª on æ–¹æ³•ã€‚åœ¨ JavaScript ä¸­ï¼Œå®ƒçš„è°ƒç”¨çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼šmakeWatchedObject(baseObject)ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªä¼ å…¥å¯¹è±¡ä¸ºï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const passedObject &#x3D; &#123;  firstName: &quot;Saoirse&quot;,  lastName: &quot;Ronan&quot;,  age: 26,&#125;;</code></pre><p>è¿™ä¸ª on æ–¹æ³•ä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ªä¼ å…¥å¯¹è±¡ä¸Šï¼Œè¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼ŒeventName ï¼ˆ string ç±»å‹ï¼‰ å’Œ callBack ï¼ˆfunction ç±»å‹ï¼‰ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; ä¼ªä»£ç const result &#x3D; makeWatchedObject(baseObject);result.on(eventName, callBack);</code></pre><p>æˆ‘ä»¬å¸Œæœ› eventName æ˜¯è¿™ç§å½¢å¼ï¼šattributeInThePassedObject + â€œChangedâ€ ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œ</p><ul><li>passedObject æœ‰ä¸€ä¸ªå±æ€§ firstNameï¼Œå¯¹åº”äº§ç”Ÿçš„ eventName ä¸º firstNameChangedï¼Œ</li><li>åŒç†ï¼ŒlastName å¯¹åº”çš„æ˜¯ lastNameChangedï¼Œ</li><li>age å¯¹åº”çš„æ˜¯ ageChangedã€‚</li></ul><p>å½“è¿™ä¸ª callBack å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼š</p><ul><li>åº”è¯¥è¢«ä¼ å…¥ä¸ attributeInThePassedObject ç›¸åŒç±»å‹çš„å€¼ã€‚æ¯”å¦‚ passedObject ä¸­ï¼Œ<ul><li>firstName çš„å€¼çš„ç±»å‹ä¸º string , å¯¹åº” firstNameChanged äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œåˆ™æ¥å—ä¼ å…¥ä¸€ä¸ª string ç±»å‹çš„å€¼ã€‚</li><li>age çš„å€¼çš„ç±»å‹ä¸º numberï¼Œå¯¹åº” ageChanged äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œåˆ™æ¥å—ä¼ å…¥ä¸€ä¸ª number ç±»å‹çš„å€¼ã€‚</li></ul></li><li>è¿”å›å€¼ç±»å‹ä¸º void ç±»å‹ã€‚<br>on() æ–¹æ³•çš„ç­¾åæœ€ä¸€å¼€å§‹æ˜¯è¿™æ ·çš„ï¼šon(eventName: string, callBack: (newValue: any) &#x3D;&gt; void)ã€‚ ä½¿ç”¨è¿™æ ·çš„ç­¾åï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½å®ç°ä¸Šé¢æ‰€è¯´çš„è¿™äº›çº¦æŸçš„ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ¨¡æ¿å­—é¢é‡ï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const person &#x3D; makeWatchedObject(&#123;  firstName: &quot;Saoirse&quot;,  lastName: &quot;Ronan&quot;,  age: 26,&#125;);&#x2F;&#x2F; makeWatchedObject has added &#96;on&#96; to the anonymous Objectperson.on(&quot;firstNameChanged&quot;, (newValue) &#x3D;&gt; &#123;  console.log(&#96;firstName was changed to $&#123;newValue&#125;!&#96;);&#125;);</code></pre><p>æ³¨æ„è¿™ä¸ªä¾‹å­é‡Œï¼Œon æ–¹æ³•æ·»åŠ çš„äº‹ä»¶åä¸º â€œfirstNameChangedâ€ï¼Œ è€Œä¸ä»…ä»…æ˜¯ â€œfirstNameâ€ï¼Œè€Œå›è°ƒå‡½æ•°ä¼ å…¥çš„å€¼ newValue ï¼Œæˆ‘ä»¬å¸Œæœ›çº¦æŸä¸º string ç±»å‹ã€‚æˆ‘ä»¬å…ˆå®ç°ç¬¬ä¸€ç‚¹ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›ä¼ å…¥çš„äº‹ä»¶åçš„ç±»å‹ï¼Œæ˜¯å¯¹è±¡å±æ€§åçš„è”åˆï¼Œåªæ˜¯æ¯ä¸ªè”åˆæˆå‘˜éƒ½è¿˜åœ¨æœ€åæ‹¼æ¥ä¸€ä¸ª Changed å­—ç¬¦ï¼Œåœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åšè¿™æ ·ä¸€ä¸ªè®¡ç®—ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">Object.keys(passedObject).map(x &#x3D;&gt; $&#123;x&#125;Changed)</code></pre><p>æ¨¡æ¿å­—é¢é‡æä¾›äº†ä¸€ä¸ªç›¸ä¼¼çš„å­—ç¬¦ä¸²æ“ä½œï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type PropEventSource&lt;Type&gt; &#x3D; &#123;  on(    eventName: &#96;$&#123;string &amp; keyof Type&#125;Changed&#96;,    callback: (newValue: any) &#x3D;&gt; void  ): void;&#125;;&#x2F;&#x2F;&#x2F; Create a &quot;watched object&quot; with an &#39;on&#39; method&#x2F;&#x2F;&#x2F; so that you can watch for changes to properties.declare function makeWatchedObject&lt;Type&gt;(  obj: Type): Type &amp; PropEventSource&lt;Type&gt;;</code></pre><p>æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¾‹å­ä¸­ï¼Œæ¨¡æ¿å­—é¢é‡é‡Œæˆ‘ä»¬å†™çš„æ˜¯ string &amp; keyof Typeï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥åªå†™æˆ keyof Type å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬è¿™æ ·å†™ï¼Œä¼šæŠ¥é”™ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type PropEventSource&lt;Type&gt; &#x3D; &#123;  on(    eventName: &#96;$&#123;keyof Type&#125;Changed&#96;,    callback: (newValue: any) &#x3D;&gt; void  ): void;&#125;;&#x2F;&#x2F; Type &#39;keyof Type&#39; is not assignable to type &#39;string | number | bigint | boolean | null | undefined&#39;.&#x2F;&#x2F; Type &#39;string | number | symbol&#39; is not assignable to type &#39;string | number | bigint | boolean | null | undefined&#39;.&#x2F;&#x2F; ...</code></pre><p>ä»æŠ¥é”™ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæŠ¥é”™åŸå› ï¼Œåœ¨ ã€ŠTypeScript ç³»åˆ—ä¹‹ Keyof æ“ä½œç¬¦ã€‹é‡Œï¼Œæˆ‘ä»¬çŸ¥é“</p><ul><li>keyof æ“ä½œç¬¦ä¼šè¿”å› string | number | symbol ç±»å‹ï¼Œ</li><li>ä½†æ˜¯æ¨¡æ¿å­—é¢é‡çš„å˜é‡è¦æ±‚çš„ç±»å‹å´æ˜¯ string | number | bigint | boolean | null | undefinedï¼Œ</li></ul><p>æ¯”è¾ƒä¸€ä¸‹ï¼Œå¤šäº†ä¸€ä¸ª symbol ç±»å‹ï¼Œæ‰€ä»¥å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type PropEventSource&lt;Type&gt; &#x3D; &#123;  on(    eventName: &#96;$&#123;Exclude&lt;keyof Type, symbol&gt;&#125;Changed&#96;,    callback: (newValue: any) &#x3D;&gt; void  ): void;&#125;;</code></pre><p>å†æˆ–è€…è¿™æ ·å†™ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type PropEventSource&lt;Type&gt; &#x3D; &#123;  on(    eventName: &#96;$&#123;Extract&lt;keyof Type, string&gt;&#125;Changed&#96;,    callback: (newValue: any) &#x3D;&gt; void  ): void;&#125;;</code></pre><p>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨é”™è¯¯çš„äº‹ä»¶åæ—¶ï¼ŒTypeScript ä¼šç»™å‡ºæŠ¥é”™ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const person &#x3D; makeWatchedObject(&#123;  firstName: &quot;Saoirse&quot;,  lastName: &quot;Ronan&quot;,  age: 26,&#125;);person.on(&quot;firstNameChanged&quot;, () &#x3D;&gt; &#123;&#125;);&#x2F;&#x2F; Prevent easy human error (using the key instead of the event name)person.on(&quot;firstName&quot;, () &#x3D;&gt; &#123;&#125;);&#x2F;&#x2F; Argument of type &#39;&quot;firstName&quot;&#39; is not assignable to parameter of type &#39;&quot;firstNameChanged&quot; | &quot;lastNameChanged&quot; | &quot;ageChanged&quot;&#39;.&#x2F;&#x2F; It&#39;s typo-resistantperson.on(&quot;frstNameChanged&quot;, () &#x3D;&gt; &#123;&#125;);&#x2F;&#x2F; Argument of type &#39;&quot;frstNameChanged&quot;&#39; is not assignable to parameter of type &#39;&quot;firstNameChanged&quot; | &quot;lastNameChanged&quot; | &quot;ageChanged&quot;&#39;.</code></pre><h2 id="æ¨¡æ¿å­—é¢é‡çš„æ¨æ–­ï¼ˆInference-with-Template-Literalsï¼‰"><a href="#æ¨¡æ¿å­—é¢é‡çš„æ¨æ–­ï¼ˆInference-with-Template-Literalsï¼‰" class="headerlink" title="æ¨¡æ¿å­—é¢é‡çš„æ¨æ–­ï¼ˆInference with Template Literalsï¼‰"></a>æ¨¡æ¿å­—é¢é‡çš„æ¨æ–­ï¼ˆInference with Template Literalsï¼‰</h2><p>ç°åœ¨æˆ‘ä»¬æ¥å®ç°ç¬¬äºŒç‚¹ï¼Œå›è°ƒå‡½æ•°ä¼ å…¥çš„å€¼çš„ç±»å‹ä¸å¯¹åº”çš„å±æ€§å€¼çš„ç±»å‹ç›¸åŒã€‚<br>æˆ‘ä»¬ç°åœ¨åªæ˜¯ç®€å•çš„å¯¹ callBack çš„å‚æ•°ä½¿ç”¨ any ç±»å‹ã€‚å®ç°è¿™ä¸ªçº¦æŸçš„å…³é”®åœ¨äºå€ŸåŠ©æ³›å‹å‡½æ•°ï¼š</p><p>æ•è·æ³›å‹å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„å­—é¢é‡ï¼Œç”Ÿæˆä¸€ä¸ªå­—é¢é‡ç±»å‹</p><ul><li>è¯¥å­—é¢é‡ç±»å‹å¯ä»¥è¢«å¯¹è±¡å±æ€§æ„æˆçš„è”åˆçº¦æŸ</li><li>å¯¹è±¡å±æ€§çš„ç±»å‹å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®è·å–</li><li>åº”ç”¨æ­¤ç±»å‹ï¼Œç¡®ä¿å›è°ƒå‡½æ•°çš„å‚æ•°ç±»å‹ä¸å¯¹è±¡å±æ€§çš„ç±»å‹æ˜¯åŒä¸€ä¸ªç±»å‹</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type PropEventSource&lt;Type&gt; &#x3D; &#123;  on&lt;Key extends string &amp; keyof Type&gt;(    eventName: &#96;$&#123;Key&#125;Changed&#96;,    callback: (newValue: Type[Key]) &#x3D;&gt; void  ): void;&#125;;declare function makeWatchedObject&lt;Type&gt;(  obj: Type): Type &amp; PropEventSource&lt;Type&gt;;const person &#x3D; makeWatchedObject(&#123;  firstName: &quot;Saoirse&quot;,  lastName: &quot;Ronan&quot;,  age: 26,&#125;);person.on(&quot;firstNameChanged&quot;, (newName) &#x3D;&gt; &#123;  &#x2F;&#x2F; (parameter) newName: string  console.log(&#96;new name is $&#123;newName.toUpperCase()&#125;&#96;);&#125;);person.on(&quot;ageChanged&quot;, (newAge) &#x3D;&gt; &#123;  &#x2F;&#x2F; (parameter) newAge: number  if (newAge &lt; 0) &#123;    console.warn(&quot;warning! negative age&quot;);  &#125;&#125;);</code></pre><p>è¿™é‡Œæˆ‘ä»¬æŠŠ on æ”¹æˆäº†ä¸€ä¸ªæ³›å‹å‡½æ•°ã€‚</p><p>å½“ä¸€ä¸ªç”¨æˆ·è°ƒç”¨çš„æ—¶å€™ä¼ å…¥ â€œfirstNameChangedâ€ï¼ŒTypeScript ä¼šå°è¯•ç€æ¨æ–­ Key æ­£ç¡®çš„ç±»å‹ã€‚å®ƒä¼šåŒ¹é… key å’Œ â€œChangedâ€ å‰çš„å­—ç¬¦ä¸² ï¼Œç„¶åæ¨æ–­å‡ºå­—ç¬¦ä¸² â€œfirstNameâ€ ï¼Œç„¶åå†è·å–åŸå§‹å¯¹è±¡çš„ firstName å±æ€§çš„ç±»å‹ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯ string ç±»å‹ã€‚</p><h2 id="å†…ç½®å­—ç¬¦æ“ä½œç±»å‹ï¼ˆIntrinsic-String-Manipulation-Typesï¼‰"><a href="#å†…ç½®å­—ç¬¦æ“ä½œç±»å‹ï¼ˆIntrinsic-String-Manipulation-Typesï¼‰" class="headerlink" title="å†…ç½®å­—ç¬¦æ“ä½œç±»å‹ï¼ˆIntrinsic String Manipulation Typesï¼‰"></a>å†…ç½®å­—ç¬¦æ“ä½œç±»å‹ï¼ˆIntrinsic String Manipulation Typesï¼‰</h2><p>TypeScript çš„ä¸€äº›ç±»å‹å¯ä»¥ç”¨äºå­—ç¬¦æ“ä½œï¼Œè¿™äº›ç±»å‹å¤„äºæ€§èƒ½çš„è€ƒè™‘è¢«å†…ç½®åœ¨ç¼–è¯‘å™¨ä¸­ï¼Œä½ ä¸èƒ½åœ¨ .d.ts æ–‡ä»¶é‡Œæ‰¾åˆ°å®ƒä»¬ã€‚</p><h2 id="Uppercase"><a href="#Uppercase" class="headerlink" title="Uppercase"></a>Uppercase</h2><p>æŠŠæ¯ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™å½¢å¼ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Greeting &#x3D; &quot;Hello, world&quot;;type ShoutyGreeting &#x3D; Uppercase&lt;Greeting&gt;;&#x2F;&#x2F; type ShoutyGreeting &#x3D; &quot;HELLO, WORLD&quot;type ASCIICacheKey&lt;Str extends string&gt; &#x3D; &#96;ID-$&#123;Uppercase&lt;Str&gt;&#125;&#96;;type MainID &#x3D; ASCIICacheKey&lt;&quot;my_app&quot;&gt;;&#x2F;&#x2F; type MainID &#x3D; &quot;ID-MY_APP&quot;</code></pre><h2 id="Lowercase"><a href="#Lowercase" class="headerlink" title="Lowercase"></a>Lowercase</h2><p>æŠŠæ¯ä¸ªå­—ç¬¦è½¬ä¸ºå°å†™å½¢å¼ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Greeting &#x3D; &quot;Hello, world&quot;;type QuietGreeting &#x3D; Lowercase&lt;Greeting&gt;;&#x2F;&#x2F; type QuietGreeting &#x3D; &quot;hello, world&quot;type ASCIICacheKey&lt;Str extends string&gt; &#x3D; &#96;id-$&#123;Lowercase&lt;Str&gt;&#125;&#96;;type MainID &#x3D; ASCIICacheKey&lt;&quot;MY_APP&quot;&gt;;&#x2F;&#x2F; type MainID &#x3D; &quot;id-my_app&quot;</code></pre><h2 id="Capitalize"><a href="#Capitalize" class="headerlink" title="Capitalize"></a>Capitalize</h2><ul><li>æŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™å½¢å¼ï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type LowercaseGreeting &#x3D; &quot;hello, world&quot;;type Greeting &#x3D; Capitalize&lt;LowercaseGreeting&gt;;&#x2F;&#x2F; type Greeting &#x3D; &quot;Hello, world&quot;</code></pre><h2 id="Uncapitalize"><a href="#Uncapitalize" class="headerlink" title="Uncapitalize"></a>Uncapitalize</h2><ul><li>æŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå°å†™å½¢å¼ï¼š</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type UppercaseGreeting &#x3D; &quot;HELLO WORLD&quot;;type UncomfortableGreeting &#x3D; Uncapitalize&lt;UppercaseGreeting&gt;;&#x2F;&#x2F; type UncomfortableGreeting &#x3D; &quot;hELLO WORLD&quot;</code></pre><ul><li>å­—ç¬¦æ“ä½œç±»å‹çš„æŠ€æœ¯ç»†èŠ‚<br>ä» TypeScript 4.1 èµ·ï¼Œè¿™äº›å†…ç½®å‡½æ•°ä¼šç›´æ¥ä½¿ç”¨ JavaScript å­—ç¬¦ä¸²è¿è¡Œæ—¶å‡½æ•°ï¼Œè€Œä¸æ˜¯æœ¬åœ°åŒ–è¯†åˆ« (locale aware)ã€‚</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function applyStringMapping(symbol: Symbol, str: string) &#123;  switch (intrinsicTypeKinds.get(symbol.escapedName as string)) &#123;    case IntrinsicTypeKind.Uppercase:      return str.toUpperCase();    case IntrinsicTypeKind.Lowercase:      return str.toLowerCase();    case IntrinsicTypeKind.Capitalize:      return str.charAt(0).toUpperCase() + str.slice(1);    case IntrinsicTypeKind.Uncapitalize:      return str.charAt(0).toLowerCase() + str.slice(1);  &#125;  return str;&#125;</code></pre><p>ä½œè€…ï¼šå†´ç¾½<br>é“¾æ¥ï¼š<a href="https://www.imooc.com/article/322215">https://www.imooc.com/article/322215</a><br>æ¥æºï¼šæ…•è¯¾ç½‘<br>æœ¬æ–‡åŸåˆ›å‘å¸ƒäºæ…•è¯¾ç½‘ ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œè°¢è°¢åˆä½œ</p><h2 id="åœ¨æƒ³ä¸€ä¸ªé—®é¢˜"><a href="#åœ¨æƒ³ä¸€ä¸ªé—®é¢˜" class="headerlink" title="åœ¨æƒ³ä¸€ä¸ªé—®é¢˜"></a>åœ¨æƒ³ä¸€ä¸ªé—®é¢˜</h2><p>ä¸ºä»€ä¹ˆåˆ«äººå¯ä»¥æŠŠæ–‡æ¡£ç¿»è¯‘çš„é‚£ä¹ˆå‡†ç¡®ï¼Œè®©è¯»è€…ä¸€çœ‹å°±æ˜ç™½</p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>6.Typescriptæ‰‹å†Œ å¯¹è±¡ç±»å‹</title>
      <link href="//post/2022-06-08ts-object-types.html"/>
      <url>//post/2022-06-08ts-object-types.html</url>
      
        <content type="html"><![CDATA[<p>In JavaScript, the fundamental way that we group and pass around data is through objects. In TypeScript, we represent those through object types.<br><code>åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹è±¡æ¥ç»„ç»‡å’Œä¼ é€’æ•°æ®ã€‚åœ¨ TypeScript ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹è±¡ç±»å‹æ¥è¡¨ç¤ºè¿™äº›å¯¹è±¡ã€‚</code><br>As weâ€™ve seen, they can be anonymous:<br><code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬å¯ä»¥æ˜¯åŒ¿åçš„ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function greet(person: &#123; name: string; age: number &#125;) &#123;  return &quot;Hello &quot; + person.name;&#125;</code></pre><p>or they can be named by using either an interface<br><code>æˆ–è€…ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨æ¥å£æ¥å‘½å</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Person &#123;  name: string;  age: number;&#125;function greet(person: Person) &#123;  return &quot;Hello &quot; + person.name;&#125;</code></pre><p>or a type alias.<br><code>æˆ–è€…ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨ç±»å‹åˆ«å</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">type Person &#x3D; &#123;  name: string;  age: number;&#125;;function greet(person: Person) &#123;  return &quot;Hello &quot; + person.name;&#125;</code></pre><p>In all three examples above, weâ€™ve written functions that take objects that contain the property name (which must be a string) and age (which must be a number).<br><code>åœ¨ä¸Šé¢ä¸‰ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»å†™äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—åŒ…å«å±æ€§ nameï¼ˆå¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼‰å’Œ ageï¼ˆå¿…é¡»æ˜¯æ•°å­—ï¼‰çš„å¯¹è±¡ã€‚</code></p><h2 id="Property-Modifiers"><a href="#Property-Modifiers" class="headerlink" title="Property Modifiers"></a>Property Modifiers</h2><p><code>å±æ€§ä¿®é¥°ç¬¦</code><br>Each property in an object type can specify a couple of things: the type, whether the property is optional, and whether the property can be written to.<br><code>å¯¹è±¡ç±»å‹ä¸­çš„æ¯ä¸ªå±æ€§éƒ½å¯ä»¥æŒ‡å®šä¸€äº›ä¸œè¥¿ï¼šç±»å‹ã€æ˜¯å¦æ˜¯å¯é€‰çš„ï¼Œä»¥åŠæ˜¯å¦å¯ä»¥å†™å…¥ã€‚</code></p><h2 id="Optional-Properties"><a href="#Optional-Properties" class="headerlink" title="Optional Properties"></a>Optional Properties</h2><p><code>å¯é€‰å±æ€§</code><br>Much of the time, weâ€™ll find ourselves dealing with objects that might have a property set. In those cases, we can mark those properties as optional by adding a question mark (?) to the end of their names.<br><code>å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬åœ¨å¯¹å¯¹è±¡è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæœ‰å±æ€§è¢«è®¾ç½®ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å±æ€§åçš„æœ«å°¾æ·»åŠ é—®å·æ¥æ ‡è®°è¿™äº›å±æ€§ä¸ºå¯é€‰çš„ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface PaintOptions &#123;  shape: Shape;  xPos?: number;  yPos?: number;&#125;function paintShape(opts: PaintOptions) &#123;  &#x2F;&#x2F; ...&#125;const shape &#x3D; getShape();paintShape(&#123; shape &#125;);paintShape(&#123; shape, xPos: 100 &#125;);paintShape(&#123; shape, yPos: 100 &#125;);paintShape(&#123; shape, xPos: 100, yPos: 100 &#125;);</code></pre><p>In this example, both xPos and yPos are considered optional. We can choose to provide either of them, so every call above to paintShape is valid. All optionality really says is that if the property is set, it better have a specific type.<br><code>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒxPoså’ŒyPoséƒ½è¢«è®¤ä¸ºæ˜¯å¯é€‰çš„ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æä¾›å…¶ä¸­ä¸€ä¸ªï¼Œå› æ­¤æ¯æ¬¡è°ƒç”¨paintShapeéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚æ‰€æœ‰çš„å¯é€‰æ€§éƒ½è¯´æ˜¯ï¼Œå¦‚æœå±æ€§è¢«è®¾ç½®ï¼Œå®ƒåº”è¯¥æœ‰ä¸€ä¸ªç‰¹å®šçš„ç±»å‹ã€‚</code><br>We can also read from those properties - but when we do under strictNullChecks, TypeScript will tell us theyâ€™re potentially undefined.<br><code>æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯»å–è¿™äº›å±æ€§ï¼Œä½†æ˜¯åœ¨ä¸¥æ ¼çš„ null æ£€æŸ¥ä¸‹ï¼ŒTypeScript å°†ä¼šå‘Šè¯‰æˆ‘ä»¬è¿™äº›å±æ€§å¯èƒ½æ˜¯ undefinedã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function paintShape(opts: PaintOptions) &#123;  let xPos &#x3D; opts.xPos;  &#x2F;&#x2F; (property) PaintOptions.xPos?: number | undefined  let yPos &#x3D; opts.yPos;  &#x2F;&#x2F; (property) PaintOptions.yPos?: number | undefined  &#x2F;&#x2F; ...&#125;</code></pre><p>In JavaScript, even if the property has never been set, we can still access it - itâ€™s just going to give us the value undefined. We can just handle undefined specially.<br><code>åœ¨ JavaScript ä¸­ï¼Œå³ä½¿å±æ€§æ²¡æœ‰è¢«è®¾ç½®ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—®å®ƒï¼Œå®ƒåªæ˜¯ç»™æˆ‘ä»¬ä¸€ä¸ªå€¼ undefinedã€‚æˆ‘ä»¬å¯ä»¥ç‰¹åˆ«å¤„ç† undefinedã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function paintShape(opts: PaintOptions) &#123;  let xPos &#x3D; opts.xPos &#x3D;&#x3D;&#x3D; undefined ? 0 : opts.xPos;  &#x2F;&#x2F; let xPos: number;  let yPos &#x3D; opts.yPos &#x3D;&#x3D;&#x3D; undefined ? 0 : opts.yPos;  &#x2F;&#x2F; let yPos: number;  &#x2F;&#x2F; ...&#125;</code></pre><p>Note that this pattern of setting defaults for unspecified values is so common that JavaScript has syntax to support it.<br><code>æ³¨æ„ï¼Œè¿™ç§è®¾ç½®é»˜è®¤å€¼çš„æ–¹å¼å¾ˆå¸¸è§ï¼Œå› æ­¤ JavaScript æœ‰ä¸€ç§è¯­æ³•æ¥æ”¯æŒå®ƒã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function paintShape(&#123; shape, xPos &#x3D; 0, yPos &#x3D; 0 &#125;: PaintOptions) &#123;  console.log(&quot;x coordinate at&quot;, xPos);  &#x2F;&#x2F; (parameter) xPos: number  console.log(&quot;y coordinate at&quot;, yPos);  &#x2F;&#x2F; (parameter) yPos: number  &#x2F;&#x2F; ...&#125;</code></pre><p>Here we used a destructuring pattern for paintShapeâ€™s parameter, and provided default values for xPos and yPos. Now xPos and yPos are both definitely present within the body of paintShape, but optional for any callers to paintShape.<br><code>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† paintShape çš„å‚æ•°çš„ææ„æ¨¡å¼ï¼Œå¹¶ä¸º xPos å’Œ yPos æä¾›äº†é»˜è®¤å€¼ã€‚ç°åœ¨ xPos å’Œ yPos åœ¨ paintShape çš„ä¸»ä½“ä¸­éƒ½æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯ä»»ä½•è°ƒç”¨è€…è°ƒç”¨ paintShape çš„å€¼éƒ½æ˜¯å¯é€‰çš„ã€‚</code><br>Note that there is currently no way to place type annotations within destructuring patterns. This is because the following syntax already means something different in JavaScript.<br><code>æ³¨æ„ï¼Œç›®å‰æ²¡æœ‰åŠæ³•åœ¨ææ„æ¨¡å¼ä¸­æ”¾ç½®ç±»å‹æ ‡æ³¨ã€‚å› ä¸ºè¿™ä¸ªè¯­æ³•å·²ç»åœ¨ JavaScript ä¸­è¡¨ç¤ºäº†ä¸åŒçš„æ„æ€ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function draw(&#123; shape: Shape, xPos: number &#x3D; 100 &#x2F;_..._&#x2F; &#125;) &#123;render(shape);&#x2F;&#x2F; Cannot find name &#39;shape&#39;. Did you mean &#39;Shape&#39;?render(xPos);&#x2F;&#x2F; Cannot find name &#39;xPos&#39;.&#125;</code></pre><p>In an object destructuring pattern, shape: Shape means â€œgrab the property shape and redefine it locally as a variable named Shape. Likewise xPos: number creates a variable named number whose value is based on the parameterâ€™s xPos.<br><code>åœ¨ä¸€ä¸ªå¯¹è±¡ææ„æ¨¡å¼ä¸­ï¼Œshape: Shape è¡¨ç¤ºâ€œæŠ“å–å±æ€§ shape å¹¶é‡æ–°å®šä¹‰å®ƒä½œä¸ºåä¸º Shape çš„å˜é‡ã€‚åŒæ ·çš„ï¼ŒxPos: number åˆ›å»ºäº†ä¸€ä¸ªåä¸º number çš„å˜é‡ï¼Œå…¶å€¼æ˜¯åŸºäºå‚æ•°çš„ xPosã€‚</code><br>Using mapping modifiers, you can remove optional attributes.<br><code>ä½¿ç”¨æ˜ å°„ä¿®é¥°ç¬¦ï¼Œä½ å¯ä»¥ç§»é™¤å¯é€‰å±æ€§ã€‚</code></p><h2 id="Readonly-Properties"><a href="#Readonly-Properties" class="headerlink" title="Readonly Properties"></a>Readonly Properties</h2><p><code>åªè¯»å±æ€§</code><br>Properties can also be marked as readonly for TypeScript. While it wonâ€™t change any behavior at runtime, a property marked as readonly canâ€™t be written to during type-checking.<br><code>åªè¯»å±æ€§</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface SomeType &#123;  readonly prop: string;&#125;function doSomething(obj: SomeType) &#123;  &#x2F;&#x2F; We can read from &#39;obj.prop&#39;.  console.log(&#96;prop has the value &#39;$&#123;obj.prop&#125;&#39;.&#96;);  &#x2F;&#x2F; But we can&#39;t re-assign it.  obj.prop &#x3D; &quot;hello&quot;;  &#x2F;&#x2F; Cannot assign to &#39;prop&#39; because it is a read-only property.&#125;</code></pre><p>Using the readonly modifier doesnâ€™t necessarily imply that a value is totally immutable - or in other words, that its internal contents canâ€™t be changed. It just means the property itself canâ€™t be re-written to.<br><code>ä½¿ç”¨ readonly ä¿®é¥°ç¬¦å¹¶ä¸æ„å‘³ç€ä¸€ä¸ªå€¼æ˜¯å®Œå…¨ä¸å¯å˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„å†…éƒ¨å†…å®¹ä¸èƒ½è¢«æ”¹å˜ã€‚å®ƒåªæ˜¯è¯´ï¼Œå±æ€§æœ¬èº«ä¸èƒ½è¢«é‡å†™ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Home &#123;  readonly resident: &#123; name: string; age: number &#125;;&#125;function visitForBirthday(home: Home) &#123;  &#x2F;&#x2F; We can read and update properties from &#39;home.resident&#39;.  &#x2F;&#x2F; æˆ‘ä»¬å¯ä»¥ä» &#39;home.resident&#39; ä¸­è¯»å–å’Œæ›´æ–°å±æ€§ã€‚  console.log(&#96;Happy birthday $&#123;home.resident.name&#125;!&#96;);  home.resident.age++;&#125;function evict(home: Home) &#123;  &#x2F;&#x2F; But we can&#39;t write to the &#39;resident&#39; property itself on a &#39;Home&#39;.  &#x2F;&#x2F; ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨ &#39;Home&#39; ä¸Šå†™å…¥ &#39;resident&#39; å±æ€§ã€‚  home.resident &#x3D; &#123;    &#x2F;&#x2F; Cannot assign to &#39;resident&#39; because it is a read-only property.    name: &quot;Victor the Evictor&quot;,    age: 42,  &#125;;&#125;</code></pre><p>Itâ€™s important to manage expectations of what readonly implies. Itâ€™s useful to signal intent during development time for TypeScript on how an object should be used. TypeScript doesnâ€™t factor in whether properties on two types are readonly when checking whether those types are compatible, so readonly properties can also change via aliasing.</p><p><strong>æ³¨æ„</strong></p><p><code>TypeScript åœ¨æ£€æŸ¥ä¸¤ä¸ªç±»å‹æ˜¯å¦å…¼å®¹çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šè€ƒè™‘ä¸¤ä¸ªç±»å‹é‡Œçš„å±æ€§æ˜¯å¦æ˜¯ readonlyï¼Œè¿™å°±æ„å‘³ç€ï¼Œreadonly çš„å€¼æ˜¯å¯ä»¥é€šè¿‡åˆ«åä¿®æ”¹çš„ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Person &#123;  name: string;  age: number;&#125;interface ReadonlyPerson &#123;  readonly name: string;  readonly age: number;&#125;let writablePerson: Person &#x3D; &#123;  name: &quot;Person McPersonface&quot;,  age: 42,&#125;;&#x2F;&#x2F; workslet readonlyPerson: ReadonlyPerson &#x3D; writablePerson;console.log(readonlyPerson.age); &#x2F;&#x2F; prints &#39;42&#39;writablePerson.age++;console.log(readonlyPerson.age); &#x2F;&#x2F; prints &#39;43&#39;</code></pre><p>Using mapping modifiers, you can remove readonly attributes.</p><h2 id="Index-Signatures"><a href="#Index-Signatures" class="headerlink" title="Index Signatures"></a>Index Signatures</h2><p><code>ç´¢å¼•ç­¾å</code><br>Sometimes you donâ€™t know all the names of a typeâ€™s properties ahead of time, but you do know the shape of the values.<br><code>æœ‰æ—¶å€™ï¼Œä½ ä¸çŸ¥é“ä¸€ä¸ªç±»å‹çš„æ‰€æœ‰å±æ€§çš„åå­—ï¼Œä½†æ˜¯ä½ çŸ¥é“å€¼çš„å½¢çŠ¶ã€‚</code></p><p>In those cases you can use an index signature to describe the types of possible values, for example:<br><code>åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ç´¢å¼•ç­¾åæ¥æè¿°å¯èƒ½çš„å€¼çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface StringArray &#123;  [index: number]: string;&#125;const myArray: StringArray &#x3D; getStringArray();const secondItem &#x3D; myArray[1];const secondItem: string;</code></pre><p>Above, we have a StringArray interface which has an index signature. This index signature states that when a StringArray is indexed with a number, it will return a string.<br><code>ä¸Šé¢ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª StringArray æ¥å£ï¼Œå®ƒæœ‰ä¸€ä¸ªç´¢å¼•ç­¾åã€‚è¿™ä¸ªç´¢å¼•ç­¾åè¯´æ˜ï¼Œå½“ä¸€ä¸ª StringArray è¢«ç´¢å¼•ä¸ºä¸€ä¸ªæ•°å­—æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</code><br>An index signature property type must be either â€˜stringâ€™ or â€˜numberâ€™.<br><code>ç´¢å¼•ç­¾åå±æ€§ç±»å‹å¿…é¡»æ˜¯â€˜stringâ€™æˆ–â€˜numberâ€™ã€‚</code><br>It is possible to support both types of indexersâ€¦<br><code>å¯ä»¥æ”¯æŒä¸¤ç§ç±»å‹çš„ç´¢å¼•å™¨...</code></p><p>While string index signatures are a powerful way to describe the â€œdictionaryâ€ pattern, they also enforce that all properties match their return type. This is because a string index declares that obj.property is also available as obj[â€œpropertyâ€]. In the following example, nameâ€™s type does not match the string indexâ€™s type, and the type checker gives an error:<br><code>å°½ç®¡å­—ç¬¦ä¸²ç´¢å¼•ç”¨æ¥æè¿°å­—å…¸æ¨¡å¼ï¼ˆdictionary patternï¼‰éå¸¸çš„æœ‰æ•ˆï¼Œä½†ä¹Ÿä¼šå¼ºåˆ¶è¦æ±‚æ‰€æœ‰çš„å±æ€§è¦åŒ¹é…ç´¢å¼•ç­¾åçš„è¿”å›ç±»å‹ã€‚è¿™æ˜¯å› ä¸ºä¸€ä¸ªå£°æ˜ç±»ä¼¼äº obj.property çš„å­—ç¬¦ä¸²ç´¢å¼•ï¼Œè·Ÿ obj[&quot;property&quot;]æ˜¯ä¸€æ ·çš„ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œname çš„ç±»å‹å¹¶ä¸åŒ¹é…å­—ç¬¦ä¸²ç´¢å¼•çš„ç±»å‹ï¼Œæ‰€ä»¥ç±»å‹æ£€æŸ¥å™¨ä¼šç»™å‡ºæŠ¥é”™ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface NumberDictionary &#123;  [index: string]: number;  length: number; &#x2F;&#x2F; ok  name: string;  &#x2F;&#x2F; Property &#39;name&#39; of type &#39;string&#39; is not assignable to &#39;string&#39; index type &#39;number&#39;.&#125;</code></pre><p>However, properties of different types are acceptable if the index signature is a union of the property types:<br><code>ä½†æ˜¯ï¼Œä¸åŒç±»å‹çš„å±æ€§æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¦‚æœç´¢å¼•ç­¾åæ˜¯å±æ€§ç±»å‹çš„è”åˆï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface NumberOrStringDictionary &#123;  [index: string]: number | string;  length: number; &#x2F;&#x2F; ok, length is a number  name: string; &#x2F;&#x2F; ok, name is a string&#125;</code></pre><p>Finally, you can make index signatures readonly in order to prevent assignment to their indices:<br><code>æœ€åï¼Œä½ å¯ä»¥ä½¿ç´¢å¼•ç­¾åå˜æˆåªè¯»ï¼Œä»¥é˜²æ­¢ç´¢å¼•èµ‹å€¼ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface ReadonlyStringArray &#123;  readonly [index: number]: string;&#125;let myArray: ReadonlyStringArray &#x3D; getReadOnlyStringArray();myArray[2] &#x3D; &quot;Mallory&quot;;&#x2F;&#x2F; Index signature in type &#39;ReadonlyStringArray&#39; only permits reading.</code></pre><p>You canâ€™t set myArray[2] because the index signature is readonly.<br><code>ä½ ä¸èƒ½è®¾ç½® myArray[2]ï¼Œå› ä¸ºç´¢å¼•ç­¾åæ˜¯åªè¯»çš„ã€‚</code></p><h2 id="Extending-Types"><a href="#Extending-Types" class="headerlink" title="Extending Types"></a>Extending Types</h2><p><code>æ‰©å±•ç±»å‹</code><br>Itâ€™s pretty common to have types that might be more specific versions of other types. For example, we might have a BasicAddress type that describes the fields necessary for sending letters and packages in the U.S.<br><code>æˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªåŸºæœ¬çš„åœ°å€ç±»å‹ï¼Œå®ƒæè¿°äº†åœ¨ç¾å›½å‘é€ä¿¡ä»¶å’ŒåŒ…è£¹çš„å¿…è¦å­—æ®µã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface BasicAddress &#123;  name?: string;  street: string;  city: string;  country: string;  postalCode: string;&#125;</code></pre><p>In some situations thatâ€™s enough, but addresses often have a unit number associated with them if the building at an address has multiple units. We can then describe an AddressWithUnit.<br><code>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ ·å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯åœ°å€æœ‰æ—¶å€™ä¼šæœ‰å•å…ƒå·ç ï¼Œå¦‚æœåœ°å€çš„å»ºç­‘æœ‰å¤šä¸ªå•å…ƒã€‚æˆ‘ä»¬å¯ä»¥æè¿°ä¸€ä¸ª AddressWithUnitã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface AddressWithUnit &#123;  name?: string;  unit: string;  street: string;  city: string;  country: string;  postalCode: string;&#125;</code></pre><p>This does the job, but the downside here is that we had to repeat all the other fields from BasicAddress when our changes were purely additive. Instead, we can extend the original BasicAddress type and just add the new fields that are unique to AddressWithUnit.<br><code>è¿™æ ·åšå°±å¯ä»¥äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬å¿…é¡»é‡å¤æ‰€æœ‰çš„å­—æ®µæ¥è‡ª BasicAddressï¼Œå½“æˆ‘ä»¬çš„æ”¹åŠ¨åªæ˜¯å¢åŠ æ€§çš„æ—¶å€™ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±•åŸæ¥çš„ BasicAddress ç±»å‹ï¼Œå¹¶ä¸”åªéœ€è¦å¢åŠ  AddressWithUnit çš„å”¯ä¸€å­—æ®µã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface BasicAddress &#123;  name?: string;  street: string;  city: string;  country: string;  postalCode: string;&#125;interface AddressWithUnit extends BasicAddress &#123;  unit: string;&#125;</code></pre><p>The extends keyword on an interface allows us to effectively copy members from other named types, and add whatever new members we want. This can be useful for cutting down the amount of type declaration boilerplate we have to write, and for signaling intent that several different declarations of the same property might be related. For example, AddressWithUnit didnâ€™t need to repeat the street property, and because street originates from BasicAddress, a reader will know that those two types are related in some way.<br><code>åœ¨ä¸€ä¸ªæ¥å£ä¸Šä½¿ç”¨ extends å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥ä»å…¶ä»–å‘½åç±»å‹å¤åˆ¶æˆå‘˜ï¼Œå¹¶ä¸”æ·»åŠ æˆ‘ä»¬æƒ³è¦çš„æ–°æˆå‘˜ã€‚è¿™å¯ä»¥ç”¨æ¥ç¼©çŸ­æˆ‘ä»¬å†™çš„ç±»å‹å£°æ˜çš„çƒ­èº«ï¼Œä»¥åŠä¸ºåŒä¸€å±æ€§çš„å¤šä¸ªå£°æ˜æä¾›ç›¸å…³æ€§çš„ä¿¡å·ã€‚ä¾‹å¦‚ï¼ŒAddressWithUnit ä¸éœ€è¦é‡å¤ street å±æ€§ï¼Œå› ä¸º street æ¥è‡ª BasicAddressï¼Œè¯»è€…çŸ¥é“è¿™ä¸¤ä¸ªç±»å‹æ˜¯ç›¸å…³çš„ã€‚</code><br>interfaces can also extend from multiple types.<br><code>æ¥å£ä¹Ÿå¯ä»¥æ‰©å±•å¤šä¸ªç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Colorful &#123;  color: string;&#125;interface Circle &#123;  radius: number;&#125;interface ColorfulCircle extends Colorful, Circle &#123;&#125;const cc: ColorfulCircle &#x3D; &#123;  color: &quot;red&quot;,  radius: 42,&#125;;</code></pre><h2 id="Intersection-Types"><a href="#Intersection-Types" class="headerlink" title="Intersection Types"></a>Intersection Types</h2><p><code>äº¤å‰ç±»å‹</code><br>interfaces allowed us to build up new types from other types by extending them. TypeScript provides another construct called intersection types that is mainly used to combine existing object types.<br><code>æ¥å£å…è®¸æˆ‘ä»¬ä»å…¶ä»–ç±»å‹æ‰©å±•æ–°ç±»å‹ã€‚TypeScript æä¾›äº†ä¸€ç§åˆå¹¶ç°æœ‰å¯¹è±¡ç±»å‹çš„äº¤å‰ç±»å‹ã€‚</code><br>An intersection type is defined using the &amp; operator.<br><code>äº¤å‰ç±»å‹ç”¨ &amp; è¿ç®—ç¬¦å®šä¹‰ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Colorful &#123;  color: string;&#125;interface Circle &#123;  radius: number;&#125;type ColorfulCircle &#x3D; Colorful &amp; Circle;</code></pre><p>Here, weâ€™ve intersected Colorful and Circle to produce a new type that has all the members of Colorful and Circle.<br><code>è¿™é‡Œï¼Œæˆ‘ä»¬å°† Colorful å’Œ Circle è¿›è¡Œäº¤å‰ï¼Œä»¥ç”Ÿæˆä¸€ä¸ªæ–°ç±»å‹ï¼Œå®ƒåŒ…å«äº† Colorful å’Œ Circle çš„æ‰€æœ‰æˆå‘˜ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function draw(circle: Colorful &amp; Circle) &#123;  console.log(&#96;Color was $&#123;circle.color&#125;&#96;);  console.log(&#96;Radius was $&#123;circle.radius&#125;&#96;);&#125;&#x2F;&#x2F; okaydraw(&#123; color: &quot;blue&quot;, radius: 42 &#125;);&#x2F;&#x2F; oopsdraw(&#123; color: &quot;red&quot;, raidus: 42 &#125;);&#x2F;&#x2F; Argument of type &#39;&#123; color: string; raidus: number; &#125;&#39; is not assignable to parameter of type &#39;Colorful &amp; Circle&#39;.&#x2F;&#x2F; Object literal may only specify known properties, but &#39;raidus&#39; does not exist in type &#39;Colorful &amp; Circle&#39;. Did you mean to write &#39;radius&#39;?</code></pre><h2 id="Interfaces-vs-Intersections"><a href="#Interfaces-vs-Intersections" class="headerlink" title="Interfaces vs. Intersections"></a>Interfaces vs. Intersections</h2><p><code>æ¥å£ä¸äº¤å‰ç±»å‹</code><br>We just looked at two ways to combine types which are similar, but are actually subtly different. With interfaces, we could use an extends clause to extend from other types, and we were able to do something similar with intersections and name the result with a type alias. The principle difference between the two is how conflicts are handled, and that difference is typically one of the main reasons why youâ€™d pick one over the other between an interface and a type alias of an intersection type.<br><code>æˆ‘ä»¬åªçœ‹åˆ°äº†ä¸¤ç§æ–¹å¼æ¥åˆå¹¶ç±»å‹ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯æœ‰ç€å¾®å¦™çš„åŒºåˆ«ã€‚æ¥å£ä½¿ç”¨ extends å…³é”®å­—æ‰©å±•å…¶ä»–ç±»å‹ï¼Œè€Œäº¤å‰ç±»å‹ä½¿ç”¨ç±»å‹åˆ«åå®šä¹‰ã€‚æ¥å£ä¸äº¤å‰ç±»å‹ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯å¦‚ä½•å¤„ç†å†²çªï¼Œè¿™ä¸ªåŒºåˆ«é€šå¸¸æ˜¯åœ¨é€‰æ‹©ä¸€ä¸ªæ¥å£æˆ–è€…ç±»å‹åˆ«åçš„æ—¶å€™ï¼Œæ¥å£æˆ–è€…ç±»å‹åˆ«åæ˜¯å¦æ›´å¥½ã€‚</code></p><p>è¿™ä¸¤ç§æ–¹å¼åœ¨åˆå¹¶ç±»å‹ä¸Šçœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œä½†å®é™…ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤§çš„ä¸åŒã€‚æœ€åŸåˆ™æ€§çš„ä¸åŒå°±æ˜¯åœ¨äºå†²çªæ€ä¹ˆå¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯ä½ å†³å®šé€‰æ‹©é‚£ç§æ–¹å¼çš„ä¸»è¦åŸå› ã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Colorful &#123;  color: string;&#125;interface ColorfulSub extends Colorful &#123;  color: number;&#125;&#x2F;&#x2F; Interface &#39;ColorfulSub&#39; incorrectly extends interface &#39;Colorful&#39;.&#x2F;&#x2F; Types of property &#39;color&#39; are incompatible.&#x2F;&#x2F; Type &#39;number&#39; is not assignable to type &#39;string&#39;.</code></pre><p>ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œå¦‚æœé‡å†™ç±»å‹ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œä½†äº¤å‰ç±»å‹ä¸ä¼šï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Colorful &#123;  color: string;&#125;type ColorfulSub &#x3D; Colorful &amp; &#123;  color: number;&#125;;</code></pre><p>è™½ç„¶ä¸ä¼šæŠ¥é”™ï¼Œé‚£ color å±æ€§çš„ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Œç­”æ¡ˆæ˜¯ neverï¼Œå–å¾—æ˜¯ string å’Œ number çš„äº¤é›†ã€‚</p><h2 id="Generic-Object-Types"><a href="#Generic-Object-Types" class="headerlink" title="Generic Object Types"></a>Generic Object Types</h2><p><code>æ³›å‹å¯¹è±¡ç±»å‹</code><br>Letâ€™s imagine a Box type that can contain any value - strings, numbers, Giraffes, whatever.<br><code>æƒ³æƒ³ä¸€ä¸ªå¯ä»¥åŒ…å«ä»»ä½•å€¼çš„ç›’å­ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€ç‹®å­ç­‰ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Box &#123;  contents: any;&#125;</code></pre><p>Right now, the contents property is typed as any, which works, but can lead to accidents down the line.<br><code>ç°åœ¨ï¼Œcontents å±æ€§æ˜¯ä»»æ„ç±»å‹ï¼Œè¿™å°±å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯æœ‰å¯èƒ½ä¼šåœ¨æœªæ¥å‡ºç°æ„å¤–ã€‚</code><br>We could instead use unknown, but that would mean that in cases where we already know the type of contents, weâ€™d need to do precautionary checks, or use error-prone type assertions.<br><code>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ unknownï¼Œä½†æ˜¯è¿™ä¼šå¯¼è‡´åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“ contents çš„ç±»å‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›é¢„é˜²æ€§æ£€æŸ¥ï¼Œæˆ–è€…ä½¿ç”¨é”™è¯¯æ€§çš„ç±»å‹æ–­è¨€ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Box &#123;  contents: unknown;&#125;let x: Box &#x3D; &#123;  contents: &quot;hello world&quot;,&#125;;&#x2F;&#x2F; we could check &#39;x.contents&#39;if (typeof x.contents &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;  console.log(x.contents.toLowerCase());&#125;&#x2F;&#x2F; or we could use a type assertionconsole.log((x.contents as string).toLowerCase());</code></pre><p>One type safe approach would be to instead scaffold out different Box types for every type of contents.<br><code>ä¸€ç§å®‰å…¨çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠä¸åŒçš„ç›’å­ç±»å‹ç”¨äºä¸åŒçš„ç±»å‹çš„å†…å®¹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface NumberBox &#123;  contents: number;&#125;interface StringBox &#123;  contents: string;&#125;interface BooleanBox &#123;  contents: boolean;&#125;</code></pre><p>But that means weâ€™ll have to create different functions, or overloads of functions, to operate on these types.<br><code>ä½†æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸åŒçš„å‡½æ•°ï¼Œæˆ–è€…é‡è½½å‡½æ•°ï¼Œæ¥æ“ä½œè¿™äº›ç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function setContents(box: StringBox, newContents: string): void;function setContents(box: NumberBox, newContents: number): void;function setContents(box: BooleanBox, newContents: boolean): void;function setContents(box: &#123; contents: any &#125;, newContents: any) &#123;  box.contents &#x3D; newContents;&#125;</code></pre><p>Thatâ€™s a lot of boilerplate. Moreover, we might later need to introduce new types and overloads. This is frustrating, since our box types and overloads are all effectively the same.<br><code>è¿™å°±æ˜¯ä¸€å¤§å †çš„çƒ§é¥¼ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æœªæ¥æ·»åŠ æ–°çš„ç±»å‹å’Œé‡è½½ã€‚è¿™æ˜¯å›°éš¾çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›’å­ç±»å‹å’Œé‡è½½éƒ½æ˜¯ä¸€æ ·çš„ã€‚</code><br>Instead, we can make a generic Box type which declares a type parameter.<br><code>è€Œä¸æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç›’å­ç±»å‹å˜æˆæ³›å‹ç±»å‹ï¼Œå®ƒå£°æ˜äº†ä¸€ä¸ªç±»å‹å‚æ•°ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Box&lt;Type&gt; &#123;  contents: Type;&#125;</code></pre><p>You might read this as â€œA Box of Type is something whose contents have type Typeâ€. Later on, when we refer to Box, we have to give a type argument in place of Type.<br><code>ä½ å¯ä»¥è¯»è¿™ä¸ªä¸ºâ€œä¸€ä¸ªç±»å‹ä¸º Type çš„ç›’å­â€ã€‚ä¹‹åï¼Œå½“æˆ‘ä»¬å¼•ç”¨ Box æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç»™å®ƒä¸€ä¸ªç±»å‹å‚æ•°ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">let box: Box&lt;string&gt;;</code></pre><p>Think of Box as a template for a real type, where Type is a placeholder that will get replaced with some other type. When TypeScript sees Box<string>, it will replace every instance of Type in Box<Type> with string, and end up working with something like { contents: string }. In other words, Box<string> and our earlier StringBox work identically.<br><code>æƒ³æƒ³ Box&lt;string&gt; å’Œ StringBox ç±»å‹ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€æ ·çš„ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Box&lt;Type&gt; &#123;contents: Type;&#125;interface StringBox &#123;contents: string;&#125;let boxA: Box&lt;string&gt; &#x3D; &#123; contents: &quot;hello&quot; &#125;;boxA.contents;(property) Box&lt;string&gt;.contents: stringlet boxB: StringBox &#x3D; &#123; contents: &quot;world&quot; &#125;;boxB.contents;(property) StringBox.contents: string</code></pre><p>Box is reusable in that Type can be substituted with anything. That means that when we need a box for a new type, we donâ€™t need to declare a new Box type at all (though we certainly could if we wanted to).<br><code>Box å¯ä»¥é‡ç”¨ï¼Œå› ä¸º Type å¯ä»¥è¢«æ›¿æ¢æˆä»»ä½•ç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Box&lt;Type&gt; &#123;  contents: Type;&#125;interface Apple &#123;  &#x2F;&#x2F; ....&#125;&#x2F;&#x2F; Same as &#39;&#123; contents: Apple &#125;&#39;.type AppleBox &#x3D; Box&lt;Apple&gt;;</code></pre><p>This also means that we can avoid overloads entirely by instead using generic functions.</p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function setContents&lt;Type&gt;(box: Box&lt;Type&gt;, newContents: Type) &#123;  box.contents &#x3D; newContents;&#125;</code></pre><p>It is worth noting that type aliases can also be generic. We could have defined our new Box<Type> interface, which was:<br><code>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„ç›’å­ç±»å‹ï¼Œå®ƒæ˜¯ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Box&lt;Type&gt; &#123;  contents: Type;&#125;</code></pre><p>by using a type alias instead:<br><code>ä½¿ç”¨ç±»å‹åˆ«åæ¥ä»£æ›¿ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">type Box&lt;Type&gt; &#x3D; &#123;  contents: Type;&#125;;</code></pre><p>Since type aliases, unlike interfaces, can describe more than just object types, we can also use them to write other kinds of generic helper types.<br><code>ç±»å‹åˆ«åï¼Œè·Ÿæ¥å£ä¸åŒï¼Œå®ƒå¯ä»¥æè¿°é™¤äº†å¯¹è±¡ç±»å‹ä¹‹å¤–çš„å…¶ä»–ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥å†™å…¶ä»–ç±»å‹çš„è¾…åŠ©ç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">type OrNull&lt;Type&gt; &#x3D; Type | null;type OneOrMany&lt;Type&gt; &#x3D; Type | Type[];&#x2F;&#x2F; è¿™ç»„ç»“æœä¸€æ ·type OneOrManyOrNull&lt;Type&gt; &#x3D; OrNull&lt;OneOrMany&lt;Type&gt;&gt;;type OneOrManyOrNull&lt;Type&gt; &#x3D; OneOrMany&lt;Type&gt; | null;&#x2F;&#x2F; è¿™ç»„ç»“æœä¸€æ ·type OneOrManyOrNullStrings &#x3D; OneOrManyOrNull&lt;string&gt;;type OneOrManyOrNullStrings &#x3D; OneOrMany&lt;string&gt; | null;</code></pre><p>Weâ€™ll circle back to type aliases in just a little bit.<br><code>æˆ‘ä»¬ä¼šåœ¨ç¨åå›åˆ°ç±»å‹åˆ«åã€‚</code></p><h2 id="The-Array-Type"><a href="#The-Array-Type" class="headerlink" title="The Array Type"></a>The Array Type</h2><p><code>æ•°ç»„ç±»å‹</code><br>Generic object types are often some sort of container type that work independently of the type of elements they contain. Itâ€™s ideal for data structures to work this way so that theyâ€™re re-usable across different data types.<br><code>æ³›å‹å¯¹è±¡ç±»å‹é€šå¸¸æ˜¯ä¸€ç§å¯ä»¥ç‹¬ç«‹äºå…¶åŒ…å«å…ƒç´ çš„ç±»å‹çš„å®¹å™¨ç±»å‹ã€‚è¿™æ ·ï¼Œå®ƒä»¬å¯ä»¥åœ¨ä¸åŒçš„æ•°æ®ç±»å‹ä¹‹é—´é‡ç”¨ã€‚</code><br>It turns out weâ€™ve been working with a type just like that throughout this handbook: the Array type. Whenever we write out types like number[] or string[], thatâ€™s really just a shorthand for Array<number> and Array<string>.<br><code>æˆ‘ä»¬åœ¨è¿™æœ¬æ‰‹å†Œä¸­å·²ç»ä½¿ç”¨è¿‡ä¸€æ ·çš„ç±»å‹ï¼šæ•°ç»„ç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function doSomething(value: Array&lt;string&gt;) &#123;  &#x2F;&#x2F; ...&#125;let myArray: string[] &#x3D; [&quot;hello&quot;, &quot;world&quot;];&#x2F;&#x2F; either of these work!doSomething(myArray);doSomething(new Array(&quot;hello&quot;, &quot;world&quot;));</code></pre><p>Much like the Box type above, Array itself is a generic type.<br><code>æ•°ç»„æœ¬èº«æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface Array&lt;Type&gt; &#123;  &#x2F;**   * Gets or sets the length of the array.   *&#x2F;  length: number;  &#x2F;**   * Removes the last element from an array and returns it.   *&#x2F;  pop(): Type | undefined;  &#x2F;**   * Appends new elements to an array, and returns the new length of the array.   *&#x2F;  push(...items: Type[]): number;  &#x2F;&#x2F; ...&#125;</code></pre><p>Modern JavaScript also provides other data structures which are generic, like Map&lt;K, V&gt;, Set<T>, and Promise<T>. All this really means is that because of how Map, Set, and Promise behave, they can work with any sets of types.<br><code>ç°ä»£ JavaScript ä¹Ÿæä¾›äº†å…¶ä»–çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚ Map&lt;K, V&gt;, Set&lt;T&gt;, Promise&lt;T&gt;ã€‚</code></p><h2 id="The-ReadonlyArray-Type"><a href="#The-ReadonlyArray-Type" class="headerlink" title="The ReadonlyArray Type"></a>The ReadonlyArray Type</h2><p><code>åªè¯»æ•°ç»„ç±»å‹</code></p><p>The ReadonlyArray is a special type that describes arrays that shouldnâ€™t be changed.<br><code>åªè¯»æ•°ç»„æ˜¯ä¸€ä¸ªæè¿°ä¸èƒ½è¢«ä¿®æ”¹çš„æ•°ç»„çš„ç‰¹æ®Šç±»å‹ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function doStuff(values: ReadonlyArray&lt;string&gt;) &#123;  &#x2F;&#x2F; We can read from &#39;values&#39;...  const copy &#x3D; values.slice();  console.log(&#96;The first value is $&#123;values[0]&#125;&#96;);  &#x2F;&#x2F; ...but we can&#39;t mutate &#39;values&#39;.  values.push(&quot;hello!&quot;);  &#x2F;&#x2F; Property &#39;push&#39; does not exist on type &#39;readonly string[]&#39;.&#125;</code></pre><p>Much like the readonly modifier for properties, itâ€™s mainly a tool we can use for intent. When we see a function that returns ReadonlyArrays, it tells us weâ€™re not meant to change the contents at all, and when we see a function that consumes ReadonlyArrays, it tells us that we can pass any array into that function without worrying that it will change its contents.<br><code>ReadonlyArray ä¸»è¦æ˜¯ç”¨æ¥åšæ„å›¾å£°æ˜ã€‚å½“æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå‡½æ•°è¿”å› ReadonlyArrayï¼Œå°±æ˜¯åœ¨å‘Šè¯‰æˆ‘ä»¬ä¸èƒ½å»æ›´æ”¹å…¶ä¸­çš„å†…å®¹ï¼Œå½“æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå‡½æ•°æ”¯æŒä¼ å…¥ ReadonlyArray ï¼Œè¿™æ˜¯åœ¨å‘Šè¯‰æˆ‘ä»¬æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒçš„ä¼ å…¥æ•°ç»„åˆ°å‡½æ•°ä¸­ï¼Œè€Œä¸ç”¨æ‹…å¿ƒä¼šæ”¹å˜æ•°ç»„çš„å†…å®¹ã€‚</code><br>Unlike Array, there isnâ€™t a ReadonlyArray constructor that we can use.<br><code>ä¸åƒ Arrayï¼ŒReadonlyArray å¹¶ä¸æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨çš„æ„é€ å™¨å‡½æ•°ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">new ReadonlyArray(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;);&#39;ReadonlyArray&#39; only refers to a type, but is being used as a value here.</code></pre><p>Instead, we can assign regular Arrays to ReadonlyArrays.<br><code>ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä¸€ä¸ªå¸¸è§„æ•°ç»„èµ‹å€¼ç»™ ReadonlyArrayã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const roArray: ReadonlyArray&lt;string&gt; &#x3D; [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;];</code></pre><p>Just as TypeScript provides a shorthand syntax for Array<Type> with Type[], it also provides a shorthand syntax for ReadonlyArray<Type> with readonly Type[].<br><code>TypeScript ä¹Ÿé’ˆå¯¹ ReadonlyArray&lt;Type&gt; æä¾›äº†æ›´ç®€çŸ­çš„å†™æ³• readonly Type[]ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doStuff(values: readonly string[]) &#123;  &#x2F;&#x2F; We can read from &#39;values&#39;...  const copy &#x3D; values.slice();  console.log(&#96;The first value is $&#123;values[0]&#125;&#96;);  &#x2F;&#x2F; ...but we can&#39;t mutate &#39;values&#39;.  values.push(&quot;hello!&quot;);  &#x2F;&#x2F; Property &#39;push&#39; does not exist on type &#39;readonly string[]&#39;.&#125;</code></pre><p>One last thing to note is that unlike the readonly property modifier, assignability isnâ€™t bidirectional between regular Arrays and ReadonlyArrays.<br><code>æœ€åæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå°±æ˜¯ Arrays å’Œ ReadonlyArray å¹¶ä¸èƒ½åŒå‘çš„èµ‹å€¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let x: readonly string[] &#x3D; [];let y: string[] &#x3D; [];x &#x3D; y; &#x2F;&#x2F; oky &#x3D; x;&#x2F;&#x2F; The type &#39;readonly string[]&#39; is &#39;readonly&#39; and cannot be assigned to the mutable type &#39;string[]&#39;.</code></pre><h2 id="Tuple-Types"><a href="#Tuple-Types" class="headerlink" title="Tuple Types"></a>Tuple Types</h2><p>A tuple type is another sort of Array type that knows exactly how many elements it contains, and exactly which types it contains at specific positions.<br><code>å…ƒç»„ç±»å‹æ˜¯å¦å¤–ä¸€ç§ Array ç±»å‹ï¼Œå½“ä½ æ˜ç¡®çŸ¥é“æ•°ç»„åŒ…å«å¤šå°‘ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”æ¯ä¸ªä½ç½®å…ƒç´ çš„ç±»å‹éƒ½æ˜ç¡®çŸ¥é“çš„æ—¶å€™ï¼Œå°±é€‚åˆä½¿ç”¨å…ƒç»„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type StringNumberPair &#x3D; [string, number];</code></pre><p>Here, StringNumberPair is a tuple type of string and number. Like ReadonlyArray, it has no representation at runtime, but is significant to TypeScript. To the type system, StringNumberPair describes arrays whose 0 index contains a string and whose 1 index contains a number.<br><code>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒStringNumberPair å°±æ˜¯ string å’Œ number çš„å…ƒç»„ç±»å‹ã€‚</code></p><p><code>è·Ÿ ReadonlyArray ä¸€æ ·ï¼Œå®ƒå¹¶ä¸ä¼šåœ¨è¿è¡Œæ—¶äº§ç”Ÿå½±å“ï¼Œä½†æ˜¯å¯¹ TypeScript å¾ˆæœ‰æ„ä¹‰ã€‚å› ä¸ºå¯¹äºç±»å‹ç³»ç»Ÿï¼ŒStringNumberPair æè¿°äº†ä¸€ä¸ªæ•°ç»„ï¼Œç´¢å¼• 0 çš„å€¼çš„ç±»å‹æ˜¯ stringï¼Œç´¢å¼• 1 çš„å€¼çš„ç±»å‹æ˜¯ numberã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(pair: [string, number]) &#123;  const a &#x3D; pair[0];  const a: string;  const b &#x3D; pair[1];  const b: number;  &#x2F;&#x2F; ...&#125;doSomething([&quot;hello&quot;, 42]);</code></pre><p>If we try to index past the number of elements, weâ€™ll get an error.<br><code>å¦‚æœè¦è·å–å…ƒç´ æ•°é‡ä¹‹å¤–çš„å…ƒç´ ï¼ŒTypeScript ä¼šæç¤ºé”™è¯¯ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(pair: [string, number]) &#123;  &#x2F;&#x2F; ...  const c &#x3D; pair[2];  &#x2F;&#x2F; Tuple type &#39;[string, number]&#39; of length &#39;2&#39; has no element at index &#39;2&#39;.&#125;</code></pre><p>We can also destructure tuples using JavaScriptâ€™s array destructuring.<br><code>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ JavaScript çš„æ•°ç»„è§£æ„è¯­æ³•è§£æ„å…ƒç»„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(stringHash: [string, number]) &#123;  const [inputString, hash] &#x3D; stringHash;  console.log(inputString);  &#x2F;&#x2F; const inputString: string;  console.log(hash);  &#x2F;&#x2F; const hash: number;&#125;</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Tuple types are useful in heavily convention-based APIs, where each elementâ€™s meaning is â€œobviousâ€. This gives us flexibility in whatever we want to name our variables when we destructure them. In the above example, we were able to name elements 0 and 1 to whatever we wanted.<br><code>å…ƒç»„ç±»å‹åœ¨é‡åº¦ä¾èµ–çº¦å®šçš„ API ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šè®©æ¯ä¸ªå…ƒç´ çš„æ„ä¹‰éƒ½å¾ˆæ˜æ˜¾ã€‚å½“æˆ‘ä»¬è§£æ„çš„æ—¶å€™ï¼Œå…ƒç»„ç»™äº†æˆ‘ä»¬å‘½åå˜é‡çš„è‡ªç”±åº¦ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘½åå…ƒç´  0 å’Œ 1 ä¸ºæˆ‘ä»¬æƒ³è¦çš„åå­—ã€‚</code><br>However, since not every user holds the same view of whatâ€™s obvious, it may be worth reconsidering whether using objects with descriptive property names may be better for your API.<br><code>ç„¶è€Œï¼Œä¹Ÿä¸æ˜¯æ¯ä¸ªç”¨æˆ·éƒ½è¿™æ ·è®¤ä¸ºï¼Œæ‰€ä»¥æœ‰çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰æè¿°å±æ€§åå­—çš„å¯¹è±¡ä¹Ÿè®¸æ˜¯ä¸ªæ›´å¥½çš„æ–¹å¼ã€‚</code><br>Other than those length checks, simple tuple types like these are equivalent to types which are versions of Arrays that declare properties for specific indexes, and that declare length with a numeric literal type.<br><code>é™¤äº†é•¿åº¦æ£€æŸ¥ï¼Œç®€å•çš„å…ƒç»„ç±»å‹è·Ÿå£°æ˜äº† length å±æ€§å’Œå…·ä½“çš„ç´¢å¼•å±æ€§çš„ Array æ˜¯ä¸€æ ·çš„ã€‚</code></p></blockquote><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface StringNumberPair &#123;  &#x2F;&#x2F; specialized properties  length: 2;  0: string;  1: number;  &#x2F;&#x2F; Other &#39;Array&lt;string | number&gt;&#39; members...  slice(start?: number, end?: number): Array&lt;string | number&gt;;&#125;</code></pre><p>Another thing you may be interested in is that tuples can have optional properties by writing out a question mark (? after an elementâ€™s type). Optional tuple elements can only come at the end, and also affect the type of length.<br><code>åœ¨å…ƒç»„ç±»å‹ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªå¯é€‰å±æ€§ï¼Œä½†å¯é€‰å…ƒç´ å¿…é¡»åœ¨æœ€åé¢ï¼Œè€Œä¸”ä¹Ÿä¼šå½±å“ç±»å‹çš„ length ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Either2dOr3d &#x3D; [number, number, number?];function setCoordinate(coord: Either2dOr3d) &#123;  const [x, y, z] &#x3D; coord;  const z: number | undefined;  console.log(&#96;Provided coordinates had $&#123;coord.length&#125; dimensions&#96;);  &#x2F;&#x2F; (property) length: 2 | 3&#125;</code></pre><p>Tuples can also have rest elements, which have to be an array&#x2F;tuple type.<br><code>Tuples ä¹Ÿå¯ä»¥ä½¿ç”¨å‰©ä½™å…ƒç´ è¯­æ³•ï¼Œä½†å¿…é¡»æ˜¯ array/tuple ç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type StringNumberBooleans &#x3D; [string, number, ...boolean[]];type StringBooleansNumber &#x3D; [string, ...boolean[], number];type BooleansStringNumber &#x3D; [...boolean[], string, number];</code></pre><ul><li><code>StringNumberBooleans</code> describes a tuple whose first two elements are string and number respectively, but which may have any number of booleans following.<br><code>æè¿°ä¸€ä¸ªå…ƒç»„ï¼Œå‰ä¸¤ä¸ªæ˜¯å­—ç¬¦ä¸²å’Œæ•°å€¼ï¼Œåé¢æ˜¯boolean</code></li><li><code>StringBooleansNumber</code> describes a tuple whose first element is string and then any number of booleans and ending with a number.<br><code>æè¿°ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²ï¼Œæœ€åä¸€ä¸ªæ˜¯æ•°å€¼ï¼Œä¸­é—´æœ‰ä»»æ„å¤šä¸ªbooleanç±»å‹</code></li><li><code>BooleansStringNumber</code> describes a tuple whose starting elements are any number of booleans and ending with a string then a number.<br><code>æè¿°ä¸€ä¸ªå…ƒç»„ï¼Œæœ€åä¸¤ä¸ªæ˜¯stringã€number</code><br>A tuple with a rest element has no set â€œlengthâ€ - it only has a set of well-known elements in different positions.<br><code>æœ‰å‰©ä½™å…ƒç´ çš„å…ƒç»„å¹¶ä¸ä¼šè®¾ç½® lengthï¼Œå› ä¸ºå®ƒåªçŸ¥é“åœ¨ä¸åŒä½ç½®ä¸Šçš„å·²çŸ¥å…ƒç´ ä¿¡æ¯ï¼š</code></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const a: StringNumberBooleans &#x3D; [&quot;hello&quot;, 1];const b: StringNumberBooleans &#x3D; [&quot;beautiful&quot;, 2, true];const c: StringNumberBooleans &#x3D; [&quot;world&quot;, 3, true, false, true, false, true];</code></pre><p>Why might optional and rest elements be useful? Well, it allows TypeScript to correspond tuples with parameter lists. Tuples types can be used in rest parameters and arguments, so that the following:<br><code>å¯é€‰å…ƒç´ å’Œå‰©ä½™å…ƒç´ çš„å­˜åœ¨ï¼Œä½¿å¾— TypeScript å¯ä»¥åœ¨å‚æ•°åˆ—è¡¨é‡Œä½¿ç”¨å…ƒç»„ï¼Œå°±åƒè¿™æ ·ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function readButtonInput(...args: [string, number, ...boolean[]]) &#123;  const [name, version, ...input] &#x3D; args;  &#x2F;&#x2F; ...&#125;</code></pre><p>is basically equivalent to:<br><code>åŸºæœ¬ç­‰åŒäºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function readButtonInput(name: string, version: number, ...input: boolean[]) &#123;  &#x2F;&#x2F; ...&#125;</code></pre><p>This is handy when you want to take a variable number of arguments with a rest parameter, and you need a minimum number of elements, but you donâ€™t want to introduce intermediate variables.</p><h2 id="readonly-Tuple-Types"><a href="#readonly-Tuple-Types" class="headerlink" title="readonly Tuple Types"></a>readonly Tuple Types</h2><p><code>åªè¯»å…ƒç»„ç±»å‹</code><br>One final note about tuple types - tuples types have readonly variants, and can be specified by sticking a readonly modifier in front of them - just like with array shorthand syntax.<br><code>å…ƒç»„ç±»å‹ä¹Ÿæ˜¯å¯ä»¥è®¾ç½® readonly çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(pair: readonly [string, number]) &#123;  &#x2F;&#x2F; ...&#125;</code></pre><p>As you might expect, writing to any property of a readonly tuple isnâ€™t allowed in TypeScript.<br><code>è¿™æ · TypeScript å°±ä¸ä¼šå…è®¸å†™å…¥readonly å…ƒç»„çš„ä»»ä½•å±æ€§ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(pair: readonly [string, number]) &#123;  pair[0] &#x3D; &quot;hello!&quot;;  &#x2F;&#x2F; Cannot assign to &#39;0&#39; because it is a read-only property.&#125;</code></pre><p>Tuples tend to be created and left un-modified in most code, so annotating types as readonly tuples when possible is a good default. This is also important given that array literals with const assertions will be inferred with readonly tuple types.<br><code>åœ¨å¤§éƒ¨åˆ†çš„ä»£ç ä¸­ï¼Œå…ƒç»„åªæ˜¯è¢«åˆ›å»ºï¼Œä½¿ç”¨å®Œåä¹Ÿä¸ä¼šè¢«ä¿®æ”¹ï¼Œæ‰€ä»¥å°½å¯èƒ½çš„å°†å…ƒç»„è®¾ç½®ä¸º readonly æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚å¦‚æœæˆ‘ä»¬ç»™ä¸€ä¸ªæ•°ç»„å­—é¢é‡ const æ–­è¨€ï¼Œä¹Ÿä¼šè¢«æ¨æ–­ä¸º readonly å…ƒç»„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let point &#x3D; [3, 4] as const;function distanceFromOrigin([x, y]: [number, number]) &#123;  return Math.sqrt(x ** 2 + y ** 2);&#125;distanceFromOrigin(point);&#x2F;&#x2F; Argument of type &#39;readonly [3, 4]&#39; is not assignable to parameter of type &#39;[number, number]&#39;.&#x2F;&#x2F; The type &#39;readonly [3, 4]&#39; is &#39;readonly&#39; and cannot be assigned to the mutable type &#39;[number, number]&#39;.</code></pre><p>Here, distanceFromOrigin never modifies its elements, but expects a mutable tuple. Since pointâ€™s type was inferred as readonly [3, 4], it wonâ€™t be compatible with [number, number] since that type canâ€™t guarantee pointâ€™s elements wonâ€™t be mutated.<br><code>å°½ç®¡ distanceFromOrigin å¹¶æ²¡æœ‰æ›´æ”¹ä¼ å…¥çš„å…ƒç´ ï¼Œä½†å‡½æ•°å¸Œæœ›ä¼ å…¥ä¸€ä¸ªå¯å˜å…ƒç»„ã€‚å› ä¸º point çš„ç±»å‹è¢«æ¨æ–­ä¸º readonly [3, 4]ï¼Œå®ƒè·Ÿ [number number] å¹¶ä¸å…¼å®¹ï¼Œæ‰€ä»¥ TypeScript ç»™äº†ä¸€ä¸ªæŠ¥é”™ã€‚</code></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5.Typescriptæ‰‹å†Œ å‡½æ•°</title>
      <link href="//post/2022-06-08ts-more-on-functions.html"/>
      <url>//post/2022-06-08ts-more-on-functions.html</url>
      
        <content type="html"><![CDATA[<p>Functions are the basic building block of any application, whether theyâ€™re local functions, imported from another module, or methods on a class. Theyâ€™re also values, and just like other values, TypeScript has many ways to describe how functions can be called. Letâ€™s learn about how to write types that describe functions.</p><h2 id="Function-Type-Expressions"><a href="#Function-Type-Expressions" class="headerlink" title="Function Type Expressions"></a>Function Type Expressions</h2><p><code>å‡½æ•°ç±»å‹è¡¨è¾¾å¼</code><br>The simplest way to describe a function is with a function type expression. These types are syntactically similar to arrow functions:<br><code>æœ€ç®€å•æè¿°ä¸€ä¸ªå‡½æ•°çš„æ–¹å¼æ˜¯ä½¿ç”¨å‡½æ•°ç±»å‹è¡¨è¾¾å¼ï¼ˆfunction type expressionï¼‰ã€‚**å®ƒçš„å†™æ³•æœ‰ç‚¹ç±»ä¼¼äºç®­å¤´å‡½æ•°ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function greeter(fn: (a: string) &#x3D;&gt; void) &#123;  fn(&quot;Hello, World&quot;);&#125;function printToConsole(s: string) &#123;  console.log(s);&#125;greeter(printToConsole);</code></pre><p>The syntax (a: string) &#x3D;&gt; void means â€œa function with one parameter, named a, of type string, that doesnâ€™t have a return valueâ€. Just like with function declarations, if a parameter type isnâ€™t specified, itâ€™s implicitly any.<br><code>è¿™ä¸ªå‡½æ•°ç±»å‹è¡¨è¾¾å¼çš„è¯­æ³•ï¼ˆa: stringï¼‰=&gt; voidï¼Œæ„æ€æ˜¯â€œä¸€ä¸ªå‚æ•°ï¼Œåä¸ºaï¼Œç±»å‹ä¸ºstringï¼Œæ²¡æœ‰è¿”å›å€¼â€ã€‚</code><br>Note that the parameter name is required. The function type (string) &#x3D;&gt; void means â€œa function with a parameter named string of type anyâ€œ!<br><code>æ³¨æ„ï¼Œå‚æ•°åæ˜¯å¿…éœ€çš„ã€‚å‡½æ•°ç±»å‹ï¼ˆstringï¼‰=&gt; voidæ„æ€æ˜¯â€œä¸€ä¸ªå‚æ•°åä¸ºstringï¼Œç±»å‹ä¸ºanyâ€ï¼</code><br>Of course, we can use a type alias to name a function type:<br><code>ç±»å‹åˆ«åï¼Œå¯ä»¥å‘½åä¸€ä¸ªå‡½æ•°ç±»å‹ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">type GreetFunction &#x3D; (a: string) &#x3D;&gt; void;function greeter(fn: GreetFunction) &#123;  &#x2F;&#x2F; ...&#125;</code></pre><h2 id="Call-Signatures"><a href="#Call-Signatures" class="headerlink" title="Call Signatures"></a>Call Signatures</h2><p><code>è°ƒç”¨ç­¾å</code></p><p>In JavaScript, functions can have properties in addition to being callable. However, the function type expression syntax doesnâ€™t allow for declaring properties. If we want to describe something callable with properties, we can write a call signature in an object type:<br><code>åœ¨JavaScriptä¸­ï¼Œå‡½æ•°å¯ä»¥æœ‰å±æ€§ï¼Œä½†æ˜¯å‡½æ•°ç±»å‹è¡¨è¾¾å¼è¯­æ³•ä¸å…è®¸å£°æ˜å±æ€§ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">type DescribableFunction &#x3D; &#123;  description: string;  (someArg: number): boolean;&#125;;function doSomething(fn: DescribableFunction) &#123;  console.log(fn.description + &quot; returned &quot; + fn(6));&#125;</code></pre><p>Note that the syntax is slightly different compared to a function type expression - use : between the parameter list and the return type rather than &#x3D;&gt;.<br><code>æ³¨æ„ï¼Œè¯­æ³•ä¸å‡½æ•°ç±»å‹è¡¨è¾¾å¼ä¸åŒï¼Œä½¿ç”¨:åœ¨å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ä¹‹é—´ã€‚</code></p><h2 id="Construct-Signatures"><a href="#Construct-Signatures" class="headerlink" title="Construct Signatures"></a>Construct Signatures</h2><p><code>æ„é€ ç­¾å</code><br>JavaScript functions can also be invoked with the new operator. TypeScript refers to these as constructors because they usually create a new object. You can write a construct signature by adding the new keyword in front of a call signature:<br><code>JavaScriptå‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨newæ“ä½œç¬¦ã€‚TypeScriptå°†å®ƒä»¬ç§°ä¸ºæ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">type SomeConstructor &#x3D; &#123;  new (s: string): SomeObject;&#125;;function fn(ctor: SomeConstructor) &#123;  return new ctor(&quot;hello&quot;);&#125;</code></pre><p>Some objects, like JavaScriptâ€™s Date object, can be called with or without new. You can combine call and construct signatures in the same type arbitrarily:<br><code>ä¸€äº›å¯¹è±¡ï¼Œå¦‚JavaScriptçš„Dateå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨æˆ–ä¸ä½¿ç”¨newã€‚ä½ å¯ä»¥åœ¨åŒä¸€ç±»å‹ä¸­åŒæ—¶ä½¿ç”¨è°ƒç”¨å’Œæ„é€ ç­¾åï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">interface CallOrConstruct &#123;  new (s: string): Date;  (n?: number): number;&#125;</code></pre><h2 id="Generic-Functions"><a href="#Generic-Functions" class="headerlink" title="Generic Functions"></a>Generic Functions</h2><p><code>æ³›å‹å‡½æ•°</code><br>Itâ€™s common to write a function where the types of the input relate to the type of the output, or where the types of two inputs are related in some way. Letâ€™s consider for a moment a function that returns the first element of an array:<br><code>æˆ‘ä»¬ç»å¸¸éœ€è¦å†™è¿™ç§å‡½æ•°ï¼Œå³å‡½æ•°çš„è¾“å‡ºç±»å‹ä¾èµ–å‡½æ•°çš„è¾“å…¥ç±»å‹ï¼Œæˆ–è€…ä¸¤ä¸ªè¾“å…¥çš„ç±»å‹ä»¥æŸç§å½¢å¼ç›¸äº’å…³è”ã€‚è®©æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function firstElement(arr: any[]) &#123;  return arr[0];&#125;</code></pre><p>This function does its job, but unfortunately has the return type any. Itâ€™d be better if the function returned the type of the array element.<br><code>æ³¨æ„æ­¤æ—¶å‡½æ•°è¿”å›å€¼çš„ç±»å‹æ˜¯ anyï¼Œå¦‚æœèƒ½è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ çš„å…·ä½“ç±»å‹å°±æ›´å¥½äº†ã€‚</code><br>In TypeScript, generics are used when we want to describe a correspondence between two values. We do this by declaring a type parameter in the function signature:<br><code>åœ¨TypeScriptä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³›å‹æ¥æè¿°ä¸¤ä¸ªå€¼ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æè¿°å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å…³ç³»ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function firstElement&lt;Type&gt;(arr: Type[]): Type | undefined &#123;  return arr[0];&#125;</code></pre><p>By adding a type parameter Type to this function and using it in two places, weâ€™ve created a link between the input of the function (the array) and the output (the return value). Now when we call it, a more specific type comes out:<br><code>åœ¨æ­¤å‡½æ•°ä¸­æ·»åŠ ä¸€ä¸ªç±»å‹å‚æ•°Typeï¼Œå¹¶åœ¨ä¸¤å¤„ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å…³ç³»ã€‚</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">&#x2F;&#x2F; s is of type &#39;string&#39;const s &#x3D; firstElement([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]);&#x2F;&#x2F; n is of type &#39;number&#39;const n &#x3D; firstElement([1, 2, 3]);&#x2F;&#x2F; u is of type undefinedconst u &#x3D; firstElement([]);</code></pre><h2 id="Inference"><a href="#Inference" class="headerlink" title="Inference"></a>Inference</h2><p><code>æ¥å£</code><br>Note that we didnâ€™t have to specify Type in this sample. The type was inferred - chosen automatically - by TypeScript.<br><code>æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªä¾‹å­ä¸­æ²¡æœ‰æŒ‡å®šç±»å‹ã€‚TypeScriptè‡ªåŠ¨æ¨æ–­å‡ºæ¥äº†ã€‚</code><br>We can use multiple type parameters as well. For example, a standalone version of map would look like this:<br><code>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªç±»å‹å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå•ç‹¬ç‰ˆæœ¬çš„mapå‡½æ•°ä¼šå¦‚ä¸‹æ‰€ç¤ºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function map&lt;Input, Output&gt;(  arr: Input[],  func: (arg: Input) &#x3D;&gt; Output): Output[] &#123;  return arr.map(func);&#125;&#x2F;&#x2F; Parameter &#39;n&#39; is of type &#39;string&#39;&#x2F;&#x2F; &#39;parsed&#39; is of type &#39;number[]&#39;const parsed &#x3D; map([&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], (n) &#x3D;&gt; parseInt(n));</code></pre><p>Note that in this example, TypeScript could infer both the type of the Input type parameter (from the given string array), as well as the Output type parameter based on the return value of the function expression (number).<br><code>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒTypeScriptå¯ä»¥æ¨æ–­å‡ºInputç±»å‹å‚æ•°çš„ç±»å‹ï¼ˆä»ç»™å®šçš„å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œä»¥åŠOutputç±»å‹å‚æ•°çš„ç±»å‹ï¼ŒåŸºäºå‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ï¼ˆnumberï¼‰ã€‚</code></p><h2 id="Constraints"><a href="#Constraints" class="headerlink" title="Constraints"></a>Constraints</h2><p><code>çº¦æŸ</code><br>Weâ€™ve written some generic functions that can work on any kind of value. Sometimes we want to relate two values, but can only operate on a certain subset of values. In this case, we can use a constraint to limit the kinds of types that a type parameter can accept.<br><code>æˆ‘ä»¬å†™äº†ä¸€äº›å¯ä»¥æ“ä½œä»»æ„ç±»å‹çš„å‡½æ•°ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åªæ“ä½œä¸€ä¸ªç‰¹å®šçš„ç±»å‹é›†åˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çº¦æŸæ¥é™åˆ¶ç±»å‹å‚æ•°å¯ä»¥æ¥å—çš„ç±»å‹ã€‚</code><br>Letâ€™s write a function that returns the longer of two values. To do this, we need a length property thatâ€™s a number. We constrain the type parameter to that type by writing an extends clause:<br><code>æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸¤ä¸ªå€¼çš„é•¿åº¦ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªlengthå±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°å­—ã€‚æˆ‘ä»¬é€šè¿‡å†™ä¸€ä¸ªextendså­å¥æ¥é™åˆ¶ç±»å‹å‚æ•°ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function longest&lt;Type extends &#123; length: number &#125;&gt;(a: Type, b: Type) &#123;  if (a.length &gt;&#x3D; b.length) &#123;    return a;  &#125; else &#123;    return b;  &#125;&#125;&#x2F;&#x2F; longerArray is of type &#39;number[]&#39;const longerArray &#x3D; longest([1, 2], [1, 2, 3]);&#x2F;&#x2F; longerString is of type &#39;alice&#39; | &#39;bob&#39;const longerString &#x3D; longest(&quot;alice&quot;, &quot;bob&quot;);&#x2F;&#x2F; Error! Numbers don&#39;t have a &#39;length&#39; propertyconst notOK &#x3D; longest(10, 100);&#x2F;&#x2F; Argument of type &#39;number&#39; is not assignable to parameter of type &#39;&#123; length: number; &#125;&#39;.</code></pre><p>There are a few interesting things to note in this example. We allowed TypeScript to infer the return type of longest. Return type inference also works on generic functions.<br><code>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…è®¸TypeScriptæ¨æ–­longestçš„è¿”å›ç±»å‹ã€‚è¿”å›ç±»å‹æ¨æ–­ä¹Ÿå¯ä»¥åœ¨æ³›å‹å‡½æ•°ä¸­ä½¿ç”¨ã€‚</code><br>Because we constrained Type to { length: number }, we were allowed to access the .length property of the a and b parameters. Without the type constraint, we wouldnâ€™t be able to access those properties because the values might have been some other type without a length property.<br><code>å› ä¸ºæˆ‘ä»¬é™åˆ¶äº†ç±»å‹å‚æ•°ä¸º&#123; length: number &#125;ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¿é—®aå’Œbå‚æ•°çš„.lengthå±æ€§ã€‚æ²¡æœ‰ç±»å‹çº¦æŸï¼Œæˆ‘ä»¬ä¸èƒ½è®¿é—®è¿™äº›å±æ€§ï¼Œå› ä¸ºå€¼å¯èƒ½æ˜¯å…¶ä»–ç±»å‹è€Œæ²¡æœ‰lengthå±æ€§ã€‚</code><br>The types of longerArray and longerString were inferred based on the arguments. Remember, generics are all about relating two or more values with the same type!<br><code>longerArrayå’ŒlongerStringçš„ç±»å‹æ˜¯æ ¹æ®å‚æ•°çš„ç±»å‹æ¨æ–­å‡ºæ¥çš„ã€‚è®°ä½ï¼Œæ³›å‹æ˜¯å…³äºä¸¤ä¸ªæˆ–å¤šä¸ªå€¼å…·æœ‰ç›¸åŒç±»å‹çš„é—®é¢˜ï¼</code><br>Finally, just as weâ€™d like, the call to longest(10, 100) is rejected because the number type doesnâ€™t have a .length property.<br><code>æœ€åï¼Œæˆ‘ä»¬æƒ³è¦ï¼Œè°ƒç”¨longest(10, 100)ä¼šè¢«æ‹’ç»ï¼Œå› ä¸ºæ•°å­—ç±»å‹æ²¡æœ‰.lengthå±æ€§ã€‚</code></p><h2 id="Working-with-Constrained-Values"><a href="#Working-with-Constrained-Values" class="headerlink" title="Working with Constrained Values"></a>Working with Constrained Values</h2><p><code>å·¥ä½œä¸­çš„çº¦æŸå€¼</code><br>Hereâ€™s a common error when working with generic constraints:<br><code>è¿™é‡Œæ˜¯å·¥ä½œä¸­å¸¸è§çš„é”™è¯¯ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function minimumLength&lt;Type extends &#123; length: number &#125;&gt;(  obj: Type,  minimum: number): Type &#123;  if (obj.length &gt;&#x3D; minimum) &#123;    return obj;  &#125; else &#123;    return &#123; length: minimum &#125;;    &#x2F;&#x2F; Type &#39;&#123; length: number; &#125;&#39; is not assignable to type &#39;Type&#39;.    &#x2F;&#x2F; &#39;&#123; length: number; &#125;&#39; is assignable to the constraint of type &#39;Type&#39;, but &#39;Type&#39; could be instantiated with a different subtype of constraint &#39;&#123; length: number; &#125;&#39;.  &#125;&#125;</code></pre><p>It might look like this function is OK - Type is constrained to { length: number }, and the function either returns Type or a value matching that constraint. The problem is that the function promises to return the same kind of object as was passed in, not just some object matching the constraint. If this code were legal, you could write code that definitely wouldnâ€™t work:<br><code>è¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºTypeæ˜¯çº¦æŸä¸º&#123; length: number &#125;ï¼Œå‡½æ•°å¯ä»¥è¿”å›Typeæˆ–è€…åŒ¹é…è¿™ä¸ªçº¦æŸçš„å€¼ã€‚é—®é¢˜æ˜¯ï¼Œå‡½æ•°æ‰¿è¯ºè¿”å›ä¼ å…¥çš„åŒæ ·ç±»å‹çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯åŒ¹é…çº¦æŸçš„å¯¹è±¡ã€‚å¦‚æœè¿™æ®µä»£ç æ˜¯åˆæ³•çš„ï¼Œä½ å¯ä»¥å†™ä¸€æ®µä»£ç ï¼Œå®ƒæ°¸è¿œä¸ä¼šè¿è¡Œï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">&#x2F;&#x2F; &#39;arr&#39; gets value &#123; length: 6 &#125;const arr &#x3D; minimumLength([1, 2, 3], 6);&#x2F;&#x2F; and crashes here because arrays have&#x2F;&#x2F; a &#39;slice&#39; method, but not the returned object!console.log(arr.slice(0));</code></pre><h2 id="Specifying-Type-Arguments"><a href="#Specifying-Type-Arguments" class="headerlink" title="Specifying Type Arguments"></a>Specifying Type Arguments</h2><p><code>æ˜ç¡®æŒ‡å®šç±»å‹å‚æ•°</code><br>TypeScript can usually infer the intended type arguments in a generic call, but not always. For example, letâ€™s say you wrote a function to combine two arrays:<br><code>Typescripté€šå¸¸å¯ä»¥åœ¨æ³›å‹è°ƒç”¨ä¸­æ¨æ–­å‡ºæ„å›¾çš„ç±»å‹å‚æ•°ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å†™äº†ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆå¹¶ä¸¤ä¸ªæ•°ç»„ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function combine&lt;Type&gt;(arr1: Type[], arr2: Type[]): Type[] &#123;  return arr1.concat(arr2);&#125;</code></pre><p>Normally it would be an error to call this function with mismatched arrays:<br><code>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¼ å…¥ä¸åŒ¹é…çš„æ•°ç»„ï¼Œå°±ä¼šæŠ¥é”™ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">const arr &#x3D; combine([1, 2, 3], [&quot;hello&quot;]);&#x2F;&#x2F; Type &#39;string&#39; is not assignable to type &#39;number&#39;.</code></pre><p>If you intended to do this, however, you could manually specify Type:<br><code>å¦‚æœä½ æƒ³è¿™æ ·åšï¼Œä½ å¯ä»¥æ‰‹åŠ¨æŒ‡å®šTypeï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">const arr &#x3D; combine&lt;string | number&gt;([1, 2, 3], [&quot;hello&quot;]);</code></pre><h2 id="Guidelines-for-Writing-Good-Generic-Functions"><a href="#Guidelines-for-Writing-Good-Generic-Functions" class="headerlink" title="Guidelines for Writing Good Generic Functions"></a>Guidelines for Writing Good Generic Functions</h2><p><code>å†™å¥½æ³›å‹å‡½æ•°çš„æŒ‡å—</code><br>Writing generic functions is fun, and it can be easy to get carried away with type parameters. Having too many type parameters or using constraints where they arenâ€™t needed can make inference less successful, frustrating callers of your function.<br><code>å†™å¥½æ³›å‹å‡½æ•°æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨ç±»å‹å‚æ•°ã€‚æœ‰å¤ªå¤šç±»å‹å‚æ•°æˆ–è€…ä½¿ç”¨çº¦æŸï¼Œè€Œä¸”è¿™äº›çº¦æŸä¸éœ€è¦çš„è¯ï¼Œæ¨æ–­å°±ä¼šæ›´åŠ ä¸æˆåŠŸï¼Œä½¿ç”¨è€…ä¼šå›°æƒ‘ã€‚</code></p><h2 id="Push-Type-Parameters-Down"><a href="#Push-Type-Parameters-Down" class="headerlink" title="Push Type Parameters Down"></a>Push Type Parameters Down</h2><p><code>æ¨ä¸‹ç±»å‹å‚æ•°</code><br>Here are two ways of writing a function that appear similar:<br><code>è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼å†™ä¸€ä¸ªå‡½æ•°ï¼Œçœ‹èµ·æ¥åƒæ˜¯ä¸€æ ·çš„ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function firstElement1&lt;Type&gt;(arr: Type[]) &#123;  return arr[0];&#125;function firstElement2&lt;Type extends any[]&gt;(arr: Type) &#123;  return arr[0];&#125;&#x2F;&#x2F; a: number (good)const a &#x3D; firstElement1([1, 2, 3]);&#x2F;&#x2F; b: any (bad)const b &#x3D; firstElement2([1, 2, 3]);</code></pre><p>These might seem identical at first glance, but firstElement1 is a much better way to write this function. Its inferred return type is Type, but firstElement2â€™s inferred return type is any because TypeScript has to resolve the arr[0] expression using the constraint type, rather than â€œwaitingâ€ to resolve the element during a call.<br><code>è¿™ä¸¤ä¸ªå‡½æ•°çœ‹èµ·æ¥åƒæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯firstElement1æ›´å¥½çš„å†™æ³•ã€‚å®ƒçš„æ¨æ–­è¿”å›ç±»å‹æ˜¯Typeï¼Œä½†firstElement2çš„æ¨æ–­è¿”å›ç±»å‹æ˜¯anyï¼Œå› ä¸ºTypeScriptè¦åœ¨è°ƒç”¨æ—¶ä½¿ç”¨çº¦æŸç±»å‹ï¼Œè€Œä¸æ˜¯ç­‰å¾…å…ƒç´ è¢«è§£æã€‚</code><br>Rule: When possible, use the type parameter itself rather than constraining it<br><code>å½“å¯èƒ½çš„è¯ï¼Œå°½é‡ä½¿ç”¨ç±»å‹å‚æ•°æœ¬èº«è€Œä¸çº¦æŸå®ƒ</code><br>Use Fewer Type Parameters<br><code>ä½¿ç”¨æ›´å°‘çš„ç±»å‹å‚æ•°</code><br>Hereâ€™s another pair of similar functions:<br><code>è¿™é‡Œæœ‰ä¸€å¯¹ç›¸ä¼¼çš„å‡½æ•°ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function filter1&lt;Type&gt;(arr: Type[], func: (arg: Type) &#x3D;&gt; boolean): Type[] &#123;  return arr.filter(func);&#125;function filter2&lt;Type, Func extends (arg: Type) &#x3D;&gt; boolean&gt;(  arr: Type[],  func: Func): Type[] &#123;  return arr.filter(func);&#125;</code></pre><p>Weâ€™ve created a type parameter Func that doesnâ€™t relate two values. Thatâ€™s always a red flag, because it means callers wanting to specify type arguments have to manually specify an extra type argument for no reason. Func doesnâ€™t do anything but make the function harder to read and reason about!<br><code>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç±»å‹å‚æ•°Funcï¼Œå®ƒä¸å…³è”ä¸¤ä¸ªå€¼ã€‚è¿™æ˜¯ä¸€ä¸ªçº¢çº¿ï¼Œå› ä¸ºå®ƒæ„å‘³ç€è°ƒç”¨è€…å¸Œæœ›æŒ‡å®šç±»å‹å‚æ•°æ—¶ï¼Œå¿…é¡»æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªé¢å¤–çš„ç±»å‹å‚æ•°ã€‚Funcä¸åšä»»ä½•äº‹æƒ…ï¼Œåªæ˜¯è®©è¿™ä¸ªå‡½æ•°æ›´éš¾è¯»ï¼Œç†è§£ã€‚</code><br>Rule: Always use as few type parameters as possible<br><code>æ€»æ˜¯ä½¿ç”¨æœ€å°‘çš„ç±»å‹å‚æ•°</code></p><h2 id="Type-Parameters-Should-Appear-Twice"><a href="#Type-Parameters-Should-Appear-Twice" class="headerlink" title="Type Parameters Should Appear Twice"></a>Type Parameters Should Appear Twice</h2><p><code>ç±»å‹å‚æ•°åº”è¯¥å‡ºç°ä¸¤æ¬¡</code><br>Sometimes we forget that a function might not need to be generic:<br><code>æœ‰æ—¶å€™æˆ‘ä»¬å¿˜è®°äº†ä¸€ä¸ªå‡½æ•°å¯èƒ½ä¸éœ€è¦æ³›å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet&lt;Str extends string&gt;(s: Str) &#123;  console.log(&quot;Hello, &quot; + s);&#125;greet(&quot;world&quot;);</code></pre><p>We could just as easily have written a simpler version:<br><code>æˆ‘ä»¬å¯ä»¥ç®€å•çš„å†™ä¸€ä¸ªæ›´ç®€å•çš„ç‰ˆæœ¬ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(s: string) &#123;  console.log(&quot;Hello, &quot; + s);&#125;</code></pre><p>Remember, type parameters are for relating the types of multiple values. If a type parameter is only used once in the function signature, itâ€™s not relating anything.<br><code>è®°ä½ï¼Œç±»å‹å‚æ•°æ˜¯ç”¨æ¥å…³è”å¤šä¸ªå€¼çš„ç±»å‹çš„ã€‚å¦‚æœä¸€ä¸ªç±»å‹å‚æ•°åªè¢«ä¸€æ¬¡ä½¿ç”¨åœ¨å‡½æ•°ç­¾åä¸­ï¼Œå®ƒä¸å…³è”ä»»ä½•ä¸œè¥¿ã€‚</code><br>Rule: If a type parameter only appears in one location, strongly reconsider if you actually need it<br><code>å¦‚æœä¸€ä¸ªç±»å‹å‚æ•°åªå‡ºç°åœ¨ä¸€ä¸ªä½ç½®ï¼Œå¼ºçƒˆå»ºè®®å¦‚æœä½ å®é™…ä¸Šéœ€è¦å®ƒçš„è¯ï¼Œ</code></p><h2 id="Optional-Parameters"><a href="#Optional-Parameters" class="headerlink" title="Optional Parameters"></a>Optional Parameters</h2><p><code>å¯é€‰å‚æ•°</code><br>Functions in JavaScript often take a variable number of arguments. For example, the toFixed method of number takes an optional digit count:<br><code>åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°é€šå¸¸ä¼šæ¥å—ä¸€ä¸ªå¯å˜æ•°é‡çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œnumber çš„ toFixed æ–¹æ³•æ¥å—ä¸€ä¸ªå¯é€‰çš„ä½æ•°ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function f(n: number) &#123;  console.log(n.toFixed()); &#x2F;&#x2F; 0 arguments  console.log(n.toFixed(3)); &#x2F;&#x2F; 1 argument&#125;</code></pre><p>We can model this in TypeScript by marking the parameter as optional with ?:<br><code>æˆ‘ä»¬å¯ä»¥åœ¨ TypeScript ä¸­ä½¿ç”¨ ?: æ¥æ ‡è®°å¯é€‰å‚æ•°</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function f(x?: number) &#123;  &#x2F;&#x2F; ...&#125;f(); &#x2F;&#x2F; OKf(10); &#x2F;&#x2F; OK</code></pre><p>Although the parameter is specified as type number, the x parameter will actually have the type number | undefined because unspecified parameters in JavaScript get the value undefined.<br><code>åœ¨ JavaScript ä¸­ï¼ŒæœªæŒ‡å®šå‚æ•°çš„å€¼ä¼šè¢«è®¾ç½®ä¸º undefinedã€‚</code><br>You can also provide a parameter default:<br><code>ä½ ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªå‚æ•°é»˜è®¤å€¼ï¼š</code></p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">function f(x &#x3D; 10) &#123;  &#x2F;&#x2F; ...&#125;</code></pre><p>Now in the body of f, x will have type number because any undefined argument will be replaced with 10. Note that when a parameter is optional, callers can always pass undefined, as this simply simulates a â€œmissingâ€ argument:<br><code>åœ¨ f ä¸­çš„ body ä¸­ï¼Œx å°†æœ‰ number ç±»å‹ï¼Œå› ä¸ºä»»ä½•æœªå®šä¹‰çš„å‚æ•°éƒ½ä¼šè¢«æ›¿æ¢ä¸º 10ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare function f(x?: number): void;&#x2F;&#x2F; cut&#x2F;&#x2F; All OKf();f(10);f(undefined);</code></pre><h2 id="Optional-Parameters-in-Callbacks"><a href="#Optional-Parameters-in-Callbacks" class="headerlink" title="Optional Parameters in Callbacks"></a>Optional Parameters in Callbacks</h2><p><code>å›è°ƒå‡½æ•°ä¸­çš„å¯é€‰å‚æ•°</code><br>Once youâ€™ve learned about optional parameters and function type expressions, itâ€™s very easy to make the following mistakes when writing functions that invoke callbacks:<br><code>ä¸€æ—¦ä½ å­¦ä¼šäº†å¯é€‰å‚æ•°å’Œå‡½æ•°ç±»å‹è¡¨è¾¾å¼ï¼Œå†™å‡½æ•°è°ƒç”¨å›è°ƒå‡½æ•°æ—¶å¾ˆå®¹æ˜“å‡ºé”™ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function myForEach(arr: any[], callback: (arg: any, index?: number) &#x3D;&gt; void) &#123;  for (let i &#x3D; 0; i &lt; arr.length; i++) &#123;    callback(arr[i], i);  &#125;&#125;</code></pre><p>What people usually intend when writing index? as an optional parameter is that they want both of these calls to be legal:<br><code>äººä»¬å¸¸å¸¸å¸Œæœ›å†™ index ä½œä¸ºå¯é€‰å‚æ•°ï¼Œè¿™æ„å‘³ç€å®ƒä»¬éƒ½æ˜¯åˆæ³•çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">myForEach([1, 2, 3], (a) &#x3D;&gt; console.log(a));myForEach([1, 2, 3], (a, i) &#x3D;&gt; console.log(a, i));</code></pre><p>What this actually means is that callback might get invoked with one argument. In other words, the function definition says that the implementation might look like this:<br><code>è¿™å®é™…ä¸Šæ„å‘³ç€å›è°ƒå‡½æ•°å¯èƒ½ä¼šè¢«è°ƒç”¨ä¸€ä¸ªå‚æ•°ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function myForEach(arr: any[], callback: (arg: any, index?: number) &#x3D;&gt; void) &#123;  for (let i &#x3D; 0; i &lt; arr.length; i++) &#123;    &#x2F;&#x2F; I don&#39;t feel like providing the index today    callback(arr[i]);  &#125;&#125;</code></pre><p>In turn, TypeScript will enforce this meaning and issue errors that arenâ€™t really possible:<br><code>åœ¨ TypeScript ä¸­ï¼Œä¼šå‘å‡ºè¿™äº›ä¸å¯èƒ½çš„é”™è¯¯ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">myForEach([1, 2, 3], (a, i) &#x3D;&gt; &#123;  console.log(i.toFixed());  &#x2F;&#x2F; Object is possibly &#39;undefined&#39;.&#125;);</code></pre><p>In JavaScript, if you call a function with more arguments than there are parameters, the extra arguments are simply ignored. TypeScript behaves the same way. Functions with fewer parameters (of the same types) can always take the place of functions with more parameters.<br><code>åœ¨ JavaScript ä¸­ï¼Œå¦‚æœè°ƒç”¨å‡½æ•°çš„å‚æ•°å¤šäºå‚æ•°ï¼Œé‚£ä¹ˆè¿™äº›å¤šä½™çš„å‚æ•°å°†è¢«å¿½ç•¥ã€‚TypeScript ä¹Ÿä¼šåƒè¿™æ ·ã€‚å‡½æ•°å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œä½†æ˜¯å‚æ•°çš„ç±»å‹å¿…é¡»æ˜¯ç›¸åŒçš„ã€‚</code><br>When writing a function type for a callback, never write an optional parameter unless you intend to call the function without passing that argument<br><code>å†™ä¸€ä¸ªå›è°ƒå‡½æ•°ç±»å‹æ—¶ï¼Œå¦‚æœä½ ä¸æƒ³ä¼ é€’è¿™ä¸ªå‚æ•°ï¼Œå°±ä¸è¦å†™å¯é€‰å‚æ•°ã€‚</code></p><h2 id="Function-Overloads"><a href="#Function-Overloads" class="headerlink" title="Function Overloads"></a>Function Overloads</h2><p><code>å‡½æ•°é‡è½½</code><br>Some JavaScript functions can be called in a variety of argument counts and types. For example, you might write a function to produce a Date that takes either a timestamp (one argument) or a month&#x2F;day&#x2F;year specification (three arguments).<br><code>åœ¨ JavaScript ä¸­ï¼Œå¯ä»¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°çš„æ•°é‡å’Œç±»å‹éƒ½ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆä¸€ä¸ª Date å¯¹è±¡ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªæ—¶é—´æˆ³ï¼ˆä¸€ä¸ªå‚æ•°ï¼‰æˆ–ä¸€ä¸ªæœˆ/æ—¥/å¹´ çš„æŒ‡å®šï¼ˆä¸‰ä¸ªå‚æ•°ï¼‰ã€‚</code><br>In TypeScript, we can specify a function that can be called in different ways by writing overload signatures. To do this, write some number of function signatures (usually two or more), followed by the body of the function:<br><code>åœ¨ TypeScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥è¢«è°ƒç”¨ä¸åŒçš„å‚æ•°å’Œç±»å‹ï¼Œé€šè¿‡å†™å‡ºå¤šä¸ªå‡½æ•°ç±»å‹ï¼ˆé€šå¸¸æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªï¼‰ï¼Œç„¶åå†™å‡ºå‡½æ•°çš„ bodyï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function makeDate(timestamp: number): Date;function makeDate(m: number, d: number, y: number): Date;function makeDate(mOrTimestamp: number, d?: number, y?: number): Date &#123;  if (d !&#x3D;&#x3D; undefined &amp;&amp; y !&#x3D;&#x3D; undefined) &#123;    return new Date(y, mOrTimestamp, d);  &#125; else &#123;    return new Date(mOrTimestamp);  &#125;&#125;const d1 &#x3D; makeDate(12345678);const d2 &#x3D; makeDate(5, 5, 5);const d3 &#x3D; makeDate(1, 3);&#x2F;&#x2F; No overload expects 2 arguments, but overloads do exist that expect either 1 or 3 arguments.</code></pre><p>In this example, we wrote two overloads: one accepting one argument, and another accepting three arguments. These first two signatures are called the overload signatures.<br><code>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å†™äº†ä¸¤ä¸ªå‡½æ•°ç±»å‹ï¼šä¸€ä¸ªåªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªåªæ¥å—ä¸‰ä¸ªå‚æ•°ã€‚è¿™ä¸¤ä¸ªç¬¬ä¸€ä¸ªç±»å‹æ˜¯å‡½æ•°ç±»å‹ã€‚</code><br>Then, we wrote a function implementation with a compatible signature. Functions have an implementation signature, but this signature canâ€™t be called directly. Even though we wrote a function with two optional parameters after the required one, it canâ€™t be called with two parameters!<br><code>ç„¶åï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªå‡½æ•°å®ç°ï¼Œè¿™ä¸ªå‡½æ•°ç±»å‹ä¸èƒ½ç›´æ¥è°ƒç”¨ã€‚å³ä½¿æˆ‘ä»¬å†™äº†ä¸€ä¸ªå‚æ•°åï¼Œå†å†™äº†ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä¸¤ä¸ªå‚æ•°ã€‚è™½ç„¶æˆ‘ä»¬å†™äº†ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯ä¸èƒ½è°ƒç”¨ä¸¤ä¸ªå‚æ•°ã€‚</code></p><h2 id="Overload-Signatures-and-the-Implementation-Signature"><a href="#Overload-Signatures-and-the-Implementation-Signature" class="headerlink" title="Overload Signatures and the Implementation Signature"></a>Overload Signatures and the Implementation Signature</h2><p><code>é‡è½½ç­¾åå’Œå®ç°ç­¾å</code><br>This is a common source of confusion. Often people will write code like this and not understand why there is an error:<br><code>è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„æ··ä¹±æºã€‚å¾ˆå¤šäººå†™äº†è¿™æ ·çš„ä»£ç ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰é”™è¯¯ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function fn(x: string): void;function fn() &#123;  &#x2F;&#x2F; ...&#125;&#x2F;&#x2F; Expected to be able to call with zero argumentsfn();&#x2F;&#x2F; Expected 1 arguments, but got 0.</code></pre><p>Again, the signature used to write the function body canâ€™t be â€œseenâ€ from the outside.<br><code>å†æ¬¡ï¼Œå†™å‡ºå‡½æ•°çš„ body çš„ç­¾åä¸èƒ½è¢«å¤–éƒ¨çœ‹åˆ°ã€‚</code><br>The signature of the implementation is not visible from the outside. When writing an overloaded function, you should always have two or more signatures above the implementation of the function.<br><code>åœ¨å†™ä¸€ä¸ªé‡è½½å‡½æ•°æ—¶ï¼Œä½ åº”è¯¥æ€»æ˜¯å†™ä¸¤ä¸ªæˆ–å¤šä¸ªç­¾åï¼Œåœ¨å‡½æ•°çš„å®ç°ä¹‹ä¸Šã€‚ä½ åº”è¯¥æ€»æ˜¯å†™ä¸¤ä¸ªæˆ–å¤šä¸ªç­¾åï¼Œåœ¨å‡½æ•°çš„å®ç°ä¹‹ä¸Šã€‚</code><br>The implementation signature must also be compatible with the overload signatures. For example, these functions have errors because the implementation signature doesnâ€™t match the overloads in a correct way:<br><code>å®ç°ç­¾åå¿…é¡»ä¸é‡è½½ç­¾åä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œè¿™äº›å‡½æ•°æœ‰é”™è¯¯ï¼Œå› ä¸ºå®ç°ç­¾åä¸æ­£ç¡®ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function fn(x: boolean): void;&#x2F;&#x2F; Argument type isn&#39;t rightfunction fn(x: string): void;&#x2F;&#x2F; This overload signature is not compatible with its implementation signature.function fn(x: boolean) &#123;&#125;function fn(x: string): string;&#x2F;&#x2F; Return type isn&#39;t rightfunction fn(x: number): boolean;&#x2F;&#x2F; This overload signature is not compatible with its implementation signature.function fn(x: string | number) &#123;  return &quot;oops&quot;;&#125;</code></pre><h2 id="Writing-Good-Overloads"><a href="#Writing-Good-Overloads" class="headerlink" title="Writing Good Overloads"></a>Writing Good Overloads</h2><p><code>å†™å¥½é‡è½½</code><br>Like generics, there are a few guidelines you should follow when using function overloads. Following these principles will make your function easier to call, easier to understand, and easier to implement.<br><code>å°±åƒæ³›å‹ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸€äº›å»ºè®®æä¾›ç»™ä½ ã€‚éµå¾ªè¿™äº›åŸåˆ™ï¼Œå¯ä»¥è®©ä½ çš„å‡½æ•°æ›´æ–¹ä¾¿è°ƒç”¨ã€ç†è§£ã€‚</code><br>Letâ€™s consider a function that returns the length of a string or an array:<br><code>æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°ç»„çš„é•¿åº¦ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function len(s: string): number;function len(arr: any[]): number;function len(x: any) &#123;  return x.length;&#125;</code></pre><p>This function is fine; we can invoke it with strings or arrays. However, we canâ€™t invoke it with a value that might be a string or an array, because TypeScript can only resolve a function call to a single overload:<br><code>è¿™ä¸ªå‡½æ•°ä»£ç åŠŸèƒ½å®ç°äº†ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæŠ¥é”™ï¼Œä½†æˆ‘ä»¬ä¸èƒ½ä¼ å…¥ä¸€ä¸ªå¯èƒ½æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ˜¯æ•°ç»„çš„å€¼ï¼Œå› ä¸º TypeScript åªèƒ½ä¸€æ¬¡ç”¨ä¸€ä¸ªå‡½æ•°é‡è½½å¤„ç†ä¸€æ¬¡å‡½æ•°è°ƒç”¨ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">len(&quot;&quot;); &#x2F;&#x2F; OKlen([0]); &#x2F;&#x2F; OKlen(Math.random() &gt; 0.5 ? &quot;hello&quot; : [0]);&#x2F;&#x2F; No overload matches this call.&#x2F;&#x2F; æ²¡æœ‰åŒ¹é…çš„é‡è½½å‡½æ•°ã€‚&#x2F;&#x2F; Overload 1 of 2, &#39;(s: string): number&#39;, gave the following error.&#x2F;&#x2F; é‡è½½ 1 å’Œ 2 ä¹‹é—´çš„å‡½æ•°è°ƒç”¨æŠ¥é”™ã€‚&#x2F;&#x2F; Argument of type &#39;number[] | &quot;hello&quot;&#39; is not assignable to parameter of type &#39;string&#39;.&#x2F;&#x2F;  å‚æ•°ç±»å‹ &#39;number[] | &quot;hello&quot;&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;string&#39;ã€‚&#x2F;&#x2F; Type &#39;number[]&#39; is not assignable to type &#39;string&#39;.&#x2F;&#x2F; ç±»å‹ &#39;number[]&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;string&#39;ã€‚&#x2F;&#x2F; Overload 2 of 2, &#39;(arr: any[]): number&#39;, gave the following error.&#x2F;&#x2F; é‡è½½ 2 å’Œ 2 ä¹‹é—´çš„å‡½æ•°è°ƒç”¨æŠ¥é”™ã€‚&#x2F;&#x2F; Argument of type &#39;number[] | &quot;hello&quot;&#39; is not assignable to parameter of type &#39;any[]&#39;.&#x2F;&#x2F; å‚æ•°ç±»å‹ &#39;number[] | &quot;hello&quot;&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;any[]&#39;ã€‚&#x2F;&#x2F; Type &#39;string&#39; is not assignable to type &#39;any[]&#39;.&#x2F;&#x2F; ç±»å‹ &#39;string&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;any[]&#39;ã€‚</code></pre><p>Because both overloads have the same argument count and same return type, we can instead write a non-overloaded version of the function:<br><code>å› ä¸ºä¸¤ä¸ªé‡è½½å‡½æ•°çš„å‚æ•°æ•°é‡å’Œè¿”å›å€¼ç±»å‹éƒ½ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªä¸é‡è½½çš„å‡½æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function len(x: any[] | string) &#123;  return x.length;&#125;</code></pre><p>This is much better! Callers can invoke this with either sort of value, and as an added bonus, we donâ€™t have to figure out a correct implementation signature.<br><code>è¿™æ›´å¥½äº†ï¼è°ƒç”¨è€…å¯ä»¥ä¼ å…¥ä»»æ„ç±»å‹çš„å€¼ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸éœ€è¦å†å»æ‰¾ä¸€ä¸ªæ­£ç¡®çš„å®ç°ç­¾åã€‚</code><br>Always prefer parameters with union types instead of overloads when possible<br><code>å¦‚æœå¯ä»¥çš„è¯ï¼Œå°½é‡ä½¿ç”¨è”åˆç±»å‹è€Œä¸æ˜¯é‡è½½å‡½æ•°ã€‚</code></p><h2 id="Declaring-this-in-a-Function"><a href="#Declaring-this-in-a-Function" class="headerlink" title="Declaring this in a Function"></a>Declaring this in a Function</h2><p><code>åœ¨å‡½æ•°ä¸­å£°æ˜ this</code><br>TypeScript will infer what the this should be in a function via code flow analysis, for example in the following:<br><code>TypeScript ä¼šæ ¹æ®ä»£ç æµåˆ†ææ¥å†³å®šå‡½æ•°ä¸­ this çš„å€¼ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const user &#x3D; &#123;  id: 123,  admin: false,  becomeAdmin: function () &#123;    this.admin &#x3D; true;  &#125;,&#125;;</code></pre><p>TypeScript understands that the function user.becomeAdmin has a corresponding this which is the outer object user. this, heh, can be enough for a lot of cases, but there are a lot of cases where you need more control over what object this represents. The JavaScript specification states that you cannot have a parameter called this, and so TypeScript uses that syntax space to let you declare the type for this in the function body.<br><code>TypeScript çŸ¥é“å‡½æ•° user.becomeAdmin æœ‰ä¸€ä¸ªå¯¹åº”çš„ thisï¼Œè¿™ä¸ª this å¯ä»¥è¶³å¤Ÿå¤§éƒ¨åˆ†çš„æƒ…å†µï¼Œä½†æœ‰å¾ˆå¤šæƒ…å†µéœ€è¦æ›´å¤šçš„æ§åˆ¶æƒã€‚ JavaScript è§„èŒƒç¦æ­¢ä½¿ç”¨ this å‚æ•°ï¼Œå› æ­¤ TypeScript ä½¿ç”¨è¿™ç§è¯­æ³•ç©ºé—´æ¥å£°æ˜å‡½æ•°ä½“ä¸­ this çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface DB &#123;  filterUsers(filter: (this: User) &#x3D;&gt; boolean): User[];&#125;const db &#x3D; getDB();const admins &#x3D; db.filterUsers(function (this: User) &#123;  return this.admin;&#125;);</code></pre><p>This pattern is common with callback-style APIs, where another object typically controls when your function is called. Note that you need to use function and not arrow functions to get this behavior:<br><code>è¿™ç§æ¨¡å¼é€šå¸¸å‡ºç°åœ¨å›è°ƒå‡½æ•°é£æ ¼çš„ API ä¸­ï¼Œå…¶ä¸­å¦ä¸€ä¸ªå¯¹è±¡é€šå¸¸æ§åˆ¶å‡½æ•°è°ƒç”¨çš„æ—¶æœºã€‚è¯·æ³¨æ„ï¼Œä½ éœ€è¦ä½¿ç”¨ function è€Œä¸æ˜¯ arrow function æ¥è·å–è¿™ç§è¡Œä¸ºã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface DB &#123;  filterUsers(filter: (this: User) &#x3D;&gt; boolean): User[];&#125;const db &#x3D; getDB();const admins &#x3D; db.filterUsers(() &#x3D;&gt; this.admin);&#x2F;&#x2F; The containing arrow function captures the global value of &#39;this&#39;.&#x2F;&#x2F; è¿™ä¸ªåŒ…å«çš„ç®­å¤´å‡½æ•°æ•è·äº†å…¨å±€å€¼ &#39;this&#39;ã€‚&#x2F;&#x2F; Element implicitly has an &#39;any&#39; type because type &#39;typeof globalThis&#39; has no index signature.&#x2F;&#x2F; å…ƒç´ éšå¼æœ‰ä¸€ä¸ª &#39;any&#39; ç±»å‹ï¼Œå› ä¸ºç±»å‹ &#39;typeof globalThis&#39; æ²¡æœ‰ç´¢å¼•ç­¾åã€‚</code></pre><h2 id="Other-Types-to-Know-About"><a href="#Other-Types-to-Know-About" class="headerlink" title="Other Types to Know About"></a>Other Types to Know About</h2><p><code>å…¶ä»–éœ€è¦çŸ¥é“çš„ç±»å‹</code><br>There are some additional types youâ€™ll want to recognize that appear often when working with function types. Like all types, you can use them everywhere, but these are especially relevant in the context of functions.<br><code>è¿™é‡Œä»‹ç»ä¸€äº›ä¹Ÿä¼šç»å¸¸å‡ºç°çš„ç±»å‹ã€‚åƒå…¶ä»–çš„ç±»å‹ä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒä»¬ï¼Œä½†å®ƒä»¬ç»å¸¸ä¸å‡½æ•°æ­é…ä½¿ç”¨ã€‚</code><br><strong>void</strong></p><p>void represents the return value of functions which donâ€™t return a value. Itâ€™s the inferred type any time a function doesnâ€™t have any return statements, or doesnâ€™t return any explicit value from those return statements:<br><code>void ç±»å‹è¡¨ç¤ºå‡½æ•°æ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µã€‚å®ƒåœ¨å‡½æ•°æ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µä¸‹è¢«æ¨æ–­ä¸º any ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; The inferred return type is voidfunction noop() &#123;  return;&#125;</code></pre><p>In JavaScript, a function that doesnâ€™t return any value will implicitly return the value undefined. However, void and undefined are not the same thing in TypeScript. There are further details at the end of this chapter.<br><code>åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°æ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼Œå‡½æ•°ä¼šè‡ªåŠ¨è¿”å› undefinedã€‚ä½†æ˜¯åœ¨ TypeScript ä¸­ï¼Œvoid å’Œ undefined çš„ç±»å‹ä¸ä¸€æ ·ã€‚æœ‰æ›´å¤šè¯¦æƒ…åœ¨æœ¬ç« æœ«å°¾ã€‚</code><br>void is not the same as undefined.<br><code>void ç±»å‹ä¸æ˜¯ undefined ç±»å‹ã€‚</code></p><p><strong>object</strong></p><p>The special type object refers to any value that isnâ€™t a primitive (string, number, bigint, boolean, symbol, null, or undefined). This is different from the empty object type { }, and also different from the global type Object. Itâ€™s very likely you will never use Object.<br><code>è¿™ä¸ªç‰¹æ®Šçš„ç±»å‹ object å¯ä»¥è¡¨ç¤ºä»»ä½•ä¸æ˜¯åŸå§‹ç±»å‹ï¼ˆprimitiveï¼‰çš„å€¼ (stringã€numberã€bigintã€booleanã€symbolã€nullã€undefined)ã€‚object ä¸åŒäºç©ºå¯¹è±¡ç±»å‹ &#123; &#125;ï¼Œä¹Ÿä¸åŒäºå…¨å±€ç±»å‹ Objectã€‚å¾ˆæœ‰å¯èƒ½ä½ ä¹Ÿç”¨ä¸åˆ° Object</code></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>object is not Object. Always use object!<br><code>object ä¸åŒäº Object ï¼Œæ€»æ˜¯ç”¨ object!</code></p></blockquote><p>Note that in JavaScript, function values are objects: They have properties, have Object.prototype in their prototype chain, are instanceof Object, you can call Object.keys on them, and so on. For this reason, function types are considered to be objects in TypeScript.<br><code>æ³¨æ„åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°å°±æ˜¯å¯¹è±¡ï¼Œä»–ä»¬å¯ä»¥æœ‰å±æ€§ï¼Œåœ¨ä»–ä»¬çš„åŸå‹é“¾ä¸Šæœ‰ Object.prototypeï¼Œå¹¶ä¸” instanceof Objectã€‚ä½ å¯ä»¥å¯¹å‡½æ•°ä½¿ç”¨ Object.keys ç­‰ç­‰ã€‚ç”±äºè¿™äº›åŸå› ï¼Œåœ¨ TypeScript ä¸­ï¼Œå‡½æ•°ä¹Ÿè¢«è®¤ä¸ºæ˜¯ objectã€‚</code></p><p><strong>unknown</strong></p><p>The unknown type represents any value. This is similar to the any type, but is safer because itâ€™s not legal to do anything with an unknown value:<br><code>unknown ç±»å‹å¯ä»¥è¡¨ç¤ºä»»ä½•å€¼ã€‚æœ‰ç‚¹ç±»ä¼¼äº anyï¼Œä½†æ˜¯æ›´å®‰å…¨ï¼Œå› ä¸ºå¯¹ unknown ç±»å‹çš„å€¼åšä»»ä½•äº‹æƒ…éƒ½æ˜¯ä¸åˆæ³•çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function f1(a: any) &#123;  a.b(); &#x2F;&#x2F; OK&#125;function f2(a: unknown) &#123;  a.b();  &#x2F;&#x2F; Object is of type &#39;unknown&#39;.&#125;</code></pre><p>This is useful when describing function types because you can describe functions that accept any value without having any values in your function body.<br><code>æœ‰çš„æ—¶å€™ç”¨æ¥æè¿°å‡½æ•°ç±»å‹ï¼Œè¿˜æ˜¯è›®æœ‰ç”¨çš„ã€‚ä½ å¯ä»¥æè¿°ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¼ å…¥ä»»ä½•å€¼ï¼Œä½†æ˜¯åœ¨å‡½æ•°ä½“å†…åˆä¸ç”¨åˆ° any ç±»å‹çš„å€¼ã€‚</code><br>Conversely, you can describe a function that returns a value of unknown type:<br><code>ç›¸åï¼Œä½ å¯ä»¥æè¿°ä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªä¸çŸ¥é“ä»€ä¹ˆç±»å‹çš„å€¼ï¼Œæ¯”å¦‚ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function safeParse(s: string): unknown &#123;  return JSON.parse(s);&#125;&#x2F;&#x2F; Need to be careful with &#39;obj&#39;!const obj &#x3D; safeParse(someRandomString);</code></pre><p><strong>never</strong></p><p>Some functions never return a value:<br><code>ä¸€äº›å‡½æ•°ä»æ¥ä¸è¿”å›å€¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function fail(msg: string): never &#123;  throw new Error(msg);&#125;</code></pre><p>The never type represents values which are never observed. In a return type, this means that the function throws an exception or terminates execution of the program.<br><code>never ç±»å‹è¡¨ç¤ºä¸€ä¸ªå€¼ä¸ä¼šå†è¢«è§‚å¯Ÿåˆ° (observed)ã€‚ä½œä¸ºä¸€ä¸ªè¿”å›ç±»å‹æ—¶ï¼Œå®ƒè¡¨ç¤ºè¿™ä¸ªå‡½æ•°ä¼šä¸¢ä¸€ä¸ªå¼‚å¸¸ï¼Œæˆ–è€…ä¼šç»“æŸç¨‹åºçš„æ‰§è¡Œã€‚</code><br>never also appears when TypeScript determines thereâ€™s nothing left in a union.<br><code>å½“ TypeScript ç¡®å®šåœ¨è”åˆç±»å‹ä¸­å·²ç»æ²¡æœ‰å¯èƒ½æ˜¯å…¶ä¸­çš„ç±»å‹çš„æ—¶å€™ï¼Œnever ç±»å‹ä¹Ÿä¼šå‡ºç°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function fn(x: string | number) &#123;  if (typeof x &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    &#x2F;&#x2F; do something  &#125; else if (typeof x &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;    &#x2F;&#x2F; do something else  &#125; else &#123;    x; &#x2F;&#x2F; has type &#39;never&#39;!  &#125;&#125;</code></pre><p><strong>Function</strong></p><p>The global type Function describes properties like bind, call, apply, and others present on all function values in JavaScript. It also has the special property that values of type Function can always be called; these calls return any:<br><code>Function ç±»å‹æè¿°äº†æ‰€æœ‰å‡½æ•°å€¼çš„å±æ€§ï¼Œæ¯”å¦‚ bindã€callã€apply ç­‰ç­‰ã€‚è¿™ä¸ªç±»å‹ä¹Ÿæœ‰ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼Œå¯ä»¥è¢«è°ƒç”¨ï¼Œè¿™äº›è°ƒç”¨ä¼šè¿”å›ä»»ä½•ç±»å‹çš„å€¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(f: Function) &#123;  return f(1, 2, 3);&#125;</code></pre><p>This is an untyped function call and is generally best avoided because of the unsafe any return type.<br><code>è¿™æ˜¯ä¸€ä¸ªæ— ç±»å‹å‡½æ•°è°ƒç”¨ (untyped function call)ï¼Œè¿™ç§è°ƒç”¨æœ€å¥½è¢«é¿å…ï¼Œå› ä¸ºå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªä¸å®‰å…¨çš„ anyç±»å‹ã€‚</code><br>If you need to accept an arbitrary function but donâ€™t intend to call it, the type () &#x3D;&gt; void is generally safer.<br><code>å¦‚æœä½ å‡†å¤‡æ¥å—ä¸€ä¸ªé»‘ç›’çš„å‡½æ•°ï¼Œä½†æ˜¯åˆä¸æ‰“ç®—è°ƒç”¨å®ƒï¼Œ() =&gt; void ä¼šæ›´å®‰å…¨ä¸€äº›ã€‚</code></p><h2 id="Rest-Parameters-and-Arguments"><a href="#Rest-Parameters-and-Arguments" class="headerlink" title="Rest Parameters and Arguments"></a>Rest Parameters and Arguments</h2><p><code>å‰©ä½™å‚æ•°</code><br><strong>Background Reading:</strong></p><ul><li>Rest Parameters</li><li>Spread Syntax</li></ul><h2 id="Rest-Parameters"><a href="#Rest-Parameters" class="headerlink" title="Rest Parameters"></a>Rest Parameters</h2><p><code>å‰©ä½™å‚æ•°</code><br>In addition to using optional parameters or overloads to make functions that can accept a variety of fixed argument counts, we can also define functions that take an unbounded number of arguments using rest parameters.<br><code>é™¤äº†ç”¨å¯é€‰å‚æ•°ã€é‡è½½èƒ½è®©å‡½æ•°æ¥æ”¶ä¸åŒæ•°é‡çš„å‡½æ•°å‚æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨å‰©ä½™å‚æ•°è¯­æ³•ï¼ˆrest parametersï¼‰ï¼Œå®šä¹‰ä¸€ä¸ªå¯ä»¥ä¼ å…¥æ•°é‡ä¸å—é™åˆ¶çš„å‡½æ•°å‚æ•°çš„å‡½æ•°ï¼š</code><br>A rest parameter appears after all other parameters, and uses the â€¦ syntax:<br><code>å‰©ä½™å‚æ•°å¿…é¡»æ”¾åœ¨æ‰€æœ‰å‚æ•°çš„æœ€åé¢ï¼Œå¹¶ä½¿ç”¨ ... è¯­æ³•ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function multiply(n: number, ...m: number[]) &#123;  return m.map((x) &#x3D;&gt; n \* x);&#125;&#x2F;&#x2F; &#39;a&#39; gets value [10, 20, 30, 40]const a &#x3D; multiply(10, 1, 2, 3, 4);</code></pre><p>In TypeScript, the type annotation on these parameters is implicitly any[] instead of any, and any type annotation given must be of the form Array<T>or T[], or a tuple type (which weâ€™ll learn about later).<br><code>åœ¨ TypeScript ä¸­ï¼Œå‰©ä½™å‚æ•°çš„ç±»å‹ä¼šè¢«éšå¼è®¾ç½®ä¸º any[] è€Œä¸æ˜¯ anyï¼Œå¦‚æœä½ è¦è®¾ç½®å…·ä½“çš„ç±»å‹ï¼Œå¿…é¡»æ˜¯ Array&lt;T&gt; æˆ–è€… T[]çš„å½¢å¼ï¼Œå†æˆ–è€…å°±æ˜¯å…ƒç»„ç±»å‹ï¼ˆtuple typeï¼‰ã€‚</code></p><h2 id="Rest-Arguments"><a href="#Rest-Arguments" class="headerlink" title="Rest Arguments"></a>Rest Arguments</h2><p><code>å‰©ä½™å‚æ•°</code><br>Conversely, we can provide a variable number of arguments from an array using the spread syntax. For example, the push method of arrays takes any number of arguments:<br><code>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€ä¸ªä½¿ç”¨ ... è¯­æ³•çš„æ•°ç»„ï¼Œä¸ºå‡½æ•°æä¾›ä¸å®šæ•°é‡çš„å®å‚ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ•°ç»„çš„ push æ–¹æ³•å°±å¯ä»¥æ¥å—ä»»ä½•æ•°é‡çš„å®å‚ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const arr1 &#x3D; [1, 2, 3];const arr2 &#x3D; [4, 5, 6];arr1.push(...arr2);</code></pre><p>Note that in general, TypeScript does not assume that arrays are immutable. This can lead to some surprising behavior:<br><code>æ³¨æ„ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒTypeScript å¹¶ä¸ä¼šå‡å®šæ•°ç»„æ˜¯ä¸å˜çš„(immutable)ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›æ„å¤–çš„è¡Œä¸ºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Inferred type is number[] -- &quot;an array with zero or more numbers&quot;,&#x2F;&#x2F; not specifically two numbersconst args &#x3D; [8, 5];const angle &#x3D; Math.atan2(...args);&#x2F;&#x2F; A spread argument must either have a tuple type or be passed to a rest parameter.</code></pre><p>The best fix for this situation depends a bit on your code, but in general a const context is the most straightforward solution:<br><code>è¿™ç§æƒ…å†µçš„æœ€ä½³è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ¡ˆï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Inferred as 2-length tupleconst args &#x3D; [8, 5] as const;&#x2F;&#x2F; OKconst angle &#x3D; Math.atan2(...args);</code></pre><p>Using rest arguments may require turning on downlevelIteration when targeting older runtimes.<br><code>ä½¿ç”¨å‰©ä½™å‚æ•°å¯èƒ½éœ€è¦åœ¨æ›´æ—§çš„è¿è¡Œæ—¶é…åˆ downlevelIteration å‚æ•°ã€‚</code></p><h2 id="Parameter-Destructuring"><a href="#Parameter-Destructuring" class="headerlink" title="Parameter Destructuring"></a>Parameter Destructuring</h2><p><code>ä½ å¯ä»¥ä½¿ç”¨å‚æ•°è§£æ„æ–¹ä¾¿çš„å°†ä½œä¸ºå‚æ•°æä¾›çš„å¯¹è±¡è§£æ„ä¸ºå‡½æ•°ä½“å†…ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±€éƒ¨å˜é‡ï¼Œåœ¨ JavaScript ä¸­ï¼Œæ˜¯è¿™æ ·çš„ï¼š</code></p><p><strong>Background Reading:</strong></p><ul><li>Destructuring Assignment</li></ul><p>You can use parameter destructuring to conveniently unpack objects provided as an argument into one or more local variables in the function body. In JavaScript, it looks like this:<br><code>ä½ å¯ä»¥ä½¿ç”¨å‚æ•°è§£æ„æ¥è½»æ¾åœ°å°†ä¸€ä¸ªä½œä¸ºå‚æ•°æä¾›çš„å¯¹è±¡è§£æ„ä¸ºå‡½æ•°ä½“å†…ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±€éƒ¨å˜é‡ã€‚åœ¨ JavaScript ä¸­ï¼Œå®ƒçš„æ ·å­æ˜¯è¿™æ ·çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function sum(&#123; a, b, c &#125;) &#123;  console.log(a + b + c);&#125;sum(&#123; a: 10, b: 3, c: 9 &#125;);&#x2F;&#x2F; The type annotation for the object goes after the destructuring syntax:function sum(&#123; a, b, c &#125;: &#123; a: number; b: number; c: number &#125;) &#123;  console.log(a + b + c);&#125;</code></pre><p>This can look a bit verbose, but you can use a named type here as well:<br><code>è¿™å¯èƒ½ä¼šå¤ªé•¿ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‘½åç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Same as prior exampletype ABC &#x3D; &#123; a: number; b: number; c: number &#125;;function sum(&#123; a, b, c &#125;: ABC) &#123;  console.log(a + b + c);&#125;</code></pre><h2 id="Assignability-of-Functions"><a href="#Assignability-of-Functions" class="headerlink" title="Assignability of Functions"></a>Assignability of Functions</h2><p><code>å‡½æ•°çš„å¯èµ‹å€¼æ€§</code><br>Return type void<br><code>è¿”å›void</code><br>The void return type for functions can produce some unusual, but expected behavior.<br><code>å‡½æ•°çš„è¿”å›ç±»å‹ä¸ºvoidæ—¶ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›æœ‰æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚</code><br>Contextual typing with a return type of void does not force functions to not return something. Another way to say this is a contextual function type with a void return type (type vf &#x3D; () &#x3D;&gt; void), when implemented, can return any other value, but it will be ignored.<br><code>åœ¨ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºvoidçš„å‡½æ•°ä¸­ï¼Œä¸ä¼šå¼ºåˆ¶å‡½æ•°ä¸è¿”å›ä»€ä¹ˆä¸œè¥¿ã€‚å¦ä¸€ç§è¯´æ³•æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡å‡½æ•°ç±»å‹ï¼Œå®ƒçš„è¿”å›ç±»å‹ä¸ºvoidï¼Œå½“å®ç°çš„æ—¶å€™ï¼Œå¯ä»¥è¿”å›ä»»ä½•å€¼ï¼Œä½†æ˜¯å®ƒå°†è¢«å¿½ç•¥ã€‚</code><br>Thus, the following implementations of the type () &#x3D;&gt; void are valid:<br><code>å› æ­¤ï¼Œä¸‹é¢çš„å®ç°æ˜¯æœ‰æ•ˆçš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type voidFunc &#x3D; () &#x3D;&gt; void;const f1: voidFunc &#x3D; () &#x3D;&gt; &#123;  return true;&#125;;const f2: voidFunc &#x3D; () &#x3D;&gt; true;const f3: voidFunc &#x3D; function () &#123;  return true;&#125;;</code></pre><p>And when the return value of one of these functions is assigned to another variable, it will retain the type of void:<br><code>å½“ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼è¢«èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œå®ƒå°†ä¿æŒè¿”å›ç±»å‹ä¸ºvoidçš„ç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const v1 &#x3D; f1();const v2 &#x3D; f2();const v3 &#x3D; f3();</code></pre><p>This behavior exists so that the following code is valid even though Array.prototype.push returns a number and the Array.prototype.forEach method expects a function with a return type of void.<br><code>è¿™ç§è¡Œä¸ºå­˜åœ¨ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ä¸‹é¢çš„ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå³ä½¿ Array.prototype.push è¿”å›ä¸€ä¸ªæ•°å­—ï¼ŒArray.prototype.forEach æ–¹æ³•ä¹ŸæœŸæœ›ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºvoidçš„å‡½æ•°ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const src &#x3D; [1, 2, 3];const dst &#x3D; [0];src.forEach((el) &#x3D;&gt; dst.push(el));</code></pre><p>There is one other special case to be aware of, when a literal function definition has a void return type, that function must not return anything.<br><code>å½“ä¸€ä¸ªå­—é¢é‡å‡½æ•°å®šä¹‰æœ‰ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºvoidçš„å‡½æ•°ï¼Œé‚£ä¹ˆå‡½æ•°å¿…é¡»ä¸è¿”å›ä»»ä½•ä¸œè¥¿ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function f2(): void &#123;  &#x2F;&#x2F; @ts-expect-error  return true;&#125;const f3 &#x3D; function (): void &#123;  &#x2F;&#x2F; @ts-expect-error , Type &#39;boolean&#39; is not assignable to type &#39;void&#39;.  return true;&#125;;</code></pre><p>For more on void please refer to these other documentation entries:<br><code>æ›´å¤šå…³äºvoidçš„æ–‡æ¡£è¯·å‚è§è¿™äº›å…¶ä»–æ–‡æ¡£æ¡ç›®ï¼š</code><br><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html#void">v1 handbook</a><br><a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void">v2 handbook</a><br>FAQ - â€œWhy are functions returning non-void assignable to function returning void?â€<br><code>ä¸ºä»€ä¹ˆå‡½æ•°è¿”å›évoidç±»å‹å¯ä»¥èµ‹å€¼ç»™å‡½æ•°è¿”å›voidç±»å‹ï¼Ÿ</code></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.typescriptlang.org/docs/handbook/2/functions.html">TypeScript æ‰‹å†Œ functions</a><br><a href="https://ts.yayujs.com/handbook/MoreOnFunctions.html#%E5%87%BD%E6%95%B0-more-on-functions">å‡½æ•°ï¼ˆMore On Functionsï¼‰</a></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>4.Typescriptæ‰‹å†Œ æ”¶ç¼©ç±»å‹</title>
      <link href="//post/2022-06-08ts-norrowing.html"/>
      <url>//post/2022-06-08ts-norrowing.html</url>
      
        <content type="html"><![CDATA[<h2 id="Narrowing"><a href="#Narrowing" class="headerlink" title="Narrowing"></a>Narrowing</h2><p><code>ç¼©å°èŒƒå›´</code></p><p>Imagine we have a function called padLeft.<br><code>è¯•æƒ³æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åä¸º padLeftï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function padLeft(padding: number | string, input: string): string &#123;  throw new Error(&quot;Not implemented yet!&quot;);&#125;</code></pre><p>If padding is a number, it will treat that as the number of spaces we want to prepend to input. If padding is a string, it should just prepend padding to input. Letâ€™s try to implement the logic for when padLeft is passed a number for padding.</p><p><code>å¦‚æœ padding æ˜¯æ•°å­—ï¼Œå®ƒå°†ä¼šå°† padding è§†ä¸ºæˆ‘ä»¬è¦æ·»åŠ çš„ç©ºæ ¼æ•°é‡ï¼Œå¦‚æœ padding æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šæ·»åŠ  padding åˆ° input çš„å‰é¢ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function padLeft(padding: number | string, input: string) &#123;  return &quot; &quot;.repeat(padding) + input;  &#x2F;&#x2F; Argument of type &#39;string | number&#39; is not assignable to parameter of type &#39;number&#39;.  &#x2F;&#x2F; å‚æ•°ç±»å‹ &#39;string | number&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;number&#39;ã€‚  &#x2F;&#x2F; Type &#39;string&#39; is not assignable to type &#39;number&#39;.  &#x2F;&#x2F; ç±»å‹ &#39;string&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;number&#39;ã€‚&#125;</code></pre><p>Uh-oh, weâ€™re getting an error on padding.<br><code>å“‡ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œpaddingã€‚</code><br>TypeScript is warning us that adding a number | string to a number might not give us what we want, and itâ€™s right. In other words, we havenâ€™t explicitly checked if padding is a number first, nor are we handling the case where itâ€™s a string, so letâ€™s do exactly that.<br><code>è¿™æ˜¯ TypeScript åœ¨è­¦å‘Šæˆ‘ä»¬ï¼Œå¦‚æœæŠŠä¸€ä¸ª number ç±»å‹ (å³ä¾‹å­é‡Œçš„æ•°å­— 1 )å’Œä¸€ä¸ª number | string ç±»å‹ç›¸åŠ ï¼Œä¹Ÿè®¸å¹¶ä¸ä¼šè¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆæ£€æŸ¥ä¸‹ padding æ˜¯å¦æ˜¯ä¸€ä¸ª numberï¼Œæˆ–è€…å¤„ç†ä¸‹å½“ padding æ˜¯ string çš„æƒ…å†µï¼Œé‚£æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function padLeft(padding: number | string, input: string) &#123;  if (typeof padding &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;    return &quot; &quot;.repeat(padding) + input;  &#125;  return padding + input;&#125;</code></pre><p>If this mostly looks like uninteresting JavaScript code, thatâ€™s sort of the point. Apart from the annotations we put in place, this TypeScript code looks like JavaScript. The idea is that TypeScriptâ€™s type system aims to make it as easy as possible to write typical JavaScript code without bending over backwards to get type safety.<br><code>å¦‚æœè¿™ä¸ªä»£ç çœ‹èµ·æ¥æ²¡æœ‰ä»€ä¹ˆæ„æ€ï¼Œé‚£å°±æ˜¯ TypeScript çš„ç±»å‹ç³»ç»Ÿå¸Œæœ›æˆ‘ä»¬èƒ½å†™å‡ºä¸€äº›æ¯”è¾ƒæ™®é€šçš„ JavaScript ä»£ç ï¼Œè€Œä¸æ˜¯æŠ˜è…¾è‡³æœ€åæ‰çŸ¥é“ç±»å‹å®‰å…¨ã€‚</code><br>While it might not look like much, thereâ€™s actually a lot going under the covers here. Much like how TypeScript analyzes runtime values using static types, it overlays type analysis on JavaScriptâ€™s runtime control flow constructs like if&#x2F;else, conditional ternaries, loops, truthiness checks, etc., which can all affect those types.<br><code>è¿™é‡Œçš„å®ç°æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å®ƒçœŸçš„æ˜¯ä¸€ä¸ªç±»å‹æ£€æŸ¥å™¨ï¼Œå®ƒä¼šåœ¨ JavaScript ä¸­çš„ if/elseã€æ¡ä»¶è¡¨è¾¾å¼ã€å¾ªç¯ã€çœŸå‡å€¼æ£€æŸ¥ç­‰æ§åˆ¶æµä¸­è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚</code><br>Within our if check, TypeScript sees typeof padding &#x3D;&#x3D;&#x3D; â€œnumberâ€ and understands that as a special form of code called a type guard. TypeScript follows possible paths of execution that our programs can take to analyze the most specific possible type of a value at a given position. It looks at these special checks (called type guards) and assignments, and the process of refining types to more specific types than declared is called narrowing. In many editors we can observe these types as they change, and weâ€™ll even do so in our examples.<br><code>åœ¨æˆ‘ä»¬çš„ if æ£€æŸ¥ä¸­ï¼ŒTypeScript ä¼šçœ‹åˆ° typeof padding === &quot;number&quot;ï¼Œå¹¶ä¸”ä¼šè§£é‡Šè¿™ä¸ªè¡¨è¾¾å¼ä¸ºä¸€ä¸ªç‰¹æ®Šçš„ä»£ç ï¼Œè¿™ä¸ªä»£ç è¢«ç§°ä¸ºç±»å‹æ£€æŸ¥ã€‚TypeScript ä¼šæ ¹æ®æˆ‘ä»¬çš„ç¨‹åºçš„æ‰§è¡Œæµï¼Œæ¥æ£€æŸ¥ä¸€ä¸ªå€¼çš„æœ€å…·ä½“çš„ç±»å‹ã€‚è¿™äº›ç‰¹æ®Šçš„æ£€æŸ¥ï¼ˆç§°ä¸ºç±»å‹æ£€æŸ¥ï¼‰å’Œèµ‹å€¼ï¼Œä¼šå½±å“åˆ°ç±»å‹çš„ç²¾ç¡®æ€§ã€‚åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™äº›ç±»å‹çš„å˜åŒ–ï¼Œæˆ‘ä»¬ä¹Ÿä¼šåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­çœ‹åˆ°ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function padLeft(padding: number | string, input: string) &#123;  if (typeof padding &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;    return &quot; &quot;.repeat(padding) + input;    &#x2F;&#x2F; (parameter) padding: number  &#125;  return padding + input;  &#x2F;&#x2F; (parameter) padding: string&#125;</code></pre><p>There are a couple of different constructs TypeScript understands for narrowing.<br><code>TypeScript ä¼šç†è§£ä¸€äº›æ›´åŠ ç²¾ç¡®çš„æ„é€ ã€‚</code></p><h2 id="typeof-type-guards"><a href="#typeof-type-guards" class="headerlink" title="typeof type guards"></a>typeof type guards</h2><p><code>ç±»å‹ä¿æŠ¤</code></p><p>As weâ€™ve seen, JavaScript supports a typeof operator which can give very basic information about the type of values we have at runtime. TypeScript expects this to return a certain set of strings:<br><code>JavaScript æ”¯æŒä¸€ä¸ª typeof æ“ä½œç¬¦ï¼Œå®ƒå¯ä»¥ç»™æˆ‘ä»¬çš„å€¼è¿”å›ä¸€äº›åŸºæœ¬çš„ä¿¡æ¯ã€‚TypeScript æœŸæœ›è¿™äº›ä¿¡æ¯æ˜¯ä¸€ä¸ªç‰¹å®šçš„é›†åˆï¼š</code></p><p>â€œstringâ€<br>â€œnumberâ€<br>â€œbigintâ€<br>â€œbooleanâ€<br>â€œsymbolâ€<br>â€œundefinedâ€<br>â€œobjectâ€<br>â€œfunctionâ€</p><p>Like we saw with padLeft, this operator comes up pretty often in a number of JavaScript libraries, and TypeScript can understand it to narrow types in different branches.<br><code>å’Œ padLeft ä¸€æ ·ï¼Œè¿™ä¸ªæ“ä½œç¬¦åœ¨ JavaScript åº“ä¸­å¾ˆå¸¸è§ï¼ŒTypeScript å¯ä»¥ç†è§£å®ƒæ¥ç¼©å°ä¸åŒçš„åˆ†æ”¯çš„ç±»å‹ã€‚</code><br>In TypeScript, checking against the value returned by typeof is a type guard. Because TypeScript encodes how typeof operates on different values, it knows about some of its quirks in JavaScript. For example, notice that in the list above, typeof doesnâ€™t return the string null. Check out the following example:<br><code>åœ¨ TypeScript ä¸­ï¼Œæ£€æŸ¥ typeof è¿”å›çš„å€¼å°±æ˜¯ä¸€ç§ç±»å‹ä¿æŠ¤ã€‚TypeScript çŸ¥é“ typeof ä¸åŒå€¼çš„ç»“æœï¼Œå®ƒä¹Ÿèƒ½è¯†åˆ« JavaScript ä¸­ä¸€äº›æ€ªå¼‚çš„åœ°æ–¹ï¼Œå°±æ¯”å¦‚åœ¨ä¸Šé¢çš„åˆ—è¡¨ä¸­ï¼Œtypeof å¹¶æ²¡æœ‰è¿”å›å­—ç¬¦ä¸² nullï¼Œçœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printAll(strs: string | string[] | null) &#123;  if (typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;    for (const s of strs) &#123;      &#x2F;&#x2F; Object is possibly &#39;null&#39;.      console.log(s);    &#125;  &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    console.log(strs);  &#125; else &#123;    &#x2F;&#x2F; do nothing  &#125;&#125;</code></pre><p>In the printAll function, we try to check if strs is an object to see if itâ€™s an array type (now might be a good time to reinforce that arrays are object types in JavaScript). But it turns out that in JavaScript, typeof null is actually â€œobjectâ€! This is one of those unfortunate accidents of history.<br><code>åœ¨è¿™ä¸ª printAll å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°è¯•åˆ¤æ–­ strs æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŸæœ¬çš„ç›®çš„æ˜¯åˆ¤æ–­å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œä½†æ˜¯åœ¨ JavaScript ä¸­ï¼Œtypeof null ä¹Ÿä¼šè¿”å› objectã€‚è€Œè¿™æ˜¯ JavaScript ä¸€ä¸ªä¸å¹¸çš„å†å²äº‹æ•…ã€‚</code><br>Users with enough experience might not be surprised, but not everyone has run into this in JavaScript; luckily, TypeScript lets us know that strs was only narrowed down to string[] | null instead of just string[].<br><code>ç†Ÿç»ƒçš„ç”¨æˆ·è‡ªç„¶ä¸ä¼šæ„Ÿåˆ°æƒŠè®¶ï¼Œä½†ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½å¦‚æ­¤ç†Ÿç»ƒã€‚ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼ŒTypeScript ä¼šè®©æˆ‘ä»¬çŸ¥é“ strs è¢«æ”¶çª„ä¸º strings[] | null ï¼Œè€Œä¸ä»…ä»…æ˜¯ string[]ã€‚</code><br>This might be a good segue into what weâ€™ll call â€œtruthinessâ€ checking.<br><code>è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¥½çš„è½¬æŠ˜ç‚¹ã€‚</code></p><h2 id="Truthiness-narrowing"><a href="#Truthiness-narrowing" class="headerlink" title="Truthiness narrowing"></a>Truthiness narrowing</h2><p><code>çœŸå®æ€§ç¼©å‡</code></p><p>Truthiness might not be a word youâ€™ll find in the dictionary, but itâ€™s very much something youâ€™ll hear about in JavaScript.<br><code>çœŸå®æ€§å¯èƒ½ä¸æ˜¯åœ¨å­—å…¸é‡Œé¢æ‰¾åˆ°çš„ï¼Œä½†æ˜¯ä½ ä¼šå¬åˆ° JavaScript ä¸­çš„çœŸå®æ€§ã€‚</code><br>In JavaScript, we can use any expression in conditionals, &amp;&amp;s, ||s, if statements, Boolean negations (!), and more. As an example, if statements donâ€™t expect their condition to always have the type boolean.<br><code>è¿™æ˜¯å› ä¸º JavaScript ä¼šåšéšå¼ç±»å‹è½¬æ¢ï¼Œåƒ 0 ã€NaNã€&quot;&quot;ã€0nã€null undefined è¿™äº›å€¼éƒ½ä¼šè¢«è½¬ä¸º falseï¼Œå…¶ä»–çš„å€¼åˆ™ä¼šè¢«è½¬ä¸º trueã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Boolean å‡½æ•°å¼ºåˆ¶è½¬ä¸º boolean å€¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´åŠ ç®€çŸ­çš„!!ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getUsersOnlineMessage(numUsersOnline: number) &#123;  if (numUsersOnline) &#123;    return &#96;There are $&#123;numUsersOnline&#125; online now!&#96;;  &#125;  return &quot;Nobody&#39;s here. :(&quot;;&#125;</code></pre><p>In JavaScript, constructs like if first â€œcoerceâ€ their conditions to booleans to make sense of them, and then choose their branches depending on whether the result is true or false. Values like<br><code>0ã€NaNã€&quot;&quot;ã€0nã€null undefined è¿™äº›å€¼éƒ½ä¼šè¢«è½¬ä¸º falseï¼Œå…¶ä»–çš„å€¼åˆ™ä¼šè¢«è½¬ä¸º trueã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Boolean å‡½æ•°å¼ºåˆ¶è½¬ä¸º boolean å€¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´åŠ ç®€çŸ­çš„!!ï¼š</code></p><ul><li>0</li><li>NaN</li><li>â€œâ€ (the empty string)</li><li>0n (the bigint version of zero)</li><li>null</li><li>undefined</li></ul><p>all coerce to false, and other values get coerced true. You can always coerce values to booleans by running them through the Boolean function, or by using the shorter double-Boolean negation. (The latter has the advantage that TypeScript infers a narrow literal boolean type true, while inferring the first as type boolean.)<br>æ‰€æœ‰ è¿™äº›å€¼éƒ½ä¼šè¢«è½¬ä¸º falseï¼Œå…¶ä»–çš„å€¼åˆ™ä¼šè¢«è½¬ä¸º trueã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ Boolean å‡½æ•°å¼ºåˆ¶è½¬ä¸º boolean å€¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´åŠ ç®€çŸ­çš„!!ã€‚(è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScript ä¼šæ¨æ–­ä¸€ä¸ªç®€å•çš„å¸ƒå°”å€¼ç±»å‹ trueï¼Œè€Œä¸æ˜¯ç±»å‹ booleanã€‚)</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; both of these result in &#39;true&#39;Boolean(&quot;hello&quot;); &#x2F;&#x2F; type: boolean, value: true!!&quot;world&quot;; &#x2F;&#x2F; type: true,    value: true</code></pre><p>Itâ€™s fairly popular to leverage this behavior, especially for guarding against values like null or undefined. As an example, letâ€™s &#96;&#96;&#96;using it for our printAll function.<code>è¿™ç§ä½¿ç”¨æ–¹å¼éå¸¸æµè¡Œï¼Œå°¤å…¶é€‚ç”¨äºé˜²èŒƒ null å’Œ undefiend è¿™ç§å€¼çš„æ—¶å€™ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ printAll å‡½æ•°ä¸­è¿™æ ·ä½¿ç”¨ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printAll(strs: string | string[] | null) &#123;  if (strs &amp;&amp; typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;    for (const s of strs) &#123;      console.log(s);    &#125;  &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    console.log(strs);  &#125;&#125;</code></pre><p>Youâ€™ll notice that weâ€™ve gotten rid of the error above by checking if strs is truthy. This at least prevents us from dreaded errors when we run our code like:<br><code>è¿™é‡Œæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬æ£€æŸ¥äº† strs æ˜¯å¦ä¸ºçœŸã€‚è¿™è‡³å°‘é˜²æ­¢äº†æˆ‘ä»¬åœ¨è¿è¡Œä»£ç æ—¶å‡ºç°çš„é”™è¯¯ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; TypeError: null is not iterable</code></pre><p>Keep in mind though that truthiness checking on primitives can often be error prone. As an example, consider a different attempt at writing printAll<br><code>ä½†è¿˜æ˜¯è¦æ³¨æ„ï¼Œåœ¨åŸºæœ¬ç±»å‹ä¸Šçš„çœŸå€¼æ£€æŸ¥å¾ˆå®¹æ˜“å¯¼è‡´é”™è¯¯ï¼Œæ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¿™æ ·å†™ printAll å‡½æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printAll(strs: string | string[] | null) &#123;  &#x2F;&#x2F; !!!!!!!!!!!!!!!!  &#x2F;&#x2F; DON&#39;T DO THIS!  &#x2F;&#x2F; KEEP READING  &#x2F;&#x2F; !!!!!!!!!!!!!!!!  if (strs) &#123;    if (typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;      for (const s of strs) &#123;        console.log(s);      &#125;    &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;      console.log(strs);    &#125;  &#125;&#125;</code></pre><p>We wrapped the entire body of the function in a truthy check, but this has a subtle downside: we may no longer be handling the empty string case correctly.<br><code>æˆ‘ä»¬å°†æ•´ä¸ªå‡½æ•°åŒ…è£¹åœ¨çœŸå€¼æ£€æŸ¥ä¸­ï¼Œä½†è¿™æœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼šæˆ‘ä»¬å¯èƒ½ä¸å†æ­£ç¡®å¤„ç†ç©ºå­—ç¬¦ä¸²çš„æƒ…å†µã€‚</code><br>TypeScript doesnâ€™t hurt us here at all, but this is behavior worth noting if youâ€™re less familiar with JavaScript. TypeScript can often help you catch bugs early on, but if you choose to do nothing with a value, thereâ€™s only so much that it can do without being overly prescriptive. If you want, you can make sure you handle situations like these with a linter.<br><code>TypeScript ä¸ä¼šç»™æˆ‘ä»¬ä»»ä½•éº»çƒ¦ï¼Œä½†å¦‚æœä½ ä¸äº†è§£ JavaScriptï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æŠ€å·§ã€‚TypeScript å¯ä»¥å¸®åŠ©ä½ æå‰å‘ç°é”™è¯¯ï¼Œä½†å¦‚æœä½ é€‰æ‹©ä¸åšä»»ä½•äº‹æƒ…ï¼Œé‚£ä¹ˆåªèƒ½æ˜¯æœ‰é™çš„ã€‚å¦‚æœä½ æƒ³ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª linter æ¥ç¡®ä¿ä½ åœ¨è¿™ç§æƒ…å†µä¸‹æ­£ç¡®å¤„ç†ã€‚</code><br>One last word on narrowing by truthiness is that Boolean negations with ! filter out from negated branches.<br><code>å¦å¤–ä¸€ä¸ªé€šè¿‡çœŸå€¼æ£€æŸ¥æ”¶çª„ç±»å‹çš„æ–¹å¼æ˜¯é€šè¿‡!æ“ä½œç¬¦ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function multiplyAll(values: number[] | undefined, factor: number): number[] | undefined &#123;  if (!values) &#123;    return values;  &#125; else &#123;    return values.map((x) &#x3D;&gt; x \* factor);  &#125;&#125;</code></pre><h2 id="Equality-narrowing"><a href="#Equality-narrowing" class="headerlink" title="Equality narrowing"></a>Equality narrowing</h2><p><code>ç­‰å€¼ç¼©å‡</code></p><p>TypeScript also uses switch statements and equality checks like &#x3D;&#x3D;&#x3D;, !&#x3D;&#x3D;, &#x3D;&#x3D;, and !&#x3D; to narrow types. For example:<br><code>TypeScript ä¹Ÿä½¿ç”¨äº† switch è¯­å¥å’Œç­‰å€¼æ£€æŸ¥ï¼Œæ¯”å¦‚ ===ã€!==ã€==ã€!=ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function example(x: string | number, y: string | boolean) &#123;  if (x &#x3D;&#x3D;&#x3D; y) &#123;    &#x2F;&#x2F; We can now call any &#39;string&#39; method on &#39;x&#39; or &#39;y&#39;.    x.toUpperCase();    &#x2F;&#x2F; (method) String.toUpperCase(): string    y.toLowerCase();    &#x2F;&#x2F; (method) String.toLowerCase(): string  &#125; else &#123;    console.log(x);    &#x2F;&#x2F; (parameter) x: string | number    console.log(y);    &#x2F;&#x2F; (parameter) y: string | boolean  &#125;&#125;</code></pre><p>When we checked that x and y are both equal in the above example, TypeScript knew their types also had to be equal. Since string is the only common type that both x and y could take on, TypeScript knows that x and y must be a string in the first branch.<br><code>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥äº† x å’Œ y æ˜¯å¦ç›¸ç­‰ã€‚TypeScript çŸ¥é“ x å’Œ y çš„ç±»å‹ä¹Ÿå¿…é¡»ç›¸ç­‰ã€‚å› ä¸º string æ˜¯æ‰€æœ‰ x å’Œ y å¯èƒ½å–å¾—çš„ç±»å‹çš„å…±åŒç±»å‹ï¼Œæ‰€ä»¥ TypeScript çŸ¥é“ x å’Œ y å¿…é¡»æ˜¯ string çš„ç¬¬ä¸€ä¸ªåˆ†æ”¯ã€‚</code><br>Checking against specific literal values (as opposed to variables) works also. In our section about truthiness narrowing, we wrote a printAll function which was error-prone because it accidentally didnâ€™t handle empty strings properly. Instead we could have done a specific check to block out nulls, and TypeScript still correctly removes null from the type of strs.<br><code>æ£€æŸ¥ç‰¹å®šçš„å­—é¢å€¼ï¼ˆè€Œä¸æ˜¯å˜é‡ï¼‰ä¹Ÿå¯ä»¥å·¥ä½œã€‚åœ¨æˆ‘ä»¬æåˆ°çš„çœŸå€¼æ”¶çª„ä¸­ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ª printAll å‡½æ•°ï¼Œå®ƒé”™è¯¯åœ°å¤„ç†äº†ç©ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯é€šè¿‡æ£€æŸ¥ null æ¥åšã€‚å¯ä»¥é€šè¿‡æ£€æŸ¥ null æ¥é˜»æ­¢ nullï¼ŒTypeScript ä»ç„¶èƒ½æ­£ç¡®åœ°ä» strs çš„ç±»å‹ä¸­å»é™¤ nullã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printAll(strs: string | string[] | null) &#123;  if (strs !&#x3D;&#x3D; null) &#123;    if (typeof strs &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;      for (const s of strs) &#123;        &#x2F;&#x2F; (parameter) strs: string[]        console.log(s);      &#125;    &#125; else if (typeof strs &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;      console.log(strs);      &#x2F;&#x2F; (parameter) strs: string    &#125;  &#125;&#125;</code></pre><p>JavaScriptâ€™s looser equality checks with &#x3D;&#x3D; and !&#x3D; also get narrowed correctly. If youâ€™re unfamiliar, checking whether something &#x3D;&#x3D; null actually not only checks whether it is specifically the value null - it also checks whether itâ€™s potentially undefined. The same applies to &#x3D;&#x3D; undefined: it checks whether a value is either null or undefined.<br><code>JavaScript çš„æ›´ç²—ç³™çš„ç­‰å€¼æ£€æŸ¥ï¼Œæ¯”å¦‚ == å’Œ !=ï¼Œä¹Ÿèƒ½æ­£ç¡®æ”¶çª„ç±»å‹ã€‚å¦‚æœä½ ä¸äº†è§£ï¼Œæ£€æŸ¥ something == null æ˜¯å¦ä¸ä»…æ£€æŸ¥äº† something æ˜¯å¦æ˜¯ç‰¹å®šçš„å€¼ nullï¼Œè¿˜æ£€æŸ¥äº†å®ƒæ˜¯å¦å¯èƒ½æ˜¯æœªå®šä¹‰çš„ã€‚åŒæ ·çš„é“ç†ï¼Œæ£€æŸ¥ something == undefined æ˜¯å¦ä¸ä»…æ£€æŸ¥äº† something æ˜¯å¦æ˜¯ç‰¹å®šçš„å€¼ undefinedï¼Œè¿˜æ£€æŸ¥äº†å®ƒæ˜¯å¦å¯èƒ½æ˜¯æœªå®šä¹‰çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Container &#123;  value: number | null | undefined;&#125;function multiplyValue(container: Container, factor: number) &#123;  &#x2F;&#x2F; Remove both &#39;null&#39; and &#39;undefined&#39; from the type.  if (container.value !&#x3D; null) &#123;    console.log(container.value);    &#x2F;&#x2F; (property) Container.value: number    &#x2F;&#x2F; Now we can safely multiply &#39;container.value&#39;.    container.value *&#x3D; factor;  &#125;&#125;</code></pre><h2 id="The-in-operator-narrowing"><a href="#The-in-operator-narrowing" class="headerlink" title="The in operator narrowing"></a>The in operator narrowing</h2><p><code>inæ“ä½œç¬¦ç¼©å‡</code></p><p>JavaScript has an operator for determining if an object has a property with a name: the in operator. TypeScript takes this into account as a way to narrow down potential types.<br><code>JavaScript æœ‰ä¸€ä¸ªæ“ä½œç¬¦ç”¨æ¥ç¡®å®šå¯¹è±¡æ˜¯å¦æœ‰ä¸€ä¸ªå±æ€§åï¼šin æ“ä½œç¬¦ã€‚TypeScript ä½¿ç”¨è¿™ç§æ–¹å¼æ¥æ”¶çª„å¯èƒ½çš„ç±»å‹ã€‚</code><br>For example, with the code: â€œvalueâ€ in x. where â€œvalueâ€ is a string literal and x is a union type. The â€œtrueâ€ branch narrows xâ€™s types which have either an optional or required property value, and the â€œfalseâ€ branch narrows to types which have an optional or missing property value.<br><code>ä¾‹å¦‚ï¼Œåœ¨ x ä¸­ï¼Œâ€œvalueâ€ æ˜¯ä¸€ä¸ªå­—é¢é‡å­—ç¬¦ä¸²ï¼Œx æ˜¯ä¸€ä¸ªè”åˆç±»å‹ã€‚â€œtrueâ€ åˆ†æ”¯æ”¶çª„ x çš„ç±»å‹ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¯é€‰æˆ–å¿…é¡»çš„å±æ€§å€¼ï¼Œè€Œâ€œfalseâ€ åˆ†æ”¯æ”¶çª„åˆ°æœ‰ä¸€ä¸ªå¯é€‰æˆ–ç¼ºå°‘çš„å±æ€§å€¼ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Fish &#x3D; &#123; swim: () &#x3D;&gt; void &#125;;type Bird &#x3D; &#123; fly: () &#x3D;&gt; void &#125;;function move(animal: Fish | Bird) &#123;  if (&quot;swim&quot; in animal) &#123;    return animal.swim();  &#125;  return animal.fly();&#125;</code></pre><p>To reiterate optional properties will exist in both sides for narrowing, for example a human could both swim and fly (with the right equipment) and thus should show up in both sides of the in check:<br><code>ä¸ºäº†æ”¶çª„å¯é€‰å±æ€§ï¼Œäººç±»å¯ä»¥åŒæ—¶é£è¡Œå’Œæ¸¸æ³³ï¼ˆæœ‰æ­£ç¡®çš„è£…å¤‡ï¼‰ï¼Œå› æ­¤åº”è¯¥åœ¨ in æ£€æŸ¥çš„ä¸¤ä¾§æ˜¾ç¤ºã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Fish &#x3D; &#123; swim: () &#x3D;&gt; void &#125;;type Bird &#x3D; &#123; fly: () &#x3D;&gt; void &#125;;type Human &#x3D; &#123; swim?: () &#x3D;&gt; void; fly?: () &#x3D;&gt; void &#125;;function move(animal: Fish | Bird | Human) &#123;  if (&quot;swim&quot; in animal) &#123;    animal;    &#x2F;&#x2F; (parameter) animal: Fish | Human  &#125; else &#123;    animal;    &#x2F;&#x2F; (parameter) animal: Bird | Human  &#125;&#125;</code></pre><h2 id="instanceof-narrowing"><a href="#instanceof-narrowing" class="headerlink" title="instanceof narrowing"></a>instanceof narrowing</h2><p><code>instanceofç¼©å‡</code></p><p>JavaScript has an operator for checking whether or not a value is an â€œinstanceâ€ of another value. More specifically, in JavaScript x instanceof Foo checks whether the prototype chain of x contains Foo.prototype. While we wonâ€™t dive deep here, and youâ€™ll see more of this when we get into classes, they can still be useful for most values that can be constructed with new. As you might have guessed, instanceof is also a type guard, and TypeScript narrows in branches guarded by instanceofs.<br><code>JavaScript æœ‰ä¸€ä¸ªæ“ä½œç¬¦ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå€¼çš„å®ä¾‹ï¼šin æ“ä½œç¬¦ã€‚æ›´è¯¦ç»†çš„è¯´ï¼Œåœ¨ JavaScript x instanceof Foo æ£€æŸ¥ x çš„åŸå‹é“¾æ˜¯å¦åŒ…å« Foo.prototypeã€‚ä½†æˆ‘ä»¬è¿™é‡Œä¸ä¼šæ·±å…¥ï¼Œå½“æˆ‘ä»¬æ¥è§¦åˆ°ç±»æ—¶ï¼Œå®ƒä»¬ä»ç„¶å¯ä»¥ç”¨äºæ„é€ å‡½æ•°ã€‚ä½ å¯èƒ½ä¼šçŒœåˆ°ï¼Œinstanceof æ˜¯ä¸€ä¸ªç±»å‹æ£€æŸ¥ï¼Œè€Œ TypeScript æ”¶çª„åœ¨ instanceof æ£€æŸ¥çš„åˆ†æ”¯ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function logValue(x: Date | string) &#123;  if (x instanceof Date) &#123;    console.log(x.toUTCString());    &#x2F;&#x2F; (parameter) x: Date  &#125; else &#123;    console.log(x.toUpperCase());    &#x2F;&#x2F; (parameter) x: string  &#125;&#125;</code></pre><h2 id="Assignments"><a href="#Assignments" class="headerlink" title="Assignments"></a>Assignments</h2><p><code>èµ‹å€¼</code></p><p>As we mentioned earlier, when we assign to any variable, TypeScript looks at the right side of the assignment and narrows the left side appropriately.<br><code>æˆ‘ä»¬å‰é¢æåˆ°è¿‡ï¼Œå½“æˆ‘ä»¬ç»™ä»»ä½•å˜é‡èµ‹å€¼æ—¶ï¼ŒTypeScript ä¼šæ£€æŸ¥èµ‹å€¼å³ä¾§å¹¶æ”¶çª„å·¦ä¾§é€‚å½“çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let x &#x3D; Math.random() &lt; 0.5 ? 10 : &quot;hello world!&quot;;let x: string | number;x &#x3D; 1;console.log(x);let x: number;x &#x3D; &quot;goodbye!&quot;;console.log(x);let x: string;</code></pre><p>Notice that each of these assignments is valid. Even though the observed type of x changed to number after our first assignment, we were still able to assign a string to x. This is because the declared type of x - the type that x started with - is string | number, and assignability is always checked against the declared type.<br><code>æ³¨æ„ï¼Œæ¯ä¸€ä¸ªèµ‹å€¼éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚å³ä½¿ x çš„å‘ç°ç±»å‹æ”¹å˜ä¸º number ä¹‹åï¼Œæˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿç»™ x èµ‹å€¼ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ˜¯å› ä¸º x çš„å£°æ˜ç±»å‹æ˜¯ string | numberï¼Œè€Œèµ‹å€¼æ—¶æ˜¯æ£€æŸ¥èµ‹å€¼ç±»å‹æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™å®ƒã€‚</code><br>If weâ€™d assigned a boolean to x, weâ€™d have seen an error since that wasnâ€™t part of the declared type.</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let x &#x3D; Math.random() &lt; 0.5 ? 10 : &quot;hello world!&quot;;let x: string | number;x &#x3D; 1;console.log(x);let x: number;x &#x3D; true;&#x2F;&#x2F; Type &#39;boolean&#39; is not assignable to type &#39;string | number&#39;.console.log(x);let x: string | number;</code></pre><h2 id="Control-flow-analysis"><a href="#Control-flow-analysis" class="headerlink" title="Control flow analysis"></a>Control flow analysis</h2><p><code>æ§åˆ¶æµåˆ†æ</code></p><p>Up until this point, weâ€™ve gone through some basic examples of how TypeScript narrows within specific branches. But thereâ€™s a bit more going on than just walking up from every variable and looking for type guards in ifs, whiles, conditionals, etc. For example<br><code>åœ¨è¿™ä¸ªç‚¹ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»æ¢ç´¢äº†ä¸€äº›åŸºæœ¬çš„ä¾‹å­ï¼Œå¦‚ä½•æ”¶çª„åœ¨ç‰¹å®šåˆ†æ”¯ä¸­ã€‚ä½†è¿™é‡Œæœ‰ä¸€äº›æ¯”è¾ƒå¤æ‚çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä»æ¯ä¸ªå˜é‡ä¸Šæ¥çœ‹ï¼Œå¦‚æœæœ‰ä¸€ä¸ª if è¯­å¥ï¼Œwhile è¯­å¥ï¼Œæ¡ä»¶è¡¨è¾¾å¼ç­‰ï¼Œéƒ½å¯ä»¥çœ‹åˆ°æ”¶çª„ã€‚ä¾‹å¦‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function padLeft(padding: number | string, input: string) &#123;  if (typeof padding &#x3D;&#x3D;&#x3D; &quot;number&quot;) &#123;    return &quot; &quot;.repeat(padding) + input;  &#125;  return padding + input;&#125;</code></pre><p>padLeft returns from within its first if block. TypeScript was able to analyze this code and see that the rest of the body (return padding + input;) is unreachable in the case where padding is a number. As a result, it was able to remove number from the type of padding (narrowing from string | number to string) for the rest of the function.<br><code>padLeft è¿”å›åœ¨å®ƒçš„ç¬¬ä¸€ä¸ª if å—ä¸­ã€‚TypeScript å¯ä»¥åˆ†æè¿™æ®µä»£ç ï¼Œå¹¶ä¸”å‘ç° rest of the body (return padding + input;) æ˜¯ä¸å¯è¾¾çš„ï¼Œåœ¨ padding æ˜¯ä¸€ä¸ª number çš„æƒ…å†µä¸‹ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥ç§»é™¤ padding çš„å£°æ˜ç±»å‹ï¼ˆæ”¶çª„ä» string | number åˆ° stringï¼‰ï¼Œä»è€Œç§»é™¤äº† padding çš„ç±»å‹ã€‚</code><br>This analysis of code based on reachability is called control flow analysis, and TypeScript uses this flow analysis to narrow types as it encounters type guards and assignments. When a variable is analyzed, control flow can split off and re-merge over and over again, and that variable can be observed to have a different type at each point.<br><code>è¿™æ®µä»£ç åŸºäºå¯è¾¾æ€§çš„åˆ†ææ˜¯æ§åˆ¶æµåˆ†æï¼ŒTypeScript ä½¿ç”¨è¿™ä¸ªåˆ†ææ¥æ”¶çª„ç±»å‹ï¼Œå½“é‡åˆ°ç±»å‹æ£€æŸ¥å’Œèµ‹å€¼æ—¶ã€‚å½“ä¸€ä¸ªå˜é‡è¢«åˆ†ææ—¶ï¼Œæ§åˆ¶æµå¯ä»¥åˆ†è£‚å’Œé‡æ–°åˆå¹¶ï¼Œå¹¶ä¸”è¿™ä¸ªå˜é‡åœ¨æ¯ä¸ªç‚¹éƒ½ä¼šæœ‰ä¸åŒçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function example() &#123;  let x: string | number | boolean;  x &#x3D; Math.random() &lt; 0.5;  console.log(x);  let x: boolean;  if (Math.random() &lt; 0.5) &#123;    x &#x3D; &quot;hello&quot;;    console.log(x);    let x: string;  &#125; else &#123;    x &#x3D; 100;    console.log(x);    let x: number;  &#125;  return x;  let x: string | number;&#125;</code></pre><h2 id="Using-type-predicates"><a href="#Using-type-predicates" class="headerlink" title="Using type predicates"></a>Using type predicates</h2><p><code>ä½¿ç”¨ç±»å‹æ–­è¨€</code></p><p>Weâ€™ve worked with existing JavaScript constructs to handle narrowing so far, however sometimes you want more direct control over how types change throughout your code.<br><code>æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ç°æœ‰çš„ JavaScript å·¥å…·æ¥å¤„ç†æ”¶çª„ï¼Œä½†æœ‰æ—¶å€™ä½ æƒ³æ›´åŠ ç›´æ¥æ§åˆ¶ç±»å‹åœ¨ä½ çš„ä»£ç ä¸­çš„å˜åŒ–ã€‚</code><br>To define a user-defined type guard, we simply need to define a function whose return type is a type predicate:<br><code>å®šä¹‰ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ç±»å‹æ–­è¨€ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºç±»å‹æ–­è¨€çš„å‡½æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function isFish(pet: Fish | Bird): pet is Fish &#123;  return (pet as Fish).swim !&#x3D;&#x3D; undefined;&#125;</code></pre><p>pet is Fish is our type predicate in this example. A predicate takes the form parameterName is Type, where parameterName must be the name of a parameter from the current function signature.<br><code>pet is Fish æ˜¯æˆ‘ä»¬çš„ç±»å‹æ–­è¨€ã€‚ä¸€ä¸ªæ–­è¨€çš„æ ¼å¼æ˜¯ parameterName is Typeï¼Œå…¶ä¸­ parameterName å¿…é¡»æ˜¯å½“å‰å‡½æ•°ç­¾åä¸­çš„ä¸€ä¸ªå‚æ•°åã€‚</code><br>Any time isFish is called with some variable, TypeScript will narrow that variable to that specific type if the original type is compatible.<br><code>ä»»ä½•æ—¶å€™ï¼ŒisFish è¢«è°ƒç”¨ï¼ŒTypeScript å°†ä¼šæ”¶çª„è¿™ä¸ªå˜é‡çš„ç±»å‹ï¼Œå¦‚æœåŸå§‹ç±»å‹æ˜¯å…¼å®¹çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Both calls to &#39;swim&#39; and &#39;fly&#39; are now okay.let pet &#x3D; getSmallPet();if (isFish(pet)) &#123;  pet.swim();&#125; else &#123;  pet.fly();&#125;</code></pre><p>Notice that TypeScript not only knows that pet is a Fish in the if branch; it also knows that in the else branch, you donâ€™t have a Fish, so you must have a Bird.<br><code>TypeScript çŸ¥é“ pet æ˜¯ä¸€ä¸ª Fish åœ¨ if åˆ†æ”¯ï¼›å®ƒä¹ŸçŸ¥é“åœ¨ else åˆ†æ”¯ï¼Œä½ æ²¡æœ‰ä¸€ä¸ª Fishï¼Œæ‰€ä»¥ä½ å¿…é¡»æœ‰ä¸€ä¸ª Birdã€‚</code><br>You may use the type guard isFish to filter an array of Fish | Bird and obtain an array of Fish:<br><code>ä½ å¯ä»¥ä½¿ç”¨ isFish æ¥è¿‡æ»¤ Fish | Bird æ•°ç»„ï¼Œå¹¶è·å¾—ä¸€ä¸ª Fish æ•°ç»„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const zoo: (Fish | Bird)[] &#x3D; [getSmallPet(), getSmallPet(), getSmallPet()];const underWater1: Fish[] &#x3D; zoo.filter(isFish);&#x2F;&#x2F; or, equivalentlyconst underWater2: Fish[] &#x3D; zoo.filter(isFish) as Fish[];&#x2F;&#x2F; The predicate may need repeating for more complex examplesconst underWater3: Fish[] &#x3D; zoo.filter((pet): pet is Fish &#x3D;&gt; &#123;  if (pet.name &#x3D;&#x3D;&#x3D; &quot;sharkey&quot;) return false;  return isFish(pet);&#125;);</code></pre><p>In addition, classes can use this is Type to narrow their type.Weâ€™ve worked with existing JavaScript constructs to handle narrowing so far, however sometimes you want more direct control over how types change throughout your code.<br><code>ç±»å¯ä»¥ä½¿ç”¨ is Type æ¥æ”¶çª„ç±»å‹ã€‚æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ç°æœ‰çš„ JavaScript å·¥å…·æ¥å¤„ç†æ”¶çª„ï¼Œä½†æœ‰æ—¶å€™ä½ æƒ³æ›´åŠ ç›´æ¥æ§åˆ¶ç±»å‹åœ¨ä½ çš„ä»£ç ä¸­çš„å˜åŒ–ã€‚</code><br>To define a user-defined type guard, we simply need to define a function whose return type is a type predicate:<br><code>å®šä¹‰ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ç±»å‹æ–­è¨€ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºç±»å‹æ–­è¨€çš„å‡½æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function isFish(pet: Fish | Bird): pet is Fish &#123;  return (pet as Fish).swim !&#x3D;&#x3D; undefined;&#125;</code></pre><p>pet is Fish is our type predicate in this example. A predicate takes the form parameterName is Type, where parameterName must be the name of a parameter from the current function signature.<br><code>pet is Fish æ˜¯æˆ‘ä»¬çš„ç±»å‹æ–­è¨€ã€‚ä¸€ä¸ªæ–­è¨€çš„æ ¼å¼æ˜¯ parameterName is Typeï¼Œå…¶ä¸­ parameterName å¿…é¡»æ˜¯å½“å‰å‡½æ•°ç­¾åä¸­çš„ä¸€ä¸ªå‚æ•°åã€‚</code><br>Any time isFish is called with some variable, TypeScript will narrow that variable to that specific type if the original type is compatible.<br><code>ä»»ä½•æ—¶å€™ï¼ŒisFish è¢«è°ƒç”¨ï¼ŒTypeScript å°†ä¼šæ”¶çª„è¿™ä¸ªå˜é‡çš„ç±»å‹ï¼Œå¦‚æœåŸå§‹ç±»å‹æ˜¯å…¼å®¹çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Both calls to &#39;swim&#39; and &#39;fly&#39; are now okay.let pet &#x3D; getSmallPet();if (isFish(pet)) &#123;  pet.swim();&#125; else &#123;  pet.fly();&#125;</code></pre><p>Notice that TypeScript not only knows that pet is a Fish in the if branch; it also knows that in the else branch, you donâ€™t have a Fish, so you must have a Bird.<br><code>TypeScript çŸ¥é“ pet æ˜¯ä¸€ä¸ª Fish åœ¨ if åˆ†æ”¯ï¼›å®ƒä¹ŸçŸ¥é“åœ¨ else åˆ†æ”¯ï¼Œä½ æ²¡æœ‰ä¸€ä¸ª Fishï¼Œæ‰€ä»¥ä½ å¿…é¡»æœ‰ä¸€ä¸ª Birdã€‚</code><br>You may use the type guard isFish to filter an array of Fish | Bird and obtain an array of Fish:<br><code>ä½ å¯ä»¥ä½¿ç”¨ isFish æ¥è¿‡æ»¤ Fish | Bird æ•°ç»„ï¼Œå¹¶è·å¾—ä¸€ä¸ª Fish æ•°ç»„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const zoo: (Fish | Bird)[] &#x3D; [getSmallPet(), getSmallPet(), getSmallPet()];const underWater1: Fish[] &#x3D; zoo.filter(isFish);&#x2F;&#x2F; or, equivalentlyconst underWater2: Fish[] &#x3D; zoo.filter(isFish) as Fish[];&#x2F;&#x2F; The predicate may need repeating for more complex examplesconst underWater3: Fish[] &#x3D; zoo.filter((pet): pet is Fish &#x3D;&gt; &#123;  if (pet.name &#x3D;&#x3D;&#x3D; &quot;sharkey&quot;) return false;  return isFish(pet);&#125;);</code></pre><p>In addition, classes can use this is Type to narrow their type.<br><code>é™¤æ­¤ä¹‹å¤–ï¼Œç±»ä¸­å¯ä»¥ä½¿ç”¨this is Typeæ¥ç¼©å‡ç±»å‹ã€‚</code></p><h2 id="Discriminated-unions"><a href="#Discriminated-unions" class="headerlink" title="Discriminated unions"></a>Discriminated unions</h2><p><code>åˆ†åŒºè”åˆ</code></p><p>Most of the examples weâ€™ve looked at so far have focused around narrowing single variables with simple types like string, boolean, and number. While this is common, most of the time in JavaScript weâ€™ll be dealing with slightly more complex structures.<br>For some motivation, letâ€™s imagine weâ€™re trying to encode shapes like circles and squares.<br>Circles keep track of their radiuses and squares keep track of their side lengths. Weâ€™ll use a field called kind to tell which shape weâ€™re dealing with. Hereâ€™s a first attempt at defining Shape.<br><code>è®©æˆ‘ä»¬è¯•æƒ³æœ‰è¿™æ ·ä¸€ä¸ªå¤„ç† Shape ï¼ˆæ¯”å¦‚ Circlesã€Squares ï¼‰çš„å‡½æ•°ï¼ŒCircles ä¼šè®°å½•å®ƒçš„åŠå¾„å±æ€§ï¼ŒSquares ä¼šè®°å½•å®ƒçš„è¾¹é•¿å±æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª kind å­—æ®µæ¥åŒºåˆ†åˆ¤æ–­å¤„ç†çš„æ˜¯ Circles è¿˜æ˜¯ Squaresï¼Œè¿™æ˜¯åˆå§‹çš„ Shape å®šä¹‰ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Shape &#123;  kind: &quot;circle&quot; | &quot;square&quot;;  radius?: number;  sideLength?: number;&#125;</code></pre><p>Notice weâ€™re using a union of string literal types: â€œcircleâ€ and â€œsquareâ€ to tell us whether we should treat the shape as a circle or square respectively. By using â€œcircleâ€ | â€œsquareâ€ instead of string, we can avoid misspelling issues.<br><code>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ç±»å‹çš„è”åˆï¼š&quot;circle&quot; å’Œ &quot;square&quot;ï¼Œæ¥å‘Šè¯‰æˆ‘ä»¬æ˜¯å¤„ç†ä¸€ä¸ªåœ†å½¢è¿˜æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function handleShape(shape: Shape) &#123;  &#x2F;&#x2F; oops!  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;rect&quot;) &#123;    &#x2F;&#x2F; This condition will always return &#39;false&#39; since the types &#39;&quot;circle&quot; | &quot;square&quot;&#39; and &#39;&quot;rect&quot;&#39; have no overlap.    &#x2F;&#x2F; æ­¤æ¡ä»¶å°†æ€»æ˜¯è¿”å› &#39;false&#39;ï¼Œå› ä¸ºç±»å‹ &#39;&quot;circle&quot; | &quot;square&quot;&#39; å’Œ &#39;&quot;rect&quot;&#39; æ²¡æœ‰é‡å ã€‚    &#x2F;&#x2F; ...  &#125;&#125;</code></pre><p>We can write a getArea function that applies the right logic based on if itâ€™s dealing with a circle or square. Weâ€™ll first try dealing with circles.<br><code>æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª getArea å‡½æ•°ï¼Œç”¨æ¥å¤„ç†åœ†å½¢ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getArea(shape: Shape) &#123;  return Math.PI * shape.radius ** 2;  &#x2F;&#x2F; Object is possibly &#39;undefined&#39;.&#125;</code></pre><p>Under strictNullChecks that gives us an error - which is appropriate since radius might not be defined. But what if we perform the appropriate checks on the kind property?<br><code>åœ¨ä¸¥æ ¼çš„ null æ£€æŸ¥ä¸‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ - å› ä¸º radius å¯èƒ½ä¸å­˜åœ¨ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¯¹ kind å±æ€§è¿›è¡Œæ­£ç¡®çš„æ£€æŸ¥ï¼Œå°±ä¸ä¼šå‡ºç°é”™è¯¯ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getArea(shape: Shape) &#123;  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;    return Math.PI * shape.radius ** 2;    &#x2F;&#x2F; Object is possibly &#39;undefined&#39;.  &#125;&#125;</code></pre><p>Hmm, TypeScript still doesnâ€™t know what to do here. Weâ€™ve hit a point where we know more about our values than the type checker does. We could try to use a non-null assertion (a ! after shape.radius) to say that radius is definitely present.<br><code>å“‡ï¼ŒTypeScript è¿˜ä¸çŸ¥é“æ€ä¹ˆåŠã€‚æˆ‘ä»¬å·²ç»ç¢°åˆ°äº†ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“æ›´å¤šçš„ä¿¡æ¯äº†ï¼Œæ¯”ç±»å‹æ£€æŸ¥å™¨æ›´å¤šã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ä¸€ä¸ªéç©ºæ–­è¨€ï¼ˆshape.radius åé¢åŠ ä¸€ä¸ª !ï¼‰æ¥å‘Šè¯‰ TypeScript radius æ˜¯ä¸€å®šå­˜åœ¨çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getArea(shape: Shape) &#123;  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;    return Math.PI * shape.radius! ** 2;  &#125;&#125;</code></pre><p>But this doesnâ€™t feel ideal. We had to shout a bit at the type-checker with those non-null assertions (!) to convince it that shape.radius was defined, but those assertions are error-prone if we start to move code around. Additionally, outside of strictNullChecks weâ€™re able to accidentally access any of those fields anyway (since optional properties are just assumed to always be present when reading them). We can definitely do better.<br><code>ä½†è¿™ä¸å¤ªå¥½ã€‚æˆ‘ä»¬å¿…é¡»å‘ç±»å‹æ£€æŸ¥å™¨å‘å‡ºä¸€äº›éç©ºæ–­è¨€ï¼ˆ!ï¼‰æ¥å‘Šè¯‰å®ƒ shape.radius å­˜åœ¨ï¼Œä½†è¿™äº›æ–­è¨€æ˜¯é”™è¯¯çš„ï¼Œå¦‚æœæˆ‘ä»¬å¼€å§‹ç§»åŠ¨ä»£ç ã€‚åŒæ—¶ï¼Œåœ¨éä¸¥æ ¼çš„ null æ£€æŸ¥ä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥éšæ„è®¿é—®è¿™äº›å­—æ®µï¼ˆå› ä¸ºå¯é€‰å±æ€§æ˜¯è¢«å‡å®šä¸ºæ€»æ˜¯å­˜åœ¨çš„ï¼Œå½“è¯»å–å®ƒä»¬æ—¶ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°åšã€‚</code><br>The problem with this encoding of Shape is that the type-checker doesnâ€™t have any way to know whether or not radius or sideLength are present based on the kind property. We need to communicate what we know to the type checker. With that in mind, letâ€™s take another swing at defining Shape.<br><code>è¿™ä¸ª Shape çš„ç¼–ç æœ‰ç‚¹é—®é¢˜ï¼Œå› ä¸ºç±»å‹æ£€æŸ¥å™¨æ²¡æœ‰ä»»ä½•æ–¹å¼å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ radius æˆ– sideLength å­˜åœ¨ã€‚æˆ‘ä»¬éœ€è¦å‘ç±»å‹æ£€æŸ¥å™¨é€šæŠ¥æˆ‘ä»¬çŸ¥é“çš„ä¿¡æ¯ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Circle &#123;  kind: &quot;circle&quot;;  radius: number;&#125;interface Square &#123;  kind: &quot;square&quot;;  sideLength: number;&#125;type Shape &#x3D; Circle | Square;</code></pre><p>Here, weâ€™ve properly separated Shape out into two types with different values for the kind property, but radius and sideLength are declared as required properties in their respective types.<br><code>è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å°† Shape åˆ†æˆäº†ä¸¤ç§ç±»å‹ï¼Œå…¶ä¸­ kind å±æ€§çš„å€¼ä¸åŒï¼Œradius å’Œ sideLength åœ¨å®ƒä»¬çš„ç±»å‹ä¸­å£°æ˜ä¸ºå¿…é¡»çš„å±æ€§ã€‚</code><br>Letâ€™s see what happens here when we try to access the radius of a Shape.<br><code>æˆ‘ä»¬çœ‹çœ‹è¿™é‡Œå¦‚ä½•è®¿é—® Shape çš„ radiusã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getArea(shape: Shape) &#123;  return Math.PI * shape.radius ** 2;  &#x2F;&#x2F; Property &#39;radius&#39; does not exist on type &#39;Shape&#39;.  &#x2F;&#x2F; Property &#39;radius&#39; does not exist on type &#39;Square&#39;.&#125;</code></pre><p>Like with our first definition of Shape, this is still an error. When radius was optional, we got an error (with strictNullChecks enabled) because TypeScript couldnâ€™t tell whether the property was present. Now that Shape is a union, TypeScript is telling us that shape might be a Square, and Squares donâ€™t have radius defined on them! Both interpretations are correct, but only the union encoding of Shape will cause an error regardless of how strictNullChecks is configured.<br><code>ä¸æˆ‘ä»¬ç¬¬ä¸€æ¬¡å®šä¹‰ Shape çš„ä¾‹å­ç›¸åŒï¼Œè¿™è¿˜æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚å½“ radius æ˜¯å¯é€‰çš„æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼ˆä¸ strictNullChecks å¯ç”¨æ—¶ï¼‰ï¼Œå› ä¸º TypeScript ä¸èƒ½å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå±æ€§æ˜¯å¦å­˜åœ¨ã€‚</code><br>But what if we tried checking the kind property again?<br><code>å¦‚æœæˆ‘ä»¬å†æ¬¡æ£€æŸ¥ kind å±æ€§ï¼Ÿ</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getArea(shape: Shape) &#123;  if (shape.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;    return Math.PI * shape.radius ** 2;    &#x2F;&#x2F; (parameter) shape: Circle  &#125;&#125;</code></pre><p>That got rid of the error! When every type in a union contains a common property with literal types, TypeScript considers that to be a discriminated union, and can narrow out the members of the union.<br><code>è¿™æ¶ˆé™¤äº†é”™è¯¯ï¼å½“ä¸€ä¸ªè”åˆé‡Œçš„æ¯ä¸ªç±»å‹éƒ½åŒ…å«å¸¸é‡ç±»å‹çš„å…±åŒå±æ€§ï¼ŒTypeScript è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ†åŒºè”åˆï¼Œå¯ä»¥ç¼©å°è”åˆçš„æˆå‘˜ã€‚</code><br>In this case, kind was that common property (which is whatâ€™s considered a discriminant property of Shape). Checking whether the kind property was â€œcircleâ€ got rid of every type in Shape that didnâ€™t have a kind property with the type â€œcircleâ€. That narrowed shape down to the type Circle.<br><code>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œkind å±æ€§æ˜¯é‚£ä¸ªè¢«è®¤ä¸ºæ˜¯ Shape çš„åˆ†åŒºå±æ€§ï¼ˆè¿™æ˜¯è¢«è®¤ä¸ºæ˜¯ Shape çš„åˆ†åŒºå±æ€§ï¼‰ã€‚æ£€æŸ¥ kind å±æ€§æ˜¯å¦æ˜¯ &quot;circle&quot; å¯ä»¥æ¶ˆé™¤æ‰æ²¡æœ‰ kind å±æ€§çš„ç±»å‹ã€‚è¿™ç¼©å°äº† shape åˆ° Circle ç±»å‹ã€‚</code><br>The same checking works with switch statements as well. Now we can try to write our complete getArea without any pesky ! non-null assertions.<br><code>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å†™æˆ‘ä»¬çš„å®Œæ•´ getArea æ²¡æœ‰ä»»ä½•éç©ºæ–­è¨€ï¼</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getArea(shape: Shape) &#123;  switch (shape.kind) &#123;    case &quot;circle&quot;:      return Math.PI * shape.radius ** 2;    &#x2F;&#x2F; (parameter) shape: Circle    case &quot;square&quot;:      return shape.sideLength ** 2;    &#x2F;&#x2F; (parameter) shape: Square  &#125;&#125;</code></pre><p>The important thing here was the encoding of Shape. Communicating the right information to TypeScript - that Circle and Square were really two separate types with specific kind fields - was crucial. Doing that let us write type-safe TypeScript code that looks no different than the JavaScript we wouldâ€™ve written otherwise. From there, the type system was able to do the â€œrightâ€ thing and figure out the types in each branch of our switch statement.<br><code>è¿™é‡Œæœ‰é‡è¦çš„äº‹æƒ…ï¼Œéœ€è¦é€šè¿‡ç¼–ç  Shape æ¥å‘Šè¯‰ TypeScriptï¼ŒCircle å’Œ Square æ˜¯çœŸæ­£çš„ä¸¤ä¸ªç±»å‹ï¼Œå…·æœ‰ç‰¹å®šçš„ kind å±æ€§ã€‚è¿™æ ·å°±å¯ä»¥å†™å‡ºç±»å‹å®‰å…¨çš„ TypeScript ä»£ç ï¼Œçœ‹èµ·æ¥å’Œ JavaScript ä¸€æ ·ã€‚</code><br>As an aside, try playing around with the above example and remove some of the return keywords. Youâ€™ll see that type-checking can help avoid bugs when accidentally falling through different clauses in a switch statement.<br><code>ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œè¯•ç€ç©ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¹¶åˆ é™¤ä¸€äº› return å…³é”®å­—ã€‚ä½ ä¼šå‘ç°ï¼Œç±»å‹æ£€æŸ¥å¯ä»¥å¸®åŠ©é¿å…åœ¨æ„å¤–çš„æƒ…å†µä¸‹è·³è¿‡ä¸åŒçš„åˆ†æ”¯ã€‚</code><br>Discriminated unions are useful for more than just talking about circles and squares. Theyâ€™re good for representing any sort of messaging scheme in JavaScript, like when sending messages over the network (client&#x2F;server communication), or encoding mutations in a state management framework.<br><code>åˆ†åŒºè”åˆæ˜¯ç”¨æ¥è¡¨ç¤ºä»»ä½•ç±»å‹çš„æ¶ˆæ¯åè®®ï¼Œæ¯”å¦‚åœ¨ç½‘ç»œä¸Šå‘é€æ¶ˆæ¯ï¼ˆå®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡ï¼‰ï¼Œæˆ–è€…ç¼–ç çŠ¶æ€ç®¡ç†æ¡†æ¶çš„å˜åŒ–ã€‚</code></p><h2 id="The-never-type"><a href="#The-never-type" class="headerlink" title="The never type"></a>The never type</h2><p><code>neverç±»å‹</code></p><p>When narrowing, you can reduce the options of a union to a point where you have removed all possibilities and have nothing left. In those cases, TypeScript will use a never type to represent a state which shouldnâ€™t exist.<br><code>åœ¨ç¼©å°è”åˆçš„æ—¶å€™ï¼Œä½ å¯ä»¥å°†è”åˆçš„å¯èƒ½æ€§é™ä½åˆ°æ²¡æœ‰ä»»ä½•å¯èƒ½æ€§çš„çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScript ä¼šä½¿ç”¨ never ç±»å‹æ¥è¡¨ç¤ºä¸åº”è¯¥å­˜åœ¨çš„çŠ¶æ€ã€‚</code></p><h2 id="Exhaustiveness-checking"><a href="#Exhaustiveness-checking" class="headerlink" title="Exhaustiveness checking"></a>Exhaustiveness checking</h2><p><code>æ¨æ–­æ€§æ£€æŸ¥</code></p><p>The never type is assignable to every type; however, no type is assignable to never (except never itself). This means you can use narrowing and rely on never turning up to do exhaustive checking in a switch statement.<br><code>neverç±»å‹å¯ä»¥èµ‹å€¼ç»™æ‰€æœ‰ç±»å‹ï¼Œä½†æ˜¯ä¸å¯ä»¥èµ‹å€¼ç»™ neverï¼ˆé™¤äº† never æœ¬èº«ï¼‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ç¼©å°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ switch è¯­å¥ä¸­ä½¿ç”¨æ¨æ–­æ€§æ£€æŸ¥ã€‚</code><br>For example, adding a default to our getArea function which tries to assign the shape to never will raise when every possible case has not been handled.<br><code>æ·»åŠ ä¸€ä¸ªé»˜è®¤åˆ° getArea å‡½æ•°ä¸­ï¼Œè¿™æ ·å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºæ²¡æœ‰å¤„ç†æ‰€æœ‰å¯èƒ½æ€§ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Shape &#x3D; Circle | Square;function getArea(shape: Shape) &#123;  switch (shape.kind) &#123;    case &quot;circle&quot;:      return Math.PI * shape.radius ** 2;    case &quot;square&quot;:      return shape.sideLength ** 2;    default:      const _exhaustiveCheck: never &#x3D; shape;      return _exhaustiveCheck;  &#125;&#125;</code></pre><p>Adding a new member to the Shape union, will cause a TypeScript error:<br><code>æ·»åŠ ä¸€ä¸ªæ–°çš„æˆå‘˜åˆ° Shape è”åˆï¼Œä¼šå¯¼è‡´ä¸€ä¸ª TypeScript é”™è¯¯ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Triangle &#123;  kind: &quot;triangle&quot;;  sideLength: number;&#125;type Shape &#x3D; Circle | Square | Triangle;function getArea(shape: Shape) &#123;  switch (shape.kind) &#123;    case &quot;circle&quot;:      return Math.PI * shape.radius ** 2;    case &quot;square&quot;:      return shape.sideLength ** 2;    default:      const _exhaustiveCheck: never &#x3D; shape;      &#x2F;&#x2F; Type &#39;Triangle&#39; is not assignable to type &#39;never&#39;.      &#x2F;&#x2F; ç±»å‹ &#39;Triangle&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;never&#39;ã€‚      return _exhaustiveCheck;  &#125;&#125;</code></pre><p>å› ä¸º TypeScript çš„æ”¶çª„ç‰¹æ€§ï¼Œæ‰§è¡Œåˆ° default çš„æ—¶å€™ï¼Œç±»å‹è¢«æ”¶çª„ä¸º Triangleï¼Œä½†å› ä¸ºä»»ä½•ç±»å‹éƒ½ä¸èƒ½èµ‹å€¼ç»™ never ç±»å‹ï¼Œè¿™å°±ä¼šäº§ç”Ÿä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å°±å¯ä»¥ç¡®ä¿ getArea å‡½æ•°æ€»æ˜¯ç©·å°½äº†æ‰€æœ‰ shape çš„å¯èƒ½æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>3.Typescript å¸¸è§ç±»å‹</title>
      <link href="//post/2022-06-08ts-Everyday%20Types.html"/>
      <url>//post/2022-06-08ts-Everyday%20Types.html</url>
      
        <content type="html"><![CDATA[<h2 id="Everyday-Types"><a href="#Everyday-Types" class="headerlink" title="Everyday Types"></a>Everyday Types</h2><p><code>å¸¸è§ç±»å‹</code><br>In this chapter, weâ€™ll cover some of the most common types of values youâ€™ll find in JavaScript code, and explain the corresponding ways to describe those types in TypeScript. This isnâ€™t an exhaustive list, and future chapters will describe more ways to name and use other types.<br><code>åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€äº› JavaScript ä»£ç ä¸­çš„å¸¸è§ç±»å‹ï¼Œå¹¶åœ¨ TypeScript ä¸­è¯´æ˜è¿™äº›ç±»å‹çš„ç›¸åº”æ–¹å¼ã€‚è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œè€Œä¸”æœªæ¥çš„ç« èŠ‚å°†è¯´æ˜æ›´å¤šçš„æ–¹æ³•æ¥å‘½åå’Œä½¿ç”¨å…¶ä»–ç±»å‹ã€‚</code><br>Types can also appear in many more places than just type annotations. As we learn about the types themselves, weâ€™ll also learn about the places where we can refer to these types to form new constructs.<br><code>ç±»å‹ä¹Ÿå¯ä»¥å‡ºç°åœ¨ç±»å‹æ³¨é‡Šä¹‹å¤–ã€‚æˆ‘ä»¬å­¦ä¹ ç±»å‹æœ¬èº«æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå­¦ä¹ åˆ°å“ªäº›åœ°æ–¹å¯ä»¥å¼•ç”¨è¿™äº›ç±»å‹æ¥å½¢æˆæ–°çš„æ„é€ ã€‚</code><br>Weâ€™ll start by reviewing the most basic and common types you might encounter when writing JavaScript or TypeScript code. These will later form the core building blocks of more complex types.<br><code>æˆ‘ä»¬å°†å¼€å§‹ä»‹ç»æœ€åŸºæœ¬çš„ JavaScript æˆ– TypeScript ä»£ç ä¸­å¯èƒ½é‡åˆ°çš„å¸¸è§ç±»å‹ã€‚è¿™äº›ç±»å‹å°†ä½œä¸ºæ›´å¤æ‚çš„ç±»å‹çš„åŸºç¡€å»ºç­‘å—ã€‚</code></p><h2 id="The-primitives-string-number-and-boolean"><a href="#The-primitives-string-number-and-boolean" class="headerlink" title="The primitives: string,number, and boolean"></a>The primitives: string,number, and boolean</h2><p>JavaScript has three very commonly used primitives: string, number, and boolean. Each has a corresponding type in TypeScript. As you might expect, these are the same names youâ€™d see if you used the JavaScript typeof operator on a value of those types:<br><code>JavaScript æœ‰ä¸‰ä¸ªéå¸¸å¸¸è§çš„åŸå§‹ç±»å‹ï¼šå­—ç¬¦ä¸²ï¼Œæ•°å­—å’Œå¸ƒå°”å€¼ã€‚è¿™ä¸‰ä¸ªç±»å‹åœ¨ TypeScript ä¸­å¯¹åº”ã€‚å¦‚æœä½ å¯ä»¥æ¥å—ï¼Œè¿™ä¸‰ä¸ªç±»å‹çš„åå­—éƒ½æ˜¯ç›¸åŒçš„ï¼š</code></p><ul><li>string represents string values like â€œHello, worldâ€<br><code>string è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ &quot;Hello, world&quot;</code></li><li>number is for numbers like 42. JavaScript does not have a special runtime value for integers, so thereâ€™s no equivalent to int or float - everything is simply number<br><code>number æ˜¯æ•°å­—ï¼Œæ¯”å¦‚ 42ã€‚JavaScript ä¸æ”¯æŒæ•´æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰ç›¸åº”çš„ int æˆ– float - æ‰€æœ‰éƒ½æ˜¯ number</code></li><li>boolean is for the two values true and false<br><code>boolean æ˜¯å¸ƒå°”å€¼ï¼Œæ¯”å¦‚ true å’Œ false</code></li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p><p>The type names String, Number, and Boolean (starting with capital letters) are legal, but refer to some special built-in types that will very rarely appear in your code. Always use string, number, or boolean for types.<br><code>ç±»å‹å String ï¼ŒNumber å’Œ Boolean ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ä¹Ÿæ˜¯åˆæ³•çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸€äº›éå¸¸å°‘è§çš„ç‰¹æ®Šå†…ç½®ç±»å‹ã€‚æ‰€ä»¥ç±»å‹æ€»æ˜¯ä½¿ç”¨ string ï¼Œnumber æˆ–è€… boolean ã€‚</code></p></div><h2 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h2><p><code>æ•°ç»„</code><br>To specify the type of an array like [1, 2, 3], you can use the syntax number[]; this syntax works for any type (e.g. string[] is an array of strings, and so on). You may also see this written as Array<number>, which means the same thing. Weâ€™ll learn more about the syntax T<U> when we cover generics.<br><code>æŒ‡å®šæ•°ç»„çš„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ number[] çš„è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯ä»¥ç”¨äºä»»ä½•ç±»å‹ï¼ˆæ¯”å¦‚ string[] æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè€Œ so onï¼‰ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™ç§å†™æ³• Array&lt;number&gt;ï¼Œå®ƒè¡¨ç¤ºç›¸åŒçš„æ„æ€ã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­å­¦ä¹ æ›´å¤šå…³äºè¯­æ³• T&lt;U&gt; çš„è¯¦ç»†ä¿¡æ¯ã€‚</code><br>:::warning<br>Note that [number] is a different thing; refer to the section on Tuples.<br><code>[number] ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œè¯·å‚è§å…³äºå…ƒç»„çš„ç« èŠ‚ã€‚</code><br>:::</p><h2 id="any"><a href="#any" class="headerlink" title="any"></a>any</h2><p>TypeScript also has a special type, any, that you can use whenever you donâ€™t want a particular value to cause typechecking errors.<br><code>TypeScript ä¹Ÿæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ anyï¼Œå¯ä»¥ç”¨äºæŒ‡å®šä½ ä¸æƒ³è¦æŸä¸ªå€¼å¯¼è‡´ç±»å‹æ£€æŸ¥é”™è¯¯çš„æƒ…å†µã€‚</code><br>When a value is of type any, you can access any properties of it (which will in turn be of type any), call it like a function, assign it to (or from) a value of any type, or pretty much anything else thatâ€™s syntactically legal:<br><code>å½“å€¼æ˜¯ any ç±»å‹æ—¶ï¼Œä½ å¯ä»¥è®¿é—®å®ƒçš„ä»»ä½•å±æ€§ï¼ˆè¿™å°†å¯¼è‡´å®ƒçš„ç±»å‹ä¸º any ï¼‰ï¼Œè°ƒç”¨å®ƒï¼Œå°†å®ƒèµ‹å€¼ç»™ï¼ˆæˆ–ä»ï¼‰ä»»ä½•ç±»å‹çš„å€¼ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•åˆæ³•çš„è¯­æ³•ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let obj: any &#x3D; &#123; x: 0 &#125;;&#x2F;&#x2F; None of the following lines of code will throw compiler errors.&#x2F;&#x2F; ä»¥ä¸‹ä»£ç è¡Œéƒ½ä¸ä¼šå¼•å‘ç¼–è¯‘å™¨é”™è¯¯ã€‚&#x2F;&#x2F; Using &#96;any&#96; disables all further type checking, and it is assumed&#x2F;&#x2F; ä½¿ç”¨â€œanyâ€å°†ç¦ç”¨æ‰€æœ‰è¿›ä¸€æ­¥çš„ç±»å‹æ£€æŸ¥ï¼Œå¹¶ä¸”å‡å®š&#x2F;&#x2F; you know the environment better than TypeScript.&#x2F;&#x2F; ä½ çŸ¥é“ç¯å¢ƒä¼˜äºTypeScriptã€‚obj.foo();obj();obj.bar &#x3D; 100;obj &#x3D; &quot;hello&quot;;const n: number &#x3D; obj;</code></pre><p>The any type is useful when you donâ€™t want to write out a long type just to convince TypeScript that a particular line of code is okay.<br><code>any ç±»å‹æ˜¯ç”¨äºæŒ‡å®šä½ ä¸æƒ³è¦å†™å‡ºä¸€ä¸ªé•¿çš„ç±»å‹æ¥è¯´æ˜ TypeScript å¯¹æŸä¸€è¡Œä»£ç æ˜¯åˆæ³•çš„ã€‚</code></p><h2 id="noImplicitAny"><a href="#noImplicitAny" class="headerlink" title="noImplicitAny"></a>noImplicitAny</h2><p>When you donâ€™t specify a type, and TypeScript canâ€™t infer it from context, the compiler will typically default to any.<br><code>å½“ä½ ä¸æŒ‡å®šç±»å‹ï¼Œå¹¶ä¸” TypeScript ä¸èƒ½ä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡ºæ¥æ—¶ï¼Œç¼–è¯‘å™¨é»˜è®¤ä½¿ç”¨ anyã€‚</code><br>You usually want to avoid this, though, because any isnâ€™t type-checked. Use the compiler flag noImplicitAny to flag any implicit any as an error.<br><code>ä½ é€šå¸¸æƒ³é¿å…è¿™ç§æƒ…å†µï¼Œä½†æ˜¯ any ä¸ä¼šè¢«ç±»å‹æ£€æŸ¥ã€‚ä½¿ç”¨ç¼–è¯‘å™¨æ ‡è®° noImplicitAny æ¥æ ‡è®° any ä¸ºé”™è¯¯ã€‚</code></p><h2 id="Type-Annotations-on-Variables"><a href="#Type-Annotations-on-Variables" class="headerlink" title="Type Annotations on Variables"></a>Type Annotations on Variables</h2><p><code>å˜é‡ä¸Šçš„ç±»å‹æ³¨è§£</code></p><p>When you declare a variable using const, var, or let, you can optionally add a type annotation to explicitly specify the type of the variable:<br><code>ä½¿ç”¨ const ï¼Œvar æˆ– let å£°æ˜å˜é‡æ—¶ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªç±»å‹æ³¨è§£æ¥æ˜¾å¼æŒ‡å®šå˜é‡çš„ç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let myName: string &#x3D; &quot;Alice&quot;;</code></pre><p>TypeScript doesnâ€™t use â€œtypes on the leftâ€-style declarations like int x &#x3D; 0; Type annotations will always go after the thing being typed.<br><code>TypeScript ä¸ä½¿ç”¨â€œå·¦è¾¹çš„ç±»å‹â€çš„å£°æ˜æ–¹å¼ï¼Œå¦‚ int x = 0; ç±»å‹æ³¨è§£å°†æ€»æ˜¯åœ¨è¢«ç±»å‹çš„ä¸œè¥¿åé¢ã€‚</code><br>In most cases, though, this isnâ€™t needed. Wherever possible, TypeScript tries to automatically infer the types in your code. For example, the type of a variable is inferred based on the type of its initializer:<br><code>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸éœ€è¦è¿™æ ·åšã€‚åœ¨æ¯ä¸ªå˜é‡çš„åˆå§‹å€¼çš„ç±»å‹å¯ä»¥è¢«è‡ªåŠ¨æ¨æ–­å‡ºæ¥ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; No type annotation needed -- &#39;myName&#39; inferred as type &#39;string&#39;&#x2F;&#x2F; æ²¡æœ‰ç±»å‹æ³¨è§£éœ€è¦ -- &#39;myName&#39; ç±»å‹è¢«æ¨æ–­ä¸º &#39;string&#39;let myName &#x3D; &quot;Alice&quot;;</code></pre><p>For the most part you donâ€™t need to explicitly learn the rules of inference. If youâ€™re starting out, try using fewer type annotations than you think - you might be surprised how few you need for TypeScript to fully understand whatâ€™s going on.<br><code>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šç±»å‹æ³¨è§£ã€‚å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œå°è¯•ä½¿ç”¨æ¯”ä½ è®¤ä¸ºæ›´å°‘çš„ç±»å‹æ³¨è§£ï¼Œä½ å¯èƒ½ä¼šæ„å¤–åœ°å‘ç° TypeScript å¯ä»¥å®Œå…¨ç†è§£ä½ çš„ä»£ç ã€‚</code></p><h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><p><code>å‡½æ•°</code></p><p>Functions are the primary means of passing data around in JavaScript. TypeScript allows you to specify the types of both the input and output values of functions.<br><code>å‡½æ•°æ˜¯ JavaScript ä¸­ä¼ é€’æ•°æ®çš„ä¸»è¦æ–¹å¼ã€‚TypeScript å…è®¸ä½ æŒ‡å®šå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå€¼çš„ç±»å‹ã€‚</code></p><h2 id="Parameter-Type-Annotations"><a href="#Parameter-Type-Annotations" class="headerlink" title="Parameter Type Annotations"></a>Parameter Type Annotations</h2><p><code>å‚æ•°ä¸Šçš„ç±»å‹æ³¨è§£</code></p><p>When you declare a function, you can add type annotations after each parameter to declare what types of parameters the function accepts. Parameter type annotations go after the parameter name:<br><code>å£°æ˜å‡½æ•°æ—¶ï¼Œå¯ä»¥åœ¨æ¯ä¸ªå‚æ•°åé¢æ·»åŠ ç±»å‹æ³¨è§£æ¥å£°æ˜å‡½æ•°æ¥å—å“ªäº›ç±»å‹çš„å‚æ•°ã€‚å‚æ•°ç±»å‹æ³¨è§£åœ¨å‚æ•°ååé¢ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Parameter type annotationfunction greet(name: string) &#123;  console.log(&quot;Hello, &quot; + name.toUpperCase() + &quot;!!&quot;);&#125;</code></pre><p>When a parameter has a type annotation, arguments to that function will be checked:<br><code>å½“å‚æ•°æœ‰ç±»å‹æ³¨è§£æ—¶ï¼Œå‡½æ•°çš„å‚æ•°ä¼šè¢«æ£€æŸ¥ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Would be a runtime error if executed!&#x2F;&#x2F; å¦‚æœæ‰§è¡Œï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ï¼greet(42);&#x2F;&#x2F; Argument of type &#39;number&#39; is not assignable to parameter of type &#39;string&#39;.&#x2F;&#x2F; å‚æ•°ç±»å‹ &#39;number&#39; ä¸èƒ½èµ‹å€¼ç»™å‚æ•°ç±»å‹ &#39;string&#39;ã€‚</code></pre><p>Even if you donâ€™t have type annotations on your parameters, TypeScript will still check that you passed the right number of arguments.<br><code>å³ä½¿ä½ æ²¡æœ‰ç±»å‹æ³¨è§£ï¼ŒTypeScript ä¹Ÿä¼šæ£€æŸ¥ä½ ä¼ å…¥çš„å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚</code></p><h2 id="Return-Type-Annotations"><a href="#Return-Type-Annotations" class="headerlink" title="Return Type Annotations"></a>Return Type Annotations</h2><p><code>è¿”å›å€¼ä¸Šçš„ç±»å‹æ³¨è§£</code></p><p>You can also add return type annotations. Return type annotations appear after the parameter list:<br><code>ä½ ä¹Ÿå¯ä»¥æ·»åŠ è¿”å›å€¼ç±»å‹æ³¨è§£ã€‚è¿”å›å€¼ç±»å‹æ³¨è§£å‡ºç°åœ¨å‚æ•°åˆ—è¡¨åé¢ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getFavoriteNumber(): number &#123;  return 26;&#125;</code></pre><p>Much like variable type annotations, you usually donâ€™t need a return type annotation because TypeScript will infer the functionâ€™s return type based on its return statements. The type annotation in the above example doesnâ€™t change anything. Some codebases will explicitly specify a return type for documentation purposes, to prevent accidental changes, or just for personal preference.<br><code>å’Œå˜é‡ç±»å‹æ³¨è§£ä¸€æ ·ï¼Œä½ é€šå¸¸ä¸éœ€è¦è¿”å›å€¼ç±»å‹æ³¨è§£ï¼Œå› ä¸º TypeScript å°†åŸºäºè¿”å›è¯­å¥çš„ç±»å‹æ¨æ–­å‡ºæ¥ã€‚ä¸Šé¢çš„ç¤ºä¾‹ç¤ºä¾‹ä¸ä¼šæ”¹å˜ä»»ä½•ä¸œè¥¿ã€‚ä¸€äº›ä»£ç åº“å°†æ˜¾å¼æŒ‡å®šä¸€ä¸ªè¿”å›å€¼ç±»å‹ï¼Œä»¥é˜²æ­¢æ„å¤–çš„æ”¹å˜ï¼Œæˆ–è€…åªæ˜¯ä¸ºäº†ä¸ªäººåå¥½ã€‚</code></p><h2 id="Anonymous-Functions"><a href="#Anonymous-Functions" class="headerlink" title="Anonymous Functions"></a>Anonymous Functions</h2><p><code>åŒ¿åå‡½æ•°</code></p><p>Anonymous functions are a little bit different from function declarations. When a function appears in a place where TypeScript can determine how itâ€™s going to be called, the parameters of that function are automatically given types.<br><code>åŒ¿åå‡½æ•°å’Œå‡½æ•°å£°æ˜ä¸€æ ·ã€‚å½“å‡½æ•°å‡ºç°åœ¨ TypeScript å¯ä»¥ç¡®å®šå®ƒä¼šå¦‚ä½•è¢«è°ƒç”¨æ—¶ï¼Œå‡½æ•°çš„å‚æ•°ä¼šè¢«è‡ªåŠ¨æŒ‡å®šç±»å‹ã€‚</code><br>Hereâ€™s an example:<br><code>è¿™é‡Œæœ‰ä¸€ä¸ªç¤ºä¾‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; No type annotations here, but TypeScript can spot the bug&#x2F;&#x2F; æ²¡æœ‰ç±»å‹æ³¨è§£ï¼Œä½† TypeScript å¯ä»¥æ£€æµ‹åˆ°é”™è¯¯const names &#x3D; [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Eve&quot;];&#x2F;&#x2F; Contextual typing for function&#x2F;&#x2F; å‡½æ•°ä¸Šä¸‹æ–‡ç±»å‹names.forEach(function (s) &#123;  console.log(s.toUppercase());  &#x2F;&#x2F; Property &#39;toUppercase&#39; does not exist on type &#39;string&#39;. Did you mean &#39;toUpperCase&#39;?  &#x2F;&#x2F; å±æ€§ &#39;toUppercase&#39; ä¸å­˜åœ¨äºç±»å‹ &#39;string&#39; ä¸­ã€‚ä½ å¯èƒ½æƒ³ç”¨ &#39;toUpperCase&#39; å—ï¼Ÿ&#125;);&#x2F;&#x2F; Contextual typing also applies to arrow functions&#x2F;&#x2F; ç®­å¤´å‡½æ•°ä¸Šä¸‹æ–‡ç±»å‹names.forEach((s) &#x3D;&gt; &#123;  console.log(s.toUppercase());  &#x2F;&#x2F; Property &#39;toUppercase&#39; does not exist on type &#39;string&#39;. Did you mean &#39;toUpperCase&#39;?  &#x2F;&#x2F; å±æ€§ &#39;toUppercase&#39; ä¸å­˜åœ¨äºç±»å‹ &#39;string&#39; ä¸­ã€‚ä½ å¯èƒ½æƒ³ç”¨ &#39;toUpperCase&#39; å—ï¼Ÿ&#125;);</code></pre><p>Even though the parameter s didnâ€™t have a type annotation, TypeScript used the types of the forEach function, along with the inferred type of the array, to determine the type s will have.<br><code>å³ä½¿å‚æ•° s æ²¡æœ‰ç±»å‹æ³¨è§£ï¼ŒTypeScript ä¼šä½¿ç”¨ forEach å‡½æ•°çš„ç±»å‹ï¼Œä»¥åŠæ¨æ–­çš„æ•°ç»„ç±»å‹ï¼Œæ¥ç¡®å®š s çš„ç±»å‹ã€‚</code><br>This process is called contextual typing because the context that the function occurred within informs what type it should have.<br><code>è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸Šä¸‹æ–‡ç±»å‹çš„ï¼Œå› ä¸ºå‡½æ•°å‘ç”Ÿåœ¨å“ªé‡Œçš„ä¸Šä¸‹æ–‡ï¼Œå°±ä¼šç¡®å®šå®ƒåº”è¯¥æœ‰å“ªç§ç±»å‹ã€‚</code><br>Similar to the inference rules, you donâ€™t need to explicitly learn how this happens, but understanding that it does happen can help you notice when type annotations arenâ€™t needed. Later, weâ€™ll see more examples of how the context that a value occurs in can affect its type.<br><code>ä¸æ¨æ–­è§„åˆ™ç›¸ä¼¼ï¼Œä½ ä¸éœ€è¦æ˜¾å¼å­¦ä¹ è¿™ç§è¿‡ç¨‹ï¼Œä½†æ˜¯äº†è§£è¿™ç§è¿‡ç¨‹å¯ä»¥å¸®åŠ©ä½ å‘ç°ï¼Œå½“å€¼ä¸éœ€è¦ç±»å‹æ³¨è§£æ—¶ï¼Œå®ƒä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¹‹åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æ›´å¤šçš„ä¾‹å­ï¼Œå¦‚ä½•å€¼çš„ä¸Šä¸‹æ–‡å¯ä»¥å½±å“å®ƒçš„ç±»å‹ã€‚</code></p><h2 id="Object-Types"><a href="#Object-Types" class="headerlink" title="Object Types"></a>Object Types</h2><p><code>å¯¹è±¡ç±»å‹</code></p><p>Apart from primitives, the most common sort of type youâ€™ll encounter is an object type. This refers to any JavaScript value with properties, which is almost all of them! To define an object type, we simply list its properties and their types.<br><code>é™¤äº†åŸå§‹ç±»å‹ï¼Œæœ€å¸¸è§çš„ç±»å‹æ˜¯å¯¹è±¡ç±»å‹ã€‚è¿™æŒ‡çš„æ˜¯ä»»ä½• JavaScript å€¼ï¼Œå®ƒçš„å±æ€§éƒ½æ˜¯å¾ˆå¤šçš„ï¼ä¸ºäº†å®šä¹‰å¯¹è±¡ç±»å‹ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ—å‡ºå®ƒçš„å±æ€§å’Œå®ƒä»¬çš„ç±»å‹ã€‚</code><br>For example, hereâ€™s a function that takes a point-like object:<br><code>è¿™é‡Œæœ‰ä¸€ä¸ªæ¥å—ç‚¹ç±»å‹å¯¹è±¡çš„å‡½æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; The parameter&#39;s type annotation is an object typefunction printCoord(pt: &#123; x: number; y: number &#125;) &#123;  console.log(&quot;The coordinate&#39;s x value is &quot; + pt.x);  console.log(&quot;The coordinate&#39;s y value is &quot; + pt.y);&#125;printCoord(&#123; x: 3, y: 7 &#125;);</code></pre><p>Here, we annotated the parameter with a type with two properties - x and y - which are both of type number. You can use , or ; to separate the properties, and the last separator is optional either way.<br><code>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæœ‰ä¸¤ä¸ªå±æ€§çš„ç±»å‹ï¼Œx å’Œ yï¼Œå®ƒä»¬éƒ½æ˜¯ number ç±»å‹ã€‚ä½ å¯ä»¥ä½¿ç”¨ , æˆ– ; åˆ†éš”å±æ€§ï¼Œæœ€åçš„åˆ†éš”ç¬¦å¯ä»¥æ˜¯ä»»æ„çš„ã€‚</code><br>The type part of each property is also optional. If you donâ€™t specify a type, it will be assumed to be any.<br><code>æ¯ä¸ªå±æ€§çš„ç±»å‹éƒ¨åˆ†éƒ½æ˜¯å¯é€‰çš„ã€‚å¦‚æœä½ æ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œå®ƒä¼šè¢«è®¤ä¸ºæ˜¯ any ç±»å‹ã€‚</code></p><h2 id="Optional-Properties"><a href="#Optional-Properties" class="headerlink" title="Optional Properties"></a>Optional Properties</h2><p><code>å¯é€‰å±æ€§</code></p><p>Object types can also specify that some or all of their properties are optional. To do this, add a ? after the property name:<br><code>å¯¹è±¡ç±»å‹å¯ä»¥æŒ‡å®šä¸€äº›æˆ–å…¨éƒ¨çš„å±æ€§æ˜¯å¯é€‰çš„ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œåªéœ€è¦åœ¨å±æ€§ååé¢åŠ ä¸Š ? å°±å¯ä»¥äº†ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printName(obj: &#123; first: string; last?: string &#125;) &#123;  &#x2F;&#x2F; ...&#125;&#x2F;&#x2F; Both OKprintName(&#123; first: &quot;Bob&quot; &#125;);printName(&#123; first: &quot;Alice&quot;, last: &quot;Alisson&quot; &#125;);</code></pre><p>In JavaScript, if you access a property that doesnâ€™t exist, youâ€™ll get the value undefined rather than a runtime error. Because of this, when you read from an optional property, youâ€™ll have to check for undefined before using it.</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printName(obj: &#123; first: string; last?: string &#125;) &#123;  &#x2F;&#x2F; Error - might crash if &#39;obj.last&#39; wasn&#39;t provided!  console.log(obj.last.toUpperCase());Object is possibly &#39;undefined&#39;.  if (obj.last !&#x3D;&#x3D; undefined) &#123;    &#x2F;&#x2F; OK    console.log(obj.last.toUpperCase());  &#125;  &#x2F;&#x2F; A safe alternative using modern JavaScript syntax:  console.log(obj.last?.toUpperCase());&#125;</code></pre><h2 id="Union-Types"><a href="#Union-Types" class="headerlink" title="Union Types"></a>Union Types</h2><p><code>è”åˆç±»å‹</code></p><p>TypeScriptâ€™s type system allows you to build new types out of existing ones using a large variety of operators. Now that we know how to write a few types, itâ€™s time to start combining them in interesting ways.</p><h2 id="Defining-a-Union-Type"><a href="#Defining-a-Union-Type" class="headerlink" title="Defining a Union Type"></a>Defining a Union Type</h2><p><code>å®šä¹‰ä¸€ä¸ªè”åˆç±»å‹</code></p><p>The first way to combine types you might see is a union type. A union type is a type formed from two or more other types, representing values that may be any one of those types. We refer to each of these types as the unionâ€™s members.</p><p>Letâ€™s write a function that can operate on strings or numbers:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printId(id: number | string) &#123;  console.log(&quot;Your ID is: &quot; + id);&#125;&#x2F;&#x2F; OKprintId(101);&#x2F;&#x2F; OKprintId(&quot;202&quot;);&#x2F;&#x2F; ErrorprintId(&#123; myID: 22342 &#125;);&#x2F;&#x2F; Argument of type &#39;&#123; myID: number; &#125;&#39; is not assignable to parameter of type &#39;string | number&#39;.</code></pre><h2 id="Working-with-Union-Types"><a href="#Working-with-Union-Types" class="headerlink" title="Working with Union Types"></a>Working with Union Types</h2><p><code>ä½¿ç”¨è”åˆç±»å‹</code></p><p>Itâ€™s easy to provide a value matching a union type - simply provide a type matching any of the unionâ€™s members. If you have a value of a union type, how do you work with it?</p><p>TypeScript will only allow an operation if it is valid for every member of the union. For example, if you have the union string | number, you canâ€™t use methods that are only available on string:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printId(id: number | string) &#123;  console.log(id.toUpperCase());Property &#39;toUpperCase&#39; does not exist on type &#39;string | number&#39;.  Property &#39;toUpperCase&#39; does not exist on type &#39;number&#39;.&#125;</code></pre><p>The solution is to narrow the union with code, the same as you would in JavaScript without type annotations. Narrowing occurs when TypeScript can deduce a more specific type for a value based on the structure of the code.</p><p>For example, TypeScript knows that only a string value will have a typeof value â€œstringâ€:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printId(id: number | string) &#123;  if (typeof id &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    &#x2F;&#x2F; In this branch, id is of type &#39;string&#39;    console.log(id.toUpperCase());  &#125; else &#123;    &#x2F;&#x2F; Here, id is of type &#39;number&#39;    console.log(id);  &#125;&#125;</code></pre><p>Another example is to use a function like Array.isArray:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function welcomePeople(x: string[] | string) &#123;  if (Array.isArray(x)) &#123;    &#x2F;&#x2F; Here: &#39;x&#39; is &#39;string[]&#39;    console.log(&quot;Hello, &quot; + x.join(&quot; and &quot;));  &#125; else &#123;    &#x2F;&#x2F; Here: &#39;x&#39; is &#39;string&#39;    console.log(&quot;Welcome lone traveler &quot; + x);  &#125;&#125;</code></pre><p>Notice that in the else branch, we donâ€™t need to do anything special - if x wasnâ€™t a string[], then it must have been a string.</p><p>Sometimes youâ€™ll have a union where all the members have something in common. For example, both arrays and strings have a slice method. If every member in a union has a property in common, you can use that property without narrowing:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Return type is inferred as number[] | stringfunction getFirstThree(x: number[] | string) &#123;  return x.slice(0, 3);&#125;</code></pre><p>It might be confusing that a union of types appears to have the intersection of those typesâ€™ properties. This is not an accident - the name union comes from type theory. The union number | string is composed by taking the union of the values from each type. Notice that given two sets with corresponding facts about each set, only the intersection of those facts applies to the union of the sets themselves. For example, if we had a room of tall people wearing hats, and another room of Spanish speakers wearing hats, after combining those rooms, the only thing we know about every person is that they must be wearing a hat.</p><h2 id="Type-Aliases"><a href="#Type-Aliases" class="headerlink" title="Type Aliases"></a>Type Aliases</h2><p><code>ç±»å‹åˆ«å</code></p><p>Weâ€™ve been using object types and union types by writing them directly in type annotations. This is convenient, but itâ€™s common to want to use the same type more than once and refer to it by a single name.</p><p>A type alias is exactly that - a name for any type. The syntax for a type alias is:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Point &#x3D; &#123;  x: number;  y: number;&#125;;&#x2F;&#x2F; Exactly the same as the earlier examplefunction printCoord(pt: Point) &#123;  console.log(&quot;The coordinate&#39;s x value is &quot; + pt.x);  console.log(&quot;The coordinate&#39;s y value is &quot; + pt.y);&#125;printCoord(&#123; x: 100, y: 100 &#125;);</code></pre><p>You can actually use a type alias to give a name to any type at all, not just an object type. For example, a type alias can name a union type:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type ID &#x3D; number | string;</code></pre><p>Note that aliases are only aliases - you cannot use type aliases to create different&#x2F;distinct â€œversionsâ€ of the same type. When you use the alias, itâ€™s exactly as if you had written the aliased type. In other words, this code might look illegal, but is OK according to TypeScript because both types are aliases for the same type:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type UserInputSanitizedString &#x3D; string;function sanitizeInput(str: string): UserInputSanitizedString &#123;  return sanitize(str);&#125;&#x2F;&#x2F; Create a sanitized inputlet userInput &#x3D; sanitizeInput(getInput());&#x2F;&#x2F; Can still be re-assigned with a string thoughuserInput &#x3D; &quot;new input&quot;;</code></pre><h2 id="Interfaces"><a href="#Interfaces" class="headerlink" title="Interfaces"></a>Interfaces</h2><p><code>æ¥å£</code></p><p>An interface declaration is another way to name an object type:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Point &#123;  x: number;  y: number;&#125;function printCoord(pt: Point) &#123;  console.log(&quot;The coordinate&#39;s x value is &quot; + pt.x);  console.log(&quot;The coordinate&#39;s y value is &quot; + pt.y);&#125;printCoord(&#123; x: 100, y: 100 &#125;);</code></pre><p>Just like when we used a type alias above, the example works just as if we had used an anonymous object type. TypeScript is only concerned with the structure of the value we passed to printCoord - it only cares that it has the expected properties. Being concerned only with the structure and capabilities of types is why we call TypeScript a structurally typed type system.</p><h2 id="Differences-Between-Type-Aliases-and-Interfaces"><a href="#Differences-Between-Type-Aliases-and-Interfaces" class="headerlink" title="Differences Between Type Aliases and Interfaces"></a>Differences Between Type Aliases and Interfaces</h2><p><code>ç±»å‹åˆ«åå’Œæ¥å£çš„åŒºåˆ«</code></p><p>Type aliases and interfaces are very similar, and in many cases you can choose between them freely. Almost all features of an interface are available in type, the key distinction is that a type cannot be re-opened to add new properties vs an interface which is always extendable.</p><p><strong>Interface</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Extending an interfaceinterface Animal &#123;  name: string;&#125;interface Bear extends Animal &#123;  honey: boolean;&#125;const bear &#x3D; getBear();bear.name;bear.honey;</code></pre><p><strong>Type</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Extending a type via intersectionstype Animal &#x3D; &#123;  name: string;&#125;;type Bear &#x3D; Animal &amp; &#123;  honey: boolean;&#125;;const bear &#x3D; getBear();bear.name;bear.honey;</code></pre><p>Adding new fields to an existing interface</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Window &#123;  title: string;&#125;interface Window &#123;  ts: TypeScriptAPI;&#125;const src &#x3D; &#39;const a &#x3D; &quot;Hello World&quot;&#39;;window.ts.transpileModule(src, &#123;&#125;);</code></pre><p>A type cannot be changed after being created</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Window &#x3D; &#123;  title: string;&#125;;type Window &#x3D; &#123;  ts: TypeScriptAPI;&#125;;&#x2F;&#x2F; Error: Duplicate identifier &#39;Window&#39;.</code></pre><p>Youâ€™ll learn more about these concepts in later chapters, so donâ€™t worry if you donâ€™t understand all of these right away.</p><ul><li>Prior to TypeScript version 4.2, type alias names may appear in error messages, sometimes in place of the equivalent anonymous type (which may or may not be desirable). Interfaces will always be named in error messages.</li><li>Type aliases may not participate in declaration merging, but interfaces can.</li><li>Interfaces may only be used to declare the shapes of objects, not rename primitives.</li><li>Interface names will always appear in their original form in error messages, but only when they are used by name.</li></ul><p>For the most part, you can choose based on personal preference, and TypeScript will tell you if it needs something to be the other kind of declaration. If you would like a heuristic, use interface until you need to use features from type.</p><h2 id="Type-Assertions"><a href="#Type-Assertions" class="headerlink" title="Type Assertions"></a>Type Assertions</h2><p><code>ç±»å‹æ–­è¨€</code></p><p>Sometimes you will have information about the type of a value that TypeScript canâ€™t know about.</p><p>For example, if youâ€™re using document.getElementById, TypeScript only knows that this will return some kind of HTMLElement, but you might know that your page will always have an HTMLCanvasElement with a given ID.</p><p>In this situation, you can use a type assertion to specify a more specific type:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const myCanvas &#x3D; document.getElementById(&quot;main_canvas&quot;) as HTMLCanvasElement;</code></pre><p>Like a type annotation, type assertions are removed by the compiler and wonâ€™t affect the runtime behavior of your code.</p><p>You can also use the angle-bracket syntax (except if the code is in a .tsx file), which is equivalent:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const myCanvas &#x3D; &lt;HTMLCanvasElement&gt;document.getElementById(&quot;main_canvas&quot;);</code></pre><p>Reminder: Because type assertions are removed at compile-time, there is no runtime checking associated with a type assertion. There wonâ€™t be an exception or null generated if the type assertion is wrong.</p><p>TypeScript only allows type assertions which convert to a more specific or less specific version of a type. This rule prevents â€œimpossibleâ€ coercions like:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const x &#x3D; &quot;hello&quot; as number;&#x2F;&#x2F; Conversion of type &#39;string&#39; to type &#39;number&#39; may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to &#39;unknown&#39; first.</code></pre><p>Sometimes this rule can be too conservative and will disallow more complex coercions that might be valid. If this happens, you can use two assertions, first to any (or unknown, which weâ€™ll introduce later), then to the desired type:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const a &#x3D; expr as any as T;</code></pre><h2 id="Literal-Types"><a href="#Literal-Types" class="headerlink" title="Literal Types"></a>Literal Types</h2><p><code>å­—é¢é‡ç±»å‹</code></p><p>In addition to the general types string and number, we can refer to specific strings and numbers in type positions.</p><p>One way to think about this is to consider how JavaScript comes with different ways to declare a variable. Both var and let allow for changing what is held inside the variable, and const does not. This is reflected in how TypeScript creates types for literals.</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let changingString &#x3D; &quot;Hello World&quot;;changingString &#x3D; &quot;OlÃ¡ Mundo&quot;;&#x2F;&#x2F; Because &#96;changingString&#96; can represent any possible string, that&#x2F;&#x2F; is how TypeScript describes it in the type systemchangingString;let changingString: string;const constantString &#x3D; &quot;Hello World&quot;;&#x2F;&#x2F; Because &#96;constantString&#96; can only represent 1 possible string, it&#x2F;&#x2F; has a literal type representationconstantString;const constantString: &quot;Hello World&quot;;</code></pre><p>By themselves, literal types arenâ€™t very valuable:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let x: &quot;hello&quot; &#x3D; &quot;hello&quot;;&#x2F;&#x2F; OKx &#x3D; &quot;hello&quot;;&#x2F;&#x2F; ...x &#x3D; &quot;howdy&quot;;&#x2F;&#x2F; Type &#39;&quot;howdy&quot;&#39; is not assignable to type &#39;&quot;hello&quot;&#39;.</code></pre><p>Itâ€™s not much use to have a variable that can only have one value!</p><p>But by combining literals into unions, you can express a much more useful concept - for example, functions that only accept a certain set of known values:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function printText(s: string, alignment: &quot;left&quot; | &quot;right&quot; | &quot;center&quot;) &#123;  &#x2F;&#x2F; ...&#125;printText(&quot;Hello, world&quot;, &quot;left&quot;);printText(&quot;G&#39;day, mate&quot;, &quot;centre&quot;);Argument of type &#39;&quot;centre&quot;&#39; is not assignable to parameter of type &#39;&quot;left&quot; | &quot;right&quot; | &quot;center&quot;&#39;.</code></pre><p>Numeric literal types work the same way:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function compare(a: string, b: string): -1 | 0 | 1 &#123;  return a &#x3D;&#x3D;&#x3D; b ? 0 : a &gt; b ? 1 : -1;&#125;</code></pre><p>Of course, you can combine these with non-literal types:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Options &#123;  width: number;&#125;function configure(x: Options | &quot;auto&quot;) &#123;  &#x2F;&#x2F; ...&#125;configure(&#123; width: 100 &#125;);configure(&quot;auto&quot;);configure(&quot;automatic&quot;);Argument of type &#39;&quot;automatic&quot;&#39; is not assignable to parameter of type &#39;Options | &quot;auto&quot;&#39;.</code></pre><p>Thereâ€™s one more kind of literal type: boolean literals. There are only two boolean literal types, and as you might guess, they are the types true and false. The type boolean itself is actually just an alias for the union true | false.</p><h2 id="Literal-Inference"><a href="#Literal-Inference" class="headerlink" title="Literal Inference"></a>Literal Inference</h2><p><code>å­—é¢é‡æ¨æ–­</code><br>When you initialize a variable with an object, TypeScript assumes that the properties of that object might change values later. For example, if you wrote code like this:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const obj &#x3D; &#123; counter: 0 &#125;;if (someCondition) &#123;  obj.counter &#x3D; 1;&#125;</code></pre><p>TypeScript doesnâ€™t assume the assignment of 1 to a field which previously had 0 is an error. Another way of saying this is that obj.counter must have the type number, not 0, because types are used to determine both reading and writing behavior.</p><p>The same applies to strings:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const req &#x3D; &#123; url: &quot;https:&#x2F;&#x2F;example.com&quot;, method: &quot;GET&quot; &#125;;handleRequest(req.url, req.method);Argument of type &#39;string&#39; is not assignable to parameter of type &#39;&quot;GET&quot; | &quot;POST&quot;&#39;.</code></pre><p>In the above example req.method is inferred to be string, not â€œGETâ€. Because code can be evaluated between the creation of req and the call of handleRequest which could assign a new string like â€œGUESSâ€ to req.method, TypeScript considers this code to have an error.</p><p>There are two ways to work around this.</p><p>You can change the inference by adding a type assertion in either location:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Change 1:const req &#x3D; &#123; url: &quot;https:&#x2F;&#x2F;example.com&quot;, method: &quot;GET&quot; as &quot;GET&quot; &#125;;&#x2F;&#x2F; Change 2handleRequest(req.url, req.method as &quot;GET&quot;);</code></pre><p>Change 1 means â€œI intend for req.method to always have the literal type â€œGETâ€â€, preventing the possible assignment of â€œGUESSâ€ to that field after. Change 2 means â€œI know for other reasons that req.method has the value â€œGETâ€â€œ.</p><p>You can use as const to convert the entire object to be type literals:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const req &#x3D; &#123; url: &quot;https:&#x2F;&#x2F;example.com&quot;, method: &quot;GET&quot; &#125; as const;handleRequest(req.url, req.method);</code></pre><p>The as const suffix acts like const but for the type system, ensuring that all properties are assigned the literal type instead of a more general version like string or number.</p><h2 id="null-and-undefined"><a href="#null-and-undefined" class="headerlink" title="null and undefined"></a>null and undefined</h2><p><code>nullå’Œundefined</code></p><p>JavaScript has two primitive values used to signal absent or uninitialized value: null and undefined.</p><p>TypeScript has two corresponding types by the same names. How these types behave depends on whether you have the strictNullChecks option on.</p><h2 id="strictNullChecks-off"><a href="#strictNullChecks-off" class="headerlink" title="strictNullChecks off"></a>strictNullChecks off</h2><p><code>strictNullCheckså…³é—­</code></p><p>With strictNullChecks off, values that might be null or undefined can still be accessed normally, and the values null and undefined can be assigned to a property of any type. This is similar to how languages without null checks (e.g. C#, Java) behave. The lack of checking for these values tends to be a major source of bugs; we always recommend people turn strictNullChecks on if itâ€™s practical to do so in their codebase.</p><h2 id="strictNullChecks-on"><a href="#strictNullChecks-on" class="headerlink" title="strictNullChecks on"></a>strictNullChecks on</h2><p><code>strictNullCheckså¼€å¯</code></p><p>With strictNullChecks on, when a value is null or undefined, you will need to test for those values before using methods or properties on that value. Just like checking for undefined before using an optional property, we can use narrowing to check for values that might be null:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function doSomething(x: string | null) &#123;  if (x &#x3D;&#x3D;&#x3D; null) &#123;    &#x2F;&#x2F; do nothing  &#125; else &#123;    console.log(&quot;Hello, &quot; + x.toUpperCase());  &#125;&#125;</code></pre><h2 id="Non-null-Assertion-Operator-Postfix"><a href="#Non-null-Assertion-Operator-Postfix" class="headerlink" title="Non-null Assertion Operator (Postfix !)"></a>Non-null Assertion Operator (Postfix !)</h2><p><code>éç©ºæ–­è¨€è¿ç®—ç¬¦</code></p><p>TypeScript also has a special syntax for removing null and undefined from a type without doing any explicit checking. Writing ! after any expression is effectively a type assertion that the value isnâ€™t null or undefined:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function liveDangerously(x?: number | null) &#123;  &#x2F;&#x2F; No error  console.log(x!.toFixed());&#125;</code></pre><p>Just like other type assertions, this doesnâ€™t change the runtime behavior of your code, so itâ€™s important to only use ! when you know that the value canâ€™t be null or undefined.</p><h2 id="Enums"><a href="#Enums" class="headerlink" title="Enums"></a>Enums</h2><p><code>æšä¸¾</code></p><p>Enums are a feature added to JavaScript by TypeScript which allows for describing a value which could be one of a set of possible named constants. Unlike most TypeScript features, this is not a type-level addition to JavaScript but something added to the language and runtime. Because of this, itâ€™s a feature which you should know exists, but maybe hold off on using unless you are sure. You can read more about enums in the Enum reference page.</p><h2 id="Less-Common-Primitives"><a href="#Less-Common-Primitives" class="headerlink" title="Less Common Primitives"></a>Less Common Primitives</h2><p><code>æ›´å°‘å¸¸è§çš„åŸå§‹ç±»å‹</code><br>Itâ€™s worth mentioning the rest of the primitives in JavaScript which are represented in the type system. Though we will not go into depth here.</p><p>bigint<br>From ES2020 onwards, there is a primitive in JavaScript used for very large integers, BigInt:</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Creating a bigint via the BigInt functionconst oneHundred: bigint &#x3D; BigInt(100);&#x2F;&#x2F; Creating a BigInt via the literal syntaxconst anotherHundred: bigint &#x3D; 100n;</code></pre><p>You can learn more about BigInt in the TypeScript 3.2 release notes.</p><h2 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h2><p>There is a primitive in JavaScript used to create a globally unique reference via the function Symbol():</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const firstName &#x3D; Symbol(&quot;name&quot;);const secondName &#x3D; Symbol(&quot;name&quot;);if (firstName &#x3D;&#x3D;&#x3D; secondName) &#123;This condition will always return &#39;false&#39; since the types &#39;typeof firstName&#39; and &#39;typeof secondName&#39; have no overlap.  &#x2F;&#x2F; Can&#39;t ever happen&#125;</code></pre><p>You can learn more about them in Symbols reference page.</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#the-primitives-string-number-and-boolean">Typescript å¸¸è§ç±»å‹</a></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2.Typescript åŸºç¡€</title>
      <link href="//post/2022-06-07ts-basics.html"/>
      <url>//post/2022-06-07ts-basics.html</url>
      
        <content type="html"><![CDATA[<h2 id="The-Basics"><a href="#The-Basics" class="headerlink" title="The Basics"></a>The Basics</h2><p>Welcome to the first page of the handbook. If this is your first experience with TypeScript - you may want to start at one of the â€˜Getting Startedâ€™ guides<br><code>æ¬¢è¿æ¥åˆ° TypeScript æ‰‹å†Œçš„ç¬¬ä¸€é¡µã€‚å¦‚æœæ‚¨æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ TypeScript - æ‚¨å¯èƒ½æƒ³è¦å¼€å§‹ä¸€ä¸ª&#39;Getting Started&#39;æŒ‡å—</code></p><p>Each and every value in JavaScript has a set of behaviors you can observe from running different operations. That sounds abstract, but as a quick example, consider some operations we might run on a variable named message.<br><code>æ¯ä¸ªå’Œæ‰€æœ‰çš„å€¼åœ¨ JavaScript ä¸­éƒ½æœ‰ä¸€ç»„è¡Œä¸ºå¯ä»¥è§‚å¯Ÿä»è¿è¡Œä¸åŒçš„æ“ä½œã€‚è¿™ä¼šæ„Ÿè§‰å¾ˆæŠ½è±¡ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¿«é€Ÿçš„ä¾‹å­ï¼Œè€ƒè™‘ä¸€äº›æˆ‘ä»¬å¯èƒ½è¿è¡Œçš„æ“ä½œçš„å˜é‡åç§° messageã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Accessing the property &#39;toLowerCase&#39;&#x2F;&#x2F; on &#39;message&#39; and then calling itmessage.toLowerCase();&#x2F;&#x2F; Calling &#39;message&#39;message();</code></pre><p>If we break this down, the first runnable line of code accesses a property called toLowerCase and then calls it. The second one tries to call message directly.<br><code>å¦‚æœ æˆ‘ä»¬å°†è¿™ä¸ªåˆ†è§£ï¼Œç¬¬ä¸€ä¸ªå¯è¿è¡Œçš„è¡Œä»£ç è®¿é—®ä¸€ä¸ªå±æ€§å«åš toLowerCase å¹¶ä¸”è°ƒç”¨å®ƒã€‚ç¬¬äºŒä¸ªå°è¯•ç›´æ¥è°ƒç”¨ messageã€‚</code><br>But assuming we donâ€™t know the value of message - and thatâ€™s pretty common - we canâ€™t reliably say what results weâ€™ll get from trying to run any of this code. The behavior of each operation depends entirely on what value we had in the first place.<br><code>ä½†æ˜¯å‡è®¾æˆ‘ä»¬ä¸çŸ¥é“ message çš„å€¼ - å¹¶ä¸”è¿™æ˜¯å¾ˆå¸¸è§çš„ - æˆ‘ä»¬ä¸å¯ä»¥å¯é åœ°è¯´ä»€ä¹ˆç»“æœæˆ‘ä»¬ä¼šå¾—åˆ°è¿è¡Œè¿™äº›ä»£ç ã€‚æ¯ä¸ªæ“ä½œçš„è¡Œä¸ºå–å†³äºæˆ‘ä»¬æœ¬èº«çš„å€¼ã€‚</code></p><ul><li>Is message callable? <code>message æ˜¯å¯è°ƒç”¨çš„å—ï¼Ÿ</code></li><li>Does it have a property called toLowerCase on it? <code>message æœ‰ä¸€ä¸ªå±æ€§å«åš toLowerCase å—ï¼Ÿ</code></li><li>If it does, is toLowerCase even callable? <code>å¦‚æœæ˜¯ï¼Œæ˜¯å¦ toLowerCase å¯è°ƒç”¨ï¼Ÿ</code></li><li>If both of these values are callable, what do they return? <code>å¦‚æœè¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯å¯è°ƒç”¨çš„ï¼Œå®ƒä»¬ä¼šè¿”å›ä»€ä¹ˆï¼Ÿ</code></li></ul><p>The answers to these questions are usually things we keep in our heads when we write JavaScript, and we have to hope we got all the details right.<br><code>è¿™äº›é—®é¢˜çš„ç­”æ¡ˆé€šå¸¸æ˜¯æˆ‘ä»¬åœ¨å†™ JavaScript æ—¶ä¿ç•™åœ¨æˆ‘ä»¬çš„è„‘ä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬å¿…é¡»å¸Œæœ›æˆ‘ä»¬æ‹¿åˆ°æ‰€æœ‰çš„ç»†èŠ‚æ­£ç¡®ã€‚</code><br>Letâ€™s say message was defined in the following way.<br><code>è®©æˆ‘ä»¬å‡è®¾ message è¢«å®šä¹‰ä¸ºä»¥ä¸‹çš„æ–¹å¼ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const message &#x3D; &quot;Hello World!&quot;;</code></pre><p>As you can probably guess, if we try to run message.toLowerCase(), weâ€™ll get the same string only in lower-case.<br><code>å¦‚æœæˆ‘ä»¬è¯•ç€è¿è¡Œ message.toLowerCase()ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªåªæœ‰å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ã€‚</code><br>What about that second line of code? If youâ€™re familiar with JavaScript, youâ€™ll know this fails with an exception:<br><code>å¦‚æœæ‚¨ç†Ÿæ‚‰ JavaScriptï¼Œæ‚¨ä¼šçŸ¥é“è¿™ä¸ªå¤±è´¥äº†ä¸€ä¸ªå¼‚å¸¸ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; TypeError: message is not a function</code></pre><p>Itâ€™d be great if we could avoid mistakes like this.<br><code>æˆ‘ä»¬åº”è¯¥èƒ½é¿å…è¿™æ ·çš„é”™è¯¯ã€‚</code><br>When we run our code, the way that our JavaScript runtime chooses what to do is by figuring out the type of the value - what sorts of behaviors and capabilities it has. Thatâ€™s part of what that TypeError is alluding to - itâ€™s saying that the string â€œHello World!â€ cannot be called as a function.<br><code>å½“æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œæˆ‘ä»¬çš„ JavaScript è¿è¡Œæ—¶é€šè¿‡åˆ†æå€¼çš„ç±»å‹æ¥å†³å®šå¦‚ä½•åšã€‚è¿™æ˜¯å®ƒå¼•ç”¨çš„ TypeError çš„ä¸€éƒ¨åˆ† - å®ƒè¯´æ˜ &quot;Hello World!&quot; ä¸èƒ½è¢«è°ƒç”¨ä½œä¸ºå‡½æ•°ã€‚</code><br>For some values, such as the primitives string and number, we can identify their type at runtime using the typeof operator. But for other things like functions, thereâ€™s no corresponding runtime mechanism to identify their types. For example, consider this function:<br><code>å¯¹äºæŸäº›å€¼ï¼Œå¦‚å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡ typeof æ“ä½œç¬¦æ¥è¯†åˆ«å®ƒçš„ç±»å‹ã€‚ä½†æ˜¯å¯¹äºå…¶ä»–çš„ä¸œè¥¿ï¼Œæ²¡æœ‰ç›¸åº”çš„è¿è¡Œæ—¶æœºåˆ¶æ¥è¯†åˆ«å®ƒä»¬çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªå‡½æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function fn(x) &#123;  return x.flip();&#125;</code></pre><p>We can observe by reading the code that this function will only work if given an object with a callable flip property, but JavaScript doesnâ€™t surface this information in a way that we can check while the code is running. The only way in pure JavaScript to tell what fn does with a particular value is to call it and see what happens. This kind of behavior makes it hard to predict what code will do before it runs, which means itâ€™s harder to know what your code is going to do while youâ€™re writing it.<br><code>æˆ‘ä»¬å¯ä»¥é€šè¿‡é˜…è¯»ä»£ç , çœ‹åˆ°è¿™ä¸ªå‡½æ•°åªæœ‰åœ¨ç»™å®šä¸€ä¸ªå¯è°ƒç”¨ flip å±æ€§çš„å¯¹è±¡æ—¶æ‰èƒ½å·¥ä½œï¼Œä½† JavaScript æ²¡æœ‰ä¸€ç§æ–¹å¼å¯ä»¥åœ¨è¿è¡Œä»£ç æ—¶æ¥è¯†åˆ« fn çš„è¡Œä¸ºã€‚åªæœ‰åœ¨è°ƒç”¨å®ƒæ—¶æ‰èƒ½çŸ¥é“ fn çš„è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºéš¾ä»¥é¢„æµ‹ï¼Œè¿™æ„å‘³ç€åœ¨å†™ä»£ç æ—¶éš¾ä»¥çŸ¥é“ä½ çš„ä»£ç ä¼šåšä»€ä¹ˆã€‚</code><br>Seen in this way, a type is the concept of describing which values can be passed to fn and which will crash. JavaScript only truly provides dynamic typing - running the code to see what happens.<br><code>åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œä¸€ä¸ªç±»å‹æ˜¯æè¿°å“ªäº›å€¼å¯ä»¥ä¼ ç»™ fnï¼Œå“ªäº›ä¼šå´©æºƒçš„æ¦‚å¿µã€‚JavaScript åªæ˜¯æä¾›äº†åŠ¨æ€ç±»å‹å®šä¹‰ - è¿è¡Œä»£ç æ¥çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</code><br>The alternative is to use a static type system to make predictions about what code is expected before it runs.<br><code>å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨é™æ€ç±»å‹ç³»ç»Ÿæ¥é¢„æµ‹åœ¨è¿è¡Œä»£ç ä¹‹å‰ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</code></p><h2 id="Static-type-checking"><a href="#Static-type-checking" class="headerlink" title="Static type-checking"></a>Static type-checking</h2><p><code>é™æ€ç±»å‹æ£€æŸ¥</code><br>Think back to that TypeError we got earlier from trying to call a string as a function. Most people donâ€™t like to get any sorts of errors when running their code - those are considered bugs! And when we write new code, we try our best to avoid introducing new bugs.<br><code>æƒ³èµ·é‚£ä¸ª TypeError æˆ‘ä»¬ä»¥å‰ä»å°è¯•è°ƒç”¨ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‡½æ•°æ—¶å¾—åˆ°çš„ã€‚å¤§å¤šæ•°äººä¸å–œæ¬¢åœ¨è¿è¡Œä»–ä»¬çš„ä»£ç æ—¶å¾—åˆ°ä»»ä½•ç±»å‹çš„é”™è¯¯ï¼Œè¿™äº›é”™è¯¯è¢«ç§°ä¸º bugï¼è€Œå½“æˆ‘ä»¬å†™æ–°ä»£ç æ—¶ï¼Œæˆ‘ä»¬å°½å¯èƒ½åœ°é¿å…å¼•å…¥æ–°çš„ bugã€‚</code><br>If we add just a bit of code, save our file, re-run the code, and immediately see the error, we might be able to isolate the problem quickly; but thatâ€™s not always the case. We might not have tested the feature thoroughly enough, so we might never actually run into a potential error that would be thrown! Or if we were lucky enough to witness the error, we might have ended up doing large refactorings and adding a lot of different code that weâ€™re forced to dig through.<br><code>å¦‚æœæˆ‘ä»¬æ·»åŠ äº›ç‚¹ä»£ç ï¼Œä¿å­˜æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œé‡æ–°è¿è¡Œä»£ç ï¼Œå¹¶ç«‹å³çœ‹åˆ°é”™è¯¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¿«é€Ÿåœ°å‘ç°é—®é¢˜ï¼›ä½†è¿™å¹¶ä¸æ€»æ˜¯å¦‚æ­¤ã€‚æˆ‘ä»¬å¯èƒ½æ²¡æœ‰æµ‹è¯•ç‰¹æ€§çš„å……åˆ†ç¨‹åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½æ²¡æœ‰çœŸæ­£å‘ç”Ÿå¯èƒ½ä¼šæŠ›å‡ºçš„é”™è¯¯ï¼æˆ–è€…å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°é”™è¯¯ï¼Œæˆ‘ä»¬å¯èƒ½å·²ç»åšäº†å¤§é‡çš„é‡æ„å’Œæ·»åŠ äº†å¾ˆå¤šä¸åŒçš„ä»£ç ï¼Œæˆ‘ä»¬è¢«è¿«è¦æ¢ç´¢å®ƒä»¬ã€‚</code><br>Ideally, we could have a tool that helps us find these bugs before our code runs. Thatâ€™s what a static type-checker like TypeScript does. Static types systems describe the shapes and behaviors of what our values will be when we run our programs. A type-checker like TypeScript uses that information and tells us when things might be going off the rails.<br><code>æœ€å¥½çš„æ–¹å¼æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„ä»£ç è¿è¡Œä¹‹å‰ï¼Œæœ‰ä¸€ä¸ªå·¥å…·å¸®æˆ‘ä»¬æ‰¾åˆ°è¿™äº› bugã€‚è¿™æ˜¯ TypeScript çš„é™æ€ç±»å‹æ£€æŸ¥å™¨åšçš„ã€‚é™æ€ç±»å‹ç³»ç»Ÿæè¿°äº†æˆ‘ä»¬çš„å€¼åœ¨è¿è¡Œæˆ‘ä»¬çš„ç¨‹åºæ—¶çš„å½¢çŠ¶å’Œè¡Œä¸ºã€‚ä¸€ä¸ªç±»å‹æ£€æŸ¥å™¨åƒ TypeScript ä½¿ç”¨è¿™äº›ä¿¡æ¯ï¼Œå‘Šè¯‰æˆ‘ä»¬å½“å¯èƒ½ä¼šå‡ºç°é—®é¢˜æ—¶ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const message &#x3D; &quot;hello!&quot;;message();&#x2F;&#x2F; This expression is not callable.&#x2F;&#x2F;   Type &#39;String&#39; has no call signatures.</code></pre><p>Running that last sample with TypeScript will give us an error message before we run the code in the first place.<br><code>è¿è¡Œè¿™ä¸ªæœ€åä¸€ä¸ªç¤ºä¾‹ï¼ŒTypeScript å°†åœ¨ç¬¬ä¸€ä¸ªä»£ç ä¹‹å‰æŠ¥é”™ã€‚</code></p><h2 id="Non-exception-Failures"><a href="#Non-exception-Failures" class="headerlink" title="Non-exception Failures"></a>Non-exception Failures</h2><p><code>éå¼‚å¸¸å¤±è´¥</code><br>So far weâ€™ve been discussing certain things like runtime errors - cases where the JavaScript runtime tells us that it thinks something is nonsensical. Those cases come up because the ECMAScript specification has explicit instructions on how the language should behave when it runs into something unexpected.<br><code>ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½è®¨è®ºäº†ä¸€äº›å…³äºè¿è¡Œæ—¶é”™è¯¯çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´ï¼Œå½“ JavaScript è¿è¡Œæ—¶è®¤ä¸ºæŸäº›ä¸œè¥¿æ˜¯æ— æ•ˆçš„ã€‚è¿™äº›æƒ…å†µå‡ºç°çš„åŸå› æ˜¯ ECMAScript è§„èŒƒæ˜ç¡®æŒ‡å‡ºäº†åœ¨è¿è¡Œæ—¶å¦‚ä½•åº”è¯¥è¡Œä¸ºã€‚</code><br>For example, the specification says that trying to call something that isnâ€™t callable should throw an error. Maybe that sounds like â€œobvious behaviorâ€, but you could imagine that accessing a property that doesnâ€™t exist on an object should throw an error too. Instead, JavaScript gives us different behavior and returns the value undefined:<br><code>æ¯”å¦‚è¯´ï¼Œè§„èŒƒæŒ‡å‡ºäº†å°è¯•è°ƒç”¨ä¸å¯è°ƒç”¨çš„ä¸œè¥¿åº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚å¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯â€œæ˜æ˜¾çš„è¡Œä¸ºâ€ï¼Œä½†ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œè®¿é—®ä¸€ä¸ªå¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§åº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚è€Œ JavaScript ç»™æˆ‘ä»¬ä¸åŒçš„è¡Œä¸ºï¼Œè¿”å›å€¼ undefinedï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const user &#x3D; &#123;  name: &quot;Daniel&quot;,  age: 26,&#125;;user.location; &#x2F;&#x2F; returns undefined</code></pre><p>Ultimately, a static type system has to make the call over what code should be flagged as an error in its system, even if itâ€™s â€œvalidâ€ JavaScript that wonâ€™t immediately throw an error. In TypeScript, the following code produces an error about location not being defined:<br><code>æœ€ç»ˆï¼Œä¸€ä¸ªé™æ€ç±»å‹ç³»ç»Ÿå¿…é¡»è¦åœ¨å®ƒçš„ç³»ç»Ÿä¸­ï¼Œå‘Šè¯‰æˆ‘ä»¬åº”è¯¥æŠŠå“ªäº›ä»£ç æ ‡è®°ä¸ºé”™è¯¯çš„ä»£ç ï¼Œå³ä½¿å®ƒæ˜¯â€œæœ‰æ•ˆçš„ JavaScriptâ€ï¼Œä¹Ÿä¸ä¼šç«‹å³æŠ›å‡ºé”™è¯¯ã€‚åœ¨ TypeScript ä¸­ï¼Œä¸‹é¢çš„ä»£ç ä¼šæŠ¥é”™ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const user &#x3D; &#123;  name: &quot;Daniel&quot;,  age: 26,&#125;;user.location;&#x2F;&#x2F; Property &#39;location&#39; does not exist on type &#39;&#123; name: string; age: number; &#125;&#39;.</code></pre><p>While sometimes that implies a trade-off in what you can express, the intent is to catch legitimate bugs in our programs. And TypeScript catches a lot of legitimate bugs.<br><code>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªäº¤æ¢ï¼Œåœ¨ä½ èƒ½è¡¨è¾¾çš„èŒƒå›´å†…ï¼Œåœ¨ä½ çš„ç¨‹åºä¸­ï¼Œä½ å¯ä»¥æŠŠä¸€äº›æœ‰æ•ˆçš„ JavaScript æŠ›å‡ºé”™è¯¯ã€‚è€Œ TypeScript æ•è·å¾ˆå¤šæœ‰æ•ˆçš„é”™è¯¯ã€‚</code><br>For example: typos,<br><code>æ¯”å¦‚è¯´ï¼Œæ‹¼å†™é”™è¯¯ï¼Œ</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const announcement &#x3D; &quot;Hello World!&quot;;&#x2F;&#x2F; How quickly can you spot the typos?announcement.toLocaleLowercase();announcement.toLocalLowerCase();&#x2F;&#x2F; We probably meant to write this...announcement.toLocaleLowerCase();</code></pre><p>uncalled functions,<br><code>æœªè°ƒç”¨çš„å‡½æ•°ï¼Œ</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function flipCoin() &#123;  &#x2F;&#x2F; Meant to be Math.random()  return Math.random &lt; 0.5;  &#x2F;&#x2F; Operator &#39;&lt;&#39; cannot be applied to types &#39;() &#x3D;&gt; number&#39; and &#39;number&#39;.&#125;</code></pre><p>or basic logic errors.<br><code>æˆ–åŸºæœ¬çš„é€»è¾‘é”™è¯¯ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const value &#x3D; Math.random() &lt; 0.5 ? &quot;a&quot; : &quot;b&quot;;if (value !&#x3D;&#x3D; &quot;a&quot;) &#123;  &#x2F;&#x2F; ...&#125; else if (value &#x3D;&#x3D;&#x3D; &quot;b&quot;) &#123;  &#x2F;&#x2F; This condition will always return &#39;false&#39; since the types &#39;&quot;a&quot;&#39; and &#39;&quot;b&quot;&#39; have no overlap.  &#x2F;&#x2F; Oops, unreachable&#125;</code></pre><h2 id="Types-for-Tooling"><a href="#Types-for-Tooling" class="headerlink" title="Types for Tooling"></a>Types for Tooling</h2><p><code>ç±»å‹ä¸ºå·¥å…·</code><br>TypeScript can catch bugs when we make mistakes in our code. Thatâ€™s great, but TypeScript can also prevent us from making those mistakes in the first place.<br><code>TypeScript å¯ä»¥æ•è·æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­åšé”™è¯¯çš„é”™è¯¯ã€‚è¿™å¾ˆå¥½ï¼Œä½† TypeScript å¯ä»¥é˜²æ­¢æˆ‘ä»¬åšé”™è¯¯ã€‚</code><br>The type-checker has information to check things like whether weâ€™re accessing the right properties on variables and other properties. Once it has that information, it can also start suggesting which properties you might want to use.<br><code>ç±»å‹æ£€æŸ¥å™¨æœ‰ä¿¡æ¯æ¥æ£€æŸ¥å˜é‡å’Œå…¶ä»–å±æ€§æ˜¯å¦æ­£ç¡®ã€‚ä¸€æ—¦æœ‰è¿™äº›ä¿¡æ¯ï¼Œå®ƒä¹Ÿå¯ä»¥å¼€å§‹æå»ºè®®ä½ åº”è¯¥ä½¿ç”¨å“ªäº›å±æ€§ã€‚</code><br>That means TypeScript can be leveraged for editing code too, and the core type-checker can provide error messages and code completion as you type in the editor. Thatâ€™s part of what people often refer to when they talk about tooling in TypeScript.<br><code>è¿™æ„å‘³ç€ TypeScript å¯ä»¥ç”¨äºç¼–è¾‘ä»£ç ï¼Œå¹¶ä¸”æ ¸å¿ƒç±»å‹æ£€æŸ¥å™¨å¯ä»¥æä¾›é”™è¯¯æ¶ˆæ¯å’Œä»£ç è¡¥å…¨ã€‚è¿™æ˜¯äººä»¬é€šå¸¸åœ¨è¯´è®¨è®ºå·¥å…·æ—¶æ‰€æåˆ°çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import express from &quot;express&quot;;const app &#x3D; express();app.get(&quot;&#x2F;&quot;, function (req, res) &#123;  res.sen    &#x2F;&#x2F; send    &#x2F;&#x2F; sendDate    &#x2F;&#x2F; sendfile    &#x2F;&#x2F; sendFile    &#x2F;&#x2F; sendStatus&#125;);app.</code></pre><p>TypeScript takes tooling seriously, and that goes beyond completions and errors as you type. An editor that supports TypeScript can deliver â€œquick fixesâ€ to automatically fix errors, refactorings to easily re-organize code, and useful navigation features for jumping to definitions of a variable, or finding all references to a given variable. All of this is built on top of the type-checker and is fully cross-platform, so itâ€™s likely that your favorite editor has TypeScript support available.<br><code>TypeScript ä¹Ÿæ·±æ·±åœ°è®¤è¯†åˆ°å·¥å…·ï¼Œå¹¶ä¸”è¿™ä¹ŸåŒ…æ‹¬äº†å®Œæˆå’Œé”™è¯¯çš„è¡¥å…¨ï¼Œä½ åœ¨è¾“å…¥æ—¶å¯ä»¥è‡ªåŠ¨ä¿®å¤é”™è¯¯ï¼Œé‡æ–°ç»„ç»‡ä»£ç ï¼Œä»¥åŠå¯»æ‰¾å˜é‡çš„å®šä¹‰ï¼Œæˆ–å¯»æ‰¾æ‰€æœ‰å¼•ç”¨çš„å˜é‡ã€‚è¿™å…¨éƒ¨æ˜¯åŸºäºç±»å‹æ£€æŸ¥å™¨çš„ï¼Œå¹¶ä¸”æ˜¯å®Œå…¨çš„è·¨å¹³å°ï¼Œæ‰€ä»¥ä½ å¯èƒ½å–œæ¬¢çš„ç¼–è¾‘å™¨æœ‰ TypeScript çš„æ”¯æŒã€‚</code></p><h2 id="tsc-the-TypeScript-compiler"><a href="#tsc-the-TypeScript-compiler" class="headerlink" title="tsc, the TypeScript compiler"></a>tsc, the TypeScript compiler</h2><p><code>tsc</code>ï¼ŒTypeScript ç¼–è¯‘å™¨<br>Weâ€™ve been talking about type-checking, but we havenâ€™t yet used our type-checker. Letâ€™s get acquainted with our new friend tsc, the TypeScript compiler. First weâ€™ll need to grab it via npm.<br><code>æˆ‘ä»¬å·²ç»è®²è¿°äº†ç±»å‹æ£€æŸ¥ï¼Œä½†æˆ‘ä»¬è¿˜æ²¡æœ‰ä½¿ç”¨æˆ‘ä»¬çš„ç±»å‹æ£€æŸ¥å™¨ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡ npm æ¥è·å– tscï¼ŒTypeScript ç¼–è¯‘å™¨ã€‚</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install -g typescript</code></pre><p>This installs the TypeScript Compiler tsc globally. You can use npx or similar tools if youâ€™d prefer to run tsc from a local node_modules package instead.<br><code>è¿™å°†å®‰è£… TypeScript ç¼–è¯‘å™¨ tsc åœ¨å…¨å±€ã€‚å¦‚æœä½ æƒ³ä»æœ¬åœ°çš„ node_modules åŒ…é‡Œè¿è¡Œ tscï¼Œå¯ä»¥ä½¿ç”¨ npx æˆ–ç±»ä¼¼çš„å·¥å…·ã€‚</code><br>Now letâ€™s move to an empty folder and try writing our first TypeScript program: hello.ts:<br><code>ç°åœ¨æˆ‘ä»¬ç§»åŠ¨åˆ°ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œå¹¶å°è¯•å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª TypeScript ç¨‹åºï¼šhello.tsï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Greets the world.console.log(&quot;Hello world!&quot;);</code></pre><p>Notice there are no frills here; this â€œhello worldâ€ program looks identical to what youâ€™d write for a â€œhello worldâ€ program in JavaScript. And now letâ€™s type-check it by running the command tsc which was installed for us by the typescript package.<br><code>é€šè¿‡è¿è¡Œ tsc å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æˆ‘ä»¬çš„ç¨‹åºã€‚</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tsc hello.ts</code></pre><p>Tada!<br><code>æ‹æ‹æ‹ï¼</code><br>Wait, â€œtadaâ€ what exactly? We ran tsc and nothing happened! Well, there were no type errors, so we didnâ€™t get any output in our console since there was nothing to report.<br><code>ç­‰ç­‰ï¼Œâ€œæ‹æ‹æ‹â€ï¼Œä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬è¿è¡Œ tscï¼Œæ²¡æœ‰ä»»ä½•äº‹æƒ…å‘ç”Ÿï¼</code><br>But check again - we got some file output instead. If we look in our current directory, weâ€™ll see a hello.js file next to hello.ts. Thatâ€™s the output from our hello.ts file after tsc compiles or transforms it into a plain JavaScript file. And if we check the contents, weâ€™ll see what TypeScript spits out after it processes a .ts file:<br><code>ä½†å†æ£€æŸ¥ä¸€æ¬¡ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ª hello.js æ–‡ä»¶ï¼Œå®ƒåœ¨ hello.ts åé¢ã€‚è¿™æ˜¯ tsc ç¼–è¯‘æˆ–è½¬æ¢æˆä¸€ä¸ªçº¯ JavaScript æ–‡ä»¶çš„ hello.ts çš„è¾“å‡ºã€‚å¦‚æœæˆ‘ä»¬æ£€æŸ¥å†…å®¹ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° TypeScript åœ¨å¤„ç† .ts æ–‡ä»¶åæ‰“å°å‡ºæ¥çš„å†…å®¹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; Greets the world.console.log(&quot;Hello world!&quot;);</code></pre><p>In this case, there was very little for TypeScript to transform, so it looks identical to what we wrote. The compiler tries to emit clean readable code that looks like something a person would write. While thatâ€™s not always so easy, TypeScript indents consistently, is mindful of when our code spans across different lines of code, and tries to keep comments around.<br><code>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScript å°è¯•è¾“å‡ºä¸€ä¸ªæ¸…æ´çš„å¯è¯»ä»£ç ï¼Œçœ‹èµ·æ¥åƒä¸€ä¸ªäººå†™çš„ä»£ç ã€‚è¿™å¹¶ä¸æ€»æ˜¯å¦‚æ­¤ç®€å•ï¼ŒTypeScript ç¼©è¿›ä¸€è‡´ï¼Œæ³¨æ„ä»£ç çš„ä¸åŒè¡Œï¼Œå¹¶å°è¯•ä¿æŒæ³¨é‡Šåœ¨åŒä¸€è¡Œã€‚</code><br>What about if we did introduce a type-checking error? Letâ€™s rewrite hello.ts:<br><code>å¦‚æœæˆ‘ä»¬æŠŠ hello.ts ä¸­çš„ console.log æ”¹æˆ console.logsï¼Œæˆ‘ä»¬ä¼šå‘ç°ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å†æ¬¡é‡å†™ hello.tsï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; This is an industrial-grade general-purpose greeter function:function greet(person, date) &#123;  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date&#125;!&#96;);&#125;greet(&quot;Brendan&quot;);</code></pre><p>If we run tsc hello.ts again, notice that we get an error on the command line!<br><code>å¦‚æœæˆ‘ä»¬è¿è¡Œ tsc hello.ts å†æ¬¡ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨å‘½ä»¤è¡Œä¸Šå‡ºç°ä¸€ä¸ªé”™è¯¯ï¼</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">Expected 2 arguments, but got 1.</code></pre><p>TypeScript is telling us we forgot to pass an argument to the greet function, and rightfully so. So far weâ€™ve only written standard JavaScript, and yet type-checking was still able to find problems with our code. Thanks TypeScript!<br><code>TypeScript æé†’æˆ‘ä»¬æ²¡æœ‰ä¼ é€’å‚æ•°ç»™ greet å‡½æ•°ï¼Œå¹¶ä¸”æ­£ç¡®åœ°ã€‚ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬åªå†™äº†æ ‡å‡† JavaScriptï¼Œç„¶è€Œç±»å‹æ£€æŸ¥ä»ç„¶å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬çš„ä»£ç çš„é—®é¢˜ã€‚æ„Ÿè°¢ TypeScriptï¼</code></p><h2 id="Emitting-with-Errors"><a href="#Emitting-with-Errors" class="headerlink" title="Emitting with Errors"></a>Emitting with Errors</h2><p><code>å‘å°„é”™è¯¯</code><br>One thing you might not have noticed from the last example was that our hello.js file changed again. If we open that file up then weâ€™ll see that the contents still basically look the same as our input file. That might be a bit surprising given the fact that tsc reported an error about our code, but this is based on one of TypeScriptâ€™s core values: much of the time, you will know better than TypeScript.<br><code>ä¸€ä¸ªä½ å¯èƒ½æ²¡æœ‰æ³¨æ„åˆ°çš„äº‹æƒ…æ˜¯ï¼Œæˆ‘ä»¬çš„ hello.js æ–‡ä»¶å˜äº†ä¸€æ¬¡ã€‚å¦‚æœæˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒçš„å†…å®¹ä»ç„¶åŸºæœ¬å’Œæˆ‘ä»¬çš„è¾“å…¥æ–‡ä»¶ä¸€æ ·ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆç³Ÿçš„æƒ…å†µï¼Œå› ä¸º tsc æŠ¥å‘Šäº†æˆ‘ä»¬çš„ä»£ç çš„é”™è¯¯ï¼Œä½†è¿™æ˜¯åŸºäº TypeScript çš„æ ¸å¿ƒå€¼ï¼šå¾ˆå¤šæ—¶å€™ï¼Œä½ ä¼šæ›´äº†è§£æ›´å¤šçš„äº‹æƒ…ã€‚</code><br>To reiterate from earlier, type-checking code limits the sorts of programs you can run, and so thereâ€™s a tradeoff on what sorts of things a type-checker finds acceptable. Most of the time thatâ€™s okay, but there are scenarios where those checks get in the way. For example, imagine yourself migrating JavaScript code over to TypeScript and introducing type-checking errors. Eventually youâ€™ll get around to cleaning things up for the type-checker, but that original JavaScript code was already working! Why should converting it over to TypeScript stop you from running it?<br><code>é‡å¤ä¸Šä¸€æ®µå†…å®¹ï¼Œç±»å‹æ£€æŸ¥ä»£ç é™åˆ¶äº†ä½ å¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Œå› æ­¤æœ‰ä¸€ä¸ªäº¤æ¢ï¼Œå¦‚æœä½ çš„ç±»å‹æ£€æŸ¥å™¨æ‰¾åˆ°äº†å¯æ¥å—çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ï¼Œè¿™äº›æ£€æŸ¥ä¼šæ‹–æ…¢ä½ çš„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ˜¯ä¸€ä¸ª JavaScript çš„ç§»æ¤è€…ï¼Œå¹¶ä¸”ä½ æŠŠç±»å‹æ£€æŸ¥é”™è¯¯æ’å…¥åˆ°ä½ çš„ä»£ç ä¸­ã€‚æœ€ç»ˆï¼Œä½ ä¼šæŠŠå®ƒä»¬æ¸…ç†æ‰ï¼Œä½†æ˜¯åŸæ¥çš„ JavaScript ä»£ç å·²ç»å·²ç»æ­£å¸¸è¿è¡Œäº†ï¼ä¸ºä»€ä¹ˆä½ ä¼šæŠŠå®ƒç§»æ¤åˆ° TypeScript ä¸­ï¼Œç„¶ååœæ­¢è¿è¡Œå®ƒï¼Ÿ</code><br>So TypeScript doesnâ€™t get in your way. Of course, over time, you may want to be a bit more defensive against mistakes, and make TypeScript act a bit more strictly. In that case, you can use the noEmitOnError compiler option. Try changing your hello.ts file and running tsc with that flag:<br><code>å› æ­¤ï¼ŒTypeScript ä¸ä¼šæ‹–æ…¢ä½ ã€‚ä½†æ˜¯ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦æ›´åŠ å®‰å…¨ï¼Œå¹¶ä¸”ä½¿ TypeScript å˜å¾—æ›´ä¸¥æ ¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ noEmitOnError ç¼–è¯‘å™¨é€‰é¡¹ã€‚è¯•ç€æŠŠ hello.ts æ–‡ä»¶ä¸­çš„ä»£ç æ”¹ä¸€ä¸‹ï¼Œç„¶åè¿è¡Œ tsc å¹¶ä¸”ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">tsc --noEmitOnError hello.ts</code></pre><p>Youâ€™ll notice that hello.js never gets updated.<br><code>hello.js ä¸ä¼šè¢«æ›´æ–°ã€‚</code></p><h2 id="Explicit-Types"><a href="#Explicit-Types" class="headerlink" title="Explicit Types"></a>Explicit Types</h2><p><code>æ˜¾å¼ç±»å‹</code><br>Up until now, we havenâ€™t told TypeScript what person or date are. Letâ€™s edit the code to tell TypeScript that person is a string, and that date should be a Date object. Weâ€™ll also use the toDateString() method on date.<br><code>ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½æ²¡æœ‰å‘Šè¯‰ TypeScript ä»€ä¹ˆæ˜¯äººæˆ–æ—¥æœŸã€‚æˆ‘ä»¬ç°åœ¨ç¼–è¾‘ä»£ç ï¼Œè®© TypeScript çŸ¥é“ person æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œ date åº”è¯¥æ˜¯ä¸€ä¸ª Date å¯¹è±¡ã€‚æˆ‘ä»¬ä¹Ÿä½¿ç”¨ date çš„ toDateString() æ–¹æ³•ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(person: string, date: Date) &#123;  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);&#125;</code></pre><p>What we did was add type annotations on person and date to describe what types of values greet can be called with. You can read that signature as â€greet takes a person of type string, and a date of type Dateâ€œ.<br><code>æˆ‘ä»¬åšäº†ä¸€ä¸ªç±»å‹æ ‡æ³¨ï¼Œè®© TypeScript çŸ¥é“ greet å¯ä»¥è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œperson çš„ç±»å‹æ˜¯ stringï¼Œè€Œ date çš„ç±»å‹æ˜¯ Dateã€‚</code><br>With this, TypeScript can tell us about other cases where greet might have been called incorrectly. For exampleâ€¦<br><code>è¿™æ ·ï¼ŒTypeScript å¯ä»¥å‘Šè¯‰æˆ‘ä»¬å…¶ä»–æƒ…å†µä¸‹ greet å¯èƒ½ä¼šè¢«è°ƒç”¨é”™è¯¯ã€‚ä¾‹å¦‚â€¦</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(person: string, date: Date) &#123;  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);&#125;greet(&quot;Maddison&quot;, Date());&#x2F;&#x2F; Argument of type &#39;string&#39; is not assignable to parameter of type &#39;Date&#39;.</code></pre><p>Huh? TypeScript reported an error on our second argument, but why?<br><code>å“ï¼ŸTypeScript åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸ŠæŠ¥é”™äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</code><br>Perhaps surprisingly, calling Date() in JavaScript returns a string. On the other hand, constructing a Date with new Date() actually gives us what we were expecting.<br><code>å¯èƒ½å°±æ˜¯å› ä¸º JavaScript ä¸­çš„ Date() è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œ new Date() åˆ™ä¼šè¿”å›æˆ‘ä»¬æœŸæœ›çš„ç»“æœã€‚</code><br>Anyway, we can quickly fix up the error:<br><code>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿä¿®å¤é”™è¯¯ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(person: string, date: Date) &#123;  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);&#125;greet(&quot;Maddison&quot;, new Date());</code></pre><p>Keep in mind, we donâ€™t always have to write explicit type annotations. In many cases, TypeScript can even just infer (or â€œfigure outâ€) the types for us even if we omit them.<br><code>è®°ä½ï¼Œæˆ‘ä»¬ä¸æ˜¯æ€»æ˜¯è¦å†™æ˜ç±»å‹æ ‡æ³¨ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒTypeScript ä¹Ÿå¯ä»¥è‡ªåŠ¨æ¨æ–­ï¼ˆæˆ–è€…è¯´è®¤ä¸ºï¼‰ç±»å‹ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰å†™æ˜ç±»å‹æ ‡æ³¨ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let msg &#x3D; &quot;hello there!&quot;;let msg: string;</code></pre><p>Even though we didnâ€™t tell TypeScript that msg had the type string it was able to figure that out. Thatâ€™s a feature, and itâ€™s best not to add annotations when the type system would end up inferring the same type anyway.<br><code>å³ä½¿æˆ‘ä»¬æ²¡æœ‰å‘Šè¯‰ TypeScript msg çš„ç±»å‹æ˜¯ stringï¼Œå®ƒä¹Ÿèƒ½å¤Ÿè‡ªåŠ¨æ¨æ–­å‡ºæ¥ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œå¹¶ä¸”å½“ç±»å‹ç³»ç»Ÿè‡ªåŠ¨æ¨æ–­å‡ºç›¸åŒç±»å‹çš„æ—¶å€™ï¼Œä¸è¦å†™æ˜ç±»å‹æ ‡æ³¨ã€‚</code><br>:::tip</p><p>the message bubble inside the code sample above. That is what your editor would show if you had hovered over the word.<br><code>åœ¨ä¸Šé¢çš„ä»£ç æ®µä¸­ï¼Œä½ çš„ç¼–è¾‘å™¨ä¼šæ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯æ³¡ã€‚å¦‚æœä½ é¼ æ ‡æ‚¬åœåœ¨è¿™ä¸ªå•è¯ä¸Šï¼Œé‚£ä¹ˆä½ çš„ç¼–è¾‘å™¨ä¼šæ˜¾ç¤ºè¿™ä¸ªæ¶ˆæ¯æ³¡ã€‚</code><br>:::</p><h2 id="Erased-Types"><a href="#Erased-Types" class="headerlink" title="Erased Types"></a>Erased Types</h2><p><code>æ“¦é™¤ç±»å‹</code><br>Letâ€™s take a look at what happens when we compile the above function greet with tsc to output JavaScript:<br><code>æˆ‘ä»¬çœ‹çœ‹å¦‚æœæˆ‘ä»¬ç”¨ tsc ç¼–è¯‘ä¸Šé¢çš„å‡½æ•° greetï¼Œå®ƒä¼šè¾“å‡º JavaScript ä»£ç ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&quot;use strict&quot;;function greet(person, date) &#123;  console.log(    &quot;Hello &quot;.concat(person, &quot;, today is &quot;).concat(date.toDateString(), &quot;!&quot;)  );&#125;greet(&quot;Maddison&quot;, new Date());</code></pre><p>Notice two things here:<br><code>æ³¨æ„è¿™é‡Œæœ‰ä¸¤ä»¶äº‹æƒ…ï¼š</code><br>Our person and date parameters no longer have type annotations.<br><code>æˆ‘ä»¬çš„ person å’Œ date å‚æ•°æ²¡æœ‰ç±»å‹æ ‡æ³¨ã€‚</code><br>Our â€œtemplate stringâ€ - that string that used backticks (the <code>character) - was converted to plain strings with concatenations (+).</code>æˆ‘ä»¬çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆä½¿ç”¨ å­—ç¬¦ï¼‰å·²ç»è¢«è½¬æ¢æˆäº†çº¯å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä½¿ç”¨äº† + å­—ç¬¦ä¸²è¿æ¥ã€‚<code>More on that second point later, but letâ€™s now focus on that first point. Type annotations arenâ€™t part of JavaScript (or ECMAScript to be pedantic), so there really arenâ€™t any browsers or other runtimes that can just run TypeScript unmodified. Thatâ€™s why TypeScript needs a compiler in the first place - it needs some way to strip out or transform any TypeScript-specific code so that you can run it. Most TypeScript-specific code gets erased away, and likewise, here our type annotations were completely erased.</code>TypeScript ä¸æ˜¯ JavaScriptï¼ˆæˆ–è€…è¯´ ECMAScriptï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰æµè§ˆå™¨æˆ–å…¶ä»–è¿è¡Œæ—¶å¯ä»¥ç›´æ¥è¿è¡Œ TypeScript çš„æƒ…å†µã€‚å› æ­¤ TypeScript éœ€è¦ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å»æ‰æˆ–è½¬æ¢ TypeScript çš„ä»»ä½•ç‰¹å®šä»£ç ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒã€‚å¤§å¤šæ•° TypeScript ç‰¹å®šä»£ç éƒ½ä¼šè¢«å»æ‰ï¼Œåä¹‹ï¼Œè¿™é‡Œçš„ç±»å‹æ ‡æ³¨ä¹Ÿä¼šè¢«å»æ‰ã€‚&#96;</p><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p>Remember: Type annotations never change the runtime behavior of your program.<br><code>è®°ä½ï¼šç±»å‹æ ‡æ³¨ä¸ä¼šæ”¹å˜ä½ çš„ç¨‹åºçš„è¿è¡Œæ—¶è¡Œä¸ºã€‚</code></div><h2 id="Downleveling"><a href="#Downleveling" class="headerlink" title="Downleveling"></a>Downleveling</h2><p><code>é™çº§</code><br>One other difference from the above was that our template string was rewritten from<br><code>æˆ‘ä»¬çš„æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ä»</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;;</code></pre><p>to</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&quot;Hello &quot; + person + &quot;, today is &quot; + date.toDateString() + &quot;!&quot;;</code></pre><p>Why did this happen?<br><code>ä¸ºä»€ä¹ˆè¿™æ ·å‘ç”Ÿäº†ï¼Ÿ</code><br>Template strings are a feature from a version of ECMAScript called ECMAScript 2015 (a.k.a. ECMAScript 6, ES2015, ES6, etc. - donâ€™t ask). TypeScript has the ability to rewrite code from newer versions of ECMAScript to older ones such as ECMAScript 3 or ECMAScript 5 (a.k.a. ES3 and ES5). This process of moving from a newer or â€œhigherâ€ version of ECMAScript down to an older or â€œlowerâ€ one is sometimes called downleveling.<br><code>æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ ECMAScript 2015 çš„ä¸€ä¸ªç‰¹æ€§ï¼ˆæˆ–è€…è¯´ ECMAScript 6ï¼ŒES2015ï¼ŒES6 ç­‰ï¼‰ã€‚TypeScript æœ‰èƒ½åŠ›å°†ä»æ›´æ–°çš„ ECMAScript ç§»åˆ°æ›´æ—§çš„ ECMAScriptï¼Œæ¯”å¦‚ ECMAScript 3 æˆ– ECMAScript 5ï¼ˆæˆ–è€…è¯´ ES3 å’Œ ES5ï¼‰ã€‚è¿™ç§ç§»åŠ¨çš„è¿‡ç¨‹ç§°ä¸ºé™çº§ã€‚</code><br>By default TypeScript targets ES3, an extremely old version of ECMAScript. We could have chosen something a little bit more recent by using the target option. Running with â€“target es2015 changes TypeScript to target ECMAScript 2015, meaning code should be able to run wherever ECMAScript 2015 is supported. So running tsc â€“target es2015 hello.ts gives us the following output:<br><code>é»˜è®¤æƒ…å†µä¸‹ï¼ŒTypeScript ç›®æ ‡ ES3ï¼Œä¸€ä¸ªéå¸¸è€çš„ ECMAScript ç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ›´æ–°çš„ç‰ˆæœ¬ï¼Œä½¿ç”¨ target é€‰é¡¹ã€‚è¿è¡Œ tsc --target es2015 hello.ts å°±ä¼šå¾—åˆ°ä»¥ä¸‹çš„è¾“å‡ºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function greet(person, date) &#123;  console.log(&#96;Hello $&#123;person&#125;, today is $&#123;date.toDateString()&#125;!&#96;);&#125;greet(&quot;Maddison&quot;, new Date());</code></pre><p>While the default target is ES3, the great majority of current browsers support ES2015. Most developers can therefore safely specify ES2015 or above as a target, unless compatibility with certain ancient browsers is important.<br><code>é»˜è®¤ç›®æ ‡æ˜¯ ES3ï¼Œå¤§å¤šæ•°å½“å‰æµè§ˆå™¨éƒ½æ”¯æŒ ES2015ã€‚å¤§å¤šæ•°å¼€å‘äººå‘˜å¯ä»¥å®‰å…¨åœ°æŒ‡å®š ES2015 æˆ–ä»¥ä¸Šä½œä¸ºç›®æ ‡ï¼Œé™¤ééœ€è¦ä¸æŸäº›å¤è€çš„æµè§ˆå™¨å…¼å®¹ã€‚</code></p><h2 id="Strictness"><a href="#Strictness" class="headerlink" title="Strictness"></a>Strictness</h2><p><code>ä¸¥æ ¼</code><br>Different users come to TypeScript looking for different things in a type-checker. Some people are looking for a more loose opt-in experience which can help validate only some parts of their program, and still have decent tooling. This is the default experience with TypeScript, where types are optional, inference takes the most lenient types, and thereâ€™s no checking for potentially null&#x2F;undefined values. Much like how tsc emits in the face of errors, these defaults are put in place to stay out of your way. If youâ€™re migrating existing JavaScript, that might be a desirable first step.<br><code>ä¸åŒçš„ç”¨æˆ·åˆ° TypeScript ä¸Šæ¥çœ‹ï¼Œæœ‰ä¸åŒçš„æ„å›¾ã€‚æœ‰äººæƒ³è¦ä¸€ä¸ªæ›´å®½æ¾çš„é€‰æ‹©ï¼Œè¿™å¯ä»¥å¸®åŠ©éªŒè¯æŸäº›éƒ¨åˆ†çš„ç¨‹åºï¼Œå¹¶ä¸”ä»ç„¶æœ‰å¾ˆå¥½çš„å·¥å…·ã€‚è¿™æ˜¯ TypeScript é»˜è®¤çš„è¡Œä¸ºï¼Œå…¶ä¸­ç±»å‹æ˜¯å¯é€‰çš„ï¼Œæ¨æ–­ä¼šæ¥å—æ›´å®½æ¾çš„ç±»å‹ï¼Œå¹¶ä¸”æ²¡æœ‰æ£€æŸ¥å¯èƒ½ null/undefined çš„å€¼ã€‚å’Œ tsc åœ¨å‡ºç°é”™è¯¯çš„æ—¶å€™ä¸€æ ·ï¼Œè¿™äº›é»˜è®¤å€¼è¢«æ”¾åœ¨äº†ä½ çš„è„šè·Ÿä¸Šï¼ˆå…œåº•ï¼šè¿™äº›é»˜è®¤é€‰é¡¹å¹¶ä¸ä¼šé˜»ç¢ä½ çš„å¼€å‘ï¼‰ã€‚å¦‚æœä½ æ­£åœ¨è¿ç§»å·²æœ‰çš„ JavaScriptï¼Œé‚£ä¹ˆè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæœ€ä½³çš„ç¬¬ä¸€æ­¥ã€‚</code><br>In contrast, a lot of users prefer to have TypeScript validate as much as it can straight away, and thatâ€™s why the language provides strictness settings as well. These strictness settings turn static type-checking from a switch (either your code is checked or not) into something closer to a dial. The further you turn this dial up, the more TypeScript will check for you. This can require a little extra work, but generally speaking it pays for itself in the long run, and enables more thorough checks and more accurate tooling. When possible, a new codebase should always turn these strictness checks on.<br><code>ä¸åŒçš„ç”¨æˆ·å–œæ¬¢ç«‹åˆ»éªŒè¯ç¨‹åºï¼Œè€Œä¸æ˜¯ç­‰åˆ°æœ€åã€‚è¿™æ˜¯ TypeScript çš„è¯­è¨€æä¾›äº†ä¸¥æ ¼æ€§è®¾ç½®ï¼Œè¿™äº›è®¾ç½®å¯ä»¥æ”¹å˜é™æ€ç±»å‹æ£€æŸ¥çš„è¡Œä¸ºã€‚è¿™äº›è®¾ç½®å¯ä»¥æ”¹å˜é™æ€ç±»å‹æ£€æŸ¥çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¼€å…³ã€‚è¿™äº›è®¾ç½®è¶Šé«˜ï¼ŒTypeScript è¶Šä¼šæ£€æŸ¥æ›´å¤šçš„ä¿¡æ¯ã€‚è¿™å¯èƒ½éœ€è¦ä¸€ç‚¹é¢å¤–çš„å·¥ä½œï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼Œè¿™èƒ½æä¾›æ›´å¥½çš„å·¥å…·ï¼Œå¹¶ä¸”èƒ½æ›´å¥½åœ°æ”¯æŒä½ çš„ä»£ç ã€‚å½“å¯èƒ½çš„æ—¶å€™ï¼Œä¸€ä¸ªæ–°çš„ä»£ç åº”è¯¥æ€»æ˜¯å¼€å¯è¿™äº›ä¸¥æ ¼æ€§æ£€æŸ¥ã€‚</code><br>TypeScript has several type-checking strictness flags that can be turned on or off, and all of our examples will be written with all of them enabled unless otherwise stated. The strict flag in the CLI, or â€œstrictâ€: true in a tsconfig.json toggles them all on simultaneously, but we can opt out of them individually. The two biggest ones you should know about are noImplicitAny and strictNullChecks.<br><code>TypeScript æœ‰å¤šä¸ªä¸¥æ ¼æ€§æ ‡å¿—ï¼Œå¯ä»¥å¼€å¯æˆ–å…³é—­ï¼Œæ‰€æœ‰çš„ç¤ºä¾‹éƒ½å°†ä½¿ç”¨æ‰€æœ‰çš„æ ‡å¿—ï¼Œé™¤éç‰¹åˆ«è¯´æ˜ã€‚CLI ä¸­çš„ strict å¼€å…³ï¼Œæˆ– tsconfig.json ä¸­çš„ strict: true å¼€å¯äº†æ‰€æœ‰çš„æ ‡å¿—ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å•ç‹¬å…³é—­å®ƒä»¬ã€‚ä¸¤ä¸ªæœ€å¤§çš„ï¼Œä½ åº”è¯¥çŸ¥é“çš„æ˜¯ noImplicitAny å’Œ strictNullChecksã€‚</code></p><h2 id="noImplicitAny"><a href="#noImplicitAny" class="headerlink" title="noImplicitAny"></a>noImplicitAny</h2><p><code>æ— éšå¼any</code><br>Recall that in some places, TypeScript doesnâ€™t try to infer types for us and instead falls back to the most lenient type: any. This isnâ€™t the worst thing that can happen - after all, falling back to any is just the plain JavaScript experience anyway.<br><code>åœ¨æŸäº›åœ°æ–¹ï¼ŒTypeScript ä¸ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œè€Œæ˜¯ä½¿ç”¨æœ€å®½æ¾çš„ç±»å‹ï¼šanyã€‚è¿™å¹¶ä¸æ˜¯æœ€å·®çš„æƒ…å†µï¼Œå› ä¸ºä»ç„¶æ˜¯ JavaScript çš„ç»éªŒã€‚</code><br>However, using any often defeats the purpose of using TypeScript in the first place. The more typed your program is, the more validation and tooling youâ€™ll get, meaning youâ€™ll run into fewer bugs as you code. Turning on the noImplicitAny flag will issue an error on any variables whose type is implicitly inferred as any.<br><code>ä½¿ç”¨ any å¾ˆå®¹æ˜“è®©ä½ çš„ç¨‹åºå˜å¾—æ›´åŠ ä¸å¯é ã€‚å› ä¸ºæ›´åŠ ç±»å‹åŒ–çš„ç¨‹åºï¼Œä½ ä¼šå‘ç°æ›´å¤šçš„é”™è¯¯ï¼Œå¹¶ä¸”æ›´åŠ å®¹æ˜“åœ°è°ƒè¯•ã€‚å¼€å¯ noImplicitAny æ ‡å¿—ä¼šåœ¨ä»»ä½•è‡ªåŠ¨æ¨æ–­ç±»å‹ä¸º any çš„å˜é‡ä¸Šå‘å‡ºé”™è¯¯ã€‚</code></p><h2 id="strictNullChecks"><a href="#strictNullChecks" class="headerlink" title="strictNullChecks"></a>strictNullChecks</h2><p><code>ä¸¥æ ¼null</code><br>By default, values like null and undefined are assignable to any other type. This can make writing some code easier, but forgetting to handle null and undefined is the cause of countless bugs in the world - some consider it<code> a billion dollar mistake!</code> The <code>strictNullChecks</code> flag makes handling null and undefined more explicit, and spares us from worrying about whether we forgot to handle null and undefined.<br><code>é»˜è®¤æƒ…å†µä¸‹ï¼Œnull å’Œ undefined å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ã€‚è¿™å¯ä»¥è®©å†™ä¸€äº›ä»£ç æ›´å®¹æ˜“ï¼Œä½†æ˜¯å¿˜è®°å¤„ç† null å’Œ undefined å°±ä¼šå¯¼è‡´ä¸–ç•Œä¸Šçš„å¾ˆå¤šé”™è¯¯ï¼Œæœ‰äººè®¤ä¸ºè¿™æ˜¯ä¸€ç™¾äº¿ç¾å…ƒé”™è¯¯ï¼ strictNullChecks å¯ä»¥è®©å¤„ç† null å’Œ undefined æ›´åŠ æ˜ç¡®ï¼Œå¹¶ä¸”è®©æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒæ˜¯å¦å¿˜è®°å¤„ç† null å’Œ undefinedã€‚</code></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.typescriptlang.org/docs/handbook/2/basic-types.html#static-type-checking">Typescript The Basics</a></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1.Typescriptèµ·æ­¥</title>
      <link href="//post/2022-06-08ts-start.html"/>
      <url>//post/2022-06-08ts-start.html</url>
      
        <content type="html"><![CDATA[<h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>æ­¤æ–‡åŠåç»­çš„å‡ ç¯‡æ˜¯å¯¹<a href="https://www.typescriptlang.org/docs/handbook/typescript-from-scratch.html">Typescriptå®˜æ–¹åŸæ–‡</a>çš„ç¿»è¯‘ï¼Œæ–¹ä¾¿é˜…è¯»</p><h2 id="Get-Started"><a href="#Get-Started" class="headerlink" title="Get Started"></a>Get Started</h2><p>typescript èµ·æ­¥ï¼Œåˆ†åˆ«é’ˆå¯¹ 4 ç±»ä¸åŒçš„ç¨‹åºå¼€å‘è€…è¿›è¡Œå¼•å¯¼ï¼Œ <strong>å¯¹å·å…¥åº§</strong></p><ul><li>æ–°æ‰‹ç¨‹åºçŒ¿ï¼Œæ²¡æœ‰æ¥è§¦è¿‡ä»»ä½•å¼€å‘è¯­è¨€</li><li>JS å¼€å‘è€…</li><li>Java&#x2F;C#å¼€å‘ [è·³è¿‡]</li><li>å‡½æ•°å¼ç¼–ç¨‹äººå‘˜</li><li>5 åˆ†é’Ÿå†…äº†è§£ Typescript</li></ul><h2 id="æ–°æ‰‹ç¨‹åºçŒ¿"><a href="#æ–°æ‰‹ç¨‹åºçŒ¿" class="headerlink" title="æ–°æ‰‹ç¨‹åºçŒ¿"></a>æ–°æ‰‹ç¨‹åºçŒ¿</h2><p>Congratulations on choosing TypeScript as one of your first languages â€” youâ€™re already making good decisions!<br><code>ç¥è´ºæ‚¨é€‰æ‹©äº† TypeScript ä½œä¸ºæ‚¨çš„ç¬¬ä¸€ç§è¯­è¨€ï¼Œæ‚¨å·²ç»åšå‡ºäº†ä¼˜ç§€çš„å†³ç­–ï¼</code><br>Youâ€™ve probably already heard that TypeScript is a â€œflavorâ€ or â€œvariantâ€ of JavaScript. The relationship between TypeScript (TS) and JavaScript (JS) is rather unique among modern programming languages, so learning more about this relationship will help you understand how TypeScript adds to JavaScript.<br><code>ä½ å¤§æ¦‚å·²ç»å¬è¯´è¿‡ï¼ŒTypeScript æ˜¯ JavaScript çš„ä¸€ä¸ªå˜ä½“ã€‚TypeScript å’Œ JavaScript çš„å…³ç³»æ˜¯åœ¨ç°ä»£ç¼–ç¨‹è¯­è¨€ä¸­éå¸¸ç‹¬ç‰¹çš„ï¼Œæ‰€ä»¥å­¦ä¹ æ›´å¤šå…³äºè¿™ä¸ªå…³ç³»çš„çŸ¥è¯†å°†å¸®åŠ©ä½ äº†è§£ TypeScript å’Œ JavaScript çš„åŒºåˆ«ã€‚</code></p><h3 id="What-is-JavaScript-A-Brief-History"><a href="#What-is-JavaScript-A-Brief-History" class="headerlink" title="What is JavaScript? A Brief History"></a>What is JavaScript? A Brief History</h3><p><code>ä»€ä¹ˆæ˜¯ JavaScriptï¼Ÿç®€å•çš„å†å²</code></p><p>JavaScript (also known as ECMAScript) started its life as a simple scripting language for browsers. At the time it was invented, it was expected to be used for short snippets of code embedded in a web page â€” writing more than a few dozen lines of code would have been somewhat unusual. Due to this, early web browsers executed such code pretty slowly. Over time, though, JS became more and more popular, and web developers started using it to create interactive experiences.<br><code>JavaScript æ˜¯ä¸€ç§ç®€å•çš„è„šæœ¬è¯­è¨€ï¼Œç”¨äºæµè§ˆå™¨ã€‚åœ¨åˆ›å»ºæ—¶ï¼Œå®ƒé¢„æœŸä¼šè¢«ç”¨äºåµŒå…¥åœ¨ç½‘é¡µä¸­çš„çŸ­ç‰‡ä»£ç  â€” å†™å…¥è¶…è¿‡åå‡ è¡Œä»£ç ä¼šæœ‰ç‚¹ä¸ä¾¿ã€‚</code><br>Web browser developers responded to this increased JS usage by optimizing their execution engines (dynamic compilation) and extending what could be done with it (adding APIs), which in turn made web developers use it even more. On modern websites, your browser is frequently running applications that span hundreds of thousands of lines of code. This is long and gradual growth of â€œthe webâ€, starting as a simple network of static pages, and evolving into a platform for rich applications of all kinds.<br><code>Web æµè§ˆå™¨å¼€å‘è€…å¯¹è¿™ä¸ªå¢åŠ äº† JS ä½¿ç”¨çš„å“åº”ï¼Œä¼˜åŒ–äº†ä»–ä»¬çš„æ‰§è¡Œå¼•æ“ï¼ˆåŠ¨æ€ç¼–è¯‘ï¼‰å’Œæ‰©å±•äº†ä»–ä»¬å¯ä»¥åšçš„äº‹æƒ…ï¼ˆæ·»åŠ  APIsï¼‰ï¼Œè¿™ä½¿å¾— Web å¼€å‘è€…ä½¿ç”¨å®ƒæ¥åšæ›´å¤šçš„äº‹æƒ…ã€‚åœ¨ç°ä»£ç½‘ç«™ä¸Šï¼Œæ‚¨çš„æµè§ˆå™¨é€šå¸¸è¿è¡Œç€ä¸€äº›åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬åƒä¸‡è¡Œä»£ç çš„åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é•¿çš„â€œç½‘â€çš„å‘å±•ï¼Œä»ä¸€ä¸ªç®€å•çš„é™æ€é¡µé¢å¼€å§‹ï¼Œå¹¶è¿›å…¥ä¸€ä¸ªä¸°å¯Œçš„åº”ç”¨ç¨‹åºçš„å¹³å°ã€‚</code><br>More than this, JS has become popular enough to be used outside the context of browsers, such as implementing JS servers using node.js. The â€œrun anywhereâ€ nature of JS makes it an attractive choice for cross-platform development. There are many developers these days that use only JavaScript to program their entire stack!<br><code>ä¸ä»…å¦‚æ­¤ï¼ŒJS å˜å¾—è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æµè§ˆå™¨ä¹‹å¤–ä½¿ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨ node.js æ¥å®ç° JS æœåŠ¡å™¨ã€‚JS çš„â€œè¿è¡Œåœ¨ä»»ä½•åœ°æ–¹â€æ€§è´¨ä½¿å¾—å®ƒä¸€ä¸ªæå—æ¬¢è¿çš„é€‰æ‹©ã€‚æœ‰è®¸å¤šå¼€å‘è€…ä»Šå¤©åªä½¿ç”¨ JavaScript æ¥ç¼–ç¨‹ä»–ä»¬çš„æ•´ä¸ªå †æ ˆï¼</code><br>To summarize, we have a language that was designed for quick uses, and then grew to a full-fledged tool to write applications with millions of lines. Every language has its own quirks â€” oddities and surprises, and JavaScriptâ€™s humble beginning makes it have many of these. Some examples:<br><code>æ¦‚æ‹¬ï¼Œæˆ‘ä»¬æœ‰ä¸€ç§è¯­è¨€ï¼Œè¢«è®¾è®¡ä¸ºå¿«é€Ÿä½¿ç”¨ï¼Œç„¶åæ‰©å±•åˆ°ä¸€ä¸ªå…·æœ‰åƒä¸‡è¡Œä»£ç çš„åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚æ¯ç§è¯­è¨€éƒ½æœ‰è‡ªå·±çš„ç‰¹æ€§ï¼Œæœ‰çš„æœ‰ç‚¹ä¸åŒï¼Œæœ‰çš„æœ‰ç‚¹æƒŠäººï¼Œè€Œ JavaScript çš„è½»é‡æ„Ÿä½¿å¾—å®ƒæœ‰è®¸å¤šè¿™äº›ã€‚æœ‰äº›ä¾‹å­ï¼š</code></p><p>JavaScriptâ€™s equality operator (&#x3D;&#x3D;) coerces its arguments, leading to unexpected behavior:<br><code>JavaScript çš„ç›¸ç­‰æ“ä½œç¬¦ï¼ˆ==ï¼‰ä¼šå¼ºåˆ¶è½¬æ¢å®ƒçš„å‚æ•°ï¼Œå¯¼è‡´æ„å¤–çš„è¡Œä¸ºï¼š</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">if (&quot;&quot; &#x3D;&#x3D; 0) &#123;  &#x2F;&#x2F; It is! But why??&#125;if (1 &lt; x &lt; 3) &#123;  &#x2F;&#x2F; True for *any* value of x!&#125;</code></pre><p>JavaScript also allows accessing properties which arenâ€™t present:<br><code>JavaScript ä¹Ÿå…è®¸è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼š</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const obj &#x3D; &#123; width: 10, height: 15 &#125;;&#x2F;&#x2F; Why is this NaN? Spelling is hard!const area &#x3D; obj.width * obj.heigth;</code></pre><p>Most programming languages would throw an error when these sorts of errors occur, some would do so during compilation â€” before any code is running. When writing small programs, such quirks are annoying but manageable; when writing applications with hundreds or thousands of lines of code, these constant surprises are a serious problem.<br><code>å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå½“è¿™äº›é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå®ƒä»¬ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶ã€‚å½“å†™å°å‹ç¨‹åºæ—¶ï¼Œè¿™äº›æƒŠäººçš„æƒŠå–œæ˜¯å¯æ¥å—çš„ï¼›å½“å†™å¤§å‹åº”ç”¨ç¨‹åºæ—¶ï¼Œè¿™äº›æƒŠå–œæ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚</code></p><ul><li>TypeScript: A Static Type Checker</li></ul><p>We said earlier that some languages wouldnâ€™t allow those buggy programs to run at all. Detecting errors in code without running it is referred to as static checking. Determining whatâ€™s an error and whatâ€™s not based on the kinds of values being operated on is known as static type checking.<br><code>æˆ‘ä»¬è¯´è¿‡ï¼ŒæŸäº›è¯­è¨€ä¸å…è®¸è¿è¡Œé‚£äº›é”™è¯¯çš„ç¨‹åºã€‚æ£€æµ‹ä»£ç ä¸­çš„é”™è¯¯ï¼Œè€Œä¸è¿è¡Œå®ƒ, æ˜¯é™æ€æ£€æŸ¥ã€‚ç¡®å®šå“ªäº›æ˜¯é”™è¯¯çš„ï¼Œå“ªäº›æ˜¯æ­£ç¡®çš„ï¼Œæ˜¯åŸºäºå€¼çš„ç±»å‹çš„é™æ€æ£€æŸ¥ã€‚</code><br>TypeScript checks a program for errors before execution, and does so based on the kinds of values, itâ€™s a static type checker. For example, the last example above has an error because of the type of obj. Hereâ€™s the error TypeScript found:<br><code>TypeScript æ£€æµ‹ç¨‹åºå‰ï¼Œå¹¶ä¸”åŸºäºå€¼çš„ç±»å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªé™æ€ç±»å‹æ£€æŸ¥å™¨ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢çš„æœ€åä¸€ä¸ªä¾‹å­æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º obj çš„ç±»å‹æ˜¯ NaNã€‚è¿™é‡Œ TypeScript å‘ç°äº†é”™è¯¯ï¼š</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const obj &#x3D; &#123; width: 10, height: 15 &#125;;const area &#x3D; obj.width * obj.heigth;&#x2F;&#x2F; Property &#39;heigth&#39; does not exist on type &#39;&#123; width: number; height: number; &#125;&#39;. Did you mean &#39;height&#39;?</code></pre><h3 id="A-Typed-Superset-of-JavaScript"><a href="#A-Typed-Superset-of-JavaScript" class="headerlink" title="A Typed Superset of JavaScript"></a>A Typed Superset of JavaScript</h3><p><code>ä¸€ä¸ªç±»å‹å®šä¹‰çš„è¶…é›† JavaScript</code></p><p>How does TypeScript relate to JavaScript, though?<br><code>TypeScript çš„ç±»å‹å®šä¹‰æ˜¯ä»€ä¹ˆï¼Œå’Œ JavaScript çš„ç±»å‹å®šä¹‰æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</code></p><h3 id="Syntax-è¯­æ³•"><a href="#Syntax-è¯­æ³•" class="headerlink" title="Syntax è¯­æ³•"></a>Syntax è¯­æ³•</h3><p>TypeScript is a language that is a superset of JavaScript: JS syntax is therefore legal TS. Syntax refers to the way we write text to form a program. For example, this code has a syntax error because itâ€™s missing a ):<br><code>Typescript æ˜¯ JavaScript çš„ä¸€ä¸ªå­é›†ï¼šJS è¯­è¨€çš„è¯­æ³•æ˜¯åˆæ³•çš„ TSã€‚è¯­æ³•æ˜¯æŒ‡æˆ‘ä»¬å†™ç¨‹åºçš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œè¿™æ®µä»£ç æœ‰ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œå› ä¸ºæ²¡æœ‰ä¸€ä¸ªï¼‰ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let a &#x3D; (4&#39;)&#39; expected.</code></pre><p>TypeScript doesnâ€™t consider any JavaScript code to be an error because of its syntax. This means you can take any working JavaScript code and put it in a TypeScript file without worrying about exactly how it is written.<br><code>TypeScript ä¸ä¼šè®¤ä¸ºä»»ä½• JavaScript ä»£ç æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå®ƒçš„è¯­æ³•ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æŠŠä»»ä½•å·¥ä½œçš„ JavaScript ä»£ç æ”¾åœ¨ TypeScript æ–‡ä»¶ä¸­ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå®ƒçš„è¯­æ³•ã€‚</code></p><h3 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h3><p>ç±»å‹</p><p>However, TypeScript is a typed superset, meaning that it adds rules about how different kinds of values can be used. The earlier error about obj.heigth was not a syntax error: it is an error of using some kind of value (a type) in an incorrect way.</p><p><code>ç„¶è€Œï¼ŒTypeScript æ˜¯ä¸€ä¸ªç±»å‹çš„è¶…é›†ï¼Œæ„å‘³ç€å®ƒæ·»åŠ äº†ä¸€äº›è§„åˆ™ï¼Œå¦‚ä½•ä½¿ç”¨ä¸åŒç±»å‹çš„å€¼ã€‚å‰é¢çš„é”™è¯¯ï¼Œobj.heigth æ˜¯ä¸æ˜¯ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªé”™è¯¯çš„ä½¿ç”¨æŸç§ç±»å‹çš„å€¼ï¼ˆä¸€ä¸ªç±»å‹ï¼‰çš„æ–¹å¼ã€‚</code></p><p>As another example, this is JavaScript code that you can run in your browser, and it will log a value:</p><p><code>å¦ä¸€ä¸ªä¾‹å­ï¼Œè¿™æ˜¯ä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ JavaScript ä»£ç ï¼Œå®ƒä¼šè®°å½•ä¸€ä¸ªå€¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">console.log(4 &#x2F; []);&#x2F;&#x2F; The right-hand side of an arithmetic operation must be of type &#39;any&#39;, &#39;number&#39;, &#39;bigint&#39; or an enum type.</code></pre><p>Itâ€™s possible you really did intend to divide a number by an array, perhaps just to see what happens, but most of the time, though, this is a programming mistake. TypeScriptâ€™s type checker is designed to allow correct programs through while still catching as many common errors as possible. (Later, weâ€™ll learn about settings you can use to configure how strictly TypeScript checks your code.)</p><p><code>ä¹‹å‰ä¸€ä¸ªæ•°é™¤ä»¥ä¸€ä¸ªæ•°ç»„ï¼Œå¯èƒ½ä»…ä»…æ˜¯æƒ³çœ‹ä¸‹ä¼šå‡ºç°ä»€ä¹ˆï¼Œå°½ç®¡ä»–æ˜¯ä¸€ä¸ªé”™è¯¯ç¨‹åºã€‚Typescript çš„ç±»å‹æ£€æŸ¥å™¨æ˜¯è®¾è®¡çš„ï¼Œè®©æ­£ç¡®çš„ç¨‹åºé€šè¿‡ï¼Œå¹¶ä¸”å°½å¯èƒ½å°‘çš„é”™è¯¯ã€‚(åé¢ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•é…ç½® TypeScript æ£€æŸ¥ä½ çš„ä»£ç ã€‚)</code></p><p>If you move some code from a JavaScript file to a TypeScript file, you might see type errors depending on how the code is written. These may be legitimate problems with the code, or TypeScript being overly conservative. Throughout this guide weâ€™ll demonstrate how to add various TypeScript syntax to eliminate such errors.</p><p><code>å¦‚æœä½ ä»ä¸€ä¸ª JavaScript æ–‡ä»¶ç§»åŠ¨åˆ°ä¸€ä¸ª TypeScript æ–‡ä»¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›ç±»å‹é”™è¯¯ï¼Œå–å†³äºä½ çš„ä»£ç å¦‚ä½•å†™ã€‚è¿™äº›å¯èƒ½æ˜¯ä»£ç çš„æ­£ç¡®æ€§ï¼Œæˆ–è€… TypeScript è¿‡äºä¿å®ˆã€‚æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬ä¼šæ¼”ç¤ºå¦‚ä½•æ·»åŠ å„ç§ TypeScript è¯­æ³•ï¼Œä»¥ä¾¿æ¶ˆé™¤è¿™äº›é”™è¯¯ã€‚</code></p><h3 id="Runtime-Behavior"><a href="#Runtime-Behavior" class="headerlink" title="Runtime Behavior"></a>Runtime Behavior</h3><p><code>è¿è¡Œæ—¶è¡Œä¸º</code><br>TypeScript is also a programming language that preserves the runtime behavior of JavaScript. For example, dividing by zero in JavaScript produces Infinity instead of throwing a runtime exception. As a principle, TypeScript never changes the runtime behavior of JavaScript code.<br>TypeScript ä¹Ÿæ˜¯ä¸€ä¸ªç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä¿ç•™ JavaScript çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œåœ¨ JavaScript ä¸­é™¤ä»¥é›¶ä¼šäº§ç”Ÿæ— ç©·ï¼Œè€Œä¸æ˜¯æŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ã€‚ä½œä¸ºä¸€ä¸ªåŸåˆ™ï¼ŒTypeScript ä¸ä¼šæ”¹å˜ JavaScript ä»£ç çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚<br>This means that if you move code from JavaScript to TypeScript, it is guaranteed to run the same way, even if TypeScript thinks that the code has type errors.<br><code>è¿™æ„å‘³ç€å¦‚æœä½ ä» JavaScript ç§»åŠ¨åˆ° TypeScriptï¼Œå®ƒå°±ä¿è¯ä¼šè¿è¡Œä¸€æ ·çš„ï¼Œå³ä½¿ TypeScript è®¤ä¸ºä»£ç æœ‰ç±»å‹é”™è¯¯ã€‚</code><br>Keeping the same runtime behavior as JavaScript is a foundational promise of TypeScript because it means you can easily transition between the two languages without worrying about subtle differences that might make your program stop working.<br><code>ä¿æŒå’Œ JavaScript çš„è¿è¡Œæ—¶ä¸€è‡´çš„è¡Œä¸ºæ˜¯ TypeScript çš„åŸºç¡€æ‰¿è¯ºï¼Œå› ä¸ºå®ƒæ„å‘³ç€ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ä» JavaScript åˆ° TypeScript è¿‡æ¸¡ï¼Œè€Œä¸ç”¨æ‹…å¿ƒæ½œåœ¨çš„å·®å¼‚ï¼Œå¯èƒ½ä¼šå½±å“ä½ çš„ç¨‹åºçš„æ­£å¸¸è¿è¡Œã€‚</code></p><h3 id="Erased-Types"><a href="#Erased-Types" class="headerlink" title="Erased Types"></a>Erased Types</h3><p><code>æ“¦é™¤ç±»å‹</code><br>Roughly speaking, once TypeScriptâ€™s compiler is done with checking your code, it erases the types to produce the resulting â€œcompiledâ€ code. This means that once your code is compiled, the resulting plain JS code has no type information.<br><code>æ¢å¥è¯è¯´ï¼Œä¸€æ—¦ TypeScript ç¼–è¯‘å™¨å®Œæˆäº†æ£€æŸ¥ä½ çš„ä»£ç ï¼Œå®ƒä¼šæ“¦é™¤ç±»å‹ï¼Œç”Ÿæˆç»“æœçš„â€œç¼–è¯‘â€ä»£ç ã€‚è¿™æ„å‘³ç€ï¼Œä¸€æ—¦ä½ çš„ä»£ç ç¼–è¯‘å®Œæˆï¼Œç»“æœçš„æ™®é€š JS ä»£ç å°†æ²¡æœ‰ç±»å‹ä¿¡æ¯ã€‚</code><br>This also means that TypeScript never changes the behavior of your program based on the types it inferred. The bottom line is that while you might see type errors during compilation, the type system itself has no bearing on how your program works when it runs.<br><code>è¿™æ„å‘³ç€ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ç±»å‹é”™è¯¯ï¼Œä½†æ˜¯ç±»å‹ç³»ç»Ÿæœ¬èº«æ²¡æœ‰ä»€ä¹ˆå½±å“ä½ çš„ç¨‹åºçš„è¿è¡Œã€‚åº•çº¿æ˜¯ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ç±»å‹é”™è¯¯ï¼Œä½†æ˜¯ç±»å‹ç³»ç»Ÿæœ¬èº«æ²¡æœ‰ä»€ä¹ˆå½±å“ä½ çš„ç¨‹åºçš„è¿è¡Œã€‚</code><br>Finally, TypeScript doesnâ€™t provide any additional runtime libraries. Your programs will use the same standard library (or external libraries) as JavaScript programs, so thereâ€™s no additional TypeScript-specific framework to learn.<br><code>æœ€åï¼ŒTypeScript ä¸æä¾›ä»»ä½•é¢å¤–çš„è¿è¡Œæ—¶åº“ã€‚ä½ çš„ç¨‹åºå°†ä½¿ç”¨å’Œ JavaScript ç¨‹åºä¸€æ ·çš„æ ‡å‡†åº“ï¼ˆæˆ–å¤–éƒ¨åº“ï¼‰ï¼Œæ‰€ä»¥æ²¡æœ‰é¢å¤–çš„ TypeScript-ç‰¹å®šçš„æ¡†æ¶æ¥å­¦ä¹ ã€‚</code></p><h3 id="Learning-JavaScript-and-TypeScript"><a href="#Learning-JavaScript-and-TypeScript" class="headerlink" title="Learning JavaScript and TypeScript"></a>Learning JavaScript and TypeScript</h3><p><code>å­¦ä¹  JavaScript å’Œ TypeScript</code><br>We frequently see the question â€œShould I learn JavaScript or TypeScript?â€œ.<br><code>æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼šâ€œæˆ‘åº”è¯¥å­¦ä¹  JavaScript è¿˜æ˜¯ TypeScriptï¼Ÿâ€</code><br>The answer is that you canâ€™t learn TypeScript without learning JavaScript! TypeScript shares syntax and runtime behavior with JavaScript, so anything you learn about JavaScript is helping you learn TypeScript at the same time.<br><code>ç­”æ¡ˆæ˜¯ï¼Œä½ ä¸èƒ½å­¦ä¹  TypeScriptï¼Œé™¤éä½ å­¦ä¹  JavaScriptï¼TypeScript å’Œ JavaScript å…±äº«è¯­æ³•å’Œè¿è¡Œæ—¶è¡Œä¸ºï¼Œæ‰€ä»¥ä½ å­¦ä¹  JavaScript çš„ä»»ä½•å†…å®¹éƒ½æ˜¯å¸®åŠ©ä½ å­¦ä¹  TypeScript çš„åŒæ—¶ã€‚</code><br>There are many, many resources available for programmers to learn JavaScript; you should not ignore these resources if youâ€™re writing TypeScript. For example, there are about 20 times more StackOverflow questions tagged javascript than typescript, but all of the javascript questions also apply to TypeScript.<br><code>æœ‰å¾ˆå¤šï¼Œå¾ˆå¤šèµ„æºå¯ä¾›ç¨‹åºå‘˜å­¦ä¹  JavaScriptï¼›å¦‚æœä½ å†™ TypeScriptï¼Œä½ ä¸åº”è¯¥å¿½ç•¥è¿™äº›èµ„æºã€‚ä¾‹å¦‚ï¼Œæœ‰ 20 å€çš„ StackOverflow é—®é¢˜æ ‡è®°äº† javascriptï¼Œè€Œ typescript é—®é¢˜ä¹Ÿé€‚ç”¨äº javascriptã€‚</code><br>If you find yourself searching for something like â€œhow to sort a list in TypeScriptâ€, remember: TypeScript is JavaScriptâ€™s runtime with a compile-time type checker. The way you sort a list in TypeScript is the same way you do so in JavaScript. If you find a resource that uses TypeScript directly, thatâ€™s great too, but donâ€™t limit yourself to thinking you need TypeScript-specific answers for everyday questions about how to accomplish runtime tasks.<br><code>å¦‚æœä½ å‘ç°è‡ªå·±åœ¨æœç´¢â€œå¦‚ä½•æ’åºä¸€ä¸ªåˆ—è¡¨â€ï¼Œè®°ä½ï¼šTypeScript æ˜¯ JavaScript çš„è¿è¡Œæ—¶ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥å™¨ã€‚ä½ åœ¨ TypeScript ä¸­æ’åºä¸€ä¸ªåˆ—è¡¨çš„æ–¹å¼å’Œåœ¨ JavaScript ä¸­ä¸€æ ·ã€‚å¦‚æœä½ æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨ TypeScript çš„èµ„æºï¼Œé‚£ä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼Œä½†ä¸è¦é™åˆ¶è‡ªå·±åœ¨æ¯å¤©çš„é—®é¢˜ä¸­æƒ³è¦ä½¿ç”¨ TypeScript-ç‰¹å®šçš„ç­”æ¡ˆæ¥å®ç°è¿è¡Œæ—¶ä»»åŠ¡ã€‚</code></p><h3 id="Next-Steps"><a href="#Next-Steps" class="headerlink" title="Next Steps"></a>Next Steps</h3><p><code>ä¸‹ä¸€æ­¥</code><br>This was a brief overview of the syntax and tools used in everyday TypeScript. From here, you can:<br><code>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¦‚è¿°ï¼Œä»è¿™é‡Œä½ å¯ä»¥ï¼š</code><br>Learn some of the JavaScript fundamentals, we recommend either:<br><code>å­¦ä¹  JavaScript åŸºæœ¬åŸç†ï¼Œæˆ‘ä»¬å»ºè®®ï¼š</code><br>Microsoftâ€™s JavaScript Resources or<br>JavaScript guide at the Mozilla Web Docs<br>Continue to TypeScript for JavaScript Programmers<br><code>ç»§ç»­å­¦ä¹  TypeScript ä¸º JavaScript ç¨‹åºå‘˜</code><br>Read the full Handbook from start to finish (30m)<br><code>é˜…è¯»å…¨éƒ¨æ‰‹å†Œä»å¤´åˆ°å°¾ï¼ˆ30 åˆ†é’Ÿï¼‰</code>å¤§ä½¬å°±æ˜¯å¤§ä½¬ 30 åˆ†é’Ÿèƒ½æå®šï¼Œæˆ‘ä¼°è®¡è¦æ 3 å¤©ï¼Œæ‰‹å†Œè¿™åœ°æ–¹å†…å®¹è¿˜æ˜¯å¾ˆå¤šçš„<br>Explore the Playground examples<br><code>æ¢ç´¢ Playground ç¤ºä¾‹</code></p><h2 id="JS-å¼€å‘è€…"><a href="#JS-å¼€å‘è€…" class="headerlink" title="JS å¼€å‘è€…"></a>JS å¼€å‘è€…</h2><p>TypeScript stands in an unusual relationship to JavaScript. TypeScript offers all of JavaScriptâ€™s features, and an additional layer on top of these: TypeScriptâ€™s type system.<br><code>TypeScript ä¸ JavaScript çš„å…³ç³»æ˜¯ä¸æ­£å¸¸çš„ã€‚TypeScript æä¾›äº† JavaScript çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨è¿™äº›åŠŸèƒ½çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¸€å±‚ï¼šTypeScript çš„ç±»å‹ç³»ç»Ÿã€‚</code><br>For example, JavaScript provides language primitives like string and number, but it doesnâ€™t check that youâ€™ve consistently assigned these. TypeScript does.<br><code>ä¾‹å¦‚ï¼ŒJavaScript æä¾›äº†å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œä½†å®ƒä¸æ£€æŸ¥ä½ æ˜¯å¦æŒ‰ç…§ä¸€è‡´çš„æ–¹å¼åˆ†é…è¿™äº›ã€‚TypeScript ä¹Ÿæä¾›äº†ã€‚</code><br>This means that your existing working JavaScript code is also TypeScript code. The main benefit of TypeScript is that it can highlight unexpected behavior in your code, lowering the chance of bugs.<br><code>è¿™æ„å‘³ç€ä½ çš„å·²æœ‰çš„å·¥ä½œä¸­çš„ JavaScript ä»£ç ä¹Ÿæ˜¯ TypeScript ä»£ç ã€‚TypeScript çš„ä¸»è¦å¥½å¤„æ˜¯å®ƒå¯ä»¥é«˜äº®ä½ çš„ä»£ç ä¸­çš„æ„å¤–è¡Œä¸ºï¼Œé™ä½ bug çš„å¯èƒ½æ€§ã€‚</code><br>This tutorial provides a brief overview of TypeScript, focusing on its type system.<br><code>è¿™ä¸ªæ•™ç¨‹ä¸»è¦ä»‹ç» TypeScript çš„ç±»å‹ç³»ç»Ÿã€‚</code></p><h3 id="Types-by-Inference"><a href="#Types-by-Inference" class="headerlink" title="Types by Inference"></a>Types by Inference</h3><p><code>ç±»å‹æ¨è®º</code></p><p>TypeScript knows the JavaScript language and will generate types for you in many cases. For example in creating a variable and assigning it to a particular value, TypeScript will use the value as its type.<br><code>TypeScript çŸ¥é“ JavaScript è¯­è¨€ï¼Œå¹¶ä¸”ä¼šä¸ºä½ ç”Ÿæˆç±»å‹ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå˜é‡å¹¶ä¸ºå®ƒèµ‹å€¼ï¼ŒTypeScript å°±ä¼šä½¿ç”¨å€¼ä½œä¸ºå®ƒçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let helloWorld &#x3D; &quot;Hello World&quot;;&#x2F;&#x2F; let helloWorld: string</code></pre><p>By understanding how JavaScript works, TypeScript can build a type-system that accepts JavaScript code but has types. This offers a type-system without needing to add extra characters to make types explicit in your code. Thatâ€™s how TypeScript knows that helloWorld is a string in the above example.<br><code>é€šè¿‡äº†è§£ JavaScript å·¥ä½œæ–¹å¼ï¼ŒTypeScript å¯ä»¥å»ºç«‹ä¸€ä¸ªæ¥å— JavaScript ä»£ç ï¼Œä½†æœ‰ç±»å‹çš„ç±»å‹ç³»ç»Ÿã€‚è¿™ä¸ªç±»å‹ç³»ç»Ÿæ²¡æœ‰éœ€è¦åœ¨ä½ çš„ä»£ç ä¸­æ·»åŠ é¢å¤–çš„å­—ç¬¦æ¥æ˜ç¡®ç±»å‹ã€‚è¿™å°±æ˜¯ TypeScript çŸ¥é“ helloWorld æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„åŸå› ã€‚</code></p><p>You may have written JavaScript in Visual Studio Code, and had editor auto-completion. Visual Studio Code uses TypeScript under the hood to make it easier to work with JavaScript.<br><code>ä½ å¯èƒ½åœ¨ Visual Studio Code ä¸­å†™äº† JavaScriptï¼Œå¹¶ä¸”æœ‰è‡ªåŠ¨è¡¥å…¨ã€‚Visual Studio Code ä½¿ç”¨ TypeScript ä½œä¸ºåå°æ¥æ›´åŠ æ–¹ä¾¿åœ°å·¥ä½œã€‚ï¼ˆåŸæ¥å¦‚æ­¤ï¼‰</code></p><h3 id="Defining-Types"><a href="#Defining-Types" class="headerlink" title="Defining Types"></a>Defining Types</h3><p><code>å®šä¹‰ç±»å‹</code><br>You can use a wide variety of design patterns in JavaScript. However, some design patterns make it difficult for types to be inferred automatically (for example, patterns that use dynamic programming). To cover these cases, TypeScript supports an extension of the JavaScript language, which offers places for you to tell TypeScript what the types should be.<br><code>ä½ å¯ä»¥ä½¿ç”¨ JavaScript çš„è®¸å¤šè®¾è®¡æ¨¡å¼ã€‚_ç„¶è€Œï¼Œæœ‰äº›è®¾è®¡æ¨¡å¼ä½¿å¾—ç±»å‹æ— æ³•è¢«è‡ªåŠ¨æ¨æ–­ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ¨¡å¼_ã€‚ä¸ºäº†è§£å†³è¿™äº›æƒ…å†µï¼ŒTypeScript æ”¯æŒä¸€ä¸ª JavaScript çš„æ‰©å±•ï¼Œå®ƒæä¾›äº†ç»™ä½ å‘Šè¯‰ TypeScript çš„ç±»å‹åº”è¯¥æ˜¯ä»€ä¹ˆçš„åœ°æ–¹ã€‚</code><br>For example, to create an object with an inferred type which includes name: string and id: number, you can write:<br><code>ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå…·æœ‰æ¨æ–­ç±»å‹çš„å¯¹è±¡ï¼Œå®ƒåŒ…å« name: string å’Œ id: numberï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const user &#x3D; &#123;  name: &quot;Hayes&quot;,  id: 0,&#125;;</code></pre><p>You can explicitly describe this objectâ€™s shape using an interface declaration:<br><code>ä½ å¯ä»¥ä½¿ç”¨æ¥å£å£°æ˜æ¥æ˜ç¡®åœ°æè¿°è¿™ä¸ªå¯¹è±¡çš„å½¢çŠ¶ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface User &#123;  name: string;  id: number;&#125;</code></pre><p>You can then declare that a JavaScript object conforms to the shape of your new interface by using syntax like : TypeName after a variable declaration:<br><code>ä½ å¯ä»¥ä½¿ç”¨ç±»å‹åç§°æ¥å‘Šè¯‰ JavaScript ä½ çš„å˜é‡æ˜¯å±äºå“ªä¸ªç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const user: User &#x3D; &#123;  name: &quot;Hayes&quot;,  id: 0,&#125;;</code></pre><p>If you provide an object that doesnâ€™t match the interface you have provided, TypeScript will warn you:<br><code>å¦‚æœä½ æä¾›çš„å¯¹è±¡ä¸ç¬¦åˆä½ æä¾›çš„æ¥å£ï¼ŒTypeScript å°±ä¼šè­¦å‘Šä½ ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface User &#123;  name: string;  id: number;&#125;const user: User &#x3D; &#123;  username: &quot;Hayes&quot;,  &#x2F;&#x2F; Type &#39;&#123; username: string; id: number; &#125;&#39; is not assignable to type &#39;User&#39;.  &#x2F;&#x2F; Object literal may only specify known properties, and &#39;username&#39; does not exist in type &#39;User&#39;.  id: 0,&#125;;</code></pre><p>Since JavaScript supports classes and object-oriented programming, so does TypeScript. You can use an interface declaration with classes:<br><code>å› ä¸º JavaScript æ”¯æŒç±»å’Œå¯¹è±¡-é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæ‰€ä»¥ TypeScript ä¹Ÿæ”¯æŒã€‚ä½ å¯ä»¥ä½¿ç”¨æ¥å£å£°æ˜ç±»ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface User &#123;  name: string;  id: number;&#125;class UserAccount &#123;  name: string;  id: number;  constructor(name: string, id: number) &#123;    this.name &#x3D; name;    this.id &#x3D; id;  &#125;&#125;const user: User &#x3D; new UserAccount(&quot;Murphy&quot;, 1);</code></pre><p>You can use interfaces to annotate parameters and return values to functions:<br><code>ä½ å¯ä»¥ä½¿ç”¨æ¥å£æ¥æ ‡æ³¨å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getAdminUser(): User &#123;  &#x2F;&#x2F;...&#125;function deleteUser(user: User) &#123;  &#x2F;&#x2F; ...&#125;</code></pre><p>There is already a small set of primitive types available in JavaScript: boolean, bigint, null, number, string, symbol, and undefined, which you can use in an interface. TypeScript extends this list with a few more, such as any (allow anything), unknown (ensure someone using this type declares what the type is), never (itâ€™s not possible that this type could happen), and void (a function which returns undefined or has no return value).<br><code>å·²ç»æœ‰ä¸€äº›ç®€å•çš„åŸå§‹ç±»å‹å¯ç”¨äº JavaScriptï¼šboolean, bigint, null, number, string, symbol, å’Œ undefinedï¼Œä½ å¯ä»¥åœ¨æ¥å£ä¸­ä½¿ç”¨å®ƒä»¬ã€‚TypeScript å°†è¿™äº›ç±»å‹æ‰©å±•äº†ä¸€äº›ï¼Œå¦‚ anyï¼ˆå…è®¸ä»»ä½•ä¸œè¥¿ï¼‰ï¼Œunknownï¼ˆç¡®ä¿ä½¿ç”¨è€…ä½¿ç”¨è¿™ä¸ªç±»å‹æ—¶å£°æ˜äº†å®ƒçš„ç±»å‹ï¼‰ï¼Œneverï¼ˆä¸å¯èƒ½å‘ç”Ÿçš„ç±»å‹ï¼‰ï¼Œå’Œ voidï¼ˆå‡½æ•°è¿”å› undefined æˆ–æ²¡æœ‰è¿”å›å€¼ï¼‰ã€‚</code></p><p>Youâ€™ll see that there are two syntaxes for building types: Interfaces and Types. You should prefer interface. Use type when you need specific features.<br><code>ä½ ä¼šçœ‹åˆ°æœ‰ä¸¤ç§ç¼–å†™ç±»å‹çš„è¯­æ³•ï¼šæ¥å£å’Œç±»å‹ã€‚å½“ä½ éœ€è¦ç‰¹å®šçš„åŠŸèƒ½æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨æ¥å£ã€‚ä½¿ç”¨ç±»å‹æ—¶ï¼Œä½ éœ€è¦ç‰¹å®šçš„åŠŸèƒ½ã€‚</code></p><h3 id="Composing-Types"><a href="#Composing-Types" class="headerlink" title="Composing Types"></a>Composing Types</h3><p><code>ç»„åˆç±»å‹</code><br>With TypeScript, you can create complex types by combining simple ones. There are two popular ways to do so: with unions, and with generics.<br><code>é€šè¿‡ä½¿ç”¨è”åˆç±»å‹ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨æ³›å‹æ¥ç»„åˆå¤æ‚çš„ç±»å‹ã€‚</code></p><h3 id="Unions"><a href="#Unions" class="headerlink" title="Unions"></a>Unions</h3><p><code>è”åˆç±»å‹</code><br>With a union, you can declare that a type could be one of many types. For example, you can describe a boolean type as being either true or false:<br><code>é€šè¿‡ä½¿ç”¨è”åˆç±»å‹ï¼Œä½ å¯ä»¥å£°æ˜ä¸€ä¸ªç±»å‹æ˜¯å¯èƒ½æ˜¯ true æˆ– false çš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type MyBool &#x3D; true | false;</code></pre><p>Note: If you hover over MyBool above, youâ€™ll see that it is classed as boolean. Thatâ€™s a property of the Structural Type System. More on this below.<br><code>è¯·æ³¨æ„ï¼Œå¦‚æœä½ å°†é¼ æ ‡ç§»åˆ° MyBool ä¸Šï¼Œä½ ä¼šçœ‹åˆ°å®ƒæ˜¯ä¸€ä¸ª boolean ç±»å‹ã€‚è¿™æ˜¯ç»“æ„ç±»å‹ç³»ç»Ÿçš„ä¸€ä¸ªå±æ€§ã€‚æ›´å¤šå†…å®¹åœ¨ä¸‹é¢ã€‚</code><br>A popular use-case for union types is to describe the set of string or number literals that a value is allowed to be:<br><code>è”åˆç±»å‹çš„ä¸€ä¸ªå¸¸è§ç”¨ä¾‹æ˜¯æè¿°ä¸€ä¸ªå€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—çš„é›†åˆï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type WindowStates &#x3D; &quot;open&quot; | &quot;closed&quot; | &quot;minimized&quot;;type LockStates &#x3D; &quot;locked&quot; | &quot;unlocked&quot;;type PositiveOddNumbersUnderTen &#x3D; 1 | 3 | 5 | 7 | 9;</code></pre><p>Unions provide a way to handle different types too. For example, you may have a function that takes an array or a string:<br><code>è”åˆç±»å‹å¯ä»¥ç”¨æ¥å¤„ç†ä¸åŒç±»å‹çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„æˆ–å­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getLength(obj: string | string[]) &#123;  return obj.length;&#125;</code></pre><p>To learn the type of a variable, use typeof:<br><code>ä½¿ç”¨ typeof æ¥æŸ¥çœ‹ä¸€ä¸ªå˜é‡çš„ç±»å‹ï¼š</code></p><h3 id="Type-Predicate"><a href="#Type-Predicate" class="headerlink" title="Type Predicate"></a>Type Predicate</h3><p><code>ç±»å‹æ–­è¨€</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">string typeof s &#x3D;&#x3D;&#x3D; &quot;string&quot;number typeof n &#x3D;&#x3D;&#x3D; &quot;number&quot;boolean typeof b &#x3D;&#x3D;&#x3D; &quot;boolean&quot;undefined typeof undefined &#x3D;&#x3D;&#x3D; &quot;undefined&quot;function typeof f &#x3D;&#x3D;&#x3D; &quot;function&quot;array Array.isArray(a)</code></pre><p>For example, you can make a function return different values depending on whether it is passed a string or an array:<br><code>ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç”¨æ¥è¿”å›ä¸åŒçš„å€¼ï¼Œæ ¹æ®ä¼ å…¥çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯æ•°ç»„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function wrapInArray(obj: string | string[]) &#123;  if (typeof obj &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    return [obj];    (parameter) obj: string  &#125;  return obj;&#125;</code></pre><h3 id="Generics"><a href="#Generics" class="headerlink" title="Generics"></a>Generics</h3><p><code>æ³›å‹</code></p><p>Generics provide variables to types. A common example is an array. An array without generics could contain anything. An array with generics can describe the values that the array contains.<br><code>æ³›å‹å¯ä»¥æä¾›ç±»å‹å˜é‡ã€‚ä¾‹å¦‚ï¼Œæ•°ç»„ã€‚æ•°ç»„æ²¡æœ‰æ³›å‹å¯ä»¥åŒ…å«ä»»ä½•ä¸œè¥¿ã€‚æ•°ç»„æœ‰æ³›å‹å¯ä»¥æè¿°æ•°ç»„ä¸­åŒ…å«çš„å€¼ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type StringArray &#x3D; Array&lt;string&gt;;type NumberArray &#x3D; Array&lt;number&gt;;type ObjectWithNameArray &#x3D; Array&lt;&#123; name: string &#125;&gt;;You can declare your own types that use generics:</code></pre><p><code>ä½ å¯ä»¥å£°æ˜è‡ªå·±çš„ç±»å‹ï¼Œä½¿ç”¨æ³›å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Backpack&lt;Type&gt; &#123;  add: (obj: Type) &#x3D;&gt; void;  get: () &#x3D;&gt; Type;&#125;&#x2F;&#x2F; This line is a shortcut to tell TypeScript there is a&#x2F;&#x2F; constant called &#96;backpack&#96;, and to not worry about where it came from.declare const backpack: Backpack&lt;string&gt;;&#x2F;&#x2F; object is a string, because we declared it above as the variable part of Backpack.const object &#x3D; backpack.get();&#x2F;&#x2F; Since the backpack variable is a string, you can&#39;t pass a number to the add function.backpack.add(23);Argument of type &#39;number&#39; is not assignable to parameter of type &#39;string&#39;.</code></pre><h3 id="Structural-Type-System"><a href="#Structural-Type-System" class="headerlink" title="Structural Type System"></a>Structural Type System</h3><p><code>ç»“æ„ç±»å‹ç³»ç»Ÿ</code></p><p>One of TypeScriptâ€™s core principles is that type checking focuses on the shape that values have. This is sometimes called â€œduck typingâ€ or â€œstructural typingâ€.<br><code>ç»“æ„ç±»å‹ç³»ç»Ÿçš„ä¸€ä¸ªæ ¸å¿ƒåŸåˆ™æ˜¯ï¼Œç±»å‹æ£€æŸ¥åªå…³æ³¨å€¼çš„å½¢çŠ¶ã€‚è¿™ç§°ä¸ºâ€œé¸­å­ç±»å‹â€æˆ–â€œç»“æ„ç±»å‹â€ã€‚</code><br>In a structural type system, if two objects have the same shape, they are considered to be of the same type.<br><code>åœ¨ç»“æ„ç±»å‹ç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡å…·æœ‰ç›¸åŒçš„å½¢çŠ¶ï¼Œåˆ™è¢«è§†ä¸ºç›¸åŒçš„ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Point &#123;  x: number;  y: number;&#125;function logPoint(p: Point) &#123;  console.log(&#96;$&#123;p.x&#125;, $&#123;p.y&#125;&#96;);&#125;&#x2F;&#x2F; logs &quot;12, 26&quot;const point &#x3D; &#123; x: 12, y: 26 &#125;;logPoint(point);</code></pre><p>The point variable is never declared to be a Point type. However, TypeScript compares the shape of point to the shape of Point in the type-check. They have the same shape, so the code passes.<br><code>point å˜é‡æ²¡æœ‰è¢«å£°æ˜ä¸º Point ç±»å‹ã€‚ä½†æ˜¯ï¼ŒTypeScript å¯¹æ¯” point å’Œ Point çš„å½¢çŠ¶ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„å½¢çŠ¶ï¼Œæ‰€ä»¥ä»£ç é€šè¿‡ã€‚</code><br>The shape-matching only requires a subset of the objectâ€™s fields to match.<br><code>ç»“æ„ç±»å‹ç³»ç»Ÿåªéœ€è¦å¯¹è±¡çš„ä¸€éƒ¨åˆ†å­—æ®µåŒ¹é…ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const point3 &#x3D; &#123; x: 12, y: 26, z: 89 &#125;;logPoint(point3); &#x2F;&#x2F; logs &quot;12, 26&quot;const rect &#x3D; &#123; x: 33, y: 3, width: 30, height: 80 &#125;;logPoint(rect); &#x2F;&#x2F; logs &quot;33, 3&quot;const color &#x3D; &#123; hex: &quot;#187ABF&quot; &#125;;logPoint(color);&#x2F;&#x2F; Argument of type &#39;&#123; hex: string; &#125;&#39; is not assignable to parameter of type &#39;Point&#39;.&#x2F;&#x2F; Type &#39;&#123; hex: string; &#125;&#39; is missing the following properties from type &#39;Point&#39;: x, y</code></pre><p>There is no difference between how classes and objects conform to shapes:<br><code>ç±»å’Œå¯¹è±¡éƒ½éµå¾ªç»“æ„ç±»å‹ç³»ç»Ÿã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">class VirtualPoint &#123;  x: number;  y: number;  constructor(x: number, y: number) &#123;    this.x &#x3D; x;    this.y &#x3D; y;  &#125;&#125;const newVPoint &#x3D; new VirtualPoint(13, 56);logPoint(newVPoint); &#x2F;&#x2F; logs &quot;13, 56&quot;</code></pre><p>If the object or class has all the required properties, TypeScript will say they match, regardless of the implementation details.<br><code>å¦‚æœå¯¹è±¡æˆ–ç±»æœ‰æ‰€æœ‰å¿…è¦çš„å±æ€§ï¼ŒTypeScriptå°†è®¤ä¸ºå®ƒä»¬åŒ¹é…ï¼Œæ— è®ºå®ç°ç»†èŠ‚ã€‚</code></p><h3 id="Next-Steps-1"><a href="#Next-Steps-1" class="headerlink" title="Next Steps"></a>Next Steps</h3><p><code>ä¸‹ä¸€æ­¥</code><br>This was a brief overview of the syntax and tools used in everyday TypeScript. From here, you can:<br><code>ä»è¿™é‡Œå¼€å§‹ï¼Œä½ å¯ä»¥ï¼š</code><br>Read the full Handbook from start to finish (30m)<br><code>é˜…è¯»å®Œæ•´æ‰‹å†Œï¼ˆ30åˆ†é’Ÿï¼‰</code><br>Explore the Playground examples<br><code>æ¢ç´¢ Playground ç¤ºä¾‹</code></p><h2 id="Java-x2F-C-å¼€å‘"><a href="#Java-x2F-C-å¼€å‘" class="headerlink" title="Java&#x2F;C#å¼€å‘"></a>Java&#x2F;C#å¼€å‘</h2><p>è™½ç„¶ Java&#x2F;C#ä¹Ÿæ¥è§¦è¿‡ï¼Œä½†è¿™ä¸æ˜¯æˆ‘æœ¬æ¬¡çš„é‡ç‚¹ï¼Œä¹‹åä¼šè¡¥ä¸Š</p><h2 id="å‡½æ•°å¼ç¼–ç¨‹äººå‘˜"><a href="#å‡½æ•°å¼ç¼–ç¨‹äººå‘˜" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹äººå‘˜"></a>å‡½æ•°å¼ç¼–ç¨‹äººå‘˜</h2><p>TypeScript began its life as an attempt to bring traditional object-oriented types to JavaScript so that the programmers at Microsoft could bring traditional object-oriented programs to the web. As it has developed, TypeScriptâ€™s type system has evolved to model code written by native JavaScripters. The resulting system is powerful, interesting and messy.<br><code>TypeScript å¼€å§‹äºä¸€ä¸ªå°è¯•ï¼Œå°†ä¼ ç»Ÿå¯¹è±¡-å¯¹è±¡ç±»å‹çš„ç¼–ç¨‹è¯­è¨€è½¬æ¢ä¸º JavaScriptï¼Œè¿™æ ·çš„ç¼–ç¨‹äººå‘˜å¯ä»¥å°†ä¼ ç»Ÿçš„å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ç¨‹åºè½¬æ¢ä¸º Web ç«¯çš„ç¨‹åºã€‚</code><br>This introduction is designed for working Haskell or ML programmers who want to learn TypeScript. It describes how the type system of TypeScript differs from Haskellâ€™s type system. It also describes unique features of TypeScriptâ€™s type system that arise from its modelling of JavaScript code.<br><code>è¿™ä¸ªä»‹ç»æ˜¯ä¸ºäº†å·¥ä½œ Haskell æˆ– ML ç¨‹åºå‘˜è€Œè®¾è®¡çš„ï¼Œå®ƒæè¿°äº† TypeScript çš„ç±»å‹ç³»ç»Ÿä¸ Haskell çš„ç±»å‹ç³»ç»Ÿä¹‹é—´çš„ä¸åŒã€‚</code><br>This introduction does not cover object-oriented programming. In practice, object-oriented programs in TypeScript are similar to those in other popular languages with OO features.<br><code>è¿™ä¸ªä»‹ç»ä¸ä¼šè®²åˆ°å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ã€‚å®é™…ä¸Šï¼Œåœ¨ TypeScript ä¸­çš„å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ç¨‹åºä¸å…¶ä»–æµè¡Œè¯­è¨€çš„å¯¹è±¡-å¯¹è±¡ç¼–ç¨‹ç¨‹åºç›¸ä¼¼ã€‚</code></p><h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><p><code>å…ˆå†³æ¡ä»¶</code><br>In this introduction, I assume you know the following:<br><code>åœ¨è¿™ä¸ªä»‹ç»ä¸­ï¼Œæˆ‘å‡è®¾ä½ çŸ¥é“äº†ä»¥ä¸‹å†…å®¹ï¼š</code><br>How to program in JavaScript, the good parts.<br><code>å¦‚ä½•ç¼–å†™ JavaScript ç¨‹åºï¼Œå¥½çš„éƒ¨åˆ†ã€‚</code><br>Type syntax of a C-descended language.<br><code>C-descended è¯­è¨€çš„ç±»å‹è¯­æ³•ã€‚</code><br>If you need to learn the good parts of JavaScript, read JavaScript: The Good Parts. You may be able to skip the book if you know how to write programs in a call-by-value lexically scoped language with lots of mutability and not much else. R4RS Scheme is a good example.<br><code>å¦‚æœä½ éœ€è¦å­¦ä¹  JavaScriptï¼Œè¯·é˜…è¯» JavaScriptï¼šThe Good Partsã€‚å¦‚æœä½ çŸ¥é“å¦‚ä½•ç¼–å†™åŸºäºå€¼è¯æ³•çš„è¯æ³•ä½œç”¨åŸŸè¯­è¨€ï¼Œå¹¶ä¸”æ‹¥æœ‰å¤§é‡å¯å˜æ€§å’Œä¸å¤šçš„å…¶ä»–ç‰¹æ€§ï¼Œä½ å¯ä»¥è·³è¿‡è¿™æœ¬ä¹¦ã€‚R4RS Scheme æ˜¯ä¸€ä¸ªå¥½ä¾‹å­ã€‚</code><br>The C++ Programming Language is a good place to learn about C-style type syntax. Unlike C++, TypeScript uses postfix types, like so: x: string instead of string x.<br><code>C++ ç¼–ç¨‹è¯­è¨€æ˜¯ä¸€ä¸ªå¥½çš„åœ°æ–¹å­¦ä¹  C-style ç±»å‹è¯­æ³•ã€‚</code></p><h3 id="Concepts-not-in-Haskell"><a href="#Concepts-not-in-Haskell" class="headerlink" title="Concepts not in Haskell"></a>Concepts not in Haskell</h3><p><code>åœ¨ Haskell ä¸­ä¸å­˜åœ¨çš„æ¦‚å¿µ</code></p><h3 id="Built-in-types"><a href="#Built-in-types" class="headerlink" title="Built-in types"></a>Built-in types</h3><p><code>å†…ç½®ç±»å‹</code><br>JavaScript defines 8 built-in types:<br><code>JavaScript å®šä¹‰äº† 8 ä¸ªå†…ç½®ç±»å‹ï¼š</code> <strong>è¿™é‡Œæ˜¯åŒ…è£…ç±»å‹</strong><br>Type Explanation<br><code>ç±»å‹è¯´æ˜</code><br>Number a double-precision IEEE 754 floating point.<br><code>æ•°å­—ï¼ŒåŒç²¾åº¦ IEEE 754 æµ®ç‚¹æ•°ã€‚</code><br>String an immutable UTF-16 string.<br><code>å­—ç¬¦ä¸²ï¼Œä¸å¯å˜çš„ UTF-16 å­—ç¬¦ä¸²ã€‚</code><br>BigInt integers in the arbitrary precision format.<br><code>å¤§æ•´æ•°ï¼Œä»»æ„ç²¾åº¦æ ¼å¼ã€‚</code><br>Boolean true and false.<br><code>å¸ƒå°”å€¼ï¼Œtrue å’Œ falseã€‚</code><br>Symbol a unique value usually used as a key.<br><code>ç¬¦å·ï¼Œé€šå¸¸ç”¨ä½œé”®ã€‚</code><br>Null equivalent to the unit type.<br><code>ç©ºï¼Œç­‰åŒäºå•å…ƒç±»å‹ã€‚</code><br>Undefined also equivalent to the unit type.<br><code>æœªå®šä¹‰ï¼Œä¹Ÿç­‰åŒäºå•å…ƒç±»å‹ã€‚</code><br>Object similar to records.<br><code>å¯¹è±¡ï¼Œç±»ä¼¼äºè®°å½•ã€‚</code><br>See the MDN page for more detail.<br><code>å‚è§ MDN é¡µé¢ã€‚</code></p><p>TypeScript has corresponding primitive types for the built-in types:<br><code>TypeScript æœ‰å¯¹åº”çš„å†…ç½®ç±»å‹çš„åŸå§‹ç±»å‹ï¼š</code><br>number<br>string<br>bigint<br>boolean<br>symbol<br>null<br>undefined<br>object</p><h3 id="Other-important-TypeScript-types"><a href="#Other-important-TypeScript-types" class="headerlink" title="Other important TypeScript types"></a>Other important TypeScript types</h3><p><code>å…¶ä»–é‡è¦çš„ TypeScript ç±»å‹</code><br>Type Explanation<br><code>ç±»å‹è¯´æ˜</code><br>unknown the top type.<br><code>æœªçŸ¥ç±»å‹ï¼Œé¡¶çº§ç±»å‹ã€‚</code><br>never the bottom type.<br><code>æ°¸è¿œä¸ä¼šæ˜¯ç±»å‹ï¼Œåº•çº§ç±»å‹ã€‚</code><br>object literal eg { property: Type }<br><code>å¯¹è±¡å­—é¢é‡ï¼Œä¾‹å¦‚ &#123; property: ç±»å‹ &#125;ã€‚</code><br>void a subtype of undefined intended for use as a return type.<br><code>void ç±»å‹ï¼Œä½œä¸ºè¿”å›ç±»å‹ã€‚</code><br>T[] mutable arrays, also written Array<T><br><code>T[] å¯å˜æ•°ç»„ï¼Œä¹Ÿç§°ä¸º Array&lt;T&gt;ã€‚</code><br>[T, T] tuples, which are fixed-length but mutable<br><code>[T, T] å…ƒç»„ï¼Œå›ºå®šé•¿åº¦ä½†å¯å˜ã€‚</code><br>(t: T) &#x3D;&gt; U functions<br><code>(t: T) =&gt; U å‡½æ•°ã€‚</code><br>Notes:<br><code>æ³¨æ„ï¼š</code><br>Function syntax includes parameter names. This is pretty hard to get used to!<br><code>å‡½æ•°è¯­æ³•åŒ…æ‹¬å‚æ•°åã€‚è¿™å¾ˆéš¾ä½¿ç”¨ï¼</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let fst: (a: any, b: any) &#x3D;&gt; any &#x3D; (a, b) &#x3D;&gt; a;&#x2F;&#x2F; or more precisely: æˆ–è€…æ›´å‡†ç¡®åœ°ï¼šlet fst: &lt;T, U&gt;(a: T, b: U) &#x3D;&gt; T &#x3D; (a, b) &#x3D;&gt; a;&#x2F;&#x2F; Object literal type syntax closely mirrors object literal value syntax:&#x2F;&#x2F; æ¨¡å¼åŒ¹é…å­—é¢é‡ç±»å‹è¯­æ³•ä¸å¯¹è±¡å­—é¢é‡å€¼è¯­æ³•ç±»ä¼¼ã€‚let o: &#123; n: number; xs: object[] &#125; &#x3D; &#123; n: 1, xs: [] &#125;;[T, T] is a subtype of T[].&#x2F;&#x2F; This is different than Haskell, where tuples are not related to lists.&#x2F;&#x2F; æ­¤å¤–ï¼Œè¿™æ˜¯ä¸åŒäº Haskell çš„ï¼Œå…ƒç»„ä¸å’Œåˆ—è¡¨ç›¸å…³ã€‚</code></pre><h3 id="Boxed-types"><a href="#Boxed-types" class="headerlink" title="Boxed types"></a>Boxed types</h3><p><code>åŒ…è£…ç±»å‹</code><br>JavaScript has boxed equivalents of primitive types that contain the methods that programmers associate with those types. TypeScript reflects this with, for example, the difference between the primitive type number and the boxed type Number. The boxed types are rarely needed, since their methods return primitives.<br><code>JavaScript æœ‰å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼ŒåŒ…å«ä¸è¿™äº›ç±»å‹ç›¸å…³çš„æ–¹æ³•ã€‚</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">(1).toExponential();&#x2F;&#x2F; equivalent toNumber.prototype.toExponential.call(1);</code></pre><p>Note that calling a method on a numeric literal requires it to be in parentheses to aid the parser.<br><code>è°ƒç”¨æ–¹æ³•åœ¨æ•°å­—å­—é¢é‡ä¸Šéœ€è¦åœ¨æ‹¬å·ä¸­ï¼Œä»¥å¸®åŠ©è§£æå™¨ã€‚</code></p><h3 id="Gradual-typing"><a href="#Gradual-typing" class="headerlink" title="Gradual typing"></a>Gradual typing</h3><p><code>æ¸è¿›ç±»å‹</code><br>TypeScript uses the type any whenever it canâ€™t tell what the type of an expression should be. Compared to Dynamic, calling any a type is an overstatement. It just turns off the type checker wherever it appears. For example, you can push any value into an any[] without marking the value in any way:<br><code>TypeScript ä½¿ç”¨ any æ—¶ï¼Œå½“å®ƒä¸èƒ½ç¡®å®šè¡¨è¾¾å¼çš„ç±»å‹æ—¶ã€‚</code><br>&#x2F;&#x2F; with â€œnoImplicitAnyâ€: false in tsconfig.json, anys: any[]<br><code>åœ¨ tsconfig.json ä¸­ï¼ŒåŠ å…¥ &quot;noImplicitAny&quot;: false å¯ä»¥ç¦ç”¨ anys: any[]ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const anys &#x3D; [];anys.push(1);anys.push(&quot;oh no&quot;);anys.push(&#123; anything: &quot;goes&quot; &#125;);</code></pre><p>And you can use an expression of type any anywhere:<br><code>ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ any ç±»å‹è¡¨è¾¾å¼ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">anys.map(anys[1]); &#x2F;&#x2F; oh no, &quot;oh no&quot; is not a function</code></pre><p>any is contagious, too â€” if you initialize a variable with an expression of type any, the variable has type any too.<br><code>any ç±»å‹æ˜¯ä¼ æ’­çš„ï¼Œ</code> å¦‚æœåˆå§‹åŒ–ä¸€ä¸ªå˜é‡ä¸º any ç±»å‹ï¼Œå˜é‡çš„ç±»å‹ä¹Ÿæ˜¯ anyã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let sepsis &#x3D; anys[0] + anys[1]; &#x2F;&#x2F; this could mean anything</code></pre><p>To get an error when TypeScript produces an any, use â€œnoImplicitAnyâ€: true, or â€œstrictâ€: true in tsconfig.json.<br><code>ä¸ºäº†åœ¨ TypeScript ç”Ÿæˆ any æ—¶å¾—åˆ°é”™è¯¯æç¤ºï¼Œä½¿ç”¨ &quot;noImplicitAny&quot;: true æˆ– &quot;strict&quot;: true åœ¨ tsconfig.json ä¸­ã€‚</code></p><h3 id="Structural-typing"><a href="#Structural-typing" class="headerlink" title="Structural typing"></a>Structural typing</h3><p><code>ç»“æ„ç±»å‹</code><br>Structural typing is a familiar concept to most functional programmers, although Haskell and most MLs are not structurally typed. Its basic form is pretty simple:<br><code>ç»“æ„æ€§ç±»å‹æ˜¯å¤§å¤šæ•°å‡½æ•°ç¼–ç¨‹ç¨‹åºå‘˜ç†Ÿæ‚‰çš„æ¦‚å¿µï¼Œå°½ç®¡ Haskell å’Œå¤§å¤šæ•° ML ä¸æ˜¯ç»“æ„æ€§ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @strict: falselet o &#x3D; &#123; x: &quot;hi&quot;, extra: 1 &#125;; &#x2F;&#x2F; oklet o2: &#123; x: string &#125; &#x3D; o; &#x2F;&#x2F; ok</code></pre><p>Here, the object literal { x: â€œhiâ€, extra: 1 } has a matching literal type { x: string, extra: number }. That type is assignable to { x: string } since it has all the required properties and those properties have assignable types. The extra property doesnâ€™t prevent assignment, it just makes it a subtype of { x: string }.<br><code>è¿™é‡Œï¼Œå¯¹è±¡å­—é¢é‡ &#123; x: &quot;hi&quot;, extra: 1 &#125; æœ‰ä¸€ä¸ªåŒ¹é…çš„å­—é¢é‡ç±»å‹ &#123; x: string, extra: number &#125;ã€‚</code><br>Named types just give a name to a type; for assignability purposes thereâ€™s no difference between the type alias One and the interface type Two below. They both have a property p: string. (Type aliases behave differently from interfaces with respect to recursive definitions and type parameters, however.)<br><code>å‘½åç±»å‹åªæ˜¯ç»™ä¸€ä¸ªç±»å‹å‘½åï¼›ç”¨äºç±»å‹èµ‹å€¼çš„ç›®çš„ä¸åŒäºæ¥å£ä¸‹é¢çš„ç±»å‹åˆ«åå’Œç±»å‹å‚æ•°ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æœ‰å±æ€§ p: stringã€‚ (ç±»å‹åˆ«åå’Œæ¥å£çš„é€’å½’å®šä¹‰å’Œç±»å‹å‚æ•°æœ‰æ‰€ä¸åŒã€‚)</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type One &#x3D; &#123; p: string &#125;;interface Two &#123;  p: string;&#125;class Three &#123;  p &#x3D; &quot;Hello&quot;;&#125;let x: One &#x3D; &#123; p: &quot;hi&quot; &#125;;let two: Two &#x3D; x;two &#x3D; new Three();</code></pre><h3 id="Unions-1"><a href="#Unions-1" class="headerlink" title="Unions"></a>Unions</h3><p><code>è”åˆç±»å‹</code></p><p>In TypeScript, union types are untagged. In other words, they are not discriminated unions like data in Haskell. However, you can often discriminate types in a union using built-in tags or other properties.<br>åœ¨ TypeScript ä¸­ï¼Œè”åˆç±»å‹æ˜¯æ— æ ‡ç­¾çš„ã€‚<code> åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œè”åˆç±»å‹æ˜¯æ ‡ç­¾åŒ–çš„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function start(  arg: string | string[] | (() &#x3D;&gt; string) | &#123; s: string &#125;): string &#123;  &#x2F;&#x2F; this is super common in JavaScript  if (typeof arg &#x3D;&#x3D;&#x3D; &quot;string&quot;) &#123;    return commonCase(arg);  &#125; else if (Array.isArray(arg)) &#123;    return arg.map(commonCase).join(&quot;,&quot;);  &#125; else if (typeof arg &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;    return commonCase(arg());  &#125; else &#123;    return commonCase(arg.s);  &#125;  function commonCase(s: string): string &#123;    &#x2F;&#x2F; finally, just convert a string to another string    return s;  &#125;&#125;</code></pre><p>string, Array and Function have built-in type predicates, conveniently leaving the object type for the else branch. It is possible, however, to generate unions that are difficult to differentiate at runtime. For new code, itâ€™s best to build only discriminated unions.<br><code>å­—ç¬¦ä¸²ã€æ•°ç»„å’Œå‡½æ•°æœ‰å†…ç½®ç±»å‹æ¨æ–­ï¼Œ</code> å¯ä»¥åœ¨ else åˆ†æ”¯ä¸­æ¨æ–­å‡ºå¯¹è±¡ç±»å‹ã€‚<code>The following types have built-in predicates:</code>ä¸‹é¢çš„ç±»å‹æœ‰å†…ç½®æ¨æ–­ï¼š<code>Type Predicate</code>ç±»å‹æ¨æ–­&#96;</p><p>string typeof s &#x3D;&#x3D;&#x3D; â€œstringâ€<br>number typeof n &#x3D;&#x3D;&#x3D; â€œnumberâ€<br>bigint typeof m &#x3D;&#x3D;&#x3D; â€œbigintâ€<br>boolean typeof b &#x3D;&#x3D;&#x3D; â€œbooleanâ€<br>symbol typeof g &#x3D;&#x3D;&#x3D; â€œsymbolâ€<br>undefined typeof undefined &#x3D;&#x3D;&#x3D; â€œundefinedâ€<br>function typeof f &#x3D;&#x3D;&#x3D; â€œfunctionâ€<br>array Array.isArray(a)<br>object typeof o &#x3D;&#x3D;&#x3D; â€œobjectâ€</p><p>Note that functions and arrays are objects at runtime, but have their own predicates.<br><code>å‡½æ•°å’Œæ•°ç»„åœ¨è¿è¡Œæ—¶æ˜¯å¯¹è±¡ï¼Œ</code> ä½†æ˜¯æœ‰è‡ªå·±çš„æ¨æ–­ã€‚&#96;</p><h3 id="Intersections"><a href="#Intersections" class="headerlink" title="Intersections"></a>Intersections</h3><p><code>äº¤å‰ç±»å‹</code></p><p>In addition to unions, TypeScript also has intersections:<br><code>åœ¨ TypeScript ä¸­ï¼Œè¿˜æœ‰äº¤å‰ç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Combined &#x3D; &#123; a: number &#125; &amp; &#123; b: string &#125;;type Conflicting &#x3D; &#123; a: number &#125; &amp; &#123; a: string &#125;;</code></pre><p>Combined has two properties, a and b, just as if they had been written as one object literal type. Intersection and union are recursive in case of conflicts, so Conflicting.a: number &amp; string.<br><code>Combined æœ‰ä¸¤ä¸ªå±æ€§ï¼Œa å’Œ bï¼Œ å¦‚æœå†™æˆä¸€ä¸ªå¯¹è±¡å­—é¢é‡ç±»å‹ï¼Œ åˆ™ a å’Œ b éƒ½æ˜¯ number å’Œ string ç±»å‹ã€‚</code></p><h3 id="Unit-types"><a href="#Unit-types" class="headerlink" title="Unit types"></a>Unit types</h3><p><code>å•å…ƒç±»å‹</code><br>Unit types are subtypes of primitive types that contain exactly one primitive value. For example, the string â€œfooâ€ has the type â€œfooâ€. Since JavaScript has no built-in enums, it is common to use a set of well-known strings instead. Unions of string literal types allow TypeScript to type this pattern:<br><code>å•å…ƒç±»å‹æ˜¯åŸå§‹ç±»å‹çš„å­ç±»å‹ï¼Œ å®ƒä»¬åŒ…å«ä¸€ä¸ªåŸå§‹å€¼ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare function pad(s: string, n: number, direction: &quot;left&quot; | &quot;right&quot;): string;pad(&quot;hi&quot;, 10, &quot;left&quot;);</code></pre><p>When needed, the compiler widens â€” converts to a supertype â€” the unit type to the primitive type, such as â€œfooâ€ to string. This happens when using mutability, which can hamper some uses of mutable variables:<br><code>å½“éœ€è¦æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ‰©å±•ï¼Œ å°†å•å…ƒç±»å‹è½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œ ä¾‹å¦‚ &quot;foo&quot; è½¬æ¢ä¸º stringã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let s &#x3D; &quot;right&quot;;pad(&quot;hi&quot;, 10, s); &#x2F;&#x2F; error: &#39;string&#39; is not assignable to &#39;&quot;left&quot; | &quot;right&quot;&#39;Argument of type &#39;string&#39; is not assignable to parameter of type &#39;&quot;left&quot; | &quot;right&quot;&#39;.</code></pre><p>Hereâ€™s how the error happens:<br><code>è¿™é‡Œæœ‰ä¸€ä¸ªé”™è¯¯ï¼š</code><br>â€œrightâ€: â€œrightâ€</p><p>s: string because â€œrightâ€ widens to string on assignment to a mutable variable.<br>string is not assignable to â€œleftâ€ | â€œrightâ€</p><p>You can work around this with a type annotation for s, but that in turn prevents assignments to s of variables that are not of type â€œleftâ€ | â€œrightâ€.<br><code>ä½ å¯ä»¥ä½¿ç”¨ç±»å‹æ³¨è§£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ ä½†æ˜¯è¿™ä¼šå¯¼è‡´ s çš„èµ‹å€¼ï¼Œ åªèƒ½èµ‹å€¼ç»™ &quot;left&quot; | &quot;right&quot; ç±»å‹çš„å˜é‡ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let s: &quot;left&quot; | &quot;right&quot; &#x3D; &quot;right&quot;;pad(&quot;hi&quot;, 10, s);</code></pre><h3 id="Concepts-similar-to-Haskell"><a href="#Concepts-similar-to-Haskell" class="headerlink" title="Concepts similar to Haskell"></a>Concepts similar to Haskell</h3><p><code>ä¸ Haskell ç±»ä¼¼çš„æ¦‚å¿µ</code></p><h3 id="Contextual-typing"><a href="#Contextual-typing" class="headerlink" title="Contextual typing"></a>Contextual typing</h3><p><code>ä¸Šä¸‹æ–‡ç±»å‹</code></p><p>TypeScript has some obvious places where it can infer types, like variable declarations:<br><code>TypeScript æœ‰ä¸€äº›æ˜æ˜¾çš„åœ°æ–¹ï¼Œ å¯ä»¥æ¨æ–­ç±»å‹ï¼Œ å¦‚å˜é‡å£°æ˜ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let s &#x3D; &quot;I&#39;m a string!&quot;;</code></pre><p>But it also infers types in a few other places that you may not expect if youâ€™ve worked with other C-syntax languages:<br><code>TypeScript ä¹Ÿå¯ä»¥æ¨æ–­åœ¨æŸäº›åœ°æ–¹æ²¡æœ‰å£°æ˜ç±»å‹çš„æƒ…å†µä¸‹ï¼Œ å¦‚æœä½ å·²ç»ä½¿ç”¨å…¶ä»– C-è¯­è¨€è¯­æ³•ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare function map&lt;T, U&gt;(f: (t: T) &#x3D;&gt; U, ts: T[]): U[];let sns &#x3D; map((n) &#x3D;&gt; n.toString(), [1, 2, 3]);</code></pre><p>Here, n: number in this example also, despite the fact that T and U have not been inferred before the call. In fact, after [1,2,3] has been used to infer T&#x3D;number, the return type of n &#x3D;&gt; n.toString() is used to infer U&#x3D;string, causing sns to have the type string[].<br><code>è¿™é‡Œï¼Œ n: number åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¹Ÿï¼Œ å³ä½¿åœ¨è°ƒç”¨ä¹‹å‰æ²¡æœ‰æ¨æ–­ T å’Œ U çš„ç±»å‹ã€‚ åœ¨å®é™…ä¸Šï¼Œ åœ¨ [1,2,3] è¢«ç”¨æ¥æ¨æ–­ T=number çš„æ—¶å€™ï¼Œ n =&gt; n.toString() çš„è¿”å›ç±»å‹ä¼šè¢«ç”¨æ¥æ¨æ–­ U=stringï¼Œ å¯¼è‡´ sns çš„ç±»å‹ä¸º string[]ã€‚</code><br>Note that inference will work in any order, but intellisense will only work left-to-right, so TypeScript prefers to declare map with the array first:<br><code>æ³¨æ„ï¼Œ æ¨æ–­ä¼šå·¥ä½œåœ¨ä»»ä½•é¡ºåºï¼Œ ä½†æ˜¯ intellisense åªä¼šä»å·¦åˆ°å³ï¼Œ å› æ­¤ TypeScript åªä¼šä¼˜å…ˆå£°æ˜ map å‡½æ•°ï¼Œ å…ˆå£°æ˜æ•°ç»„ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare function map&lt;T, U&gt;(ts: T[], f: (t: T) &#x3D;&gt; U): U[];</code></pre><p>Contextual typing also works recursively through object literals, and on unit types that would otherwise be inferred as string or number. And it can infer return types from context:<br><code>ä¸Šä¸‹æ–‡ç±»å‹ä¹Ÿå¯ä»¥é€’å½’åœ°é€šè¿‡å¯¹è±¡å­—é¢é‡ï¼Œ å’Œå•å…ƒç±»å‹ï¼Œ å¦‚æœæ²¡æœ‰å£°æ˜ç±»å‹ï¼Œ åˆ™ä¼šè¢«æ¨æ–­ä¸º string æˆ– numberã€‚ å¹¶ä¸”å¯ä»¥ä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡½æ•°çš„è¿”å›ç±»å‹ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare function run&lt;T&gt;(thunk: (t: T) &#x3D;&gt; void): T;let i: &#123; inference: string &#125; &#x3D; run((o) &#x3D;&gt; &#123;  o.inference &#x3D; &quot;INSERT STATE HERE&quot;;&#125;);</code></pre><p>The type of o is determined to be { inference: string } because<br><code>è¿™ä¸ª o çš„ç±»å‹æ˜¯ç”± run å‡½æ•°çš„å‚æ•°ç±»å‹å†³å®šçš„ï¼Œ å› ä¸º</code><br>Declaration initializers are contextually typed by the declarationâ€™s type: { inference: string }.<br><code>å£°æ˜åˆå§‹å€¼æ˜¯ç”±å£°æ˜çš„ç±»å‹å†³å®šçš„</code><br>The return type of a call uses the contextual type for inferences, so the compiler infers that T&#x3D;{ inference: string }.<br><code>è°ƒç”¨çš„è¿”å›ç±»å‹æ˜¯ç”±ä¸Šä¸‹æ–‡ç±»å‹å†³å®šçš„ï¼Œ å› æ­¤ç¼–è¯‘å™¨ä¼šæ¨æ–­ T=&#123; inference: string &#125;ã€‚</code><br>Arrow functions use the contextual type to type their parameters, so the compiler gives o: { inference: string }.<br><code>ç®­å¤´å‡½æ•°ä½¿ç”¨ä¸Šä¸‹æ–‡ç±»å‹æ¥ç±»å‹å‚æ•°ï¼Œ å› æ­¤ç¼–è¯‘å™¨ä¼šç»™ o: &#123; inference: string &#125;ã€‚</code><br>And it does so while you are typing, so that after typing o., you get completions for the property inference, along with any other properties youâ€™d have in a real program.<br><code>è€Œä¸”è¿™æ ·ï¼Œ åœ¨ä½ è¾“å…¥ o. çš„æ—¶å€™ï¼Œ ä½ ä¼šå¾—åˆ° inference çš„å±æ€§çš„å®Œæ•´è¡¥å…¨ï¼Œ åŒæ—¶ä¹Ÿä¼šæœ‰å…¶ä»–å®é™…ç¨‹åºä¸­çš„å±æ€§ã€‚</code><br>Altogether, this feature can make TypeScriptâ€™s inference look a bit like a unifying type inference engine, but it is not.<br><code>è¿™ä¸ªåŠŸèƒ½å¯ä»¥è®© TypeScript çš„æ¨æ–­çœ‹èµ·æ¥åƒä¸€ä¸ªç»Ÿä¸€ç±»å‹æ¨æ–­å¼•æ“ï¼Œ ä½†æ˜¯å®ƒä¸æ˜¯ã€‚</code></p><h3 id="Type-aliases"><a href="#Type-aliases" class="headerlink" title="Type aliases"></a>Type aliases</h3><p><code>ç±»å‹åˆ«å</code></p><p>Type aliases are mere aliases, just like type in Haskell. The compiler will attempt to use the alias name wherever it was used in the source code, but does not always succeed.<br><code>ç±»å‹åˆ«åæ˜¯ç±»å‹åˆ«åï¼Œ åƒ Haskell ä¸­çš„ç±»å‹ã€‚ ç¼–è¯‘å™¨ä¼šå°è¯•ä½¿ç”¨åˆ«ååç§°åœ¨æºä»£ç ä¸­ä½¿ç”¨ï¼Œ ä½†ä¸ä¸€å®šæˆåŠŸã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Size &#x3D; [number, number];let x: Size &#x3D; [101.1, 999.9];</code></pre><p>The closest equivalent to newtype is a tagged intersection:<br><code>æœ€æ¥è¿‘çš„ç­‰ä»·æ˜¯æ ‡è®°äº¤é›†ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type FString &#x3D; string &amp; &#123; **compileTimeOnly: any &#125;;</code></pre><p>An FString is just like a normal string, except that the compiler thinks it has a property named **compileTimeOnly that doesnâ€™t actually exist. This means that FString can still be assigned to string, but not the other way round.<br><code>FString æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸²ï¼Œ ä½†æ˜¯ç¼–è¯‘å™¨è®¤ä¸ºå®ƒæœ‰ä¸€ä¸ªåä¸º **compileTimeOnly çš„å±æ€§ï¼Œ è¿™ä¸ªå±æ€§å¹¶ä¸å­˜åœ¨ã€‚ è¿™æ„å‘³ç€ FString ä»ç„¶å¯ä»¥è¢«èµ‹å€¼ç»™ stringï¼Œ ä½†æ˜¯ä¸èƒ½è¢«èµ‹å€¼ç»™å…¶ä»–ç±»å‹ã€‚</code></p><h3 id="Discriminated-Unions"><a href="#Discriminated-Unions" class="headerlink" title="Discriminated Unions"></a>Discriminated Unions</h3><p><code>å¯è¯†åˆ«è”åˆ</code></p><p>The closest equivalent to data is a union of types with discriminant properties, normally called discriminated unions in TypeScript:<br><code>æœ€æ¥è¿‘çš„ç­‰ä»·æ˜¯æ•°æ®çš„ä¸€ä¸ªè”åˆç±»å‹ï¼Œ å¸¸è§çš„æ˜¯ TypeScript ä¸­çš„åˆ†å±‚è”åˆï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Shape &#x3D;  | &#123; kind: &quot;circle&quot;; radius: number &#125;  | &#123; kind: &quot;square&quot;; x: number &#125;  | &#123; kind: &quot;triangle&quot;; x: number; y: number &#125;;</code></pre><p>Unlike Haskell, the tag, or discriminant, is just a property in each object type. Each variant has an identical property with a different unit type. This is still a normal union type; the leading | is an optional part of the union type syntax. You can discriminate the members of the union using normal JavaScript code:<br><code>ä¸ Haskell ä¸åŒï¼Œ æ ‡è®°ï¼Œ æˆ–è€…è¯´åˆ†å±‚è”åˆçš„æ ‡è®°ï¼Œ åœ¨æ¯ä¸ªå¯¹è±¡ç±»å‹ä¸­éƒ½æ˜¯ä¸€ä¸ªå±æ€§ã€‚ æ¯ä¸ªå˜ä½“éƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„å±æ€§ï¼Œ å¹¶ä¸”å®ƒçš„å•å…ƒç±»å‹ä¸åŒã€‚ è¿™ä»ç„¶æ˜¯ä¸€ä¸ªè”åˆç±»å‹ï¼› å‰é¢çš„ | æ˜¯è”åˆç±»å‹çš„å¯é€‰éƒ¨åˆ†ã€‚ ä½ å¯ä»¥ä½¿ç”¨æ™®é€šçš„ JavaScript ä»£ç æ¥åŒºåˆ†è”åˆæˆå‘˜ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">type Shape &#x3D;| &#123; kind: &quot;circle&quot;; radius: number &#125;| &#123; kind: &quot;square&quot;; x: number &#125;| &#123; kind: &quot;triangle&quot;; x: number; y: number &#125;;function area(s: Shape) &#123;  if (s.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;    return Math.PI _ s.radius _ s.radius;  &#125; else if (s.kind &#x3D;&#x3D;&#x3D; &quot;square&quot;) &#123;    return s.x _ s.x;  &#125; else &#123;  r eturn (s.x _ s.y) &#x2F; 2;  &#125;&#125;</code></pre><p>Note that the return type of area is inferred to be number because TypeScript knows the function is total. If some variant is not covered, the return type of area will be number | undefined instead.<br><code>æ³¨æ„ï¼Œ area çš„è¿”å›ç±»å‹è¢«æ¨æ–­ä¸º numberï¼Œ å› ä¸º TypeScript çŸ¥é“å‡½æ•°æ˜¯å®Œå…¨çš„ã€‚ å¦‚æœæŸä¸ªå˜ä½“æ²¡æœ‰è¢«è¦†ç›–ï¼Œ area çš„è¿”å›ç±»å‹å°†ä¼šæ˜¯ number | undefinedã€‚</code><br>Also, unlike Haskell, common properties show up in any union, so you can usefully discriminate multiple members of the union:<br><code>ä¸ Haskell ä¸åŒï¼Œ å…±æœ‰å±æ€§åœ¨è”åˆä¸­æ˜¾ç¤ºï¼Œ ä½ å¯ä»¥ä½¿ç”¨æœ‰æ•ˆçš„æ–¹å¼æ¥åŒºåˆ†è”åˆæˆå‘˜ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function height(s: Shape) &#123;  if (s.kind &#x3D;&#x3D;&#x3D; &quot;circle&quot;) &#123;    return 2 \* s.radius;  &#125; else &#123;  &#x2F;&#x2F; s.kind: &quot;square&quot; | &quot;triangle&quot;    return s.x;  &#125;&#125;</code></pre><h3 id="Type-Parameters"><a href="#Type-Parameters" class="headerlink" title="Type Parameters"></a>Type Parameters</h3><p><code>å‚æ•°ç±»å‹</code><br>Like most C-descended languages, TypeScript requires declaration of type parameters:<br><code>ç±»ä¼¼äºå¤§å¤šæ•° C-descended è¯­è¨€ï¼Œ TypeScript éœ€è¦å£°æ˜ç±»å‹å‚æ•°ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function liftArray&lt;T&gt;(t: T): Array&lt;T&gt; &#123;  return [t];&#125;</code></pre><p>There is no case requirement, but type parameters are conventionally single uppercase letters. Type parameters can also be constrained to a type, which behaves a bit like type class constraints:<br><code>æ²¡æœ‰è¦æ±‚ï¼Œ ä½†æ˜¯ç±»å‹å‚æ•°æ˜¯ä¸€ä¸ªæƒ¯ä¾‹ï¼Œ å•å¤§å†™å­—æ¯ã€‚ ç±»å‹å‚æ•°å¯ä»¥è¢«é™åˆ¶ä¸ºä¸€ä¸ªç±»å‹ï¼Œ è¿™ä¸ªç±»å‹è¡Œä¸ºç±»ä¼¼äºç±»å‹çº¦æŸï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function firstish&lt;T extends &#123; length: number &#125;&gt;(t1: T, t2: T): T &#123;  return t1.length &gt; t2.length ? t1 : t2;&#125;</code></pre><p>TypeScript can usually infer type arguments from a call based on the type of the arguments, so type arguments are usually not needed.<br><code>TypeScript å¯ä»¥é€šè¿‡è°ƒç”¨å‚æ•°çš„ç±»å‹æ¨æ–­å‡ºç±»å‹å‚æ•°ï¼Œ å› æ­¤é€šå¸¸ä¸éœ€è¦æŒ‡å®šç±»å‹å‚æ•°ã€‚</code><br>Because TypeScript is structural, it doesnâ€™t need type parameters as much as nominal systems. Specifically, they are not needed to make a function polymorphic. Type parameters should only be used to propagate type information, such as constraining parameters to be the same type:<br><code>TypeScript æ˜¯ç»“æ„æ€§çš„ï¼Œ ä¸éœ€è¦ç±»å‹å‚æ•°ï¼Œ å› ä¸ºå®ƒä»¬ä¸éœ€è¦ä½¿ä¸€ä¸ªå‡½æ•°å¤šæ€ã€‚ ç±»å‹å‚æ•°åªæ˜¯ç”¨æ¥ä¼ é€’ç±»å‹ä¿¡æ¯ï¼Œ å¦‚é™åˆ¶å‚æ•°ä¸ºç›¸åŒç±»å‹ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function length&lt;T extends ArrayLike&lt;unknown&gt;&gt;(t: T): number &#123;&#125;function length(t: ArrayLike&lt;unknown&gt;): number &#123;&#125;</code></pre><p>In the first length, T is not necessary; notice that itâ€™s only referenced once, so itâ€™s not being used to constrain the type of the return value or other parameters.<br><code>åœ¨ç¬¬ä¸€ä¸ª lengthï¼Œ T æ²¡æœ‰å¿…è¦ï¼› å¯ä»¥æ³¨æ„ï¼Œ å®ƒåªè¢«å¼•ç”¨ä¸€æ¬¡ï¼Œ å› æ­¤å®ƒä¸ä¼šè¢«ç”¨æ¥é™åˆ¶è¿”å›å€¼æˆ–å…¶ä»–å‚æ•°çš„ç±»å‹ã€‚</code></p><h3 id="Higher-kinded-types"><a href="#Higher-kinded-types" class="headerlink" title="Higher-kinded types"></a>Higher-kinded types</h3><p><code>é«˜é˜¶ç±»å‹</code></p><p>TypeScript does not have higher kinded types, so the following is not legal:<br><code>TypeScript ä¸æ”¯æŒé«˜é˜¶ç±»å‹ï¼Œ å› æ­¤ä¸‹é¢çš„ä¸åˆæ³•ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function length&lt;T extends ArrayLike&lt;unknown&gt;, U&gt;(m: T&lt;U&gt;) &#123;&#125;</code></pre><h3 id="Point-free-programming"><a href="#Point-free-programming" class="headerlink" title="Point-free programming"></a>Point-free programming</h3><p>Point-free programming â€” heavy use of currying and function composition â€” is possible in JavaScript, but can be verbose. In TypeScript, type inference often fails for point-free programs, so youâ€™ll end up specifying type parameters instead of value parameters. The result is so verbose that itâ€™s usually better to avoid point-free programming.<br><code>ç‚¹-free ç¼–ç¨‹ â€” é‡é‡çº§çš„ä½¿ç”¨ curry å’Œå‡½æ•°ç»„åˆ â€” åœ¨ JavaScript ä¸­å¯ä»¥ï¼Œ ä½†æ˜¯å¯èƒ½ä¼šå¾ˆå¤šã€‚ åœ¨ TypeScript ä¸­ï¼Œ ç±»å‹æ¨æ–­å¯¹ç‚¹-free ç¼–ç¨‹å¤±è´¥ï¼Œ å› æ­¤ä½ ä¼šæŒ‡å®šç±»å‹å‚æ•°è€Œä¸æ˜¯å€¼å‚æ•°ã€‚ ç»“æœæ˜¯è¿™æ ·çš„å¤šï¼Œ å› æ­¤æ¯”è¾ƒé€‚åˆé¿å…ç‚¹-free ç¼–ç¨‹ã€‚</code></p><h3 id="Module-system"><a href="#Module-system" class="headerlink" title="Module system"></a>Module system</h3><p><code>æ¨¡å—ç³»ç»Ÿ</code></p><p>JavaScriptâ€™s modern module syntax is a bit like Haskellâ€™s, except that any file with import or export is implicitly a module:<br><code>JavaScript çš„ç°ä»£æ¨¡å—è¯­æ³•å’Œ Haskell ç±»ä¼¼ï¼Œ åªæ˜¯ä»»ä½•å¸¦æœ‰ import æˆ– export çš„æ–‡ä»¶éƒ½æ˜¯éšå¼çš„æ¨¡å—ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; value, Type &#125; from &quot;npm-package&quot;;import &#123; other, Types &#125; from &quot;.&#x2F;local-package&quot;;import \* as prefix from &quot;..&#x2F;lib&#x2F;third-package&quot;;</code></pre><p>You can also import commonjs modules â€” modules written using node.jsâ€™ module system:<br><code>ä½ ä¹Ÿå¯ä»¥å¯¼å…¥ commonjs æ¨¡å— â€” ä½¿ç”¨ node.js çš„æ¨¡å—ç³»ç»Ÿå†™çš„æ¨¡å—ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import f &#x3D; require(&quot;single-function-package&quot;);</code></pre><p>You can export with an export list:<br><code>ä½ å¯ä»¥ä½¿ç”¨ export åˆ—è¡¨å¯¼å‡ºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export &#123; f &#125;;function f() &#123;  return g();&#125;function g() &#123;&#125; &#x2F;&#x2F; g is not exported</code></pre><p>Or by marking each export individually:<br><code>æˆ–è€…é€šè¿‡å•ç‹¬æ ‡è®°æ¯ä¸ªå¯¼å‡ºï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function f &#123; return g() &#125;function g() &#123; &#125;</code></pre><p>The latter style is more common but both are allowed, even in the same file.<br><code>åè€…æ›´å¸¸è§ï¼Œ ä½†æ˜¯éƒ½å¯ä»¥ï¼Œ å³ä½¿åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</code></p><h3 id="readonly-and-const"><a href="#readonly-and-const" class="headerlink" title="readonly and const"></a>readonly and const</h3><p>In JavaScript, mutability is the default, although it allows variable declarations with const to declare that the reference is immutable. The referent is still mutable:<br><code>åœ¨ JavaScript ä¸­ï¼Œ å¯å˜æ€§æ˜¯é»˜è®¤çš„ï¼Œ å³ä½¿å®ƒå…è®¸ä½¿ç”¨ const å£°æ˜çš„å˜é‡å£°æ˜å¼•ç”¨æ˜¯ä¸å¯å˜çš„ã€‚ å¼•ç”¨ä»ç„¶å¯å˜ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const a &#x3D; [1, 2, 3];a.push(102); &#x2F;&#x2F; ):a[0] &#x3D; 101; &#x2F;&#x2F; D:</code></pre><p>TypeScript additionally has a readonly modifier for properties.<br><code>TypeScript è¿˜æœ‰ä¸€ä¸ª readonly å±æ€§ä¿®é¥°ç¬¦ã€‚</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface Rx &#123;  readonly x: number;&#125;let rx: Rx &#x3D; &#123; x: 1 &#125;;rx.x &#x3D; 12; &#x2F;&#x2F; error</code></pre><p>It also ships with a mapped type Readonly<T> that makes all properties readonly:<br><code>å®ƒè¿˜æœ‰ä¸€ä¸ªæ˜ å°„ç±»å‹ Readonly&lt;T&gt;ï¼Œ è®©æ‰€æœ‰å±æ€§éƒ½å˜æˆåªè¯»çš„ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">interface X &#123;  x: number;&#125;let rx: Readonly&lt;X&gt; &#x3D; &#123; x: 1 &#125;;rx.x &#x3D; 12; &#x2F;&#x2F; error</code></pre><p>And it has a specific ReadonlyArray<T> type that removes side-affecting methods and prevents writing to indices of the array, as well as special syntax for this type:<br><code>å®ƒè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ ReadonlyArray&lt;T&gt; ç±»å‹ï¼Œ å»é™¤äº†ä¾§å½±å“çš„æ–¹æ³•å’Œé˜²æ­¢å†™å…¥æ•°ç»„ç´¢å¼•ï¼Œ åŒæ—¶è¿˜æœ‰è¿™ç§ç±»å‹çš„ç‰¹æ®Šè¯­æ³•ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let a: ReadonlyArray&lt;number&gt; &#x3D; [1, 2, 3];let b: readonly number[] &#x3D; [1, 2, 3];a.push(102); &#x2F;&#x2F; errorb[0] &#x3D; 101; &#x2F;&#x2F; error</code></pre><p>You can also use a const-assertion, which operates on arrays and object literals:<br><code>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ const æ–­è¨€ï¼Œ å®ƒæ“ä½œäº†æ•°ç»„å’Œå¯¹è±¡å­—é¢é‡ï¼š</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">let a &#x3D; [1, 2, 3] as const;a.push(102); &#x2F;&#x2F; errora[0] &#x3D; 101; &#x2F;&#x2F; error</code></pre><p>However, none of these options are the default, so they are not consistently used in TypeScript code.<br><code>ä½†æ˜¯ï¼Œ æ²¡æœ‰è¿™äº›é€‰é¡¹æ˜¯é»˜è®¤çš„ï¼Œ å› æ­¤å®ƒä»¬ä¸æ˜¯ä¸€è‡´åœ°ä½¿ç”¨åœ¨ TypeScript ä»£ç ä¸­ã€‚</code></p><h3 id="Next-Steps-2"><a href="#Next-Steps-2" class="headerlink" title="Next Steps"></a>Next Steps</h3><p><code>ä¸‹ä¸€æ­¥</code></p><p>This doc is a high level overview of the syntax and types you would use in everyday code. From here you should:<br><code>æ­¤æ–‡æ¡£æ˜¯æ—¥å¸¸ä»£ç ä¸­çš„è¯­æ³•å’Œç±»å‹ä¸€ä¸ªé«˜çº§çš„æ¦‚è§ˆï¼Œ ä»è¿™é‡Œä½ åº”è¯¥ï¼š</code><br>Read the full Handbook from start to finish (30m)<br><code>é˜…è¯»å®Œæ•´çš„æ‰‹å†Œï¼ˆ30åˆ†é’Ÿï¼‰</code><br>Explore the Playground examples<br><code>æ¢ç´¢ Playground ç¤ºä¾‹</code></p><h2 id="5-åˆ†é’Ÿå†…äº†è§£-Typescript"><a href="#5-åˆ†é’Ÿå†…äº†è§£-Typescript" class="headerlink" title="5 åˆ†é’Ÿå†…äº†è§£ Typescript"></a>5 åˆ†é’Ÿå†…äº†è§£ Typescript</h2><p>è·³è¿‡ï¼Œè¿™éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œçœ‹åŸæ–‡å§ï¼Œä¹‹åé‡ç‚¹æ”¾åˆ°æ‰‹å†Œé‡Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-HTTPS</title>
      <link href="//post/2022-06-05https.html"/>
      <url>//post/2022-06-05https.html</url>
      
        <content type="html"><![CDATA[<h2 id="åæ§½æ˜é‡‘"><a href="#åæ§½æ˜é‡‘" class="headerlink" title="åæ§½æ˜é‡‘"></a>åæ§½æ˜é‡‘</h2><ul><li>åå°æœ‰å®šæ—¶å™¨åœ¨è¿è¡Œï¼Œä¸€ç›´å‘é€è¯·æ±‚ï¼Œæ‰“å¼€å¤šä¸ª web æ ‡ç­¾é¡µé¢ï¼Œcpu ç›´æ¥é£™å‡åˆ° 100% +ï¼Œé‰´äºæ˜é‡‘å¤ªå¡ï¼Œæ‰€ä»¥è½¬è½½</li></ul><h2 id="ä¸ºä»€ä¹ˆè¦æœ‰-HTTPS"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰-HTTPS" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰ HTTPS"></a>ä¸ºä»€ä¹ˆè¦æœ‰ HTTPS</h2><p>åœ¨ HTTPS å‡ºç°ä¹‹å‰ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ˜¯ä»¥æ˜æ–‡æ–¹å¼é€å‡ºçš„ï¼Œé‚£ä¹ˆå¦‚æœæœ‰äººåœ¨ä¼ è¾“é€”ä¸­å·å¬æˆ–è€…æŠ“åŒ…çš„è¯ï¼Œä½ çš„æ‰€æœ‰é€šä¿¡å†…å®¹éƒ½ä¼šæ³„æ¼ã€‚<br>æ¯”è¾ƒå®‰å…¨çš„æ–¹æ³•æ˜¯å°†é€šä¿¡å†…å®¹åŠ å¯†åœ¨å‘é€ç»™å¯¹æ–¹ã€‚åŠ å¯†æ–¹æ³•æœ‰ä¸¤ç§ï¼Œå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚</p><h2 id="å¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†</h2><ul><li>å¯¹ç§°åŠ å¯†æŒ‡çš„æ˜¯åŠ å¯†å’Œè§£å¯†ç”¨åŒä¸€ä¸ªå¯†é’¥ã€‚</li><li>ä½†æ˜¯åœ¨é€šä¿¡ä¹‹å‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯ä¸ä¼šæœ‰è¿™æ ·åŒä¸€æŠŠå¯†é’¥çš„ã€‚éœ€è¦å…¶ä¸­ä¸€æ–¹å°†å¯†é’¥å‘é€ç»™å¯¹æ–¹ã€‚</li><li>åœ¨æ•´ä¸ªä¼ è¾“è¿‡ç¨‹æ²¡æœ‰ä»»ä½•éªŒè¯æ“ä½œï¼Œæ‰€ä»¥é»‘å®¢ä¹Ÿå¯ä»¥æˆªå–åˆ°è¿™æŠŠå¯†é’¥ä»è€Œç ´è¯‘å‡ºåŠ å¯†çš„å†…å®¹ã€‚<br>æ‰€ä»¥çº¯å¯¹ç§°åŠ å¯†æ˜¯ä¸å®‰å…¨çš„ã€‚</li></ul><h2 id="éå¯¹ç§°åŠ å¯†"><a href="#éå¯¹ç§°åŠ å¯†" class="headerlink" title="éå¯¹ç§°åŠ å¯†"></a>éå¯¹ç§°åŠ å¯†</h2><p>éå¯¹ç§°åŠ å¯†æŒ‡çš„æ˜¯åŠ å¯†å’Œè§£å¯†ç”¨ä¸åŒçš„å¯†é’¥ã€‚å¯ä»¥æ˜¯ç”¨ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‚<br>ä½†æ˜¯ä¼šæœ‰è¿™ç§æƒ…å†µã€‚</p><ul><li>æœåŠ¡ç«¯æ‹¥æœ‰ç§é’¥å’Œå…¬é’¥ï¼Œå°†å…¬é’¥å‘ç»™å®¢æˆ·ç«¯ã€‚<br>æ—¢ç„¶å®¢æˆ·ç«¯å¯ä»¥è·å¾—å…¬é’¥ï¼Œé»‘å®¢ä¹Ÿå¯ä»¥è·å¾—å…¬é’¥ã€‚é‚£ä¹ˆæœåŠ¡ç«¯å‘é€ç»™å®¢æˆ·ç«¯çš„æ‰€æœ‰å†…å®¹é»‘å®¢ä¹Ÿæ˜¯å¯ä»¥è§£è¯»çš„ã€‚</li><li>å®¢æˆ·ç«¯ç”¨å…¬é’¥åŠ å¯†å‘é€ç»™æœåŠ¡ç«¯ä¸å—å½±å“ï¼Œå› ä¸ºé»‘å®¢æ‰‹ä¸Šæ²¡æœ‰æœåŠ¡å™¨çš„ç§é’¥ã€‚<br>æ‰€ä»¥çº¯éå¯¹ç§°åŠ å¯†ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ã€‚</li></ul><h2 id="ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹"><a href="#ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹" class="headerlink" title="ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹"></a>ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹</h2><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/15/17217c84d03a66a9~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp"></p><h2 id="å›¾è§£ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹"><a href="#å›¾è§£ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹" class="headerlink" title="å›¾è§£ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹"></a>å›¾è§£ä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹</h2><p>HTTPS é‡‡ç”¨å¯¹ç§°åŠ å¯†æ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Œæ‰€ç”¨çš„å¯†é’¥ç§°ä¸º Aã€‚ç”¨éå¯¹ç§°åŠ å¯†æ¥åŠ å¯†å¯†é’¥ A å†å‘é€ç»™å¯¹æ–¹ï¼ˆæœ‰ç‚¹ç»•ï¼‰ã€‚åªè¦å¯†é’¥ A ä¸è½å…¥ä»–äººæ‰‹ä¸­ï¼Œé‚£ä¼ è¾“çš„æ•°æ®å°±ä¸ä¼šè¢«åˆ«äººç ´è¯‘ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¦å¦‚ä½•å®‰å…¨çš„å°†è¿™æŠŠå¯†é’¥é€åˆ°å¯¹æ–¹æ‰‹ä¸Šå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ¥çœ‹å¯†é’¥çš„ä¼ è¾“è¿‡ç¨‹<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/15/17218630ec9be8b3~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp"></p><h2 id="ä¸ºä»€ä¹ˆ-HTTPS-æ˜¯å¯é çš„ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-HTTPS-æ˜¯å¯é çš„ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ HTTPS æ˜¯å¯é çš„ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ HTTPS æ˜¯å¯é çš„ï¼Ÿ</h2><p>HTTPS æ˜¯å¯é çš„ï¼Œå› ä¸ºå®ƒè§£å†³äº†ä¸‰ä¸ªé—®é¢˜ã€‚</p><ol><li>åŠ å¯†é€šä¿¡ï¼Œå³ä½¿åˆ«äººè·å–åˆ°äº†ä¿¡æ¯ä¹Ÿæ²¡æ³•å¤åŸæˆåŸæ¥çš„ä¿¡æ¯ã€‚</li><li>é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚é»‘å®¢æ²¡æ³•å†’å……æœåŠ¡ç«¯ã€‚å› ä¸ºåœ¨ç¬¬ 2 æ­¥ï¼ŒæœåŠ¡ç«¯ç»™äº†å®¢æˆ·ç«¯ä¸€ä¸ª CA è¯ä¹¦ã€‚</li></ol><ul><li>å¦‚æœå®¢æˆ·ç«¯éªŒè¯äº†è¿™ä¸ªè¯ä¹¦ï¼Œè¯´æ˜è¿™ä¸ªè¯ä¹¦å’Œå…¬é’¥æ˜¯ç”±æœåŠ¡ç«¯å‘æ¥çš„ä¸”çœŸå®å¯é ã€‚</li><li>å¦‚æœå®¢æˆ·ç«¯éªŒè¯ä¸äº†è¿™ä¸ªè¯ä¹¦ï¼Œå°±è¯´æ˜è¿™ä¸ªè¯ä¹¦ä¸å¯é ï¼Œæœ‰å¯èƒ½æ˜¯å‡çš„ã€‚</li></ul><ol start="3"><li>CA è¯ä¹¦çš„å…¬ä¿¡åŠ›<br>CA è¯ä¹¦éœ€è¦ç”±å…¬å¸æˆ–è€…ä¸ªäººå‘å‡ºç”³è¯·ï¼Œå†é€šè¿‡é‚®ç®±éªŒè¯ç­‰æ–¹æ³•éªŒè¯åŸŸåå­˜åœ¨ã€‚é¿å…äº†é»‘å®¢å†’å……ç½‘ç«™è·å–è¯ä¹¦çš„å¯èƒ½ã€‚<br>åœ¨æŠ€æœ¯å±‚é¢ä¸Šï¼ŒCA æœºæ„çš„å…¬é’¥æ˜¯å†™åœ¨æ“ä½œç³»ç»Ÿæˆ–è€…æµè§ˆå™¨é‡Œçš„ã€‚åªæœ‰ç”¨ CA æœºæ„çš„ç§é’¥åŠ å¯†çš„å†…å®¹æ‰èƒ½å®Œæˆè§£å¯†ã€‚ç¡®ä¿äº†è¯ä¹¦çš„ç¡®æ˜¯ CA æœºæ„å‘è¡Œçš„ã€‚</li></ol><h2 id="å¯†é’¥çš„ä½œç”¨"><a href="#å¯†é’¥çš„ä½œç”¨" class="headerlink" title="å¯†é’¥çš„ä½œç”¨"></a>å¯†é’¥çš„ä½œç”¨</h2><p>æœ€åè®©æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹æ¯ä¸€æŠŠå¯†é’¥çš„ä½œç”¨<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/15/17217e2ee1709bcd~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp"></p><h2 id="HTTPS-ä¸€å®šå®‰å…¨å—"><a href="#HTTPS-ä¸€å®šå®‰å…¨å—" class="headerlink" title="HTTPS ä¸€å®šå®‰å…¨å—"></a>HTTPS ä¸€å®šå®‰å…¨å—</h2><p>éå…¨ç«™ HTTPS å¹¶ä¸å®‰å…¨</p><p>ç™»å½•é¡µé¢æ”¯æŒ HTTPS ä¸å°±è¡Œäº†ï¼Œé¦–é¡µåˆæ²¡æœ‰æ¶‰åŠè´¦æˆ·ä¿¡æ¯<br>å…¶å®è¿™æ˜¯éå¸¸ä¸å®‰å…¨çš„è¡Œä¸ºï¼Œé»‘å®¢ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡Œæ”»å‡»ï¼Œä¸€èˆ¬æ˜¯ä»¥ä¸‹æµç¨‹ï¼š</p><p>1.ç”¨æˆ·åœ¨é¦–é¡µç‚¹å‡»ã€Œç™»å½•ã€ï¼Œé¡µé¢è·³è½¬åˆ°æœ‰ htps çš„ç½‘é“¶é¡µé¢ï¼Œä½†æ­¤æ—¶ç”±äºé¦–é¡µæ˜¯ htp è¯·æ±‚ï¼Œæ‰€ä»¥æ˜¯æ˜æ–‡çš„ï¼Œè¿™å°±ä¼šè¢«é»‘å®¢åŠ«æŒ 2.é»‘å®¢åŠ«æŒç”¨æˆ·çš„è·³è½¬è¯·æ±‚ï¼Œå°† https ç½‘é“¶é¡µé¢åœ°å€è½¬æ¢ä¸º http çš„åœ°å€å†å‘é€ç»™é“¶è¡Œ</p><p>ç”¨æˆ·&lt;&#x3D;&#x3D;HTTP&#x3D;&#x3D;&gt;é»‘å®¢&lt;&#x3D;&#x3D;HTTPS&#x3D;&#x3D;&gt;é“¶è¡Œ</p><p>1.æ­¤æ—¶å¦‚æœç”¨æˆ·è¾“å…¥è´¦æˆ·ä¿¡æ¯ï¼Œé‚£ä¹ˆä¼šè¢«ä¸­é—´çš„é»‘å®¢è·å–ï¼Œæ­¤æ—¶çš„è´¦å·å¯†ç å°±è¢«æ³„éœ²äº†</p><p>å¥½åœ¨æ˜¯é“¶è¡Œçš„ç½‘é“¶é¡µé¢,åªæ”¯æŒ htps,å› æ­¤ä¸Šè¿°æ”»å‡»æš‚æ—¶æ˜¯æ— æ•ˆçš„</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV1w4411m7GL">ã€web å®‰å…¨ 3ã€‘ã€ç¡¬æ ¸ã€‘HTTPS åŸç†å…¨è§£æ</a></p><p>ä½œè€…ï¼šç«™åœ¨ä¹¦è„Šä¹‹ä¸Š<br>é“¾æ¥ï¼š<a href="https://juejin.cn/post/6844904160089882631">https://juejin.cn/post/6844904160089882631</a><br>æ¥æºï¼šç¨€åœŸæ˜é‡‘<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-7 æœ€ä½³å®è·µ</title>
      <link href="//post/2022-06-02vue-7.html"/>
      <url>//post/2022-06-02vue-7.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602200611.webp"></p><h3 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h3><p><img src="http://t-blog-images.aijs.top/img/20220602200621.webp"></p><h3 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h3><p><img src="http://t-blog-images.aijs.top/img/20220602200638.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-8 typescript</title>
      <link href="//post/2022-06-02vue-8.html"/>
      <url>//post/2022-06-02vue-8.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602201222.webp"></p><h3 id="ç»„åˆå¼"><a href="#ç»„åˆå¼" class="headerlink" title="ç»„åˆå¼"></a>ç»„åˆå¼</h3><p><img src="http://t-blog-images.aijs.top/img/20220602201022.webp"></p><h3 id="é€‰é¡¹å¼"><a href="#é€‰é¡¹å¼" class="headerlink" title="é€‰é¡¹å¼"></a>é€‰é¡¹å¼</h3><p><img src="http://t-blog-images.aijs.top/img/20220602201032.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-6 å‡çº§è§„æ¨¡</title>
      <link href="//post/2022-06-02vue-6.html"/>
      <url>//post/2022-06-02vue-6.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602200123.webp"></p><h3 id="çŠ¶æ€ç®¡ç†"><a href="#çŠ¶æ€ç®¡ç†" class="headerlink" title="çŠ¶æ€ç®¡ç†"></a>çŠ¶æ€ç®¡ç†</h3><p><img src="http://t-blog-images.aijs.top/img/20220602200102.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-5 å†…ç½®ç»„ä»¶</title>
      <link href="//post/2022-06-02vue-5.html"/>
      <url>//post/2022-06-02vue-5.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602195846.webp"></p><h2 id="KeepAlive"><a href="#KeepAlive" class="headerlink" title="KeepAlive"></a>KeepAlive</h2><p><img src="http://t-blog-images.aijs.top/img/20220602195059.webp"></p><h3 id="teleportÂ·ä¼ é€é—¨"><a href="#teleportÂ·ä¼ é€é—¨" class="headerlink" title="teleportÂ·ä¼ é€é—¨"></a>teleportÂ·ä¼ é€é—¨</h3><p><img src="http://t-blog-images.aijs.top/img/20220602195124.webp"></p><h3 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h3><p><img src="http://t-blog-images.aijs.top/img/20220602195153.webp"></p><h3 id="è¿‡æ¸¡"><a href="#è¿‡æ¸¡" class="headerlink" title="è¿‡æ¸¡"></a>è¿‡æ¸¡</h3><p> <img src="http://t-blog-images.aijs.top/img/20220602195252.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-4 å¯é‡ç”¨æ€§</title>
      <link href="//post/2022-06-02vue-4.html"/>
      <url>//post/2022-06-02vue-4.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602185624.webp"></p><h2 id="å¯é‡ç”¨æ€§"><a href="#å¯é‡ç”¨æ€§" class="headerlink" title="å¯é‡ç”¨æ€§"></a>å¯é‡ç”¨æ€§</h2><p><img src="http://t-blog-images.aijs.top/img/20220602193659.webp"></p><h3 id="ç»„åˆå‡½æ•°"><a href="#ç»„åˆå‡½æ•°" class="headerlink" title="ç»„åˆå‡½æ•°"></a>ç»„åˆå‡½æ•°</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193738.webp"></p><h3 id="è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="è‡ªå®šä¹‰æŒ‡ä»¤"></a>è‡ªå®šä¹‰æŒ‡ä»¤</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193751.webp"></p><h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-3 æ·±å…¥ç»„ä»¶</title>
      <link href="//post/2022-06-02vue-3.html"/>
      <url>//post/2022-06-02vue-3.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602185624.webp"></p><h2 id="æ·±å…¥ç»„ä»¶"><a href="#æ·±å…¥ç»„ä»¶" class="headerlink" title="æ·±å…¥ç»„ä»¶"></a>æ·±å…¥ç»„ä»¶</h2><p><img src="http://t-blog-images.aijs.top/img/20220602193405.webp"></p><h3 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h3><h3 id="prop"><a href="#prop" class="headerlink" title="prop"></a>prop</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193158.webp"></p><h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193205.webp"></p><h3 id="é€ä¼ -Attribute"><a href="#é€ä¼ -Attribute" class="headerlink" title="é€ä¼  Attribute"></a>é€ä¼  Attribute</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193213.webp"></p><h3 id="æ’æ§½"><a href="#æ’æ§½" class="headerlink" title="æ’æ§½"></a>æ’æ§½</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193228.webp"></p><h3 id="ä¾èµ–æ³¨å…¥"><a href="#ä¾èµ–æ³¨å…¥" class="headerlink" title="ä¾èµ–æ³¨å…¥"></a>ä¾èµ–æ³¨å…¥</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193235.webp"></p><h3 id="å¼‚æ­¥ç»„ä»¶"><a href="#å¼‚æ­¥ç»„ä»¶" class="headerlink" title="å¼‚æ­¥ç»„ä»¶"></a>å¼‚æ­¥ç»„ä»¶</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193244.webp"></p><h2 id="å¯é‡ç”¨æ€§"><a href="#å¯é‡ç”¨æ€§" class="headerlink" title="å¯é‡ç”¨æ€§"></a>å¯é‡ç”¨æ€§</h2><p><img src="http://t-blog-images.aijs.top/img/20220602193659.webp"></p><h3 id="ç»„åˆå‡½æ•°"><a href="#ç»„åˆå‡½æ•°" class="headerlink" title="ç»„åˆå‡½æ•°"></a>ç»„åˆå‡½æ•°</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193738.webp"></p><h3 id="è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="è‡ªå®šä¹‰æŒ‡ä»¤"></a>è‡ªå®šä¹‰æŒ‡ä»¤</h3><p><img src="http://t-blog-images.aijs.top/img/20220602193751.webp"></p><h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-2 v3</title>
      <link href="//post/2022-06-02vue-2.html"/>
      <url>//post/2022-06-02vue-2.html</url>
      
        <content type="html"><![CDATA[<h2 id="v3"><a href="#v3" class="headerlink" title="v3"></a>v3</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><p><img src="http://t-blog-images.aijs.top/img/20220602191916.webp"></p><h3 id="å“åº”å¼åŸºç¡€"><a href="#å“åº”å¼åŸºç¡€" class="headerlink" title="å“åº”å¼åŸºç¡€"></a>å“åº”å¼åŸºç¡€</h3><p><img src="http://t-blog-images.aijs.top/img/20220602192006.webp"></p><h3 id="è®¡ç®—å±æ€§"><a href="#è®¡ç®—å±æ€§" class="headerlink" title="è®¡ç®—å±æ€§"></a>è®¡ç®—å±æ€§</h3><p><img src="http://t-blog-images.aijs.top/img/20220602192306.webp"></p><h3 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h3><p><img src="http://t-blog-images.aijs.top/img/20220602192315.webp"></p><h3 id="ä¾¦å¬å™¨"><a href="#ä¾¦å¬å™¨" class="headerlink" title="ä¾¦å¬å™¨"></a>ä¾¦å¬å™¨</h3><p><img src="http://t-blog-images.aijs.top/img/20220602192323.webp"></p><h3 id="æ¨¡ç‰ˆ-ref"><a href="#æ¨¡ç‰ˆ-ref" class="headerlink" title="æ¨¡ç‰ˆ ref"></a>æ¨¡ç‰ˆ ref</h3><p><img src="http://t-blog-images.aijs.top/img/20220602192333.webp"></p><h3 id="ç»„ä»¶åŸºç¡€"><a href="#ç»„ä»¶åŸºç¡€" class="headerlink" title="ç»„ä»¶åŸºç¡€"></a>ç»„ä»¶åŸºç¡€</h3><p><img src="http://t-blog-images.aijs.top/img/20220602192342.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-1 åŸºç¡€</title>
      <link href="//post/2022-06-02vue-1.html"/>
      <url>//post/2022-06-02vue-1.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><h2 id="v2"><a href="#v2" class="headerlink" title="v2"></a>v2</h2><p><img src="http://t-blog-images.aijs.top/img/20220602190150.webp"></p><h3 id="æ¨¡ç‰ˆè¯­æ³•"><a href="#æ¨¡ç‰ˆè¯­æ³•" class="headerlink" title="æ¨¡ç‰ˆè¯­æ³•"></a>æ¨¡ç‰ˆè¯­æ³•</h3><!-- ![](http://t-blog-images.aijs.top/img/20220602190219.webp) --><p><img src="http://t-blog-images.aijs.top/img/20220602191619.webp"></p><h3 id="æ•°æ®ç»‘å®š"><a href="#æ•°æ®ç»‘å®š" class="headerlink" title="æ•°æ®ç»‘å®š"></a>æ•°æ®ç»‘å®š</h3><!-- ![](http://t-blog-images.aijs.top/img/20220602190321.webp) --><p><img src="http://t-blog-images.aijs.top/img/20220602191251.webp"></p><h3 id="äº‹ä»¶ç»‘å®š"><a href="#äº‹ä»¶ç»‘å®š" class="headerlink" title="äº‹ä»¶ç»‘å®š"></a>äº‹ä»¶ç»‘å®š</h3><p><img src="http://t-blog-images.aijs.top/img/20220602190525.webp"></p><h3 id="è¡¨å•è¾“å…¥ç»‘å®š"><a href="#è¡¨å•è¾“å…¥ç»‘å®š" class="headerlink" title="è¡¨å•è¾“å…¥ç»‘å®š"></a>è¡¨å•è¾“å…¥ç»‘å®š</h3><p><img src="http://t-blog-images.aijs.top/img/20220602190828.webp"></p><h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3><p><img src="http://t-blog-images.aijs.top/img/20220602191049.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†å­¦Vue3-0 æ¦‚è§ˆ</title>
      <link href="//post/2022-06-02vue-0.html"/>
      <url>//post/2022-06-02vue-0.html</url>
      
        <content type="html"><![CDATA[<h2 id="vue3"><a href="#vue3" class="headerlink" title="vue3"></a>vue3</h2><ul><li>ä½¿ç”¨ proxy é‡å†™äº† vue2ï¼Œå¹¶å¢åŠ äº†ç»„åˆå¼ api</li><li>ä»¥ä¸‹æ€ç»´å¯¼å›¾ä»¥<a href="https://staging-cn.vuejs.org/">vue3 æ–‡æ¡£</a>å†…å®¹ä¸ºä¾æ®ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç»˜åˆ¶</li><li>å­¦ä¹ è¿‡ç¨‹ä¸­å¯¹æ¯”äº† vue3 å’Œ react</li><li>å¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡çœ‹vueäº†ï¼Œvue3ä¸€ç›´æ²¡æ¥è§¦ï¼Œåª³å¦‡ä¸å­¦ã€‚ä¸‡ä¸€å“ªå¤©åª³å¦‡éœ€è¦ç”¨vue3äº†ï¼Œæ²¡äººå¸¦å²‚ä¸æ˜¯è¦å¤±ä¸šï¼Œèµ¶ç´§å­¦èµ·æ¥ï½<h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2></li></ul><!-- ![](http://t-blog-images.aijs.top/img/20220602185624.webp) --><!-- ![](http://t-blog-images.aijs.top/img/20220602201338.webp) --><img src="http://t-blog-images.aijs.top/img/20220602201338.webp" style="max-width:240px" /><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ul><li>å¿µå¨ç€ <code>æ¸è¿›å¼</code> <code>ä¾èµ–æ”¶é›†</code> å»å­¦ä¹ <a href="https://staging-cn.vuejs.org/guide/introduction.html">vueæŒ‡å—</a></li></ul><p><img src="http://t-blog-images.aijs.top/img/20220602201731.webp"></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react useState é”™è¯¯ä½¿ç”¨</title>
      <link href="//post/2022-05-31bug.html"/>
      <url>//post/2022-05-31bug.html</url>
      
        <content type="html"><![CDATA[<h2 id="Share"><a href="#Share" class="headerlink" title="Share"></a>Share</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">const Share: FC&lt;ShareProps&gt; &#x3D; (props) &#x3D;&gt; &#123;  const &#123; entityType, entityCode &#125; &#x3D; props  const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;    value: props.value,    title: props.title,    shareId: props.shareId,    mappingPassword: props.mappingPassword,    passwordEnable: props.passwordEnable,    mappingState: props.mappingState,    expireTime: props.expireTime,    shortCode: props.shortCode,  &#125;)  const &#123; value &#125; &#x3D; state  ...  return (    &lt;div&gt;      &#123;renderBtn&#125;      &lt;ShareModal        entityType&#x3D;&#123;entityType&#125;        entityCode&#x3D;&#123;entityCode&#125;        &#123;...modalProps&#125;        state&#x3D;&#123;state&#125;        setState&#x3D;&#123;setState&#125;      &#x2F;&gt;    &lt;&#x2F;div&gt;  )&#125;export default Share</code></pre><h2 id="ShareModal"><a href="#ShareModal" class="headerlink" title="ShareModal"></a>ShareModal</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">interface ShareModalProps extends ModalFuncProps &#123;  entityType: EntityType  entityCode: string  className?: string  state: StateProps  setState: (state: StateProps) &#x3D;&gt; void&#125;const Copy &#x3D; (&#123; text, children &#125;: &#123; text: string; children: string &#125;) &#x3D;&gt; &#123;  return (    &lt;CopyToClipboard      text&#x3D;&#123;text&#125;      onCopy&#x3D;&#123;() &#x3D;&gt; &#123;        message.success(&#39;é“¾æ¥å·²å¤åˆ¶&#39;)      &#125;&#125;    &gt;      &lt;span&gt;&#123;children&#125;&lt;&#x2F;span&gt;    &lt;&#x2F;CopyToClipboard&gt;  )&#125;const ShareModal: FC&lt;ShareModalProps&gt; &#x3D; (props) &#x3D;&gt; &#123;  const [form] &#x3D; HookForm.useForm()  const &#123; state, setState, entityType, entityCode, ...restProps &#125; &#x3D; props  const &#123; value, title, mappingPassword, shortCode, expireTime &#125; &#x3D; state  const &#123;    onChange: toggle,    resetPassword: reset,    update,  &#125; &#x3D; useShare(&#123;    entityCode,    entityType,    state,    setState,  &#125;)  ....  return (    &lt;Modal      &#123;...restProps&#125;      className&#x3D;&#123;styles[&#39;share-modal-wrap&#39;]&#125;      title&#x3D;&quot;é“¾æ¥åˆ†äº«&quot;      destroyOnClose      width&#x3D;&#123;420&#125;      footer&#x3D;&#123;null&#125;    &gt;      &lt;ConditionComponent isShow&#x3D;&#123;value&#125;&gt;        ....        &lt;HookForm form&#x3D;&#123;form&#125; style&#x3D;&#123;&#123; marginBottom: 10, width: &#39;100%&#39; &#125;&#125; layout&#x3D;&quot;vertical&quot;&gt;          &lt;HookForm.Item noStyle shouldUpdate&gt;            &#123;() &#x3D;&gt; &#123;              const &#123; url, mappingPassword, expireTime &#125; &#x3D; form.getFieldsValue()              const text &#x3D; &#96;$&#123;url&#125;ï¼ˆå¯†ç ï¼š$&#123;mappingPassword&#125;ï¼‰ã€Š$&#123;title&#125;ã€‹$&#123;moment(                expireTime,              ).format(&#39;YYYY-MM-DD HH:mm:ss&#39;)&#125;è¿‡æœŸ&#96;              return (                &lt;HookForm.Item name&#x3D;&quot;url&quot; label&#x3D;&quot;&quot;&gt;                  &lt;Input                    className&#x3D;&#123;styles[&#39;share-copy&#39;]&#125;                    addonAfter&#x3D;&#123;&lt;Copy text&#x3D;&#123;text&#125;&gt;å¤åˆ¶é“¾æ¥å’Œå¯†ç &lt;&#x2F;Copy&gt;&#125;                    disabled                  &#x2F;&gt;                &lt;&#x2F;HookForm.Item&gt;              )            &#125;&#125;          &lt;&#x2F;HookForm.Item&gt;        &lt;&#x2F;HookForm&gt;      &lt;&#x2F;ConditionComponent&gt;    &lt;&#x2F;Modal&gt;  )&#125;export default ShareModal</code></pre><h2 id="ç”¨æˆ·åé¦ˆ"><a href="#ç”¨æˆ·åé¦ˆ" class="headerlink" title="ç”¨æˆ·åé¦ˆ"></a>ç”¨æˆ·åé¦ˆ</h2><p>ä¸ºä»€ä¹ˆåˆ†äº«çš„é“¾æ¥ä¸è¦åˆ†äº«çš„é“¾æ¥å¯¹ä¸ä¸Šï¼Ÿ</p><h2 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h2><p>useCallbackå—ä¾èµ–é¡¹çš„å½±å“ï¼Œä¸æ›´æ–°ï¼Œä¹‹å‰æ”¹è¿‡åŒäº‹çš„ä»£ç ï¼Œè¿™æ¬¡æ‰«äº†ä¸€æ ·ï¼Œæ²¡æœ‰callbackï¼Œå°±è¿™é—®é¢˜ä¿®æ”¹å‡ ä¸ªäº†</p><h2 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h2><ul><li>æ‰¾äº†ä¸‹æ•°æ®<code>ShareModal</code>ç»„ä»¶,çœ‹åˆ°ä¸¤ä¸ªå…¥å‚<code>state, setState</code> ï¼Œæˆ‘è‰¹</li><li>ç»§ç»­å¾€ä¸Šå±‚æ‰¾<pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&lt;ShareModal  entityType&#x3D;&#123;entityType&#125;  entityCode&#x3D;&#123;entityCode&#125;  &#123;...modalProps&#125;  state&#x3D;&#123;state&#125; &#x2F;&#x2F; ğŸ˜“  setState&#x3D;&#123;setState&#125; &#x2F;&#x2F;ğŸ˜“ &#x2F;&gt;</code></pre></li><li>å†å¾€ä¸Šæ‰¾ï¼ŒuseState å†…éƒ¨åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ•°æ®åˆå§‹åŒ–å®Œæˆä¸å†æ”¹å˜</li></ul><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;  value: props.value,  title: props.title,  shareId: props.shareId,  mappingPassword: props.mappingPassword,  passwordEnable: props.passwordEnable,  mappingState: props.mappingState,  expireTime: props.expireTime,  shortCode: props.shortCode,&#125;)const &#123; value &#125; &#x3D; state</code></pre><ul><li>è¿™é‡Œä»£ç è¿™ä¹ˆå†™ï¼Œå…¶ä»–åœ°æ–¹è‚¯å®šä¹Ÿæœ‰è¿™æ ·çš„å†™æ³•ï¼ŒğŸ˜“</li></ul><h2 id="æ”¹ä¸€ä¸‹"><a href="#æ”¹ä¸€ä¸‹" class="headerlink" title="æ”¹ä¸€ä¸‹"></a>æ”¹ä¸€ä¸‹</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">const [state, setState] &#x3D; useState&lt;StateProps&gt;(&#123;&#125;)useEffect(() &#x3D;&gt; &#123;  setState(&#123; ...props &#125;)&#125;, [props.shareId])</code></pre>]]></content>
      
      
      <categories>
          
          <category> bug </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bug </tag>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-ç¼–ç¨‹èŒƒå¼-å‡½æ•°å¼ç¼–ç¨‹ç®€å•äº†è§£</title>
      <link href="//post/2022-05-28func.html"/>
      <url>//post/2022-05-28func.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>js ä¸ºäº†å®ç°é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œåšäº†å¾ˆå¤šäº‹æƒ…ï¼Œå¯¼è‡´å¤§å®¶åœ¨å­¦ä¹  js çš„æ—¶å€™ï¼Œä¼šé‡åˆ°å¤æ‚çš„åŸå‹ã€åŸå‹é“¾ã€ç»§æ‰¿ï¼Œè¿˜æœ‰å¯¹äººä¸å‹å¥½çš„ this ï¼›è€Œå½“æˆ‘ä»¬ç”¨è¿™äº›ä¸œè¥¿ç»„åˆèµ·æ¥æ¨¡æ‹Ÿé¢å‘å¯¹è±¡çš„ç‰¹æ€§çš„æ—¶å€™ï¼Œå°±æ›´åŠ ç—›è‹¦äº†ã€‚ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç§æ›´å‹å¥½çš„æ–¹å¼ï¼Œå‡½æ•°å¼ç¼–ç¨‹ã€‚<br><strong>ç®€å•æ¥è¯´å°±æ˜¯ï¼šé¢å‘å¯¹è±¡çš„æ€æƒ³åœ¨ js ä¸­ä¸æ˜¯å¾ˆå¥½ç”¨</strong></p><h2 id="ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹"><a href="#ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹"></a>ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹</h2><p>å‡½æ•°å¼ç¼–ç¨‹ï¼ˆfunctional programingï¼‰æ˜¯ç¼–ç¨‹èŒƒå¼ä¹‹ä¸€ã€‚æˆ‘ä»¬å¸¸è§çš„èŒƒå¼è¿˜æœ‰é¢å‘è¿‡ç¨‹ã€é¢å‘è¡Œä¸ºã€é¢å‘å¯¹è±¡ç­‰ã€‚</p><p>èŒƒå¼ï¼šæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ç§<code>æ€ç»´æ¨¡å¼</code>åŠ ä¸Šå®ƒçš„å®ç°æ–¹æ³•ï¼Œ<code>ç®€å•è¯´å°±æ˜¯ç¼–ç¨‹çš„æ–¹æ³•è®º</code>ã€‚</p><ul><li><p><strong>é¢å‘è¿‡ç¨‹ç¼–ç¨‹</strong>ï¼šç®€å•è§£é‡Šå°±æ˜¯æŒ‰ç…§æ­¥éª¤æ¥å®ç°ã€‚</p></li><li><p><strong>é¢å‘è¡Œä¸ºç¼–ç¨‹</strong>ï¼šå®ƒæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„è¡ç”ŸèŒƒå‹ï¼Œå°†ç”µè„‘è¿ç®—å¹³å±•ä¸ºä¸€ç³»åˆ—çš„å˜åŒ–ï¼Œå¹¶ä¸”é¿å…ä½¿ç”¨ç¨‹åºæŒ‡ä»¤ä»¥åŠå †å çš„å¯¹è±¡ã€‚</p></li><li><p><strong>é¢å‘å¯¹è±¡ç¼–ç¨‹</strong>ï¼šå®ƒçš„æ€ç»´æ–¹å¼æ˜¯æŠŠç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©æŠ½è±¡æˆç¨‹åºä¸–ç•Œä¸­çš„ç±»å’Œå¯¹è±¡ï¼Œç„¶åé€šè¿‡å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€æ¥æ¼”ç¤ºäº‹ç‰©ä¹‹é—´çš„è”ç³»ã€‚</p></li><li><p><strong>é¢å‘å‡½æ•°å¼ç¼–ç¨‹</strong>ï¼šå®ƒçš„æ€ç»´æ–¹å¼æ˜¯æŠŠç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©å’Œäº‹ç‰©ä¹‹é—´çš„è”ç³»ï¼ŒæŠ½è±¡åˆ°ç¨‹åºä¸–ç•Œä¸­ã€‚</p></li></ul><h2 id="å‡½æ•°å¼ç¼–ç¨‹ç‰¹ç‚¹ï¼š"><a href="#å‡½æ•°å¼ç¼–ç¨‹ç‰¹ç‚¹ï¼š" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹ç‰¹ç‚¹ï¼š"></a>å‡½æ•°å¼ç¼–ç¨‹ç‰¹ç‚¹ï¼š</h2><ul><li><p>ç¨‹åºçš„æœ¬è´¨ï¼šå°±æ˜¯åˆ©ç”¨è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›å°†è¾“å…¥è½¬åŒ–æˆå¯¹åº”çš„è¾“å‡ºã€‚</p></li><li><p>å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„å‡½æ•°æŒ‡çš„ä¸æ˜¯ç¼–ç¨‹è¯­è¨€é‡Œçš„å‡½æ•°ï¼Œè€Œæ˜¯æ•°å­¦æ„ä¹‰ä¸Šçš„æ˜ å°„å…³ç³»ã€‚æ¯”å¦‚ y&#x3D;sin(x) ä¸­ x å’Œ y å€¼çš„æ˜ å°„å…³ç³»ã€‚</p></li><li><p>çº¯å‡½æ•°ï¼šç›¸åŒçš„è¾“å…¥è·å¾—ç›¸åŒçš„è¾“å‡ºï¼ˆæ— å‰¯ä½œç”¨ï¼‰ã€‚</p></li><li><p>å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯å¯¹æ•°æ®(å‡½æ•°)æ˜ å°„å…³ç³»çš„æŠ½è±¡ã€‚</p></li></ul><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>é«˜é˜¶å‡½æ•°</li><li>é—­åŒ…</li><li>çº¯å‡½æ•°</li><li>æŸ¯é‡ŒåŒ–</li><li>ç»„åˆå‡½æ•°</li></ul><h2 id="ä¸‰å¤§ç¼–ç¨‹èŒƒå¼"><a href="#ä¸‰å¤§ç¼–ç¨‹èŒƒå¼" class="headerlink" title="ä¸‰å¤§ç¼–ç¨‹èŒƒå¼"></a>ä¸‰å¤§ç¼–ç¨‹èŒƒå¼</h2><h3 id="ç¼–ç¨‹èŒƒå¼æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š"><a href="#ç¼–ç¨‹èŒƒå¼æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š" class="headerlink" title="ç¼–ç¨‹èŒƒå¼æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š"></a>ç¼–ç¨‹èŒƒå¼æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</h3><p>1ã€é¢å‘å¯¹è±¡ç¼–ç¨‹<br>2ã€é¢å‘è¿‡ç¨‹ç¼–ç¨‹<br>3ã€é¢å‘å‡½æ•°ç¼–ç¨‹</p><h3 id="åŒºåˆ«ï¼š"><a href="#åŒºåˆ«ï¼š" class="headerlink" title="åŒºåˆ«ï¼š"></a>åŒºåˆ«ï¼š</h3><span style="color: red">é¢å‘å¯¹è±¡ç¼–ç¨‹æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼šä»¥ç±»ã€å¯¹è±¡ä½œä¸ºç»„ç»‡ä»£ç çš„å•å…ƒä»¥åŠå®ƒçš„å››å¤§ç‰¹æ€§ã€‚<p>é¢å‘è¿‡ç¨‹ç¼–ç¨‹æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼šä»¥å‡½æ•°ä½œä¸ºç»„ç»‡ä»£ç çš„å•å…ƒï¼Œæ•°æ®ä¸æ–¹æ³•ç›¸åˆ†ç¦»ã€‚</p><p>å‡½æ•°å¼ç¼–ç¨‹è·Ÿé¢å‘è¿‡ç¨‹ç¼–ç¨‹ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä»¥å‡½æ•°ä½œä¸ºç»„ç»‡ä»£ç çš„å•å…ƒã€‚</p><p>ä¸è¿‡ï¼Œå®ƒè·Ÿé¢å‘è¿‡ç¨‹ç¼–ç¨‹çš„åŒºåˆ«åœ¨äºï¼Œå®ƒçš„å‡½æ•°æ˜¯æ— çŠ¶æ€çš„ã€‚<br></span></p><h3 id="ä½•ä¸ºæ— çŠ¶æ€ï¼Ÿ"><a href="#ä½•ä¸ºæ— çŠ¶æ€ï¼Ÿ" class="headerlink" title="ä½•ä¸ºæ— çŠ¶æ€ï¼Ÿ"></a>ä½•ä¸ºæ— çŠ¶æ€ï¼Ÿ</h3><p>ç®€å•ç‚¹è®²å°±æ˜¯ï¼Œå‡½æ•°å†…éƒ¨æ¶‰åŠçš„å˜é‡éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼Œ<br>ä¸ä¼šåƒé¢å‘å¯¹è±¡ç¼–ç¨‹é‚£æ ·ï¼Œå…±äº«ç±»æˆå‘˜å˜é‡ï¼Œ<br>ä¹Ÿä¸ä¼šåƒé¢å‘è¿‡ç¨‹ç¼–ç¨‹é‚£æ ·ï¼Œå…±äº«å…¨å±€å˜é‡ã€‚<br>å‡½æ•°çš„æ‰§è¡Œç»“æœåªä¸å…¥å‚æœ‰å…³ï¼Œè·Ÿå…¶ä»–ä»»ä½•å¤–éƒ¨å˜é‡æ— å…³ã€‚<br>åŒæ ·çš„å…¥å‚ï¼Œä¸ç®¡æ€ä¹ˆæ‰§è¡Œï¼Œå¾—åˆ°çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚<br>è¿™å®é™…ä¸Šå°±æ˜¯æ•°å­¦å‡½æ•°æˆ–æ•°å­¦è¡¨è¾¾å¼çš„åŸºæœ¬è¦æ±‚ã€‚</p><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>ä¸åŒçš„ç¼–ç¨‹èŒƒå¼ä¹‹é—´å¹¶ä¸æ˜¯æˆªç„¶ä¸åŒçš„ï¼Œæ€»æ˜¯æœ‰ä¸€äº›ç›¸åŒçš„ç¼–ç¨‹è§„åˆ™ã€‚<br>æ¯”å¦‚ï¼Œä¸ç®¡æ˜¯é¢å‘è¿‡ç¨‹ã€é¢å‘å¯¹è±¡è¿˜æ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Œå®ƒä»¬éƒ½æœ‰å˜é‡ã€å‡½æ•°çš„æ¦‚å¿µï¼Œ<br>æœ€é¡¶å±‚éƒ½è¦æœ‰ main å‡½æ•°æ‰§è¡Œå…¥å£ï¼Œæ¥ç»„è£…ç¼–ç¨‹å•å…ƒï¼ˆç±»ã€å‡½æ•°ç­‰ï¼‰ã€‚<br>åªä¸è¿‡ï¼Œé¢å‘å¯¹è±¡çš„ç¼–ç¨‹å•å…ƒæ˜¯ç±»æˆ–å¯¹è±¡ï¼Œé¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹å•å…ƒæ˜¯å‡½æ•°ï¼Œå‡½æ•°å¼ç¼–ç¨‹çš„ç¼–ç¨‹å•å…ƒæ˜¯æ— çŠ¶æ€å‡½æ•°ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.zoo.team/article/function-production"></a><br><a href="https://blog.csdn.net/weixin_43871678/article/details/124617216" target="_blank" >ä¸‰å¤§ç¼–ç¨‹èŒƒå¼</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wiki Laser Pen</title>
      <link href="//post/2022-05-27wiki-laserPen.html"/>
      <url>//post/2022-05-27wiki-laserPen.html</url>
      
        <content type="html"><![CDATA[<h2 id="Laser-Pen"><a href="#Laser-Pen" class="headerlink" title="Laser Pen"></a>Laser Pen</h2><p><code>Laser Pen </code>æ˜¯ä¸€å¥—ç”¨æ¥åœ¨ web canvas ä¸Šç»˜åˆ¶é¼ æ ‡è½¨è¿¹çš„å·¥å…·é›†ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p><code>wiki</code>å…¨å±æ¼”ç¤ºæ—¶å€™ï¼Œä¸ºäº†ä¾¿äºå¬ä¼—è·Ÿéšæ¼”è®²è€…è¿›åº¦ï¼Œç»™é¼ æ ‡è½¨è¿¹åŠ ä¸Šæ ‡è®°ã€‚</p><p><img src="http://t-blog-images.aijs.top/img/demo.gif"></p><p>æ³¨ï¼šå…¬å¸é¡¹ç›®ç”±äºç‰ˆæƒé—®é¢˜ï¼Œä¸ä¾¿æ¼”ç¤º</p><h2 id="åˆæ­¥ä¸Šæ‰‹"><a href="#åˆæ­¥ä¸Šæ‰‹" class="headerlink" title="åˆæ­¥ä¸Šæ‰‹"></a>åˆæ­¥ä¸Šæ‰‹</h2><p>é¦–å…ˆåœ¨ä½ çš„é¡¹ç›®ä¸­æ·»åŠ å¯¹ Laser Pen çš„ä¾èµ–ï¼š</p><pre class="line-numbers language-none"><code class="language-none">yarn add laser-pen</code></pre><p>æˆ–è€…</p><pre class="line-numbers language-none"><code class="language-none">npm i laser-pen</code></pre><p>ç„¶åç›‘å¬é¼ æ ‡çš„ move äº‹ä»¶ï¼Œè·å–é¼ æ ‡ç§»åŠ¨è½¨è¿¹çš„åæ ‡ï¼Œå¹¶åŒæ—¶è®°å½• move äº‹ä»¶è§¦å‘æ—¶çš„æ—¶é—´æˆ³ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è·å– canvas å…ƒç´ çš„åæ ‡const canvasDom &#x3D; document.querySelector(&#39;canvas&#39;)const canvasPos &#x3D; canvasDom.getBoundingClientRect()const ctx &#x3D; canvas.getContext(&#39;2d&#39;)&#x2F;&#x2F; ç”¨æ¥å­˜å‚¨æ‰€æœ‰é¼ æ ‡è½¨è¿¹æ•°æ®let mouseTrack &#x3D; []&#x2F;&#x2F; ç›‘å¬é¼ æ ‡äº‹ä»¶document.addEventListener(&#39;mousemove&#39;, (event) &#x3D;&gt; &#123;  mouseTrack.push(&#123;    x: event.clientX - canvasPos.x,    y: event.clientY - canvasPos.y,    time: Date.now(),  &#125;)&#125;)</code></pre><p>æœ€ååœ¨è°ƒç”¨ drawLaserPen æ–¹æ³•ç»˜åˆ¶é¼ æ ‡è½¨è¿¹</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">import &#123; drainPoints, drawLaserPen &#125; from &#39;laser-pen&#39;function draw() &#123;  &#x2F;&#x2F; è¿‡æ»¤æ‰ä¸€äº›å¤±æ•ˆçš„è½¨è¿¹åæ ‡  mouseTrack &#x3D; drainPoints(mouseTrack)  if (mouseTrack.length &gt;&#x3D; 3) &#123;    &#x2F;&#x2F; ç»˜åˆ¶é¼ æ ‡è½¨è¿¹    drawLaserPen(ctx, mouseTrack)  &#125;  requestAnimation(draw)&#125;</code></pre><p>åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥å·²ç»å¯ä»¥åœ¨ canvas ä¸Šå®ç°é¼ æ ‡è½¨è¿¹çš„ç»˜åˆ¶äº†ã€‚</p><h2 id="å‚æ•°é…ç½®"><a href="#å‚æ•°é…ç½®" class="headerlink" title="å‚æ•°é…ç½®"></a>å‚æ•°é…ç½®</h2><p>å¦‚æœé»˜è®¤çš„è½¨è¿¹æ•ˆæœä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼ŒLaser Pen è¿˜æä¾›äº†ä¸€äº›æ¥å£è®©ä½ å¯ä»¥æ–¹ä¾¿çš„ä¿®æ”¹é¼ æ ‡è½¨è¿¹çš„æ ·å¼ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è®¾ç½®å»¶è¿Ÿæ—¶é—´ï¼Œmousemove äº‹ä»¶äº§ç”Ÿçš„åæ ‡ç‚¹åœ¨è¶…è¿‡å»¶è¿Ÿæ—¶é—´åå°±ä¸ä¼šè¢«ç»˜åˆ¶ï¼Œä¼šç›´æ¥å½±å“è½¨è¿¹çš„é•¿åº¦setDelay: (millisecond: number) &#x3D;&gt; void;&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„æœ€å¤§å®½åº¦ï¼Œè½¨è¿¹æ˜¯ä¸€æ¡ç”±ç²—å˜ç»†çš„æ›²çº¿ï¼ŒmaxWidth è¡¨ç¤ºç²—çš„é‚£ä¸€å¤´çš„çº¿å®½setMaxWidth: (width: number) &#x3D;&gt; void;&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„æœ€å°å®½åº¦ï¼Œè½¨è¿¹æ˜¯ä¸€æ¡ç”±ç²—å˜ç»†çš„æ›²çº¿ï¼ŒminWidth è¡¨ç¤ºç»†çš„é‚£ä¸€å¤´çš„çº¿å®½setMinWidth: (width: number) &#x3D;&gt; void;&#x2F;&#x2F; è®¾ç½®æ›²çº¿å¼ åŠ›å¤§å°ï¼Œå¼ åŠ›è¶Šå¤§æ‹ç‚¹å¤„è¶Šå¹³æ»‘ï¼Œåä¹‹è¶Šå°–é”setTension: (t: number) &#x3D;&gt; void;&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„æœ€å°é€æ˜åº¦ï¼Œè½¨è¿¹æ˜¯ä¸€æ¡ç”±ä¸é€æ˜å˜é€æ˜çš„æ›²çº¿ï¼Œopacity è¡¨ç¤ºè½¨è¿¹æœ«å°¾çš„ä¸é€æ˜åº¦setOpacity: (o: number) &#x3D;&gt; void;&#x2F;&#x2F; è®¾ç½®è½¨è¿¹çš„é¢œè‰²setColor: (r: number, g: number, b: number) &#x3D;&gt; void;&#x2F;&#x2F; è®¾ç½®è½¨è¿¹å¤´éƒ¨æ˜¯å¦æ˜¯åœ†å½¢setRoundCap: (b: boolean) &#x3D;&gt; void;</code></pre><p>åœ¨ä»»ä½•æ—¶å€™è°ƒç”¨ä¸Šè¿°æ¥å£ä¿®æ”¹é¼ æ ‡è½¨è¿¹çš„æ ·å¼ï¼Œéƒ½ä¼šåœ¨ç´§æ¥ç€çš„ä¸‹ä¸€æ¬¡ç»˜åˆ¶ä¸­ç”Ÿæ•ˆã€‚æ‰€ä»¥å¦‚æœä½ æƒ³å®ç°ä¸€ä¸ªç±»ä¼¼ RGB è·‘é©¬ç¯çš„é¼ æ ‡è½¨è¿¹ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><h2 id="å®šåˆ¶åŒ–å¼€å‘"><a href="#å®šåˆ¶åŒ–å¼€å‘" class="headerlink" title="å®šåˆ¶åŒ–å¼€å‘"></a>å®šåˆ¶åŒ–å¼€å‘</h2><p>å¦‚æœä¸Šé¢çš„æ¥å£éƒ½ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦åšä¸€äº›å®šåˆ¶åŒ–çš„å¼€å‘äº†ã€‚</p><p>ç»˜åˆ¶é¼ æ ‡è½¨è¿¹çš„è¿‡ç¨‹å¤§æ¦‚åˆ†ä¸º 5 ä¸ªæ­¥éª¤ï¼š</p><p>æ¸…æ´—è½¨è¿¹åæ ‡æ•°æ®<br>æ ¹æ®è½¨è¿¹åæ ‡è®¡ç®—æ¯ä¸ªåæ ‡çš„æ§åˆ¶ç‚¹<br>é€šè¿‡åæ ‡ç‚¹å’Œæ§åˆ¶ç‚¹æ•°æ®ç”Ÿæˆ Bezier æ›²çº¿<br>å°†ä¸Šä¸€æ­¥ç”Ÿæˆçš„æ›²çº¿åˆ†å‰²ä¸ºæ›´çŸ­çš„ Bezier æ›²çº¿ï¼Œå¹¶è®¡ç®—æ¯æ¡æ›²çº¿çš„ç»˜åˆ¶æ ·å¼<br>ä¾æ¬¡ç»˜åˆ¶æ¯æ¡ Bezier æ›²çº¿<br>è¿™ 5 ä¸ªæ­¥éª¤å¯¹åº”ä¸‹é¢çš„ç¬¬ 1 åˆ°ç¬¬ 5 ä¸ªæ¥å£ï¼Œæœ€åçš„ drawLaserPen æ¥å£æ˜¯å¯¹å‰é¢ 5 ä¸ªæ¥å£çš„ç»„åˆã€‚ å¦‚æœç›´æ¥è°ƒç”¨ drawLaserPen ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œä½ å¯ä»¥åœ¨å‰ 5 ä¸ªæ¥å£çš„åŸºç¡€ä¸Šè‡ªè¡Œç»„åˆï¼Œå®ç°ä½ æƒ³è¦çš„æ•ˆæœã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; å»æ‰åŸå§‹é¼ æ ‡åæ ‡æ•°æ®ä¸­ä¸åˆç†çš„æ•°æ®ï¼ŒåŒ…æ‹¬è¶…è¿‡å»¶è¿Ÿæ—¶é—´çš„åæ ‡ï¼Œå’Œä¸€äº›æ’åˆ—ä¸åˆæ³•çš„åæ ‡drainPoints: (originalPoints: IOriginalPointData[]) &#x3D;&gt; IOriginalPointData[];&#x2F;&#x2F; æ ¹æ®é¼ æ ‡åæ ‡æ•°æ®è®¡ç®—æ¯ä¸ªåæ ‡ç‚¹çš„å‰åæ§åˆ¶ç‚¹calControlPoints: (points: IPoint[]) &#x3D;&gt; IControlPoint[];&#x2F;&#x2F; å°†é¼ æ ‡åæ ‡æ•°æ®å’Œæ§åˆ¶ç‚¹æ•°æ®ç»„åˆä¸ºè´å¡å°”æ›²çº¿transformPointToBezier: (  points: IPoint[],  controlPoints: IControlPoint[]) &#x3D;&gt; Bezier[];&#x2F;&#x2F; æ ¹æ®åŸå§‹çš„è´å¡å°”æ›²çº¿æ•°æ®ï¼Œè®¡ç®—å‡ºç”¨äºç»˜åˆ¶çš„æ•°æ®ç»“æ„calDrawingData: (  bzArray: Bezier[],  totalLength: number) &#x3D;&gt; IDrawingBezierData[];&#x2F;&#x2F; æ ¹æ®è®¡ç®—å‡ºçš„ç»˜åˆ¶æ•°æ®ï¼Œå°†æ›²çº¿ç»˜åˆ¶åˆ°ç”»å¸ƒä¸ŠdrawDrawingBezierData: (  ctx: CanvasRenderingContext2D,  data: IDrawingBezierData[]) &#x3D;&gt; void;&#x2F;&#x2F; ä¸€ä¸ªæ–¹ä¾¿ç®€å•ä½¿ç”¨çš„å…¥å£æ–¹æ³•ï¼Œç›´æ¥é€šè¿‡å¤„ç†å¥½çš„é¼ æ ‡åæ ‡æ•°æ®ï¼Œç»˜åˆ¶é¼ æ ‡è½¨è¿¹drawLaserPen: (ctx: CanvasRenderingContext2D, points: IPoint[]) &#x3D;&gt; void;</code></pre><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ul><li><a href="https://github.com/SilentTiger/laser-pen">laser-pen</a></li><li>çªç„¶æœ‰ä¸ªæƒ³æ³•ï¼šç‹è€…è£è€€çš„æ‹–å°¾æ•ˆæœå®ç°åŸç†ï¼Œæ˜¯ä¸æ˜¯å’Œè¿™ä¸ªç±»ä¼¼ï¼Ÿ</li></ul>]]></content>
      
      
      <categories>
          
          <category> wiki </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redux-loggeræºç </title>
      <link href="//post/2022-05-27redux-logger.html"/>
      <url>//post/2022-05-27redux-logger.html</url>
      
        <content type="html"><![CDATA[<h2 id="redux-æ—¥å¿—ä¸­é—´ä»¶"><a href="#redux-æ—¥å¿—ä¸­é—´ä»¶" class="headerlink" title="redux æ—¥å¿—ä¸­é—´ä»¶"></a>redux æ—¥å¿—ä¸­é—´ä»¶</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">.â”œâ”€â”€ core.jsâ”œâ”€â”€ defaults.jsâ”œâ”€â”€ diff.jsâ”œâ”€â”€ helpers.js &#x2F;&#x2F; ä¸€äº›å¸®åŠ©å‡½æ•°â””â”€â”€ index.js0 directories, 5 files</code></pre><h2 id="defaultLogger"><a href="#defaultLogger" class="headerlink" title="defaultLogger"></a>defaultLogger</h2><p><strong>v3 ç‰ˆæœ¬ï¼Œç ´åæ€§å˜æ›´</strong></p><p>ä¹‹å‰</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import createLogger from &quot;redux-logger&quot;;</code></pre><p>ä¹‹å</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import &#123; createLogger &#125; from &quot;redux-logger&quot;;</code></pre><p><strong>æºç </strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; src&#x2F;index.jsconst defaultLogger &#x3D; (&#123; dispatch, getState &#125; &#x3D; &#123;&#125;) &#x3D;&gt; &#123;  if (typeof dispatch &#x3D;&#x3D;&#x3D; &quot;function&quot; || typeof getState &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;    &#x2F;&#x2F; createLoggerï¼ŒæŸ¯é‡ŒåŒ– å·¥å‚æ¨¡å¼    return createLogger()(&#123; dispatch, getState &#125;);  &#125;  &#x2F;&#x2F; å¦‚æœæ²¡æœ‰ä¼ é€’dispatchå’ŒgetStateï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯  &#x2F;&#x2F; v3ç‰ˆæœ¬ï¼Œç ´åæ€§å˜æ›´, æ ¹æ®ã€Šè¯­ä¹‰åŒ–ç‰ˆæœ¬ã€‹ä¸çœ‹å†…å®¹ä¹ŸçŸ¥é“æœ‰ç ´åæ€§å˜æ›´  &#x2F;&#x2F; Since 3.0.0 redux-logger exports by default logger with default settings  &#x2F;&#x2F; import createLogger from &#39;redux-logger&#39; &#x3D;&gt; import &#123; createLogger &#125; from &#39;redux-logger&#39;  console.error(&#96;[redux-logger v3] BREAKING CHANGE[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.[redux-logger v3] Change[redux-logger v3] import createLogger from &#39;redux-logger&#39;[redux-logger v3] to[redux-logger v3] import &#123; createLogger &#125; from &#39;redux-logger&#39;&#96;);&#125;;export &#123; defaults, createLogger, defaultLogger as logger &#125;;export default defaultLogger;</code></pre><h2 id="createLogger"><a href="#createLogger" class="headerlink" title="createLogger"></a>createLogger</h2><ul><li>ä½¿ç”¨ä¼ å…¥çš„ optionsï¼Œ åˆ›å»ºæ—¥å¿—è®°å½•å™¨</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;** * Creates logger with following options * åˆ›å»ºæ—¥å¿—è®°å½•å™¨ï¼Œé…ç½®å¦‚ä¸‹ï¼š * @namespace * @param &#123;object&#125; options - options for logger * @param &#123;string | function | object&#125; options.level - console[level] æ—¥å¿—çº§åˆ« * @param &#123;boolean&#125; options.duration - print duration of each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´ * @param &#123;boolean&#125; options.timestamp - print timestamp with each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´æˆ³ * @param &#123;object&#125; options.colors - custom colors å®šåˆ¶é¢œè‰² * @param &#123;object&#125; options.logger - implementation of the &#96;console&#96; API æ‰“å°æ—¥å¿—çš„å®ç° * @param &#123;boolean&#125; options.logErrors - should errors in action execution be caught, logged, and re-thrown? æ˜¯å¦æ•è·actionæ‰§è¡Œé”™è¯¯ï¼Œæ‰“å°é”™è¯¯ï¼Œå¹¶é‡æ–°æŠ›å‡º * @param &#123;boolean&#125; options.collapsed - is group collapsed? æ˜¯å¦æŠ˜å ç»„ * @param &#123;boolean&#125; options.predicate - condition which resolves logger behavior æ¡ä»¶ï¼Œå†³å®šæ—¥å¿—è®°å½•å™¨è¡Œä¸º * @param &#123;function&#125; options.stateTransformer - transform state before print æ‰“å°å‰çš„çŠ¶æ€è½¬æ¢ * @param &#123;function&#125; options.actionTransformer - transform action before print æ‰“å°å‰çš„actionè½¬æ¢ * @param &#123;function&#125; options.errorTransformer - transform error before print  æ‰“å°å‰çš„é”™è¯¯è½¬æ¢ * * @returns &#123;function&#125; logger middleware è¿”å›ä¸­é—´ä»¶ *&#x2F;function createLogger(options &#x3D; &#123;&#125;) &#123;  const loggerOptions &#x3D; Object.assign(&#123;&#125;, defaults, options);  const &#123;    logger,    stateTransformer,    errorTransformer,    predicate,    logErrors,    diffPredicate,  &#125; &#x3D; loggerOptions;  &#x2F;&#x2F; Return if &#39;console&#39; object is not defined  &#x2F;&#x2F; å¦‚æœ&#39;console&#39;å¯¹è±¡æœªå®šä¹‰ï¼Œè¿”å›  if (typeof logger &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) &#123;    return () &#x3D;&gt; (next) &#x3D;&gt; (action) &#x3D;&gt; next(action);  &#125;  &#x2F;&#x2F; Detect if &#39;createLogger&#39; was passed directly to &#39;applyMiddleware&#39;.  &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦ä¼ é€’ç»™applyMiddleware  if (options.getState &amp;&amp; options.dispatch) &#123;    &#x2F;&#x2F; eslint-disable-next-line no-console    console.error(&#96;[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:&#x2F;&#x2F; Logger with default optionsimport &#123; logger &#125; from &#39;redux-logger&#39;const store &#x3D; createStore(  reducer,  applyMiddleware(logger))&#x2F;&#x2F; Or you can create your own logger with custom options http:&#x2F;&#x2F;bit.ly&#x2F;redux-logger-optionsimport &#123; createLogger &#125; from &#39;redux-logger&#39;const logger &#x3D; createLogger(&#123;  &#x2F;&#x2F; ...options&#125;);const store &#x3D; createStore(  reducer,  applyMiddleware(logger))&#96;);    &#x2F;&#x2F; ä¸­é—´ä»¶ä¹¦å†™å¥—è·¯    return () &#x3D;&gt; (next) &#x3D;&gt; (action) &#x3D;&gt; next(action);  &#125;  const logBuffer &#x3D; [];  return (&#123; getState &#125;) &#x3D;&gt;    (next) &#x3D;&gt;    (action) &#x3D;&gt; &#123;      &#x2F;&#x2F; Exit early if predicate function returns &#39;false&#39; å¦‚æœpredicateå‡½æ•°è¿”å›falseï¼Œé€€å‡º      if (typeof predicate &#x3D;&#x3D;&#x3D; &quot;function&quot; &amp;&amp; !predicate(getState, action)) &#123;        return next(action);      &#125;      const logEntry &#x3D; &#123;&#125;;      logBuffer.push(logEntry);      logEntry.started &#x3D; timer.now();      logEntry.startedTime &#x3D; new Date();      logEntry.prevState &#x3D; stateTransformer(getState());      logEntry.action &#x3D; action;      let returnedValue;      if (logErrors) &#123;        try &#123;          returnedValue &#x3D; next(action);        &#125; catch (e) &#123;          logEntry.error &#x3D; errorTransformer(e);        &#125;      &#125; else &#123;        returnedValue &#x3D; next(action);      &#125;      logEntry.took &#x3D; timer.now() - logEntry.started;      logEntry.nextState &#x3D; stateTransformer(getState());      const diff &#x3D;        loggerOptions.diff &amp;&amp; typeof diffPredicate &#x3D;&#x3D;&#x3D; &quot;function&quot;          ? diffPredicate(getState, action)          : loggerOptions.diff;      printBuffer(logBuffer, Object.assign(&#123;&#125;, loggerOptions, &#123; diff &#125;));      logBuffer.length &#x3D; 0;      if (logEntry.error) throw logEntry.error;      return returnedValue;    &#125;;&#125;</code></pre><p><strong>defaults é»˜è®¤é…ç½®</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; src&#x2F;default.jsexport default &#123;  level: &quot;log&quot;,  logger: console,  logErrors: true,  collapsed: undefined,  predicate: undefined,  duration: false,  timestamp: true,  stateTransformer: (state) &#x3D;&gt; state,  actionTransformer: (action) &#x3D;&gt; action,  errorTransformer: (error) &#x3D;&gt; error,  colors: &#123;    title: () &#x3D;&gt; &quot;inherit&quot;,    prevState: () &#x3D;&gt; &quot;#9E9E9E&quot;,    action: () &#x3D;&gt; &quot;#03A9F4&quot;,    nextState: () &#x3D;&gt; &quot;#4CAF50&quot;,    error: () &#x3D;&gt; &quot;#F20404&quot;,  &#125;,  diff: false,  diffPredicate: undefined,  &#x2F;&#x2F; Deprecated options å·²åºŸå¼ƒé…ç½®  transformer: undefined,&#125;;&#x2F;&#x2F; å­—æ®µé‡Šä¹‰&#x2F;** * Creates logger with following options * åˆ›å»ºæ—¥å¿—è®°å½•å™¨ï¼Œé…ç½®å¦‚ä¸‹ï¼š * @namespace * @param &#123;object&#125; options - options for logger * @param &#123;string | function | object&#125; options.level - console[level] æ—¥å¿—çº§åˆ« * @param &#123;boolean&#125; options.duration - print duration of each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´ * @param &#123;boolean&#125; options.timestamp - print timestamp with each action? æ‰“å°æ¯ä¸ªactionçš„æ—¶é—´æˆ³ * @param &#123;object&#125; options.colors - custom colors å®šåˆ¶é¢œè‰² * @param &#123;object&#125; options.logger - implementation of the &#96;console&#96; API æ‰“å°æ—¥å¿—çš„å®ç° * @param &#123;boolean&#125; options.logErrors - should errors in action execution be caught, logged, and re-thrown? æ˜¯å¦æ•è·actionæ‰§è¡Œé”™è¯¯ï¼Œæ‰“å°é”™è¯¯ï¼Œå¹¶é‡æ–°æŠ›å‡º * @param &#123;boolean&#125; options.collapsed - is group collapsed? æ˜¯å¦æŠ˜å ç»„ * @param &#123;boolean&#125; options.predicate - condition which resolves logger behavior æ¡ä»¶ï¼Œå†³å®šæ—¥å¿—è®°å½•å™¨è¡Œä¸º * @param &#123;function&#125; options.stateTransformer - transform state before print æ‰“å°å‰çš„çŠ¶æ€è½¬æ¢ * @param &#123;function&#125; options.actionTransformer - transform action before print æ‰“å°å‰çš„actionè½¬æ¢ * @param &#123;function&#125; options.errorTransformer - transform error before print  æ‰“å°å‰çš„é”™è¯¯è½¬æ¢ * * @returns &#123;function&#125; logger middleware è¿”å›ä¸­é—´ä»¶ *&#x2F;</code></pre><p><strong>å¥‡æ€ª</strong></p><ul><li>è¿™ä¸¤ä¸ªé…ç½®åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ï¼Œæ²¡æ‰¾åˆ°ç›¸å…³æµ‹è¯•ä»£ç </li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"> &#x2F;&#x2F; é…ç½® diff: false, &#x2F;&#x2F; diffPredicate: undefined, &#x2F;&#x2F; ... const diff &#x3D;       loggerOptions.diff &amp;&amp; typeof diffPredicate &#x3D;&#x3D;&#x3D; &quot;function&quot;         ? diffPredicate(getState, action)         : loggerOptions.diff; &#x2F;&#x2F; æ‰“å°æ—¥å¿—ä¸­ printBuffer(logBuffer, Object.assign(&#123;&#125;, loggerOptions, &#123; diff &#125;)); &#x2F;&#x2F; src&#x2F;core.js printBufferçš„å®šä¹‰function printBuffer(buffer, options) &#123;   const &#123;     &#x2F;&#x2F; ...       diff,   &#125; &#x3D; options;   &#x2F;&#x2F; å¦‚æœå¼€å¯   if (diff) &#123;     &#x2F;&#x2F; æ‰§è¡Œäº† diffLogger     diffLogger(prevState, nextState, logger, isCollapsed);   &#125;&#125;&#x2F;&#x2F; src&#x2F;diff.jsexport default function diffLogger(prevState, newState, logger, isCollapsed) &#123;  &#x2F;&#x2F; import differ from &#39;deep-diff&#39;;è®¡ç®—å¯¹è±¡å·®å¼‚åŒ–çš„åŒ…  const diff &#x3D; differ(prevState, newState);  try &#123;    if (isCollapsed) &#123;      logger.groupCollapsed(&#39;diff&#39;);    &#125; else &#123;      logger.group(&#39;diff&#39;);    &#125;  &#125; catch (e) &#123;    logger.log(&#39;diff&#39;);  &#125;  &#x2F;&#x2F; æœ‰å·®å¼‚æ‰§è¡Œè¾“å‡ºï¼Œè¿™ä¸ªå·®å¼‚åŒ…å«ç±»å‹kind E:ç¼–è¾‘ N:æ–°å¢ D:åˆ é™¤ A:æ•°ç»„  &#x2F;&#x2F; dictionaryä¸ºå¯¹è±¡ï¼Œå¯¹kindå€¼è¿›è¡Œæšä¸¾  &#x2F;&#x2F; éå†è¾“å‡º  if (diff) &#123;    diff.forEach((elem) &#x3D;&gt; &#123;      const &#123; kind &#125; &#x3D; elem;      const output &#x3D; render(elem);      logger.log(&#96;%c $&#123;dictionary[kind].text&#125;&#96;, style(kind), ...output);    &#125;);  &#125; else &#123;    logger.log(&#39;â€”â€” no diff â€”â€”&#39;);  &#125;  try &#123;    logger.groupEnd();  &#125; catch (e) &#123;    logger.log(&#39;â€”â€” diff end â€”â€” &#39;);  &#125;&#125;</code></pre><h2 id="helpers"><a href="#helpers" class="headerlink" title="helpers"></a>helpers</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; repeat + pad &#x3D; padLeft å·¦ä¾§è¡¥é›¶ï¼Œ eså¤šå°‘æœ‰ä¸ªapiexport const repeat &#x3D; (str, times) &#x3D;&gt; (new Array(times + 1)).join(str);export const pad &#x3D; (num, maxLength) &#x3D;&gt; repeat(&#39;0&#39;, maxLength - num.toString().length) + num;&#x2F;&#x2F; æ—¶é—´æ ¼å¼åŒ–export const formatTime &#x3D; time &#x3D;&gt; &#96;$&#123;pad(time.getHours(), 2)&#125;:$&#123;pad(time.getMinutes(), 2)&#125;:$&#123;pad(time.getSeconds(), 2)&#125;.$&#123;pad(time.getMilliseconds(), 3)&#125;&#96;;&#x2F;&#x2F; Use performance API if it&#39;s available in order to get better precisionexport const timer &#x3D;(typeof performance !&#x3D;&#x3D; &#39;undefined&#39; &amp;&amp; performance !&#x3D;&#x3D; null) &amp;&amp; typeof performance.now &#x3D;&#x3D;&#x3D; &#39;function&#39; ?  performance :  Date;</code></pre><p><strong>è¿è¡Œæµ‹è¯•ä¸‹</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">const repeat &#x3D; (str, times) &#x3D;&gt; (new Array(times + 1)).join(str);const pad &#x3D; (num, maxLength) &#x3D;&gt; repeat(&#39;0&#39;, maxLength - num.toString().length) + num;const formatTime &#x3D; time &#x3D;&gt; &#96;$&#123;pad(time.getHours(), 2)&#125;:$&#123;pad(time.getMinutes(), 2)&#125;:$&#123;pad(time.getSeconds(), 2)&#125;.$&#123;pad(time.getMilliseconds(), 3)&#125;&#96;;console.log(formatTime(new Date()))&#x2F;&#x2F; è¾“å‡º18:58:15.667</code></pre><h2 id="æºç å›¾"><a href="#æºç å›¾" class="headerlink" title="æºç å›¾"></a>æºç å›¾</h2><p><img src="http://t-blog-images.aijs.top/img/20220527190102.webp"></p><h2 id="deep-diff"><a href="#deep-diff" class="headerlink" title="deep-diff"></a>deep-diff</h2><ul><li>çœ‹ä¸‹ä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒçš„äº‹ä¾‹</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">var lhs &#x3D; &#123;name: &#39;my object&#39;,description: &#39;it\&#39;s an object!&#39;,details: &#123;it: &#39;has&#39;,an: &#39;array&#39;,with: [&#39;a&#39;, &#39;few&#39;, &#39;elements&#39;]&#125;&#125;;var rhs &#x3D; &#123;name: &#39;updated object&#39;,description: &#39;it\&#39;s an object!&#39;,details: &#123;it: &#39;has&#39;,an: &#39;array&#39;,with: [&#39;a&#39;, &#39;few&#39;, &#39;more&#39;, &#39;elements&#39;, &#123; than: &#39;before&#39; &#125;]&#125;&#125;;var differences &#x3D; deep.diff(lhs, rhs);&#x2F;&#x2F; è¾“å‡º27 May 17:27:12 - [  DiffEdit &#123;    kind: &#39;E&#39;,    path: [ &#39;name&#39; ],    lhs: &#39;my object&#39;,    rhs: &#39;updated object&#39;  &#125;,  DiffArray &#123;    kind: &#39;A&#39;,    path: [ &#39;details&#39;, &#39;with&#39; ],    index: 4,    item: DiffNew &#123; kind: &#39;N&#39;, rhs: &#123; than: &#39;before&#39; &#125; &#125;  &#125;,  DiffArray &#123;    kind: &#39;A&#39;,    path: [ &#39;details&#39;, &#39;with&#39; ],    index: 3,    item: DiffNew &#123; kind: &#39;N&#39;, rhs: &#39;elements&#39; &#125;  &#125;,  DiffEdit &#123;    kind: &#39;E&#39;,    path: [ &#39;details&#39;, &#39;with&#39;, 2 ],    lhs: &#39;elements&#39;,    rhs: &#39;more&#39;  &#125;]</code></pre>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redux </tag>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode i18n-ally</title>
      <link href="//post/2022-05-27i18n.html"/>
      <url>//post/2022-05-27i18n.html</url>
      
        <content type="html"><![CDATA[<h2 id="å›½é™…åŒ–"><a href="#å›½é™…åŒ–" class="headerlink" title="å›½é™…åŒ–"></a>å›½é™…åŒ–</h2><ul><li>å¤§å‹å…¬å¸çš„å›½é™…åŒ–éœ€æ±‚å¾ˆé«˜ï¼Œéœ€è¦æ”¯æŒå¤šè¯­è¨€ï¼Œæ¯”å¦‚ä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰ç­‰ã€‚</li><li>i18n-allyæ˜¯ä¸€ä¸ªåŸºäºvscodeçš„å›½é™…åŒ–å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿçš„å®ç°å›½é™…åŒ–ã€‚</li></ul><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul><li>å¦‚æœç»å¸¸åšå›½é™…åŒ–çš„ç ”å‘ï¼Œåº”è¯¥å¾ˆæ¸…æ¥šï¼Œä»£ç ä¸­å†™å¤šè¯­è¨€ï¼Œç„¶è€Œï¼Œå¤šè¯­è¨€åœ¨é¡¹ç›®ä¸­ç»´æŠ¤æ˜¯éå¸¸å›°éš¾çš„ã€‚</li><li>å½“é‡åˆ°å¤§å‹é¡¹ç›®ï¼Œä¸šåŠ¡è¦åšæ‹†åˆ†æˆä¸º<code>å¾®å‰ç«¯æ¶æ„</code>ï¼Œå¤šè¯­è¨€è¦åœ¨å¤šä¸ªé¡¹ç›®ä¸­ç»´æŠ¤ï¼Œæµªè´¹æ—¶é—´ä¸è¯´ï¼Œè¿˜å¯èƒ½é€ æˆä¸ä¸€è‡´é—®é¢˜</li><li>å¤„ç†æ–¹å¼ï¼š<ol><li>å°†å¯¹åº”çš„å¤šè¯­è¨€å¼€å‘ä¸ºnpmåŒ…ï¼Œåœ¨é¡¹ç›®ä¸­å¼•å…¥</li><li>æ‹†å¤šè¯­è¨€ä¸ºä¸€ä¸ªåº”ç”¨å¹³å°ï¼Œå®ç°å¤šé¡¹ç›®å…±äº«ï¼Œå®ç°å¯è§†åŒ–äº¤äº’ï¼ˆæˆ‘ä»¬ç›®å‰ä½¿ç”¨ï¼Œè‡ªç ”localizeå¹³å°ï¼Œå®ç°å¤šè¯­è¨€ç®¡ç†ï¼‰</li></ol></li></ul><h2 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h2><p><strong>åº”ç”¨å¹³å°</strong></p><ul><li>åŠ¨æ€ç”Ÿæ•ˆï¼š ä¿®æ”¹å¤šè¯­è¨€ä¸éœ€è¦é‡å¯ã€å‘å¸ƒæœåŠ¡</li><li>ç¿»è¯‘ç®¡ç†ï¼šå¤šäººååŒåœ¨çº¿ç¿»è¯‘</li><li>ç‰ˆæœ¬ç®¡ç†ï¼š è®°å½•ç¿»è¯‘å˜æ›´è®°å½•ä»¥åŠå¯¹åº”çš„æ“ä½œäººï¼Œæ–¹ä¾¿å®šä½ä¸æ’é”™</li><li>è‡ªåŠ¨å¤šåŒºåŒæ­¥ï¼šåªéœ€åœ¨ä¸­å›½åŒºä¿®æ”¹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŒæ­¥åˆ°å›½å¤–5åŒº</li></ul><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul><li>æç¤ºä¼˜é›…ï¼Œæœªå¤„ç†çš„å¤šè¯­è¨€ä¼šæœ‰æç¤º</li><li>ç¼–è¾‘æ–¹ä¾¿</li></ul><p align="center"><img src="https://github.com/lokalise/i18n-ally/blob/main/screenshots/full-logo-new.png?raw=true" alt="logo" width="450"/></p><p align='center'>English | <a href="https://github.com/lokalise/i18n-ally/blob/main/README.zh-CN.md">ç®€ä½“ä¸­æ–‡</a></p><p align="center" style="display: flex; flex-wrap: wrap"><a href="https://marketplace.visualstudio.com/items?itemName=lokalise.i18n-ally" target="__blank"><img src="https://img.shields.io/visual-studio-marketplace/v/lokalise.i18n-ally.svg?color=blue&amp;label=VS%20Code%20Marketplace&logo=visual-studio-code" alt="Visual Studio Marketplace Version" /></a><a href="https://marketplace.visualstudio.com/items?itemName=lokalise.i18n-ally" target="__blank"><img src="https://img.shields.io/visual-studio-marketplace/d/lokalise.i18n-ally.svg?color=4bdbe3" alt="Visual Studio Marketplace Downloads" /></a><a href="https://marketplace.visualstudio.com/items?itemName=lokalise.i18n-ally" target="__blank"><img src="https://img.shields.io/visual-studio-marketplace/i/lokalise.i18n-ally.svg?color=63ba83" alt="Visual Studio Marketplace Installs" /></a><a href="https://marketplace.visualstudio.com/items?itemName=lokalise.i18n-ally" target="__blank"><img src="https://vsmarketplacebadge.apphb.com/trending-monthly/lokalise.i18n-ally.svg?color=a1b858" alt="Marketplace Trending Monthly" /></a><br/><a href="https://github.com/lokalise/i18n-ally/wiki" target="__blank"><img alt="Wiki" src="https://img.shields.io/static/v1?label=docs&message=wiki&color=e3897b"></a><a href="https://github.com/lokalise/i18n-ally" target="__blank"><img src="https://img.shields.io/github/last-commit/lokalise/i18n-ally.svg?color=c977be" alt="GitHub last commit" /></a><a href="https://github.com/lokalise/i18n-ally/issues" target="__blank"><img src="https://img.shields.io/github/issues/lokalise/i18n-ally.svg?color=a38eed" alt="GitHub issues" /></a><a href="https://github.com/lokalise/i18n-ally" target="__blank"><img alt="GitHub stars" src="https://img.shields.io/github/stars/lokalise/i18n-ally?style=social"></a></p><p align='center'><b>v2.0</b> is released with new <a href='https://github.com/lokalise/i18n-ally/wiki/Editor-UI'>Editor UI</a> and <a href='https://github.com/lokalise/i18n-ally/wiki/Review-&-Collaboration-System'>Review System</a> ğŸ‰</p><p align='center'><i><a href="https://github.com/lokalise/i18n-ally/wiki/Migration-v1.x">Migrate from v1.x</a></i></p><br><p align="center"><a href='https://github.com/lokalise/i18n-ally/wiki/Supported-Frameworks' target="__blank"><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/supported-frameworks.png?raw=true" alt="Supported Frameworks" width="550"/></a></p><h3 align="center">Maintained by</h3><p align="center"><a title="Lokalise: accelerate localization from code to delivery" href="https://lokalise.com/?utm_source=vscmarket&amp;utm_campaign=i18nally&amp;utm_medium=banner"><img src="https://github.com/lokalise/i18n-ally/raw/screenshots/lokalise-logo.png?raw=true" alt="Lokalise logo" width="275px"></a><br><sup>Lokalise is the fastest growing language cloud technology made by developers, for developers.<br>As a collaborative productivity platform, it helps structure and automate the translation and localization process for any company in the world.<br>Lokaliseæ˜¯å¼€å‘äººå‘˜ä¸ºå¼€å‘äººå‘˜å¼€å‘çš„å¢é•¿æœ€å¿«çš„è¯­è¨€äº‘æŠ€æœ¯<br>ä½œä¸ºä¸€ä¸ªåä½œç”Ÿäº§åŠ›å¹³å°ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä¸–ç•Œä¸Šä»»ä½•å…¬å¸æ„å»ºå’Œè‡ªåŠ¨åŒ–ç¿»è¯‘å’Œæœ¬åœ°åŒ–è¿‡ç¨‹ã€‚<a title="Lokalise: accelerate localization from code to delivery" href="https://lokalise.com/?utm_source=vscmarket&amp;utm_campaign=i18nally&amp;utm_medium=banner">Learn more</a></sup></p><br><br><h4 align="center"><a href="https://github.com/lokalise/i18n-ally/wiki">ğŸ“– Docs æ–‡æ¡£</a>&nbsp;|&nbsp;<a href="https://github.com/lokalise/i18n-ally/wiki/FAQ">ğŸ’­ FAQ é—®ç­”</a>&nbsp;|&nbsp;<a href="https://github.com/lokalise/i18n-ally/wiki/Configurations">âš™ï¸ Configs é…ç½®</a>&nbsp;|&nbsp;<a href="https://github.com/lokalise/i18n-ally/wiki/Locale-Formats#supported-locale-formats">ğŸ“œ Supported Formats æ”¯æŒæ ¼å¼</a>&nbsp;|&nbsp;<a href="https://github.com/lokalise/i18n-ally/wiki/Contribute">ğŸ§± Contribute è´¡çŒ®</a></h4><br><br><h3 align='center'>Inline Annotations è¡Œå†…æç¤º</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/annotation-animated.gif?raw=true"></p><h3 align='center'>Hover and Direct Actions æ‚¬åœå’Œç›´æ¥æ“ä½œ</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/hover.png?raw=true"></p><h3 align='center'>Manage All Translations in One Place åœ¨ä¸€ä¸ªä½ç½®ç®¡ç†æ‰€æœ‰ç¿»è¯‘</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/review-sidebar.png?raw=true"></p><h3 align='center'><a href='https://github.com/lokalise/i18n-ally/wiki/Editor-UI'>Editor UIç¼–è¾‘ç•Œé¢</a> & <a href='https://github.com/lokalise/i18n-ally/wiki/Review-&-Collaboration-System'>Review System é¢„è§ˆç³»ç»Ÿ</a></h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/review-editor.png?raw=true"></p><h3 align='center'>Extract Translations from Code ä»ä»£ç ä¸­æå–ç¿»è¯‘</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/extract.png?raw=true"></p><h3 align='center'>Report Missing Translations æŠ¥å‘Šç¼ºå¤±çš„ç¿»è¯‘</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/problems.png?raw=true"></p><h3 align='center'>Machine Translation æœºå™¨ç¿»è¯‘</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/quick-actions.png?raw=true"></p><h3 align='center'>Annotations for JSON and YAML æ¥æºäºJSON å’Œ YAMLçš„æç¤º</h3><p><img src="https://github.com/lokalise/i18n-ally/blob/screenshots/annotation-locale.png?raw=true"></p><h3 align="center">General Features</h3><ul><li>Supports multi-root workspaces  æ”¯æŒå¤šä¸ªå·¥ä½œç©ºé—´</li><li>Supports remote development æ”¯æŒè¿œç¨‹å¼€å‘</li><li>Supports numerous popular frameworks æ”¯æŒå¤šç§æµè¡Œæ¡†æ¶</li><li>Supports <a href="https://kazupon.github.io/vue-i18n/guide/messages.html#linked-locale-messages">linked locale messages é“¾æ¥çš„åŒºåŸŸè®¾ç½®æ¶ˆæ¯</a></li><li>Uses i18n for the extension itself, of course. å½“ç„¶ï¼Œå°†i18nç”¨äºæ‰©å±•æœ¬èº«ã€‚ <a href="https://github.com/lokalise/i18n-ally#-multilingual-support">Translation List ç¿»è¯‘åˆ—è¡¨</a></li></ul><h2 id="ğŸŒ-Multilingual-Support-å¤šè¯­è¨€æ”¯æŒ"><a href="#ğŸŒ-Multilingual-Support-å¤šè¯­è¨€æ”¯æŒ" class="headerlink" title="ğŸŒ Multilingual Support å¤šè¯­è¨€æ”¯æŒ"></a>ğŸŒ Multilingual Support å¤šè¯­è¨€æ”¯æŒ</h2><p>This extension itself supports i18n as well. It will be auto-matched to the display language you use in your VS Code editor. We currently support the following languages.<br>è¿™ä¸ªæ‰©å±•æ”¯æŒå¤šè¯­è¨€ã€‚å®ƒå°†è‡ªåŠ¨åŒ¹é…åˆ°ä½ åœ¨VS Codeç¼–è¾‘å™¨ä¸­ä½¿ç”¨çš„è¯­è¨€ã€‚æˆ‘ä»¬ç›®å‰æ”¯æŒçš„è¯­è¨€æœ‰ï¼š</p><table><thead><tr><th>Language</th><th>Maintainer</th><th>Contributors</th></tr></thead><tbody><tr><td>English   è‹±è¯­</td><td><a href="https://github.com/antfu">@antfu</a></td><td><a href="https://github.com/rubjo">@rubjo</a>, <a href="https://github.com/EdRands">@EdRands</a></td></tr><tr><td>Simplified Chinese (ç®€ä½“ä¸­æ–‡)</td><td><a href="https://github.com/antfu">@antfu</a></td><td></td></tr><tr><td>Traditional Chinese (ç¹é«”ä¸­æ–‡)</td><td><a href="https://github.com/antfu">@antfu</a></td><td></td></tr><tr><td>Norwegian (Norsk) æŒªå¨è¯­</td><td></td><td><a href="https://github.com/rubjo">@rubjo</a></td></tr><tr><td>Spanish (EspaÃ±ol) è¥¿ç­ç‰™çš„</td><td></td><td><a href="https://github.com/Baltimer">@Baltimer</a></td></tr><tr><td>Japanese (æ—¥æœ¬èª) æ—¥è¯­</td><td></td><td><a href="https://github.com/isdh">@isdh</a></td></tr><tr><td>Dutch (Nederlands) è·å…°è¯­</td><td></td><td><a href="https://github.com/Niekvdm">@Niekvdm</a>, <a href="https://github.com/Excalibaard">@Excalibaard</a></td></tr><tr><td>Portuguese (Brazilian) è‘¡è„ç‰™è¯­</td><td></td><td><a href="https://github.com/Ibcs16">@Ibcs16</a></td></tr><tr><td>French (FranÃ§ais) æ³•è¯­</td><td></td><td><a href="https://github.com/Nicoxx45">@Nicoxx45</a>, <a href="https://github.com/eri">@eri</a></td></tr><tr><td>Swedish (Svenska)ç‘å…¸è¯­</td><td><a href="https://github.com/vladdeSV">@vladdeSV</a></td><td></td></tr><tr><td>Ukrainian (Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°) ä¹Œå…‹å…°è¯­</td><td></td><td><a href="https://github.com/uhodav">@uhodav</a></td></tr><tr><td>Russian (Ğ ÑƒÑÑĞºĞ¸Ğ¹) ä¿„è¯­</td><td></td><td><a href="https://github.com/uhodav">@uhodav</a></td></tr><tr><td>German (Deutsch) å¾·è¯­</td><td><a href="https://github.com/alexanderniebuhr">@alexanderniebuhr</a></td><td></td></tr><tr><td>Turkish (TÃ¼rkÃ§e) åœŸè€³å…¶è¯­</td><td></td><td><a href="https://github.com/eri">@eri</a></td></tr></tbody></table><p><a href="https://github.com/lokalise/i18n-ally/wiki/Contribute#working-on-translations"><strong>å¸®å¿™ç¿»è¯‘</strong></a></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ğŸ‘¨â€ğŸ’» å¦‚æœæ‚¨æƒ³å¸®åŠ©ä¸€ç§è¯­è¨€çš„ç¿»è¯‘æ›´æ–°ï¼Œè¯·åœ¨<strong>ç»´æŠ¤è€…</strong>å­—æ®µä¸­è¾“å…¥æ‚¨çš„å§“åã€‚æˆ‘ä¼šåœ¨éœ€è¦çš„æ—¶å€™æåˆ°ä½ ã€‚éå¸¸æ„Ÿè°¢ã€‚</p></blockquote><h2 id="â¤ï¸-æ„Ÿè°¢"><a href="#â¤ï¸-æ„Ÿè°¢" class="headerlink" title="â¤ï¸ æ„Ÿè°¢"></a>â¤ï¸ æ„Ÿè°¢</h2><p>æ­¤æ’ä»¶çš„çµæ„Ÿæ¥æºäº<a href="https://github.com/think2011/vscode-vue-i18n">think2011&#x2F;vscode-vue-i18n</a>. å¦‚æœæ²¡æœ‰<a href="https://github.com/think2011">@think2011</a>,i18n-allyä¸ä¼šå­˜åœ¨</p><p>å¯¹Vueå•æ–‡ä»¶ç»„ä»¶ï¼ˆSFCï¼‰çš„æ”¯æŒç”±[kazupon&#x2F;Vue-i18n-locale-message]æä¾›æ”¯æŒ(<a href="https://github.com/kazupon/vue-i18n-locale-message)%EF%BC%8C%E5%AE%83%E6%98%AF%E7%94%B1vue-i18n%E7%9A%84%E4%BD%9C%E8%80%85%E5%88%9B%E5%BB%BA%E7%9A%84%E3%80%82%E8%B0%A2%E8%B0%A2%E4%BD%A0%E5%81%9A%E8%BF%99%E4%B8%AA%EF%BC%81">https://github.com/kazupon/vue-i18n-locale-message)ï¼Œå®ƒæ˜¯ç”±vue-i18nçš„ä½œè€…åˆ›å»ºçš„ã€‚è°¢è°¢ä½ åšè¿™ä¸ªï¼</a></p><h3 id="ä»£ç å…±äº«è€…"><a href="#ä»£ç å…±äº«è€…" class="headerlink" title="ä»£ç å…±äº«è€…"></a>ä»£ç å…±äº«è€…</h3><p>éå¸¸æ„Ÿè°¢æ‰€æœ‰æ°å‡ºçš„è´¡çŒ®è€…ï¼š<br><a href="https://github.com/lokalise/i18n-ally/graphs/contributors"><img src="https://opencollective.com/i18n-ally/contributors.svg?width=890"/></a></p><h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><p><a href="https://github.com/lokalise/i18n-ally/blob/master/LICENSE">MIT License</a> Â© 2019-PRESENT <a href="https://github.com/antfu">Anthony Fu</a></p><p>MIT License Â© 2018-2019 <a href="https://github.com/think2011">think2011</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><a href="https://marketplace.visualstudio.com/items?itemName=Lokalise.i18n-ally">Visual Studio Code&gt;Other&gt;i18n Ally</a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://github.com/lokalise/i18n-ally">github å®˜ç½‘</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redux-thunkæºç </title>
      <link href="//post/2022-05-27redux-thunk.html"/>
      <url>//post/2022-05-27redux-thunk.html</url>
      
        <content type="html"><![CDATA[<h2 id="æºç ç‰ˆæœ¬"><a href="#æºç ç‰ˆæœ¬" class="headerlink" title="æºç ç‰ˆæœ¬"></a>æºç ç‰ˆæœ¬</h2><p><a href="https://github.com/reduxjs/redux-thunk/releases/tag/v2.4.1">v2.4.1</a></p><h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><ul><li>é€šè¿‡reduxæºç applyMiddlewareäº†è§£åˆ°ï¼Œæ˜¯å¯¹store.dispatchè¿›è¡Œå¢å¼º</li><li>å¯ä»¥æ¥å—ä¸€ä¸ªè¿”å›å‡½æ•°çš„action creatorã€‚å¦‚æœè¿™ä¸ªaction creator è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±æŒ‰ç…§åŸæ¥çš„next(action)æ‰§è¡Œã€‚</li><li>å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­æ‰§è¡Œä¸€äº›å¼‚æ­¥çš„æ“ä½œ</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function addCount() &#123;  return &#123;type: ADD_COUNT&#125;&#125; export function addCountAsync() &#123;  return dispatch &#x3D;&gt; &#123; &#x2F;&#x2F; dispatchå¯¹åº”æºç çš„ ï¼š action(dispatch, getState, extraArgument);çš„ç¬¬ä¸€ä¸ªå‚æ•°    setTimeout( () &#x3D;&gt; &#123;      dispatch(addCount())    &#125;,2000)  &#125;&#125;</code></pre><ul><li>addCountAsyncå‡½æ•°å°±è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œå°†dispatchä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’è¿›å»ï¼Œåœ¨å‡½æ•°å†…è¿›è¡Œå¼‚æ­¥æ“ä½œå°±å¯ä»¥äº†ã€‚</li></ul><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><ul><li>è¿™ä¸ªæ–‡ä»¶ç»“æ„ä¸reduxã€react-reduxç›¸æ¯”ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œè¿™é‡ŒåŠä»¥åå¦‚æ— å¿…è¦ä¸åœ¨è¿›è¡Œé˜…è¯»</li><li>ç®€å•æ‰«ä¸€çœ¼å°±å¥½</li></ul><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** A function that accepts a potential &quot;extra argument&quot; value to be injected later, * and returns an instance of the thunk middleware that uses that value *&#x2F;&#x2F;** ä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯èƒ½çš„&quot;extra argument&quot;å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªthunkä¸­é—´ä»¶ï¼Œå®ƒä½¿ç”¨è¿™ä¸ªå€¼ *&#x2F;function createThunkMiddleware&lt;  State &#x3D; any,  BasicAction extends Action &#x3D; AnyAction,  ExtraThunkArg &#x3D; undefined&gt;(extraArgument?: ExtraThunkArg) &#123;  &#x2F;&#x2F; Standard Redux middleware definition pattern:  &#x2F;&#x2F; æ ‡å‡†Reduxä¸­é—´ä»¶å®šä¹‰æ¨¡å¼:  &#x2F;&#x2F; See: https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#writing-custom-middleware  const middleware: ThunkMiddleware&lt;State, BasicAction, ExtraThunkArg&gt; &#x3D;    (&#123; dispatch, getState &#125;) &#x3D;&gt; (next) &#x3D;&gt;  (action) &#x3D;&gt; &#123;      &#x2F;&#x2F; The thunk middleware looks for any functions that were passed to &#96;store.dispatch&#96;.      &#x2F;&#x2F; If this &quot;action&quot; is really a function, call it and return the result.      &#x2F;&#x2F; è¿™ä¸ªthunkä¸­é—´ä»¶ä¼šæŸ¥æ‰¾store.dispatchä¼ å…¥çš„ä»»ä½•å‡½æ•°ã€‚å¦‚æœè¿™ä¸ª&quot;action&quot;æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨å®ƒå¹¶è¿”å›ç»“æœã€‚      if (typeof action &#x3D;&#x3D;&#x3D; &quot;function&quot;) &#123;        &#x2F;&#x2F; Inject the store&#39;s &#96;dispatch&#96; and &#96;getState&#96; methods, as well as any &quot;extra arg&quot;        &#x2F;&#x2F; æ³¨å…¥storeçš„dispatchå’ŒgetStateæ–¹æ³•ï¼Œä»¥åŠä»»æ„çš„&quot;extra arg&quot;        return action(dispatch, getState, extraArgument);      &#125;      &#x2F;&#x2F; å¦åˆ™ï¼Œåƒå¾€å¸¸ä¸€æ ·å°†æ“ä½œä¼ é€’ç»™ä¸­é—´ä»¶é“¾      &#x2F;&#x2F; Otherwise, pass the action down the middleware chain as usual      return next(action);    &#125;;  return middleware;&#125;</code></pre><p><strong>ä¸­é—´ä»¶æ¨¡å¼</strong></p><p>æŸ¯é‡ŒåŒ–ï¼šå°†ä¸€ä¸ªå‡½æ•°çš„å‚æ•°åˆ†è§£æˆå¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªæ–°çš„å‡½æ•°å¯ä»¥è¢«è°ƒç”¨ï¼Œå¹¶ä¸”è¿”å›åŸå‡½æ•°çš„ç»“æœã€‚</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const anotherExampleMiddleware &#x3D; storeAPI &#x3D;&gt; next &#x3D;&gt; action &#x3D;&gt; &#123;  &#x2F;&#x2F; Do something in here, when each action is dispatched  return next(action)&#125;</code></pre><p><strong>storeAPI</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; storeAPIconst store &#x3D; &#123;  dispatch: dispatch as Dispatch&lt;A&gt;,  subscribe,  getState,  replaceReducer,  [$$observable]: observable&#125; as unknown as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext</code></pre><p><em>å·¥å‚æ¨¡å¼</em></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const thunk &#x3D; createThunkMiddleware() as ThunkMiddleware &amp; &#123;  withExtraArgument&lt;    ExtraThunkArg,    State &#x3D; any,    BasicAction extends Action &#x3D; AnyAction  &gt;(    extraArgument: ExtraThunkArg  ): ThunkMiddleware&lt;State, BasicAction, ExtraThunkArg&gt;&#125;&#x2F;&#x2F; Attach the factory function so users can create a customized version&#x2F;&#x2F; with whatever &quot;extra arg&quot; they want to inject into their thunks&#x2F;&#x2F; å°è¯•å°†å·¥å‚å‡½æ•°é™„åŠ åˆ°ç”¨æˆ·å¯ä»¥åˆ›å»ºä»»ä½•é¢å¤–çš„&quot;extra arg&quot;çš„thunkä¸­é—´ä»¶thunk.withExtraArgument &#x3D; createThunkMiddlewareexport default thunk</code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/reduxjs/redux-thunk/blob/master/src/index.ts">redux-thunkæºç </a><br><a href="https://blog.csdn.net/hsany330/article/details/105951197">Reduxä¸­é—´ä»¶ä¹‹redux-thunkä½¿ç”¨è¯¦è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redux </tag>
            
            <tag> æºç  </tag>
            
            <tag> redux-thunk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js ä»£ç æ³¨é‡Š</title>
      <link href="//post/2022-05-26code.html"/>
      <url>//post/2022-05-26code.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç æ³¨é‡Š"><a href="#ä»£ç æ³¨é‡Š" class="headerlink" title="ä»£ç æ³¨é‡Š"></a>ä»£ç æ³¨é‡Š</h2><p><code>//</code>è¿™ç§jsæ³¨é‡Šä»£ç åœ¨vscodeå…¶ä»–åœ°æ–¹å¼•ç”¨æ—¶å€™ï¼Œæ²¡æœ‰æç¤ºï¼Œ å¦‚æœéœ€è¦æœ‰æç¤ºï¼Œéœ€è¦å†™æˆ<code>/** æç¤º **/</code></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">å†™æ³•1export enum ELeaveType &#123;  MATERNITY_ &#x3D; 17, &#x2F;&#x2F; &quot;äº§å‡&amp;è¡¥å……å‡&quot;, &quot;è¿ç»­ä½¿ç”¨ï¼Œé¢„äº§æœŸå‰15å¤©&quot;),&#125;å†™æ³•2export enum ELeaveType &#123;  &#x2F;&#x2F; &quot;äº§å‡&amp;è¡¥å……å‡&quot;, &quot;è¿ç»­ä½¿ç”¨ï¼Œé¢„äº§æœŸå‰15å¤©&quot;),  MATERNITY_ &#x3D; 17, &#125;</code></pre><p><img src="http://t-blog-images.aijs.top/img/20220526153244.webp"></p><h2 id="æœ‰æç¤ºæ³¨é‡Šå†™æ³•"><a href="#æœ‰æç¤ºæ³¨é‡Šå†™æ³•" class="headerlink" title="æœ‰æç¤ºæ³¨é‡Šå†™æ³•"></a>æœ‰æç¤ºæ³¨é‡Šå†™æ³•</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export enum ELeaveType &#123;...  &#x2F;**&quot;äº§å‡&amp;è¡¥å……å‡&quot;, &quot;è¿ç»­ä½¿ç”¨ï¼Œé¢„äº§æœŸå‰15å¤©&quot;),**&#x2F;  MATERNITY_ &#x3D; 17, ...&#125;</code></pre><p><img src="http://t-blog-images.aijs.top/img/20220526153709.webp"></p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redux æºç  2</title>
      <link href="//post/2022-05-25.redux2.html"/>
      <url>//post/2022-05-25.redux2.html</url>
      
        <content type="html"><![CDATA[<h2 id="redux-ç®€ä»‹"><a href="#redux-ç®€ä»‹" class="headerlink" title="redux ç®€ä»‹"></a>redux ç®€ä»‹</h2><p>Predictable state container for JavaScript apps</p><p>å­—é¢æ„æ€</p><p>jsåº”ç”¨å¯é¢„æµ‹çŠ¶æ€å®¹å™¨</p><p><img src="http://t-blog-images.aijs.top/img/20220527091836.webp"></p><h2 id="æ€ä¹ˆç”¨ï¼Œä¸ºä»€ä¹ˆç”¨"><a href="#æ€ä¹ˆç”¨ï¼Œä¸ºä»€ä¹ˆç”¨" class="headerlink" title="æ€ä¹ˆç”¨ï¼Œä¸ºä»€ä¹ˆç”¨"></a>æ€ä¹ˆç”¨ï¼Œä¸ºä»€ä¹ˆç”¨</h2><p><a href="https://redux.js.org/">çœ‹å®˜ç½‘ã€‚ã€‚ã€‚</a></p><h2 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a>createStore</h2><p><strong>ä»£ç æ³¨é‡Šå¦‚ä¸‹</strong></p><ul><li>redux storeæŒæœ‰stateæ ‘ï¼Œå”¯ä¸€å¯ä»¥æ”¹å˜storeä¸­æ•°æ®çš„æ–¹å¼æ˜¯dispatch</li><li>åœ¨ä½ çš„appä¸­åº”è¯¥æœ‰å”¯ä¸€ä¸€ä¸ªstore.ä¸ºäº†åŒºåˆ†ä¸åŒéƒ¨åˆ†å“åº”æ“ä½œçš„çš„çŠ¶æ€æ ‘ï¼Œå¯ä»¥å°†å‡ ä¸ªreduceré€šè¿‡combinereducersåˆå¹¶ä¸ºä¸€ä¸ªreducer</li><li>ä¸€ä¸ªæ ¹æ®å½“å‰stateå’Œè¡Œä¸ºè¿”å›æ–°stateçš„å‡½æ•°</li><li>åˆå§‹stateï¼Œ</li><li>storeä¸­é—´ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶å¢å¼ºstore</li><li>redux store å¯ä»¥è¯»å–stateï¼Œdispatchè¡Œä¸ºï¼Œè®¢é˜…æ”¹å˜</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Creates a Redux store that holds the state tree. * The only way to change the data in the store is to call &#96;dispatch()&#96; on it. *  * redux storeæŒæœ‰stateæ ‘ï¼Œå”¯ä¸€å¯ä»¥æ”¹å˜storeä¸­æ•°æ®çš„æ–¹å¼æ˜¯dispatch *  * There should only be a single store in your app. To specify how different * parts of the state tree respond to actions, you may combine several reducers * into a single reducer function by using &#96;combineReducers&#96;. * * åœ¨ä½ çš„appä¸­åº”è¯¥æœ‰å”¯ä¸€ä¸€ä¸ªstore.ä¸ºäº†åŒºåˆ†ä¸åŒéƒ¨åˆ†å“åº”æ“ä½œçš„çš„çŠ¶æ€æ ‘ï¼Œå¯ä»¥å°†å‡ ä¸ªreduceré€šè¿‡combinereducersåˆå¹¶ä¸ºä¸€ä¸ªreducer *  * @param reducer A function that returns the next state tree, given * the current state tree and the action to handle. *  * ä¸€ä¸ªæ ¹æ®å½“å‰stateå’Œè¡Œä¸ºè¿”å›æ–°stateçš„å‡½æ•° * * @param preloadedState The initial state. You may optionally specify it * to hydrate the state from the server in universal apps, or to restore a * previously serialized user session. * If you use &#96;combineReducers&#96; to produce the root reducer function, this must be * an object with the same shape as &#96;combineReducers&#96; keys. * * åˆå§‹stateï¼Œ *  * @param enhancer The store enhancer. You may optionally specify it * to enhance the store with third-party capabilities such as middleware, * time travel, persistence, etc. The only store enhancer that ships with Redux * is &#96;applyMiddleware()&#96;. * * storeä¸­é—´ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶å¢å¼ºstore *  * @returns A Redux store that lets you read the state, dispatch actions * and subscribe to changes. *  * redux store å¯ä»¥è¯»å–stateï¼Œdispatchè¡Œä¸ºï¼Œè®¢é˜…æ”¹å˜ *&#x2F;</code></pre><p><strong>å‡½æ•°å£°æ˜</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function createStore&lt;  S,  A extends Action,  Ext &#x3D; &#123;&#125;,  StateExt &#x3D; never&gt;(  reducer: Reducer&lt;S, A&gt;, &#x2F;&#x2F; reducer  enhancer?: StoreEnhancer&lt;Ext, StateExt&gt;&#x2F;&#x2F; ä¸­é—´ä»¶): Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Extexport default function createStore&lt;  S,  A extends Action,  Ext &#x3D; &#123;&#125;,  StateExt &#x3D; never&gt;(  reducer: Reducer&lt;S, A&gt;, &#x2F;&#x2F; reducer  preloadedState?: PreloadedState&lt;S&gt;, &#x2F;&#x2F; &#x2F;&#x2F;åˆå§‹çŠ¶æ€  enhancer?: StoreEnhancer&lt;Ext, StateExt&gt; &#x2F;&#x2F; ä¸­é—´ä»¶): Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Extexport default function createStore&lt;  S,  A extends Action,  Ext &#x3D; &#123;&#125;,  StateExt &#x3D; never&gt;(  reducer: Reducer&lt;S, A&gt;,&#x2F;&#x2F; reducer  preloadedState?: PreloadedState&lt;S&gt; | StoreEnhancer&lt;Ext, StateExt&gt;, &#x2F;&#x2F;åˆå§‹çŠ¶æ€  enhancer?: StoreEnhancer&lt;Ext, StateExt&gt;&#x2F;&#x2F; ä¸­é—´ä»¶  &#x2F;&#x2F; è¿™é‡Œå¯ä»¥çœ‹åˆ° preloadedStateçš„å‚æ•°| StoreEnhancer&lt;Ext, StateExt&gt; ä¸ enhancerç±»å‹ä¸€è‡´ï¼Œ è¿™é‡Œå¤„ç†ç¬¬äºŒå‚æ•°å¯èƒ½æ˜¯ enhancer  &#x2F;&#x2F; ä»£ç ä¸»ä½“åˆ†æœ‰åšåˆ¤æ–­ï¼š  &#x2F;&#x2F; if (typeof preloadedState &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof enhancer &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;  &#x2F;&#x2F;   enhancer &#x3D; preloadedState as StoreEnhancer&lt;Ext, StateExt&gt;  &#x2F;&#x2F;   preloadedState &#x3D; undefined  &#x2F;&#x2F; &#125; ): Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext &#123;&#125;</code></pre><p><strong>createStore ä¸»ä½“ä»£ç </strong></p><ul><li>ä¸€äº›å…¥å‚æ ¡éªŒ</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">if (  (typeof preloadedState &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof enhancer &#x3D;&#x3D;&#x3D; &#39;function&#39;) ||  (typeof enhancer &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof arguments[3] &#x3D;&#x3D;&#x3D; &#39;function&#39;)) &#123;  throw new Error(    &#39;It looks like you are passing several store enhancers to &#39; +      &#39;createStore(). This is not supported. Instead, compose them &#39; +      &#39;together to a single function. See https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#creating-a-store-with-enhancers for an example.&#39;  )&#125;if (typeof preloadedState &#x3D;&#x3D;&#x3D; &#39;function&#39; &amp;&amp; typeof enhancer &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;  enhancer &#x3D; preloadedState as StoreEnhancer&lt;Ext, StateExt&gt;  preloadedState &#x3D; undefined&#125;if (typeof enhancer !&#x3D;&#x3D; &#39;undefined&#39;) &#123;  if (typeof enhancer !&#x3D;&#x3D; &#39;function&#39;) &#123;    throw new Error(      &#96;Expected the enhancer to be a function. Instead, received: &#39;$&#123;kindOf(        enhancer      )&#125;&#39;&#96;    )  &#125;  return enhancer(createStore)(    reducer,    preloadedState as PreloadedState&lt;S&gt;  ) as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Ext&#125;if (typeof reducer !&#x3D;&#x3D; &#39;function&#39;) &#123;  throw new Error(    &#96;Expected the root reducer to be a function. Instead, received: &#39;$&#123;kindOf(      reducer    )&#125;&#39;&#96;  )&#125;&#x2F;&#x2F; å½“å‰reducerlet currentReducer &#x3D; reducer&#x2F;&#x2F; å½“å‰çŠ¶æ€let currentState &#x3D; preloadedState as S&#x2F;&#x2F; å½“å‰è®¢é˜…let currentListeners: (() &#x3D;&gt; void)[] | null &#x3D; []&#x2F;&#x2F; æ–°çš„è®¢é˜…let nextListeners &#x3D; currentListenerslet isDispatching &#x3D; false&#x2F;** * This makes a shallow copy of currentListeners so we can use * nextListeners as a temporary list while dispatching. * * This prevents any bugs around consumers calling * subscribe&#x2F;unsubscribe in the middle of a dispatch. *&#x2F;&#x2F;&#x2F; æµ…æ‹·è´å½“å‰currentListenerså¾—åˆ° nextListeners ç”¨äº dispatching   &#x2F;&#x2F; ç¡®å®šæ–°çš„å¯å˜ç›‘å¬function ensureCanMutateNextListeners() &#123;  ã€‚ã€‚ã€‚&#125;&#x2F;&#x2F; è·å–storeçš„çŠ¶æ€function getState(): S &#123;  ã€‚ã€‚ã€‚&#125;&#x2F;&#x2F; ä¼ å…¥ç›‘å¬ï¼Œè¿”å›ç›‘å¬ç§»é™¤çš„å‡½æ•°function subscribe(listener: () &#x3D;&gt; void) &#123;  ã€‚ã€‚ã€‚  return function unsubscribe() &#123;    ã€‚ã€‚ã€‚ã€‚  &#125;&#125;function dispatch(action: A) &#123;  ã€‚ã€‚ã€‚&#125;&#x2F;&#x2F; ç”¨äºåŒæ„æ›´æ–°reducerfunction replaceReducer&lt;NewState, NewActions extends A&gt;(  nextReducer: Reducer&lt;NewState, NewActions&gt;): Store&lt;ExtendState&lt;NewState, StateExt&gt;, NewActions, StateExt, Ext&gt; &amp; Ext &#123;  ã€‚ã€‚ã€‚&#125;&#x2F;** * Interoperability point for observable&#x2F;reactive libraries. * @returns A minimal observable of state changes. * For more information, see the observable proposal: * https:&#x2F;&#x2F;github.com&#x2F;tc39&#x2F;proposal-observable *&#x2F;&#x2F;&#x2F; å®ç°å°å‹è§‚å¯ŸçŠ¶æ€å˜æ›´function observable() &#123;  ã€‚ã€‚ã€‚&#125;&#x2F;&#x2F; å½“storeè¢«åˆ›å»ºï¼Œåˆå§‹åŒ–æ“ä½œä¼šè¢«dispatchï¼Œï¼Œæ¯ä¸ªreducerä¼šè¿”å›æœ€åˆçš„state. æœ‰æ•ˆåœ°å¡«å……åˆå§‹çŠ¶æ€æ ‘ã€‚dispatch(&#123; type: ActionTypes.INIT &#125; as A)const store &#x3D; &#123;  dispatch: dispatch as Dispatch&lt;A&gt;,  subscribe,  getState,  replaceReducer,  [$$observable]: observable&#125; as unknown as Store&lt;ExtendState&lt;S, StateExt&gt;, A, StateExt, Ext&gt; &amp; Extreturn store &#x2F;&#x2F; storeä¸Šçš„apiæˆ‘ä»¬åˆç†Ÿæ‚‰äº†</code></pre><p><strong>ensureCanMutateNextListeners</strong></p><ul><li>æµ…æ‹·è´å½“å‰currentListenerså¾—åˆ° nextListeners ç”¨äº dispatching</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function ensureCanMutateNextListeners() &#123;  if (nextListeners &#x3D;&#x3D;&#x3D; currentListeners) &#123;    nextListeners &#x3D; currentListeners.slice()  &#125;&#125;</code></pre><p><strong>getState</strong></p><ul><li>è·å–storeçš„çŠ¶æ€</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getState(): S &#123;  if (isDispatching) &#123;    throw new Error(      &#39;You may not call store.getState() while the reducer is executing. &#39; +        &#39;The reducer has already received the state as an argument. &#39; +        &#39;Pass it down from the top reducer instead of reading it from the store.&#39;    )  &#125;  return currentState as S&#125;</code></pre><p><strong>subscribe</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;**   * Adds a change listener. It will be called any time an action is dispatched,   * and some part of the state tree may potentially have changed. You may then   * call &#96;getState()&#96; to read the current state tree inside the callback.   *   * You may call &#96;dispatch()&#96; from a change listener, with the following   * caveats:   *   * 1. The subscriptions are snapshotted just before every &#96;dispatch()&#96; call.   * If you subscribe or unsubscribe while the listeners are being invoked, this   * will not have any effect on the &#96;dispatch()&#96; that is currently in progress.   * However, the next &#96;dispatch()&#96; call, whether nested or not, will use a more   * recent snapshot of the subscription list.   *   * 2. The listener should not expect to see all state changes, as the state   * might have been updated multiple times during a nested &#96;dispatch()&#96; before   * the listener is called. It is, however, guaranteed that all subscribers   * registered before the &#96;dispatch()&#96; started will be called with the latest   * state by the time it exits.   *   * @param listener A callback to be invoked on every dispatch.   * @returns A function to remove this change listener.   *&#x2F;  &#x2F;&#x2F; ä¸Šè¿°æ³¨é‡Š  &#x2F;** æ·»åŠ ä¸€ä¸ªç›‘å¬ï¼Œåœ¨actionè¢«è§¦å‘æ—¶å€™ä¼šè°ƒç”¨ï¼Œstateä¼šè¿›è¡Œæ›´æ–°ï¼Œåœ¨å›è°ƒä¸­å¯ä»¥ç”¨getStateæ–¹æ³•è·å–å½“å‰çŠ¶æ€æ ‘   * ä¸¤ä¸ªæ³¨æ„ï¼šè®¢é˜…çš„æ˜¯åœ¨æ¯ä¸ªdispatchä¹‹å‰çš„å¿«ç…§ï¼Œ   * 1.   * è®¢é˜…æ˜¯åœ¨æ¯æ¬¡&#39;dispatchï¼ˆï¼‰&#39;è°ƒç”¨ä¹‹å‰è¿›è¡Œå¿«ç…§çš„ã€‚   * å¦‚æœåœ¨è°ƒç”¨ä¾¦å¬å™¨æ—¶è®¢é˜…æˆ–å–æ¶ˆè®¢é˜…ï¼Œè¿™å°†ä¸ä¼šå¯¹å½“å‰æ­£åœ¨è¿›è¡Œçš„â€œdispatchï¼ˆï¼‰â€äº§ç”Ÿä»»ä½•å½±å“ã€‚   * ä½†æ˜¯ï¼Œä¸‹ä¸€ä¸ª&#39;dispatchï¼ˆï¼‰&#39;è°ƒç”¨ï¼ˆæ— è®ºæ˜¯å¦åµŒå¥—ï¼‰å°†ä½¿ç”¨è®¢é˜…åˆ—è¡¨çš„æœ€æ–°å¿«ç…§ã€‚   * 2ã€‚   * ç›‘å¬å™¨ä¸åº”è¯¥æœŸæœ›çœ‹åˆ°æ‰€æœ‰çš„çŠ¶æ€æ›´æ”¹ï¼Œå› ä¸ºåœ¨è°ƒç”¨ç›‘å¬å™¨ä¹‹å‰ï¼ŒçŠ¶æ€å¯èƒ½åœ¨åµŒå¥—çš„&#39;dispatchï¼ˆï¼‰&#39;æœŸé—´è¢«å¤šæ¬¡æ›´æ–°ã€‚   * ä½†æ˜¯ï¼Œå¯ä»¥ä¿è¯åœ¨â€œdispatchï¼ˆï¼‰â€å¯åŠ¨ä¹‹å‰æ³¨å†Œçš„æ‰€æœ‰è®¢é˜…è€…åœ¨é€€å‡ºæ—¶éƒ½å°†ä»¥æœ€æ–°çŠ¶æ€è°ƒç”¨ã€‚   * *&#x2F;  function subscribe(listener: () &#x3D;&gt; void) &#123;    if (typeof listener !&#x3D;&#x3D; &#39;function&#39;) &#123;      throw new Error(        &#96;Expected the listener to be a function. Instead, received: &#39;$&#123;kindOf(          listener        )&#125;&#39;&#96;      )    &#125;    if (isDispatching) &#123;      throw new Error(        &#39;You may not call store.subscribe() while the reducer is executing. &#39; +          &#39;If you would like to be notified after the store has been updated, subscribe from a &#39; +          &#39;component and invoke store.getState() in the callback to access the latest state. &#39; +          &#39;See https:&#x2F;&#x2F;redux.js.org&#x2F;api&#x2F;store#subscribelistener for more details.&#39;      )    &#125;    let isSubscribed &#x3D; true    ensureCanMutateNextListeners()    nextListeners.push(listener) &#x2F;&#x2F; å¢åŠ     return function unsubscribe() &#123;      if (!isSubscribed) &#123;        return      &#125;      if (isDispatching) &#123;        throw new Error(          &#39;You may not unsubscribe from a store listener while the reducer is executing. &#39; +            &#39;See https:&#x2F;&#x2F;redux.js.org&#x2F;api&#x2F;store#subscribelistener for more details.&#39;        )      &#125;      isSubscribed &#x3D; false      ensureCanMutateNextListeners()      const index &#x3D; nextListeners.indexOf(listener)      nextListeners.splice(index, 1) &#x2F;&#x2F; ç§»é™¤      currentListeners &#x3D; null    &#125;  &#125;</code></pre><p><strong>dispatch</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** * Dispatches an action. It is the only way to trigger a state change. * * The &#96;reducer&#96; function, used to create the store, will be called with the * current state tree and the given &#96;action&#96;. Its return value will * be considered the **next** state of the tree, and the change listeners * will be notified. * * The base implementation only supports plain object actions. If you want to * dispatch a Promise, an Observable, a thunk, or something else, you need to * wrap your store creating function into the corresponding middleware. For * example, see the documentation for the &#96;redux-thunk&#96; package. Even the * middleware will eventually dispatch plain object actions using this method. * * @param action A plain object representing â€œwhat changedâ€. It is * a good idea to keep actions serializable so you can record and replay user * sessions, or use the time travelling &#96;redux-devtools&#96;. An action must have * a &#96;type&#96; property which may not be &#96;undefined&#96;. It is a good idea to use * string constants for action types. * * @returns For convenience, the same action object you dispatched. * * Note that, if you use a custom middleware, it may wrap &#96;dispatch()&#96; to * return something else (for example, a Promise you can await). *&#x2F;function dispatch(action: A) &#123;  if (!isPlainObject(action)) &#123; &#x2F;&#x2F; åªèƒ½æ˜¯ç®€å•çš„å¯¹è±¡    throw new Error(      &#96;Actions must be plain objects. Instead, the actual type was: &#39;$&#123;kindOf(        action      )&#125;&#39;. You may need to add middleware to your store setup to handle dispatching other values, such as &#39;redux-thunk&#39; to handle dispatching functions. See https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-4-store#middleware and https:&#x2F;&#x2F;redux.js.org&#x2F;tutorials&#x2F;fundamentals&#x2F;part-6-async-logic#using-the-redux-thunk-middleware for examples.&#96;    )  &#125;  if (typeof action.type &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;    throw new Error(      &#39;Actions may not have an undefined &quot;type&quot; property. You may have misspelled an action type string constant.&#39;    )  &#125;  if (isDispatching) &#123;    throw new Error(&#39;Reducers may not dispatch actions.&#39;)  &#125;  try &#123;    isDispatching &#x3D; true    currentState &#x3D; currentReducer(currentState, action) &#x2F;&#x2F; ä¼ å…¥å½“å‰çŠ¶æ€å’Œæ“ä½œï¼Œè¿”å›æ–°çš„çŠ¶æ€  &#125; finally &#123;    isDispatching &#x3D; false  &#125;  const listeners &#x3D; (currentListeners &#x3D; nextListeners) &#x2F;&#x2F; è§¦å‘æ›´æ–°  for (let i &#x3D; 0; i &lt; listeners.length; i++) &#123;    const listener &#x3D; listeners[i]    listener()  &#125;  return action&#125;</code></pre><h2 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a>combineReducers</h2><ul><li>ä½¿ç”¨æ—¶å€™ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨</li></ul><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import useInfoReducer from &#39;.&#x2F;userInfo&#39;import recordReducer from &#39;.&#x2F;record&#39;const rootReducer &#x3D; combineReducers(&#123;  useInfoReducer,  recordReducer&#125;)const store &#x3D; createStore(rootReducer)</code></pre><p><strong>æºç </strong></p><ul><li>è¿”å›ä¸æœŸæœ›çš„stateå‹è­¦å‘Šä¿¡æ¯</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function getUnexpectedStateShapeWarningMessage(  inputState: object,  reducers: ReducersMapObject,  action: Action,  unexpectedKeyCache: &#123; [key: string]: true &#125;) &#123;  const reducerKeys &#x3D; Object.keys(reducers)  const argumentName &#x3D;    action &amp;&amp; action.type &#x3D;&#x3D;&#x3D; ActionTypes.INIT      ? &#39;preloadedState argument passed to createStore&#39;      : &#39;previous state received by the reducer&#39;  if (reducerKeys.length &#x3D;&#x3D;&#x3D; 0) &#123;    return (      &#39;Store does not have a valid reducer. Make sure the argument passed &#39; +      &#39;to combineReducers is an object whose values are reducers.&#39;    )  &#125;  if (!isPlainObject(inputState)) &#123;    return (      &#96;The $&#123;argumentName&#125; has unexpected type of &quot;$&#123;kindOf(        inputState      )&#125;&quot;. Expected argument to be an object with the following &#96; +      &#96;keys: &quot;$&#123;reducerKeys.join(&#39;&quot;, &quot;&#39;)&#125;&quot;&#96;    )  &#125;  const unexpectedKeys &#x3D; Object.keys(inputState).filter(    key &#x3D;&gt; !reducers.hasOwnProperty(key) &amp;&amp; !unexpectedKeyCache[key]  )  unexpectedKeys.forEach(key &#x3D;&gt; &#123;    unexpectedKeyCache[key] &#x3D; true  &#125;)  if (action &amp;&amp; action.type &#x3D;&#x3D;&#x3D; ActionTypes.REPLACE) return  if (unexpectedKeys.length &gt; 0) &#123;    return (      &#96;Unexpected $&#123;unexpectedKeys.length &gt; 1 ? &#39;keys&#39; : &#39;key&#39;&#125; &#96; +      &#96;&quot;$&#123;unexpectedKeys.join(&#39;&quot;, &quot;&#39;)&#125;&quot; found in $&#123;argumentName&#125;. &#96; +      &#96;Expected to find one of the known reducer keys instead: &#96; +      &#96;&quot;$&#123;reducerKeys.join(&#39;&quot;, &quot;&#39;)&#125;&quot;. Unexpected keys will be ignored.&#96;    )  &#125;&#125; &#x2F;&#x2F; å¯¹ reducerå‹è¿›è¡Œæ–­è¨€function assertReducerShape(reducers: ReducersMapObject) &#123;  Object.keys(reducers).forEach(key &#x3D;&gt; &#123;    const reducer &#x3D; reducers[key]    const initialState &#x3D; reducer(undefined, &#123; type: ActionTypes.INIT &#125;)    if (typeof initialState &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;      throw new Error(         &#x2F;&#x2F; åˆå§‹åŒ–initialStateæ—¶å€™å¯ä»¥ç”¨null,ä½†æ˜¯ä¸å¯ä»¥ç”¨undefined        &#96;The slice reducer for key &quot;$&#123;key&#125;&quot; returned undefined during initialization. &#96; +          &#96;If the state passed to the reducer is undefined, you must &#96; +          &#96;explicitly return the initial state. The initial state may &#96; +          &#96;not be undefined. If you don&#39;t want to set a value for this reducer, &#96; +          &#96;you can use null instead of undefined.&#96;      )    &#125;    if (      typeof reducer(undefined, &#123;        type: ActionTypes.PROBE_UNKNOWN_ACTION()      &#125;) &#x3D;&#x3D;&#x3D; &#39;undefined&#39;    ) &#123;      throw new Error(         &#x2F;&#x2F; 1.éšæœºç±»å‹&#x2F; redux&#x2F;*ç±»å‹ çš„æ“ä½œç±»å‹ä¸ºreduxç§æœ‰ï¼Œä¸å…è®¸ä½¿ç”¨         &#x2F;&#x2F; 2.åˆå§‹åŒ–çŠ¶æ€ä¸å¯ä»¥æ˜¯undefined,         &#x2F;&#x2F; 3.æ–°çŠ¶æ€å¦‚æœæ˜¯undefinedçš„ï¼Œå¿…é¡»è¿”å›åˆå§‹çŠ¶æ€        &#96;The slice reducer for key &quot;$&#123;key&#125;&quot; returned undefined when probed with a random type. &#96; +          &#96;Don&#39;t try to handle &#39;$&#123;ActionTypes.INIT&#125;&#39; or other actions in &quot;redux&#x2F;*&quot; &#96; +          &#96;namespace. They are considered private. Instead, you must return the &#96; +          &#96;current state for any unknown actions, unless it is undefined, &#96; +          &#96;in which case you must return the initial state, regardless of the &#96; +          &#96;action type. The initial state may not be undefined, but can be null.&#96;      )    &#125;  &#125;)&#125;&#x2F;&#x2F; combineReducersçš„å®ç°ï¼Œå…¶å®å°±æ˜¯å°†å¤šä¸ªå€¼ï¼Œåˆå¹¶åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­export default function combineReducers(reducers: ReducersMapObject) &#123;  const reducerKeys &#x3D; Object.keys(reducers)  const finalReducers: ReducersMapObject &#x3D; &#123;&#125;  for (let i &#x3D; 0; i &lt; reducerKeys.length; i++) &#123;    const key &#x3D; reducerKeys[i]    if (typeof reducers[key] &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;      finalReducers[key] &#x3D; reducers[key]    &#125;  &#125;  const finalReducerKeys &#x3D; Object.keys(finalReducers)  &#x2F;&#x2F; This is used to make sure we don&#39;t warn about the same  &#x2F;&#x2F; keys multiple times.  &#x2F;&#x2F;è¿™ç”¨äºç¡®ä¿æˆ‘ä»¬ä¸ä¼šå¤šæ¬¡è­¦å‘Šç›¸åŒçš„keyã€‚  let unexpectedKeyCache: &#123; [key: string]: true &#125;  return function combination(    state: StateFromReducersMapObject&lt;typeof reducers&gt; &#x3D; &#123;&#125;,    action: AnyAction  ) &#123;    &#x2F;&#x2F;æ ¡éªŒä¿¡æ¯...    let hasChanged &#x3D; false    const nextState: StateFromReducersMapObject&lt;typeof reducers&gt; &#x3D; &#123;&#125;    for (let i &#x3D; 0; i &lt; finalReducerKeys.length; i++) &#123;      const key &#x3D; finalReducerKeys[i]      &#x2F;&#x2F; reducer      const reducer &#x3D; finalReducers[key]      &#x2F;&#x2F; ä¹‹å‰çŠ¶æ€      const previousStateForKey &#x3D; state[key]      &#x2F;&#x2F; æ–°çŠ¶æ€      const nextStateForKey &#x3D; reducer(previousStateForKey, action)      if (typeof nextStateForKey &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;        const actionType &#x3D; action &amp;&amp; action.type        throw new Error(          &#96;When called with an action of type $&#123;            actionType ? &#96;&quot;$&#123;String(actionType)&#125;&quot;&#96; : &#39;(unknown type)&#39;          &#125;, the slice reducer for key &quot;$&#123;key&#125;&quot; returned undefined. &#96; +            &#96;To ignore an action, you must explicitly return the previous state. &#96; +            &#96;If you want this reducer to hold no value, you can return null instead of undefined.&#96;        )      &#125;      nextState[key] &#x3D; nextStateForKey      &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦å‘ç”Ÿæ›´æ–°      hasChanged &#x3D; hasChanged || nextStateForKey !&#x3D;&#x3D; previousStateForKey    &#125;    hasChanged &#x3D;      hasChanged || finalReducerKeys.length !&#x3D;&#x3D; Object.keys(state).length      &#x2F;&#x2F; æ›´æ–°è¿”å›æ–°çš„çŠ¶æ€ï¼Œå¦åˆ™è¿”å›ä¹‹å‰çŠ¶æ€    return hasChanged ? nextState : state  &#125;&#125;</code></pre><h2 id="bindActionCreators"><a href="#bindActionCreators" class="headerlink" title="bindActionCreators"></a>bindActionCreators</h2><ul><li>ç»™actionåŒ…è£¹å±‚dispatch</li><li>actionæœ‰ä¸¤ç§ç±»å‹ï¼š å‡½æ•°ã€é”®å€¼å¯¹</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function bindActionCreators(  actionCreators: ActionCreator&lt;any&gt; | ActionCreatorsMapObject,  dispatch: Dispatch) &#123;  &#x2F;&#x2F; å‡½æ•°ç±»å‹ç›´æ¥bindActionCreatorè¿”å›  if (typeof actionCreators &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;    return bindActionCreator(actionCreators, dispatch)  &#125;  if (typeof actionCreators !&#x3D;&#x3D; &#39;object&#39; || actionCreators &#x3D;&#x3D;&#x3D; null) &#123;    throw new Error(      &#96;bindActionCreators expected an object or a function, but instead received: &#39;$&#123;kindOf(        actionCreators      )&#125;&#39;. &#96; +        &#96;Did you write &quot;import ActionCreators from&quot; instead of &quot;import * as ActionCreators from&quot;?&#96;    )  &#125;  const boundActionCreators: ActionCreatorsMapObject &#x3D; &#123;&#125;  &#x2F;&#x2F; å¯¹è±¡éå†è°ƒç”¨bindActionCreator  for (const key in actionCreators) &#123;    const actionCreator &#x3D; actionCreators[key]    if (typeof actionCreator &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;      boundActionCreators[key] &#x3D; bindActionCreator(actionCreator, dispatch)    &#125;  &#125;  return boundActionCreators&#125;</code></pre><p><strong>ä½¿ç”¨åŠæµ‹è¯•ä»£ç è§</strong></p><p><code>redux/test/typescript/actionCreators.ts</code></p><p><strong>bindActionCreator</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; ä½œç”¨æ˜¯æ¯ä¸ªactionCreatorå¢åŠ ä¸€ä¸ªdispatchåŒ…è£¹function bindActionCreator&lt;A extends AnyAction &#x3D; AnyAction&gt;(  actionCreator: ActionCreator&lt;A&gt;,  dispatch: Dispatch) &#123;  return function (this: any, ...args: any[]) &#123;    return dispatch(actionCreator.apply(this, args)) &#x2F;&#x2F; ä¸»è¦ä»£ç   &#125;&#125;</code></pre><h2 id="applyMiddleware"><a href="#applyMiddleware" class="headerlink" title="applyMiddleware"></a>applyMiddleware</h2><ul><li>ä¸­é—´ä»¶</li><li>å¯¹storeèƒ½åŠ›è¿›è¡Œå¢å¼º</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function applyMiddleware(  ...middlewares: Middleware[]): StoreEnhancer&lt;any&gt; &#123;  return (createStore: StoreEnhancerStoreCreator) &#x3D;&gt;    &lt;S, A extends AnyAction&gt;(      reducer: Reducer&lt;S, A&gt;,      preloadedState?: PreloadedState&lt;S&gt;    ) &#x3D;&gt; &#123;      const store &#x3D; createStore(reducer, preloadedState)      &#x2F;&#x2F; å£°æ˜      let dispatch: Dispatch &#x3D; () &#x3D;&gt; &#123;        throw new Error(          &#39;Dispatching while constructing your middleware is not allowed. &#39; +            &#39;Other middleware would not be applied to this dispatch.&#39;        )      &#125;      const middlewareAPI: MiddlewareAPI &#x3D; &#123;        getState: store.getState,                                      &#x2F;&#x2F;ä½¿ç”¨ä¸Šè¿°å‡½æ•°è¿›è¡Œ        dispatch: (action, ...args) &#x3D;&gt; dispatch(action, ...args)      &#125;      &#x2F;&#x2F; ä¸­é—´ä»¶æ•°ç»„      const chain &#x3D; middlewares.map(middleware &#x3D;&gt; middleware(middlewareAPI))      &#x2F;&#x2F; å¢å¼ºçš„æ˜¯dispatch      dispatch &#x3D; compose&lt;typeof dispatch&gt;(...chain)(store.dispatch)      return &#123;        ...store,        dispatch      &#125;    &#125;&#125;&#96;&#96;&#96;ts      const chain &#x3D; middlewares.map(middleware &#x3D;&gt; middleware(middlewareAPI))            dispatch &#x3D; compose&lt;typeof dispatch&gt;(...chain)(store.dispatch)      return &#123;        ...store,        dispatch      &#125;    &#125;&#125;</code></pre><h2 id="compose"><a href="#compose" class="headerlink" title="compose"></a>compose</h2><ul><li>æ´‹è‘±æ¨¡å‹</li></ul><p><strong>ä½¿ç”¨</strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">compose(f, g, h)(...args) &#x3D;&gt; f(g(h(...args)))</code></pre><p><strong>æºç </strong></p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function compose(...funcs: Function[]) &#123;  &#x2F;&#x2F; å‚æ•°é•¿åº¦åˆ¤æ–­  if (funcs.length &#x3D;&#x3D;&#x3D; 0) &#123;    &#x2F;&#x2F; infer the argument type so it is usable in inference down the line    return &lt;T&gt;(arg: T) &#x3D;&gt; arg  &#125;  &#x2F;&#x2F; é•¿åº¦ä¸º1  if (funcs.length &#x3D;&#x3D;&#x3D; 1) &#123;    return funcs[0]  &#125;  &#x2F;&#x2F; ä¸»è¦ä»£ç ä¸€è¡Œ  return funcs.reduce((a, b) &#x3D;&gt; (...args: any) &#x3D;&gt;  a(b(...args)))&#125;</code></pre><p><strong>è®²composeçš„æ–‡ç« </strong></p><p><a href="http://givencui.com/index.php/archives/28/" target="_blank" >è¿™é‡Œæœ‰ä¸€ç¯‡éå¸¸å¥½</a></p><h2 id="DO-NOT-USE-ActionTypes"><a href="#DO-NOT-USE-ActionTypes" class="headerlink" title="__DO_NOT_USE__ActionTypes"></a>__DO_NOT_USE__ActionTypes</h2><ul><li>ä¸€äº›ç§æœ‰çš„actionè¢«reduxä¿ç•™ï¼Œå¯¹äºä¸æ˜ç¡®çš„actionï¼Œå¿…é¡»è¿”å›å½“å‰state.</li><li>å¦‚æœå½“å‰çŠ¶æ€æ˜¯undefined,å¿…é¡»è¿”å›åˆå§‹çŠ¶æ€</li><li>ä¸è¦åœ¨ä»£ç ä¸­ç›´æ¥æ¶‰åŠè¿™äº›action</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const ActionTypes &#x3D; &#123;  INIT: &#96;@@redux&#x2F;INIT$&#123;&#x2F;* #__PURE__ *&#x2F; randomString()&#125;&#96;,  REPLACE: &#96;@@redux&#x2F;REPLACE$&#123;&#x2F;* #__PURE__ *&#x2F; randomString()&#125;&#96;,  PROBE_UNKNOWN_ACTION: () &#x3D;&gt; &#96;@@redux&#x2F;PROBE_UNKNOWN_ACTION$&#123;randomString()&#125;&#96;&#125;</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><img src="http://t-blog-images.aijs.top/img/reduxæºç å†…å®¹.png"/><h2 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h2><p><img src="http://t-blog-images.aijs.top/img/20220527091836.webp"></p><h2 id="å·©å›º"><a href="#å·©å›º" class="headerlink" title="å·©å›º"></a>å·©å›º</h2><p><img src="http://t-blog-images.aijs.top/img/20220527095407.webp"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.51cto.com/u_15283585/2958523">æœ€ç²¾ç®€çš„Reduxæºç è§£æï¼Œçœ‹å®Œä»æ­¤å†ä¹Ÿä¸æ€•é¢è¯•å®˜</a><br><a href="https://www.jianshu.com/p/490fc0d89029">Redux æºç è§£æ</a><br><a href="https://github.com/841660202/redux">github æºç </a></p>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redux </tag>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redux æºç  1</title>
      <link href="//post/2022-05-25.redux.html"/>
      <url>//post/2022-05-25.redux.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>A Predictable State Container for JS Apps</p><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;name&quot;: &quot;redux&quot;,  &quot;version&quot;: &quot;5.0.0-alpha.0&quot;,  &quot;description&quot;: &quot;Predictable state container for JavaScript apps&quot;,  &quot;keywords&quot;: [    &quot;redux&quot;,    &quot;reducer&quot;,  &#x2F;&#x2F; reducer, reduxæ„æˆç»„æˆä¹‹ä¸€    &quot;state&quot;,    &#x2F;&#x2F; çŠ¶æ€ç®¡ç†    &quot;predictable&quot;,   &#x2F;&#x2F; å¯é¢„æµ‹çš„    &quot;functional&quot;,    &#x2F;&#x2F; çº¯å‡½æ•°çš„    &quot;immutable&quot;,     &#x2F;&#x2F; ä¸å¯å˜çš„    &quot;hot&quot;,    &quot;live&quot;,    &quot;replay&quot;,        &#x2F;&#x2F; å›æ”¾    &quot;flux&quot;,          &#x2F;&#x2F; reduxå¯¹fluxçš„æ”¹è¿›    &quot;elm&quot;            &#x2F;&#x2F; Elm æ˜¯ä¸€é—¨ä¸“æ³¨äºWebå‰ç«¯çš„çº¯å‡½æ•°å¼è¯­è¨€, reducerå—elmå¯å‘  ],  &#x2F;&#x2F; å…¥å£  &quot;main&quot;: &quot;lib&#x2F;redux.js&quot;,  &#x2F;&#x2F; unpkg æ˜¯ä¸€ä¸ªå†…å®¹æºè‡ª npm çš„å…¨çƒå¿«é€Ÿ CDN, å®ƒèƒ½ä»¥å¿«é€Ÿè€Œç®€å•çš„æ–¹å¼æä¾›ä»»æ„åŒ…ã€ä»»æ„æ–‡ä»¶ï¼Œé€šè¿‡ç±»ä¼¼è¿™æ ·çš„ URL ï¼šunpkg.com&#x2F;:package@:version&#x2F;:file  &#x2F;&#x2F; å½“ä½ è®¿é—®: https:&#x2F;&#x2F;unpkg.com&#x2F;redux@4.0.3&#x2F;dist&#x2F;redux.min.js æ˜¯å¯¹åº”redux@4.0.3ç‰ˆæœ¬çš„å‹ç¼©åçš„jsæ–‡ä»¶  &#x2F;&#x2F; å½“ä½ è®¿é—®: https:&#x2F;&#x2F;unpkg.com&#x2F;redux â€”â€”æ ¹æ®package.jsoné…ç½®çš„unpkg, é‡å®šå‘ä¸º--â€”&gt; https:&#x2F;&#x2F;unpkg.com&#x2F;redux@4.0.4&#x2F;dist&#x2F;redux.js , åšäº†ä¸¤æ¬¡é‡å®šå‘  &#x2F;&#x2F; å¦‚ä½•ä½ è®¿é—®: https:&#x2F;&#x2F;unpkg.com&#x2F;redux&#x2F; (æ³¨æ„reduxåæœ‰&#x2F;), æ˜¯ä¸€ä¸ªé¡µé¢  &quot;unpkg&quot;: &quot;dist&#x2F;redux.js&quot;, &#x2F;&#x2F; ç”¨unpkgçš„è£¸urlè®¿é—®æ—¶, æŒ‡å®šåˆ°è¯¥æ–‡ä»¶  &#x2F;**    module      ç‚¹å‡» Setting up multi-platform npm packages æŸ¥çœ‹ç›¸å…³ä»‹ç»ã€‚      å°±åƒ main å­—æ®µä¸€æ ·ï¼Œå®šä¹‰ä¸€ä¸ªé’ˆå¯¹ es6 æ¨¡å—åŠè¯­æ³•çš„å…¥å£æ–‡ä»¶ã€‚      æ„å»ºå·¥å…·åœ¨æ„å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°äº†è¿™ä¸ªå­—æ®µï¼Œä¼šé¦–å…ˆä½¿ç”¨è¿™ä¸ªå­—æ®µæŒ‡å‘çš„æ–‡ä»¶ï¼Œå¦‚æœæœªå®šä¹‰ï¼Œåˆ™å›é€€åˆ° main å­—æ®µæŒ‡å‘çš„æ–‡ä»¶ã€‚      æ”¯æŒçš„å·¥å…·ï¼š      rollup      webpack  **&#x2F;  &quot;module&quot;: &quot;es&#x2F;redux.js&quot;,&#x2F;&#x2F; TypeScriptæ˜¯javascript çš„è¶…é›†, typings&#x2F;typeså­—æ®µ, å®šä¹‰äº†TypeScriptçš„å…¥å£æ–‡ä»¶  &quot;types&quot;: &quot;types&#x2F;index.d.ts&quot;,  &#x2F;&#x2F; å‘å¸ƒä¸Šä¼ å†…å®¹  &#x2F;&#x2F; æ˜¯ä¸€ä¸ªå¯é€‰å­—æ®µ, ç”¨æ¥æè¿°ä½œå°†è½¯ä»¶åŒ…ä½œä¸ºä¾èµ–é¡¹å®‰è£…æ—¶è¦åŒ…å«çš„æ¡ç›®, ç›¸å½“äºç™½åå•, ç±»ä¼¼.gitignoreç±»ä¼¼çš„è¯­æ³•, fileså­—æ®µä¸­åŒ…å«çš„æ–‡ä»¶ä¸èƒ½é€šè¿‡.npmignoreæˆ–.gitignoreæ’é™¤  &quot;files&quot;: [    &quot;dist&quot;,    &quot;lib&quot;,    &quot;es&quot;,    &quot;src&quot;,    &quot;types&quot;  ],  &quot;scripts&quot;: &#123;    ...  &#125;,  &#x2F;&#x2F; è¡¨ç¤ºåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨è¯¥ä¾èµ–, å¯¹åº” npm install xx -S æˆ– npm install xx --save  &quot;dependencies&quot;: &#123;    &quot;@babel&#x2F;runtime&quot;: &quot;^7.16.7&quot;  &#125;,  &#x2F;&#x2F; è¡¨ç¤ºä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨, ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨çš„ä¾èµ–, å¯¹åº” npm install xx -D æˆ– npm install xx --save-dev  &quot;devDependencies&quot;: &#123;   ...  &#125;,  &quot;npmName&quot;: &quot;redux&quot;,  &#x2F;&#x2F; npmæ–‡ä»¶æ˜ å°„ã€‚æŠŠéœ€è¦åŒæ­¥åˆ° cdnjs çš„æ–‡ä»¶é…ç½®åœ¨è¿™é‡Œã€‚  &quot;npmFileMap&quot;: [    &#123;      &quot;basePath&quot;: &quot;&#x2F;dist&#x2F;&quot;,      &quot;files&quot;: [        &quot;*.js&quot;      ]    &#125;  ],  &#x2F;&#x2F; webpackç›¸å…³å­—æ®µ, å£°æ˜è¯¥æ¨¡å—æ˜¯å¦åŒ…å« sideEffectsï¼ˆå‰¯ä½œç”¨ï¼‰ï¼Œä»è€Œå¯ä»¥ä¸º tree-shaking æä¾›æ›´å¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚  &quot;sideEffects&quot;: false&#125;</code></pre><h2 id="versionå­—æ®µ"><a href="#versionå­—æ®µ" class="headerlink" title="versionå­—æ®µ"></a>versionå­—æ®µ</h2><p>åŒ…çš„ç‰ˆæœ¬, å¿…é¡»æœ‰, è¦ç¬¦åˆ<a href="https://docs.npmjs.com/about-semantic-versioning">semantic versioning guidelines</a>, å‚è€ƒ <a href="https://semver.org/lang/zh-CN/">è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ</a>, å»ºè®®ä»”ç»†é€šè¯»<br><img src="http://t-blog-images.aijs.top/img/20220525140247.webp" width=600 style="object-fit: content"/></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="http://givencui.com/index.php/archives/29/">é…åˆreduxé¡¹ç›®æ·±åº¦äº†è§£package.json</a><br><a href="https://docs.npmjs.com/about-semantic-versioning">semantic versioning guidelines</a><br><a href="https://semver.org/lang/zh-CN/">è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ</a></p><h2 id="æºç ç›®å½•"><a href="#æºç ç›®å½•" class="headerlink" title="æºç ç›®å½•"></a>æºç ç›®å½•</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.â”œâ”€â”€ applyMiddleware.tsâ”œâ”€â”€ bindActionCreators.tsâ”œâ”€â”€ combineReducers.tsâ”œâ”€â”€ compose.tsâ”œâ”€â”€ createStore.tsâ”œâ”€â”€ index.tsâ”œâ”€â”€ typesâ”‚   â”œâ”€â”€ actions.tsâ”‚   â”œâ”€â”€ middleware.tsâ”‚   â”œâ”€â”€ reducers.tsâ”‚   â””â”€â”€ store.tsâ””â”€â”€ utils    â”œâ”€â”€ actionTypes.ts    â”œâ”€â”€ formatProdErrorMessage.ts    â”œâ”€â”€ isPlainObject.ts    â”œâ”€â”€ kindOf.ts    â”œâ”€â”€ symbol-observable.ts    â””â”€â”€ warning.ts2 directories, 16 files</code></pre><h2 id="index-ts"><a href="#index-ts" class="headerlink" title="index.ts"></a>index.ts</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export &#123;  createStore,  combineReducers,  bindActionCreators,  applyMiddleware,  compose,  __DO_NOT_USE__ActionTypes&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redux </tag>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-redux  æºç 2</title>
      <link href="//post/2022-05-24react-redux2.html"/>
      <url>//post/2022-05-24react-redux2.html</url>
      
        <content type="html"><![CDATA[<p>æºç ç‰ˆæœ¬<code>&quot;version&quot;: &quot;8.0.2&quot;,</code></p><h2 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h2><ul><li>ä¸»è¦ä½œç”¨é€šè¿‡subscriptionè°ƒç”¨reduxä¸­storeçš„subscriptionäº§ç”Ÿè®¢é˜…ï¼Œè®¢é˜…å†…å®¹æ˜¯onStateChangeçš„å›è°ƒ</li><li>é€šè¿‡reactçš„ProvideråŠŸèƒ½ï¼Œæä¾›ä¼ é€’ç»™æ ¹çš„storeå’Œæ ¹çš„subscriptionç»™åç»­ä½¿ç”¨äº†connectçš„ç»„ä»¶</li></ul><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;* provider ç»„ä»¶ä»£ç  *&#x2F;function Provider(&#123; store, context, children &#125;) &#123;   &#x2F;* åˆ©ç”¨useMemoï¼Œè·Ÿæ®storeå˜åŒ–åˆ›å»ºå‡ºä¸€ä¸ªcontextValue åŒ…å«ä¸€ä¸ªæ ¹å…ƒç´ è®¢é˜…å™¨å’Œå½“å‰store  *&#x2F;   const contextValue &#x3D; useMemo(() &#x3D;&gt; &#123;      &#x2F;* åˆ›å»ºäº†ä¸€ä¸ªæ ¹ Subscription è®¢é˜…å™¨ *&#x2F;    const subscription &#x3D; new Subscription(store)    &#x2F;* subscription çš„ notifyNestedSubs æ–¹æ³• ï¼Œèµ‹å€¼ç»™  onStateChangeæ–¹æ³• *&#x2F;    &#x2F;&#x2F;onStateChangeå°±æ˜¯ä¹‹åè§¦å‘çš„listenr    subscription.onStateChange &#x3D; subscription.notifyNestedSubs      return &#123;      store,      subscription    &#125; &#x2F;*  store æ”¹å˜åˆ›å»ºæ–°çš„contextValue *&#x2F;  &#125;, [store])  &#x2F;*  è·å–æ›´æ–°ä¹‹å‰çš„stateå€¼ ï¼Œå‡½æ•°ç»„ä»¶é‡Œé¢çš„ä¸Šä¸‹æ–‡è¦ä¼˜å…ˆäºç»„ä»¶æ›´æ–°æ¸²æŸ“  *&#x2F;  const previousState &#x3D; useMemo(() &#x3D;&gt; store.getState(), [store])  useEffect(() &#x3D;&gt; &#123;    const &#123; subscription &#125; &#x3D; contextValue    &#x2F;* è§¦å‘trySubscribeæ–¹æ³•æ‰§è¡Œï¼Œåˆ›å»ºlistens *&#x2F;    subscription.trySubscribe() &#x2F;&#x2F; å‘èµ·è®¢é˜…    if (previousState !&#x3D;&#x3D; store.getState()) &#123;        &#x2F;* ç»„ä»¶æ›´æ–°æ¸²æŸ“ä¹‹åï¼Œå¦‚æœæ­¤æ—¶stateå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆç«‹å³è§¦å‘ subscription.notifyNestedSubs æ–¹æ³•  *&#x2F;        &#x2F;&#x2F;è§¦å‘æ‰€æœ‰çš„listener      subscription.notifyNestedSubs()     &#125;    &#x2F;*   *&#x2F;    return () &#x3D;&gt; &#123;      subscription.tryUnsubscribe()  &#x2F;&#x2F; å¸è½½è®¢é˜…      subscription.onStateChange &#x3D; null    &#125;    &#x2F;*  contextValue state æ”¹å˜å‡ºå‘æ–°çš„ effect *&#x2F;  &#125;, [contextValue, previousState])  &#x2F;&#x2F;è‹¥Provideræ²¡æœ‰æ˜¾ç¤ºä¼ å…¥contextï¼Œåˆ™ä¸ºä½¿ç”¨React.createContextåˆ›å»ºçš„ä¸Šä¸‹æ–‡  const Context &#x3D; context || ReactReduxContext  return &lt;Context.Provider value&#x3D;&#123;contextValue&#125;&gt;&#123;children&#125;&lt;&#x2F;Context.Provider&gt;&#125;</code></pre><h2 id="Subscription"><a href="#Subscription" class="headerlink" title="Subscription"></a>Subscription</h2><ul><li>è®¢é˜…æ¶ˆæ¯ã€å‘èµ·æ›´æ–°</li><li>åœ¨æ ¹çš„Providerçš„ä½œç”¨æ˜¯è°ƒç”¨reduxä¸­storeçš„è®¢é˜…æ–¹æ³•ï¼Œå°†æ ¹çš„onStateChangeè¿›è¡Œè®¢é˜…</li><li>åœ¨å­ä»£ä¸­æ˜¯æ”¶é›†æ‰€æœ‰è¢« connect åŒ…è£¹çš„ç»„ä»¶ä¸­çš„Subscriptionçš„æ›´æ–°å‡½æ•° onstatechangeï¼Œç„¶åå½¢æˆä¸€ä¸ª callback é“¾è¡¨ï¼Œå†ç”±çˆ¶çº§ Subscription ç»Ÿä¸€æ´¾å‘æ‰§è¡Œæ›´æ–°ï¼Œåªä¼šå¾€ä¸Šä¼ é€’ä¸€å±‚ï¼Œä¸ä¼šä¸€ç›´ä¼ é€’ä½¿å¾—æ¯ä¸€ä¸ªä¸Šçº§éƒ½æœ‰è‡ªèº«çš„æ›´æ–°å‡½æ•°</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;* å‘å¸ƒè®¢é˜…è€…æ¨¡å¼ *&#x2F;export default class Subscription &#123;  constructor(store, parentSub) &#123;    this.store &#x3D; store    this.parentSub &#x3D; parentSub    this.unsubscribe &#x3D; null    this.listeners &#x3D; nullListeners    this.handleChangeWrapper &#x3D; this.handleChangeWrapper.bind(this)  &#125;  &#x2F;* è´Ÿè´£æ£€æµ‹æ˜¯å¦è¯¥ç»„ä»¶è®¢é˜…ï¼Œç„¶åæ·»åŠ è®¢é˜…è€…ä¹Ÿå°±æ˜¯listener *&#x2F;    &#x2F;&#x2F;å½“çˆ¶ä»£è°ƒç”¨è¿‡trySubscribeåï¼Œå­ä»£å†è°ƒç”¨ï¼Œå› ä¸ºthis.unsubscribeæœ‰å€¼ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå®é™…æ‰§è¡Œçˆ¶ä»£çš„trySubscribeï¼Œè€Œåªæ˜¯å°†listeneræ”¾è¿›çˆ¶ä»£ä¸­ç®¡ç†  addNestedSub(listener) &#123;    this.trySubscribe()    return this.listeners.subscribe(listener)  &#125;  &#x2F;* å‘listenerså‘å¸ƒé€šçŸ¥ *&#x2F;  notifyNestedSubs() &#123;    this.listeners.notify()  &#125;  &#x2F;* å¯¹äº Provide onStateChange å°±æ˜¯ notifyNestedSubs æ–¹æ³•ï¼Œ  å¯¹äº connect åŒ…è£¹æ¥å—æ›´æ–°çš„ç»„ä»¶ ï¼ŒonStateChange å°±æ˜¯ è´Ÿè´£æ›´æ–°ç»„ä»¶çš„å‡½æ•° ã€‚   *&#x2F;  handleChangeWrapper() &#123;    if (this.onStateChange) &#123;      this.onStateChange()    &#125;  &#125;   &#x2F;* åˆ¤æ–­æœ‰æ²¡æœ‰å¼€å¯è®¢é˜… *&#x2F;  isSubscribed() &#123;    return Boolean(this.unsubscribe)  &#125;  &#x2F;* å¼€å¯è®¢é˜…æ¨¡å¼ é¦–å…ˆåˆ¤æ–­å½“å‰è®¢é˜…å™¨æœ‰æ²¡æœ‰çˆ¶çº§è®¢é˜…å™¨ ï¼Œ å¦‚æœæœ‰çˆ¶çº§è®¢é˜…å™¨(å°±æ˜¯çˆ¶çº§Subscription)ï¼ŒæŠŠè‡ªå·±çš„handleChangeWrapperæ”¾å…¥åˆ°ç›‘å¬è€…é“¾è¡¨ä¸­ *&#x2F;  trySubscribe() &#123;    &#x2F;*    parentSubå³æ˜¯provide value é‡Œé¢çš„ Subscription è¿™é‡Œå¯ä»¥ç†è§£ä¸º çˆ¶çº§å…ƒç´ çš„ Subscription    *&#x2F;    &#x2F;&#x2F;å½“Subscriptionæ‰§è¡Œè¿‡ä¸€æ¬¡æ”¹æ–¹æ³•åï¼Œå†è°ƒç”¨å› ä¸ºthis.unsubscribeæœ‰å€¼    &#x2F;&#x2F;æ‰€ä»¥è¯¥æ–¹æ³•è°ƒç”¨ä¸€æ¬¡åå°±ä¸ä¼šå†è¢«è°ƒç”¨äº†    &#x2F;&#x2F;æ„å‘³ç€addNestedSubä¸­åªä¼šæ·»åŠ listenerï¼Œè€Œä¸ä¼šå†è°ƒç”¨trySubscribeï¼Œä½¿å¾—listenerä¸ä¼šå¾€ä¸Šä¼ é€’    if (!this.unsubscribe) &#123;      this.unsubscribe &#x3D; this.parentSub        ? this.parentSub.addNestedSub(this.handleChangeWrapper)        &#x2F;* providerçš„Subscriptionæ˜¯ä¸å­˜åœ¨parentSubï¼Œæ‰€ä»¥æ­¤æ—¶trySubscribe å°±ä¼šè°ƒç”¨ store.subscribe   *&#x2F;        : this.store.subscribe(this.handleChangeWrapper)      this.listeners &#x3D; createListenerCollection()    &#125;  &#125;  &#x2F;* å–æ¶ˆè®¢é˜… *&#x2F;  tryUnsubscribe() &#123;    if (this.unsubscribe) &#123;      this.unsubscribe()      this.unsubscribe &#x3D; null      this.listeners.clear()      this.listeners &#x3D; nullListeners    &#125;  &#125;&#125;</code></pre><ul><li>é¦–å…ˆProvideråˆ›å»º Subscription æ—¶å€™æ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±è¯´æ˜provider ä¸­çš„Subscription ä¸å­˜åœ¨ parentSub ã€‚</li><li>é‚£ä¹ˆå†è°ƒç”¨Providerç»„ä»¶ä¸­useEffecté’©å­ä¸­trySubscribeçš„æ—¶å€™,ä¼šè§¦å‘this.store.subscribe , subscribe å°±æ˜¯ redux çš„ subscribe ,æ­¤æ—¶çœŸæ­£å‘èµ·äº†è®¢é˜…</li><li>è®¢é˜…çš„å†…å®¹æ˜¯notifyNestedSubsï¼Œå³é€šçŸ¥æ ¹ç®¡ç†çš„listenersè§¦å‘<pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">subscription.onStateChange &#x3D; subscription.notifyNestedSubs &#x2F;* å‘listenerså‘å¸ƒé€šçŸ¥ *&#x2F;notifyNestedSubs() &#123;  this.listeners.notify()&#125;</code></pre><h2 id="createListenerCollection"><a href="#createListenerCollection" class="headerlink" title="createListenerCollection"></a>createListenerCollection</h2>é€šè¿‡åŒå‘é“¾è¡¨çš„ç»“æ„ç®¡ç†æ¯ä¸€ä¸ªlistener<br>ä»¥é“¾è¡¨çš„å½¢å¼æ”¶é›†å¯¹åº”çš„ listeners (æ¯ä¸€ä¸ªSubscription) çš„handleChangeWrapperå‡½æ•°å³onStateChangeã€‚<br>é€šè¿‡ batch æ–¹æ³•( react-dom ä¸­çš„ unstable_batchedUpdates ) æ¥è¿›è¡Œæ‰¹é‡æ›´æ–°ï¼Œè®¸å°†ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­çš„æ‰€æœ‰ React æ›´æ–°éƒ½ä¸€èµ·æ‰¹é‡å¤„ç†åˆ°ä¸€ä¸ªæ¸²æŸ“è¿‡ç¨‹ä¸­ã€‚<pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">import &#123; unstable_batchedUpdates as batch &#125; from &#39;.&#x2F;utils&#x2F;reactBatchedUpdates&#39;setBatch(batch)function createListenerCollection() &#123;   &#x2F;* batch ç”±getBatchå¾—åˆ°çš„ unstable_batchedUpdates æ–¹æ³• *&#x2F;  const batch &#x3D; getBatch()  let first &#x3D; null  let last &#x3D; null  return &#123;    &#x2F;* æ¸…é™¤å½“å‰listenersçš„æ‰€æœ‰listener *&#x2F;    clear() &#123;      first &#x3D; null      last &#x3D; null    &#125;,    &#x2F;* æ´¾å‘æ›´æ–° *&#x2F;    notify() &#123;      batch(() &#x3D;&gt; &#123;        let listener &#x3D; first        while (listener) &#123;          listener.callback()          listener &#x3D; listener.next        &#125;      &#125;)    &#125;,    &#x2F;* è·å–listenersçš„æ‰€æœ‰listener *&#x2F;    get() &#123;      let listeners &#x3D; []      let listener &#x3D; first      while (listener) &#123;        listeners.push(listener)        listener &#x3D; listener.next      &#125;      return listeners    &#125;,     &#x2F;* æ¥æ”¶è®¢é˜…ï¼Œå°†å½“å‰çš„callbackï¼ˆhandleChangeWrapperï¼‰å­˜åˆ°å½“å‰çš„é“¾è¡¨ä¸­  *&#x2F;    subscribe(callback) &#123;      let isSubscribed &#x3D; true      let listener &#x3D; (last &#x3D; &#123;        callback,        next: null,        prev: last &#x2F;&#x2F;é¦–æ¬¡lastä¸ºç©º      &#125;)         if (listener.prev) &#123;        listener.prev.next &#x3D; listener      &#125; else &#123;        first &#x3D; listener      &#125;      &#x2F;* å–æ¶ˆå½“å‰ handleChangeWrapper çš„è®¢é˜…*&#x2F;      return function unsubscribe() &#123;        if (!isSubscribed || first &#x3D;&#x3D;&#x3D; null) return        isSubscribed &#x3D; false&#x2F;&#x2F;åŒå‘é“¾è¡¨åˆ é™¤èŠ‚ç‚¹çš„æ“ä½œ        if (listener.next) &#123;          listener.next.prev &#x3D; listener.prev        &#125; else &#123;          last &#x3D; listener.prev        &#125;        if (listener.prev) &#123;          listener.prev.next &#x3D; listener.next        &#125; else &#123;          first &#x3D; listener.next        &#125;      &#125;    &#125;  &#125;&#125;</code></pre><h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2>åŸºæœ¬ä½¿ç”¨<pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">function connect(mapStateToProps?, mapDispatchToProps?, mergeProps?, options?)const mapStateToProps &#x3D; state &#x3D;&gt; (&#123; todos: state.todos &#125;)const mapDispatchToProps &#x3D; dispatch &#x3D;&gt; &#123;  return &#123;    increment: () &#x3D;&gt; dispatch(&#123; type: &#39;INCREMENT&#39; &#125;),    decrement: () &#x3D;&gt; dispatch(&#123; type: &#39;DECREMENT&#39; &#125;),    reset: () &#x3D;&gt; dispatch(&#123; type: &#39;RESET&#39; &#125;)  &#125;&#125;&#x2F;** stateProps , state æ˜ å°„åˆ° props ä¸­çš„å†…å®¹* dispatchPropsï¼Œ dispatch æ˜ å°„åˆ° props ä¸­çš„å†…å®¹ã€‚* ownProps ç»„ä»¶æœ¬èº«çš„ propså½“æœªä¼ é€’æ—¶ï¼Œé»˜è®¤çš„åˆå¹¶è§„åˆ™ä¸º&#123; ...ownProps, ...stateProps, ...dispatchProps &#125;*&#x2F;mergeProps&#x3D;(stateProps, dispatchProps, ownProps) &#x3D;&gt; Objectoptions&#x3D;&#123;  context?: Object,   &#x2F;&#x2F; è‡ªå®šä¹‰ä¸Šä¸‹æ–‡  pure?: boolean, &#x2F;&#x2F; é»˜è®¤ä¸º true , å½“ä¸º true çš„æ—¶å€™ ï¼Œé™¤äº† mapStateToProps å’Œ props ,å…¶ä»–è¾“å…¥æˆ–è€…state æ”¹å˜ï¼Œå‡ä¸ä¼šæ›´æ–°ç»„ä»¶ã€‚  areStatesEqual?: Function, &#x2F;&#x2F; å½“pure true , æ¯”è¾ƒå¼•è¿›store ä¸­stateå€¼ æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚ (next: Object, prev: Object) &#x3D;&gt; boolean  areOwnPropsEqual?: Function, &#x2F;&#x2F; å½“pure true , æ¯”è¾ƒ props å€¼, æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚ (next: Object, prev: Object) &#x3D;&gt; boolean  areStatePropsEqual?: Function, &#x2F;&#x2F; å½“pure true , æ¯”è¾ƒ mapStateToProps åçš„å€¼ æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚  (next: Object, prev: Object) &#x3D;&gt; boolean  areMergedPropsEqual?: Function, &#x2F;&#x2F; å½“ pure ä¸º true æ—¶ï¼Œ æ¯”è¾ƒ ç»è¿‡ mergeProps åˆå¹¶åçš„å€¼ ï¼Œ æ˜¯å¦ä¸ä¹‹å‰ç­‰  (next: Object, prev: Object) &#x3D;&gt; boolean  forwardRef?: boolean, &#x2F;&#x2F;å½“ä¸ºtrue æ—¶å€™,å¯ä»¥é€šè¿‡ref è·å–è¢«connectåŒ…è£¹çš„ç»„ä»¶å®ä¾‹ã€‚&#125;</code></pre><img src="http://t-blog-images.aijs.top/img/20220525105732.webp"></li></ul><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;** * Connects a React component to a Redux store. * * - Without arguments, just wraps the component, without changing the behavior &#x2F; props * * - If 2 params are passed (3rd param, mergeProps, is skipped), default behavior * is to override ownProps (as stated in the docs), so what remains is everything that&#39;s * not a state or dispatch prop * * - When 3rd param is passed, we don&#39;t know if ownProps propagate and whether they * should be valid component props, because it depends on mergeProps implementation. * As such, it is the user&#39;s responsibility to extend ownProps interface from state or * dispatch props or both when applicable * * @param mapStateToProps A function that extracts values from state * @param mapDispatchToProps Setup for dispatching actions * @param mergeProps Optional callback to merge state and dispatch props together * @param options Options for configuring the connection * *&#x2F;function connect&lt;  TStateProps &#x3D; &#123;&#125;,  TDispatchProps &#x3D; &#123;&#125;,  TOwnProps &#x3D; &#123;&#125;,  TMergedProps &#x3D; &#123;&#125;,  State &#x3D; unknown&gt;(  mapStateToProps?: MapStateToPropsParam&lt;TStateProps, TOwnProps, State&gt;,  mapDispatchToProps?: MapDispatchToPropsParam&lt;TDispatchProps, TOwnProps&gt;,  mergeProps?: MergeProps&lt;TStateProps, TDispatchProps, TOwnProps, TMergedProps&gt;,  &#123;    &#x2F;&#x2F; The &#96;pure&#96; option has been removed, so TS doesn&#39;t like us destructuring this to check its existence.    &#x2F;&#x2F; @ts-ignore    pure,    areStatesEqual &#x3D; strictEqual,    areOwnPropsEqual &#x3D; shallowEqual,    areStatePropsEqual &#x3D; shallowEqual,    areMergedPropsEqual &#x3D; shallowEqual,    &#x2F;&#x2F; use React&#39;s forwardRef to expose a ref of the wrapped component    forwardRef &#x3D; false,    &#x2F;&#x2F; the context consumer to use    context &#x3D; ReactReduxContext,  &#125;: ConnectOptions&lt;unknown, unknown, unknown, unknown&gt; &#x3D; &#123;&#125;): unknown &#123;    const Context &#x3D; context  &#x2F;*  * stateProps , state æ˜ å°„åˆ° props ä¸­çš„å†…å®¹  * dispatchPropsï¼Œ dispatch æ˜ å°„åˆ° props ä¸­çš„å†…å®¹ã€‚  * ownProps ç»„ä»¶æœ¬èº«çš„ props  å½“æœªä¼ é€’æ—¶ï¼Œé»˜è®¤çš„åˆå¹¶è§„åˆ™ä¸º  &#123; ...ownProps, ...stateProps, ...dispatchProps &#125;  *&#x2F; &#x2F;* ç»è¿‡ä»£ç†åŒ…è£…åçš„ mapStateToProps,å®Œæˆä¼ å…¥storeç­‰æ“ä½œ*&#x2F;  const initMapStateToProps &#x3D; mapStateToPropsFactory(mapStateToProps)  &#x2F;* ç»è¿‡ä»£ç†åŒ…è£…åçš„ mapDispatchToPropsï¼Œå®Œæˆä¼ å…¥store.dispatchç­‰æ“ä½œ*&#x2F;  const initMapDispatchToProps &#x3D; mapDispatchToPropsFactory(mapDispatchToProps)  &#x2F;* ç»è¿‡ä»£ç†åŒ…è£…åçš„ mergePropsï¼Œç”¨äºå½¢æˆçœŸæ­£çš„ mergePropså‡½æ•°ï¼Œåˆå¹¶ä¸šåŠ¡ç»„ä»¶çš„ props , state æ˜ å°„çš„ props , dispatch æ˜ å°„çš„ props *&#x2F;  const initMergeProps &#x3D; mergePropsFactory(mergeProps)  const shouldHandleStateChanges &#x3D; Boolean(mapStateToProps)  &#x2F;&#x2F;é»˜è®¤çš„é«˜é˜¶ç»„ä»¶connectAdvancedï¼Œå®é™…æ¸²æŸ“çš„ç»„ä»¶æ˜¯å…¶ä¸­è¿”å›çš„ä¸€ä¸ªConnectFunction&#x2F;&#x2F;selectorFactoryä¸ºæ•´åˆconnectæ›´æ–°è¿‡ç¨‹ä¸­çš„å½¢æˆæ–°propsçš„ä¸»è¦å‡½æ•°&#x2F;&#x2F;selectorFactoryä¸ºåé¢çš„finalPropsSelectorFactory  const wrapWithConnect: AdvancedComponentDecorator&lt;    TOwnProps,    WrappedComponentProps  &gt; &#x3D; (WrappedComponent) &#x3D;&gt; &#123;    ...  &#125;&#125;</code></pre><ul><li>å½“æˆ‘ä»¬ä¸å‘connectä¼ é€’ç¬¬ä¸‰ä¸ªå‚æ•°mergeProps çš„æ—¶å€™ï¼Œé»˜è®¤çš„defaultMergePropså¦‚ä¸‹ï¼Œä½œä¸ºæ–°çš„ props ä¼ é€’ç»™äº†ä¸šåŠ¡ç»„ä»¶</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export function defaultMergeProps(stateProps, dispatchProps, ownProps) &#123;  return &#123; ...ownProps, ...stateProps, ...dispatchProps &#125;&#125;</code></pre><h2 id="selectorFactory"><a href="#selectorFactory" class="headerlink" title="selectorFactory"></a>selectorFactory</h2><p><img src="http://t-blog-images.aijs.top/img/20220525101153.webp"></p><ul><li>é¦–å…ˆå¾—åˆ°çœŸæ­£connect ç»è¿‡ä¸€å±‚ä»£ç†å‡½æ•° mapStateToProps ,mapDispatchToProps ,mergeProps</li><li>ç„¶åè°ƒç”¨selectorFactory (åœ¨pureæ¨¡å¼ä¸‹ï¼ŒselectorFactory å°±æ˜¯ pureFinalPropsSelectorFactory )<pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function finalPropsSelectorFactory(  dispatch,  &#123; initMapStateToProps, initMapDispatchToProps, initMergeProps, ...options &#125;) &#123;  &#x2F;&#x2F; mapStateToProps mapDispatchToProps mergeProps ä¸ºçœŸæ­£connect ç»è¿‡ä¸€å±‚ä»£ç†çš„ proxy å‡½æ•°  const mapStateToProps &#x3D; initMapStateToProps(dispatch, options)  const mapDispatchToProps &#x3D; initMapDispatchToProps(dispatch, options)  const mergeProps &#x3D; initMergeProps(dispatch, options)  &#x2F;&#x2F;é»˜è®¤pureä¸ºtrueï¼ŒselectorFactoryé»˜è®¤ä¸ºpureFinalPropsSelectorFactory  const selectorFactory &#x3D; options.pure ? pureFinalPropsSelectorFactory : impureFinalPropsSelectorFactory   &#x2F;&#x2F; è¿”å›ä¸€ä¸ª å‡½æ•°ç”¨äºç”Ÿæˆæ–°çš„ props   return selectorFactory(    mapStateToProps,    mapDispatchToProps,    mergeProps,    dispatch,    options  )&#125;</code></pre></li></ul><h2 id="pureFinalPropsSelectorFactory"><a href="#pureFinalPropsSelectorFactory" class="headerlink" title="pureFinalPropsSelectorFactory"></a>pureFinalPropsSelectorFactory</h2><p><img src="http://t-blog-images.aijs.top/img/20220525100640.webp"></p><ul><li>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ï¼Œé‚£ä¹ˆç›´æ¥è°ƒç”¨mergePropsåˆå¹¶ownProps,stateProps,dispatchProps å½¢æˆæœ€ç»ˆçš„propsã€‚</li><li>å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œé‚£ä¹ˆåˆ¤æ–­åˆ°åº•æ˜¯propsè¿˜æ˜¯ store.state å‘ç”Ÿæ”¹å˜ï¼Œç„¶åé’ˆå¯¹é‚£é‡Œå˜åŒ–ï¼Œé‡æ–°ç”Ÿæˆå¯¹åº”çš„propsï¼Œæœ€ç»ˆåˆå¹¶åˆ°çœŸæ­£çš„props</li><li>æ•´ä¸ª selectorFactory é€»è¾‘å°±æ˜¯å½¢æˆæ–°çš„propsä¼ é€’ç»™æˆ‘ä»¬çš„ä¸šåŠ¡ç»„ä»¶ã€‚</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;** pureç»„ä»¶å¤„ç† ï¼Œ å¯¹æ¯” props æ˜¯å¦å‘ç”Ÿå˜åŒ– ç„¶å åˆå¹¶props *&#x2F;export function pureFinalPropsSelectorFactory(  mapStateToProps,  mapDispatchToProps,  mergeProps,  dispatch,  &#123; areStatesEqual, areOwnPropsEqual, areStatePropsEqual &#125; &#x2F;&#x2F;åˆ¤æ–­ state prop æ˜¯å¦ç›¸ç­‰) &#123;  let hasRunAtLeastOnce &#x3D; false  let state  let ownProps  let stateProps  let dispatchProps  let mergedProps   &#x2F;* ç¬¬ä¸€æ¬¡ ç›´æ¥å½¢æˆ ownProps  stateProps  dispatchProps åˆå¹¶  å½¢æˆæ–°çš„ props *&#x2F;  function handleFirstCall(firstState, firstOwnProps) &#123;    state &#x3D; firstState    ownProps &#x3D; firstOwnProps    &#x2F;&#x2F;è·å–ä¸šåŠ¡ç»„ä»¶ä¸­mapStateToPropså‡½æ•°çš„è¿”å›å€¼    stateProps &#x3D; mapStateToProps(state, ownProps)    &#x2F;&#x2F;è·å–ä¸šåŠ¡ç»„ä»¶ä¸­mapDispatchToPropså‡½æ•°çš„è¿”å›å€¼    dispatchProps &#x3D; mapDispatchToProps(dispatch, ownProps)    &#x2F;&#x2F;åˆå¹¶stateã€dispatchã€ç»„ä»¶è‡ªèº«çš„propsï¼Œå½¢æˆæœ€ç»ˆä¼ é€’ç»™ç»„ä»¶çš„props    mergedProps &#x3D; mergeProps(stateProps, dispatchProps, ownProps)    hasRunAtLeastOnce &#x3D; true    return mergedProps  &#125;    function handleNewPropsAndNewState() &#123;    &#x2F;&#x2F;  props å’Œ state éƒ½æ”¹å˜  mergeProps   &#125;  function handleNewProps() &#123;    &#x2F;&#x2F; props æ”¹å˜  mergeProps  &#125;  function handleNewState() &#123;     &#x2F;&#x2F; state æ”¹å˜ mergeProps  &#125;  &#x2F;*  ä¸æ˜¯ç¬¬ä¸€æ¬¡çš„æƒ…å†µ props æˆ–è€… store.state å‘ç”Ÿæ”¹å˜çš„æƒ…å†µã€‚ *&#x2F;  function handleSubsequentCalls(nextState, nextOwnProps) &#123;      &#x2F;* åˆ¤æ–­ä¸¤æ¬¡ props æ˜¯å¦ç›¸ç­‰ *&#x2F;    const propsChanged &#x3D; !areOwnPropsEqual(nextOwnProps, ownProps)       &#x2F;* åˆ¤æ–­ä¸¤æ¬¡ store.state æ˜¯å¦ç›¸ç­‰ *&#x2F;    const stateChanged &#x3D; !areStatesEqual(nextState, state)    state &#x3D; nextState    ownProps &#x3D; nextOwnProps        &#x2F;&#x2F;æ ¹æ®æ”¹å˜çš„ç±»å‹ä¸åŒï¼Œè¿”å›å¯¹åº”åˆå¹¶ç­–ç•¥ä¸‹çš„props    if (propsChanged &amp;&amp; stateChanged) return handleNewPropsAndNewState()    if (propsChanged) return handleNewProps()    if (stateChanged) return handleNewState()    return mergedProps  &#125;    &#x2F;&#x2F;æ ¹æ®æ˜¯å¦ç¬¬ä¸€æ¬¡å½¢æˆpropsï¼Œæ‰§è¡Œå¯¹åº”æ–¹æ³•  return function pureFinalPropsSelector(nextState, nextOwnProps) &#123;    return hasRunAtLeastOnce      ? handleSubsequentCalls(nextState, nextOwnProps)      : handleFirstCall(nextState, nextOwnProps)  &#125;&#125;</code></pre><h2 id="connectHOC"><a href="#connectHOC" class="headerlink" title="connectHOC"></a>connectHOC</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">const mapStateToProp &#x3D; (store) &#x3D;&gt; (&#123; userInfo: store.root.userInfo &#125;)function Index()&#123;    &#x2F;* ..... *&#x2F;    return &lt;div&gt; &#123; &#x2F;* .... *&#x2F; &#125; &lt;&#x2F;div&gt;&#125;export default connect(mapStateToProp)(Index)</code></pre><ul><li>connect(mapStateToProp)&#x3D;&#x3D;&#x3D;connectAdvanced()</li></ul><details class="custom-details"><summary>ç‚¹å‡»æŸ¥çœ‹æ›´å¤š</summary><p><ul><li>è¿™éƒ¨åˆ†ä»£ç ï¼Œåœ¨8.x.xç‰ˆæœ¬åœ¨conncetä¸­ç›´æ¥å¤„ç†ï¼Œå¹¶æ²¡æœ‰æ‹†åˆ†ä¸ºå•ç‹¬å‡½æ•°</li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function connectAdvanced(  selectorFactory, &#x2F;&#x2F; æ¯æ¬¡ props,stateæ”¹å˜æ‰§è¡Œ ï¼Œç”¨äºç”Ÿæˆæ–°çš„ propsã€‚  &#123;    getDisplayName &#x3D; name &#x3D;&gt; &#96;ConnectAdvanced($&#123;name&#125;)&#96;,    &#x2F;&#x2F;å¯èƒ½è¢«åŒ…è£…å‡½æ•°ï¼ˆå¦‚connectï¼ˆï¼‰ï¼‰é‡å†™    methodName &#x3D; &#39;connectAdvanced&#39;,    &#x2F;&#x2F;å¦‚æœå®šä¹‰äº†ï¼Œåˆ™ä¼ é€’ç»™åŒ…è£…å…ƒç´ çš„å±æ€§çš„åç§°ï¼ŒæŒ‡ç¤ºè¦å‘ˆç°çš„è°ƒç”¨ã€‚ç”¨äºç›‘è§†react devtoolsä¸­ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚    renderCountProp &#x3D; undefined,    shouldHandleStateChanges &#x3D; true,  &#x2F;&#x2F;ç¡®å®šæ­¤HOCæ˜¯å¦è®¢é˜…å­˜å‚¨æ›´æ”¹    storeKey &#x3D; &#39;store&#39;,    withRef &#x3D; false,    forwardRef &#x3D; false, &#x2F;&#x2F; æ˜¯å¦ ç”¨ forwarRef æ¨¡å¼    context &#x3D; ReactReduxContext,&#x2F;&#x2F; Provider ä¿å­˜çš„ä¸Šä¸‹æ–‡    ...connectOptions  &#125; &#x3D; &#123;&#125;) &#123;  &#x2F;* ReactReduxContext å°±æ˜¯storeå­˜åœ¨çš„context *&#x2F;  const Context &#x3D; context   &#x2F;* WrappedComponent ä¸ºconnect åŒ…è£¹çš„ç»„ä»¶æœ¬èº«  *&#x2F;     return  function wrapWithConnect(WrappedComponent)&#123;      &#x2F;&#x2F; WrappedComponent è¢« connect çš„ä¸šåŠ¡ç»„ä»¶æœ¬èº«  &#125;&#125;</code></pre><ul><li>æ‹¿åˆ°Provideræä¾›çš„contextä¸Šä¸‹æ–‡</li></ul></p></details><h2 id="wrapWithConnect"><a href="#wrapWithConnect" class="headerlink" title="wrapWithConnect"></a>wrapWithConnect</h2><p>wrapWithConnectä½œä¸ºé«˜é˜¶ç»„ä»¶ï¼Œä¼šè¿”å›ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä¼šå¯¹åŸæœ‰çš„ä¸šåŠ¡ç»„ä»¶ï¼Œè¿›è¡Œä¸€ç³»åˆ—å¢å¼ºç­‰å·¥ä½œ<br>åˆ¤æ–­æ˜¯å¦æ˜¯ pure çº¯ç»„ä»¶æ¨¡å¼ï¼Œå¦‚æœæ˜¯ç”¨react.memoåŒ…è£¹,è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¼šå‘ pureComponent ä¸€æ ·å¯¹ props è¿›è¡Œæµ…æ¯”è¾ƒ<br>å¦‚æœ connect æœ‰forwardRefé…ç½®é¡¹ï¼Œç”¨React.forwardRefå¤„ç†</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">function wrapWithConnect(WrappedComponent) &#123;&#x2F;&#x2F;WrappedComponentä¸ºå®é™…ä¼ é€’çš„ä¸šåŠ¡ç»„ä»¶    const wrappedComponentName &#x3D;      WrappedComponent.displayName || WrappedComponent.name || &#39;Component&#39;      const displayName &#x3D; getDisplayName(wrappedComponentName)        &#x2F;&#x2F;è¦åˆå¹¶éƒ½å†…å®¹ï¼ŒconnectOptionsä¸ºä¸Šä¸€æ­¥é—­åŒ…æ‹¿åˆ°çš„å†…å®¹    const selectorFactoryOptions &#x3D; &#123;      ...connectOptions,      getDisplayName,      methodName,      renderCountProp,      shouldHandleStateChanges,      storeKey,      displayName,      wrappedComponentName,      WrappedComponent    &#125;    const &#123; pure &#125; &#x3D; connectOptions        &#x2F;&#x2F;selectorFactoryä¸ºfinalPropsSelectorFactory    function createChildSelector(store) &#123;      &#x2F;&#x2F; åˆå¹¶å‡½æ•° mergeprops å¾—åˆ°æœ€æ–°çš„props      &#x2F;&#x2F; åŠé»˜è®¤è¿”å›pureFinalPropsSelectorFactoryï¼Œä¼šæ ¹æ®æ˜¯å¦ç¬¬ä¸€æ¬¡åˆå¹¶ã€ä¿®æ”¹ç±»å‹ç­‰è¿›è¡Œä¸åŒç­–ç•¥ç­‰åˆå¹¶ä»¥åŠè¿”å›æœ€ç»ˆéƒ½props      return selectorFactory(store.dispatch, selectorFactoryOptions)    &#125;    &#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦æ˜¯pureçº¯ç»„ä»¶æ¨¡å¼ å¦‚æœæ˜¯å°†ç”¨ useMemo ç¼“å­˜ç»„ä»¶æå‡æ€§èƒ½    const usePureOnlyMemo &#x3D; pure ? useMemo : callback &#x3D;&gt; callback()    &#x2F;&#x2F; è´Ÿè´£æ›´æ–°çš„å®¹å™¨å­ç»„ä»¶ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å®é™…æ¸²æŸ“çš„ç±»ç»„ä»¶    function ConnectFunction (props)&#123;        &#x2F;&#x2F; props ä¸º ä¸šåŠ¡ç»„ä»¶ çœŸæ­£çš„ props     &#125;    &#x2F;&#x2F;å¦‚æœ    const Connect &#x3D; pure ? React.memo(ConnectFunction) : ConnectFunction      Connect.WrappedComponent &#x3D; WrappedComponent    Connect.displayName &#x3D; displayName    &#x2F;* forwardRef *&#x2F;    if (forwardRef) &#123;      const forwarded &#x3D; React.forwardRef(function forwardConnectRef(        props,        ref      ) &#123;      &#x2F;&#x2F;connectä¸­æ˜¯å¦ä¼ é€’äº†forwardRefé€‰é¡¹        return &lt;Connect &#123;...props&#125; reactReduxForwardedRef&#x3D;&#123;ref&#125; &#x2F;&gt;      &#125;)        forwarded.displayName &#x3D; displayName      forwarded.WrappedComponent &#x3D; WrappedComponent      &#x2F;&#x2F;hoistStaticsä¸ºä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œè´Ÿè´£æŠŠä¸€ä¸ªç±»ä¸­çš„é™æ€å±æ€§æ‹·è´åˆ°å¦ä¸€ä¸ªç±»ä¸­      return hoistStatics(forwarded, WrappedComponent)    &#125;      return hoistStatics(Connect, WrappedComponent)  &#125;&#125;</code></pre><h2 id="ä¸ºä½•è¦ä¼ é€’forwardRefï¼Ÿ"><a href="#ä¸ºä½•è¦ä¼ é€’forwardRefï¼Ÿ" class="headerlink" title="ä¸ºä½•è¦ä¼ é€’forwardRefï¼Ÿ"></a>ä¸ºä½•è¦ä¼ é€’forwardRefï¼Ÿ</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">connect(mapStateToProp,mapDispatchToProps,mergeProps,&#123; forwardRef:true  &#125;)(Child)</code></pre><p>å¦‚æœä¸ä¼ é€’ï¼Œè€Œæ˜¯åœ¨å…¶ä»–ç»„ä»¶ä¸­ç›´æ¥æ”¾refåˆ°ä½¿ç”¨äº†connectçš„ç»„ä»¶ï¼Œåˆ™refå®é™…åº”ç”¨åˆ°çš„æ˜¯ConncectFunctionç»„ä»¶ï¼Œè€ŒéçœŸæ­£çš„WrappedComponentç»„ä»¶<br>æ‰€ä»¥react-reduxæä¾›forwardRefé€‰é¡¹ï¼Œä½¿ç”¨React.forwardRefï¼Œå°†refå®é™…æ”¾åˆ°çœŸæ­£çš„WrappedComponentä¸Š</p><h2 id="ConnectFunction"><a href="#ConnectFunction" class="headerlink" title="ConnectFunction"></a>ConnectFunction</h2><ul><li><p>å®é™…æ¸²æŸ“çš„ç»„ä»¶</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">function ConnectFunction(props) &#123;    &#x2F;* TODO:  ç¬¬ä¸€æ­¥ æŠŠ context ForwardedRef props å–å‡ºæ¥ *&#x2F;    &#x2F;&#x2F;å–å‡ºforwardRefå’Œä¼ é€’ç»™ConnectFunctionçš„æ‰€æœ‰é™¤forwardRefçš„props    &#x2F;&#x2F;é™¤äº†forwardRefä»¥å¤–çš„propsä¹Ÿå°±æ˜¯å®é™…ä¸šåŠ¡ä»£ç ä¸­ä¼ é€’ç»™conncecåŒ…è£¹ç»„ä»¶éƒ½props    const [      reactReduxForwardedRef,      wrapperProps &#x2F;&#x2F; props ä¼ é€’çš„props    ] &#x3D; useMemo(() &#x3D;&gt; &#123;      const &#123; reactReduxForwardedRef, ...wrapperProps &#125; &#x3D; props      return [reactReduxForwardedRef, wrapperProps]    &#125;, [props])   &#x2F;&#x2F; è·å–ä¸Šå±‚Provideræä¾›çš„contextï¼Œå¤šä¸ªProvideråªä¼šå–æœ€è¿‘çš„Provider    &#x2F;&#x2F; è·å– contextå†…å®¹ é‡Œé¢å«æœ‰  redux ä¸­store å’Œ subscription    const contextValue &#x3D; useContext(Context)    &#x2F;&#x2F;TODO: åˆ¤æ–­ store æ˜¯å¦æ¥è‡ªprops  didStoreComeFromProps ,æ­£å¸¸æƒ…å†µä¸‹ ï¼Œprop ä¸­æ˜¯ä¸å­˜åœ¨ store æ‰€ä»¥  didStoreComeFromProps &#x3D; false    const didStoreComeFromProps &#x3D;      Boolean(props.store) &amp;&amp;      Boolean(props.store.getState) &amp;&amp;      Boolean(props.store.dispatch)    &#x2F;&#x2F;storeæ˜¯å¦æ¥è‡ªProvideræä¾›çš„ä¸Šä¸‹æ–‡    const didStoreComeFromContext &#x3D;      Boolean(contextValue) &amp;&amp; Boolean(contextValue.store)    &#x2F;&#x2F;æ ¹æ®ä¸¤ç§æƒ…å†µè·å–store    const store &#x3D; didStoreComeFromProps ? props.store : contextValue.store          &#x2F;&#x2F;è¿”å›mergeå‡½æ•° ç”¨äºç”ŸæˆçœŸæ­£ä¼ ç»™å­ç»„ä»¶ props    const childPropsSelector &#x3D; useMemo(() &#x3D;&gt; &#123;    &#x2F;&#x2F;é»˜è®¤æƒ…å†µä¸‹pureä¸ºtrueï¼Œè¿”å›çš„æ˜¯pureFinalPropsSelectorFactory      return createChildSelector(store)    &#125;, [store])    &#x2F;&#x2F; TODO:  ç¬¬äºŒæ­¥  åˆ›å»ºconnectç»„ä»¶è‡ªèº«çš„subscription ç›‘å¬è€…å®ä¾‹      const [subscription, notifyNestedSubs] &#x3D; useMemo(() &#x3D;&gt; &#123;        &#x2F;&#x2F; å¦‚æœæ²¡æœ‰è®¢é˜…æ›´æ–°ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ï¼Œé»˜è®¤æƒ…å†µä¸‹å¼€å¯äº†è®¢é˜…      if (!shouldHandleStateChanges) return NO_SUBSCRIPTION_ARRAY&#x2F;&#x2F;ä¸ºæ¯ä¸€ä¸ªconncetçš„ç»„ä»¶åˆ›å»ºè®¢é˜…å™¨ï¼Œè·å–ä¸Šå±‚Provideræä¾›çš„contextValue.subscription&#x2F;&#x2F;connctçš„ç»„ä»¶è·å–çš„æ˜¯ä¸Šå±‚çš„Provderæä¾›çš„subscriptionï¼Œæœ‰å¤šä¸ªProviderï¼Œåªä¼šå–å±‚çº§æœ€è¿‘çš„ä¸€ä¸ª&#x2F;&#x2F;æ‰€ä»¥connectä¸­çš„connectç»„ä»¶ï¼Œè·å–åˆ°çš„æ˜¯ç¦»å®ƒæœ€è¿‘çš„Providerä¸­çš„è®¢é˜…å™¨ï¼Œé€šè¿‡å®ƒæ¥ç®¡ç†è‡ªèº«çš„listeneræ›´æ–°å‡½æ•°      const subscription &#x3D; new Subscription(        store,        didStoreComeFromProps ? null : contextValue.subscription &#x2F;&#x2F; å’Œ ä¸Šçº§ &#96;subscription&#96; å»ºç«‹èµ·å…³ç³»ã€‚ this.parentSub &#x3D; contextValue.subscription      )      &#x2F;&#x2F; notifyNestedSubs è§¦å‘ noticy æ‰€æœ‰å­ä»£ listener ç›‘å¬è€… -&gt; è§¦å‘batchæ–¹æ³•,è§¦å‘ batchupdateæ–¹æ³• ,æ‰¹é‡æ›´æ–°      &#x2F;&#x2F;å¹¶æ›´æ–°ä¸€ä¸‹thisæŒ‡å‘      const notifyNestedSubs &#x3D; subscription.notifyNestedSubs.bind(        subscription      )      return [subscription, notifyNestedSubs]    &#125;, [store, didStoreComeFromProps, contextValue])    &#x2F;*  åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„contextValue ,æŠŠçˆ¶çº§çš„ subscription æ¢æˆè‡ªå·±çš„ subscription   *&#x2F;    const overriddenContextValue &#x3D; useMemo(() &#x3D;&gt; &#123;         if (didStoreComeFromProps) &#123;         return contextValue      &#125;      &#x2F;&#x2F;é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿”å›è‡ªèº«çš„è®¢é˜…å™¨ä»¥åŠreduxä¸­çš„storeç»™è‡ªèº«çš„å­ä»£connectä¸­è·å–      return &#123;        ...contextValue,        subscription      &#125;    &#125;, [didStoreComeFromProps, contextValue, subscription])        &#x2F;&#x2F;å®šä¹‰äº†ä¸€ä¸ªuseReducerï¼Œå½“actualChildPropså˜åŒ–æ—¶ï¼Œè°ƒç”¨dispatchæ–¹æ³•forceComponentUpdateDispatchè¿›è¡Œç»„ä»¶æ›´æ–°    const [      [previousStateUpdateResult], &#x2F;&#x2F;è°ƒç”¨dispatchæ›´æ–°åçš„å†…å®¹      forceComponentUpdateDispatch  &#x2F;*  *&#x2F;    ] &#x3D; useReducer(storeStateUpdatesReducer, EMPTY_ARRAY, initStateUpdates)    &#x2F;&#x2F; TODO: ç¬¬ä¸‰æ­¥ç¼“å­˜ç»„ä»¶æœ¬æ¬¡çš„propsç­‰å†…å®¹ï¼Œåœ¨ä¸‹ä¸€æ¬¡ç»„ä»¶æ›´æ–°æ—¶åšæ¯”è¾ƒ    const lastChildProps &#x3D; useRef() &#x2F;&#x2F;ä¿å­˜ä¸Šä¸€æ¬¡ åˆå¹¶è¿‡çš„ propsä¿¡æ¯ï¼ˆç»è¿‡ ownprops ,stateProps , dispatchProps åˆå¹¶è¿‡çš„ ï¼‰    const lastWrapperProps &#x3D; useRef(wrapperProps) &#x2F;&#x2F;ä¿å­˜æœ¬æ¬¡ä¸šåŠ¡ç»„ä»¶çš„ props     const childPropsFromStoreUpdate &#x3D; useRef() &#x2F;&#x2F;ç”¨æ¥ä¿å­˜æ›´æ–°åçš„æœ€æ–°çš„props    const renderIsScheduled &#x3D; useRef(false) &#x2F;&#x2F; å½“å‰ç»„ä»¶æ˜¯å¦å¤„äºæ¸²æŸ“é˜¶æ®µ        &#x2F;&#x2F; actualChildProps ä¸ºå½“å‰çœŸæ­£å¤„ç†è¿‡åï¼Œç»è¿‡åˆå¹¶çš„ props    const actualChildProps &#x3D; usePureOnlyMemo(() &#x3D;&gt; &#123;        &#x2F;&#x2F; è°ƒç”¨ mergeProps è¿›è¡Œåˆå¹¶ï¼Œè¿”å›åˆå¹¶åçš„æœ€æ–° porps        &#x2F;&#x2F;åŠè°ƒç”¨pureFinalPropsSelectorFactoryåçš„åˆå¹¶ç»“æœ      return childPropsSelector(store.getState(), wrapperProps)         &#x2F;&#x2F;ä¼šåœ¨storeã€è°ƒç”¨äº†checkForUpdatesã€ä¼ é€’ç»™ç»„å»ºçš„propså‘ç”Ÿå˜åŒ–åï¼Œé‡æ–°è®¡ç®—è·å–åˆå¹¶åçš„props     &#125;, [store, previousStateUpdateResult, wrapperProps])   &#x2F;* è´Ÿè´£æ›´æ–°ç¼“å­˜å˜é‡ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™æ¯”è¾ƒ *&#x2F;    useEffect(()&#x3D;&gt;&#123;      captureWrapperProps(...[          lastWrapperProps,          lastChildProps,          renderIsScheduled,          wrapperProps,          actualChildProps,          childPropsFromStoreUpdate,          notifyNestedSubs       ])    &#125;)        &#x2F;&#x2F;å®é™…è®¢é˜…æ›´æ–°ç»„ä»¶çš„åœ°æ–¹    useEffect(()&#x3D;&gt;&#123;        subscribeUpdates(...[        shouldHandleStateChanges,        store,        subscription,        childPropsSelector,        lastWrapperProps,        lastChildProps,        renderIsScheduled,        childPropsFromStoreUpdate,        notifyNestedSubs,        forceComponentUpdateDispatch       ])    &#125;,[store, subscription, childPropsSelector])    &#x2F;&#x2F; TODO: ç¬¬å››æ­¥ï¼šæ¸²æŸ“å®é™…æŒ‚è½½çš„ç»„ä»¶ï¼Œé€šè¿‡useMemoè¿›è¡Œç»„ä»¶çš„ç¼“å­˜    const renderedWrappedComponent &#x3D; useMemo(      () &#x3D;&gt; (        &lt;WrappedComponent          &#123;...actualChildProps&#125;          ref&#x3D;&#123;reactReduxForwardedRef&#125;        &#x2F;&gt;      ),      &#x2F;&#x2F;å½“actualChildPropså‘ç”Ÿå˜åŒ–çš„æ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶      &#x2F;&#x2F;è¿™é‡Œå°±æ˜¯ç»„ä»¶é‡æ–°æ¸²æŸ“çš„åŸå› ï¼šä¸»è¦é€šè¿‡ç›‘å¬actualChildPropsçš„å˜åŒ–      [reactReduxForwardedRef, WrappedComponent, actualChildProps]    )    &#x2F;&#x2F; å°†ä¸Šä¸€æ­¥çš„renderedWrappedComponentåŒ…è£¹ä¸€å±‚Provider    &#x2F;&#x2F; æä¾›è¯¥connectç»„ä»¶è‡ªèº«çš„è®¢é˜…å™¨ã€storeç»™å­ä»£ä¸­çš„connectç»„ä»¶è·å–    const renderedChild &#x3D; useMemo(() &#x3D;&gt; &#123;      &#x2F;&#x2F;shouldHandleStateChanges æ¥æº connectæ˜¯å¦æœ‰ç¬¬ä¸€ä¸ªå‚æ•°      if (shouldHandleStateChanges) &#123;        return (          &#x2F;&#x2F; ContextToUse ä¼ é€’ context           &lt;ContextToUse.Provider value&#x3D;&#123;overriddenContextValue&#125;&gt;            &#123;renderedWrappedComponent&#125;          &lt;&#x2F;ContextToUse.Provider&gt;        )      &#125;      return renderedWrappedComponent    &#125;, [ContextToUse, renderedWrappedComponent, overriddenContextValue])    return renderedChild  &#125;</code></pre></li><li><p>åˆ›å»ºè¯¥connectç»„ä»¶è‡ªèº«çš„subscription, å¹¶ä½¿ç”¨ProvideråŒ…è£¹ï¼Œå±‚å±‚ä¼ é€’æ–°çš„context(å¾ˆé‡è¦)</p></li><li><p>æ‰€ä»¥connectç»„ä»¶çš„å­ä»£connectç»„ä»¶ï¼Œè·å–åˆ°çš„éƒ½æ˜¯å…¶ä¸Šå±‚æœ€è¿‘çš„connectæä¾›çš„Providerä¸­çš„è®¢é˜…å™¨ï¼Œç„¶åå°†æ›´æ–°å‡½æ•°checkForUpdatesæ”¾è¿›å…¶ä¸­ç®¡ç†</p></li><li><p>ç„¶åé€šè¿‡ useMemo åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„ contextValue ,æŠŠçˆ¶çº§çš„ subscription æ¢æˆè‡ªå·±çš„ subscriptionã€‚ç”¨äºé€šè¿‡ Provider ä¼ é€’æ–°çš„ context</p></li><li><p>æ¥ä¸‹æ¥é€šè¿‡useReduceråˆ¶é€ å‡ºçœŸæ­£è§¦å‘æ›´æ–°çš„forceComponentUpdateDispatch è¿™ä¸ªdispatchå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯æ•´ä¸ª state æˆ–è€…æ˜¯ propsæ”¹å˜ï¼Œè§¦å‘ç»„ä»¶æ›´æ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ”¾è¿›checkForUpdatesä¸­æ‰§è¡Œ</p></li></ul><h2 id="captureWrapperProps"><a href="#captureWrapperProps" class="headerlink" title="captureWrapperProps"></a>captureWrapperProps</h2><ul><li>è¿›è¡Œå†…å®¹ç¼“å­˜ï¼Œä¸ºäº†ä¸‹æ¬¡ç»„ä»¶æ›´æ–°è¿›è¡Œæ¯”è¾ƒ<pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F;è·å–åŒ…è£…çš„props function captureWrapperProps(  lastWrapperProps,  lastChildProps,  renderIsScheduled,  wrapperProps,  actualChildProps,  childPropsFromStoreUpdate,  notifyNestedSubs) &#123;  lastWrapperProps.current &#x3D; wrapperProps  &#x2F;&#x2F;å­props   lastChildProps.current &#x3D; actualChildProps &#x2F;&#x2F;ç»è¿‡ megeprops ä¹‹åå½¢æˆçš„æ–°prop  renderIsScheduled.current &#x3D; false  &#x2F;&#x2F; å½“å‰ç»„ä»¶æ¸²æŸ“å®Œæˆ&#125;</code></pre></li></ul><h2 id="subscribeUpdates"><a href="#subscribeUpdates" class="headerlink" title="subscribeUpdates"></a>subscribeUpdates</h2><ul><li><p>å®é™…æ·»åŠ æ›´æ–°å›è°ƒçš„åœ°æ–¹</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function subscribeUpdates(  shouldHandleStateChanges,  store,  subscription,  childPropsSelector,  lastWrapperProps,  &#x2F;&#x2F;å­props   lastChildProps, &#x2F;&#x2F;ç»è¿‡ megeprops ä¹‹åå½¢æˆçš„ prop  renderIsScheduled,  childPropsFromStoreUpdate,  notifyNestedSubs,  forceComponentUpdateDispatch) &#123;  if (!shouldHandleStateChanges) return   &#x2F;&#x2F; æ•è·å€¼ä»¥æ£€æŸ¥æ­¤ç»„ä»¶æ˜¯å¦å¸è½½ä»¥åŠä½•æ—¶å¸è½½  let didUnsubscribe &#x3D; false  let lastThrownError &#x3D; null   &#x2F;&#x2F;storeæ›´æ–°è®¢é˜…ä¼ æ’­åˆ°æ­¤ç»„ä»¶æ—¶ï¼Œè¿è¡Œæ­¤å›è°ƒ  const checkForUpdates &#x3D; ()&#x3D;&gt;&#123;      &#x2F;&#x2F;....  &#125;  &#x2F;&#x2F;å°†checkForUpdatesä½œä¸ºlistener  subscription.onStateChange &#x3D; checkForUpdates  &#x2F;&#x2F;å¼€å¯è®¢é˜…è€… ï¼Œå½“å‰æ˜¯è¢«connect åŒ…è½¬çš„æƒ…å†µ ä¼šæŠŠ å½“å‰çš„ checkForceUpdate æ”¾åœ¨å­˜å…¥ çˆ¶å…ƒç´ çš„addNestedSubä¸­ã€‚  subscription.trySubscribe()  &#x2F;&#x2F;åœ¨ç¬¬ä¸€æ¬¡å‘ˆç°ä¹‹åä»å­˜å‚¨ä¸­æå–æ•°æ®ï¼Œä»¥é˜²å­˜å‚¨ä»æˆ‘ä»¬å¼€å§‹å°±æ”¹å˜äº†ã€‚  &#x2F;&#x2F;ç¡®ä¿è·å–åˆ°çš„æœ€æ–°çš„store.getState,ç„¶ååˆ¤æ–­æ˜¯å¦æ›´æ–°ç»„ä»¶  checkForUpdates()  &#x2F;* å¸è½½è®¢é˜…èµ· *&#x2F;  const unsubscribeWrapper &#x3D; () &#x3D;&gt; &#123;    didUnsubscribe &#x3D; true    subscription.tryUnsubscribe()    subscription.onStateChange &#x3D; null  &#125;  return unsubscribeWrapper&#125;</code></pre></li><li><p>é¦–å…ˆå£°æ˜ store æ›´æ–°è®¢é˜…ä¼ æ’­åˆ°æ­¤ç»„ä»¶æ—¶çš„å›è°ƒå‡½æ•°checkForUpdatesæŠŠå®ƒèµ‹å€¼ç»™onStateChange,å¦‚æœstoreä¸­çš„stateå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆåœ¨ç»„ä»¶è®¢é˜…äº†stateå†…å®¹ä¹‹åï¼Œç›¸å…³è”çš„stateæ”¹å˜å°±ä¼šè§¦å‘å½“å‰ç»„ä»¶çš„onStateChange,æ¥åˆå¹¶å¾—åˆ°æ–°çš„props</p></li><li><p>subscription.trySubscribe()æŠŠè®¢é˜…å‡½æ•°onStateChangeç»‘å®šç»™çˆ¶çº§subscription,è¿›è¡Œäº†å±‚å±‚è®¢é˜…</p></li><li><p>ä¸ºäº†ç¡®ä¿æ‹¿åˆ°çš„storeå†…å®¹æ˜¯æœ€æ–°çš„ï¼Œæ‰€ä»¥é¦–å…ˆæ‰§è¡Œäº†ä¸€æ¬¡checkForUpdates<br><img src="https://img-blog.csdnimg.cn/d03af8b00dcd4deaad5bcb09c5cc2903.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56We5aWH5aSn5Y-U,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="checkForUpdates"><a href="#checkForUpdates" class="headerlink" title="checkForUpdates"></a>checkForUpdates</h2></li><li><p>åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°çš„å‡½æ•°</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F;storeæ›´æ–°è®¢é˜…ä¼ æ’­åˆ°æ­¤ç»„ä»¶æ—¶ï¼Œè¿è¡Œæ­¤å›è°ƒconst checkForUpdates &#x3D; () &#x3D;&gt; &#123;  if (didUnsubscribe) &#123;    &#x2F;&#x2F;å¦‚æœå–æ¶ˆè®¢é˜…äº†    return  &#125;   &#x2F;&#x2F; è·å– store é‡Œstate  const latestStoreState &#x3D; store.getState()q  let newChildProps, error  try &#123;    &#x2F;* å¾—åˆ°æœ€æ–°çš„ props *&#x2F;    newChildProps &#x3D; childPropsSelector(      latestStoreState,      lastWrapperProps.current    )  &#125;   &#x2F;&#x2F;å¦‚æœæ–°çš„åˆå¹¶çš„ propsæ²¡æœ‰æ›´æ”¹ï¼Œåˆ™æ­¤å¤„ä¸åšä»»ä½•æ“ä½œ-å±‚å è®¢é˜…æ›´æ–°  if (newChildProps &#x3D;&#x3D;&#x3D; lastChildProps.current) &#123;     if (!renderIsScheduled.current) &#123;        notifyNestedSubs() &#x2F;* é€šçŸ¥å­ä»£ subscription è§¦å‘ checkForUpdates æ¥æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ã€‚ *&#x2F;    &#125;  &#125; else &#123;    lastChildProps.current &#x3D; newChildProps    childPropsFromStoreUpdate.current &#x3D; newChildProps    renderIsScheduled.current &#x3D; true    &#x2F;&#x2F; è§¦å‘useReducerçš„dispatchæ¥è¿›è¡Œæ›´æ–°ï¼Œè¯¥dispatchä¼šæ”¹å˜useReducerè¿”å›çš„previousStateUpdateResult    &#x2F;&#x2F; è€ŒpreviousStateUpdateResultæ˜¯ä½œä¸ºactualChildPropsçš„ä¾èµ–é¡¹å¼•å‘actualChildPropsçš„æ”¹å˜    &#x2F;&#x2F; actualChildPropsåˆæ˜¯å®é™…æ¸²æŸ“ç»„ä»¶çš„ä¾èµ–æ€§ï¼Œä»è€Œå¼•å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“æ›´æ–°    forceComponentUpdateDispatch(&#123;      type: &#39;STORE_UPDATED&#39;,      payload: &#123;        error      &#125;    &#125;)  &#125;&#125;</code></pre></li><li><p>checkForUpdates é€šè¿‡è°ƒç”¨ childPropsSelectoræ¥å½¢æˆæ–°çš„props,ç„¶ååˆ¤æ–­ä¹‹å‰çš„ prop å’Œå½“å‰æ–°çš„ prop æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœç›¸ç­‰ï¼Œè¯æ˜æ²¡æœ‰å‘ç”Ÿå˜åŒ–,æ— é¡»æ›´æ–°å½“å‰ç»„ä»¶ï¼Œé‚£ä¹ˆé€šè¿‡è°ƒç”¨notifyNestedSubsæ¥é€šçŸ¥å­ä»£å®¹å™¨ç»„ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å¦‚æœä¸ç›¸ç­‰è¯æ˜è®¢é˜…çš„store.stateå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç«‹å³æ‰§è¡ŒforceComponentUpdateDispatchæ¥è§¦å‘ç»„ä»¶çš„æ›´æ–°</p></li></ul><h2 id="æ•´ä¸ªè®¢é˜…æµç¨‹"><a href="#æ•´ä¸ªè®¢é˜…æµç¨‹" class="headerlink" title="æ•´ä¸ªè®¢é˜…æµç¨‹"></a>æ•´ä¸ªè®¢é˜…æµç¨‹</h2><p>æ•´ä¸ªè®¢é˜…çš„æµç¨‹æ˜¯ï¼Œå¦‚æœè¢«connectåŒ…è£¹ï¼Œå¹¶ä¸”å…·æœ‰ç¬¬ä¸€ä¸ªå‚æ•°ã€‚é¦–å…ˆé€šè¿‡contextè·å–æœ€è¿‘çš„ subscriptionï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„subscription,å¹¶ä¸”å’Œçˆ¶çº§çš„subscriptionå»ºç«‹èµ·å…³è”ã€‚å½“ç¬¬ä¸€æ¬¡hocå®¹å™¨ç»„ä»¶æŒ‚åœ¨å®Œæˆåï¼Œåœ¨useEffecté‡Œï¼Œè¿›è¡Œè®¢é˜…ï¼Œå°†è‡ªå·±çš„è®¢é˜…å‡½æ•°checkForUpdates,ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œé€šè¿‡trySubscribe å’Œthis.parentSub.addNestedSub ,åŠ å…¥åˆ°çˆ¶çº§subscriptionçš„listenersä¸­ã€‚ç”±æ­¤å®Œæˆæ•´ä¸ªè®¢é˜…æµç¨‹</p><h2 id="æ•´ä¸ªå‘å¸ƒæµç¨‹"><a href="#æ•´ä¸ªå‘å¸ƒæµç¨‹" class="headerlink" title="æ•´ä¸ªå‘å¸ƒæµç¨‹"></a>æ•´ä¸ªå‘å¸ƒæµç¨‹</h2><p>æ•´ä¸ªæ›´æ–°æµç¨‹æ˜¯ï¼Œå½“ç»„ä»¶ä¸­è°ƒç”¨dispatchè§¦å‘äº†reduxçš„stateæ”¹å˜å’Œreduxçš„è®¢é˜…å™¨ï¼Œä»è€Œè§¦å‘æ ¹è®¢é˜…å™¨çš„è§¦å‘listeners.notify ,ä¹Ÿå°±æ˜¯checkForUpdateså‡½æ•°ï¼Œç„¶åcheckForUpdateså‡½æ•°é¦–å…ˆæ ¹æ®mapStoretopropsï¼Œmergepropsç­‰æ“ä½œï¼ŒéªŒè¯è¯¥ç»„ä»¶æ˜¯å¦å‘èµ·è®¢é˜…ï¼Œprops æ˜¯å¦æ”¹å˜ï¼Œå¹¶æ›´æ–°ï¼Œå¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆè§¦å‘useReducerçš„forceComponentUpdateDispatchå‡½æ•°ï¼Œæ¥æ›´æ–°ä¸šåŠ¡ç»„ä»¶ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œé‚£ä¹ˆé€šè¿‡è°ƒç”¨notifyNestedSubs,æ¥é€šçŸ¥å½“å‰subscriptionçš„listenersæ£€æŸ¥æ˜¯å¦æ›´æ–°ï¼Œç„¶åå°½å¿ƒå±‚å±‚checkForUpdates,é€çº§å‘ä¸‹ï¼Œå€Ÿæ­¤å®Œæˆæ•´ä¸ªæ›´æ–°æµç¨‹ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>connectä½¿ç”¨æŸ¯é‡ŒåŒ–</li><li>useMemoç¼“å­˜æ¸²æŸ“ç»„ä»¶çš„æ“ä½œ</li><li>å‘å¸ƒè®¢é˜…æ¨¡å¼ä»¥åŠé€šè¿‡åŒå‘é“¾è¡¨æ¥ç®¡ç†</li><li>å¦‚ä½•é€šè¿‡Providerè¿›è¡Œå±‚å±‚è®¢é˜…</li><li>react-reduxè§¦å‘æ›´æ–°çš„ä¾æ®æ˜¯actualChildPropsæ˜¯å¦æ”¹å˜</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/weixin_43294560/article/details/123284317">react-reduxæºç è§£æ</a><br><a href="https://github.com/841660202/react-redux">github æºç </a><br><a href="https://blog.csdn.net/qq_33715850/article/details/122535984">React-reduxæºç è§£æâ€“å‡†å¤‡çŸ¥è¯†</a><br><a href="https://blog.csdn.net/qq_33715850/article/details/122590433">React-reduxæºç è§£æ</a></p>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-redux </tag>
            
            <tag> redux </tag>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-redux æºç 1</title>
      <link href="//post/2022-05-24react-redux.html"/>
      <url>//post/2022-05-24react-redux.html</url>
      
        <content type="html"><![CDATA[<h2 id="react-reduxå®˜æ–¹ä»‹ç»"><a href="#react-reduxå®˜æ–¹ä»‹ç»" class="headerlink" title="react-reduxå®˜æ–¹ä»‹ç»"></a>react-reduxå®˜æ–¹ä»‹ç»</h2><ul><li>å®˜æ–¹UIç»‘å®šå±‚ã€‚ React Redux is the <code>official React UI bindings layer</code> for Redux. </li><li>ä»reduxçš„storeè¯»æ•°æ®ã€‚ It lets your React components <code>read data from a Redux store</code>,</li><li>è§¦å‘è¡Œä¸ºç»™storeæ¥æ›´æ–°çŠ¶æ€ã€‚and <code>dispatch actions to the store to update state</code>.</li></ul><h2 id="react-redux-æºç "><a href="#react-redux-æºç " class="headerlink" title="react-redux æºç "></a>react-redux æºç </h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.â”œâ”€â”€ alternate-renderers.tsâ”œâ”€â”€ componentsâ”‚Â Â  â”œâ”€â”€ Context.tsâ”‚Â Â  â”œâ”€â”€ Provider.tsxâ”‚Â Â  â””â”€â”€ connect.tsx # å¤§éƒ¨åˆ†ä»£ç éƒ½åœ¨è¿™é‡Œâ”œâ”€â”€ connect # ç»™ connect.tsxä½¿ç”¨â”‚Â Â  â”œâ”€â”€ invalidArgFactory.tsâ”‚Â Â  â”œâ”€â”€ mapDispatchToProps.tsâ”‚Â Â  â”œâ”€â”€ mapStateToProps.tsâ”‚Â Â  â”œâ”€â”€ mergeProps.tsâ”‚Â Â  â”œâ”€â”€ selectorFactory.tsâ”‚Â Â  â”œâ”€â”€ verifySubselectors.tsâ”‚Â Â  â””â”€â”€ wrapMapToProps.tsâ”œâ”€â”€ exports.tsâ”œâ”€â”€ hooksâ”‚Â Â  â”œâ”€â”€ useDispatch.tsâ”‚Â Â  â”œâ”€â”€ useReduxContext.tsâ”‚Â Â  â”œâ”€â”€ useSelector.tsâ”‚Â Â  â””â”€â”€ useStore.tsâ”œâ”€â”€ index.tsâ”œâ”€â”€ next.tsâ”œâ”€â”€ types.tsâ””â”€â”€ utils    â”œâ”€â”€ Subscription.ts    â”œâ”€â”€ batch.ts    â”œâ”€â”€ bindActionCreators.ts    â”œâ”€â”€ isPlainObject.ts    â”œâ”€â”€ reactBatchedUpdates.native.ts    â”œâ”€â”€ reactBatchedUpdates.ts    â”œâ”€â”€ shallowEqual.ts    â”œâ”€â”€ useIsomorphicLayoutEffect.native.ts    â”œâ”€â”€ useIsomorphicLayoutEffect.ts    â”œâ”€â”€ useSyncExternalStore.ts    â”œâ”€â”€ verifyPlainObject.ts    â””â”€â”€ warning.ts</code></pre><h2 id="packge-json"><a href="#packge-json" class="headerlink" title="packge.json"></a>packge.json</h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#x2F;&#x2F; packge.json&#123;  &quot;name&quot;: &quot;react-redux&quot;,  &quot;version&quot;: &quot;8.0.2&quot;,  &quot;description&quot;: &quot;Official React bindings for Redux&quot;,  &quot;keywords&quot;: [    &quot;react&quot;,    &quot;reactjs&quot;,    &quot;redux&quot;  ],  &quot;license&quot;: &quot;MIT&quot;,  &quot;author&quot;: &quot;Dan Abramov &lt;dan.abramov@me.com&gt; (https:&#x2F;&#x2F;github.com&#x2F;gaearon)&quot;,  &quot;homepage&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;reduxjs&#x2F;react-redux&quot;,  &quot;repository&quot;: &quot;github:reduxjs&#x2F;react-redux&quot;,  &quot;bugs&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;reduxjs&#x2F;react-redux&#x2F;issues&quot;,  &#x2F;&#x2F; æ‰¾æ‰¾å…¥å£ï¼Œå…¥å£æœ‰3ç§ï¼š  &quot;main&quot;: &quot;.&#x2F;lib&#x2F;index.js&quot;, &#x2F;&#x2F; å¸¸è§„æ“ä½œå…¥å£  &quot;types&quot;: &quot;.&#x2F;es&#x2F;index.d.ts&quot;, &#x2F;&#x2F; ç±»å‹å…¥å£  &quot;unpkg&quot;: &quot;dist&#x2F;react-redux.js&quot;, &#x2F;&#x2F; cdnå…¥å£  &quot;module&quot;: &quot;es&#x2F;index.js&quot;,&#x2F;&#x2F;esmå…¥å£  &#x2F;&#x2F; npmå‘å¸ƒä¸Šä¼ çš„æ–‡ä»¶  &quot;files&quot;: [    &quot;dist&quot;,    &quot;lib&quot;,    &quot;src&quot;, &#x2F;&#x2F; ä¸€èˆ¬ç”¨äºå¼€å‘é˜¶æ®µä»£ç è°ƒè¯•,soucemap    &quot;es&quot;  ],  &quot;scripts&quot;: &#123;    &#x2F;&#x2F; è„šæœ¬ä¸çœ‹äº†...  &#125;,  &#x2F;&#x2F; é…ç½®äº†ä¾èµ–é¡¹ï¼Œè¿™äº›ä¾èµ–é¡¹ä¸éœ€è¦åœ¨æœ¬åŒ…å®‰è£…ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£…å³å¯  &quot;peerDependencies&quot;: &#123;    &quot;@types&#x2F;react&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,    &quot;@types&#x2F;react-dom&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,    &quot;react&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,    &quot;react-dom&quot;: &quot;^16.8 || ^17.0 || ^18.0&quot;,    &quot;react-native&quot;: &quot;&gt;&#x3D;0.59&quot;,    &quot;redux&quot;: &quot;^4&quot;  &#125;,  &quot;peerDependenciesMeta&quot;: &#123;    &quot;@types&#x2F;react&quot;: &#123;      &quot;optional&quot;: true    &#125;,    &quot;@types&#x2F;react-dom&quot;: &#123;      &quot;optional&quot;: true    &#125;,    &quot;react-dom&quot;: &#123;      &quot;optional&quot;: true    &#125;,    &quot;react-native&quot;: &#123;      &quot;optional&quot;: true    &#125;,    &quot;redux&quot;: &#123;      &quot;optional&quot;: true    &#125;  &#125;,  &#x2F;&#x2F; å‘å¸ƒåï¼Œä¸šåŠ¡å¼€å‘è€…ä½¿ç”¨ï¼Œéœ€è¦å®‰è£…ï¼Œ&#x2F;&#x2F;è‡ªåŠ¨å®‰è£…  &quot;dependencies&quot;: &#123;    &quot;@babel&#x2F;runtime&quot;: &quot;^7.12.1&quot;,    &quot;@types&#x2F;hoist-non-react-statics&quot;: &quot;^3.3.1&quot;,    &quot;@types&#x2F;use-sync-external-store&quot;: &quot;^0.0.3&quot;,    &quot;hoist-non-react-statics&quot;: &quot;^3.3.2&quot;,    &quot;react-is&quot;: &quot;^18.0.0&quot;,    &quot;use-sync-external-store&quot;: &quot;^1.0.0&quot;  &#125;,  &#x2F;&#x2F; å¼€å‘é˜¶æ®µéœ€è¦ç”¨åˆ°çš„ï¼Œä¸€èˆ¬æ˜¯examplesä¸­demoä½¿ç”¨  &quot;devDependencies&quot;: &#123;    &#x2F;&#x2F;...  &#125;&#125;</code></pre><h2 id="exports-ts"><a href="#exports-ts" class="headerlink" title="exports.ts"></a>exports.ts</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export &#123;  Provider, &#x2F;&#x2F; import Provider from &#39;.&#x2F;components&#x2F;Provider&#39;  ReactReduxContext, &#x2F;&#x2F; import &#123; ReactReduxContext &#125; from &#39;.&#x2F;components&#x2F;Context&#39;  connect, &#x2F;&#x2F; import connect from &#39;.&#x2F;components&#x2F;connect&#39;  useDispatch, &#x2F;&#x2F; import &#123; useDispatch, createDispatchHook &#125; from &#39;.&#x2F;hooks&#x2F;useDispatch&#39;  createDispatchHook, &#x2F;&#x2F; import &#123; useDispatch, createDispatchHook &#125; from &#39;.&#x2F;hooks&#x2F;useDispatch&#39;  useSelector, &#x2F;&#x2F; import &#123; useSelector, createSelectorHook &#125; from &#39;.&#x2F;hooks&#x2F;useSelector&#39;  createSelectorHook, &#x2F;&#x2F; import &#123; useSelector, createSelectorHook &#125; from &#39;.&#x2F;hooks&#x2F;useSelector&#39;  useStore, &#x2F;&#x2F; import &#123; useStore, createStoreHook &#125; from &#39;.&#x2F;hooks&#x2F;useStore&#39;  createStoreHook, &#x2F;&#x2F; import &#123; useStore, createStoreHook &#125; from &#39;.&#x2F;hooks&#x2F;useStore&#39;  shallowEqual, &#x2F;&#x2F; import shallowEqual from &#39;.&#x2F;utils&#x2F;shallowEqual&#39;&#125;</code></pre><h2 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h2><p>å…ˆçœ‹ä¸‹ ï¼Œæœ€ç†Ÿæ‚‰çš„api</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; components&#x2F;Provider.tsx&#x2F;&#x2F; è¿™ä¸ªç»„ä»¶åšçš„äº‹æƒ…&#x2F;&#x2F; 1. åˆå¹¶æµè§ˆå™¨å’ŒæœåŠ¡å™¨çš„çŠ¶æ€&#x2F;&#x2F; 2. å¯¹äºåŒæ„çš„åº”ç”¨ï¼Œå¤„ç†subscriptionè®¢é˜…function Provider&lt;A extends Action &#x3D; AnyAction&gt;(&#123;  store,  context,  children,  serverState,&#125;: ProviderProps&lt;A&gt;) &#123;  &#x2F;&#x2F; 1.useMemoï¼Œå¯¹å…¥å‚è¿›è¡Œæ ¼å¼åŒ–ã€Œå¤„ç†äº†storeå’Œ æœåŠ¡ç«¯çš„ serverStateã€  const contextValue &#x3D; useMemo(() &#x3D;&gt; &#123;    const subscription &#x3D; createSubscription(store)    return &#123;      store,      subscription,      getServerState: serverState ? () &#x3D;&gt; serverState : undefined,    &#125;  &#125;, [store, serverState])  &#x2F;&#x2F; 2.ä¹‹å‰çš„stateçŠ¶æ€ä»storeä¸­ç›´æ¥è·å–  const previousState &#x3D; useMemo(() &#x3D;&gt; store.getState(), [store])  &#x2F;&#x2F; 3.åŒæ„ç›¸å…³ï¼Œè·³è¿‡  useIsomorphicLayoutEffect(() &#x3D;&gt; &#123;    const &#123; subscription &#125; &#x3D; contextValue    subscription.onStateChange &#x3D; subscription.notifyNestedSubs    subscription.trySubscribe()    if (previousState !&#x3D;&#x3D; store.getState()) &#123;      subscription.notifyNestedSubs()    &#125;    return () &#x3D;&gt; &#123;      subscription.tryUnsubscribe()      subscription.onStateChange &#x3D; undefined    &#125;  &#125;, [contextValue, previousState])  &#x2F;&#x2F; 4.react-reduxä¸Šä¸‹æ–‡  const Context &#x3D; context || ReactReduxContext  &#x2F;&#x2F; @ts-ignore &#39;AnyAction&#39; is assignable to the constraint of type &#39;A&#39;, but &#39;A&#39; could be instantiated with a different subtype  return &lt;Context.Provider value&#x3D;&#123;contextValue&#125;&gt;&#123;children&#125;&lt;&#x2F;Context.Provider&gt; &#x2F;&#x2F; è¿™è¡Œä»£ç æ˜¯ä¸æ˜¯éå¸¸ç†Ÿæ‚‰äº†&#125;export default Provider</code></pre><h2 id="ReactReduxContext"><a href="#ReactReduxContext" class="headerlink" title="ReactReduxContext"></a>ReactReduxContext</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; .&#x2F;components&#x2F;Context.tsx&#x2F;&#x2F; è¿™ä¸ªç»„ä»¶åšçš„äº‹æƒ…&#x2F;&#x2F; 1.åˆ›å»ºä¸ªcreateContext&#x2F;&#x2F; 2.ç»™ä¸ªåå­—displayName&#x2F;&#x2F; ...ç±»å‹ä»£ç ä¸å…³æ³¨export const ReactReduxContext &#x3D;&#x2F;*#__PURE__*&#x2F; React.createContext&lt;ReactReduxContextValue&gt;(null as any)&#x2F;&#x2F; ...ç±»å‹ä»£ç ä¸å…³æ³¨if (process.env.NODE_ENV !&#x3D;&#x3D; &#39;production&#39;) &#123;  ReactReduxContext.displayName &#x3D; &#39;ReactRedux&#39;&#125;export default ReactReduxContext</code></pre><h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; .&#x2F;components&#x2F;connect.tsx&#x2F;&#x2F; è¿™ä¸ªæ–‡ä»¶æ¯”è¾ƒé•¿ï¼Œå…ˆä¸çœ‹&#x2F;&#x2F; hoist-non-react-staticsè¿™ä¸ªä¾èµ–å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨æ‹·è´éReactçš„é™æ€æ–¹æ³•</code></pre><h2 id="useDispatchã€createDispatchHook"><a href="#useDispatchã€createDispatchHook" class="headerlink" title="useDispatchã€createDispatchHook"></a>useDispatchã€createDispatchHook</h2><p>æŠŠtsç±»å‹åˆ åˆ ï¼Œçœ‹ä¸Šå»æ›´ç®€å•äº†</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; .&#x2F;hooks&#x2F;useDispatch&#x2F;&#x2F; ç”¨createDispatchHooké’©å­å·¥å‚åˆ›å»ºäº†ä¸ªé’©å­useDispatchexport function createDispatchHook(context) &#123;  &#x2F;&#x2F; TODO: createStoreHookä¸‹é¢å†çœ‹ï¼Œå…ˆè·³è¿‡  const useStore &#x3D; context &#x3D;&#x3D;&#x3D; ReactReduxContext ? useDefaultStore : createStoreHook(context)  return function useDispatch() &#123;    const store &#x3D; useStore()    &#x2F;&#x2F; @ts-ignore    return store.dispatch  &#125;&#125;&#x2F;** * A hook to access the redux &#96;dispatch&#96; function. * * @returns &#123;any|function&#125; redux store&#39;s &#96;dispatch&#96; function * * @example * * import React, &#123; useCallback &#125; from &#39;react&#39; * import &#123; useDispatch &#125; from &#39;react-redux&#39; * * export const CounterComponent &#x3D; (&#123; value &#125;) &#x3D;&gt; &#123; *   const dispatch &#x3D; useDispatch() *   const increaseCounter &#x3D; useCallback(() &#x3D;&gt; dispatch(&#123; type: &#39;increase-counter&#39; &#125;), []) *   return ( *     &lt;div&gt; *       &lt;span&gt;&#123;value&#125;&lt;&#x2F;span&gt; *       &lt;button onClick&#x3D;&#123;increaseCounter&#125;&gt;Increase counter&lt;&#x2F;button&gt; *     &lt;&#x2F;div&gt; *   ) * &#125; *&#x2F;export const useDispatch &#x3D; &#x2F;*#__PURE__*&#x2F; createDispatchHook()</code></pre><h2 id="useSelectorã€createSelectorHook"><a href="#useSelectorã€createSelectorHook" class="headerlink" title="useSelectorã€createSelectorHook"></a>useSelectorã€createSelectorHook</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; .&#x2F;hooks&#x2F;useSelector&#x2F;&#x2F; ç”¨ createSelectorHook é’©å­å·¥å‚åˆ›å»ºäº†ä¸ªé’©å­ useSelectorlet useSyncExternalStoreWithSelector &#x3D; notInitialized as uSESWSexport const initializeUseSelector &#x3D; (fn: uSESWS) &#x3D;&gt; &#123;  useSyncExternalStoreWithSelector &#x3D; fn&#125;const refEquality: EqualityFn&lt;any&gt; &#x3D; (a, b) &#x3D;&gt; a &#x3D;&#x3D;&#x3D; b&#x2F;&#x2F; ä¸‹é¢çš„ä»£ç ä¿ç•™èŒƒå‹ï¼ŒSelectedexport function createSelectorHook(  context &#x3D; ReactReduxContext): &lt;TState &#x3D; unknown, Selected &#x3D; unknown&gt;(  selector: (state: TState) &#x3D;&gt; Selected,  equalityFn?: EqualityFn&lt;Selected&gt;) &#x3D;&gt; Selected &#123;  const useReduxContext &#x3D;    context &#x3D;&#x3D;&#x3D; ReactReduxContext      ? useDefaultReduxContext      : () &#x3D;&gt; useContext(context)  return function useSelector(    selector,    equalityFn &#x3D; refEquality  ) &#123;    const &#123; store, subscription, getServerState &#125; &#x3D; useReduxContext()!    const selectedState &#x3D; useSyncExternalStoreWithSelector(      subscription.addNestedSub,      store.getState,      getServerState || store.getState,      selector,      equalityFn    )    useDebugValue(selectedState) &#x2F;&#x2F; æ ‡è®°    return selectedState  &#125;&#125;&#x2F;** * A hook to access the redux store&#39;s state. This hook takes a selector function * as an argument. The selector is called with the store state. * * This hook takes an optional equality comparison function as the second parameter * that allows you to customize the way the selected state is compared to determine * whether the component needs to be re-rendered. * * @param &#123;Function&#125; selector the selector function * @param &#123;Function&#x3D;&#125; equalityFn the function that will be used to determine equality * * @returns &#123;any&#125; the selected state * * @example * * import React from &#39;react&#39; * import &#123; useSelector &#125; from &#39;react-redux&#39; * * export const CounterComponent &#x3D; () &#x3D;&gt; &#123; *   const counter &#x3D; useSelector(state &#x3D;&gt; state.counter) *   return &lt;div&gt;&#123;counter&#125;&lt;&#x2F;div&gt; * &#125; *&#x2F;export const useSelector &#x3D; &#x2F;*#__PURE__*&#x2F; createSelectorHook()</code></pre><h2 id="useStoreã€createStoreHook"><a href="#useStoreã€createStoreHook" class="headerlink" title="useStoreã€createStoreHook"></a>useStoreã€createStoreHook</h2><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; 1.ç”¨é’©å­å·¥å‚åˆ›å»ºäº†ä¸ªé’©å­&#x2F;&#x2F; 2.ä»   const &#123; store &#125; &#x3D; useReduxContext()! è·å–store&#x2F;** * Hook factory, which creates a &#96;useStore&#96; hook bound to a given context. * * @param &#123;React.Context&#125; [context&#x3D;ReactReduxContext] Context passed to your &#96;&lt;Provider&gt;&#96;. * @returns &#123;Function&#125; A &#96;useStore&#96; hook bound to the specified context. *&#x2F;export function createStoreHook&lt;  S &#x3D; unknown,  A extends BasicAction &#x3D; AnyAction  &#x2F;&#x2F; @ts-ignore&gt;(context?: Context&lt;ReactReduxContextValue&lt;S, A&gt;&gt; &#x3D; ReactReduxContext) &#123;  const useReduxContext &#x3D;    &#x2F;&#x2F; @ts-ignore    context &#x3D;&#x3D;&#x3D; ReactReduxContext      ? useDefaultReduxContext      : () &#x3D;&gt; useContext(context)  return function useStore&lt;    State &#x3D; S,    Action extends BasicAction &#x3D; A    &#x2F;&#x2F; @ts-ignore  &gt;() &#123;    const &#123; store &#125; &#x3D; useReduxContext()!    &#x2F;&#x2F; @ts-ignore    return store as Store&lt;State, Action&gt;  &#125;&#125;&#x2F;** * A hook to access the redux store. * * @returns &#123;any&#125; the redux store * * @example * * import React from &#39;react&#39; * import &#123; useStore &#125; from &#39;react-redux&#39; * * export const ExampleComponent &#x3D; () &#x3D;&gt; &#123; *   const store &#x3D; useStore() *   return &lt;div&gt;&#123;store.getState()&#125;&lt;&#x2F;div&gt; * &#125; *&#x2F;export const useStore &#x3D; &#x2F;*#__PURE__*&#x2F; createStoreHook()</code></pre><h2 id="connect-1"><a href="#connect-1" class="headerlink" title="connect"></a>connect</h2><p> è§ï¼šreact-redux æºç 2</p>]]></content>
      
      
      <categories>
          
          <category> react </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-redux </tag>
            
            <tag> redux </tag>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flex width:0</title>
      <link href="//post/2022-05-23width0.html"/>
      <url>//post/2022-05-23width0.html</url>
      
        <content type="html"><![CDATA[<h2 id="flexåµŒå¥—"><a href="#flexåµŒå¥—" class="headerlink" title="flexåµŒå¥—"></a>flexåµŒå¥—</h2><p>å†…éƒ¨å…ƒç´ å®½åº¦é»˜è®¤100%ï¼Œæ’‘å¼€çˆ¶å…ƒç´ ï¼Œçˆ¶å…ƒç´ çš„æ ¹å…ƒç´ é™åˆ¶æœ€å¤§å®½åº¦ï¼Œå­å…ƒç´ å¹¶ä¸å—flexæ§åˆ¶</p><p>é‡åˆ°å¤šæ¬¡äº†ï¼Œè¿™æ¬¡æ˜¯ç»´æŠ¤å…¶ä»–åŒäº‹çš„ä»£ç ï¼Œåˆæ’è§äº†ï¼Œè¯´æ˜è¿™ä¸ªé—®é¢˜å¾ˆå¸¸è§ï¼Œä¸€ä¸ªä¸ç•™ç¥ï¼Œå°±è¸©åˆ°äº†</p><pre class="line-numbers language-none"><code class="language-none">æ ¹å…ƒç´   â€¦â€¦  - çˆ¶å…ƒç´ flex  â€¦â€¦ flex   - å­å…ƒç´ flex(é»˜è®¤å®½åº¦100%)</code></pre><pre class="line-numbers language-css" data-language="css"><code class="language-css">.doc-tree-base-title-node .doc-tree-base-title-text &gt; a &#123;    display: flex;    align-items: center;    color: #777;    white-space: nowrap;    overflow: hidden;    text-overflow: ellipsis;    flex: 1;&#125;</code></pre><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p><img src="http://t-blog-images.aijs.top/img/20220523171556.webp"></p><p> è§‚å¯Ÿä¸‹å‘ç°ï¼Œflexæ˜¯åµŒå¥—çš„ï¼Œæœ€å¤–å±‚çš„è¿˜æ˜¯flexï¼Œä¸€å±‚ä¸€å±‚ï¼Œæœ€å¤–å±‚çš„å®½åº¦ï¼Œå´æ˜¯ç”±æœ€å†…å±‚çš„å®½åº¦å†³å®šï¼ˆè¿™ä¸ªè°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼‰</p><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><ul><li>å›¾1</li></ul><p> <img src="http://t-blog-images.aijs.top/img/20220523171802.webp"></p><ul><li>å›¾2</li></ul><p> <img src="http://t-blog-images.aijs.top/img/20220523171918.webp"></p><ul><li>å›¾3</li></ul><p> <img src="http://t-blog-images.aijs.top/img/20220523172024.webp"></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p> å›¾1 å…ƒç´ æ²¡æœ‰å®½åº¦ï¼Œå®½åº¦é»˜è®¤æ˜¯<code>100%</code></p><p> å›¾1åˆ°å›¾3æ˜¯ç”±aæ ‡ç­¾å­å…ƒç´ æ’‘å¼€çš„ï¼Œå®½åº¦æ˜¯<code>100%</code>,åŠ ä¸Šæ“ä½œæŒ‰é’®ï¼Œå…ƒç´ å®½åº¦è¶…100%</p><p> è€Œåœ¨ä¾§è¾¹æ ‘ç»“æ„çš„æœ€å¤–å±‚è®¾ç½®äº†<code>max-width: 500px</code>,è€Œå†…éƒ¨å­å…ƒç´ å°ºå¯¸å´æ˜¯<code>599.48 x 36</code></p><p> æ˜¾ç„¶æ˜¯ä¸åˆç†çš„</p><h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2> <pre class="line-numbers language-none"><code class="language-none">æ ¹å…ƒç´   â€¦â€¦  - çˆ¶å…ƒç´ flex  â€¦â€¦ flex   - å­å…ƒç´ flex(é»˜è®¤å®½åº¦è®¾ç½®å®½åº¦0 æˆ–è€…å…¶ä»–å°ç‚¹çš„å®½åº¦ï¼Œè¶Šå°è¶Šå¥½)</code></pre><p> <img src="http://t-blog-images.aijs.top/img/20220523173256.webp"></p><h2 id="ä»€ä¹ˆåŸå› å¯¼è‡´çš„"><a href="#ä»€ä¹ˆåŸå› å¯¼è‡´çš„" class="headerlink" title="ä»€ä¹ˆåŸå› å¯¼è‡´çš„"></a>ä»€ä¹ˆåŸå› å¯¼è‡´çš„</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex">MDN flex</a></p><p>è¯­æ³•</p><pre class="line-numbers language-CSS" data-language="CSS"><code class="language-CSS">&#x2F;* å…³é”®å­—å€¼ *&#x2F;flex: auto;flex: initial;flex: none;&#x2F;* ä¸€ä¸ªå€¼, æ— å•ä½æ•°å­—: flex-grow *&#x2F;flex: 2;&#x2F;* ä¸€ä¸ªå€¼, width&#x2F;height: flex-basis *&#x2F;flex: 10em;flex: 30px;flex: min-content;&#x2F;* ä¸¤ä¸ªå€¼: flex-grow | flex-basis *&#x2F;flex: 1 30px;&#x2F;* ä¸¤ä¸ªå€¼: flex-grow | flex-shrink *&#x2F;flex: 2 2;&#x2F;* ä¸‰ä¸ªå€¼: flex-grow | flex-shrink | flex-basis *&#x2F;flex: 2 2 10%;&#x2F;*å…¨å±€å±æ€§å€¼ *&#x2F;flex: inherit;flex: initial;flex: unset;</code></pre><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªï¼Œä¸¤ä¸ªæˆ–ä¸‰ä¸ªå€¼æ¥æŒ‡å®š flexå±æ€§ã€‚</p><p>1.<strong>å•å€¼è¯­æ³•</strong>: å€¼å¿…é¡»ä¸ºä»¥ä¸‹å…¶ä¸­ä¹‹ä¸€:</p><ul><li>ä¸€ä¸ªæ— å•ä½æ•°(<code>&lt;number&gt;</code>): å®ƒä¼šè¢«å½“ä½œflex:<code>&lt;number&gt;</code> 1 0; è§£é‡Šï¼š<code>&lt;flex-shrink&gt;</code>çš„å€¼è¢«å‡å®šä¸º1ï¼Œç„¶å<code>&lt;flex-basis&gt;</code> çš„å€¼è¢«å‡å®šä¸º0ã€‚</li><li>ä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦(width)å€¼: å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-basis&gt;</code>çš„å€¼ã€‚</li><li>å…³é”®å­—noneï¼Œautoæˆ–initial.</li></ul><p>2.<strong>åŒå€¼è¯­æ³•</strong>: ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-grow&gt;</code> çš„å€¼ã€‚ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä»¥ä¸‹ä¹‹ä¸€ï¼š</p><ul><li>ä¸€ä¸ªæ— å•ä½æ•°ï¼šå®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-shrink&gt;</code> çš„å€¼ã€‚</li><li>ä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼: å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-basis&gt;</code> çš„å€¼ã€‚</li></ul><p>3.<strong>ä¸‰å€¼è¯­æ³•</strong>:</p><ul><li>ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-grow&gt;</code> çš„å€¼ã€‚</li><li>ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ  <code>&lt;flex-shrink&gt;</code> çš„å€¼ã€‚</li><li>ç¬¬ä¸‰ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼ï¼Œ å¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <code>&lt;flex-basis&gt;</code> çš„å€¼ã€‚</li></ul><p> å¯ä»¥çœ‹åˆ°å•å€¼ï¼Œä½œä¸ºåŒå€¼å¤„ç†</p> <pre class="line-numbers language-css" data-language="css"><code class="language-css">flex-shrink:1;flex-basis: 0;</code></pre><h2 id="flex-basis"><a href="#flex-basis" class="headerlink" title="flex-basis"></a>flex-basis</h2><p> è‡ªæ¥çœ‹ä¸‹<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex-basis">flex-base</a></p><p> æŸ¥çœ‹æ–‡æ¡£åå‘ç°ï¼Œæ–‡æ¡£ä¸Šæ²¡è¯´å…³äº<code>flex-basic: 0 </code>çš„äº‹æƒ…,ç»™äº†ä¸ªæ¼”ç¤ºï¼Œä¹Ÿçœ‹ä¸å‡ºæ¥æƒ³è¡¨è¾¾ä»€ä¹ˆ</p><p><a href="https://blog.csdn.net/u010951953/article/details/124145786">flex-basis å±æ€§çš„å«ä¹‰</a><br><a href="https://www.w3.org/TR/2018/CR-css-flexbox-1-20181119/#flex-basis-property">w3c flex-basis-property</a><br>flexå¸ƒå±€ä¸€èˆ¬ç”±flexå®¹å™¨ï¼ˆdisplay å±æ€§å€¼ä¸º flex æˆ– inline-flexï¼‰å’Œå…¶å­å…ƒç´ ï¼ˆåæ–‡äº¦ç§°flexå­é¡¹æˆ–flex itemï¼‰æ„æˆã€‚flex-basis å±æ€§ä¸€èˆ¬ä½œç”¨åœ¨flexå­é¡¹ä¸Šï¼Œå®ƒå®šä¹‰äº†ï¼šåœ¨flexå®¹å™¨åˆ†é…å‰©ä½™ç©ºé—´å‰flexå­é¡¹åœ¨ä¸»è½´æ–¹å‘ä¸Šçš„åˆå§‹å°ºå¯¸ã€‚flexå­é¡¹åœ¨ä¸»è½´æ–¹å‘ä¸Šçš„å®é™…å°ºå¯¸æ˜¯æ ¹æ®å…ƒç´ è‡ªèº«å°ºå¯¸ã€flex-basisã€flex-growã€flex-shrink ç­‰å±æ€§å…±åŒå†³å®šçš„ã€‚å¦‚ä½•è®¡ç®—å®é™…å°ºå¯¸ä¸æ˜¯æœ¬æ–‡é‡ç‚¹ï¼Œä¸ç»§ç»­å±•å¼€ã€‚</p><h2 id="flex-basis-0pxä¸0"><a href="#flex-basis-0pxä¸0" class="headerlink" title="flex-basis:0pxä¸0%"></a>flex-basis:0pxä¸0%</h2><ul><li>å¦‚æœ flex-basis çš„å€¼ä¸ºç™¾åˆ†æ•°ï¼Œä¸”å®ƒflexå®¹å™¨çš„å°ºå¯¸æ²¡æœ‰è¢«æ˜¾å¼è®¾ç½®ï¼Œæ­¤æ—¶ flex-basis çš„å€¼ä¼šè¢«è§£æä¸º content</li></ul><h2 id="å…¶ä»–ï¼Œå€¼å¾—ä¸€çœ‹"><a href="#å…¶ä»–ï¼Œå€¼å¾—ä¸€çœ‹" class="headerlink" title="å…¶ä»–ï¼Œå€¼å¾—ä¸€çœ‹"></a>å…¶ä»–ï¼Œå€¼å¾—ä¸€çœ‹</h2><h2 id="flex-1"><a href="#flex-1" class="headerlink" title="flex: 1"></a>flex: 1</h2><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œflex: 1 çš„ flex-basis å€¼ä¸ºä»€ä¹ˆä¸æ˜¯W3Cæ–‡æ¡£ä¸­æåˆ°çš„ 0 ï¼Ÿ</p><p>å½“ä½¿ç”¨ flex å±æ€§ä½†åˆçœç•¥ä¸å†™å®ƒå…¶ä¸­çš„ flex-basis å€¼æ—¶ï¼Œä¼šå°† flex-basis è®¾ç½®ä¸º 0.</p><p>è¿™é‡Œçš„ 0 å•ä½æ˜¯ px è¿˜æ˜¯ % æˆ‘ä»¬åœ¨Chromeæµè§ˆå™¨é‡Œå°±èƒ½éªŒè¯ï¼š</p><img src="http://t-blog-images.aijs.top/img/20220523181618.webp" width=400  style="object-fit: content"/><p>ç­”æ¡ˆæ˜¯ px.</p><p>è¿™æ®µæ˜¯2015å¹´ä¿®æ­£æ—¥å¿—é‡Œçš„ï¼Œæ„æ€æ˜¯å°†ä¹‹å‰ flex ç®€å†™è¯­æ³•é‡Œçš„ flex-basis çš„è§£æå€¼ä» 0% æ¢å¤ä¸ºåŸæ¥çš„ 0.</p><p>æ³¨æ„ï¼š è¿™ä¸ªå€¼çš„è§£æè§„åˆ™ç»å†äº† 0px -&gt; 0% -&gt; 0px çš„å˜åŒ–ï¼Œè¿™æ˜¯W3C flex æ ‡å‡†æ–‡æ¡£çš„è§†è§’ã€‚</p><p>ç®€è€Œè¨€ä¹‹å°±æ˜¯æœ‰å…¼å®¹æ€§é—®é¢˜ã€‚ç°åœ¨å·²æœ‰å¾ˆå¤šç½‘é¡µéƒ½åˆ©ç”¨äº† flex å±æ€§çš„è¿™ä¸ªç‰¹æ€§æ¥å¼€å‘ã€‚å¦‚æœç®€å†™è¯­æ³•é‡Œ flex-basis çš„è§£æä» 0% å˜ä¸º 0px ä¼šå¯¼è‡´éƒ¨åˆ†æƒ…å†µä¸‹flexå®¹å™¨å¡Œé™·ï¼Œè‡´ä½¿å¾ˆå¤šç½‘é¡µå¼‚å¸¸</p><p><a href="https://blog.csdn.net/u010951953/article/details/124145786">å»ºè®®çœ‹åŸæ–‡</a></p>]]></content>
      
      
      <categories>
          
          <category> css3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bug </tag>
            
            <tag> css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-CSSå¦‚ä½•å·¥ä½œ</title>
      <link href="//post/2022-05-23css.html"/>
      <url>//post/2022-05-23css.html</url>
      
        <content type="html"><![CDATA[<h2 id="æµè§ˆå™¨å·¥ä½œåŸç†"><a href="#æµè§ˆå™¨å·¥ä½œåŸç†" class="headerlink" title="æµè§ˆå™¨å·¥ä½œåŸç†"></a>æµè§ˆå™¨å·¥ä½œåŸç†</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å½“æµè§ˆå™¨å±•ç¤ºä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå®ƒå¿…é¡»å…¼é¡¾æ–‡ä»¶çš„å†…å®¹å’Œæ–‡ä»¶çš„æ ·å¼ä¿¡æ¯</p></blockquote><h2 id="å¦‚ä½•åŠ è½½CSSå’ŒHTML"><a href="#å¦‚ä½•åŠ è½½CSSå’ŒHTML" class="headerlink" title="å¦‚ä½•åŠ è½½CSSå’ŒHTML"></a>å¦‚ä½•åŠ è½½CSSå’ŒHTML</h2><p>ä¸‹é¢çš„æ­¥éª¤æ˜¯æµè§ˆåŠ è½½ç½‘é¡µçš„ç®€åŒ–ç‰ˆæœ¬:</p><ol><li>æµè§ˆå™¨è½½å…¥HTMLæ–‡ä»¶ï¼ˆæ¯”å¦‚ä»ç½‘ç»œä¸Šè·å–ï¼‰ã€‚</li><li>å°†HTMLæ–‡ä»¶è½¬åŒ–æˆä¸€ä¸ªDOMï¼ˆDocument Object Modelï¼‰ï¼ŒDOMæ˜¯æ–‡ä»¶åœ¨è®¡ç®—æœºå†…å­˜ä¸­çš„è¡¨ç°å½¢å¼ï¼Œä¸‹ä¸€èŠ‚å°†æ›´åŠ è¯¦ç»†çš„è§£é‡ŠDOMã€‚</li><li>æ¥ä¸‹æ¥ï¼Œæµè§ˆå™¨ä¼šæ‹‰å–è¯¥HTMLç›¸å…³çš„å¤§éƒ¨åˆ†èµ„æºï¼Œæ¯”å¦‚åµŒå…¥åˆ°é¡µé¢çš„å›¾ç‰‡ã€è§†é¢‘å’ŒCSSæ ·å¼ã€‚JavaScriptåˆ™ä¼šç¨åè¿›è¡Œå¤„ç†ï¼Œç®€å•èµ·è§ï¼ŒåŒæ—¶æ­¤èŠ‚ä¸»è®²CSSï¼Œæ‰€ä»¥è¿™é‡Œå¯¹å¦‚ä½•åŠ è½½JavaScriptä¸ä¼šå±•å¼€å™è¿°ã€‚</li><li>æµè§ˆå™¨æ‹‰å–åˆ°CSSä¹‹åä¼šè¿›è¡Œè§£æï¼Œæ ¹æ®é€‰æ‹©å™¨çš„ä¸åŒç±»å‹ï¼ˆæ¯”å¦‚elementã€classã€idç­‰ç­‰ï¼‰æŠŠä»–ä»¬åˆ†åˆ°ä¸åŒçš„â€œæ¡¶â€ä¸­ã€‚æµè§ˆå™¨åŸºäºå®ƒæ‰¾åˆ°çš„ä¸åŒçš„é€‰æ‹©å™¨ï¼Œå°†ä¸åŒçš„è§„åˆ™ï¼ˆåŸºäºé€‰æ‹©å™¨çš„è§„åˆ™ï¼Œå¦‚å…ƒç´ é€‰æ‹©å™¨ã€ç±»é€‰æ‹©å™¨ã€idé€‰æ‹©å™¨ç­‰ï¼‰åº”ç”¨åœ¨å¯¹åº”çš„DOMçš„èŠ‚ç‚¹ä¸­ï¼Œå¹¶æ·»åŠ èŠ‚ç‚¹ä¾èµ–çš„æ ·å¼ï¼ˆè¿™ä¸ªä¸­é—´æ­¥éª¤ç§°ä¸ºæ¸²æŸ“æ ‘ï¼‰ã€‚</li><li>ä¸Šè¿°çš„è§„åˆ™åº”ç”¨äºæ¸²æŸ“æ ‘ä¹‹åï¼Œæ¸²æŸ“æ ‘ä¼šä¾ç…§åº”è¯¥å‡ºç°çš„ç»“æ„è¿›è¡Œå¸ƒå±€ã€‚</li><li>ç½‘é¡µå±•ç¤ºåœ¨å±å¹•ä¸Šï¼ˆè¿™ä¸€æ­¥è¢«ç§°ä¸ºç€è‰²ï¼‰ã€‚</li></ol><p><strong>è¿è¡Œå›¾</strong></p><img src="http://t-blog-images.aijs.top/img/rendering.svg" width=400 style="object-fit:content; background: #fff"/><hr/><h2 id="æ— æ³•è§£æçš„CSSä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#æ— æ³•è§£æçš„CSSä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="æ— æ³•è§£æçš„CSSä¼šå‘ç”Ÿä»€ä¹ˆ"></a>æ— æ³•è§£æçš„CSSä¼šå‘ç”Ÿä»€ä¹ˆ</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ç­”æ¡ˆå°±æ˜¯æµè§ˆå™¨ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œç»§ç»­è§£æä¸‹ä¸€ä¸ªCSSæ ·å¼ï¼</p></blockquote><p>ä»¥ä¸‹æ˜¯åºŸè¯ï¼š</p><ul><li><p>æµè§ˆå™¨å¹¶ä¸ä¼šåŒæ—¶å®ç°æ‰€æœ‰çš„æ–°CSSï¼Œæ­¤å¤–å¾ˆå¤šäººä¹Ÿä¸ä¼šä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ã€‚é‰´äºCSSä¸€ç›´ä¸æ–­çš„å¼€å‘ï¼Œå› æ­¤é¢†å…ˆäºæµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„èŒƒå›´ï¼Œé‚£ä¹ˆä½ ä¹Ÿè®¸ä¼šå¥½å¥‡å½“æµè§ˆå™¨é‡åˆ°æ— æ³•è§£æçš„CSSé€‰æ‹©å™¨æˆ–å£°æ˜çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p></li><li><p>CSSè§„åˆ™ï¼š å¦‚æœä¸€ä¸ªæµè§ˆå™¨åœ¨è§£æä½ æ‰€ä¹¦å†™çš„CSSè§„åˆ™çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†æ— æ³•ç†è§£çš„å±æ€§æˆ–è€…å€¼ï¼Œå®ƒä¼šå¿½ç•¥è¿™äº›å¹¶ç»§ç»­è§£æä¸‹é¢çš„CSSå£°æ˜ã€‚åœ¨ä½ ä¹¦å†™äº†é”™è¯¯çš„CSSä»£ç ï¼ˆæˆ–è€…è¯¯æ‹¼å†™ï¼‰ï¼Œåˆæˆ–è€…å½“æµè§ˆå™¨é‡åˆ°å¯¹äºå®ƒæ¥è¯´å¾ˆæ–°çš„è¿˜æ²¡æœ‰æ”¯æŒçš„CSSä»£ç çš„æ—¶å€™ä¸Šè¿°çš„æƒ…å†µåŒæ ·ä¼šå‘ç”Ÿï¼ˆç›´æ¥å¿½ç•¥ï¼‰ã€‚</p></li><li><p>é€‰æ‹©å™¨ï¼š ç›¸ä¼¼çš„ï¼Œå½“æµè§ˆå™¨é‡åˆ°æ— æ³•è§£æçš„é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œä»–ä¼š<code>ç›´æ¥å¿½ç•¥æ•´ä¸ªé€‰æ‹©å™¨è§„åˆ™</code>ï¼Œç„¶åè§£æä¸‹ä¸€ä¸ªCSSé€‰æ‹©å™¨ã€‚</p></li></ul><hr/><h2 id="å…³äºDOM"><a href="#å…³äºDOM" class="headerlink" title="å…³äºDOM"></a>å…³äºDOM</h2><p>ä¸€ä¸ªDOMæœ‰ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œæ ‡è®°è¯­è¨€ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ã€å±æ€§ä»¥åŠæ¯ä¸€æ®µæ–‡å­—éƒ½å¯¹åº”ç€ç»“æ„æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆNode&#x2F;DOMæˆ–DOM nodeï¼‰ã€‚èŠ‚ç‚¹ç”±èŠ‚ç‚¹æœ¬èº«å’Œå…¶ä»–DOMèŠ‚ç‚¹çš„å…³ç³»å®šä¹‰ï¼Œæœ‰äº›èŠ‚ç‚¹æœ‰çˆ¶èŠ‚ç‚¹ï¼Œæœ‰äº›èŠ‚ç‚¹æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼ˆåŒçº§èŠ‚ç‚¹ï¼‰ã€‚</p><p>å¯¹äºDOMçš„ç†è§£ä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå¸®åŠ©ä½ è®¾è®¡ã€è°ƒè¯•å’Œç»´æŠ¤ä½ çš„CSSï¼Œå› ä¸ºDOMæ˜¯ä½ çš„CSSæ ·å¼å’Œæ–‡ä»¶å†…å®¹çš„ç»“åˆã€‚å½“ä½ ä½¿ç”¨æµè§ˆå™¨F12è°ƒè¯•çš„æ—¶å€™ä½ éœ€è¦æ“ä½œDOMä»¥æŸ¥çœ‹ä½¿ç”¨äº†å“ªäº›è§„åˆ™ã€‚</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;p&gt;  Let&#39;s use:  &lt;span&gt;Cascading&lt;&#x2F;span&gt;  &lt;span&gt;Style&lt;&#x2F;span&gt;  &lt;span&gt;Sheets&lt;&#x2F;span&gt;&lt;&#x2F;p&gt;</code></pre><pre class="line-numbers language-none"><code class="language-none">Pâ”œâ”€ &quot;Let&#39;s use:&quot;â”œâ”€ SPAN|  â””â”€ &quot;Cascading&quot;â”œâ”€ SPAN|  â””â”€ &quot;Style&quot;â””â”€ SPAN   â””â”€ &quot;Sheets&quot;</code></pre><hr/><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Learn/CSS/First_steps/How_CSS_works">MDN</a></p>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> æµè§ˆå™¨åŸç† </tag>
            
            <tag> åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>monorepo</title>
      <link href="//post/2022-05-23monorepo.html"/>
      <url>//post/2022-05-23monorepo.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul><li>è°ƒè¯•æºç æ—¶å€™ï¼Œæ€»ä¼šé‡åˆ°å¤šåŒ…çš„ä»“åº“ï¼Œé‡åˆ°äº†ä¸æ™“å¾—å¦‚ä½•è°ƒè¯•</li><li>å¼€å‘ä¸ªåº“æˆ–è€…æ˜¯æ’ä»¶ä¹‹ç±»çš„å¼€å‘çš„æ¯”è¾ƒæ··ä¹±</li><li>ç»å†å¤šä¸ªé¡¹ç›®çš„æ¯’æ‰“ï¼Œç»ˆäºæœ‰æ—¶é—´å­¦ä¸‹<code>monorepo</code></li></ul><h2 id="lernaã€yarn-workspace"><a href="#lernaã€yarn-workspace" class="headerlink" title="lernaã€yarn workspace"></a>lernaã€yarn workspace</h2><ul><li>å’Œjavaå¾®æœåŠ¡æ¶æ„ä»£ç å¾ˆåƒ</li><li>å¾ˆå¤šé¡¹ç›®æ˜¯ lerna+yarn workspaceï¼Œå¦‚æœä¸æ‡‚ï¼Œæˆ–è€…äº†è§£äº†ä¸€ç‚¹<code>lerna</code>ã€‚ä¸Šå»ä¸€é¡¿æ“ä½œï¼Œå„ç§æŠ¥é”™ï¼Œåœ¨æ‰€éš¾å…ï¼ˆäº²èº«ç»å†ï¼‰</li></ul><h2 id="monorepoç®¡ç†"><a href="#monorepoç®¡ç†" class="headerlink" title="monorepoç®¡ç†"></a>monorepoç®¡ç†</h2><p>å¯¹äºç»´æŠ¤è¿‡å¤šä¸ªpackage(åŠŸèƒ½ç›¸è¿‘)çš„åŒå­¦æ¥è¯´ï¼Œéƒ½ä¼šé‡åˆ°ä¸€ä¸ªé€‰æ‹©é¢˜ï¼Œè¿™äº›packageæ˜¯æ”¾åœ¨ä¸€ä¸ªä»“åº“é‡Œç»´æŠ¤è¿˜æ˜¯æ”¾åœ¨å¤šä¸ªä»“åº“é‡Œå•ç‹¬ç»´æŠ¤ã€‚Multirepo æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„åšæ³•ï¼Œå³æ¯ä¸€ä¸ª package éƒ½å•ç‹¬ç”¨ä¸€ä¸ªä»“åº“æ¥è¿›è¡Œç®¡ç†ã€‚Monorepo æ˜¯ç®¡ç†é¡¹ç›®ä»£ç çš„ä¸€ä¸ªæ–¹å¼ï¼ŒæŒ‡åœ¨ä¸€ä¸ªé¡¹ç›®ä»“åº“ (repo) ä¸­ç®¡ç†å¤šä¸ªæ¨¡å—&#x2F;åŒ… (package)ï¼Œä¸åŒäºå¸¸è§çš„æ¯ä¸ªæ¨¡å—å»ºä¸€ä¸ª repoã€‚</p><p>ç›®å‰æœ‰ä¸å°‘å¤§å‹å¼€æºé¡¹ç›®é‡‡ç”¨äº†è¿™ç§æ–¹å¼ï¼Œå¦‚ Babelï¼ŒReact, Meteor, Ember, Angular,Jest, Umijs, Vue, è¿˜æœ‰ create-react-app, react-router ç­‰ã€‚å‡ ä¹æˆ‘ä»¬ç†ŸçŸ¥çš„ä»“åº“ï¼Œéƒ½æ— ä¸€ä¾‹å¤–çš„é‡‡ç”¨äº†monorepo çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹åˆ°è¿™äº›é¡¹ç›®çš„ç¬¬ä¸€çº§ç›®å½•çš„å†…å®¹ä»¥è„šæ‰‹æ¶ä¸ºä¸»ï¼Œä¸»è¦å†…å®¹éƒ½åœ¨ packagesç›®å½•ä¸­ã€åˆ†å¤šä¸ª package è¿›è¡Œç®¡ç†ã€‚</p><p>ç›®å½•ç»“æ„å¦‚ä¸‹:</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”œâ”€â”€ packages|   â”œâ”€â”€ pkg1|   |   â”œâ”€â”€ package.json|   â”œâ”€â”€ pkg2|   |   â”œâ”€â”€ package.jsonâ”œâ”€â”€ package.json</code></pre><p>monorepo æœ€ä¸»è¦çš„å¥½å¤„æ˜¯ç»Ÿä¸€çš„å·¥ä½œæµå’ŒCode Sharingã€‚æ¯”å¦‚æˆ‘æƒ³çœ‹ä¸€ä¸ª pacakge çš„ä»£ç ã€äº†è§£æŸæ®µé€»è¾‘ï¼Œä¸éœ€è¦æ‰¾å®ƒçš„ repoï¼Œç›´æ¥å°±åœ¨å½“å‰ repoï¼›å½“æŸä¸ªéœ€æ±‚è¦ä¿®æ”¹å¤šä¸ª pacakge æ—¶ï¼Œä¸éœ€è¦åˆ†åˆ«åˆ°å„è‡ªçš„ repo è¿›è¡Œä¿®æ”¹ã€æµ‹è¯•ã€å‘ç‰ˆæˆ–è€… npm linkï¼Œç›´æ¥åœ¨å½“å‰ repo ä¿®æ”¹ï¼Œç»Ÿä¸€æµ‹è¯•ã€ç»Ÿä¸€å‘ç‰ˆã€‚åªè¦æ­å»ºä¸€å¥—è„šæ‰‹æ¶ï¼Œå°±èƒ½ç®¡ç†ï¼ˆæ„å»ºã€æµ‹è¯•ã€å‘å¸ƒï¼‰å¤šä¸ª packageã€‚</p><p>ä¸€å›¾èƒœåƒè¨€:<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOThmNTYwZDgxZDg"></p><p>å‰è€…å…è®¸å¤šå…ƒåŒ–å‘å±•ï¼ˆå„é¡¹ç›®å¯ä»¥æœ‰è‡ªå·±çš„æ„å»ºå·¥å…·ã€ä¾èµ–ç®¡ç†ç­–ç•¥ã€å•å…ƒæµ‹è¯•æ–¹æ³•ï¼‰ï¼Œåè€…å¸Œæœ›é›†ä¸­ç®¡ç†ï¼Œå‡å°‘é¡¹ç›®é—´çš„å·®å¼‚å¸¦æ¥çš„æ²Ÿé€šæˆæœ¬ã€‚</p><p>è™½ç„¶æ‹†åˆ†å­ä»“åº“ã€æ‹†åˆ†å­ npm åŒ…æ˜¯è¿›è¡Œé¡¹ç›®éš”ç¦»çš„å¤©ç„¶æ–¹æ¡ˆï¼Œä½†å½“ä»“åº“å†…å®¹å‡ºç°å…³è”æ—¶ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ç§è°ƒè¯•æ–¹å¼æ¯”æºç æ”¾åœ¨ä¸€èµ·æ›´é«˜æ•ˆã€‚</p><p>ç»“åˆshop-serviceé—¨æˆ·çš„å®é™…åœºæ™¯å’Œä¸šåŠ¡éœ€è¦ï¼Œå¤©ç„¶çš„ MonoRepo ! ä¸€ä¸ªç†æƒ³çš„å¼€å‘ç¯å¢ƒå¯ä»¥æŠ½è±¡æˆè¿™æ ·ï¼š</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>â€œåªå…³å¿ƒä¸šåŠ¡ä»£ç ï¼Œå¯ä»¥ç›´æ¥è·¨ä¸šåŠ¡å¤ç”¨è€Œä¸å…³å¿ƒå¤ç”¨æ–¹å¼ï¼Œè°ƒè¯•æ—¶æ‰€æœ‰ä»£ç éƒ½åœ¨æºç ä¸­ã€‚â€</p></blockquote><p>åœ¨å‰ç«¯å¼€å‘ç¯å¢ƒä¸­ï¼Œå¤š Git Repoï¼Œå¤š npm åˆ™æ˜¯è¿™ä¸ªç†æƒ³çš„é˜»åŠ›ï¼Œå®ƒä»¬å¯¼è‡´å¤ç”¨è¦å…³å¿ƒç‰ˆæœ¬å·ï¼Œè°ƒè¯•éœ€è¦ npm linkã€‚è€Œè¿™äº›æ˜¯ MonoRepo æœ€å¤§çš„ä¼˜åŠ¿ã€‚</p><p>ä¸Šå›¾ä¸­æåˆ°çš„åˆ©ç”¨ç›¸å…³å·¥å…·å°±æ˜¯ä»Šå¤©çš„ä¸»è§’ Lerna ! Lernaæ˜¯ä¸šç•ŒçŸ¥ååº¦æœ€é«˜çš„ Monorepo ç®¡ç†å·¥å…·ï¼ŒåŠŸèƒ½å®Œæ•´ã€‚</p><h2 id="Lerna"><a href="#Lerna" class="headerlink" title="Lerna"></a>Lerna</h2><p>Lerna æ˜¯ä¸€ä¸ªç®¡ç†å¤šä¸ª npm æ¨¡å—çš„å·¥å…·ï¼Œæ˜¯ Babel è‡ªå·±ç”¨æ¥ç»´æŠ¤è‡ªå·±çš„ Monorepo å¹¶å¼€æºå‡ºçš„ä¸€ä¸ªé¡¹ç›®ã€‚ä¼˜åŒ–ç»´æŠ¤å¤šåŒ…çš„å·¥ä½œæµï¼Œè§£å†³å¤šä¸ªåŒ…äº’ç›¸ä¾èµ–ï¼Œä¸”å‘å¸ƒéœ€è¦æ‰‹åŠ¨ç»´æŠ¤å¤šä¸ªåŒ…çš„é—®é¢˜ã€‚</p><p>2.1 å®‰è£…<br>æ¨èå…¨å±€å®‰è£…ï¼Œå› ä¸ºä¼šç»å¸¸ç”¨åˆ° lerna å‘½ä»¤</p><pre class="line-numbers language-none"><code class="language-none">npm i -g lerna</code></pre><p>2.2 åˆå§‹åŒ–é¡¹ç›®</p><pre class="line-numbers language-none"><code class="language-none">lerna init</code></pre><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOWE5MDhiMTkyOWQ"></p><p>å…¶ä¸­ package.json &amp; lerna.json å¦‚ä¸‹:</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#x2F;&#x2F; package.json&#123;  &quot;name&quot;: &quot;root&quot;,  &quot;private&quot;: true, &#x2F;&#x2F; ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å‘å¸ƒï¼Œæ˜¯ç®¡ç†æ•´ä¸ªé¡¹ç›®ï¼Œä¸è¦å‘å¸ƒåˆ°npmçš„è§£è€¦  &quot;devDependencies&quot;: &#123;    &quot;lerna&quot;: &quot;^3.15.0&quot;  &#125;&#125; &#x2F;&#x2F; lerna.json&#123;  &quot;packages&quot;: [    &quot;packages&#x2F;*&quot;  ],  &quot;version&quot;: &quot;0.0.0&quot;&#125;</code></pre><p>2.3 åˆ›å»ºnpmåŒ…<br>å¢åŠ ä¸¤ä¸ª packages</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOWIyOTgzNjExZDE"></p><p>2.4 å¢åŠ æ¨¡å—ä¾èµ–<br>åˆ†åˆ«ç»™ç›¸åº”çš„ package å¢åŠ ä¾èµ–æ¨¡å—</p><pre class="line-numbers language-none"><code class="language-none">lerna add chalk &#x2F;&#x2F; ä¸ºæ‰€æœ‰ package å¢åŠ  chalk æ¨¡å— lerna add semver --scope @mo-demo&#x2F;cli-shared-utils &#x2F;&#x2F; ä¸º @mo-demo&#x2F;cli-shared-utils å¢åŠ  semver æ¨¡å— lerna add @mo-demo&#x2F;cli-shared-utils --scope @mo-demo&#x2F;cli &#x2F;&#x2F; å¢åŠ å†…éƒ¨æ¨¡å—ä¹‹é—´çš„ä¾èµ–</code></pre><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOWI2NTNmMGQ5NjQ"></p><p>2.5 å‘å¸ƒ</p><pre class="line-numbers language-none"><code class="language-none">lerna publish</code></pre><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOWJiMWY4MjhjZjk"></p><p>2.6 ä¾èµ–åŒ…ç®¡ç†<br>ä¸Šè¿°1-5æ­¥å·²ç»åŒ…å«äº† Lerna æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„è¿‡ç¨‹äº†ï¼Œä½†å½“æˆ‘ä»¬ç»´æŠ¤è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œæ–°æ‹‰ä¸‹æ¥ä»“åº“çš„ä»£ç åï¼Œéœ€è¦ä¸ºå„ä¸ª package å®‰è£…ä¾èµ–åŒ…ã€‚</p><p>æˆ‘ä»¬åœ¨ç¬¬4æ­¥ lerna add æ—¶ä¹Ÿå‘ç°äº†ï¼Œä¸ºæŸä¸ª package å®‰è£…çš„åŒ…è¢«æ”¾åˆ°äº†è¿™ä¸ª package ç›®å½•ä¸‹çš„ node_modules ç›®å½•ä¸‹ã€‚è¿™æ ·å¯¹äºå¤šä¸ª package éƒ½ä¾èµ–çš„åŒ…ï¼Œä¼šè¢«å¤šä¸ª package å®‰è£…å¤šæ¬¡ï¼Œå¹¶ä¸”æ¯ä¸ª package ä¸‹éƒ½ç»´æŠ¤ node_modules ï¼Œä¹Ÿä¸æ¸…çˆ½ã€‚äºæ˜¯æˆ‘ä»¬ä½¿ç”¨ â€“hoist æ¥æŠŠæ¯ä¸ª package ä¸‹çš„ä¾èµ–åŒ…éƒ½æå‡åˆ°å·¥ç¨‹æ ¹ç›®å½•ï¼Œæ¥é™ä½å®‰è£…ä»¥åŠç®¡ç†çš„æˆæœ¬ã€‚</p><pre class="line-numbers language-none"><code class="language-none">lerna bootstrap --hoist</code></pre><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOWJmNjUxZDkxMWY"></p><p>ä¸ºäº†çœå»æ¯æ¬¡éƒ½è¾“å…¥ â€“hoist å‚æ•°çš„éº»çƒ¦ï¼Œå¯ä»¥åœ¨ lerna.json é…ç½®ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;packages&quot;: [    &quot;packages&#x2F;*&quot;  ],  &quot;command&quot;: &#123;    &quot;bootstrap&quot;: &#123;      &quot;hoist&quot;: true    &#125;  &#125;,  &quot;version&quot;: &quot;0.0.1-alpha.0&quot;&#125;</code></pre><p>é…ç½®å¥½åï¼Œå¯¹äºä¹‹å‰ä¾èµ–åŒ…å·²ç»è¢«å®‰è£…åˆ°å„ä¸ª package ä¸‹çš„æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦æ¸…ç†ä¸€ä¸‹å®‰è£…çš„ä¾èµ–å³å¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">lerna clean</code></pre><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyOWM2OTdjODVjMWM" width=350 style="object-fit:contain"/>ç„¶åæ‰§è¡Œ lerna bootstrap å³å¯çœ‹åˆ° package çš„ä¾èµ–éƒ½è¢«å®‰è£…åˆ°æ ¹ç›®å½•ä¸‹çš„ `node_modules` ä¸­äº†ã€‚<h2 id="Lerna-Monorepo-æœ€ä½³å®è·µ"><a href="#Lerna-Monorepo-æœ€ä½³å®è·µ" class="headerlink" title="Lerna + Monorepo æœ€ä½³å®è·µ"></a>Lerna + Monorepo æœ€ä½³å®è·µ</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>lernaä¸è´Ÿè´£æ„å»ºï¼Œæµ‹è¯•ç­‰ä»»åŠ¡ï¼Œå®ƒæå‡ºäº†ä¸€ç§é›†ä¸­ç®¡ç†packageçš„ç›®å½•æ¨¡å¼ï¼Œæä¾›äº†ä¸€å¥—è‡ªåŠ¨åŒ–ç®¡ç†ç¨‹åºï¼Œè®©å¼€å‘è€…ä¸å¿…å†æ·±è€•åˆ°å…·ä½“çš„ç»„ä»¶é‡Œç»´æŠ¤å†…å®¹ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•å°±å¯ä»¥å…¨å±€æŒæ§ï¼ŒåŸºäº npm scriptsï¼Œä½¿ç”¨è€…å¯ä»¥å¾ˆå¥½åœ°å®Œæˆç»„ä»¶æ„å»ºï¼Œä»£ç æ ¼å¼åŒ–ç­‰æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼Œå¦‚æœåŸºäº Lernaï¼Œå¹¶ç»“åˆå…¶å®ƒå·¥å…·æ¥æ­å»º Monorepo é¡¹ç›®çš„æœ€ä½³å®è·µã€‚</p></blockquote><p>ç›®å‰æœ€å¸¸è§çš„ monorepo è§£å†³æ–¹æ¡ˆæ˜¯ Lerna å’Œ yarn çš„ workspaces ç‰¹æ€§ï¼ŒåŸºäºlernaå’Œyarn workspaceçš„monorepoå·¥ä½œæµã€‚ç”±äºyarnå’Œlernaåœ¨åŠŸèƒ½ä¸Šæœ‰è¾ƒå¤šçš„é‡å ,æˆ‘ä»¬é‡‡ç”¨yarnå®˜æ–¹æ¨èçš„åšæ³•,ç”¨yarnæ¥å¤„ç†ä¾èµ–é—®é¢˜ï¼Œç”¨lernaæ¥å¤„ç†å‘å¸ƒé—®é¢˜ã€‚èƒ½ç”¨yarnåšçš„å°±ç”¨yarnåšå§</p><h2 id="yarn-workspace"><a href="#yarn-workspace" class="headerlink" title="yarn workspace"></a>yarn workspace</h2><p>3.1.1 æ­å»ºç¯å¢ƒ<br>æ™®é€šé¡¹ç›®ï¼šcloneä¸‹æ¥åé€šè¿‡yarn install,å³å¯æ­å»ºå®Œé¡¹ç›®ï¼Œæœ‰æ—¶éœ€è¦é…åˆpostinstall hooks,æ¥è¿›è¡Œè‡ªåŠ¨ç¼–è¯‘ï¼Œæˆ–è€…å…¶ä»–è®¾ç½®ã€‚</p><p>monorepo: å„ä¸ªåº“ä¹‹é—´å­˜åœ¨ä¾èµ–ï¼Œå¦‚Aä¾èµ–äºBï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸éœ€è¦å°†B linkåˆ°Açš„node_moduleé‡Œï¼Œä¸€æ—¦ä»“åº“å¾ˆå¤šçš„è¯ï¼Œæ‰‹åŠ¨çš„ç®¡ç†è¿™äº›linkæ“ä½œè´Ÿæ‹…å¾ˆå¤§ï¼Œå› æ­¤éœ€è¦è‡ªåŠ¨åŒ–çš„linkæ“ä½œï¼ŒæŒ‰ç…§æ‹“æ‰‘æ’åºå°†å„ä¸ªä¾èµ–è¿›è¡Œlink</p><p>è§£å†³æ–¹å¼ï¼šé€šè¿‡ä½¿ç”¨workspaceï¼Œyarn installä¼šè‡ªåŠ¨çš„å¸®å¿™è§£å†³å®‰è£…å’Œlinké—®é¢˜</p><pre class="line-numbers language-none"><code class="language-none">yarn install # ç­‰ä»·äº lerna bootstrap --npm-client yarn --use-workspaces</code></pre><p>3.1.2 æ¸…ç†ç¯å¢ƒ<br>åœ¨ä¾èµ–ä¹±æ‰æˆ–è€…å·¥ç¨‹æ··ä¹±çš„æƒ…å†µä¸‹ï¼Œæ¸…ç†ä¾èµ–</p><p>æ™®é€šé¡¹ç›®ï¼š ç›´æ¥åˆ é™¤node_modulesä»¥åŠç¼–è¯‘åçš„äº§ç‰©ã€‚</p><p>monorepoï¼š ä¸ä»…éœ€è¦åˆ é™¤rootçš„node_modulesçš„ç¼–è¯‘äº§ç‰©è¿˜éœ€è¦åˆ é™¤å„ä¸ªpackageé‡Œçš„node_modulesä»¥åŠç¼–è¯‘äº§ç‰©</p><p>è§£å†³æ–¹å¼ï¼šä½¿ç”¨lerna cleanæ¥åˆ é™¤æ‰€æœ‰çš„node_modulesï¼Œä½¿ç”¨yarn workspaces run cleanæ¥æ‰§è¡Œæ‰€æœ‰packageçš„æ¸…ç†å·¥ä½œ</p><pre class="line-numbers language-none"><code class="language-none">lerna clean # æ¸…ç†æ‰€æœ‰çš„node_modulesyarn workspaces run clean # æ‰§è¡Œæ‰€æœ‰packageçš„cleanæ“ä½œ</code></pre><p>3.1.3 å®‰è£…|åˆ é™¤ä¾èµ–<br>æ™®é€šé¡¹ç›®ï¼š é€šè¿‡yarn addå’Œyarn removeå³å¯ç®€å•å§è§£å†³ä¾èµ–åº“çš„å®‰è£…å’Œåˆ é™¤é—®é¢˜</p><p>monorepo: ä¸€èˆ¬åˆ†ä¸ºä¸‰ç§åœºæ™¯</p><p>ç»™æŸä¸ªpackageå®‰è£…ä¾èµ–ï¼šyarn workspace packageB add packageA å°†packageAä½œä¸ºpackageBçš„ä¾èµ–è¿›è¡Œå®‰è£…</p><p>ç»™æ‰€æœ‰çš„packageå®‰è£…ä¾èµ–: ä½¿ç”¨yarn workspaces add lodash ç»™æ‰€æœ‰çš„packageå®‰è£…ä¾èµ–</p><p>ç»™root å®‰è£…ä¾èµ–ï¼šä¸€èˆ¬çš„å…¬ç”¨çš„å¼€å‘å·¥å…·éƒ½æ˜¯å®‰è£…åœ¨rooté‡Œï¼Œå¦‚typescript,æˆ‘ä»¬ä½¿ç”¨yarn add -W -D typescriptæ¥ç»™rootå®‰è£…ä¾èµ–</p><p>å¯¹åº”çš„ä¸‰ç§åœºæ™¯åˆ é™¤ä¾èµ–å¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">yarn workspace packageB remove packageAyarn workspaces remove lodashyarn remove -W -D typescript</code></pre><p>3.1.4 é¡¹ç›®æ„å»º<br>æ™®é€šé¡¹ç›®ï¼šå»ºç«‹ä¸€ä¸ªbuildçš„npm scriptï¼Œä½¿ç”¨yarn buildå³å¯å®Œæˆé¡¹ç›®æ„å»º</p><p>monorepo:åŒºåˆ«äºæ™®é€šé¡¹ç›®ä¹‹å¤„åœ¨äºå„ä¸ªpackageä¹‹é—´å­˜åœ¨ç›¸äº’ä¾èµ–ï¼Œå¦‚packageBåªæœ‰åœ¨packageAæ„å»ºå®Œä¹‹åæ‰èƒ½è¿›è¡Œæ„å»ºï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ï¼Œè¿™å®é™…ä¸Šè¦æ±‚æˆ‘ä»¬ä»¥ä¸€ç§æ‹“æ‰‘æ’åºçš„è§„åˆ™è¿›è¡Œæ„å»ºã€‚</p><p>æˆ‘ä»¬å¯ä»¥è‡ªå·±æ„å»ºæ‹“æ‰‘æ’åºè§„åˆ™ï¼Œå¾ˆä¸å¹¸çš„æ˜¯yarnçš„workspaceæš‚æ—¶å¹¶æœªæ”¯æŒæŒ‰ç…§æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤,è™½ç„¶è¯¥ rfcå·²ç»è¢«acceptedï¼Œä½†æ˜¯å°šæœªå®ç°, å¹¸è¿çš„æ˜¯lernaæ”¯æŒæŒ‰ç…§æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤, â€“sortå‚æ•°å¯ä»¥æ§åˆ¶ä»¥æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤</p><pre class="line-numbers language-none"><code class="language-none">lerna run --stream --sort build</code></pre><p>3.1.5 ç‰ˆæœ¬å‡çº§åŠå‘åŒ…<br>é¡¹ç›®æµ‹è¯•å®Œæˆåï¼Œå°±æ¶‰åŠåˆ°ç‰ˆæœ¬å‘å¸ƒï¼Œç‰ˆæœ¬å‘å¸ƒä¸€èˆ¬æ¶‰åŠåˆ°å¦‚ä¸‹ä¸€äº›æ­¥éª¤</p><p>æ¡ä»¶éªŒè¯: å¦‚éªŒè¯æµ‹è¯•æ˜¯å¦é€šè¿‡ï¼Œæ˜¯å¦å­˜åœ¨æœªæäº¤çš„ä»£ç ï¼Œæ˜¯å¦åœ¨ä¸»åˆ†æ”¯ä¸Šè¿›è¡Œç‰ˆæœ¬å‘å¸ƒæ“ä½œ</p><p>version_bump:å‘ç‰ˆçš„æ—¶å€™éœ€è¦æ›´æ–°ç‰ˆæœ¬å·ï¼Œè¿™æ—¶å€™å¦‚ä½•æ›´æ–°ç‰ˆæœ¬å·å°±æ˜¯ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬å¤§å®¶éƒ½ä¼šéµå¾ª semVerè¯­ä¹‰ï¼Œ</p><p>ç”Ÿæˆchangelog: ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æ¯ä¸ªpackageæ¯ä¸ªç‰ˆæœ¬è§£å†³äº†å“ªäº›åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªpackageéƒ½ç”Ÿæˆä¸€ä»½changelogæ–¹ä¾¿ç”¨æˆ·æŸ¥çœ‹å„ä¸ªç‰ˆæœ¬çš„åŠŸèƒ½å˜åŒ–ã€‚</p><p>ç”Ÿæˆgit tagï¼šä¸ºäº†æ–¹ä¾¿åç»­å›æ»šé—®é¢˜åŠé—®é¢˜æ’æŸ¥é€šå¸¸éœ€è¦ç»™æ¯ä¸ªç‰ˆæœ¬åˆ›å»ºä¸€ä¸ªgit tag</p><p>git å‘å¸ƒç‰ˆæœ¬ï¼šæ¯æ¬¡å‘ç‰ˆæˆ‘ä»¬éƒ½éœ€è¦å•ç‹¬ç”Ÿæˆä¸€ä¸ªcommitè®°å½•æ¥æ ‡è®°milestone</p><p>å‘å¸ƒnpmåŒ…ï¼šå‘å¸ƒå®Œgitåæˆ‘ä»¬è¿˜éœ€è¦å°†æ›´æ–°çš„ç‰ˆæœ¬å‘å¸ƒåˆ°npmä¸Šï¼Œä»¥ä¾¿å¤–éƒ¨ç”¨æˆ·ä½¿ç”¨</p><p>æˆ‘ä»¬å‘ç°æ‰‹åŠ¨çš„æ‰§è¡Œè¿™äº›æ“ä½œæ˜¯å¾ˆéº»çƒ¦çš„ä¸”åŠå…¶å®¹æ˜“å‡ºé”™ï¼Œå¹¸è¿çš„æ˜¯lernaå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™äº›é—®é¢˜</p><p>yarnå®˜æ–¹å¹¶ä¸æ‰“ç®—æ”¯æŒå‘å¸ƒæµç¨‹ï¼Œåªæ˜¯æƒ³åšå¥½åŒ…ç®¡ç†å·¥å…·ï¼Œå› æ­¤è¿™éƒ¨åˆ†è¿˜æ˜¯éœ€è¦é€šè¿‡lernaæ”¯æŒ</p><p>lernaæä¾›äº†publishå’Œversionæ¥æ”¯æŒç‰ˆæœ¬çš„å‡çº§å’Œå‘å¸ƒ, publishçš„åŠŸèƒ½å¯ä»¥å³åŒ…å«versionçš„å·¥ä½œï¼Œä¹Ÿå¯ä»¥å•çº¯çš„åªåšå‘å¸ƒæ“ä½œã€‚</p><p>3.2 ä¼˜é›…çš„æäº¤<br>3.2.1 <code>commitizen</code> &amp;&amp; <code>cz-lerna-changelog</code><br>commitizen æ˜¯ç”¨æ¥æ ¼å¼åŒ– git commit message çš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ç§é—®è¯¢å¼çš„æ–¹å¼å»è·å–æ‰€éœ€çš„æäº¤ä¿¡æ¯ã€‚</p><p>cz-lerna-changelog æ˜¯ä¸“é—¨ä¸º Lerna é¡¹ç›®é‡èº«å®šåˆ¶çš„æäº¤è§„èŒƒï¼Œåœ¨é—®è¯¢çš„è¿‡ç¨‹ï¼Œä¼šæœ‰ç±»ä¼¼å½±å“å“ªäº› package çš„é€‰æ‹©ã€‚å¦‚ä¸‹ï¼š</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyYTNmZGEyMTA3MGI"></p><p>æˆ‘ä»¬ä½¿ç”¨ commitizen å’Œ cz-lerna-changelog æ¥è§„èŒƒæäº¤ï¼Œä¸ºåé¢è‡ªåŠ¨ç”Ÿæˆæ—¥å¿—ä½œå¥½å‡†å¤‡ã€‚</p><p>å› ä¸ºè¿™æ˜¯æ•´ä¸ªå·¥ç¨‹çš„å¼€å‘ä¾èµ–ï¼Œæ‰€ä»¥åœ¨æ ¹ç›®å½•å®‰è£…ï¼š</p><pre class="line-numbers language-none"><code class="language-none">yarn add  -D commitizenyarn add  -D cz-lerna-changelog</code></pre><p>å®‰è£…å®Œæˆåï¼Œåœ¨ <code>package.json</code> ä¸­å¢åŠ  <code>config</code> å­—æ®µï¼ŒæŠŠ <code>cz-lerna-changelog</code> é…ç½®ç»™ <code>commitizen</code>ã€‚åŒæ—¶å› ä¸º<code>commitizen</code>ä¸æ˜¯å…¨å±€å®‰å…¨çš„ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ  <code>scripts</code> è„šæœ¬æ¥æ‰§è¡Œ <code>git-cz</code></p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;name&quot;: &quot;root&quot;,  &quot;private&quot;: true,  &quot;scripts&quot;: &#123;    &quot;commit&quot;: &quot;git-cz&quot;  &#125;,  &quot;config&quot;: &#123;    &quot;commitizen&quot;: &#123;      &quot;path&quot;: &quot;.&#x2F;node_modules&#x2F;cz-lerna-changelog&quot;    &#125;  &#125;,  &quot;devDependencies&quot;: &#123;    &quot;commitizen&quot;: &quot;^3.1.1&quot;,    &quot;cz-lerna-changelog&quot;: &quot;^2.0.2&quot;,    &quot;lerna&quot;: &quot;^3.15.0&quot;  &#125;&#125;</code></pre><p>ä¹‹ååœ¨å¸¸è§„çš„å¼€å‘ä¸­å°±å¯ä»¥ä½¿ç”¨ yarn run commit æ¥æ ¹æ®æç¤ºä¸€æ­¥ä¸€æ­¥è¾“å…¥ï¼Œæ¥å®Œæˆä»£ç çš„æäº¤ã€‚</p><p>3.2.2 commitlint &amp;&amp; husky<br>ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº† commitizen æ¥è§„èŒƒæäº¤ï¼Œä½†è¿™ä¸ªè¦é å¼€å‘è‡ªè§‰ä½¿ç”¨<code>yarn run commit</code> ã€‚ä¸‡ä¸€å¿˜è®°äº†ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ git commit æäº¤æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆå°±æ˜¯åœ¨æäº¤æ—¶å¯¹æäº¤ä¿¡æ¯è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä¸ç¬¦åˆè¦æ±‚å°±ä¸è®©æäº¤ï¼Œå¹¶æç¤ºã€‚æ ¡éªŒçš„å·¥ä½œç”± commitlint æ¥å®Œæˆï¼Œæ ¡éªŒçš„æ—¶æœºåˆ™ç”± husky æ¥æŒ‡å®šã€‚husky ç»§æ‰¿äº† Git ä¸‹æ‰€æœ‰çš„é’©å­ï¼Œåœ¨è§¦å‘é’©å­çš„æ—¶å€™ï¼Œhusky å¯ä»¥é˜»æ­¢ä¸åˆæ³•çš„ commit,push ç­‰ç­‰ã€‚</p><p>å®‰è£… commitlint ä»¥åŠè¦éµå®ˆçš„è§„èŒƒ</p><pre class="line-numbers language-none"><code class="language-none">yarn add -D @commitlint&#x2F;cli @commitlint&#x2F;config-conventional</code></pre><p>åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸º commitlint å¢åŠ é…ç½®æ–‡ä»¶ commitlint.config.js ä¸ºcommitlint æŒ‡å®šç›¸åº”çš„è§„èŒƒ</p><pre class="line-numbers language-none"><code class="language-none">module.exports &#x3D; &#123; extends: [&#39;@commitlint&#x2F;config-conventional&#39;] &#125;</code></pre><p>å®‰è£… husky</p><pre class="line-numbers language-none"><code class="language-none">yarn add -D husky</code></pre><p>åœ¨ package.json ä¸­å¢åŠ å¦‚ä¸‹é…ç½®</p><pre class="line-numbers language-none"><code class="language-none">&quot;husky&quot;: &#123; &quot;hooks&quot;: &#123;    &quot;commit-msg&quot;: &quot;commitlint -E HUSKY_GIT_PARAMS&quot;     &#125;&#125;</code></pre><p>â€œcommit-msgâ€æ˜¯gitæäº¤æ—¶æ ¡éªŒæäº¤ä¿¡æ¯çš„é’©å­ï¼Œå½“è§¦å‘æ—¶ä¾¿ä¼šä½¿ç”¨ commitlit æ¥æ ¡éªŒã€‚å®‰è£…é…ç½®å®Œæˆåï¼Œæƒ³é€šè¿‡ git commit æˆ–è€…å…¶å®ƒç¬¬ä¸‰æ–¹å·¥å…·æäº¤æ—¶ï¼Œåªè¦æäº¤ä¿¡æ¯ä¸ç¬¦åˆè§„èŒƒå°±æ— æ³•æäº¤ã€‚ä»è€Œçº¦æŸå¼€å‘è€…ä½¿ç”¨ yarn run commit æ¥æäº¤ã€‚</p><p>3.2.3 eslint &amp;&amp; lint-staged<br>é™¤äº†è§„èŒƒæäº¤ä¿¡æ¯ï¼Œä»£ç æœ¬èº«è‚¯å®šä¹Ÿå°‘äº†é è§„èŒƒæ¥ç»Ÿä¸€é£æ ¼ã€‚</p><p>å®‰è£…</p><pre class="line-numbers language-none"><code class="language-none">yarn add  -D standard lint-staged</code></pre><p>eslintå°±æ˜¯å®Œæ•´çš„ä¸€å¥— JavaScriptï¼ˆtypescriptï¼‰ ä»£ç è§„èŒƒï¼Œè‡ªå¸¦ linter &amp; ä»£ç è‡ªåŠ¨ä¿®æ­£ã€‚è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç å¹¶ä¿®æ­£ï¼Œæå‰å‘ç°é£æ ¼ä»¥åŠç¨‹åºé—®é¢˜, åŒæ—¶ä¹Ÿæ”¯æŒtypescriptçš„ä»£ç è§„èŒƒæ ¡éªŒï¼Œ<code>eslintrc.json</code>é…ç½®ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;    &quot;extends&quot;: [        &quot;yayajing&quot;,        &quot;plugin:@typescript-eslint&#x2F;recommended&quot;    ],    &quot;parser&quot;: &quot;typescript-eslint-parser&quot;,    &quot;plugins&quot;: [&quot;@typescript-eslint&quot;],    &quot;rules&quot;: &#123;        &quot;eqeqeq&quot;:&quot;off&quot;,        &quot;@typescript-eslint&#x2F;explicit-function-return-type&quot;: &quot;off&quot;,        &quot;no-template-curly-in-string&quot;: &quot;off&quot;    &#125;  &#125;</code></pre><p><code>lint-staged staged</code> æ˜¯ Git é‡Œçš„æ¦‚å¿µï¼Œè¡¨ç¤ºæš‚å­˜åŒºï¼Œlint-staged è¡¨ç¤ºåªæ£€æŸ¥å¹¶çŸ«æ­£æš‚å­˜åŒºä¸­çš„æ–‡ä»¶ã€‚ä¸€æ¥æé«˜æ ¡éªŒæ•ˆç‡ï¼ŒäºŒæ¥å¯ä»¥ä¸ºè€çš„é¡¹ç›®å¸¦å»å·¨å¤§çš„æ–¹ä¾¿ã€‚<br>package.jsoné…ç½®</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; package.json&#123;  &quot;name&quot;: &quot;root&quot;,  &quot;private&quot;: true,  &quot;scripts&quot;: &#123;    &quot;c&quot;: &quot;git-cz&quot;  &#125;,  &quot;config&quot;: &#123;    &quot;commitizen&quot;: &#123;      &quot;path&quot;: &quot;.&#x2F;node_modules&#x2F;cz-lerna-changelog&quot;    &#125;  &#125;,  &quot;husky&quot;: &#123;    &quot;hooks&quot;: &#123;      &quot;pre-commit&quot;: &quot;lint-staged&quot;,      &quot;commit-msg&quot;: &quot;commitlint -E HUSKY_GIT_PARAMS&quot;    &#125;  &#125;,  &quot;lint-staged&quot;: &#123;    &quot;*.ts&quot;: [      &quot;eslint --fix&quot;,      &quot;git add&quot;    ]  &#125;,  &quot;devDependencies&quot;: &#123;    &quot;@commitlint&#x2F;cli&quot;: &quot;^8.1.0&quot;,    &quot;@commitlint&#x2F;config-conventional&quot;: &quot;^8.1.0&quot;,    &quot;commitizen&quot;: &quot;^3.1.1&quot;,    &quot;cz-lerna-changelog&quot;: &quot;^2.0.2&quot;,    &quot;husky&quot;: &quot;^3.0.0&quot;,    &quot;lerna&quot;: &quot;^3.15.0&quot;,    &quot;lint-staged&quot;: &quot;^9.2.0&quot;  &#125;&#125;</code></pre><p>å®‰è£…å®Œæˆåï¼Œåœ¨ package.json å¢åŠ  lint-staged é…ç½®ï¼Œå¦‚ä¸Šæ‰€ç¤ºè¡¨ç¤ºå¯¹æš‚å­˜åŒºä¸­çš„ js æ–‡ä»¶æ‰§è¡Œ eslint â€“fix æ ¡éªŒå¹¶è‡ªåŠ¨ä¿®å¤ã€‚é‚£ä»€ä¹ˆæ—¶å€™å»æ ¡éªŒå‘¢ï¼Œå°±åˆç”¨åˆ°äº†ä¸Šé¢å®‰è£…çš„ husky ï¼Œhuskyçš„é…ç½®ä¸­å¢åŠ pre-commitçš„é’©å­ç”¨æ¥æ‰§è¡Œ lint-staged çš„æ ¡éªŒæ“ä½œã€‚</p><p>æ­¤æ—¶æäº¤ ts æ–‡ä»¶æ—¶ï¼Œä¾¿ä¼šè‡ªåŠ¨ä¿®æ­£å¹¶æ ¡éªŒé”™è¯¯ã€‚å³ä¿è¯äº†ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œåˆèƒ½æé«˜ä»£ç è´¨é‡ã€‚</p><p>3.3 å‘å¸ƒè‡ªåŠ¨ç”Ÿæˆæ—¥å¿—<br>æœ‰äº†ä¹‹å‰çš„è§„èŒƒæäº¤ï¼Œè‡ªåŠ¨ç”Ÿæˆæ—¥å¿—ä¾¿æ°´åˆ°æ¸ æˆäº†ã€‚å†è¯¦ç»†çœ‹ä¸‹ lerna publish æ—¶åšäº†å“ªäº›äº‹æƒ…ï¼š</p><p>3.3.1 lerna version æ›´æ–°ç‰ˆæœ¬</p><ul><li><p>æ‰¾å‡ºä»ä¸Šä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒä»¥æ¥æœ‰è¿‡å˜æ›´çš„ package</p></li><li><p>æç¤ºå¼€å‘è€…ç¡®å®šè¦å‘å¸ƒçš„ç‰ˆæœ¬å·</p></li><li><p>å°†æ‰€æœ‰æ›´æ–°è¿‡çš„çš„ package ä¸­çš„package.jsonçš„versionå­—æ®µæ›´æ–°</p></li><li><p>å°†ä¾èµ–æ›´æ–°è¿‡çš„ package çš„ åŒ…ä¸­çš„ä¾èµ–ç‰ˆæœ¬å·æ›´æ–°</p></li><li><p>æ›´æ–° lerna.json ä¸­çš„ version å­—æ®µ</p></li><li><p>æäº¤ä¸Šè¿°ä¿®æ”¹ï¼Œå¹¶æ‰“ä¸€ä¸ª tag</p></li><li><p>æ¨é€åˆ° git ä»“åº“<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyYTMzNTMzMzhkYTA"></p></li></ul><p>3.3.2 ä½¿ç”¨ npm publish å°†æ–°ç‰ˆæœ¬æ¨é€åˆ° npm<br><code>CHANGELOG</code> å¾ˆæ˜æ˜¾æ˜¯å’Œ version ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨ lerna version ä¸­æƒ³åŠæ³•ï¼ŒæŸ¥çœ‹ lerna version å‘½ä»¤çš„è¯¦ç»†è¯´æ˜åï¼Œä¼šçœ‹åˆ°ä¸€ä¸ªé…ç½®å‚æ•° <code>--conventional-commits</code>ã€‚æ²¡é”™ï¼Œåªè¦æˆ‘ä»¬æŒ‰è§„èŒƒæäº¤åï¼Œåœ¨ lerna version çš„è¿‡ç¨‹ä¸­ä¼šä¾¿ä¼šè‡ªåŠ¨ç”Ÿæˆå½“å‰è¿™ä¸ªç‰ˆæœ¬çš„ CHANGELOGã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œä¸ç”¨æ¯æ¬¡è¾“å…¥å‚æ•°ï¼Œå¯ä»¥é…ç½®åœ¨ <code>lerna.json</code>ä¸­ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;packages&quot;: [    &quot;packages&#x2F;*&quot;  ],  &quot;command&quot;: &#123;    &quot;bootstrap&quot;: &#123;      &quot;hoist&quot;: true    &#125;,    &quot;version&quot;: &#123;      &quot;conventionalCommits&quot;: true    &#125;  &#125;,  &quot;ignoreChanges&quot;: [    &quot;**&#x2F;*.md&quot;  ],  &quot;version&quot;: &quot;0.0.1-alpha.1&quot;&#125;</code></pre><p><code>lerna version</code> ä¼šæ£€æµ‹ä»ä¸Šä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒä»¥æ¥çš„å˜åŠ¨ï¼Œä½†æœ‰ä¸€äº›æ–‡ä»¶çš„æäº¤ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è§¦å‘ç‰ˆæœ¬çš„å˜åŠ¨ï¼Œè­¬å¦‚ .md æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå¹¶æ²¡æœ‰å®é™…å¼•èµ· package é€»è¾‘çš„å˜åŒ–ï¼Œä¸åº”è¯¥è§¦å‘ç‰ˆæœ¬çš„å˜æ›´ã€‚å¯ä»¥é€šè¿‡ <code>ignoreChanges</code> é…ç½®æ’é™¤ã€‚å¦‚ä¸Šã€‚<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS84LzE4LzE2Y2EyYTM3NTQwN2Y0MzY"></p><p>å®é™… <code>lerna version</code>å¾ˆå°‘ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåŒ…å«åœ¨ <code>lerna publish</code> ä¸­äº†ï¼Œç›´æ¥ä½¿ç”¨ <code>lerna publish</code>å°±å¥½äº†ã€‚</p><p>3.4 å®Œå–„çš„æµ‹è¯•ç”¨ä¾‹<br>monorepoé¡¹ç›®ï¼šæµ‹è¯•æœ‰ä¸¤ç§æ–¹å¼</p><ul><li><p>ä½¿ç”¨ç»Ÿä¸€çš„jestæµ‹è¯•é…ç½®è¿™æ ·æ–¹ä¾¿å…¨å±€çš„è·‘jestå³å¯ï¼Œå¥½å¤„æ˜¯å¯ä»¥æ–¹ä¾¿ç»Ÿè®¡æ‰€æœ‰ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡ï¼Œåå¤„æ˜¯å¦‚æœpackageæ¯”è¾ƒå¼‚æ„ï¼ˆå¦‚å°ç¨‹åºï¼Œå‰ç«¯ï¼Œnode æœåŠ¡ç«¯ç­‰ï¼‰ï¼Œç»Ÿä¸€çš„æµ‹è¯•é…ç½®ä¸å¤ªå¥½ç¼–å†™</p></li><li><p>æ¯ä¸ªpackageå•ç‹¬æ”¯æŒtestå‘½ä»¤ï¼Œä½¿ç”¨yarn workspace run testï¼Œåå¤„æ˜¯ä¸å¥½ç»Ÿä¸€æ”¶é›†æ‰€æœ‰ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡</p></li></ul><p>å¦‚æœé‡‡ç”¨jestç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæ”¯æŒtypescriptçš„è¯ï¼Œéœ€è¦åˆå§‹åŒ–é…ç½®jest.config.jsï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">module.exports &#x3D; &#123;  preset: &#39;ts-jest&#39;,  moduleFileExtensions: [&#39;ts&#39;],  testEnvironment: &#39;node&#39;&#125;</code></pre><p>4 å®è·µæ€»ç»“<br>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå·²ç»æ„å»ºäº†åŸºäºlernaå’Œyarn workspaceçš„monorepoé¡¹ç›®çš„æœ€ä½³å®è·µäº†ï¼Œè¯¥æœ‰çš„åŠŸèƒ½éƒ½æœ‰ï¼š</p><ul><li><p>å®Œå–„çš„å·¥ä½œæµ</p></li><li><p>typescriptæ”¯æŒ</p></li><li><p>é£æ ¼ç»Ÿä¸€çš„ç¼–ç </p></li><li><p>å®Œæ•´çš„å•å…ƒæµ‹è¯•</p></li><li><p>ä¸€é”®å¼çš„å‘å¸ƒæœºåˆ¶</p></li><li><p>å®Œç¾çš„æ›´æ–°æ—¥å¿—</p></li></ul><p>â€¦â€¦</p><p>å½“ç„¶ï¼Œæ„å»ºä¸€å¥—å®Œå–„çš„ä»“åº“ç®¡ç†æœºåˆ¶ï¼Œå¯èƒ½å®ƒçš„æ”¶ç›Šä¸æ˜¯ä¸€äº›é‡åŒ–çš„æŒ‡æ ‡å¯ä»¥è¡¡é‡å‡ºæ¥çš„ï¼Œä¹Ÿæ²¡æœ‰ç›´æ¥çš„ä»·å€¼è¾“å‡ºï¼Œä½†å®ƒèƒ½åœ¨æ—¥å¸¸çš„å·¥ä½œä¸­æå¤§çš„æé«˜å·¥ä½œæ•ˆç‡ï¼Œè§£æ”¾ç”Ÿäº§åŠ›ï¼ŒèŠ‚çœå¤§é‡çš„äººåŠ›æˆæœ¬ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/i10630226/article/details/99702447">lerna+yarn workspace+monorepoé¡¹ç›®çš„æœ€ä½³å®è·µ</a><br><a href="https://www.jianshu.com/p/c10d0b8c5581">5åˆ†é’Ÿææ‡‚Monorepo</a><br><a href="https://www.easemob.com/news/5948">2021å¹´ç®¡ç†Monorepoä»£ç åº“çš„11ç§å‡ºè‰²å·¥å…·</a></p>]]></content>
      
      
      <categories>
          
          <category> npm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> npm </tag>
            
            <tag> monorepo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ ‡ï¼ˆBeacon ï¼‰</title>
      <link href="//post/2022-05-23beacon.html"/>
      <url>//post/2022-05-23beacon.html</url>
      
        <content type="html"><![CDATA[<h2 id="Beacon-ç‰¹ç‚¹"><a href="#Beacon-ç‰¹ç‚¹" class="headerlink" title="Beacon  ç‰¹ç‚¹"></a>Beacon  ç‰¹ç‚¹</h2><ul><li>æ¥å£ç”¨äºå°†<em>å¼‚æ­¥</em>å’Œ<em>éé˜»å¡</em>è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚</li><li>è¯·æ±‚ä½¿ç”¨HTTPåè®®ä¸­çš„POSTæ–¹æ³•ï¼Œè¯·æ±‚é€šå¸¸<em>ä¸éœ€è¦å“åº”</em>ã€‚</li><li>è¿™ä¸ªè¯·æ±‚è¢«ä¿è¯åœ¨ï¼Œé¡µé¢çš„unloadçŠ¶æ€ä»å‘èµ·åˆ°å®Œæˆä¹‹å‰ï¼Œè¢«å‘é€ã€‚è€Œå¹¶ä¸éœ€è¦ä¸€ä¸ªé˜»å¡è¯·æ±‚ï¼Œä¾‹å¦‚ XMLHttpRequest ã€‚<h2 id="Beacon-åœºæ™¯"><a href="#Beacon-åœºæ™¯" class="headerlink" title="Beacon  åœºæ™¯"></a>Beacon  åœºæ™¯</h2>å‘é€å¼‚æ­¥éé˜»å¡æ•°æ®åˆ°æœåŠ¡ç«¯<h2 id="ä¸ºä»€ä¹ˆæ˜¯ä¿¡æ ‡ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ˜¯ä¿¡æ ‡ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ä¿¡æ ‡ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ˜¯ä¿¡æ ‡ï¼Ÿ</h2>Beacon æ¥å£æ»¡è¶³äº†<em>åˆ†æ</em>å’Œ<em>è¯Šæ–­ä»£ç </em>çš„éœ€è¦ï¼Œè¿™äº›ä»£ç é€šå¸¸ä¼šå°è¯•åœ¨<em>å¸è½½æ–‡æ¡£ä¹‹å‰å°†æ•°æ®å‘é€åˆ° webæœåŠ¡å™¨</em>ã€‚å‘é€æ•°æ®çš„ä»»ä½•è¿‡æ—©æ—¶æœºéƒ½å¯èƒ½å¯¼è‡´é”™å¤±æ”¶é›†æ•°æ®çš„æœºä¼šã€‚ä½†æ˜¯ï¼Œç¡®ä¿åœ¨å¸è½½æ–‡æ¡£æœŸé—´å‘é€æ•°æ®æ˜¯å¼€å‘äººå‘˜éš¾ä»¥åšåˆ°çš„ã€‚</li></ul><p>ç”¨æˆ·ä»£ç†é€šå¸¸ä¼šå¿½ç•¥å¸è½½æ–‡æ¡£å¤„ç†ç¨‹åºä¸­çš„å¼‚æ­¥ XMLHttpRequests è¯·æ±‚ã€‚è‹¥è¦è§£å†³æ­¤é—®é¢˜ï¼Œä¸ºäº†åˆ†æå’Œè¯Šæ–­ä»£ç ï¼Œé€šå¸¸ä¼šåœ¨ unload (en-US) äº‹ä»¶æˆ– beforeunload (en-US) äº‹ä»¶ä¸­åˆ›å»ºåŒæ­¥ XMLHttpRequest è¯·æ±‚ä»¥æäº¤æ•°æ®ã€‚åŒæ­¥ XMLHttpRequest è¯·æ±‚å¼ºåˆ¶æµè§ˆå™¨å»¶è¿Ÿå¸è½½æ–‡æ¡£ï¼Œå¹¶ä½¿ä¸‹ä¸€ä¸ªé¡µé¢è·³è½¬çœ‹èµ·æ¥è¾ƒæ…¢ã€‚ä¸‹ä¸€é¡µé¢æ²¡æœ‰ä»»ä½•åŠæ³•æ¥é¿å…è¿™ç§é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½³çš„æ„Ÿè§‰ã€‚</p><h2 id="å…¶ä»–æŠ€æœ¯"><a href="#å…¶ä»–æŠ€æœ¯" class="headerlink" title="å…¶ä»–æŠ€æœ¯"></a>å…¶ä»–æŠ€æœ¯</h2><p>å…¶ä¸­ä¸€ç§æŠ€æœ¯æ˜¯é€šè¿‡åˆ›å»º Image å…ƒç´ å¹¶åœ¨å¸è½½æ–‡æ¡£å¤„ç†ç¨‹åºä¸­è®¾ç½®å…¶ src å±æ€§æ¥å»¶è¿Ÿå¸è½½ä»¥æäº¤æ•°æ®ã€‚ç”±äºå¤§å¤šæ•°ç”¨æˆ·ä»£ç†ä¼šå»¶è¿Ÿæ–‡æ¡£å¸è½½ï¼Œä»¥å®ŒæˆæŒ‚èµ·çš„å›¾ç‰‡åŠ è½½ï¼Œå› æ­¤å¯ä»¥åœ¨å¸è½½è¿‡ç¨‹ä¸­æäº¤æ•°æ®ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨å¸è½½å¤„ç†ç¨‹åºä¸­åˆ›å»ºä¸€ä¸ªæ— æ“ä½œå¾ªç¯ï¼ŒèŠ±è´¹æ•°ç§’ä»¥å»¶è¿Ÿå¸è½½å¹¶å°†æ•°æ®æäº¤åˆ°æœåŠ¡å™¨ã€‚</p><p>ä½†æ˜¯ä¸Šè¿°æŠ€æœ¯ä¸ä»…ä»£è¡¨äº†è¾ƒå·®çš„ç¼–ç æ¨¡å¼ï¼Œå…¶ä¸­ä¸€äº›è¿˜æ˜¯ä¸å¯é çš„ï¼Œä¼šå¯¼è‡´ä¸‹ä¸€ä¸ªå¯¼èˆªçš„é¡µé¢åŠ è½½æ€§èƒ½è¾ƒå·®çš„æ„Ÿè§‰ã€‚ä¿¡æ ‡ API æä¾›äº†è§£å†³è¿™äº›é—®é¢˜çš„æ ‡å‡†æ–¹æ³•ã€‚</p><h2 id="å…¨å±€ç¯å¢ƒ"><a href="#å…¨å±€ç¯å¢ƒ" class="headerlink" title="å…¨å±€ç¯å¢ƒ"></a>å…¨å±€ç¯å¢ƒ</h2><p>Beacon API çš„ Navigator.sendBeacon() æ–¹æ³•ç”¨äºåœ¨å…¨å±€æµè§ˆä¸Šä¸‹æ–‡ä¸­å‘æœåŠ¡å™¨å‘é€æ•°æ®ä¿¡æ ‡ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒURLå’Œè¦åœ¨è¯·æ±‚ä¸­å‘é€çš„æ•°æ®dataã€‚dataå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå…¶ç±»å‹å¯ä»¥æ˜¯ ArrayBufferViewã€Blobã€DOMString æˆ–FormDataã€‚å¦‚æœæµè§ˆå™¨æˆåŠŸçš„ä»¥é˜Ÿåˆ—å½¢å¼æ’åˆ—äº†ç”¨äºä¼ é€’çš„è¯·æ±‚ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›â€œtrueâ€ï¼Œå¦åˆ™è¿”å›â€œfalseâ€ã€‚</p><h2 id="ç”Ÿäº§ç¯å¢ƒ"><a href="#ç”Ÿäº§ç¯å¢ƒ" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒ"></a>ç”Ÿäº§ç¯å¢ƒ</h2><p>Beacon APIçš„ WorkerNavigator.sendBeacon() æ–¹æ³•ç”¨äºä» worker global scope å‘æœåŠ¡å™¨å‘é€æ•°æ®ä¿¡æ ‡ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒURLå’Œè¦åœ¨è¯·æ±‚ä¸­å‘é€çš„æ•°æ®dataã€‚dataå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå…¶ç±»å‹å¯ä»¥æ˜¯ ArrayBufferViewã€Blobã€DOMString æˆ– FormDataã€‚å¦‚æœæµè§ˆå™¨æˆåŠŸçš„ä»¥é˜Ÿåˆ—å½¢å¼æ’åˆ—äº†ç”¨äºä¼ é€’çš„è¯·æ±‚ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›â€œtrueâ€ï¼Œå¦åˆ™è¿”å›â€œfalseâ€ã€‚</p><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul><li>API æä¾›äº†è§£å†³è¿™äº›é—®é¢˜çš„æ ‡å‡†æ–¹æ³•</li></ul><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><ul><li>æµè§ˆå™¨å…¼å®¹æ€§<br>Navigator.sendBeacon().Browser_compatibilityè¡¨è¯´æ˜äº†è¯¥æ–¹æ³•å…·æœ‰ç›¸å¯¹å¹¿æ³›åœ°å®ç°ã€‚ä½†æ˜¯ï¼ŒWorkerNavigator.sendBeacon().Browser_compatibilityæ•°æ®æ˜¾ç¤ºè¯¥æ–¹æ³•æ²¡æœ‰è¢«å®ç°ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµè§ˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flutter Bruno</title>
      <link href="//post/2022-05-20fluter-bruno.html"/>
      <url>//post/2022-05-20fluter-bruno.html</url>
      
        <content type="html"><![CDATA[<h1 id="Bruno"><a href="#Bruno" class="headerlink" title="Bruno"></a>Bruno</h1><p><img src="http://t-blog-images.aijs.top/img/20220520105610.webp"><br>Bruno æ˜¯ç”±è´å£³ã€Œç”¨æˆ·ä½“éªŒä¸­å¿ƒ &amp; ç§»åŠ¨ç«¯ä½œä¸šç»„ã€è”åˆæ‰“é€ çš„ä¸€å¥—ä¼ä¸šçº§ç§»åŠ¨ç«¯ Flutter ç»„ä»¶åº“ï¼Œäº 12 æœˆ 10 æ—¥æ­£å¼å¼€æº:</p><p><a href="https://bruno.ke.com/">å®˜ç½‘</a></p><p><a href="https://pub.flutter-io.cn/packages/bruno">Pub åœ°å€</a></p><p><a href="https://github.com/LianjiaTech/bruno">GitHub ä»“åº“</a></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>è´å£³è‡ª 2018 å¹´åº•å¼€å§‹å¯¹ Flutter çš„æ¢ç´¢å’Œå®è·µï¼ŒFlutter è½åœ°ä¸šåŠ¡æœ‰æ•ˆåœ°æå‡äº†äº§ç ”æ•ˆç‡ã€‚ä½†è·¨ä¸šåŠ¡çº¿ååŒæ•ˆç‡è¾ƒä½ï¼Œé‡å¤åŠ³åŠ¨åŠ›å¤§ï¼Œä»£ç ç»´æŠ¤æˆæœ¬é«˜ç­‰é—®é¢˜ä¾æ—§å‡¸æ˜¾ã€‚Bruno æ˜¯è´å£³é’ˆå¯¹ä¸Šè¿°é—®é¢˜åœ¨å…¬å¸å†…å‘èµ·çš„ææ•ˆä¸“é¡¹ï¼Œè‡´åŠ›äºæ‰“é€ è´å£³æ ‡å‡† Flutter ç”Ÿæ€ã€‚ç»è¿‡ä¸¤å¹´çš„æ‰“ç£¨å’Œæ²‰æ·€ï¼ŒBruno ç°å·²æœåŠ¡è´å£³ B ç«¯å…¨çº¿ä¸šåŠ¡ï¼Œæ¶µç›– 30 å¤šç§ç±»å‹ 100+  ç»„ä»¶ï¼Œä¸ºè¿‘ 18 ä¸ª App æœåŠ¡ï¼Œæ–°å¢é¡µé¢ç»„ä»¶è¦†ç›–ç‡å¹³å‡è¾¾åˆ° 80% ä»¥ä¸Šã€‚</p><p>ç›¸ä¿¡è´å£³é‡åˆ°çš„é—®é¢˜ä¹Ÿæ˜¯å¤§å‹å›¢é˜Ÿæˆ–è€…ä¸ªäººå¼€å‘è€…ä¸å¯é¿å…çš„é—®é¢˜ï¼Œç›®å‰é’ˆå¯¹è¯¥ç±»é—®é¢˜çš„ä¸­åå°è§£å†³æ–¹æ¡ˆå±‚å‡ºä¸ç©·ï¼Œä½†åœ¨ Flutter ç”Ÿæ€ä¸­ç±»ä¼¼æˆç†Ÿè§£å†³æ–¹æ¡ˆåŒ®ä¹ã€‚æˆ‘ä»¬å¸Œæœ›å°†è´å£³åœ¨ Flutter é¢†åŸŸçš„å®è·µç»éªŒå›é¦ˆç»™ç¤¾åŒºï¼Œæ›´åŠ å®Œå–„ Flutter ç”Ÿæ€ï¼Œå› æ­¤ Bruno æ­£å¼å¼€æºã€‚</p><h1 id="è®¾è®¡ç†å¿µ"><a href="#è®¾è®¡ç†å¿µ" class="headerlink" title="è®¾è®¡ç†å¿µ"></a>è®¾è®¡ç†å¿µ</h1><p>Bruno åŸºäºç”Ÿé•¿ã€åŒ…å®¹ã€è”æ¥çš„è®¾è®¡ç†å¿µï¼Œèµ‹äºˆç»„ä»¶è½»å·§çµæ´»ã€æ‹¥æŠ±å˜åŒ–ã€åŒ…å®¹ä¸‡ç‰©çš„å“è´¨ã€‚</p><h1 id="Bruno-çš„ä¼˜åŠ¿"><a href="#Bruno-çš„ä¼˜åŠ¿" class="headerlink" title="Bruno çš„ä¼˜åŠ¿"></a>Bruno çš„ä¼˜åŠ¿</h1><ol><li>é€‚åº¦çµæ´»ã€å……åˆ†å¯æ‰©å±•</li></ol><p>Bruno å€¡å¯¼æ ‡å‡†åŒ–ä¸‹çš„è‡ªç”±ã€ç®€å•ã€çµæ´»ï¼ŒåŸºäº Flutter åŸºç¡€ç»„ä»¶çš„å°è£…ï¼Œä½¿å…¶å…·å¤‡é€‚åº¦çµæ´»ï¼Œä½¿ç”¨ç»„ä»¶ææ•ˆå°¤ä¸ºé‡è¦ã€‚åŒæ—¶ç»„ä»¶æ”¯æŒå……åˆ†å¯æ‰©å±•ï¼Œæ—¢å¯æ»¡è¶³å¤šäº§å“çš„å¿«é€Ÿæ¥å…¥åˆèƒ½åŒ…å®¹ç‰¹æ®Šåœºæ™¯ã€‚</p><p>ç»è¿‡ä¸¤å¹´çš„ä¸šåŠ¡å®è·µï¼Œæˆ‘ä»¬æœ€ç»ˆäº§å‡ºäº† 102 ä¸ªç»„ä»¶ï¼Œè¦†ç›–ç±»å‹æœ‰ å›¾è¡¨ã€å¯¼èˆªã€æ•°æ®å½•å…¥ã€æ“ä½œåé¦ˆã€å†…å®¹å±•ç¤º ç­‰ã€‚</p><p><img src="http://t-blog-images.aijs.top/img/54b2f46cdc6ee8467b67d92d9c0d2d98.gif"><br>2. è¿æ¥è®¾è®¡&lt;â€“&gt;å¼€å‘</p><p>Bruno åŸºäº Sketch MeaXure äºŒæ¬¡å¼€å‘ï¼Œå®ç°ç»„ä»¶è‡ªåŠ¨è¯†åˆ«å’Œæ ‡æ³¨ã€‚å¼€å‘è€…å¯ä»¥ä»è®¾è®¡ä¾§äº§å‡ºçš„æ ‡æ³¨ç¨¿ä¸­æ¸…æ™°çš„çœ‹åˆ°é¡µé¢æ¶µç›–çš„ç»„ä»¶ï¼Œä¿¡æ¯æ— ç¼ä¼ è¾¾ï¼Œé«˜æ•ˆè¿æ¥è®¾è®¡ä¸å¼€å‘ã€‚</p><p><img src="http://t-blog-images.aijs.top/img/a72e4aee43eb8e32589bef23dd95c75d.gif"><br>3. ä¸»é¢˜å®šåˆ¶ã€å“ç‰Œé£æ ¼è‡ªå®šä¹‰</p><p>Bruno ä¸ä»…æ”¯æŒå…¨å±€è‰²å·çš„æ›¿æ¢ï¼Œè¿˜æ”¯æŒç»„ä»¶åœ†è§’ã€å­—ä½“å¤§å°ã€å†…éƒ¨é—´è·ç­‰å±æ€§çš„å®šåˆ¶ã€‚åœ¨å®šåˆ¶å…¨å±€æ ·å¼æ‰“é€ è‡ªæœ‰å“ç‰Œé£æ ¼çš„åŒæ—¶ï¼Œæ”¯æŒå•ä¸ªç»„ä»¶è‡ªå®šä¹‰æ»¡è¶³ç‰¹å¼‚åŒ–åœºæ™¯éœ€æ±‚ã€‚</p><ul><li>é»˜è®¤åŸºç¡€è§„èŒƒ</li></ul><img src="http://t-blog-images.aijs.top/img/20220520105949.webp" style="width:400px;object-fit:contain" /><img src="http://t-blog-images.aijs.top/img/20220520110003.webp" style="width:400px;object-fit:contain" /><ul><li>å…¨å±€æ ·å¼å®šåˆ¶</li></ul><p><img src="http://t-blog-images.aijs.top/img/61dc33d90cd80e88c4a52cccdc713c48.gif"></p><ul><li>å•ç»„ä»¶æ ·å¼å®šåˆ¶</li></ul><p><img src="http://t-blog-images.aijs.top/img/6da0a3d9b63b47e64a127320597900eb.gif"><br>Bruno è¿˜å¯æ”¯æŒå•ä¸šåŠ¡çš„å…¨å±€é…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ æ˜¯ç»„ä»¶åŒ–å·¥ç¨‹ç»“æ„ï¼Œé‚£ä¹ˆä½ å¯ä»¥å®šä¹‰æ¯ä¸ªä¸šåŠ¡ç»„ä»¶çš„ç‰¹æœ‰é£æ ¼ã€‚</p><ol start="4"><li>ç‰©æ–™æ‰¿è½½ã€æ•™ç¨‹æŒ‡å¼•</li></ol><p>Bruno å®˜ç½‘æ‰¿è½½äº§å“è®¾è®¡ç‰©æ–™ã€ç»„ä»¶é…å¥—æ–‡æ¡£ã€Demo ä¸‹è½½ã€æœç´¢ç­‰åŸºç¡€èƒ½åŠ›ï¼ŒåŒæ—¶é…æœ‰æ•™ç¨‹æŒ‡å¼•å¼€å‘ä¹Ÿå¯æ“ä½œ Sketch æ’ä»¶è®¾è®¡é¡µé¢ï¼Œå®ç°é›¶è®¾è®¡èµ„æºä»‹å…¥ã€‚</p><p><img src="http://t-blog-images.aijs.top/img/ea334037633605e094d03338cc151045.gif"><br>Bruno å®˜ç½‘: <a href="https://bruno.ke.com/">https://bruno.ke.com</a></p><h1 id="æœªæ¥å±•æœ›"><a href="#æœªæ¥å±•æœ›" class="headerlink" title="æœªæ¥å±•æœ›"></a>æœªæ¥å±•æœ›</h1><ol><li>ä¸°å¯Œå’Œå®Œå–„ç»„ä»¶</li></ol><p>ç›®å‰ Bruno ç»„ä»¶æ¶µç›–ç§ç±»å¯ä»¥è¦†ç›–å¸¸è§ä½¿ç”¨åœºæ™¯ï¼Œæ»¡è¶³ä¼ä¸šå»ºç«‹è‡ªæœ‰å“ç‰Œå½¢è±¡ App éœ€æ±‚ã€‚æœªæ¥æˆ‘ä»¬ä¼šæ ¹æ®ä¸šåŠ¡å‘å±•å’Œäº§å“å‡çº§ä¸æ–­è¿­ä»£ç»„ä»¶ï¼Œä¸°å¯Œäº§å“å†…å®¹æå‡è§†è§‰ä½“éªŒã€‚</p><ol start="2"><li>æå‡è½åœ°æ•ˆç‡</li></ol><p>æˆ‘ä»¬ä¸æ­¢å…³æ³¨ç»„ä»¶çš„è®¾è®¡ä¸ç ”å‘ï¼Œç»„ä»¶è½åœ°ä¹Ÿæ˜¯æå‡äº§ç ”æ•ˆç‡è‡³å…³é‡è¦çš„ç¯èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬å¯¹ Sketch MeaXure åšäº†äºŒæ¬¡æ”¹é€ ï¼Œå®ç°ç»„ä»¶è‡ªåŠ¨åŒ–æ ‡æ³¨ã€‚åŒæ—¶è´å£³äº§ç ”å›¢é˜ŸæŠŠè‡ªåŠ¨åŒ–æ ‡æ³¨èƒ½åŠ›çº¿ä¸ŠåŒ–ï¼Œè¿›ä¸€æ­¥æå‡ç»„ä»¶è½åœ°æ•ˆç‡ã€‚</p><p>3ã€UI è‡ªåŠ¨åŒ–èµ°æŸ¥</p><p>è´å£³äº§ç ”å›¢é˜Ÿä¹Ÿåœ¨æ¢ç´¢ UI è‡ªåŠ¨åŒ–èµ°æŸ¥æ–¹å‘ï¼ŒæœŸæœ›è§£æ”¾è®¾è®¡ä¾§èµ°æŸ¥äººåŠ›ï¼Œè®©è®¾è®¡å¸ˆæ›´å¤šæŠ•å…¥å¯¹äº§å“çš„æ´å¯Ÿç†è§£ï¼Œåˆ›é€ ä¼˜è´¨è®¾è®¡ï¼Œæå‡è§†è§‰ä½“éªŒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> flutter </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> flutter </tag>
            
            <tag> mobile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npmå¼€å‘wikiç¼–è¾‘å™¨é—®é¢˜æ€»ç»“</title>
      <link href="//post/2022-05-19npm-pkg.html"/>
      <url>//post/2022-05-19npm-pkg.html</url>
      
        <content type="html"><![CDATA[<h2 id="åŸæ¶æ„"><a href="#åŸæ¶æ„" class="headerlink" title="åŸæ¶æ„"></a>åŸæ¶æ„</h2><p><img src="http://t-blog-images.aijs.top/img/wiki-ui.webp"></p><h2 id="é‡æ„å"><a href="#é‡æ„å" class="headerlink" title="é‡æ„å"></a>é‡æ„å</h2><p><img src="http://t-blog-images.aijs.top/img/slate-wiki.webp"></p><h2 id="tsconfig-ts"><a href="#tsconfig-ts" class="headerlink" title="tsconfig.ts"></a>tsconfig.ts</h2><pre class="line-numbers language-none"><code class="language-none">&#123;  &#x2F;&#x2F; ç¼–è¯‘é€‰é¡¹  &quot;compilerOptions&quot;: &#123;    &#x2F;&#x2F; ç”Ÿæˆä»£ç çš„è¯­è¨€ç‰ˆæœ¬ï¼šå°†æˆ‘ä»¬å†™çš„ TS ä»£ç ç¼–è¯‘æˆå“ªä¸ªç‰ˆæœ¬çš„ JS ä»£ç     &quot;target&quot;: &quot;es5&quot;,    &#x2F;&#x2F; æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„ library    &#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;microsoft&#x2F;TypeScript&#x2F;blob&#x2F;90e83adb44&#x2F;lib&#x2F;lib.dom.iterable.d.ts    &quot;lib&quot;: [&quot;dom&quot;, &quot;dom.iterable&quot;, &quot;esnext&quot;],    &#x2F;&#x2F; å…è®¸ ts ç¼–è¯‘å™¨ç¼–è¯‘ js æ–‡ä»¶    &quot;allowJs&quot;: true,    &#x2F;&#x2F; è·³è¿‡ç±»å‹å£°æ˜æ–‡ä»¶çš„ç±»å‹æ£€æŸ¥    &quot;skipLibCheck&quot;: true,    &#x2F;&#x2F; es æ¨¡å— äº’æ“ä½œï¼Œå±è”½ ESModule å’Œ CommonJS ä¹‹é—´çš„å·®å¼‚    &quot;esModuleInterop&quot;: true,    &#x2F;&#x2F; å…è®¸é€šè¿‡ import x from &#39;y&#39; å³ä½¿æ¨¡å—æ²¡æœ‰æ˜¾å¼æŒ‡å®š default å¯¼å‡º    &quot;allowSyntheticDefaultImports&quot;: true,    &#x2F;&#x2F; å¼€å¯ä¸¥æ ¼æ¨¡å¼    &quot;strict&quot;: true,    &#x2F;&#x2F; å¯¹æ–‡ä»¶åç§°å¼ºåˆ¶åŒºåˆ†å¤§å°å†™    &quot;forceConsistentCasingInFileNames&quot;: true,    &#x2F;&#x2F; ä¸º switch è¯­å¥å¯ç”¨é”™è¯¯æŠ¥å‘Š    &quot;noFallthroughCasesInSwitch&quot;: true,    &#x2F;&#x2F; ç”Ÿæˆä»£ç çš„æ¨¡å—åŒ–æ ‡å‡†    &quot;module&quot;: &quot;esnext&quot;,    &#x2F;&#x2F; æ¨¡å—è§£æï¼ˆæŸ¥æ‰¾ï¼‰ç­–ç•¥    &quot;moduleResolution&quot;: &quot;node&quot;,    &#x2F;&#x2F; å…è®¸å¯¼å…¥æ‰©å±•åä¸º.jsonçš„æ¨¡å—    &quot;resolveJsonModule&quot;: true,    &#x2F;&#x2F; æ˜¯å¦å°†æ²¡æœ‰ import&#x2F;export çš„æ–‡ä»¶è§†ä¸ºæ—§ï¼ˆå…¨å±€è€Œéæ¨¡å—åŒ–ï¼‰è„šæœ¬æ–‡ä»¶    &quot;isolatedModules&quot;: true,    &#x2F;&#x2F; ç¼–è¯‘æ—¶ä¸ç”Ÿæˆä»»ä½•JSæ–‡ä»¶ï¼ˆåªè¿›è¡Œç±»å‹æ£€æŸ¥ï¼‰    &quot;noEmit&quot;: true,    &#x2F;&#x2F; æŒ‡å®šå°† JSX ç¼–è¯‘æˆä»€ä¹ˆå½¢å¼    &quot;jsx&quot;: &quot;react-jsx&quot;  &#125;,  &#x2F;&#x2F; æŒ‡å®šå…è®¸ ts å¤„ç†çš„ç›®å½•  &quot;include&quot;: [&quot;src&quot;]&#125;&#x2F;&#x2F; https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_62118859&#x2F;article&#x2F;details&#x2F;124543485</code></pre><h2 id="Cannot-read-properties-of-null"><a href="#Cannot-read-properties-of-null" class="headerlink" title="Cannot read properties of null"></a>Cannot read properties of null</h2><pre class="line-numbers language-none"><code class="language-none">react.development.js:1621 Uncaught TypeError: Cannot read properties of null</code></pre><hr/><h2 id="ahooks-ç‰ˆæœ¬"><a href="#ahooks-ç‰ˆæœ¬" class="headerlink" title="ahooks  ç‰ˆæœ¬"></a>ahooks  ç‰ˆæœ¬</h2><ol><li><p>useControlledValue</p><pre class="line-numbers language-none"><code class="language-none">Uncaught SyntaxError: The requested module &#39;&#x2F;node_modules&#x2F;.vite&#x2F;deps&#x2F;ahooks.js?v&#x3D;a7b43f7a&#39; does not provide an export named &#39;useControlledValue&#39; (at index.tsx:2:1)</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Deprecated the useControlledValue naming left over from 1.0, please use useControllableValue instead<br><a href="https://github.com/alibaba/hooks/releases?page=5#:~:text=Deprecated%20the%20useControlledValue%20naming%20left%20over%20from%201.0%2C%20please%20use%20useControllableValue%20instead"><a href="https://github.com/alibaba/hooks/releases/tag/v3.0.0-alpha.4">v3.0.0-alpha.4</a></a></p></blockquote></li><li><p>useRequest</p></li></ol><pre class="line-numbers language-none"><code class="language-none">react_devtools_backend.js:4026 Warning: Failed prop type: The prop &#96;loadMore&#96; is marked as required in &#96;InfiniteScroll&#96;, but its value is &#96;undefined&#96;.</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Removed loadMore related attributes, it is recommended to use useInfiniteScroll to achieve unlimited loading capacity.<br><a href="https://github.com/alibaba/hooks/releases/tag/v3.0.0-alpha.4">v3.0.0-alpha.4</a></p></blockquote><p><a href="http://quanzhan.applemei.com/webStack/TmpJeE1BPT0=">é™¤äº† dependencies å’Œ devDependenciesï¼Œå…¶ä»–çš„ä¾èµ–æœ‰ä»€ä¹ˆä½œç”¨å‘¢</a></p><pre class="line-numbers language-none"><code class="language-none">Pre-bundling dependencies:reactrecoilreact-domreact-router-domantd(...and 29 more)</code></pre><h3 id="æœ¬åœ°npm-linkå¤„ç†ä¸äº†ä¾èµ–å†²çª"><a href="#æœ¬åœ°npm-linkå¤„ç†ä¸äº†ä¾èµ–å†²çª" class="headerlink" title="æœ¬åœ°npm linkå¤„ç†ä¸äº†ä¾èµ–å†²çª"></a>æœ¬åœ°<code>npm link</code>å¤„ç†ä¸äº†ä¾èµ–å†²çª</h3><ul><li>è€ç‰ˆæœ¬å¯ä»¥è¿è¡Œ</li></ul><p><img src="http://t-blog-images.aijs.top/img/20220519183558.webp"></p><ul><li>æ–°ç‰ˆæœ¬æŠ¥é”™</li><li>åŸå›  ahooks^3.x.xæ²¡æœ‰v2ç‰ˆæœ¬api</li></ul><hr/><h3 id="å‘å¸ƒå®‰è£…åˆ°é¡¹ç›®ä¸­æµ‹è¯•"><a href="#å‘å¸ƒå®‰è£…åˆ°é¡¹ç›®ä¸­æµ‹è¯•" class="headerlink" title="å‘å¸ƒå®‰è£…åˆ°é¡¹ç›®ä¸­æµ‹è¯•"></a>å‘å¸ƒå®‰è£…åˆ°é¡¹ç›®ä¸­æµ‹è¯•</h3><ul><li>å‘å¸ƒ</li></ul><ol><li><p>npm è„šæœ¬</p><pre class="line-numbers language-none"><code class="language-none">&quot;scripts&quot;: &#123;    &quot;dev&quot;: &quot;vite --port 3004&quot;,    &quot;start&quot;: &quot;yarn build:css &amp;&amp; webpack serve --config config&#x2F;webpack.dev.config.js&quot;,    &quot;copy:css&quot;: &quot;cp src&#x2F;**&#x2F;*.css dist&#x2F; &amp;&amp; rsync src&#x2F;styles&#x2F;*.css dist&#x2F;styles&#x2F;&quot;,    &quot;build&quot;: &quot;tsc&quot;,    &quot;build:css&quot;: &quot;node-sass src&#x2F; -o src&#x2F; &quot;,    &quot;prepublishOnly&quot;: &quot;rm -rf dist&#x2F; &amp;&amp; yarn build &amp;&amp; yarn build:css &amp;&amp; yarn copy:css&quot;,    &quot;t&quot;: &quot;rm -rf dist&#x2F; &amp;&amp; yarn build &amp;&amp; yarn build:css &amp;&amp; yarn copy:css&quot;,    &quot;push:beta&quot;: &quot;npm publish --tag beta&quot;  &#125;,</code></pre></li><li><p>æ‰§è¡Œè„šæœ¬<br><code>$ yarn push:beta</code></p></li><li><p>å‘å¸ƒç»“æœ</p></li></ol><pre class="line-numbers language-none"><code class="language-none">## Current Tags*   [0.0.1Â ](https:&#x2F;&#x2F;tnpm.ty-inc.top&#x2F;package&#x2F;@ty-fe&#x2F;slate-wiki-pro&#x2F;v&#x2F;0.0.1)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â  ... Â Â Â Â Â Â Â Â Â Â betaÂ (a few seconds ago)*   [0.0.1Â ](https:&#x2F;&#x2F;tnpm.ty-inc.top&#x2F;package&#x2F;@ty-fe&#x2F;slate-wiki-pro&#x2F;v&#x2F;0.0.1)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â  ... Â Â Â Â Â Â Â Â Â Â latestÂ (a few seconds ago)</code></pre><p><img src="http://t-blog-images.aijs.top/img/20220519183625.webp"><br><img src="http://t-blog-images.aijs.top/img/20220519183638.webp"></p><hr/><h2 id="å›¾ç‰‡æ²¡æœ‰æ¸²æŸ“ï¼Œä¿®æ”¹ï¼Œæ‰“åŒ…é‡æ–°å‘å¸ƒ0-0-1-220519betaç‰ˆæœ¬æµ‹è¯•"><a href="#å›¾ç‰‡æ²¡æœ‰æ¸²æŸ“ï¼Œä¿®æ”¹ï¼Œæ‰“åŒ…é‡æ–°å‘å¸ƒ0-0-1-220519betaç‰ˆæœ¬æµ‹è¯•" class="headerlink" title="å›¾ç‰‡æ²¡æœ‰æ¸²æŸ“ï¼Œä¿®æ”¹ï¼Œæ‰“åŒ…é‡æ–°å‘å¸ƒ0.0.1-220519betaç‰ˆæœ¬æµ‹è¯•"></a>å›¾ç‰‡æ²¡æœ‰æ¸²æŸ“ï¼Œä¿®æ”¹ï¼Œæ‰“åŒ…é‡æ–°å‘å¸ƒ<code>0.0.1-220519beta</code>ç‰ˆæœ¬æµ‹è¯•</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">slate-wiki@0.0.1-220519betanpm notice &#x3D;&#x3D;&#x3D; Tarball Details &#x3D;&#x3D;&#x3D; npm notice name:          @ty-fe&#x2F;slate-wiki                     npm notice version:       0.0.1-220519beta                        npm notice filename:      @ty-fe&#x2F;slate-wiki-0.0.1-220519beta.tgznpm notice package size:  228.0 kB                                npm notice unpacked size: 1.2 MB                                  npm notice shasum:        a2991de4933a9e5039ceb7082c5e0a80c2db828cnpm notice integrity:     sha512-iHQKpR2LM+F6Z[...]XDN40tHfwMxNg&#x3D;&#x3D;npm notice total files:   417                                     npm notice + @ty-fe&#x2F;slate-wiki@0.0.1-220519betaâœ¨  Done in 16.36s.slate-wiki-pro@0.0.1-220519betanpm notice &#x3D;&#x3D;&#x3D; Tarball Details &#x3D;&#x3D;&#x3D; npm notice name:          @ty-fe&#x2F;slate-wiki-pro                     npm notice version:       0.0.1-220519beta                            npm notice filename:      @ty-fe&#x2F;slate-wiki-pro-0.0.1-220519beta.tgznpm notice package size:  83.5 kB                                     npm notice unpacked size: 413.7 kB                                    npm notice shasum:        85cbe6fbffafc75db16e02427d1eac9b6a906ec3    npm notice integrity:     sha512-3viVco6ssb2N3[...]xxisHN9+qYnCA&#x3D;&#x3D;    npm notice total files:   205                                         npm notice + @ty-fe&#x2F;slate-wiki-pro@0.0.1-220519betaâœ¨  Done in 14.68s.</code></pre><hr/><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ol><li>ä¼ æŸ“æ€§<br>slate-wiki-pro,ä¾èµ–äºslate-wikiã€‚slate-wikiæ”¹åŠ¨ï¼Œé¡¹ç›®ä¾èµ–slate-wiki-proï¼Œéœ€è¦å‘slate-wikiå’Œslate-wiki-proï¼Œé¡¹ç›®è¦å®‰è£…slate-wiki-pro</li></ol><p><code>æ˜¯å¦å¯ä»¥è®©é¡¹ç›®ç›´æ¥ä¾èµ–slate-wikiã€slate-wiki-proæ”¹åŠ¨å“ªä¸ªå‘å¸ƒå“ªä¸ªï¼Œäº’ä¸å½±å“ï¼Ÿ</code></p><ol start="2"><li>é¡¹ç›®å¾ˆå¡</li></ol><p><code>å°†slateã€slate-wikiã€slate-wiki-proä½¿ç”¨umdèµ„æºï¼Œé¿å…é‡å¤ç¼–è¯‘æ˜¯å¦å¯ä»¥ï¼Ÿ</code></p><ol start="3"><li>ä¾èµ–è´¼å¤š</li></ol><pre class="line-numbers language-none"><code class="language-none">[######--------------------------------------------------] 49992&#x2F;102014</code></pre><ol start="4"><li>å¯åŠ¨æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¿«äº†</li></ol><p>viteé¢„ç¼–è¯‘æ—¶é—´è¿‡é•¿  130262ms &#x2F; 1000 &#x2F; 60 å¤§æ¦‚ä¸¤åˆ†é’Ÿï¼ŒåŠ è½½ç¼–è¯‘å¤§æ¦‚å‡ åˆ†é’Ÿï¼Œæ…¢çš„å“äºº</p><pre class="line-numbers language-none"><code class="language-none">vite v2.7.1 dev server running at:&gt; Local: http:&#x2F;&#x2F;localhost:3005&#x2F;&gt; Network: use &#96;--host&#96; to exposeready in 130262ms.  #é¦–æ¬¡ç¼–è¯‘vite v2.7.1 dev server running at:&gt; Local: http:&#x2F;&#x2F;localhost:3005&#x2F;&gt; Network: use &#96;--host&#96; to exposeready in 43312ms. #éé¦–æ¬¡ç¼–è¯‘</code></pre><hr/><h2 id="ä»£ç æ”¾ä»“åº“"><a href="#ä»£ç æ”¾ä»“åº“" class="headerlink" title="ä»£ç æ”¾ä»“åº“"></a>ä»£ç æ”¾ä»“åº“</h2><ul><li>slate-wiki</li></ul><p><img src="http://t-blog-images.aijs.top/img/20220519183700.webp"></p><p>Command line instructions<br>You can also upload existing files from your computer using the instructions below.</p><p>Git global setup</p><pre class="line-numbers language-none"><code class="language-none">git config --global user.name &quot;é™ˆæµ·é¾™&quot;git config --global user.email &quot;haotian.chen@ty.com&quot;</code></pre><p>Create a new repository</p><pre class="line-numbers language-none"><code class="language-none">git clone ssh:&#x2F;&#x2F;git@registry.code.ty-inc.top:10023&#x2F;fe-efficacy&#x2F;slate-wiki.gitcd slate-wikitouch README.mdgit add README.mdgit commit -m &quot;add README&quot;</code></pre><p>Push an existing folder</p><pre class="line-numbers language-none"><code class="language-none">cd existing_foldergit initgit remote add origin ssh:&#x2F;&#x2F;git@registry.code.ty-inc.top:10023&#x2F;fe-efficacy&#x2F;slate-wiki.gitgit add .git commit -m &quot;Initial commit&quot;</code></pre><p>Push an existing Git repository</p><pre class="line-numbers language-none"><code class="language-none">cd existing_repogit remote rename origin old-origingit remote add origin ssh:&#x2F;&#x2F;git@registry.code.ty-inc.top:10023&#x2F;fe-efficacy&#x2F;slate-wiki.git</code></pre><ul><li>slate-wiki-pro<br>ç•¥<hr/></li></ul><p>æ·±å…¥äº†è§£æ‰“åŒ…ï¼Œæœ¬ç«™è¯·æœ<a href="https://v.aijs.top/post/2022-05-19npm"><code>npm ç‰ˆæœ¬çš„ä¾èµ–</code></a></p><h2 id="react-codemirrorä½¿ç”¨ç‰ˆæœ¬react16-æ’ä»¶åŠé¡¹ç›®ä½¿ç”¨react18"><a href="#react-codemirrorä½¿ç”¨ç‰ˆæœ¬react16-æ’ä»¶åŠé¡¹ç›®ä½¿ç”¨react18" class="headerlink" title="react-codemirrorä½¿ç”¨ç‰ˆæœ¬react16,æ’ä»¶åŠé¡¹ç›®ä½¿ç”¨react18"></a>react-codemirrorä½¿ç”¨ç‰ˆæœ¬react16,æ’ä»¶åŠé¡¹ç›®ä½¿ç”¨react18</h2><pre class="line-numbers language-none"><code class="language-none">react-dom.development.js:22738 Uncaught TypeError: cm is not a function    at UnControlled.componentDidMount (react-codemirror.tsx:718:19)    at commitLayoutEffectOnFiber (react-dom.development.js:23204:30)    at commitLayoutMountEffects_complete (react-dom.development.js:24578:9)    at commitLayoutEffects_begin (react-dom.development.js:24564:7)    at commitLayoutEffects (react-dom.development.js:24502:3)    at commitRootImpl (react-dom.development.js:26779:5)    at commitRoot (react-dom.development.js:26638:5)    at performSyncWorkOnRoot (react-dom.development.js:26073:3)    at flushSyncCallbacks (react-dom.development.js:12009:22)    at flushSyncCallbacksOnlyInLegacyMode (react-dom.development.js:11988:5)</code></pre><p><img src="http://t-blog-images.aijs.top/img/20220520141611.webp"></p><h2 id="vite-å…³äº-global-is-not-defined-é—®é¢˜"><a href="#vite-å…³äº-global-is-not-defined-é—®é¢˜" class="headerlink" title="vite å…³äº global is not defined é—®é¢˜"></a>vite å…³äº global is not defined é—®é¢˜</h2><p><a href="https://github.com/scniro/react-codemirror2/blob/0f2bb13cad2fb1364eb063cbd7ec9aae726a55eb/src/index.tsx#L7">react-codemirror2 æºç </a></p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">declare let global: any;declare let require: any;const SERVER_RENDERED &#x3D; (typeof navigator &#x3D;&#x3D;&#x3D; &#39;undefined&#39; || (typeof global !&#x3D;&#x3D; &#39;undefined&#39; &amp;&amp; global[&#39;PREVENT_CODEMIRROR_RENDER&#39;] &#x3D;&#x3D;&#x3D; true));let cm;if (!SERVER_RENDERED) &#123;  cm &#x3D; require(&#39;codemirror&#39;);&#125;</code></pre><h2 id="vite-404"><a href="#vite-404" class="headerlink" title="vite 404"></a>vite 404</h2><pre class="line-numbers language-none"><code class="language-none">Could not load content for http:&#x2F;&#x2F;localhost:3005&#x2F;node_modules&#x2F;@ty-fe&#x2F;slate-wiki&#x2F;src&#x2F;slate&#x2F;3rd&#x2F;react-codemirror.tsx (HTTP error: status code 404, net::ERR_HTTP_RESPONSE_CODE_FAILURE)</code></pre><h2 id="todo"><a href="#todo" class="headerlink" title="todo"></a>todo</h2><ul><li>codemirror åœ¨viteä¸­è¿è¡ŒæŠ¥é”™ï¼Œcodemirroræ‰¾ä¸åˆ°ï¼Œwebpackæ‰“åŒ…æ­£å¸¸</li></ul>]]></content>
      
      
      <categories>
          
          <category> npm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> npm </tag>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npm ç‰ˆæœ¬çš„ä¾èµ–</title>
      <link href="//post/2022-05-19npm.html"/>
      <url>//post/2022-05-19npm.html</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æèµ· npmï¼Œå¤§å®¶ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„åº”è¯¥å°±æ˜¯ npm install äº†ï¼Œä½†æ˜¯ npm install ä¹‹åç”Ÿæˆçš„ node_modules å¤§å®¶æœ‰è§‚å¯Ÿè¿‡å—ï¼Ÿpackage-lock.json æ–‡ä»¶çš„ä½œç”¨å¤§å®¶çŸ¥é“å—ï¼Ÿé™¤äº† dependencies å’Œ devDependenciesï¼Œå…¶ä»–çš„ä¾èµ–æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæœ¬æ–‡å°†é’ˆå¯¹ npm ä¸­çš„ä½ å¯èƒ½å¿½ç•¥çš„ç»†èŠ‚å’Œå¤§å®¶åˆ†äº«ä¸€äº›ç»éªŒ ã€‚</p><h1 id="npm-å®‰è£…æœºåˆ¶"><a href="#npm-å®‰è£…æœºåˆ¶" class="headerlink" title="npm å®‰è£…æœºåˆ¶"></a>npm å®‰è£…æœºåˆ¶</h1><p>A å’Œ B åŒæ—¶ä¾èµ– Cï¼ŒC è¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼ŸC çš„ç‰ˆæœ¬ç›¸åŒå’Œç‰ˆæœ¬ä¸åŒæ—¶å®‰è£…ä¼šæœ‰ä»€ä¹ˆå·®å¼‚å‘¢ï¼Ÿpackage.json ä¸­åŒ…çš„å‰åé¡ºåºå¯¹äºå®‰è£…æ—¶æœ‰ä»€ä¹ˆå½±å“å—ï¼Ÿè¿™äº›é—®é¢˜å¹³æ—¶å¤§å®¶å¯èƒ½æ²¡æœ‰æ³¨æ„è¿‡ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸€èµ·ç ”ç©¶ä¸€ä¸‹å§ã€‚</p><h2 id="A-å’Œ-B-åŒæ—¶ä¾èµ–-Cï¼Œè¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼Ÿ"><a href="#A-å’Œ-B-åŒæ—¶ä¾èµ–-Cï¼Œè¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼Ÿ" class="headerlink" title="A å’Œ B åŒæ—¶ä¾èµ– Cï¼Œè¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼Ÿ"></a>A å’Œ B åŒæ—¶ä¾èµ– Cï¼Œè¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼Ÿ</h2><p>å‡å¦‚æœ‰ A å’Œ B ä¸¤ä¸ªåŒ…ï¼Œä¸¤ä¸ªåŒ…éƒ½ä¾èµ– C è¿™ä¸ªåŒ…ï¼Œnpm 2 ä¼šä¾æ¬¡é€’å½’å®‰è£… A å’Œ B ä¸¤ä¸ªåŒ…åŠå…¶å­ä¾èµ–åŒ…åˆ° node_modules ä¸­ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° <code>./node_modules</code> è¿™å±‚ç›®å½•åªå«æœ‰è¿™ä¸¤ä¸ªå­ç›®å½•ï¼š</p><pre class="line-numbers language-none"><code class="language-none">node_modules&#x2F; â”œâ”€â”¬ A â”‚ â”œâ”€â”€ C â”œâ”€â”¬ B â”‚ â””â”€â”€ C </code></pre><p>å¦‚æœä½¿ç”¨ npm 3 æ¥è¿›è¡Œå®‰è£…çš„è¯ï¼Œ<code>./node_modules</code> ä¸‹çš„ç›®å½•å°†ä¼šåŒ…å«ä¸‰ä¸ªå­ç›®å½•ï¼š</p><pre class="line-numbers language-none"><code class="language-none">node_modules&#x2F; â”œâ”€â”¬ A â”œâ”€â”¬ B â”œâ”€â”¬ C </code></pre><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„åŒºåˆ«å‘¢ï¼Ÿè¿™å°±è¦ä» npm çš„å·¥ä½œæ–¹å¼è¯´èµ·äº†ï¼š</p><h2 id="npm-2-å’Œ-npm-3-æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚"><a href="#npm-2-å’Œ-npm-3-æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚" class="headerlink" title="npm 2 å’Œ npm 3 æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚"></a>npm 2 å’Œ npm 3 æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚</h2><p>è™½ç„¶ç›®å‰æœ€æ–°çš„ npm ç‰ˆæœ¬æ˜¯ npm 6ï¼Œä½† npm 2 åˆ° npm 3 çš„ç‰ˆæœ¬å˜æ›´ä¸­å®ç°äº†ç›®å½•æ‰“å¹³ï¼Œä¸å…¶ä»–ç‰ˆæœ¬ç›¸æ¯”å·®åˆ«è¾ƒå¤§ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬å…·ä½“çœ‹ä¸‹è¿™ä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚ã€‚</p><p>npm 2 åœ¨å®‰è£…ä¾èµ–åŒ…æ—¶ï¼Œé‡‡ç”¨ç®€å•çš„é€’å½’å®‰è£…æ–¹æ³•ã€‚æ‰§è¡Œ npm install åï¼Œnpm æ ¹æ® dependencies å’Œ devDependencies å±æ€§ä¸­æŒ‡å®šçš„åŒ…æ¥ç¡®å®šç¬¬ä¸€å±‚ä¾èµ–ï¼Œnpm 2 ä¼šæ ¹æ®ç¬¬ä¸€å±‚ä¾èµ–çš„å­ä¾èµ–ï¼Œé€’å½’å®‰è£…å„ä¸ªåŒ…åˆ°å­ä¾èµ–çš„ node_modules ä¸­ï¼Œç›´åˆ°å­ä¾èµ–ä¸å†ä¾èµ–å…¶ä»–æ¨¡å—ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° .&#x2F;node_modules è¿™å±‚ç›®å½•ä¸­åŒ…å«æœ‰æˆ‘ä»¬ package.json æ–‡ä»¶ä¸­æ‰€æœ‰çš„ä¾èµ–åŒ…ï¼Œè€Œè¿™äº›ä¾èµ–åŒ…çš„å­ä¾èµ–åŒ…éƒ½å®‰è£…åœ¨äº†è‡ªå·±çš„ node_modules ä¸­ ï¼Œå½¢æˆç±»ä¼¼äºä¸‹é¢çš„ä¾èµ–æ ‘ï¼š</p><p><img src="http://t-blog-images.aijs.top/img/20220519181427.webp"></p><p>è¿™æ ·çš„ç›®å½•æœ‰è¾ƒä¸ºæ˜æ˜¾çš„å¥½å¤„ï¼š</p><p>1ï¼‰å±‚çº§ç»“æ„éå¸¸æ˜æ˜¾ï¼Œå¯ä»¥æ¸…æ¥šçš„åœ¨ç¬¬ä¸€å±‚çš„ node_modules ä¸­çœ‹åˆ°æˆ‘ä»¬å®‰è£…çš„æ‰€æœ‰åŒ…çš„å­ç›®å½•ï¼›</p><p>2ï¼‰åœ¨å·²çŸ¥è‡ªå·±æ‰€éœ€åŒ…çš„åå­—ä»¥åŠç‰ˆæœ¬å·æ—¶ï¼Œå¯ä»¥å¤åˆ¶ç²˜è´´ç›¸åº”çš„æ–‡ä»¶åˆ° node_modules ä¸­ï¼Œç„¶åæ‰‹åŠ¨æ›´æ”¹ package.json ä¸­çš„é…ç½®ï¼›</p><p>3ï¼‰å¦‚æœæƒ³è¦åˆ é™¤æŸä¸ªåŒ…ï¼Œåªéœ€è¦ç®€å•çš„åˆ é™¤ package.json æ–‡ä»¶ä¸­ç›¸åº”çš„æŸä¸€è¡Œï¼Œç„¶ååˆ é™¤ node_modules ä¸­è¯¥åŒ…çš„ç›®å½•ï¼›</p><p>ä½†æ˜¯è¿™æ ·çš„å±‚çº§ç»“æ„ä¹Ÿæœ‰è¾ƒä¸ºæ˜æ˜¾çš„ç¼ºé™·ï¼Œå½“æˆ‘çš„ Aï¼ŒBï¼ŒC ä¸‰ä¸ªåŒ…ä¸­æœ‰ç›¸åŒçš„ä¾èµ– D æ—¶ï¼Œæ‰§è¡Œ <code>npm install</code> åï¼ŒD ä¼šè¢«é‡å¤ä¸‹è½½ä¸‰æ¬¡ï¼Œè€Œéšç€æˆ‘ä»¬çš„é¡¹ç›®è¶Šæ¥è¶Šå¤æ‚ï¼Œ<code>node_modules</code> ä¸­çš„ä¾èµ–æ ‘ä¹Ÿä¼šè¶Šæ¥è¶Šå¤æ‚ï¼Œåƒ D è¿™æ ·çš„åŒ…ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šï¼Œé€ æˆäº†å¤§é‡çš„å†—ä½™ï¼›åœ¨ windows ç³»ç»Ÿä¸­ï¼Œç”šè‡³ä¼šå› ä¸ºç›®å½•çš„å±‚çº§å¤ªæ·±å¯¼è‡´æ–‡ä»¶çš„è·¯å¾„è¿‡é•¿ï¼Œè§¦å‘æ–‡ä»¶è·¯å¾„ä¸èƒ½è¶…è¿‡ 280 ä¸ªå­—ç¬¦çš„é”™è¯¯ï¼›</p><p>ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œnpm 3 çš„ node_modules ç›®å½•æ”¹æˆäº†æ›´ä¸ºæ‰å¹³çŠ¶çš„å±‚çº§ç»“æ„ï¼Œå°½é‡æŠŠä¾èµ–ä»¥åŠä¾èµ–çš„ä¾èµ–å¹³é“ºåœ¨ node_modules æ–‡ä»¶å¤¹ä¸‹å…±äº«ä½¿ç”¨ã€‚</p><h2 id="npm-3-å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ"><a href="#npm-3-å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ" class="headerlink" title="npm 3 å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ"></a>npm 3 å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</h2><p>npm 3 ä¼šéå†æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œé€ä¸ªå°†æ¨¡å—æ”¾åœ¨ node_modules çš„ç¬¬ä¸€å±‚ï¼Œå½“å‘ç°æœ‰é‡å¤æ¨¡å—æ—¶ï¼Œåˆ™ä¸¢å¼ƒï¼Œ å¦‚æœé‡åˆ°æŸäº›ä¾èµ–ç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜ï¼Œåˆ™ç»§ç»­é‡‡ç”¨ npm 2 çš„å¤„ç†æ–¹å¼ï¼Œå‰é¢çš„æ”¾åœ¨ node_modules ç›®å½•ä¸­ï¼Œåé¢çš„æ”¾åœ¨ä¾èµ–æ ‘ä¸­ã€‚ä¸¾ä¸ªä¾‹å­ï¼š Aï¼ŒBï¼Œä¾èµ– D(v 0.0.1)ï¼ŒC ä¾èµ– D(v 0.0.2):</p><p><img src="http://t-blog-images.aijs.top/img/20220519181500.webp"></p><p>ä½†æ˜¯ npm 3 ä¼šå¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç”±äºåœ¨æ‰§è¡Œ npm install çš„æ—¶å€™ï¼ŒæŒ‰ç…§ package.json é‡Œä¾èµ–çš„é¡ºåºä¾æ¬¡è§£æï¼Œä¸Šå›¾å¦‚æœ C çš„é¡ºåºåœ¨ Aï¼ŒB çš„å‰è¾¹ï¼Œnode_modules æ ‘åˆ™ä¼šæ”¹å˜ï¼Œä¼šå‡ºç°ä¸‹è¾¹çš„æƒ…å†µï¼š</p><p><img src="http://t-blog-images.aijs.top/img/20220519181517.webp"></p><p>ç”±æ­¤å¯è§ï¼Œnpm 3 å¹¶æœªå®Œå…¨è§£å†³å†—ä½™çš„é—®é¢˜ï¼Œç”šè‡³è¿˜ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚</p><h2 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°-package-lock-json-å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°-package-lock-json-å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç° package-lock.json å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç° package-lock.json å‘¢ï¼Ÿ</h2><p>ä¸ºä»€ä¹ˆä¼šæœ‰ package-lock.json æ–‡ä»¶å‘¢ï¼Ÿè¿™ä¸ªæˆ‘ä»¬å°±è¦å…ˆä» package.json æ–‡ä»¶è¯´èµ·äº†ã€‚</p><h2 id="package-json-çš„ä¸è¶³ä¹‹å¤„"><a href="#package-json-çš„ä¸è¶³ä¹‹å¤„" class="headerlink" title="package.json çš„ä¸è¶³ä¹‹å¤„"></a>package.json çš„ä¸è¶³ä¹‹å¤„</h2><p>npm install æ‰§è¡Œåï¼Œä¼šç”Ÿæˆä¸€ä¸ª node_modules æ ‘ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œ å¸Œæœ›å¯¹äºåŒä¸€ä¸ª package.json æ€»æ˜¯ç”Ÿæˆå®Œå…¨ç›¸åŒ node_modules æ ‘ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¡®å®å¦‚æ­¤ã€‚ä½†åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œnpm æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼š</p><p>1ï¼‰æŸäº›ä¾èµ–é¡¹è‡ªä¸Šæ¬¡å®‰è£…ä»¥æ¥ï¼Œå¯èƒ½å·²å‘å¸ƒäº†æ–°ç‰ˆæœ¬ ã€‚æ¯”å¦‚ï¼šA åŒ…åœ¨å›¢é˜Ÿä¸­ç¬¬ä¸€ä¸ªäººå®‰è£…çš„æ—¶å€™æ˜¯ 1.0.5 ç‰ˆæœ¬ï¼Œpackage.json ä¸­çš„é…ç½®é¡¹ä¸º <code>A: &#39;^1.0.5&#39;</code> ï¼›å›¢é˜Ÿä¸­ç¬¬äºŒä¸ªäººæŠŠä»£ç æ‹‰ä¸‹æ¥çš„æ—¶å€™ï¼ŒA åŒ…çš„ç‰ˆæœ¬å·²ç»å‡çº§æˆäº† 1.0.8ï¼Œæ ¹æ® package.json ä¸­çš„ semver-range version è§„èŒƒï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªäºº npm install å A çš„ç‰ˆæœ¬ä¸º 1.0.8ï¼› å¯èƒ½ä¼šé€ æˆå› ä¸ºä¾èµ–ç‰ˆæœ¬ä¸åŒè€Œå¯¼è‡´çš„ bugï¼›</p><p>2ï¼‰é’ˆå¯¹ 1ï¼‰ä¸­çš„é—®é¢˜ï¼Œå¯èƒ½æœ‰çš„å°ä¼™ä¼´ä¼šæƒ³ï¼ŒæŠŠ A çš„ç‰ˆæœ¬å·å›ºå®šä¸º <code>A: &#39;1.0.5&#39;</code> ä¸å°±å¯ä»¥äº†å—ï¼Ÿä½†æ˜¯è¿™æ ·çš„åšæ³•å…¶å®å¹¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œ æ¯”å¦‚ A çš„æŸä¸ªä¾èµ–åœ¨ç¬¬ä¸€ä¸ªäººä¸‹è½½çš„æ—¶å€™æ˜¯ 2.1.3 ç‰ˆæœ¬ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªäººä¸‹è½½çš„æ—¶å€™å·²ç»å‡çº§åˆ°äº† 2.2.5 ç‰ˆæœ¬ï¼Œæ­¤æ—¶ç”Ÿæˆçš„ node_modules æ ‘ä¾æ—§ä¸å®Œå…¨ç›¸åŒ ï¼Œå›ºå®šç‰ˆæœ¬åªæ˜¯å›ºå®šæ¥è‡ªèº«çš„ç‰ˆæœ¬ï¼Œä¾èµ–çš„ç‰ˆæœ¬æ— æ³•å›ºå®šã€‚</p><h2 id="é’ˆå¯¹-package-json-ä¸è¶³çš„è§£å†³æ–¹æ³•"><a href="#é’ˆå¯¹-package-json-ä¸è¶³çš„è§£å†³æ–¹æ³•" class="headerlink" title="é’ˆå¯¹ package.json ä¸è¶³çš„è§£å†³æ–¹æ³•"></a>é’ˆå¯¹ package.json ä¸è¶³çš„è§£å†³æ–¹æ³•</h2><p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ä»¥åŠ npm 3 çš„é—®é¢˜ï¼Œåœ¨ npm 5.0 ç‰ˆæœ¬åï¼Œnpm install åéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª package-lock.json æ–‡ä»¶ ï¼Œå½“åŒ…ä¸­æœ‰ package-lock.json æ–‡ä»¶æ—¶ï¼Œnpm install æ‰§è¡Œæ—¶ï¼Œå¦‚æœ package.json å’Œ package-lock.json ä¸­çš„ç‰ˆæœ¬å…¼å®¹ï¼Œä¼šæ ¹æ® package-lock.json ä¸­çš„ç‰ˆæœ¬ä¸‹è½½ï¼›å¦‚æœä¸å…¼å®¹ï¼Œå°†ä¼šæ ¹æ® package.json çš„ç‰ˆæœ¬ï¼Œæ›´æ–° package-lock.json ä¸­çš„ç‰ˆæœ¬ï¼Œå·²ä¿è¯ package-lock.json ä¸­çš„ç‰ˆæœ¬å…¼å®¹ package.jsonã€‚</p><h2 id="package-lock-json-æ–‡ä»¶çš„ç»“æ„"><a href="#package-lock-json-æ–‡ä»¶çš„ç»“æ„" class="headerlink" title="package-lock.json æ–‡ä»¶çš„ç»“æ„"></a>package-lock.json æ–‡ä»¶çš„ç»“æ„</h2><p>package-lock.json æ–‡ä»¶ä¸­çš„ nameã€version ä¸ package.json ä¸­çš„ nameã€version ä¸€æ ·ï¼Œæè¿°äº†å½“å‰åŒ…çš„åå­—å’Œç‰ˆæœ¬ï¼Œdependencies æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å’Œ node_modules ä¸­çš„åŒ…ç»“æ„ä¸€ä¸€å¯¹åº”ï¼Œå¯¹è±¡çš„ key ä¸ºåŒ…çš„åç§°ï¼Œå€¼ä¸ºåŒ…çš„ä¸€äº›æè¿°ä¿¡æ¯ï¼Œ æ ¹æ® <a href="https://docs.npmjs.com/configuring-npm/package-lock-json.html#requires">package-lock-jsonå®˜æ–¹æ–‡æ¡£</a>ï¼Œä¸»è¦çš„ç»“æ„å¦‚ä¸‹ï¼š</p><ul><li><p>version ï¼šåŒ…ç‰ˆæœ¬ï¼Œå³è¿™ä¸ªåŒ…å½“å‰å®‰è£…åœ¨ node_modules ä¸­çš„ç‰ˆæœ¬</p></li><li><p>resolved ï¼šåŒ…å…·ä½“çš„å®‰è£…æ¥æº</p></li><li><p>integrity ï¼šåŒ… hash å€¼ï¼ŒéªŒè¯å·²å®‰è£…çš„è½¯ä»¶åŒ…æ˜¯å¦è¢«æ”¹åŠ¨è¿‡ã€æ˜¯å¦å·²å¤±æ•ˆ</p></li><li><p>requires ï¼šå¯¹åº”å­ä¾èµ–çš„ä¾èµ–ï¼Œä¸å­ä¾èµ–çš„ package.json ä¸­ dependencies çš„ä¾èµ–é¡¹ç›¸åŒ</p></li><li><p>dependencies ï¼šç»“æ„å’Œå¤–å±‚çš„ <code>dependencies</code> ç»“æ„ç›¸åŒï¼Œå­˜å‚¨å®‰è£…åœ¨å­ä¾èµ– <code>node_modules</code> ä¸­çš„ä¾èµ–åŒ…</p></li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­ä¾èµ–éƒ½æœ‰ <code>dependencies</code> å±æ€§ï¼Œåªæœ‰å­ä¾èµ–çš„ä¾èµ–å’Œå½“å‰å·²å®‰è£…åœ¨æ ¹ç›®å½•çš„ <code>node_modules</code> ä¸­çš„ä¾èµ–å†²çªä¹‹åï¼Œæ‰ä¼šæœ‰è¿™ä¸ªå±æ€§ã€‚</p><h2 id="package-lock-json-æ–‡ä»¶çš„ä½œç”¨"><a href="#package-lock-json-æ–‡ä»¶çš„ä½œç”¨" class="headerlink" title="package-lock.json æ–‡ä»¶çš„ä½œç”¨"></a>package-lock.json æ–‡ä»¶çš„ä½œç”¨</h2><p>åœ¨å›¢é˜Ÿå¼€å‘ä¸­ï¼Œç¡®ä¿æ¯ä¸ªå›¢é˜Ÿæˆå‘˜å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬æ˜¯ä¸€è‡´çš„ï¼Œç¡®å®šä¸€æ£µå”¯ä¸€çš„ node_modules æ ‘ï¼›</p><p>node_modules ç›®å½•æœ¬èº«æ˜¯ä¸ä¼šè¢«æäº¤åˆ°ä»£ç åº“çš„ï¼Œä½†æ˜¯ package-lock.json å¯ä»¥æäº¤åˆ°ä»£ç åº“ï¼Œå¦‚æœå¼€å‘äººå‘˜æƒ³è¦å›æº¯åˆ°æŸä¸€å¤©çš„ç›®å½•çŠ¶æ€ï¼Œåªéœ€è¦æŠŠ package.json å’Œ package-lock.json è¿™ä¸¤ä¸ªæ–‡ä»¶å›é€€åˆ°é‚£ä¸€å¤©å³å¯ ã€‚</p><p>ç”±äº package-lock.json å’Œ node_modules ä¸­çš„ä¾èµ–åµŒå¥—å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥æ›´åŠ æ¸…æ¥šçš„äº†è§£æ ‘çš„ç»“æ„åŠå…¶å˜åŒ–ã€‚</p><p>åœ¨å®‰è£…æ—¶ï¼Œnpm ä¼šæ¯”è¾ƒ node_modules å·²æœ‰çš„åŒ…ï¼Œå’Œ package-lock.json è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœé‡å¤çš„è¯ï¼Œå°±è·³è¿‡å®‰è£… ï¼Œä»è€Œä¼˜åŒ–äº†å®‰è£…çš„è¿‡ç¨‹ã€‚</p><h1 id="ä¾èµ–çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯"><a href="#ä¾èµ–çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä¾èµ–çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯"></a>ä¾èµ–çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯</h1><h2 id="npm-ç›®å‰æ”¯æŒä»¥ä¸‹å‡ ç±»ä¾èµ–åŒ…ç®¡ç†åŒ…æ‹¬"><a href="#npm-ç›®å‰æ”¯æŒä»¥ä¸‹å‡ ç±»ä¾èµ–åŒ…ç®¡ç†åŒ…æ‹¬" class="headerlink" title="npm ç›®å‰æ”¯æŒä»¥ä¸‹å‡ ç±»ä¾èµ–åŒ…ç®¡ç†åŒ…æ‹¬"></a>npm ç›®å‰æ”¯æŒä»¥ä¸‹å‡ ç±»ä¾èµ–åŒ…ç®¡ç†åŒ…æ‹¬</h2><ol><li><p>dependencies</p></li><li><p>devDependencies</p></li><li><p>optionalDependencies å¯é€‰æ‹©çš„ä¾èµ–åŒ…</p></li><li><p>peerDependencies åŒç­‰ä¾èµ–</p></li><li><p>bundledDependencies æ†ç»‘ä¾èµ–åŒ…</p></li></ol><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™å‡ ç§ä¾èµ–çš„åŒºåˆ«ä»¥åŠå„è‡ªçš„åº”ç”¨åœºæ™¯ï¼š</p><h2 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h2><p>dependencies æ˜¯æ— è®ºåœ¨å¼€å‘ç¯å¢ƒè¿˜æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒéƒ½å¿…é¡»ä½¿ç”¨çš„ä¾èµ–ï¼Œæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ä¾èµ–åŒ…ç®¡ç†å¯¹è±¡ï¼Œä¾‹å¦‚ Reactï¼ŒLoadshï¼ŒAxios ç­‰ï¼Œé€šè¿‡ npm install XXX ä¸‹è½½çš„åŒ…éƒ½ä¼šé»˜è®¤å®‰è£…åœ¨ dependencies å¯¹è±¡ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>npm install XXX --save</code> ä¸‹è½½ dependencies ä¸­çš„åŒ…ï¼›</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;devDependencies&quot;:&#123;  &quot;eslint&quot;: &quot;^5.0.0&quot;,  &quot;debug&quot;: &quot;^3.1.0&quot;,&#125;</code></pre><h2 id="devDependencies"><a href="#devDependencies" class="headerlink" title="devDependencies"></a>devDependencies</h2><p>devDependencies æ˜¯æŒ‡å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨çš„ä¾èµ–ï¼Œä¾‹å¦‚ eslintï¼Œdebug ç­‰ï¼Œé€šè¿‡ <code>npm install packageName --save-dev</code> ä¸‹è½½çš„åŒ…éƒ½ä¼šåœ¨ devDependencies å¯¹è±¡ä¸­ï¼›</p><p>dependencies å’Œ devDependencies æœ€å¤§çš„åŒºåˆ«æ˜¯åœ¨æ‰“åŒ…è¿è¡Œæ—¶ï¼Œæ‰§è¡Œ <code>npm install</code> æ—¶é»˜è®¤ä¼šæŠŠæ‰€æœ‰ä¾èµ–å…¨éƒ¨å®‰è£…ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ <code>npm install --production</code> æ—¶å°±åªä¼šå®‰è£… dependencies ä¸­çš„ä¾èµ–ï¼Œå¦‚æœæ˜¯ node æœåŠ¡é¡¹ç›®ï¼Œå°±å¯ä»¥é‡‡ç”¨è¿™æ ·çš„æ–¹å¼ç”¨äºæœåŠ¡è¿è¡Œæ—¶å®‰è£…å’Œæ‰“åŒ…ï¼Œå‡å°‘åŒ…å¤§å°ã€‚</p><h2 id="optionalDependencies"><a href="#optionalDependencies" class="headerlink" title="optionalDependencies"></a>optionalDependencies</h2><p>optionalDependencies æŒ‡çš„æ˜¯å¯ä»¥é€‰æ‹©çš„ä¾èµ–ï¼Œå½“ä½ å¸Œæœ›æŸäº›ä¾èµ–å³ä½¿ä¸‹è½½å¤±è´¥æˆ–è€…æ²¡æœ‰æ‰¾åˆ°æ—¶ï¼Œé¡¹ç›®ä¾ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œæˆ–è€… npm ç»§ç»­è¿è¡Œçš„æ—¶ï¼Œå°±å¯ä»¥æŠŠè¿™äº›ä¾èµ–æ”¾åœ¨ optionalDependencies å¯¹è±¡ä¸­ï¼Œä½†æ˜¯ optionalDependencies ä¼šè¦†ç›– dependencies ä¸­çš„åŒåä¾èµ–åŒ…ï¼Œæ‰€ä»¥ä¸è¦æŠŠä¸€ä¸ªåŒ…åŒæ—¶å†™è¿›ä¸¤ä¸ªå¯¹è±¡ä¸­ã€‚</p><p>optionalDependencies å°±åƒæ˜¯æˆ‘ä»¬çš„ä»£ç çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ä¸€æ ·ï¼Œå¦‚æœåŒ…å­˜åœ¨çš„è¯å°±èµ°å­˜åœ¨çš„é€»è¾‘ï¼Œä¸å­˜åœ¨çš„å°±èµ°ä¸å­˜åœ¨çš„é€»è¾‘ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">try &#123;   var axios &#x3D; require(&#39;axios&#39;)   var fooVersion &#x3D; require(&#39;axios&#x2F;package.json&#39;).version &#125; catch (er) &#123;   foo &#x3D; null &#125; &#x2F;&#x2F; .. then later in your program .. if (foo) &#123;   foo.doFooThings() &#125; </code></pre><h2 id="peerDependencies"><a href="#peerDependencies" class="headerlink" title="peerDependencies"></a>peerDependencies</h2><p>peerDependencies ç”¨äºæŒ‡å®šä½ å½“å‰çš„æ’ä»¶å…¼å®¹çš„å®¿ä¸»å¿…é¡»è¦å®‰è£…çš„åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼šæˆ‘ä»¬å¸¸ç”¨çš„ react ç»„ä»¶åº“ <code>ant-design@3.x</code> çš„ <code>package.json</code> ä¸­çš„é…ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;peerDependencies&quot;: &#123;   &quot;react&quot;: &quot;&gt;&#x3D;16.9.0&quot;,   &quot;react-dom&quot;: &quot;&gt;&#x3D;16.9.0&quot;  &#125;, </code></pre><p>å‡è®¾æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º project çš„é¡¹ç›®ï¼Œåœ¨æ­¤é¡¹ç›®ä¸­æˆ‘ä»¬è¦ä½¿ç”¨ <code>ant-design@3.x</code> è¿™ä¸ªæ’ä»¶ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„é¡¹ç›®å°±å¿…é¡»å…ˆå®‰è£… React &gt;&#x3D; 16.9.0 å’Œ React-dom &gt;&#x3D; 16.9.0 çš„ç‰ˆæœ¬ã€‚</p><p>åœ¨ npm 2 ä¸­ï¼Œå½“æˆ‘ä»¬ä¸‹è½½ <code>ant-design@3.x</code> æ—¶ï¼ŒpeerDependencies ä¸­æŒ‡å®šçš„ä¾èµ–ä¼šéšç€ <code>ant-design@3.x</code> ä¸€èµ·è¢«å¼ºåˆ¶å®‰è£…ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦åœ¨å®¿ä¸»é¡¹ç›®çš„ <code>package.json</code> æ–‡ä»¶ä¸­æŒ‡å®š peerDependencies ä¸­çš„ä¾èµ–ï¼Œä½†æ˜¯åœ¨ npm 3 ä¸­ï¼Œä¸ä¼šå†å¼ºåˆ¶å®‰è£… peerDependencies ä¸­æ‰€æŒ‡å®šçš„åŒ…ï¼Œè€Œæ˜¯é€šè¿‡è­¦å‘Šçš„æ–¹å¼æ¥æç¤ºæˆ‘ä»¬ï¼Œæ­¤æ—¶å°±éœ€è¦æ‰‹åŠ¨åœ¨ package.json æ–‡ä»¶ä¸­æ‰‹åŠ¨æ·»åŠ ä¾èµ–ï¼›</p><h2 id="bundledDependencies"><a href="#bundledDependencies" class="headerlink" title="bundledDependencies"></a>bundledDependencies</h2><p>è¿™ä¸ªä¾èµ–é¡¹ä¹Ÿå¯ä»¥è®°ä¸º bundleDependenciesï¼Œä¸å…¶ä»–å‡ ç§ä¾èµ–é¡¹ä¸åŒï¼Œä»–ä¸æ˜¯ä¸€ä¸ªé”®å€¼å¯¹çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œæ˜¯åŒ…åçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;   &quot;name&quot;: &quot;project&quot;,   &quot;version&quot;: &quot;1.0.0&quot;,   &quot;bundleDependencies&quot;: [     &quot;axios&quot;,      &quot;lodash&quot;   ] &#125; </code></pre><p>å½“ä½¿ç”¨ npm pack çš„æ–¹å¼æ¥æ‰“åŒ…æ—¶ï¼Œä¸Šè¿°çš„ä¾‹å­ä¼šç”Ÿæˆä¸€ä¸ª project-1.0.0.tgz çš„æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨äº† bundledDependencies åï¼Œæ‰“åŒ…æ—¶ä¼šæŠŠ Axios å’Œ Lodash è¿™ä¸¤ä¸ªä¾èµ–ä¸€èµ·æ”¾å…¥åŒ…ä¸­ï¼Œä¹‹åæœ‰äººä½¿ç”¨ <code>npm install project-1.0.0.tgz</code> ä¸‹è½½åŒ…æ—¶ï¼ŒAxios å’Œ Lodash è¿™ä¸¤ä¸ªä¾èµ–ä¹Ÿä¼šè¢«å®‰è£…ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å®‰è£…ä¹‹å Axios å’Œ Lodash è¿™ä¸¤ä¸ªåŒ…çš„ä¿¡æ¯åœ¨ dependencies ä¸­ï¼Œå¹¶ä¸”ä¸åŒ…æ‹¬ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;bundleDependencies&quot;: [     &quot;axios&quot;,     &quot;lodash&quot;   ], &quot;dependencies&quot;: &#123;   &quot;axios&quot;: &quot;*&quot;,   &quot;lodash&quot;: &quot;*&quot; &#125;, </code></pre><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨å¸¸è§„çš„ npm publish æ¥å‘å¸ƒçš„è¯ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥æ—¥å¸¸æƒ…å†µä¸­ä½¿ç”¨çš„è¾ƒå°‘ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä»‹ç»çš„æ˜¯ npm 2ï¼Œnpm 3ï¼Œpackage-lock.json ä»¥åŠå‡ ç§ä¾èµ–çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ï¼Œå¸Œæœ›èƒ½å¤Ÿè®©å¤§å®¶å¯¹ npm çš„äº†è§£æ›´åŠ å¤šä¸€ç‚¹ï¼Œæœ‰ä»€ä¹ˆä¸æ¸…æ¥šçš„åœ°æ–¹æˆ–è€…ä¸è¶³ä¹‹å¤„æ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ol><li><a href="https://www.zoo.team/article/npm-details">åŸæ–‡</a></li><li><a href="https://docs.npmjs.com/files/package.json#peerdependencies">package.jsonå®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://docs.npmjs.com/configuring-npm/package-lock-json.html#requires">package-lock-jsonå®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://juejin.im/post/6844903582337237006#heading-0">npmæ–‡æ¡£æ€»ç»“</a></li><li><a href="https://www.npmjs.cn/cli/pack/">npm-pack</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> npm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScript noEmit</title>
      <link href="//post/2022-05-18ts.html"/>
      <url>//post/2022-05-18ts.html</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>No Emit -<br>noEmit<br>Do not emit compiler output files like JavaScript source code, source-maps or declarations.<br>ä¸è¦å‘å‡ºç¼–è¯‘å™¨è¾“å‡ºæ–‡ä»¶ï¼Œå¦‚JavaScriptæºä»£ç ã€æºæ˜ å°„æˆ–å£°æ˜ã€‚</p><p>This makes room for another tool like Babel, or swc to handle converting the TypeScript file to a file which can run inside a JavaScript environment.</p><p>You can then use TypeScript as a tool for providing editor integration, and as a source code type-checker.</p><p><code>å¯¼è‡´outDirä¸è¾“å‡º</code></p>]]></content>
      
      
      <categories>
          
          <category> typescript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Slate å­¦ä¹ </title>
      <link href="//post/2022-04-29slate-lean.html"/>
      <url>//post/2022-04-29slate-lean.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h2><p><a href="https://doodlewind.github.io/slate-doc-cn/">slate ä¸­æ–‡æ–‡æ¡£</a><br><a href="https://docs.slatejs.org/">slate è‹±æ–‡æ–‡æ¡£</a></p><h2 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><a href="https://doodlewind.github.io/slate-doc-cn/">Slate</a> æ˜¯ä¸€ä¸ª å®Œå…¨ å¯å®šåˆ¶çš„å¯Œæ–‡æœ¬ç¼–è¾‘æ¡†æ¶ã€‚<br>é€šè¿‡ Slateï¼Œä½ å¯ä»¥æ„å»ºå‡ºç±»ä¼¼ Mediumã€Dropbox Paper æˆ–è€… Canvas è¿™æ ·ä½¿ç”¨ç›´è§‚ã€å¯Œäº¤äº’ã€ä½“éªŒä¸šå·²æˆä¸º Web åº”ç”¨æ ‡æ†çš„ç¼–è¾‘å™¨ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿæ— éœ€æ‹…å¿ƒåœ¨ä»£ç å®ç°ä¸Šé™·å…¥å¤æ‚åº¦çš„æ³¥æ½­ä¹‹ä¸­ã€‚</p></blockquote><h2 id="èƒ½åšä»€ä¹ˆ"><a href="#èƒ½åšä»€ä¹ˆ" class="headerlink" title="èƒ½åšä»€ä¹ˆ"></a>èƒ½åšä»€ä¹ˆ</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>é€šè¿‡ Slateï¼Œä½ å¯ä»¥æ„å»ºå‡ºç±»ä¼¼ Mediumã€Dropbox Paper æˆ–è€… Canvas è¿™æ ·ä½¿ç”¨ç›´è§‚ã€å¯Œäº¤äº’ã€ä½“éªŒä¸šå·²æˆä¸º Web åº”ç”¨æ ‡æ†çš„ç¼–è¾‘å™¨ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿæ— éœ€æ‹…å¿ƒåœ¨ä»£ç å®ç°ä¸Šé™·å…¥å¤æ‚åº¦çš„æ³¥æ½­ä¹‹ä¸­ã€‚<br>Slate ä¹‹æ‰€ä»¥èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ˜¯å› ä¸ºå®ƒçš„æ‰€æœ‰é€»è¾‘éƒ½æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„æ’ä»¶å®ç°çš„ã€‚è¿™æ ·ï¼Œä½ å°±å†ä¹Ÿä¸ä¼šè¢«æŸé¡¹ç‰¹æ€§ åœ¨ æˆ– ä¸åœ¨ ç¼–è¾‘å™¨ã€æ ¸å¿ƒã€‘è¾¹ç•Œä¹‹å†…çš„é—®é¢˜æ‰€å›°æ‰°äº†ã€‚ä½ å¯ä»¥å°†å®ƒç†è§£ä¸ºåœ¨ React å’Œ Immutable åŸºç¡€ä¸Šï¼Œä¸€ç§å¯æ’æ‹”çš„ contenteditable å®ç°ã€‚å¦å¤–ï¼Œå®ƒçš„çµæ„Ÿæ¥è‡ªäº Draft.jsï¼ŒProsemirror å’Œ Quill ç­‰ç±»åº“ã€‚</p></blockquote><h2 id="äº§ç”Ÿçš„èƒŒæ™¯"><a href="#äº§ç”Ÿçš„èƒŒæ™¯" class="headerlink" title="äº§ç”Ÿçš„èƒŒæ™¯"></a>äº§ç”Ÿçš„èƒŒæ™¯</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¸ºä»€ä¹ˆå‘æ˜ Slate å‘¢ï¼Ÿå¥½å§â€¦ï¼ˆæ³¨æ„ï¼Œè¿™éƒ¨åˆ†å†…å®¹åŒ…å«äº†ä¸€äº›æˆ‘çš„ä¸ªäººè§‚ç‚¹ï¼ï¼‰</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åœ¨å‘æ˜ Slate ä¹‹å‰ï¼Œæˆ‘å°è¯•äº†è®¸å¤šä¸åŒçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€‚æˆ‘å‘ç°è™½ç„¶å®ƒä»¬åœ¨ç¼–å†™ç®€å•ç¤ºä¾‹æ—¶åŸºæœ¬æ²¡æœ‰é—®é¢˜ï¼Œä½†ä¸€æ—¦æƒ³è¦æ„å»ºä¸€äº›ç±»ä¼¼ Mediumã€Dropbox Paper æˆ–è€… Google Docs è¿™æ ·çš„å†…å®¹ï¼Œä½ å°±ä¼šå‘ç°ä¸€äº›æ·±å±‚æ¬¡çš„é—®é¢˜ï¼Œæ¯”å¦‚â€¦</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>ç¼–è¾‘å™¨ç¡¬ç¼–ç äº†æ–‡æ¡£çš„ç»“æ„è§„èŒƒï¼Œéš¾ä»¥å®šåˆ¶</strong>ã€‚ç±»ä¼¼åŠ ç²—å’Œæ–œä½“çš„ç»“æ„å¯ä»¥å¼€ç®±å³ç”¨ï¼Œä½†è¯„è®ºã€åµŒå…¥å†…å®¹ä»¥åŠæ›´å¤šçš„å®šåˆ¶æ€§éœ€æ±‚å‘¢ï¼Ÿ</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>å¯¹æ–‡æ¡£çš„ç¼–ç¨‹å¼å˜æ¢éå¸¸é”™ç»¼å¤æ‚</strong>ã€‚ç”¨æˆ·çš„ç¼–å†™ä½“éªŒå¯èƒ½ä¸é”™ï¼Œä½†åœ¨æ‰§è¡Œç¼–ç¨‹å¼å˜æ›´æ—¶å´ä¸å¿…è¦åœ°å¤æ‚ï¼Œè€Œè¿™å¯¹äºæ„å»ºé«˜çº§çš„ç¼–è¾‘è¡Œä¸ºè‡³å…³é‡è¦ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>å¯¹ HTMLã€Markdown ç­‰å†…å®¹çš„åºåˆ—åŒ–æ”¯æŒçœ‹èµ·æ¥åƒæ˜¯äº‹ååŠ ä¸Šçš„</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼Œä½†è¦å®ç°å°†æ–‡æ¡£è½¬æ¢ä¸º HTML æˆ– Markdown çš„ç®€å•åŠŸèƒ½éƒ½éœ€è¦ç¼–å†™å¤§é‡çš„æ¨¡æ¿ä»£ç ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>é‡æ–°å­¦ä¹ ä¸€ä¸ªæ–°çš„è§†å›¾å±‚æ•ˆç‡ä¸é«˜ä¸”ååˆ†å—é™</strong>ã€‚å„ç§ç¼–è¾‘å™¨åœ¨é‡æ–°å‘æ˜è§†å›¾å±‚çš„è½®å­ï¼Œè€Œéä½¿ç”¨ React è¿™æ ·å·²æœ‰çš„æŠ€æœ¯æ–¹æ¡ˆã€‚ä½ å¿…é¡»å­¦ä¹ ä¸€å¥—å¸¦ç€è‡ªæœ‰é™åˆ¶å’Œé™·é˜±çš„æ–°ç³»ç»Ÿã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>**<code>å¯¹ååŒç¼–è¾‘æ²¡æœ‰é¢„å…ˆè®¾è®¡å¥½çš„æ”¯æŒ</code>**ã€‚ç¼–è¾‘å™¨å†…éƒ¨çš„æ•°æ®ç»“æ„ä½¿å…¶æ— æ³•ç”¨äºå®æ—¶ã€åä½œçš„ç¼–è¾‘åœºæ™¯ä¸­ï¼Œé™¤éé‡å†™ç¼–è¾‘å™¨ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>ä»£ç ä»“åº“æ˜¯å•ä½“çš„ï¼Œè€Œéå°è€Œå¯å¤ç”¨çš„</strong>ã€‚è®¸å¤šç¼–è¾‘å™¨æ²¡æœ‰å¯¹å¤–å¼€æ”¾æœ¬åº”ä¸ºå¼€å‘è€…æ‰€å¤ç”¨çš„å†…éƒ¨å·¥å…·ï¼Œä»¥è‡³äºä¸å¾—ä¸é‡æ–°å‘æ˜è½®å­ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>æ— æ³•æ„å»ºå¤æ‚è€Œå­˜åœ¨åµŒå¥—å…³ç³»çš„æ–‡æ¡£</strong>ã€‚ä¸å°‘ç¼–è¾‘å™¨æ˜¯å›´ç»•ç®€å•çš„ã€æ‰å¹³ã€‘æ–‡æ¡£ç»“æ„è®¾è®¡çš„ï¼Œè¿™ä½¿å¾—è¡¨æ ¼ã€åµŒå…¥å†…å®¹å’Œå­—å¹•ç­‰å†…å®¹éš¾ä»¥ç†è§£ï¼Œæœ‰æ—¶ç”šè‡³æ— æ³•å®ç°ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å½“ç„¶ï¼Œå¹¶éæ‰€æœ‰çš„ç¼–è¾‘å™¨éƒ½å­˜åœ¨ä»¥ä¸Šçš„é—®é¢˜ï¼Œä½†å¦‚æœä½ å·²ç»å°è¯•è¿‡ä¸€äº›ç¼–è¾‘å™¨ï¼Œä½ å¯èƒ½å·²ç»è¸©è¿‡ç±»ä¼¼çš„å‘äº†ã€‚ä¸ºäº†æ‘†è„±å®ƒä»¬åœ¨ API ä¸Šçš„é™åˆ¶æ¥è¾¾åˆ°ä½ æœŸæœ›çš„ç”¨æˆ·ä½“éªŒï¼Œä½ å¾—ä½¿ç”¨å„ç§å¥‡æŠ€æ·«å·§ï¼Œæœ‰äº›ä½“éªŒç”šè‡³æ˜¯å®Œå…¨æ— æ³•å®ç°çš„ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¦‚æœä½ é‡åˆ°äº†ç›¸ä¼¼çš„é—®é¢˜ï¼Œé‚£ä¹ˆä¹Ÿè®¸ä½ ä¼šå–œæ¬¢ä¸Š Slateã€‚è®©æˆ‘æ¥ä»‹ç»ä¸€ä¸‹ Slate æ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„å§â€¦</p></blockquote><h2 id="æä¾›äº†ä»€ä¹ˆèƒ½åŠ›"><a href="#æä¾›äº†ä»€ä¹ˆèƒ½åŠ›" class="headerlink" title="æä¾›äº†ä»€ä¹ˆèƒ½åŠ›"></a>æä¾›äº†ä»€ä¹ˆèƒ½åŠ›</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Slate å°è¯•é€šè¿‡ä¸€äº›åŸåˆ™æ¥è§£å†³ â€œWhy?â€ è¿™ä¸€èŠ‚ä¸­çš„é—®é¢˜ï¼š</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>ä½œä¸ºä¸€ç­‰å…¬æ°‘çš„æ’ä»¶</strong>ã€‚ åœ¨ Slate ä¸­æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæ’ä»¶æ˜¯ä¸€ç­‰å…¬æ°‘ï¼ˆfirst-classï¼‰çš„å®ä½“â€”â€”ç”šè‡³è¿ç¼–è¾‘å™¨çš„æ ¸å¿ƒé€»è¾‘éƒ½æ˜¯é€šè¿‡æ’ä»¶å®ç°çš„ã€‚è¿™æ„å‘³ç€ä½ èƒ½å¤Ÿ å®Œå…¨åœ° å®šåˆ¶ç¼–è¾‘ä½“éªŒï¼Œæ„å»ºå‡ºå¯¹æ ‡ Medium å’Œ Canvas é‚£æ ·çš„å¤æ‚ç¼–è¾‘å™¨ï¼Œè€Œæ— éœ€å¯¹æŠ—å„ç§ç±»åº“çš„é¢„è®¾æ¡ä»¶ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>ç²¾ç®€ Schema çš„æ ¸å¿ƒ</strong>ã€‚ Slate çš„æ ¸å¿ƒé€»è¾‘å¹¶ä¸å¯¹ä½ æ‰€ç¼–è¾‘çš„æ•°æ®ç»“æ„åšä»»ä½•å‡è®¾ï¼Œè¿™æ„å‘³ç€ä½ åœ¨éœ€è¦åº”å¯¹å¤æ‚åœºæ™¯æ—¶ä¸ä¼šè¢«ç¼–è¾‘å™¨é¢„ç½®çš„å†…å®¹æ‰€æŸç¼šï¼ˆè¯‘è€…æ³¨ï¼šæ­¤å¤„ Schema å¯ç†è§£ä¸ºç±»ä¼¼ XML Schema çš„æ–‡æ¡£ç»“æ„è§„èŒƒï¼‰ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>æ”¯æŒåµŒå¥—çš„æ–‡æ¡£æ¨¡å‹</strong>ã€‚ Slate æ‰€ä½¿ç”¨çš„æ–‡æ¡£æ¨¡å‹æ˜¯ä¸€æ£µåµŒå¥—çš„ã€é€’å½’çš„æ ‘ï¼Œå’Œ DOM æœ¬èº«ååˆ†æ¥è¿‘ã€‚è¿™ä½¿å¾—æ„å»ºè¡¨æ ¼å’ŒåµŒå¥—å¼•ç”¨ç­‰èƒ½å¤Ÿæ»¡è¶³è¿›é˜¶éœ€æ±‚çš„å¤æ‚ç»„ä»¶æˆä¸ºäº†å¯èƒ½ã€‚å½“ç„¶ï¼Œä½ åŒæ ·å¯ä»¥ä½¿ç”¨å•ä¸€çš„å±‚çº§å…³ç³»ä»¥ä¿è¯ç®€å•æ€§ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>æ— çŠ¶æ€ã€ä¸å¯å˜çš„æ•°æ®</strong>ã€‚ é€šè¿‡ä½¿ç”¨ React å’Œ Immutable.jsï¼Œæˆ‘ä»¬æ˜¯åŸºäºä¸å¯å˜æ•°æ®ç»“æ„ï¼Œä»¥æ— çŠ¶æ€çš„æ–¹å¼æ„å»º Slate ç¼–è¾‘å™¨çš„ã€‚è¿™å¤§å¤§é™ä½äº†ç†è§£ä»£ç çš„éš¾åº¦ï¼Œä¹ŸèŠ‚çº¦äº†å¤§é‡å¼€å‘æ’ä»¶çš„æ—¶é—´ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><strong>ç›´è§‚çš„ changes</strong>ã€‚ Slate ä¸­çš„å†…å®¹æ˜¯é€šè¿‡ â€œchangeâ€ æ¥ç¼–è¾‘çš„ï¼Œè¿™æ˜¯ä¸€ç§è¢«è®¾è®¡ä¸ºæ”¯æŒé«˜é˜¶ä½¿ç”¨ï¼Œä¸”æå…¶ç¬¦åˆç›´è§‰çš„æ¦‚å¿µã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿé€šè¿‡å®ƒæ¥å°½å¯èƒ½ç®€å•åœ°ç¼–å†™æ’ä»¶å’Œè‡ªå®šä¹‰åŠŸèƒ½äº†ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>**<code>ä¸ºååŒç¼–è¾‘å‡†å¤‡çš„æ•°æ®æ¨¡å‹</code>**ã€‚ Slate ä½¿ç”¨çš„æ•°æ®æ¨¡å‹â€”â€”å°¤å…¶æ˜¯ç”± change æ›´æ”¹æ–‡æ¡£çš„æ–¹å¼â€”â€”åœ¨è®¾è®¡æ—¶å°±å·²è€ƒè™‘åˆ°å¯¹ååŒç¼–è¾‘çš„æ”¯æŒã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ å†³å®šä¸ºç¼–è¾‘å™¨æ·»åŠ åä½œåŠŸèƒ½ï¼Œä½ ä¸éœ€è¦è¿›è¡Œå½»åº•çš„é‡æ„ã€‚ï¼ˆå½“ç„¶ï¼Œè¿™è¿˜éœ€è¦ä½ æŠ•å…¥æ›´å¤šçš„åŠªåŠ›ï¼ï¼‰</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æ˜ç¡®çš„ã€æ ¸å¿ƒã€‘è¾¹ç•Œåˆ’åˆ†ã€‚ é€šè¿‡æ’ä»¶ä¼˜å…ˆçš„æ¶æ„ä¸ç²¾ç®€ Schema çš„å†…æ ¸ï¼ŒSlate å¯¹äºã€æ ¸å¿ƒã€‘å’Œã€è‡ªå®šä¹‰ã€‘æœ‰ç€æ˜ç¡®å¾—å¤šçš„åˆ’åˆ†ï¼Œä»è€Œä¿è¯æ ¸å¿ƒçš„ç¼–è¾‘ä½“éªŒä¸ä¼šä¸ºå„ç§è¾¹ç¼˜æƒ…å†µæ‰€å›°æ‰°ã€‚</p></blockquote><h2 id="ååŒç¼–è¾‘ï¼Œè¿™ä¸ªåé¢ä¼šæŒç»­å…³æ³¨"><a href="#ååŒç¼–è¾‘ï¼Œè¿™ä¸ªåé¢ä¼šæŒç»­å…³æ³¨" class="headerlink" title="ååŒç¼–è¾‘ï¼Œè¿™ä¸ªåé¢ä¼šæŒç»­å…³æ³¨"></a>ååŒç¼–è¾‘ï¼Œè¿™ä¸ªåé¢ä¼šæŒç»­å…³æ³¨</h2><p><img src="http://t-blog-images.aijs.top/img/20220429152337.png"><br><a href="https://docs.slate-yjs.dev/">slate-yjs</a><br><a href="https://docs.yjs.dev/">yjs</a></p><h2 id="slate-æ–‡æ¡£ä¸æ˜¯å¾ˆå¤šï¼ŒåŠå°æ—¶çœ‹å®Œ"><a href="#slate-æ–‡æ¡£ä¸æ˜¯å¾ˆå¤šï¼ŒåŠå°æ—¶çœ‹å®Œ" class="headerlink" title="slate æ–‡æ¡£ä¸æ˜¯å¾ˆå¤šï¼ŒåŠå°æ—¶çœ‹å®Œ"></a>slate æ–‡æ¡£ä¸æ˜¯å¾ˆå¤šï¼ŒåŠå°æ—¶çœ‹å®Œ</h2><p>ä¸»è¦å†…å®¹ </p><ul><li>æ’ä»¶å®šåˆ¶åŒ–</li><li>æ¸²æŸ“èŠ‚ç‚¹å®šåˆ¶åŒ–</li><li>æŒ‰é”®ç›‘å¬å¤„ç†</li><li>æ•°æ®æ ¼å¼ç¼–ç ã€åç¼–ç </li><li>æ•°æ®å­˜å‚¨</li></ul><h2 id="å°±è¿™ç‚¹ä¸œè¥¿ğŸ˜±"><a href="#å°±è¿™ç‚¹ä¸œè¥¿ğŸ˜±" class="headerlink" title="å°±è¿™ç‚¹ä¸œè¥¿ğŸ˜±"></a>å°±è¿™ç‚¹ä¸œè¥¿ğŸ˜±</h2><p>ç«Ÿç„¶æœ‰äº›åŒå­¦å‡­å€Ÿslateçš„ä½¿ç”¨æ‹¿äº†3.75,èµ¶ç´§å­¦ï½</p>]]></content>
      
      
      <categories>
          
          <category> wiki </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼</title>
      <link href="//post/2022-05-13design_mode.html"/>
      <url>//post/2022-05-13design_mode.html</url>
      
        <content type="html"><![CDATA[<h2 id="å…ˆèŠç”¨åˆ°è¿‡å“ªäº›ï¼ŒèƒŒåçš„è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆ"><a href="#å…ˆèŠç”¨åˆ°è¿‡å“ªäº›ï¼ŒèƒŒåçš„è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆ" class="headerlink" title="å…ˆèŠç”¨åˆ°è¿‡å“ªäº›ï¼ŒèƒŒåçš„è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆ"></a>å…ˆèŠç”¨åˆ°è¿‡å“ªäº›ï¼ŒèƒŒåçš„è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆ</h2><ol><li>å®ä¾‹åŒ–ä¸€ä¸ª axios å®ä¾‹ï¼Œå…¨å±€éƒ½æ¥ä½¿ç”¨å®ƒ <em>å•ä¾‹æ¨¡å¼</em></li><li>å…„å¼Ÿç»„ä»¶é€šä¿¡,äº‹ä»¶ç›‘å¬ <em>è§‚å¯Ÿè€…æ¨¡å¼</em></li><li>æ„é€ å‡½æ•°ç»§æ‰¿ã€ç±»çš„ç»§æ‰¿ <em>æ„é€ å‡½æ•°æ¨¡å¼</em></li><li>å®ä¾‹åŒ–ä¸åŒçš„å®ä¾‹ <em>å·¥å‚æ¨¡å¼</em></li><li>ä¼˜åŒ–ä¸­çš„<code>äº‹ä»¶ä»£ç†</code><em>ä»£ç†æ¨¡å¼</em></li><li>esmã€commonjs<em>æ¨¡å—æ¨¡å¼</em></li></ol><p><em>ç†Ÿæ‚‰è€Œåˆé™Œç”Ÿ</em>ï¼šç†Ÿæ‚‰çš„æ˜¯ä¸€ç›´åœ¨ç”¨ï¼Œé™Œç”Ÿçš„æ˜¯å­¦åç«Ÿç„¶æ˜¯è¿™äº›ã€‚æˆ‘éƒ½æœ‰ç‚¹æ€€ç–‘äº†ï¼Œè¿™æ˜¯çœŸçš„å—ï¼Ÿæ˜¯çœŸçš„å—ï¼Ÿï½ï½ï½</p><p><img    src="https://img1.baidu.com/it/u=1902986975,2375222058&fm=253&fmt=auto&app=138&f=JPEG?w=535&h=500"    width=100 style="border-radius: 10px"    /></p>   <div style="font-size: 20px; color: orange;margin-top: 30px">æ¥ï½æ¥ï½æ¥ï½ï¼Œæˆ‘ä»¬ç»§ç»­ã€‚ã€‚ã€‚</div><h2 id="å•¥å‘€"><a href="#å•¥å‘€" class="headerlink" title="å•¥å‘€"></a>å•¥å‘€</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>â€œè®¾è®¡æ¨¡å¼(è‹±è¯­ design pattern)æ˜¯å¯¹é¢å‘å¯¹è±¡è®¾è®¡ä¸­<code>åå¤å‡ºç°çš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</code>ã€‚è¿™ä¸ªæœ¯è¯­æ˜¯åœ¨1990å¹´ä»£ç”±Erich Gammaç­‰äººä»å»ºç­‘è®¾è®¡é¢†åŸŸ<code>å¼•å…¥åˆ°</code>è®¡ç®—æœºç§‘å­¦ä¸­æ¥çš„ã€‚â€</p></blockquote><h2 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h2><h2 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h2><ul><li>ä½œç”¨ï¼šè®¿é—®æ§åˆ¶</li><li>åœºæ™¯ï¼šäº‹ä»¶ä»£ç†ã€Proxyã€Object.defineProperty</li></ul><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><ul><li>å®šä¹‰ï¼šå”¯ä¸€å®ä¾‹ï¼Œå…¨å±€å¯è®¿é—®</li><li>åœºæ™¯ï¼šè¯·æ±‚å®ä¾‹ã€å…¨å±€ç¼“å­˜ã€çº¿ç¨‹æ± ã€window å¯¹è±¡ã€ç™»å½•æµ®æ¡†</li><li>å®ç°ï¼šå·²ç»åˆ›å»ºè¿‡çš„ç›´æ¥è¿”å›ï¼Œä¸é‡å¤åˆ›å»º</li></ul><h2 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h2><ul><li>ä½œç”¨ï¼šåˆ›å»ºåŒä¸€ç±»å¯¹è±¡</li><li>åˆ†ç±»ï¼š<em>ç®€å•å·¥å‚_ã€_æ–¹æ³•å·¥å‚</em></li></ul><h3 id="1-ç®€å•å·¥å‚"><a href="#1-ç®€å•å·¥å‚" class="headerlink" title="1. ç®€å•å·¥å‚"></a>1. ç®€å•å·¥å‚</h3><ul><li>ä¾‹å¦‚ï¼šé¡¹ç›®ä¸­æ ¹æ®ç”¨æˆ·æƒé™æ¸²æŸ“ä¸åŒçš„é¡µé¢ï¼Œåœ¨ä¸åŒæƒé™ç­‰çº§ç”¨æˆ·çš„æ„é€ å‡½æ•°ä¸­ï¼Œä¿å­˜ç”¨æˆ·å¯ä»¥çœ‹åˆ°çš„é¡µé¢</li><li>ä¼˜ç‚¹ï¼šä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œæ— éœ€çŸ¥é“å…¶åˆ›å»ºçš„å…·ä½“ç»†èŠ‚</li><li>ç¼ºç‚¹ï¼šå‡½æ•°ä¼šæˆä¸ºä¸€ä¸ªè¶…çº§å‡½æ•°ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œç®€å•å·¥å‚é€‚ç”¨äºåˆ›å»ºå°‘é‡å¯¹è±¡ï¼Œå¯¹è±¡çš„é€»è¾‘ä¸èƒ½å¤æ‚</li></ul><h3 id="2-å·¥å‚æ–¹æ³•"><a href="#2-å·¥å‚æ–¹æ³•" class="headerlink" title="2. å·¥å‚æ–¹æ³•"></a>2. å·¥å‚æ–¹æ³•</h3><ul><li>æœ¬è´¨ï¼šå°†åˆ›å»ºå¯¹è±¡çš„å·¥ä½œï¼Œæ¨è¿Ÿåˆ°å­ç±»ä¸­ï¼Œè¿™æ ·æ ¸å¿ƒç±»å°±å˜æˆæŠ½è±¡ç±»</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">let UserFactory &#x3D; function (type) &#123;  if (this instanceof UserFactory) &#123;    return new this[type]();  &#125; else &#123;    return new UserFactory(type);  &#125;&#125;;&#x2F;&#x2F; å·¥å‚æ–¹æ³•ï¼Œå‡½æ•°çš„åŸå‹ä¸­è®¾ç½®æ‰€æœ‰å¯¹è±¡çš„æ„é€ å‡½æ•°UserFactory.prototype &#x3D; &#123;  SuperAdmin: function () &#123;    this.name &#x3D; &quot;è¶…çº§ç®¡ç†å‘˜&quot;;    this.viewPage &#x3D; [&quot;é¦–é¡µ&quot;, &quot;è®¢å•ç®¡ç†&quot;, &quot;ç”¨æˆ·ç®¡ç†&quot;, &quot;åº”ç”¨ç®¡ç†&quot;, &quot;æƒé™ç®¡ç†&quot;];  &#125;,  Admin: function () &#123;    this.name &#x3D; &quot;ç®¡ç†å‘˜&quot;;    this.viewPage &#x3D; [&quot;é¦–é¡µ&quot;, &quot;è®¢å•ç®¡ç†&quot;, &quot;ç”¨æˆ·ç®¡ç†&quot;];  &#125;,  NormalUser: function () &#123;    this.name &#x3D; &quot;æ™®é€šç”¨æˆ·&quot;;    this.viewPage &#x3D; [&quot;é¦–é¡µ&quot;, &quot;è®¢å•ç®¡ç†&quot;];  &#125;,&#125;;&#x2F;&#x2F; è°ƒç”¨let superAdmin &#x3D; new UserFactory(&quot;SuperAdmin&quot;);let admin &#x3D; new UserFactory(&quot;Admin&quot;);let normalUser &#x3D; new UserFactory(&quot;NormalUser&quot;);</code></pre><h3 id="3-æŠ½è±¡å·¥å‚"><a href="#3-æŠ½è±¡å·¥å‚" class="headerlink" title="3. æŠ½è±¡å·¥å‚"></a>3. æŠ½è±¡å·¥å‚</h3><ul><li></li></ul><h2 id="æ„é€ å‡½æ•°æ¨¡å¼"><a href="#æ„é€ å‡½æ•°æ¨¡å¼" class="headerlink" title="æ„é€ å‡½æ•°æ¨¡å¼"></a>æ„é€ å‡½æ•°æ¨¡å¼</h2><h2 id="ğŸ‘€-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#ğŸ‘€-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="ğŸ‘€ è§‚å¯Ÿè€…æ¨¡å¼"></a>ğŸ‘€ è§‚å¯Ÿè€…æ¨¡å¼</h2><ul><li>å®šä¹‰ï¼š å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»</li><li>ä½œç”¨ï¼šä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä¾èµ–ä»–çš„å¯¹è±¡ï¼Œéƒ½å°†å¾—åˆ°é€šçŸ¥</li><li>ä¼˜ç‚¹ï¼šè§£è€¦</li><li>ç»„æˆï¼šå‘å¸ƒè€…ã€è®¢é˜…è€…</li><li>åœºæ™¯ï¼šäº‹ä»¶ç›‘å¬ã€eventBus</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">document.body.addEventListener(&quot;click&quot;, function () &#123;&#125;, false);</code></pre><h2 id="æ··åˆæ¨¡å¼"><a href="#æ··åˆæ¨¡å¼" class="headerlink" title="æ··åˆæ¨¡å¼"></a>æ··åˆæ¨¡å¼</h2><h2 id="æ¨¡å—æ¨¡å¼"><a href="#æ¨¡å—æ¨¡å¼" class="headerlink" title="æ¨¡å—æ¨¡å¼"></a>æ¨¡å—æ¨¡å¼</h2><ul><li>ä½œç”¨ï¼šé¿å…å…¨å±€æ±¡æŸ“ï¼ŒæŒ‰éœ€æš´éœ²</li><li>å®ç°ï¼šå¤šé‡‡ç”¨é—­åŒ…</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">var Person &#x3D; (function () &#123;  var name &#x3D; &quot;xxx&quot;;  function sayName(params) &#123;    console.log(name);  &#125;  return &#123;    name,    sayName,  &#125;;&#125;)();</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ant design formè®¾ç½®å€¼ !== è·å–å€¼</title>
      <link href="//post/2022-05-13react.html"/>
      <url>//post/2022-05-13react.html</url>
      
        <content type="html"><![CDATA[<h2 id="æœ‰æ„æ€çš„äº‹"><a href="#æœ‰æ„æ€çš„äº‹" class="headerlink" title="æœ‰æ„æ€çš„äº‹"></a>æœ‰æ„æ€çš„äº‹</h2><ul><li>ä»Šå¤©ç»´æŠ¤é¡¹ç›®é‡åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„äº‹ï¼Œç›´è§‚æ„Ÿå—ï¼Œè®¾ç½®å€¼ï¼Œå†å–å‡ºæ¥ï¼Œè²Œä¼¼æ²¡æ¯›ç—…<pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">  &#x2F;&#x2F; ...  const [values, setValues] &#x3D; useState&lt;Record&lt;string, any&gt;&gt;()  const &#123; applyStartTime, applyEndTime, attendanceType, staffId &#125; &#x3D; values || &#123;&#125;  const getDetail &#x3D; usePersistFn(async () &#x3D;&gt; &#123;    &#x2F;&#x2F; ...ç•¥    const obj: Record&lt;string, any&gt; &#x3D; &#123;      staffId: applyStaff.staffId,      attendanceType: res.result.attendanceType,      applyStartTime: &#123;        value: moment(res.result.applyStartTime),        half: res.result.startDayType,      &#125;,      applyEndTime: &#123;        value: moment(res.result.applyEndTime),        half: res.result.endDayType,      &#125;,      applyReason,      applyAttachments,    &#125;    &#x2F;&#x2F; ...ç•¥    form.setFieldsValue(obj)    setValues(form.getFieldsValue())  &#125;)  &#x2F;&#x2F; ...ç•¥  const &#123; total, loading: totalLoading &#125; &#x3D; useCaculateDays(    &#123;      start: applyStartTime,      end: applyEndTime,    &#125;,    staffId,    attendanceType,  )  &#x2F;&#x2F; ...ç•¥  &#x2F;&#x2F; AnualFormç»„ä»¶  &lt;Form.Item name&#x3D;&quot;applyStartTime&quot; label&#x3D;&quot;èµ·å§‹æ—¥æœŸ&quot; rules&#x3D;&#123;[&#123; required: true &#125;]&#125;&gt;      &lt;HalftDatePicker predict&#x3D;&#123;&#123; lessThan: end?.value &#125;&#125; &#x2F;&gt;    &lt;&#x2F;Form.Item&gt;  &lt;Form.Item name&#x3D;&quot;applyEndTime&quot; label&#x3D;&quot;ç»“æŸæ—¥æœŸ&quot; rules&#x3D;&#123;[&#123; required: true &#125;]&#125;&gt;    &lt;HalftDatePicker predict&#x3D;&#123;&#123; moreThan: start?.value &#125;&#125; &#x2F;&gt;  &lt;&#x2F;Form.Item&gt;  type IValue &#x3D; &#123;    value?: moment.Moment    half: 1 | 2  &#125; &#x2F;&#x2F; HalftDatePickerç»„ä»¶const HalftDatePicker: React.ForwardRefRenderFunction&lt;any, PickerProps&lt;moment.Moment&gt; &amp; &#123;  value?: IValue  onChange?: (v?: IValue) &#x3D;&gt; void  predict?: &#123;    lessThan?: moment.Moment    moreThan?: moment.Moment    holiday?: boolean  &#125;&#125;&gt; &#x3D; (props, ref) &#x3D;&gt; &#123;  &#x2F;&#x2F; ...ç•¥&#125;</code></pre></li></ul><p>ä»£ç çš„ç›®çš„æ˜¯ï¼š </p><ol><li>è¯·æ±‚è¯¦æƒ…</li><li>è£…é…æ•°æ®ï¼Œæ›´æ–°values</li><li>useCaculateDays é€šè¿‡åå°åŠ¨æ€è®¡ç®—æœ‰æ•ˆå·¥ä½œæ—¥ï¼Œè¿”å›totalè¯·å‡å¤©æ•°ï¼Œ</li><li>æ¸²æŸ“totalåˆ°è¡¨å•å¯¹åº”ä½ç½®</li></ol><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>ç»è¿‡ä¸€ç‚¹ä¸€ç‚¹å›æº¯è°ƒè¯•ï¼Œå‘ç° useCaculateDays æ²¡è¯·æ±‚ï¼Œè¢«åˆ¤æ–­æ‹¦æˆªæ‰äº†ï¼Œå¾€ä¸Šæ‰¾æ‰¾ï¼Œ</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">form.setFieldsValue(obj)setValues(form.getFieldsValue())</code></pre><h3 id="æ‰“ä¸Šæ—¥å¿—"><a href="#æ‰“ä¸Šæ—¥å¿—" class="headerlink" title="æ‰“ä¸Šæ—¥å¿—"></a>æ‰“ä¸Šæ—¥å¿—</h3><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">&#x2F;&#x2F; ...ç•¥console.log(&quot;obj&quot;,obj);form.setFieldsValue(obj)console.log(&quot;obj1&quot;,form.getFieldsValue());setValues(obj)</code></pre><p>å‘ç°<code>obj</code>é”®å€¼å†…å®¹ä¸ç­‰äº<code>obj1</code></p><ul><li>obj</li></ul><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;    &quot;staffId&quot;: &quot;02333&quot;,    &quot;attendanceType&quot;: 11,    &quot;applyStartTime&quot;: &#123;        &quot;value&quot;: &quot;2022-03-23T16:00:00.000Z&quot;,        &quot;half&quot;: 1    &#125;,    &quot;applyEndTime&quot;: &#123;        &quot;value&quot;: &quot;2022-03-23T16:00:00.000Z&quot;,        &quot;half&quot;: 2    &#125;,    &quot;applyReason&quot;: &quot;&quot;,    &quot;applyAttachments&quot;: []&#125;</code></pre><ul><li>obj1<pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;    &quot;staffId&quot;: &quot;02333&quot;,    &quot;attendanceType&quot;: 11,    &quot;applyReason&quot;: &quot;&quot;,    &quot;applyAttachments&quot;: []&#125;</code></pre></li></ul><p><em>çŒœæƒ³</em></p><ul><li>ä¼šä¸ä¼š<code>form.setFieldsValue</code>å¼‚æ­¥ï¼ŸæŸ¥äº†ä¸‹apiæ˜¯åŒæ­¥çš„<em>æ’é™¤è¿™ç§å¯èƒ½</em></li><li>æ–­ç‚¹è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šé‡åˆ°è¡¨å•æ¸²æŸ“ä¸€åŠçš„æƒ…å†µï¼Œ<code>AnualFormç»„ä»¶</code>æ˜¯æ¡ä»¶æ¸²æŸ“ï¼Œå¦‚æœè¿™å—è¡¨å•æ²¡æœ‰æ¸²æŸ“å‡ºæ¥ï¼Œé€šè¿‡<code>form.getFieldsValue</code>å°±æ‹¿ä¸åˆ°</li></ul><h3 id="ä¿®æ”¹ä»£ç éªŒè¯ä¸‹çŒœæƒ³"><a href="#ä¿®æ”¹ä»£ç éªŒè¯ä¸‹çŒœæƒ³" class="headerlink" title="ä¿®æ”¹ä»£ç éªŒè¯ä¸‹çŒœæƒ³"></a>ä¿®æ”¹ä»£ç éªŒè¯ä¸‹çŒœæƒ³</h3><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">console.log(&quot;obj&quot;,obj);form.setFieldsValue(obj)console.log(&quot;obj1&quot;,form.getFieldsValue());setTimeout(() &#x3D;&gt; &#123;  setValues(form.getFieldsValue())  &#125;, 5000);&#125;</code></pre><img src="http://t-blog-images.aijs.top/img/Kapture%202022-05-13%20at%2016.01.46.gif" width=300 /><h3 id="æœ€ç»ˆä¿®æ”¹"><a href="#æœ€ç»ˆä¿®æ”¹" class="headerlink" title="æœ€ç»ˆä¿®æ”¹"></a>æœ€ç»ˆä¿®æ”¹</h3><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">form.setFieldsValue(obj)setValues(obj)</code></pre>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ModHeader</title>
      <link href="//post/2022-05-13modeheader.html"/>
      <url>//post/2022-05-13modeheader.html</url>
      
        <content type="html"><![CDATA[<h2 id="é€šè¿‡ä¸åŒè¯·æ±‚å¤´å­—æ®µæ ‡è¯†è¯·æ±‚ä¸åŒçš„ç¯å¢ƒ"><a href="#é€šè¿‡ä¸åŒè¯·æ±‚å¤´å­—æ®µæ ‡è¯†è¯·æ±‚ä¸åŒçš„ç¯å¢ƒ" class="headerlink" title="é€šè¿‡ä¸åŒè¯·æ±‚å¤´å­—æ®µæ ‡è¯†è¯·æ±‚ä¸åŒçš„ç¯å¢ƒ"></a>é€šè¿‡ä¸åŒè¯·æ±‚å¤´å­—æ®µæ ‡è¯†è¯·æ±‚ä¸åŒçš„ç¯å¢ƒ</h2><img src="http://t-blog-images.aijs.top/img/20220513145839.webp" width=400 /><h3 id="Requesr-Headers"><a href="#Requesr-Headers" class="headerlink" title="Requesr Headers"></a>Requesr Headers</h3><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Accept: *&#x2F;*Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8,zh-TW;q&#x3D;0.7Cache-Control: no-cacheConnection: keep-alivecontent-type: application&#x2F;json; charset&#x3D;utf-8Cookie: perfLang&#x3D;zh; envtag: ladon-1        Host: localhost:3119Pragma: no-cacheReferer: http:&#x2F;&#x2F;localhost:3119&#x2F;sec-ch-ua: &quot; Not A;Brand&quot;;v&#x3D;&quot;99&quot;, &quot;Chromium&quot;;v&#x3D;&quot;101&quot;, &quot;Google Chrome&quot;;v&#x3D;&quot;101&quot;sec-ch-ua-mobile: ?0sec-ch-ua-platform: &quot;macOS&quot;</code></pre><h3 id="ä¸ç”Ÿæ•ˆäº†"><a href="#ä¸ç”Ÿæ•ˆäº†" class="headerlink" title="ä¸ç”Ÿæ•ˆäº†"></a>ä¸ç”Ÿæ•ˆäº†</h3><p>ç†è®ºä¸Šæ˜¯æ²¡é—®é¢˜ï¼Œåº”è¯¥æ˜¯ç”±äºæŸäº›åŸå› å¯¼è‡´è¿™ä¸ªæ’ä»¶å†…éƒ¨è¿è¡Œå‡ºäº†é—®é¢˜ï¼Œå…·ä½“ä»€ä¹ˆé—®é¢˜ä¸çŸ¥<br><em>å¤„ç†ï¼š</em>å°†æµè§ˆå™¨é‡å¯åŠ¨å,è¯·æ±‚å¤´<code>envtag: ladon-1</code>å¢åŠ æˆåŠŸ</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> Chrome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-æ€§èƒ½ä¼˜åŒ–1</title>
      <link href="//post/2022-05-12performance.html"/>
      <url>//post/2022-05-12performance.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼˜åŒ–çš„æŒ‡æ ‡"><a href="#ä¼˜åŒ–çš„æŒ‡æ ‡" class="headerlink" title="ä¼˜åŒ–çš„æŒ‡æ ‡"></a>ä¼˜åŒ–çš„æŒ‡æ ‡</h2><p>ç™½å±æ—¶é—´ &#x3D; åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨å‡ºç°ç¬¬ä¸€ä¸ªå…ƒç´ <br>é¦–å±æ—¶é—´ &#x3D; åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨ç¬¬ä¸€å±æ¸²æŸ“å®Œæˆ</p><p>å½±å“ç™½å±æ—¶é—´çš„å› ç´ ï¼šç½‘ç»œï¼ŒæœåŠ¡ç«¯æ€§èƒ½ï¼Œå‰ç«¯é¡µé¢ç»“æ„è®¾è®¡ã€‚<br>å½±å“é¦–å±æ—¶é—´çš„å› ç´ ï¼šç™½å±æ—¶é—´ï¼Œèµ„æºä¸‹è½½æ‰§è¡Œæ—¶é—´ã€‚</p><p>é€šå¸¸åœ¨ head è§£æå®Œï¼Œbody å¼€å§‹æ¸²æŸ“æ­¤æ—¶æ˜¯ç™½å±ç»“æŸ<br>ç™½å±æ—¶é—´ &#x3D; firstPaint - performance.timing.navigationStart || pageStartTime</p><h2 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h2><ol><li>é¦–å±æ¨¡å—æ ‡ç­¾æ ‡è®°ï¼Œ ä½ è§‰å¾—é¦–å±å®Œæˆçš„åœ°æ–¹æ’å…¥è„šæœ¬</li><li>åŒçº§é¦–å±å†…åŠ è½½æœ€æ…¢çš„å›¾ç‰‡&#x2F;iframe</li></ol><p>è¿™ä¸ªå›¾çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¾€ä¸‹çœ‹ï¼Œåé¢ä¼šä»¥ç®€ä¹¦ä»£ç å’Œæ˜é‡‘æ¥éªŒè¯è¿™å¹…å›¾çš„æ­£ç¡®æ€§</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9sejV6LmNvbS9hc3NldHMvaW1nL3BlcmZvcm1hbmNlLnBuZw?x-oss-process=image/format,png"></p><p><strong>ç¼ºå¤±éƒ¨åˆ†ï¼šsecureConnectionStart</strong></p><h2 id="ç›´è§‚æ„Ÿå—ä¸‹"><a href="#ç›´è§‚æ„Ÿå—ä¸‹" class="headerlink" title="ç›´è§‚æ„Ÿå—ä¸‹"></a>ç›´è§‚æ„Ÿå—ä¸‹</h2><img src="http://t-blog-images.aijs.top/img/202207290919904.webp" /><p>æ³¨æ„ä¸‹é¢çš„ä¸€è¡Œå°å­—ï¼š <a href="https://web.dev/custom-metrics/?utm_source=devtools#server-timing-api" target="_blank" >the Server Timing API</a></p><h2 id="è¾“å…¥-url-å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#è¾“å…¥-url-å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="è¾“å…¥ url å‘ç”Ÿäº†ä»€ä¹ˆ"></a>è¾“å…¥ url å‘ç”Ÿäº†ä»€ä¹ˆ</h2><ul><li>1ã€å½“æµè§ˆå™¨åœ°å€ä¸­è¾“å…¥ url åï¼Œ<code>navigationStart</code>å¦‚æœä¹‹å‰æœ‰å‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢ä¸ä¸€å®šåŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³,å¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰,</li><li>2ã€æ¥ç€ï¼Œæ˜¯å¦æœ‰é‡å®šå‘ï¼ˆ<code>redirect</code> ï¼‰</li><li>3ã€æ¥ç€ï¼Œå‡†å¤‡ç”¨ HTTP æŠ“å–æ–‡æ¡£çš„å†…å®¹ï¼ˆ<code>fetchStart</code>ï¼‰æŸ¥çœ‹<code>APP Cache</code><ul><li>åŸŸåæŸ¥è¯¢ï¼ˆ<code>domainLookupStartã€domainLookupEnd</code>ï¼‰</li><li>TCP è¿æ¥ï¼ˆ<code>connectStartã€connectEnd</code>ï¼‰,å¦‚æœæ˜¯å®‰å…¨é“¾æ¥ï¼Œåœ¨ connectEnd ä¹‹å‰ï¼Œä¼šæœ‰ SSL è¿æ¥(secureConnectionStart)</li></ul></li><li>4ã€æ¥ç€ï¼ŒHTTP è¯·æ±‚ï¼ˆ<code>requestStartã€responseStartã€responseEnd</code>ï¼‰,å¦‚æœæœ‰ç¼“å­˜ï¼Œåœ¨ responseStart ä¹‹å‰ï¼Œä¼šæœ‰ cacheStartï¼Œå¦‚æœä¹‹å‰æœ‰ç½‘é¡µï¼Œè¿˜æ¶‰åŠåˆ°ç½‘é¡µçš„ unloadï¼Œåœ¨ cacheStart ä¹‹å‰ï¼Œä¼šæœ‰<code>unloadStartã€unloadEnd</code></li><li>5ã€æ¥ç€ï¼Œdom è§£æ<ul><li><code>domLoading</code>Document.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶</li><li><code>domInteractive</code>Document.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶</li><li><code>domContentLoadedEventStartã€domContentLoadedEventEnd </code>DOM è§£æå®Œæˆåï¼Œ<ul><li>ç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹ï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶</li><li>ç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶</li></ul></li><li><code>domComplete</code>Document.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶</li><li><code>loadEventStart</code>load äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œ</li><li><code>loadEventEnd</code>load äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´</li><li>è¯´æ˜ï¼šdom è§£æè¿‡ç¨‹ï¼ŒHTML ç”Ÿæˆ dom æ ‘ï¼Œè§£æ CSS æ–‡ä»¶ç”Ÿæˆ CSSOM æ ‘ï¼ŒDOM æ ‘å’Œ CSSOM æ ‘ç”Ÿæˆ render æ ‘ï¼Œä¹Ÿå°±æ˜¯æ¸²æŸ“æ ‘ï¼Œ render æ ‘ä¸­å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå¸ƒå±€ï¼Œè®¡ç®—æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œç¡®å®šå…¶åœ¨å±å¹•ä¸­çš„ä½ç½®ï¼Œç»˜åˆ¶ã€‚æ ¹æ® render æ ‘å’Œå¸ƒå±€å°†æ˜¾ç¤ºé¡µé¢</li></ul></li></ul><h2 id="åŠ è½½é˜¶æ®µ"><a href="#åŠ è½½é˜¶æ®µ" class="headerlink" title="åŠ è½½é˜¶æ®µ"></a>åŠ è½½é˜¶æ®µ</h2><p>å·¦è¾¹çº¢çº¿ä»£è¡¨çš„æ˜¯ç½‘ç»œä¼ è¾“å±‚é¢çš„è¿‡ç¨‹ï¼Œå³è¾¹çº¢çº¿ä»£è¡¨äº†æœåŠ¡å™¨ä¼ è¾“å›å­—èŠ‚åæµè§ˆå™¨çš„å„ç§äº‹ä»¶çŠ¶æ€ï¼Œè¿™ä¸ªé˜¶æ®µåŒ…å«äº†æµè§ˆå™¨å¯¹æ–‡æ¡£çš„è§£æï¼ŒDOM æ ‘æ„å»ºï¼Œå¸ƒå±€ï¼Œç»˜åˆ¶ç­‰ç­‰ã€‚</p><p>  <em>1. prompt for unload</em></p><ul><li>navigationStart: è¡¨ç¤ºä»ä¸Šä¸€ä¸ªæ–‡æ¡£å¸è½½ç»“æŸæ—¶çš„ unix æ—¶é—´æˆ³ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸€ä¸ªæ–‡æ¡£ï¼Œè¿™ä¸ªå€¼å°†å’Œ fetchStart ç›¸ç­‰ã€‚<br><em>2. å‰ä¸€ä¸ªç½‘é¡µå¸è½½</em></li><li>unloadEventStart: è¡¨ç¤ºå‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢åŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload æˆ–è€…å‰ä¸€ä¸ªç½‘é¡µä¸å½“å‰é¡µé¢ä¸åŒåŸŸï¼Œåˆ™å€¼ä¸º 0ã€‚</li><li>unloadEventEnd: è¿”å›å‰ä¸€ä¸ªé¡µé¢ unload æ—¶é—´ç»‘å®šçš„å›æ‰å‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´æˆ³ã€‚<br><em>3. é‡å®šå‘</em></li><li>redirectStart: ç¬¬ä¸€ä¸ª HTTP é‡å®šå‘å‘ç”Ÿæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0ã€‚</li><li>redirectEnd: æœ€åä¸€ä¸ª HTTP é‡å®šå‘å®Œæˆæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…éƒ¨çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0ã€‚<br><em>4. ä½¿ç”¨ HTTP è¯·æ±‚</em></li><li>fetchStart: æµè§ˆå™¨å‡†å¤‡å¥½ä½¿ç”¨ HTTP è¯·æ±‚æŠ“å–æ–‡æ¡£çš„æ—¶é—´ï¼Œè¿™å‘ç”Ÿåœ¨æ£€æŸ¥æœ¬åœ°ç¼“å­˜ä¹‹å‰ã€‚<br><em>5. åŸŸåè§£æ</em></li><li>domainLookupStart&#x2F;domainLookupEnd: DNS åŸŸåæŸ¥è¯¢å¼€å§‹&#x2F;ç»“æŸçš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰<br><em>6. tcp é“¾æ¥</em></li><li>connectStart: HTTPï¼ˆTCPï¼‰å¼€å§‹&#x2F;é‡æ–° å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰ã€‚<br><em>7. ssl å»ºç«‹</em></li><li>secureConnectionStart: HTTPS è¿æ¥å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œåˆ™å€¼ä¸º 0ã€‚</li><li>connectEnd: HTTPï¼ˆTCPï¼‰ å®Œæˆå»ºç«‹è¿æ¥çš„æ—¶é—´ï¼ˆå®Œæˆæ¡æ‰‹ï¼‰ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰ã€‚<br><em>8. è¯»å–æ–‡æ¡£</em></li><li>requestStart: HTTP è¯·æ±‚è¯»å–çœŸå®æ–‡æ¡£å¼€å§‹çš„æ—¶é—´ï¼ˆå®Œæˆå»ºç«‹è¿æ¥ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚<br><em>9. å“åº”</em></li><li>responseStart: HTTP å¼€å§‹æ¥æ”¶å“åº”çš„æ—¶é—´ï¼ˆè·å–åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚</li><li>responseEnd: HTTP å“åº”å…¨éƒ¨æ¥æ”¶å®Œæˆçš„æ—¶é—´ï¼ˆè·å–åˆ°æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚<br><em>10. è§£æ dom</em></li><li>domLoading: å¼€å§‹è§£ææ¸²æŸ“ DOM æ ‘çš„æ—¶é—´ï¼Œæ­¤æ—¶ Document.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ã€‚<br><em>11. dom å¯äº¤äº’</em></li><li>domInteractive: å®Œæˆè§£æ DOM æ ‘çš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ï¼Œæ³¨æ„åªæ˜¯ DOM æ ‘è§£æå®Œæˆï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰å¼€å§‹åŠ è½½ç½‘é¡µå†…çš„èµ„æºã€‚<br><em>12. é¡µé¢å†…èµ„æºåŠ è½½</em></li><li>domContentLoadedEventStart: DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹çš„æ—¶é—´ï¼Œåœ¨ DOMContentLoaded äº‹ä»¶æŠ›å‡ºå‰å‘ç”Ÿã€‚</li><li>domContentLoadedEventEnd: DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆçš„æ—¶é—´ï¼ˆå¦‚ JS è„šæœ¬åŠ è½½æ‰§è¡Œå®Œæ¯•ï¼‰ã€‚<br><em>13. dom æ ‘è§£æå®Œæˆ</em></li><li>domComplete: DOM æ ‘è§£æå®Œæˆï¼Œä¸”èµ„æºä¹Ÿå‡†å¤‡å°±ç»ªçš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ã€‚<br><em>14. load äº‹ä»¶</em></li><li>loadEventStart: load äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ã€‚</li><li>loadEventEnd: load äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´ã€‚</li></ul><h2 id="Performance-æ¥å£"><a href="#Performance-æ¥å£" class="headerlink" title="Performance æ¥å£"></a>Performance æ¥å£</h2><p>Performance æ¥å£å¯ä»¥è·å–åˆ°å½“å‰é¡µé¢ä¸æ€§èƒ½ç›¸å…³çš„ä¿¡æ¯ã€‚</p><div class="custom-quote tip"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06"></path><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M11.99 18H12.01"></path></svg></span><p class="custom-quote-title">TIP</p><p><strong>æ•°æ®å…ˆä¸è¦å…³æ³¨æ—¶é—´å¾ªåºï¼Œåé¢æˆ‘ä»¬ä¼šä»å¤šä¸ªè§’åº¦æ¥éªŒè¯é¡ºåº</strong></p></div><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;  &quot;timeOrigin&quot;: 1652338539312.5,  &#x2F;&#x2F; é¡ºåºå·²ç»æ’å¥½äº†  &quot;timing&quot;: &#123;    &#x2F;&#x2F; åœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­ï¼Œå‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢ä¸ä¸€å®šåŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰    &quot;navigationStart&quot;: 1652338539312,    &#x2F;&#x2F; ç¬¬ä¸€ä¸ª HTTP é‡å®šå‘å‘ç”Ÿæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0    &quot;redirectStart&quot;: 0,    &#x2F;&#x2F; æœ€åä¸€ä¸ª HTTP é‡å®šå‘å®Œæˆæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…éƒ¨çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0    &quot;redirectEnd&quot;: 0,    &#x2F;&#x2F; æµè§ˆå™¨å‡†å¤‡å¥½ä½¿ç”¨ HTTP è¯·æ±‚æŠ“å–æ–‡æ¡£çš„æ—¶é—´ï¼Œè¿™å‘ç”Ÿåœ¨æ£€æŸ¥æœ¬åœ°ç¼“å­˜ä¹‹å‰    &quot;fetchStart&quot;: 1652338539316,    &#x2F;&#x2F; DNS åŸŸåæŸ¥è¯¢å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰    &quot;domainLookupStart&quot;: 1652338539353,    &#x2F;&#x2F; DNS åŸŸåæŸ¥è¯¢å®Œæˆçš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰    &quot;domainLookupEnd&quot;: 1652338539353,    &#x2F;&#x2F; HTTPï¼ˆTCPï¼‰ å¼€å§‹å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰    &#x2F;&#x2F; æ³¨æ„å¦‚æœåœ¨ä¼ è¾“å±‚å‘ç”Ÿäº†é”™è¯¯ä¸”é‡æ–°å»ºç«‹è¿æ¥ï¼Œåˆ™è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯æ–°å»ºç«‹çš„è¿æ¥å¼€å§‹çš„æ—¶é—´    &quot;connectStart&quot;: 1652338539353,    &#x2F;&#x2F; HTTPS è¿æ¥å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œåˆ™å€¼ä¸º 0    &quot;secureConnectionStart&quot;: 1652338539401,    &#x2F;&#x2F; HTTPï¼ˆTCPï¼‰ å®Œæˆå»ºç«‹è¿æ¥çš„æ—¶é—´ï¼ˆå®Œæˆæ¡æ‰‹ï¼‰ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰    &#x2F;&#x2F; æ³¨æ„å¦‚æœåœ¨ä¼ è¾“å±‚å‘ç”Ÿäº†é”™è¯¯ä¸”é‡æ–°å»ºç«‹è¿æ¥ï¼Œåˆ™è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯æ–°å»ºç«‹çš„è¿æ¥å®Œæˆçš„æ—¶é—´    &#x2F;&#x2F; æ³¨æ„è¿™é‡Œæ¡æ‰‹ç»“æŸï¼ŒåŒ…æ‹¬å®‰å…¨è¿æ¥å»ºç«‹å®Œæˆã€SOCKS æˆæƒé€šè¿‡    &quot;connectEnd&quot;: 1652338539504,    &#x2F;&#x2F; HTTP è¯·æ±‚è¯»å–çœŸå®æ–‡æ¡£å¼€å§‹çš„æ—¶é—´ï¼ˆå®Œæˆå»ºç«‹è¿æ¥ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜    &#x2F;&#x2F; è¿æ¥é”™è¯¯é‡è¿æ—¶ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„ä¹Ÿæ˜¯æ–°å»ºç«‹è¿æ¥çš„æ—¶é—´    &quot;requestStart&quot;: 1652338539505,    &#x2F;&#x2F; HTTP å¼€å§‹æ¥æ”¶å“åº”çš„æ—¶é—´ï¼ˆè·å–åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜    &quot;responseStart&quot;: 1652338539807,    &#x2F;&#x2F; å‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢åŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload æˆ–è€…å‰ä¸€ä¸ªç½‘é¡µä¸å½“å‰é¡µé¢ä¸åŒåŸŸï¼Œåˆ™å€¼ä¸º 0    &quot;unloadEventStart&quot;: 0,    &#x2F;&#x2F; å’Œ unloadEventStart ç›¸å¯¹åº”ï¼Œè¿”å›å‰ä¸€ä¸ªç½‘é¡µ unload äº‹ä»¶ç»‘å®šçš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´æˆ³    &quot;unloadEventEnd&quot;: 0,    &#x2F;&#x2F; HTTP å“åº”å…¨éƒ¨æ¥æ”¶å®Œæˆçš„æ—¶é—´ï¼ˆè·å–åˆ°æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜    &quot;responseEnd&quot;: 1652338539828,    &#x2F;&#x2F; å¼€å§‹è§£ææ¸²æŸ“ DOM æ ‘çš„æ—¶é—´ï¼Œæ­¤æ—¶ Document.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶    &quot;domLoading&quot;: 1652338539823,    &#x2F;&#x2F; å®Œæˆè§£æ DOM æ ‘çš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶    &#x2F;&#x2F; æ³¨æ„åªæ˜¯ DOM æ ‘è§£æå®Œæˆï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰å¼€å§‹åŠ è½½ç½‘é¡µå†…çš„èµ„æº    &quot;domInteractive&quot;: 1652338540574,    &#x2F;&#x2F; DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹çš„æ—¶é—´    &#x2F;&#x2F; åœ¨ DOMContentLoaded äº‹ä»¶æŠ›å‡ºå‰å‘ç”Ÿ    &quot;domContentLoadedEventStart&quot;: 1652338540574,    &#x2F;&#x2F; DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆçš„æ—¶é—´ï¼ˆå¦‚ JS è„šæœ¬åŠ è½½æ‰§è¡Œå®Œæ¯•ï¼‰    &quot;domContentLoadedEventEnd&quot;: 1652338540575,    &#x2F;&#x2F; load äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶é—´    &#x2F;&#x2F; æ³¨æ„å¦‚æœæ²¡æœ‰ç»‘å®š load äº‹ä»¶ï¼Œå€¼ä¸º 0    &quot;loadEventStart&quot;: 1652338542489,    &#x2F;&#x2F; load äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´    &quot;loadEventEnd&quot;: 1652338542492,    &#x2F;&#x2F; DOM æ ‘è§£æå®Œæˆï¼Œä¸”èµ„æºä¹Ÿå‡†å¤‡å°±ç»ªçš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶    &quot;domComplete&quot;: 1652338542489  &#125;,  &quot;navigation&quot;: &#123;    &#x2F;&#x2F; 0   å³ TYPE_NAVIGATENEXT æ­£å¸¸è¿›å…¥çš„é¡µé¢ï¼ˆéåˆ·æ–°ã€éé‡å®šå‘ç­‰ï¼‰    &#x2F;&#x2F; 1   å³ TYPE_RELOAD       é€šè¿‡ window.location.reload() åˆ·æ–°çš„é¡µé¢    &#x2F;&#x2F; 2   å³ TYPE_BACK_FORWARD é€šè¿‡æµè§ˆå™¨çš„å‰è¿›åé€€æŒ‰é’®è¿›å…¥çš„é¡µé¢ï¼ˆå†å²è®°å½•ï¼‰    &#x2F;&#x2F; 255 å³ TYPE_UNDEFINED    éä»¥ä¸Šæ–¹å¼è¿›å…¥çš„é¡µé¢    &quot;type&quot;: 0,    &quot;redirectCount&quot;: 0 &#x2F;&#x2F; &#x2F;&#x2F; å¦‚æœæœ‰é‡å®šå‘çš„è¯ï¼Œé¡µé¢é€šè¿‡å‡ æ¬¡é‡å®šå‘è·³è½¬è€Œæ¥  &#125;&#125;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">function getPerfermanceTiming() &#123;  let t &#x3D; performance.timing;  &#x2F;&#x2F; é‡å®šå‘ç»“æŸæ—¶é—´ - é‡å®šå‘å¼€å§‹æ—¶é—´  let redirect &#x3D; t.redirectEnd - t.redirectStart;  &#x2F;&#x2F; DNS æŸ¥è¯¢å¼€å§‹æ—¶é—´ - fetech start æ—¶é—´  let appCache &#x3D; t.domainLookupStart - t.fetchStart;  &#x2F;&#x2F; DNS æŸ¥è¯¢ç»“æŸæ—¶é—´ - DNS æŸ¥è¯¢å¼€å§‹æ—¶é—´  let dns &#x3D; t.domainLookupEnd - t.domainLookupStart;  &#x2F;&#x2F; å®Œæˆ TCP è¿æ¥æ¡æ‰‹æ—¶é—´ - TCP è¿æ¥å¼€å§‹æ—¶é—´  let tcp &#x3D; t.connectEnd - t.connectStart;  &#x2F;&#x2F; ä»è¯·æ±‚å¼€å§‹åˆ°æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªå“åº”å­—ç¬¦çš„æ—¶é—´  let ttfb &#x3D; t.responseStart - t.requestStart;  &#x2F;&#x2F; èµ„æºä¸‹è½½æ—¶é—´ï¼Œå“åº”ç»“æŸæ—¶é—´ - å“åº”å¼€å§‹æ—¶é—´  let contentDL &#x3D; t.responseEnd - t.responseStart;  &#x2F;&#x2F; ä»è¯·æ±‚å¼€å§‹åˆ°å“åº”ç»“æŸçš„æ—¶é—´  let httpTotal &#x3D; t.responseEnd - t.requestStart;  &#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° domContentLoadedEventEnd  let domContentloaded &#x3D; t.domContentLoadedEventEnd - t.navigationStart;  &#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° loadEventEnd  let loaded &#x3D; t.loadEventEnd - t.navigationStart;  let result &#x3D; [    &#123; key: &quot;Redirect&quot;, desc: &quot;ç½‘é¡µé‡å®šå‘çš„è€—æ—¶&quot;, value: redirect &#125;,    &#123; key: &quot;AppCache&quot;, desc: &quot;æ£€æŸ¥æœ¬åœ°ç¼“å­˜çš„è€—æ—¶&quot;, value: appCache &#125;,    &#123; key: &quot;DNS&quot;, desc: &quot;DNSæŸ¥è¯¢çš„è€—æ—¶&quot;, value: dns &#125;,    &#123; key: &quot;TCP&quot;, desc: &quot;TCPè¿æ¥çš„è€—æ—¶&quot;, value: tcp &#125;,    &#123;      key: &quot;Waiting(TTFB)&quot;,      desc: &quot;ä»å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚åˆ°æ¥æ”¶åˆ°å“åº”çš„æ—¶é—´ &#x2F; Time To First Byte&quot;,      value: ttfb,    &#125;,    &#123;      key: &quot;Content Download&quot;,      desc: &quot;ä¸‹è½½æœåŠ¡ç«¯è¿”å›æ•°æ®çš„æ—¶é—´&quot;,      value: contentDL,    &#125;,    &#123; key: &quot;HTTP Total Time&quot;, desc: &quot;httpè¯·æ±‚æ€»è€—æ—¶&quot;, value: httpTotal &#125;,    &#123;      key: &quot;DOMContentLoaded&quot;,      desc: &quot;domåŠ è½½å®Œæˆçš„æ—¶é—´&quot;,      value: domContentloaded,    &#125;,    &#123; key: &quot;Loaded&quot;, desc: &quot;é¡µé¢loadçš„æ€»è€—æ—¶&quot;, value: loaded &#125;,  ];  return result;&#125;getPerfermanceTiming();</code></pre><hr/><h2 id="èŠä¸‹æ€§èƒ½è®¡ç®—"><a href="#èŠä¸‹æ€§èƒ½è®¡ç®—" class="headerlink" title="èŠä¸‹æ€§èƒ½è®¡ç®—"></a>èŠä¸‹æ€§èƒ½è®¡ç®—</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; è®¡ç®—åŠ è½½æ—¶é—´function getPerformanceTiming() &#123;  var performance &#x3D; window.performance;  if (!performance) &#123;    &#x2F;&#x2F; å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ    console.log(&quot;ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ performance æ¥å£&quot;);    return;  &#125;  var t &#x3D; performance.timing;  var times &#x3D; &#123;&#125;;  &#x2F;&#x2F;ã€é‡è¦ã€‘é¡µé¢åŠ è½½å®Œæˆçš„æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘è¿™å‡ ä¹ä»£è¡¨äº†ç”¨æˆ·ç­‰å¾…é¡µé¢å¯ç”¨çš„æ—¶é—´  times.loadPage &#x3D; t.loadEventEnd - t.navigationStart;  &#x2F;&#x2F;ã€é‡è¦ã€‘è§£æ DOM æ ‘ç»“æ„çš„æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘åçœä¸‹ä½ çš„ DOM æ ‘åµŒå¥—æ˜¯ä¸æ˜¯å¤ªå¤šäº†ï¼  times.domReady &#x3D; t.domComplete - t.responseEnd;  &#x2F;&#x2F;ã€é‡è¦ã€‘é‡å®šå‘çš„æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘æ‹’ç»é‡å®šå‘ï¼æ¯”å¦‚ï¼Œhttp:&#x2F;&#x2F;example.com&#x2F; å°±ä¸è¯¥å†™æˆ http:&#x2F;&#x2F;example.com  times.redirect &#x3D; t.redirectEnd - t.redirectStart;  &#x2F;&#x2F;ã€é‡è¦ã€‘DNS æŸ¥è¯¢æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘DNS é¢„åŠ è½½åšäº†ä¹ˆï¼Ÿé¡µé¢å†…æ˜¯ä¸æ˜¯ä½¿ç”¨äº†å¤ªå¤šä¸åŒçš„åŸŸåå¯¼è‡´åŸŸåæŸ¥è¯¢çš„æ—¶é—´å¤ªé•¿ï¼Ÿ  &#x2F;&#x2F; å¯ä½¿ç”¨ HTML5 Prefetch é¢„æŸ¥è¯¢ DNS ï¼Œè§ï¼š[HTML5 prefetch](http:&#x2F;&#x2F;segmentfault.com&#x2F;a&#x2F;1190000000633364)  times.lookupDomain &#x3D; t.domainLookupEnd - t.domainLookupStart;  &#x2F;&#x2F;ã€é‡è¦ã€‘è¯»å–é¡µé¢ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘è¿™å¯ä»¥ç†è§£ä¸ºç”¨æˆ·æ‹¿åˆ°ä½ çš„èµ„æºå ç”¨çš„æ—¶é—´ï¼ŒåŠ å¼‚åœ°æœºæˆ¿äº†ä¹ˆï¼ŒåŠ CDN å¤„ç†äº†ä¹ˆï¼ŸåŠ å¸¦å®½äº†ä¹ˆï¼ŸåŠ  CPU è¿ç®—é€Ÿåº¦äº†ä¹ˆï¼Ÿ  &#x2F;&#x2F; TTFB å³ Time To First Byte çš„æ„æ€  &#x2F;&#x2F; ç»´åŸºç™¾ç§‘ï¼šhttps:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Time_To_First_Byte  times.ttfb &#x3D; t.responseStart - t.navigationStart;  &#x2F;&#x2F;ã€é‡è¦ã€‘å†…å®¹åŠ è½½å®Œæˆçš„æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘é¡µé¢å†…å®¹ç»è¿‡ gzip å‹ç¼©äº†ä¹ˆï¼Œé™æ€èµ„æº css&#x2F;js ç­‰å‹ç¼©äº†ä¹ˆï¼Ÿ  times.request &#x3D; t.responseEnd - t.requestStart;  &#x2F;&#x2F;ã€é‡è¦ã€‘æ‰§è¡Œ onload å›è°ƒå‡½æ•°çš„æ—¶é—´  &#x2F;&#x2F;ã€åŸå› ã€‘æ˜¯å¦å¤ªå¤šä¸å¿…è¦çš„æ“ä½œéƒ½æ”¾åˆ° onload å›è°ƒå‡½æ•°é‡Œæ‰§è¡Œäº†ï¼Œè€ƒè™‘è¿‡å»¶è¿ŸåŠ è½½ã€æŒ‰éœ€åŠ è½½çš„ç­–ç•¥ä¹ˆï¼Ÿ  times.loadEvent &#x3D; t.loadEventEnd - t.loadEventStart;  &#x2F;&#x2F; DNS ç¼“å­˜æ—¶é—´  times.appcache &#x3D; t.domainLookupStart - t.fetchStart;  &#x2F;&#x2F; å¸è½½é¡µé¢çš„æ—¶é—´  times.unloadEvent &#x3D; t.unloadEventEnd - t.unloadEventStart;  &#x2F;&#x2F; TCP å»ºç«‹è¿æ¥å®Œæˆæ¡æ‰‹çš„æ—¶é—´  times.connect &#x3D; t.connectEnd - t.connectStart;  return times;&#125;</code></pre><h2 id="èŠä¸‹æ€§èƒ½ä¼˜åŒ–"><a href="#èŠä¸‹æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="èŠä¸‹æ€§èƒ½ä¼˜åŒ–"></a>èŠä¸‹æ€§èƒ½ä¼˜åŒ–</h2><p><strong>å‡è®¾ä½ å¯¹ performance API å¾ˆç†Ÿæ‚‰</strong></p><ul><li>å‡å°‘é‡å®šå‘æ¬¡æ•°</li><li>DNS æŸ¥è¯¢æ—¶é—´ï¼šHTML5 Prefetch é¢„æŸ¥è¯¢</li><li>TCP è¿æ¥: http1.1 å¼€å¯ connect: keep-alive, http2.0ï¼Œ å¦‚æœå¯ä»¥çš„è¯ <strong>http3.0 å¯ä»¥çœ‹æœ¬ç«™å¦ä¸€ç¯‡æ–‡ç« </strong></li><li>èµ„æºå‹ç¼©ï¼šgzipã€brotliã€å›¾ç‰‡å‹ç¼©ã€tree-shakingã€consoleã€CDN ç§»é™¤</li><li>èµ„æºæ•´åˆï¼šå‡å°‘è¯·æ±‚æ¬¡æ•°ã€å‡å°‘ç½‘ç»œè¯·æ±‚ï¼Œé›ªç¢§å›¾ï¼ˆè™½ç„¶ http2 æä¾›äº†<strong>å¤šè·¯å¤ç”¨</strong>[å¤šè·¯å¤ç”¨ä»£æ›¿äº† HTTP1.x çš„åºåˆ—å’Œé˜»å¡æœºåˆ¶ï¼Œæ‰€æœ‰çš„ç›¸åŒåŸŸåè¯·æ±‚éƒ½é€šè¿‡åŒä¸€ä¸ª TCP è¿æ¥å¹¶å‘å®Œæˆã€‚åœ¨ HTTP1.x ä¸­ï¼Œå¹¶å‘å¤šä¸ªè¯·æ±‚éœ€è¦å¤šä¸ª TCP è¿æ¥ï¼Œæµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºä¼šæœ‰ 6-8 ä¸ª TCP è¿æ¥éƒ½é™åˆ¶,å•ä¸ªè¿æ¥ä¸Šå¯ä»¥å¹¶è¡Œäº¤é”™çš„è¯·æ±‚å’Œå“åº”ï¼Œä¹‹é—´äº’ä¸å¹²æ‰°,ä½†æ˜¯æ•°é‡çŒ›å¢ï¼ŒæœåŠ¡å™¨è¦å¤„ç†ï¼Œå¤šå¤šå°‘å°‘ä¹Ÿè€—æ€§èƒ½]çš„èƒ½åŠ›ï¼Œè€Œä¸”ç°åœ¨è¿˜æœ‰ä½¿ç”¨çš„å¸¸è§ï¼Œæ¯”èŠå¤©è¡¨æƒ…ï¼Œé£ä¹¦ä¹Ÿåœ¨ç”¨ï¼‰</li><li>èµ„æºåŠ è½½ï¼šCDNã€å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€æŒ‰éœ€åŠ è½½</li><li>DOM è§£æï¼šè‡ªä¸Šè€Œä¸‹ï¼Œscript æ ‡ç­¾æ”¾åœ¨åº•éƒ¨ï¼Œcss æ”¾åœ¨ä¸Šé¢ï¼Œæ— è®ºæ˜¯ html è¿˜æ˜¯ css çš„å±‚çº§ï¼Œåº”å°½é‡å°‘çš„è§£æï¼Œè§£ææ¶ˆè€—æ€§èƒ½</li><li>æ¸²æŸ“æ—¶å€™ï¼šå›æµå’Œé‡ç»˜ã€æ‡’åŠ è½½ã€è™šæ‹Ÿåˆ—è¡¨</li></ul><h2 id="ä¸¤ä¸ªäº‹ä¾‹"><a href="#ä¸¤ä¸ªäº‹ä¾‹" class="headerlink" title="ä¸¤ä¸ªäº‹ä¾‹"></a>ä¸¤ä¸ªäº‹ä¾‹</h2><p><strong>é£ä¹¦é›ªç¢§å›¾</strong></p><ul><li>ä¸ºä»€ä¹ˆæ‹¿é£ä¹¦æ¡Œç«¯æ•°æ®æ¥è¯´ï¼ˆä¹‹å‰å¼€å‘æ¡Œé¢ç«¯ Electronï¼Œæ‰’æ‹‰è¿‡é£ä¹¦åº”ç”¨åŒ…çš„æ•°æ®)</li></ul><img src="http://t-blog-images.aijs.top/img/20220606170307.webp" width=200 style="object-fit:content"/><p><strong>äº¬ä¸œç§»åŠ¨ç«¯ dns-prefetch</strong></p><ul><li>ä¸ºä»€ä¹ˆæ‹¿äº¬ä¸œæ•°æ®æ¥è¯´ï¼ˆä¹‹å‰çˆ¬å–è¿‡äº¬ä¸œç§»åŠ¨ç«¯æ•°æ®å¼€å‘ RN)</li></ul><p><img src="http://t-blog-images.aijs.top/img/20220606172316.webp"></p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;head&gt;  &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;  &lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;    window.alert &#x3D; console.log;  &lt;&#x2F;script&gt;  &lt;script&gt;    window._PFM_TIMING &#x3D; [[1351, new Date()]]; &#x2F;&#x2F;TODO  &lt;&#x2F;script&gt;  &lt;meta    name&#x3D;&quot;viewport&quot;    content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;0&quot;  &#x2F;&gt;  &lt;title&gt;å¤šå¿«å¥½çœï¼Œè´­ç‰©ä¸Šäº¬ä¸œï¼&lt;&#x2F;title&gt;  &lt;!-- å¼ºç¼“å­˜Cache-Control --&gt;  &lt;meta http-equiv&#x3D;&quot;Cache-Control&quot; content&#x3D;&quot;max-age&#x3D;180&quot; &#x2F;&gt;  &lt;meta name&#x3D;&quot;apple-mobile-web-app-capable&quot; content&#x3D;&quot;yes&quot; &#x2F;&gt;  &lt;meta name&#x3D;&quot;apple-mobile-web-app-status-bar-style&quot; content&#x3D;&quot;black&quot; &#x2F;&gt;  &lt;meta name&#x3D;&quot;format-detection&quot; content&#x3D;&quot;telephone&#x3D;no&quot; &#x2F;&gt;  &lt;!-- äº¬ä¸œ &lt;meta name&#x3D;&quot;format-detection&quot; content&#x3D;&quot;telephone&#x3D;no&quot; &#x2F;&gt; å†™é‡å¤äº† --&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;m.360buyimg.com&quot; &#x2F;&gt;  &lt;meta name&#x3D;&quot;format-detection&quot; content&#x3D;&quot;telephone&#x3D;no&quot; &#x2F;&gt;  &lt;meta    name&#x3D;&quot;viewport&quot;    content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;0, shrink-to-fit&#x3D;no, viewport-fit&#x3D;cover&quot;  &#x2F;&gt;  &lt;!-- X-DNS-Prefetch-Control å¤´æ§åˆ¶ç€æµè§ˆå™¨çš„ DNS é¢„è¯»å–åŠŸèƒ½  DNS é¢„è¯»å–æ˜¯ä¸€é¡¹ä½¿æµè§ˆå™¨ä¸»åŠ¨å»æ‰§è¡ŒåŸŸåè§£æçš„åŠŸèƒ½--&gt;  &lt;meta http-equiv&#x3D;&quot;x-dns-prefetch-control&quot; content&#x3D;&quot;on&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img11.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img10.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img12.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img13.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img14.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img20.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;img30.360buyimg.com&quot; &#x2F;&gt;  &lt;link rel&#x3D;&quot;dns-prefetch&quot; href&#x3D;&quot;&#x2F;&#x2F;wq.360buyimg.com&quot; &#x2F;&gt;&lt;&#x2F;head&gt;</code></pre><h2 id="performance-æ•°æ®èƒ½å¹²å•¥ç”¨ï¼Ÿ"><a href="#performance-æ•°æ®èƒ½å¹²å•¥ç”¨ï¼Ÿ" class="headerlink" title="performance æ•°æ®èƒ½å¹²å•¥ç”¨ï¼Ÿ"></a>performance æ•°æ®èƒ½å¹²å•¥ç”¨ï¼Ÿ</h2><p>ï¼ˆå¼€å‘è€…ï¼‰ç†Ÿæ‚‰ Chrome å¼€å‘è€…å·¥å…·çš„æœ‹å‹åº”è¯¥çŸ¥é“ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œå…¶å®æˆ‘ä»¬è‡ªå·±æ‰“å¼€ Chrome çš„å¼€å‘è€…å·¥å…·ï¼Œåˆ‡æ¢åˆ°ç½‘ç»œé¢æ¿ï¼Œå°±èƒ½å¾ˆè¯¦ç»†çš„çœ‹åˆ°ç½‘é¡µæ€§èƒ½ç›¸å…³çš„æ•°æ®ã€‚</p><p>ï¼ˆç½‘ç«™ç”¨æˆ·ï¼‰ä½†å½“æˆ‘ä»¬éœ€è¦ç»Ÿè®¡åˆ†æç”¨æˆ·æ‰“å¼€æˆ‘ä»¬ç½‘é¡µæ—¶çš„æ€§èƒ½å¦‚ä½•æ—¶ï¼Œæˆ‘ä»¬å°† performance åŸå§‹ä¿¡æ¯æˆ–é€šè¿‡ç®€å•è®¡ç®—åçš„ä¿¡æ¯ (å¦‚ä¸Šé¢å†™åˆ°çš„ getPerformanceTiming()) ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œé…åˆå…¶ä»–ä¿¡æ¯ï¼ˆå¦‚ HTTP è¯·æ±‚å¤´ä¿¡æ¯ï¼‰ï¼Œå°±å®Œç¾å•¦~</p><h2 id="æ¥çœ‹ä¸‹ç®€ä¹¦"><a href="#æ¥çœ‹ä¸‹ç®€ä¹¦" class="headerlink" title="æ¥çœ‹ä¸‹ç®€ä¹¦"></a>æ¥çœ‹ä¸‹ç®€ä¹¦</h2><ul><li>é“¾æ¥ <a href="https://www.jianshu.com/p/464593cea4dc" target="_blank" >ç®€ä¹¦</a> ,æ‰“å¼€æ§åˆ¶å°å¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æœä¸€ä¸ªæ•°ç»„ï¼ˆ<strong>å¦‚æœç®€ä¹¦æ²¡å°†æ­¤æ—¥å¿—å»é™¤</strong>ï¼‰</li><li>ç®€ä¹¦ä»£ç </li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">window.addEventListener(&quot;load&quot;, function () &#123;  setTimeout(function () &#123;    var e &#x3D; window.performance;    if (e) &#123;      var t &#x3D; e.getEntriesByType(&quot;navigation&quot;)[0],        r &#x3D; 0;      t || (r &#x3D; (t &#x3D; e.timing).navigationStart);      var n &#x3D; [        &#123;          key: &quot;Redirect&quot;,          desc: &quot;\u7f51\u9875\u91cd\u5b9a\u5411\u7684\u8017\u65f6&quot;,          value: t.redirectEnd - t.redirectStart,        &#125;,        &#123;          key: &quot;AppCache&quot;,          desc: &quot;\u68c0\u67e5\u672c\u5730\u7f13\u5b58\u7684\u8017\u65f6&quot;,          value: t.domainLookupStart - t.fetchStart,        &#125;,        &#123;          key: &quot;DNS&quot;,          desc: &quot;DNS\u67e5\u8be2\u7684\u8017\u65f6&quot;,          value: t.domainLookupEnd - t.domainLookupStart,        &#125;,        &#123;          key: &quot;TCP&quot;,          desc: &quot;TCP\u8fde\u63a5\u7684\u8017\u65f6&quot;,          value: t.connectEnd - t.connectStart,        &#125;,        &#123;          key: &quot;Waiting(TTFB)&quot;, &#x2F;&#x2F; TTFBï¼šTime To First Byte          desc: &quot;\u4ece\u5ba2\u6237\u7aef\u53d1\u8d77\u8bf7\u6c42\u5230\u63a5\u6536\u5230\u54cd\u5e94\u7684\u65f6\u95f4 &#x2F; Time To First Byte&quot;,          value: t.responseStart - t.requestStart,        &#125;,        &#123;          key: &quot;Content Download&quot;,          desc: &quot;\u4e0b\u8f7d\u670d\u52a1\u7aef\u8fd4\u56de\u6570\u636e\u7684\u65f6\u95f4&quot;,          value: t.responseEnd - t.responseStart,        &#125;,        &#123;          key: &quot;HTTP Total Time&quot;,          desc: &quot;http\u8bf7\u6c42\u603b\u8017\u65f6&quot;,          value: t.responseEnd - t.requestStart,        &#125;,        &#123;          key: &quot;DOMContentLoaded&quot;,          desc: &quot;dom\u52a0\u8f7d\u5b8c\u6210\u7684\u65f6\u95f4&quot;,          value: t.domContentLoadedEventEnd - r,        &#125;,        &#123;          key: &quot;Loaded&quot;,          desc: &quot;\u9875\u9762load\u7684\u603b\u8017\u65f6&quot;,          value: t.loadEventEnd - r,        &#125;,      ];      if (Math.random() &gt; 0.75) &#123;        var s &#x3D; window.location,          i &#x3D; s.href,          c &#x3D; s.pathname,          u &#x3D; navigator.userAgent,          d &#x3D; i.split(&quot;?&quot;)[0];        o.a          .post(&quot;https:&#x2F;&#x2F;tr.jianshu.com&#x2F;fe&#x2F;1&#x2F;mon&#x2F;atf&quot;, &#123;            app: &quot;shakespeare-performance&quot;,            url: d,            ua: u,            path: c,            stats_ttfb: t.responseStart - t.requestStart,            stats_domLoaded: t.domContentLoadedEventEnd - r,            stats_loaded: t.loadEventEnd - r,          &#125;)          .then(a.a)          .catch(a.a);      &#125;      console &amp;&amp; console.log &amp;&amp; console.log(n);    &#125;  &#125;, 0);&#125;);</code></pre><h2 id="ç®€ä¹¦æˆªå›¾"><a href="#ç®€ä¹¦æˆªå›¾" class="headerlink" title="ç®€ä¹¦æˆªå›¾"></a>ç®€ä¹¦æˆªå›¾</h2><p><img src="http://t-blog-images.aijs.top/img/20220605112219.webp"></p><h2 id="domContentLoaded-ä¸-loaded"><a href="#domContentLoaded-ä¸-loaded" class="headerlink" title="domContentLoaded ä¸ loaded"></a>domContentLoaded ä¸ loaded</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° domContentLoadedEventEndlet domContentloaded &#x3D; t.domContentLoadedEventEnd - t.navigationStart;&#x2F;&#x2F; ä»é¡µé¢å¼€å§‹åˆ° loadEventEndlet loaded &#x3D; t.loadEventEnd - t.navigationStart;</code></pre><p><strong>domContentLoadedEventEnd æ¯” loaded å…ˆè§¦å‘</strong></p><p><img src="http://t-blog-images.aijs.top/img/20220605133905.webp"></p><hr/><h2 id="æ˜é‡‘é¡µé¢"><a href="#æ˜é‡‘é¡µé¢" class="headerlink" title="æ˜é‡‘é¡µé¢"></a>æ˜é‡‘é¡µé¢</h2><ul><li><p>è¯è¯´å·²ç»åˆ°äº† 6 æœˆ 6 å·ï¼Œé—²é€›æ˜é‡‘ï¼Œé‡åˆ°é¢è¯•é¢˜ï¼š<code>ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆ</code>ï¼Œçªç„¶æƒ³èµ·ä¸ª performance,å°±æ‹¿æ˜é‡‘çš„ä¸€ä¸ªé¡µé¢æ¥éªŒè¯è¿™å¹…å›¾</p><p><img src="http://t-blog-images.aijs.top/img/20220606151451.webp"></p></li></ul><div class="custom-quote warning"><span class="custom-quote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 8V13"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M12 15.99V16.01"></path></svg></span><p class="custom-quote-title">WARNING</p><p>æ³¨æ„ï¼šæ­¤ä»£ç æ”¾åˆ° dayjs ç½‘ç«™çš„ Sources&#x2F;Snippets ä¸­æ‰§è¡Œï¼Œåˆ©ç”¨å…¨å±€çš„ dayjsï¼Œæ— éœ€å¼•å…¥ dayjs</div><p><a href="https://dayjs.fenxianglu.cn/category/display.html#%E6%A0%BC%E5%BC%8F%E5%8C%96" target="_blank" >dayjs ç½‘ç«™</a></p><p><img src="http://t-blog-images.aijs.top/img/20220606152413.webp"></p><ul><li>ä»£ç æ˜¯ä¸ºäº†å¯¹ performance.timing æŒ‰ç…§æ—¶é—´å€¼è¿›è¡Œæ’åºï¼Œæ’åºç»“æœå¤§è‡´æ˜¯æ‰§è¡Œçš„é¡ºåºï¼Œç¨å¾®æœ‰å‡ºå…¥ï¼Œä¼šæ‰‹åŠ¨åšè°ƒæ•´</li><li>ä»£ç å¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">var timing &#x3D; &#123;  connectStart: 1654499041800,  navigationStart: 1654499041744,  loadEventEnd: 1654499043641,  domLoading: 1654499042279,  secureConnectionStart: 1654499041820,  fetchStart: 1654499041746,  domContentLoadedEventStart: 1654499042718,  responseStart: 1654499042247,  responseEnd: 1654499042304,  domInteractive: 1654499042495,  domainLookupEnd: 1654499041800,  redirectStart: 0,  requestStart: 1654499041849,  unloadEventEnd: 1654499042267,  unloadEventStart: 1654499042267,  domComplete: 1654499043640,  domainLookupStart: 1654499041750,  loadEventStart: 1654499043641,  domContentLoadedEventEnd: 1654499042718,  redirectEnd: 0,  connectEnd: 1654499041849,&#125;;&#x2F;&#x2F; YYYY-MM-DD HH:ä¸€å®šä¸€è‡´ï¼Œè¿™ä¸ªå°±ä¸çœ‹äº†var fmt &#x3D; &quot;mm:ss:SSS&quot;;var arr &#x3D; [];var sort_obj &#x3D; &#123;&#125;;function fmt_sort_key(obj) &#123;  for (let [key, value] of Object.entries(obj)) &#123;    arr.push(&#123;      key,      value,    &#125;);  &#125;  const sortArr &#x3D; arr.sort((a, b) &#x3D;&gt; a.value - b.value);  const fmtSortArr &#x3D; sortArr.map((item) &#x3D;&gt; &#123;    if (!item.value) return item;    return &#123;      ...item,      value: dayjs(item.value).format(fmt),    &#125;;  &#125;);  console.log(fmtSortArr);&#125;fmt_sort_key(timing);</code></pre><h2 id="éæ— ç—•é¦–æ¬¡è®¿é—®"><a href="#éæ— ç—•é¦–æ¬¡è®¿é—®" class="headerlink" title="éæ— ç—•é¦–æ¬¡è®¿é—®"></a>éæ— ç—•é¦–æ¬¡è®¿é—®</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">const timing &#x3D; &#123;  connectStart: 1654391072118,  navigationStart: 1654391071928,  loadEventEnd: 1654391076402,  domLoading: 1654391072670,  secureConnectionStart: 1654391072118,  fetchStart: 1654391071969,  domContentLoadedEventStart: 1654391074189,  responseStart: 1654391072621,  responseEnd: 1654391072664,  domInteractive: 1654391073865,  domainLookupEnd: 1654391072118,  redirectStart: 0,  requestStart: 1654391072199,  &#x2F;&#x2F; æ²¡æœ‰ä¹‹å‰é¡µé¢çš„å¸è½½  unloadEventEnd: 0,  unloadEventStart: 0,  domComplete: 1654391076400,  domainLookupStart: 1654391072118,  loadEventStart: 1654391076400,  domContentLoadedEventEnd: 1654391074189,  redirectEnd: 0,  connectEnd: 1654391072199,&#125;;&#x2F;&#x2F; æ—¶é—´æˆ³ 1654391072118ï¼š connectStartã€secureConnectionStartã€domainLookupStartã€domainLookupEnd ï¼Œè¿™ä¸ªå€¼æ˜¯ç›¸åŒçš„&#x2F;&#x2F; æŠŠä¸Šè¿° timing ä½¿ç”¨dayjsè¿›è¡Œè½¬åŒ–ï¼Œçœ‹ä¸‹æ¯ä¸ªkeyå¯¹åº”çš„time,å¯¹äº0æ˜¯æ²¡æœ‰è¿›è¡Œçš„æ“ä½œï¼Œæˆ‘ä»¬è·³è¿‡ä¸å¤„ç†ï¼ˆçŸ¥é“æ²¡è¿›è¡Œï¼‰var timingfmt &#x3D; [  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº  &#123; key: &quot;navigationStart&quot;, value: &quot;04:31:928&quot; &#125;,  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,  &#123; key: &quot;fetchStart&quot;, value: &quot;04:31:969&quot; &#125;,  &#123; key: &quot;connectStart&quot;, value: &quot;04:32:118&quot; &#125;,  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;04:32:118&quot; &#125;,  &#123; key: &quot;domainLookupStart&quot;, value: &quot;04:32:118&quot; &#125;,  &#123; key: &quot;secureConnectionStart&quot;, value: &quot;04:32:118&quot; &#125;,  &#123; key: &quot;requestStart&quot;, value: &quot;04:32:199&quot; &#125;,  &#123; key: &quot;connectEnd&quot;, value: &quot;04:32:199&quot; &#125;,  &#123; key: &quot;responseStart&quot;, value: &quot;04:32:621&quot; &#125;,  &#123; key: &quot;unloadEventStart&quot;, value: 0 &#125;,  &#123; key: &quot;unloadEventEnd&quot;, value: 0 &#125;,  &#123; key: &quot;responseEnd&quot;, value: &quot;04:32:664&quot; &#125;,  &#123; key: &quot;domLoading&quot;, value: &quot;04:32:670&quot; &#125;,  &#123; key: &quot;domInteractive&quot;, value: &quot;04:33:865&quot; &#125;,  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;04:34:189&quot; &#125;,  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;04:34:189&quot; &#125;,  &#123; key: &quot;domComplete&quot;, value: &quot;04:36:400&quot; &#125;,  &#123; key: &quot;loadEventStart&quot;, value: &quot;04:36:400&quot; &#125;,  &#123; key: &quot;loadEventEnd&quot;, value: &quot;04:36:402&quot; &#125;,];</code></pre><p><strong>æˆ‘ä»¬çœ‹ä¸‹ç»“æœ 2022-06-05 09:04ï¼Œå¹´æœˆæ—¥æ—¶åˆ†éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸‰ä½çš„æ¯«ç§’æ•°</strong></p><h2 id="éæ— ç—•ç¬¬äºŒæ¬¡è®¿é—®"><a href="#éæ— ç—•ç¬¬äºŒæ¬¡è®¿é—®" class="headerlink" title="éæ— ç—•ç¬¬äºŒæ¬¡è®¿é—®"></a>éæ— ç—•ç¬¬äºŒæ¬¡è®¿é—®</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">const timing2 &#x3D; &#123;  connectStart: 1654494048918,  navigationStart: 1654494048902,  loadEventEnd: 1654494054146,  domLoading: 1654494049851,  secureConnectionStart: 0, &#x2F;&#x2F; èµ°ç¼“å­˜  fetchStart: 1654494048918,  domContentLoadedEventStart: 1654494051380,  responseStart: 1654494049430,  responseEnd: 1654494049514,  domInteractive: 1654494051115,  domainLookupEnd: 1654494048918,  redirectStart: 0,  requestStart: 1654494048942,  &#x2F;&#x2F; æœ‰ä¹‹å‰é¡µé¢å¸è½½  unloadEventEnd: 1654494049537,  unloadEventStart: 1654494049536,  domComplete: 1654494054143,  domainLookupStart: 1654494048918,  loadEventStart: 1654494054143,  domContentLoadedEventEnd: 1654494051381,  redirectEnd: 0,  connectEnd: 1654494048918,&#125;;var timingfmt2 &#x3D; [  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº  &#123; key: &quot;navigationStart&quot;, value: &quot;40:48:902&quot; &#125;,  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,  &#123; key: &quot;fetchStart&quot;, value: &quot;40:48:918&quot; &#125;,  &#123; key: &quot;connectStart&quot;, value: &quot;40:48:918&quot; &#125;,  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;40:48:918&quot; &#125;,  &#123; key: &quot;domainLookupStart&quot;, value: &quot;40:48:918&quot; &#125;,  &#123; key: &quot;secureConnectionStart&quot;, value: 0 &#125;,  &#123; key: &quot;connectEnd&quot;, value: &quot;40:48:918&quot; &#125;,  &#123; key: &quot;requestStart&quot;, value: &quot;40:48:942&quot; &#125;,  &#123; key: &quot;responseStart&quot;, value: &quot;40:49:430&quot; &#125;,  &#123; key: &quot;responseEnd&quot;, value: &quot;40:49:514&quot; &#125;,  &#123; key: &quot;unloadEventStart&quot;, value: &quot;40:49:536&quot; &#125;,  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;40:49:537&quot; &#125;,  &#123; key: &quot;domLoading&quot;, value: &quot;40:49:851&quot; &#125;,  &#123; key: &quot;domInteractive&quot;, value: &quot;40:51:115&quot; &#125;,  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;40:51:380&quot; &#125;,  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;40:51:381&quot; &#125;,  &#123; key: &quot;domComplete&quot;, value: &quot;40:54:143&quot; &#125;,  &#123; key: &quot;loadEventStart&quot;, value: &quot;40:54:143&quot; &#125;,  &#123; key: &quot;loadEventEnd&quot;, value: &quot;40:54:146&quot; &#125;,];</code></pre><h2 id="éæ— ç—•-f5-æ‰‹åŠ¨åˆ·æ–°"><a href="#éæ— ç—•-f5-æ‰‹åŠ¨åˆ·æ–°" class="headerlink" title="éæ— ç—• f5 æ‰‹åŠ¨åˆ·æ–°"></a>éæ— ç—• f5 æ‰‹åŠ¨åˆ·æ–°</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var timing3 &#x3D; &#123;  connectStart: 1654495600379,  navigationStart: 1654495600360,  loadEventEnd: 1654495604101,  domLoading: 1654495601005,  secureConnectionStart: 1654495600389,  fetchStart: 1654495600364,  domContentLoadedEventStart: 1654495601947,  responseStart: 1654495600935,  responseEnd: 1654495600989,  domInteractive: 1654495601794,  domainLookupEnd: 1654495600379,  redirectStart: 0,  requestStart: 1654495600404,  unloadEventEnd: 1654495600971,  unloadEventStart: 1654495600970,  domComplete: 1654495604099,  domainLookupStart: 1654495600379,  loadEventStart: 1654495604099,  domContentLoadedEventEnd: 1654495601947,  redirectEnd: 0,  connectEnd: 1654495600403,&#125;;var timingfmt3 &#x3D; [  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº  &#123; key: &quot;navigationStart&quot;, value: &quot;06:40:360&quot; &#125;,  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,  &#123; key: &quot;fetchStart&quot;, value: &quot;06:40:364&quot; &#125;,  &#123; key: &quot;connectStart&quot;, value: &quot;06:40:379&quot; &#125;,  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;06:40:379&quot; &#125;,  &#123; key: &quot;domainLookupStart&quot;, value: &quot;06:40:379&quot; &#125;,  &#123; key: &quot;secureConnectionStart&quot;, value: &quot;06:40:389&quot; &#125;,  &#123; key: &quot;connectEnd&quot;, value: &quot;06:40:403&quot; &#125;,  &#123; key: &quot;requestStart&quot;, value: &quot;06:40:404&quot; &#125;,  &#123; key: &quot;responseStart&quot;, value: &quot;06:40:935&quot; &#125;,  &#123; key: &quot;unloadEventStart&quot;, value: &quot;06:40:970&quot; &#125;,  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;06:40:971&quot; &#125;,  &#123; key: &quot;responseEnd&quot;, value: &quot;06:40:989&quot; &#125;,  &#123; key: &quot;domLoading&quot;, value: &quot;06:41:005&quot; &#125;,  &#123; key: &quot;domInteractive&quot;, value: &quot;06:41:794&quot; &#125;,  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;06:41:947&quot; &#125;,  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;06:41:947&quot; &#125;,  &#123; key: &quot;domComplete&quot;, value: &quot;06:44:099&quot; &#125;,  &#123; key: &quot;loadEventStart&quot;, value: &quot;06:44:099&quot; &#125;,  &#123; key: &quot;loadEventEnd&quot;, value: &quot;06:44:101&quot; &#125;,];</code></pre><h2 id="æ— ç—•æ¨¡å¼é¦–æ¬¡"><a href="#æ— ç—•æ¨¡å¼é¦–æ¬¡" class="headerlink" title="æ— ç—•æ¨¡å¼é¦–æ¬¡"></a>æ— ç—•æ¨¡å¼é¦–æ¬¡</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var timing4 &#x3D; &#123;  connectStart: 1654496795083,  navigationStart: 1654496795041,  loadEventEnd: 1654496799718,  domLoading: 1654496795428,  secureConnectionStart: 1654496795093,  fetchStart: 1654496795050,  domContentLoadedEventStart: 1654496796111,  responseStart: 1654496795420,  responseEnd: 1654496795469,  domInteractive: 1654496795680,  domainLookupEnd: 1654496795083,  redirectStart: 0,  requestStart: 1654496795123,  unloadEventEnd: 0,  unloadEventStart: 0,  domComplete: 1654496799718,  domainLookupStart: 1654496795057,  loadEventStart: 1654496799718,  domContentLoadedEventEnd: 1654496796111,  redirectEnd: 0,  connectEnd: 1654496795123,&#125;;var timing4fmt &#x3D; [  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº  &#123; key: &quot;navigationStart&quot;, value: &quot;26:35:041&quot; &#125;,  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,  &#123; key: &quot;fetchStart&quot;, value: &quot;26:35:050&quot; &#125;,  &#123; key: &quot;domainLookupStart&quot;, value: &quot;26:35:057&quot; &#125;,  &#123; key: &quot;connectStart&quot;, value: &quot;26:35:083&quot; &#125;,  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;26:35:083&quot; &#125;,  &#123; key: &quot;secureConnectionStart&quot;, value: &quot;26:35:093&quot; &#125;,  &#123; key: &quot;requestStart&quot;, value: &quot;26:35:123&quot; &#125;,  &#123; key: &quot;connectEnd&quot;, value: &quot;26:35:123&quot; &#125;,  &#123; key: &quot;responseStart&quot;, value: &quot;26:35:420&quot; &#125;,  &#123; key: &quot;unloadEventEnd&quot;, value: 0 &#125;,  &#123; key: &quot;unloadEventStart&quot;, value: 0 &#125;,  &#123; key: &quot;domLoading&quot;, value: &quot;26:35:428&quot; &#125;,  &#123; key: &quot;responseEnd&quot;, value: &quot;26:35:469&quot; &#125;,  &#123; key: &quot;domInteractive&quot;, value: &quot;26:35:680&quot; &#125;,  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;26:36:111&quot; &#125;,  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;26:36:111&quot; &#125;,  &#123; key: &quot;loadEventEnd&quot;, value: &quot;26:39:718&quot; &#125;,  &#123; key: &quot;domComplete&quot;, value: &quot;26:39:718&quot; &#125;,  &#123; key: &quot;loadEventStart&quot;, value: &quot;26:39:718&quot; &#125;,];</code></pre><h2 id="æ— ç—•æ¨¡å¼åˆ·æ–°"><a href="#æ— ç—•æ¨¡å¼åˆ·æ–°" class="headerlink" title="æ— ç—•æ¨¡å¼åˆ·æ–°"></a>æ— ç—•æ¨¡å¼åˆ·æ–°</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var timing5 &#x3D; &#123;  connectStart: 1654496848681,  navigationStart: 1654496848679,  loadEventEnd: 1654496850263,  domLoading: 1654496848983,  secureConnectionStart: 0,  fetchStart: 1654496848681,  domContentLoadedEventStart: 1654496849277,  responseStart: 1654496848959,  responseEnd: 1654496849017,  domInteractive: 1654496849096,  domainLookupEnd: 1654496848681,  redirectStart: 0,  requestStart: 1654496848702,  unloadEventEnd: 1654496848979,  unloadEventStart: 1654496848979,  domComplete: 1654496850262,  domainLookupStart: 1654496848681,  loadEventStart: 1654496850262,  domContentLoadedEventEnd: 1654496849277,  redirectEnd: 0,  connectEnd: 1654496848681,&#125;;var timing5fmt &#x3D; [  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº  &#123; key: &quot;navigationStart&quot;, value: &quot;27:28:679&quot; &#125;,  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,  &#123; key: &quot;fetchStart&quot;, value: &quot;27:28:681&quot; &#125;,  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;27:28:681&quot; &#125;,  &#123; key: &quot;domainLookupStart&quot;, value: &quot;27:28:681&quot; &#125;,  &#123; key: &quot;connectStart&quot;, value: &quot;27:28:681&quot; &#125;,  &#123; key: &quot;connectEnd&quot;, value: &quot;27:28:681&quot; &#125;,  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#123; key: &quot;secureConnectionStart&quot;, value: 0 &#125;,  &#123; key: &quot;requestStart&quot;, value: &quot;27:28:702&quot; &#125;,  &#123; key: &quot;responseStart&quot;, value: &quot;27:28:959&quot; &#125;,  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;27:28:979&quot; &#125;,  &#123; key: &quot;unloadEventStart&quot;, value: &quot;27:28:979&quot; &#125;,  &#123; key: &quot;domLoading&quot;, value: &quot;27:28:983&quot; &#125;,  &#123; key: &quot;responseEnd&quot;, value: &quot;27:29:017&quot; &#125;,  &#123; key: &quot;domInteractive&quot;, value: &quot;27:29:096&quot; &#125;,  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;27:29:277&quot; &#125;,  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;27:29:277&quot; &#125;,  &#123; key: &quot;domComplete&quot;, value: &quot;27:30:262&quot; &#125;,  &#123; key: &quot;loadEventStart&quot;, value: &quot;27:30:262&quot; &#125;,  &#123; key: &quot;loadEventEnd&quot;, value: &quot;27:30:263&quot; &#125;,];</code></pre><h2 id="æ— ç—•æ¨¡å¼åˆ·æ–°-disable-cache"><a href="#æ— ç—•æ¨¡å¼åˆ·æ–°-disable-cache" class="headerlink" title="æ— ç—•æ¨¡å¼åˆ·æ–° + disable-cache"></a>æ— ç—•æ¨¡å¼åˆ·æ–° + disable-cache</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">var timing6 &#x3D; &#123;  connectStart: 1654496917781,  navigationStart: 1654496917780,  loadEventEnd: 1654496921224,  domLoading: 1654496918186,  secureConnectionStart: 0,  fetchStart: 1654496917781,  domContentLoadedEventStart: 1654496918836,  responseStart: 1654496918156,  responseEnd: 1654496918293,  domInteractive: 1654496918654,  domainLookupEnd: 1654496917781,  redirectStart: 0,  requestStart: 1654496917784,  unloadEventEnd: 1654496918182,  unloadEventStart: 1654496918182,  domComplete: 1654496921224,  domainLookupStart: 1654496917781,  loadEventStart: 1654496921224,  domContentLoadedEventEnd: 1654496918836,  redirectEnd: 0,  connectEnd: 1654496917781,&#125;;var timing6fmt &#x3D; [  &#x2F;&#x2F; ä»¥ä¸‹æŒ‰ç…§æ—¶é—´æ’åº  &#123; key: &quot;navigationStart&quot;, value: &quot;28:37:780&quot; &#125;,  &#x2F;&#x2F; æ—¶é—´ä¸º0æ˜¯æ²¡æœ‰è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œè·³è¿‡ä¸å¤„ç†  &#123; key: &quot;redirectStart&quot;, value: 0 &#125;,  &#123; key: &quot;redirectEnd&quot;, value: 0 &#125;,  &#123; key: &quot;fetchStart&quot;, value: &quot;28:37:781&quot; &#125;,  &#123; key: &quot;domainLookupEnd&quot;, value: &quot;28:37:781&quot; &#125;,  &#123; key: &quot;domainLookupStart&quot;, value: &quot;28:37:781&quot; &#125;,  &#123; key: &quot;connectStart&quot;, value: &quot;28:37:781&quot; &#125;,  &#123; key: &quot;connectEnd&quot;, value: &quot;28:37:781&quot; &#125;,  &#123; key: &quot;secureConnectionStart&quot;, value: 0 &#125;,  &#123; key: &quot;requestStart&quot;, value: &quot;28:37:784&quot; &#125;,  &#123; key: &quot;responseStart&quot;, value: &quot;28:38:156&quot; &#125;,  &#x2F;&#x2F; å’Œ timing5fmtæ¯”è¾ƒï¼Œä¹‹å‰é¡µé¢çš„å¸è½½ï¼Œéå¸¸å¿«  &#123; key: &quot;unloadEventStart&quot;, value: &quot;28:38:182&quot; &#125;,  &#123; key: &quot;unloadEventEnd&quot;, value: &quot;28:38:182&quot; &#125;,  &#x2F;&#x2F; æ³¨æ„ domLoading å’Œ responseEnd,è¿™ä¸¤ä¸ªï¼Œé¡ºåºä¸å®š  &#123; key: &quot;domLoading&quot;, value: &quot;28:38:186&quot; &#125;,  &#123; key: &quot;responseEnd&quot;, value: &quot;28:38:293&quot; &#125;,  &#123; key: &quot;domInteractive&quot;, value: &quot;28:38:654&quot; &#125;,  &#123; key: &quot;domContentLoadedEventStart&quot;, value: &quot;28:38:836&quot; &#125;,  &#123; key: &quot;domContentLoadedEventEnd&quot;, value: &quot;28:38:836&quot; &#125;,  &#123; key: &quot;loadEventEnd&quot;, value: &quot;28:41:224&quot; &#125;,  &#123; key: &quot;domComplete&quot;, value: &quot;28:41:224&quot; &#125;,  &#123; key: &quot;loadEventStart&quot;, value: &quot;28:41:224&quot; &#125;,];</code></pre><p>è¿™ä¸ªæ“ä½œç«Ÿç„¶æœ‰ä¸€ä¸ª base64 ç¼–ç å›¾ç‰‡ä¾ç„¶è¢«ç¼“å­˜äº†,æµè§ˆå™¨ disable-cache å¯¹äºæœ‰äº›å†…å­˜ç¼“å­˜çš„å›¾ç‰‡ç«Ÿç„¶æ˜¯æ— æ•ˆçš„.</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Request URL: data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCCRequest Method: GETStatus Code: 200 OK (from memory cache)Referrer Policy: strict-origin-when-cross-origin</code></pre><p><img src="http://t-blog-images.aijs.top/img/20220606143138.webp"></p><h2 id="DNS-ç¼“å­˜"><a href="#DNS-ç¼“å­˜" class="headerlink" title="DNS ç¼“å­˜"></a>DNS ç¼“å­˜</h2><p>åœ¨å®é™…çš„è§£æè¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸æ˜¯å®¢æˆ·ç«¯çš„æ¯ä¸€æ¬¡è®¿é—®éƒ½éœ€è¦å§”æ‰˜é€’å½’æœåŠ¡å™¨è¿›è¡Œè¿­ä»£æŸ¥è¯¢ï¼Œ</p><ol><li>è€Œæ˜¯å…ˆæœç´¢æµè§ˆå™¨è‡ªèº«çš„ DNS ç¼“å­˜ï¼Œå¦‚æœæœ‰ï¼Œè§£æåˆ°æ­¤ä¸ºæ­¢ï¼›</li><li>å¦‚æœ DNS ç¼“å­˜ä¸­æ²¡æœ‰ç»“æœå°±ä¼šè¯»å–æ“ä½œç³»ç»Ÿä¸­çš„ HOSTS æ–‡ä»¶æŸ¥æ‰¾å¯¹åº”çš„æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰åˆ°æ­¤å®Œæˆï¼›</li><li>å¦‚æœæ²¡æœ‰ï¼Œå†è¯·æ±‚é€’å½’æœåŠ¡å™¨ï¼Œè¿›è¡Œå…¨çƒé€’å½’æŸ¥è¯¢ã€‚ä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡º DNS ç¼“å­˜æ˜¯è·å–åŸŸåè§£æè®°å½•çš„ç¬¬ä¸€æ­¥éª¤ã€‚</li></ol><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/z9061/article/details/101454438" target="_blank" >Web æ€§èƒ½ä¼˜åŒ–-é¦–å±å’Œç™½å±æ—¶é—´</a></p><p><a href="http://www.alloyteam.com/2015/09/explore-performance/" target="_blank" >åˆæ¢ performance â€“ ç›‘æ§ç½‘é¡µä¸ç¨‹åºæ€§èƒ½</a></p><p><a href="https://blog.csdn.net/abuanden/article/details/114530985" target="_blank" >ç®€è¿°æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶</a></p><p><a href="https://baijiahao.baidu.com/s?id=1722369549920506968&wfr=spider&for=pc" target="_blank" >æµ…è°ˆ DNS ç¼“å­˜çš„ä½œç”¨å’Œå½±å“</a></p><p><a href="https://www.jianshu.com/p/0f2158726daf" target="_blank" >TTFB</a></p><p><a href="https://cn.bluehost.com/blog/?p=14093" target="_blank" >ä»€ä¹ˆæ˜¯ç½‘ç«™ TTFBï¼Ÿä»¥åŠ 6 ä¸ªä¼˜åŒ– TTFB çš„æ–¹æ³•</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Resource_Timing_API/Using_the_Resource_Timing_API" target="_blank" >Web å¼€å‘æŠ€æœ¯&gt;Web API æ¥å£å‚è€ƒ&gt;Resource Timing API&gt;Using the Resource Timing API</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> performance </tag>
            
            <tag> æµè§ˆå™¨åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscodeæ’ä»¶ paste code to snippets</title>
      <link href="//post/2022-05-11vscode.html"/>
      <url>//post/2022-05-11vscode.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç²˜è´´ä»£ç ï¼Œç”Ÿæˆç”¨æˆ·ä»£ç ç‰‡æ®µ"><a href="#ç²˜è´´ä»£ç ï¼Œç”Ÿæˆç”¨æˆ·ä»£ç ç‰‡æ®µ" class="headerlink" title="ç²˜è´´ä»£ç ï¼Œç”Ÿæˆç”¨æˆ·ä»£ç ç‰‡æ®µ"></a>ç²˜è´´ä»£ç ï¼Œç”Ÿæˆç”¨æˆ·ä»£ç ç‰‡æ®µ</h2><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ol><li>å…¶ä»–æ’ä»¶å…·æœ‰<code>å…±æ€§</code>ï¼Œè€Œ<code>ä¸å…·ç‰¹æ€§ </code>ï¼Œæ¯æ¬¡å†™ä»£ç ï¼Œè¦ä¹ˆç”¨ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œç°æˆçš„ä»£ç ç‰‡æ®µï¼Œæ—¶å¸¸ä¸èƒ½æ»¡è¶³æ—¥å¸¸å¼€å‘éœ€è¦</li><li>è‡ªå®šä¹‰ä»£ç ç‰‡æ®µï¼Œæ‰‹å†™ <code>è´¹æ—¶è´¹åŠ›</code>ï¼Œä¸€èˆ¬æ­¥éª¤ï¼Œç²˜è´´ã€ä¿®æ”¹ã€æ ¼å¼åŒ–</li><li>å…¶ä»–æ’ä»¶ç±»ä¼¼vscodeå®å˜é‡çš„ä½¿ç”¨å°‘ä¹‹åˆå°‘ï¼Œ è¦ä¹ˆå°†å¼€æºæ’ä»¶å®šåˆ¶åŒ–ï¼Œè¦ä¹ˆé‡æ–°å¼€å‘</li><li>å¿«æ·å˜é‡è®°ä¸ä½</li></ol><h2 id="paste-code-to-snippets-ä¼˜ç‚¹ï¼š"><a href="#paste-code-to-snippets-ä¼˜ç‚¹ï¼š" class="headerlink" title="paste code to snippets ä¼˜ç‚¹ï¼š"></a>paste code to snippets ä¼˜ç‚¹ï¼š</h2><ol><li>é«˜åº¦å®šåˆ¶åŒ–</li><li>è·¨è¯­è¨€ï¼ˆä»»ä½•vscodeæ”¯æŒçš„è¯­è¨€ï¼Œéƒ½å¯åœ¨å¯¹åº”ç±»å‹ç‰‡æ®µæ–‡ä»¶ä¸­è¿›è¡Œå¢åŠ ï¼‰</li><li>ä½¿ç”¨ç®€å• ï¼ˆå¤åˆ¶ã€å”¤èµ·å‘½ä»¤ã€æŒ–å­”ï¼‰</li><li>å¿«æ·æç¤ºå®Œå…¨è‡ªå®šä¹‰ï¼ˆæƒ³æ€ä¹ˆå†™å°±æ€ä¹ˆå†™ï¼‰</li></ol><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p><img src="http://t-blog-images.aijs.top/img/Kapture%202022-05-11%20at%2009.39.01.gif"></p><ol><li>å¤åˆ¶è¦ç”Ÿæˆçš„ä»£ç ç‰‡æ®µ</li><li>cmd + shift + p</li><li>æ‰¾åˆ°è¦ç”Ÿæˆä»£ç ç‰‡æ®µçš„æ–‡ä»¶åç¼€</li><li>æ‰§è¡Œ paste code to snippets</li><li>ä¸‹æ¬¡ä½¿ç”¨</li></ol><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ul><li>å¦‚æœé…ç½®äº†ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰æç¤º, æŸ¥çœ‹<code>settings.json</code>å¯¹åº”</li><li>æ‰“å¼€ <code>settings.json</code> å‘½ä»¤ï¼š <code>command + shift + p</code>, æœ <code>&gt;settings</code></li></ul><p><strong>ä»¥markdownä¸ºä¾‹</strong> é»˜è®¤åªè¯»é…ç½®åœ¨å‡çº§åå˜æˆäº†false</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">&#x2F;&#x2F; Configure settings to be overridden for the markdown language.&quot;[markdown]&quot;:  &#123;&quot;editor.unicodeHighlight.ambiguousCharacters&quot;: false,&quot;editor.unicodeHighlight.invisibleCharacters&quot;: false,&quot;editor.wordWrap&quot;: &quot;on&quot;,&quot;editor.quickSuggestions&quot;: false  &#x2F;&#x2F; æ”¹ä¸ºtrue&#125;,</code></pre><ul><li>ä¿®æ”¹<br><img src="http://t-blog-images.aijs.top/img/20220602184856.webp"></li></ul><h2 id="æœ‰æƒ³æ³•"><a href="#æœ‰æƒ³æ³•" class="headerlink" title="æœ‰æƒ³æ³•"></a>æœ‰æƒ³æ³•</h2><p>TODO: ä¹‹å‰ä»£ç ç‰‡æ®µå¤åˆ¶ä¹‹åæ˜¯æ‰‹åŠ¨ç²˜è´´åˆ°å¯¹åº”çš„ç‰‡æ®µæ–‡ä»¶ä¸­çš„ï¼Œæˆ‘æœ‰ä¸ªæƒ³æ³•ï¼Œæ—¢ç„¶æˆ‘å¤åˆ¶æ–‡ä»¶çš„æ–‡ä»¶ç±»å‹æˆ‘å·²ç»çŸ¥é“äº†ï¼Œæˆ‘å¤åˆ¶çš„ä»£ç å’Œè¾“å‡ºçš„ç‰‡æ®µä»£ç ä¹Ÿå·²ç»å¤„ç†äº†ï¼Œé‚£ä¹ˆä¹‹åæˆ‘å°±èƒ½å®ç°<code>å¤åˆ¶æŸä¸ªæ–‡ä»¶çš„ä»£ç ï¼Œè‡ªåŠ¨åŒæ­¥åˆ°å¯¹åº”çš„ç‰‡æ®µæ–‡ä»¶ä¸­ï¼Œå¦‚æœä¸éœ€è¦å®šåˆ¶åŒ–ï¼Œä¹Ÿä¸ç”¨æ‰“å¼€ç‰‡æ®µæ–‡ä»¶ä¿®æ”¹äº†</code></p><p>TODO:æƒ³åˆ°è¿™é‡Œæˆ‘åˆæœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œæ—¢ç„¶æˆ‘æ¯æ¬¡è¦å‘½ä»¤ï¼Œç„¶åå†æ‰¾å•Šæ‰¾ï¼Œæˆ‘å¯ä»¥ç”¨ä¸€ä¸ªå¿«æ·é”®<code>&quot;å¤åˆ¶&quot;</code>çš„åŒæ—¶ï¼Œå”¤èµ·è¦å®šåˆ¶çš„ä»£ç ç‰‡æ®µå¯¹åº”çš„ç±»å‹æ–‡ä»¶ï¼Œç›´æ¥è¿›å»ï¼Œä¸ç”¨å¼¯å¼¯ç»•ç»•çš„</p><p>TODO: github copilotæ”¶è´¹äº†ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æŠŠè¿™ä¸ªä»£ç åŠŸèƒ½ç”Ÿæˆç‰‡æ®µä»“åº“ï¼Œè¿›è¡Œå›¢é˜Ÿå…±äº«ï¼Œç±»ä¼¼github copilotï¼Œæˆ‘ä»¬ä¸åšAI,åšåŒ¹é…æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-HTTP3</title>
      <link href="//post/2022-05-11http.html"/>
      <url>//post/2022-05-11http.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><img src="https://www.upyun.com/static/img/title@3x.5597f51.png" />HTTP/3 çš„åŸºç¡€å³è°·æ­Œå¤šå¹´æ¢ç´¢çš„åŸºäº UDP çš„ QUIC åè®®ã€‚ä¸ TCP ç›¸æ¯”ï¼Œä½¿ç”¨ UDP å¯ä»¥æä¾›æ›´å¤§çš„çµæ´»æ€§ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ QUIC å®Œå…¨äºç”¨æˆ·ç©ºé—´ä¸­å®ç°â€”â€”å¯¹åè®®å®ç°çš„æ›´æ–°ä¸åƒ TCP é‚£æ ·éœ€è¦ç»‘å®šåˆ°æ“ä½œç³»ç»Ÿæ›´æ–°ã€‚ä½¿ç”¨ QUICï¼Œå¯ä»¥ç®€å•åœ°å°† HTTP çº§åˆ«çš„æµæ˜ å°„åˆ° QUIC æµçš„é¡¶éƒ¨ï¼Œä»è€Œç»§æ‰¿ HTTP/2 çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œè€Œä¸ä¼šäº§ç”Ÿé˜Ÿå¤´é˜»å¡ã€‚HTTP/3 è™½ä»å¤„äºè‰æ¡ˆçŠ¶æ€ï¼Œä½†å¾ˆå¤šç”¨æˆ·å·²ç»è·ƒè·ƒæ¬²è¯•ã€‚</blockquote><h2 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h2><ol><li>HTTP&#x2F;3 åˆ©ç”¨ QUIC åŠ é€Ÿ HTTP è¯·æ±‚ï¼ŒQUIC æä¾›æ¯” TCP å’Œ TLS æ›´é«˜çš„åŠ å¯†å’Œæ€§èƒ½</li><li>QUIC æ˜¯ä¸€ç§é»˜è®¤åŠ å¯†çš„æ–°ä¼ è¾“åè®®ï¼Œæ—¨åœ¨åŠ å¿« HTTP ä¼ è¾“é€Ÿåº¦ä»¥åŠä½¿å…¶æ›´åŠ å®‰å…¨</li><li><span style="color: red">HTTP&#x2F;3 åŸºäº UDPï¼Œå¦‚æœæ•°æ®åŒ…ä¸¢å¤±ï¼Œåªä¼šä¸­æ–­ä¸€ä¸ªæµï¼Œè€Œä¸ä¼šä¸­æ–­æ‰€æœ‰æµï¼Œæé«˜äº†åŒæ—¶è·å–å¤šä¸ªå¯¹è±¡çš„æ€§èƒ½</span></li><li>æ”¯æŒ 0-RTTï¼Œæ¶ˆé™¤æœåŠ¡å™¨çš„ TLS ç¡®è®¤ï¼Œä½¿åç»­è¿æ¥çš„å¯åŠ¨é€Ÿåº¦æ›´å¿«</li></ol><h2 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h2><p>ä¸‹å›¾è¡¨ç¤º HTTP&#x2F;2 å’Œ HTTP&#x2F;3 å¤šè·¯å¤ç”¨ä¸¤ä¸ªè¯·æ±‚æ—¶ï¼Œæ•°æ®åŒ…ä¸¢å¤±åŠå…¶å½±å“ï¼ˆè¯·æ±‚åŠå…¶ç›¸å…³çš„å“åº”åˆ†åˆ«ä¸ºæ·±è“å’Œæµ…è“è‰²ï¼‰</p><p>HTTP&#x2F;2 å¤šè·¯å¤ç”¨ 2 ä¸ªè¯·æ±‚ã€‚å“åº”è¢«åˆ†è§£ä¸ºå¤šä¸ªæ•°æ®åŒ…ï¼Œä¸€æ—¦ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œä¸¤ä¸ªè¯·æ±‚éƒ½è¢«é˜»æ­¢ã€‚<br><img src="https://www.upyun.com/static/img/http_3%20&%20QUIC.d73f941.gif" /><br>HTTP&#x2F;3 å¤ç”¨ 2 ä¸ªè¯·æ±‚ã€‚è™½ç„¶æµ…è‰²çš„æ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œä½†æ˜¯æ·±è‰²çš„æ•°æ®åŒ…ä¼ è¾“å¾—å¾ˆå¥½ã€‚<br><img src="https://www.upyun.com/static/img/http2.27d52a1.gif" /><br>åœ¨ç›¸åŒä¸¢åŒ…ç‡çš„æ¡ä»¶ä¸‹ï¼ŒHTTP&#x2F;3 å’Œ HTTP&#x2F;2 æ€§èƒ½æµ‹è¯•å¯¹æ¯”å¦‚ä¸‹<br>æµ‹è¯•ç¯å¢ƒï¼šæœåŠ¡ç«¯ï¼ˆHTTP&#x2F;3 with cubic &amp; HTTP&#x2F;2 with bbrï¼‰ã€å®¢æˆ·ç«¯ï¼ˆcubicï¼‰<br><img src="https://www.upyun.com/static/img/%E5%BB%BA%E8%BF%9E%E6%97%B6%E9%97%B4.35656db.png" /><br><img src="https://www.upyun.com/static/img/%E8%AF%B7%E6%B1%82%E6%97%B6%E9%97%B41x.7069918.png" /></p><h2 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p><a href="https://www.upyun.com/tech/tags/HTTP3" target="_blank" >æŸ¥çœ‹æ›´å¤š</a></p><p><a href="https://zh.wikipedia.org/wiki/HTTP/3" target="_blank" >HTTP&#x2F;3</a></p><p><a href="https://zh.wikipedia.org/wiki/QUIC" target="_blank" >QUIC</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Slate wiki-uiè¯„è®ºåŠŸèƒ½å…‰æ ‡ä¹±è·³</title>
      <link href="//post/2022-04-29slate.html"/>
      <url>//post/2022-04-29slate.html</url>
      
        <content type="html"><![CDATA[<h2 id="bugå¤ç°"><a href="#bugå¤ç°" class="headerlink" title="bugå¤ç°"></a>bugå¤ç°</h2><pre class="line-numbers language-none"><code class="language-none">bugå¤ç° (node:29) UnhandledPromiseRejectionWarning: Error: Forbidden at &amp;#x2F;code&amp;#x2F;client&amp;#x2F;.next&amp;#x2F;server&amp;#x2F;pages&amp;#x2F;_app-a05...</code></pre><p><img src="https://t-blog-images.aijs.top/img/Kapture%202022-04-29%20at%2015.41.56.gif"></p><p>åœ¨vite reacté¡¹ç›®ä¸Šï¼Œè¾“å…¥æ±‰å­—çš„åŒæ—¶æŒ‰ä½åˆ é™¤é”®ï¼Œå…‰æ ‡ä¼šä¹±è·³</p><h3 id="æ’æŸ¥1"><a href="#æ’æŸ¥1" class="headerlink" title="æ’æŸ¥1:"></a>æ’æŸ¥1:</h3><p>wikiï¼ˆesmï¼‰ç»„ä»¶é—®é¢˜ï¼Œæ£€æŸ¥wiki-uiç»„ä»¶åº“ï¼Œè¿è¡Œæ­£å¸¸</p><pre class="line-numbers language-none"><code class="language-none">&quot;react&quot;: &quot;^16.8.0&quot;,&quot;react-dom&quot;: &quot;^16.8.0&quot;,</code></pre><h3 id="æ’æŸ¥2"><a href="#æ’æŸ¥2" class="headerlink" title="æ’æŸ¥2:"></a>æ’æŸ¥2:</h3><p>viteåŠ è½½wiki-uiç»„ä»¶æ—¶å€™ï¼Œå› ä¸ºviteåªèƒ½å¤„ç†esmï¼Œåœ¨vite.config.ts, esbuildOptionsè‡ªå®šä¹‰æ’ä»¶è¿›è¡Œå¤„ç†<br>wiki-uiï¼Œä¸æ˜¯å¾ˆæ‡‚ï¼Œæ¢ä¸ªè§’åº¦</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">esbuildOptions: &#123;  plugins: [    &#123;      name: &#39;originjs:commonjs&#39;,      setup(build) &#123;        build.onLoad(          &#123;            filter: &#x2F;@æ•æ„Ÿæ•°æ®-fe\&#x2F;wiki-ui\&#x2F;dist&#x2F;,            namespace: &#39;file&#39;,          &#125;,          async (&#123; path: id &#125;) &#x3D;&gt; &#123;            const code &#x3D; readFileSync(id).toString()            const result &#x3D; transformRequire(code, id)            return &#123;              contents: result,              loader: &#39;js&#39;,            &#125;          &#125;,        ),          build.onLoad(            &#123;              filter: &#x2F;@æ•æ„Ÿæ•°æ®-fe\&#x2F;wiki-ui\&#x2F;dist\&#x2F;components\&#x2F;iconfont&#x2F;,              namespace: &#39;file&#39;,            &#125;,            async (&#123; path: id &#125;) &#x3D;&gt; &#123;              const code &#x3D; readFileSync(id).toString()              const result &#x3D; transformRequire(code, id)              return &#123;                contents: result,                loader: &#39;js&#39;,              &#125;            &#125;,          )      &#125;,    &#125;,    esbuildPluginMonacoEditorNls(&#123;      locale: Languages.zh_hans,    &#125;),  ],&#125;,</code></pre><h3 id="æ’æŸ¥3"><a href="#æ’æŸ¥3" class="headerlink" title="æ’æŸ¥3:"></a>æ’æŸ¥3:</h3><p>å°†wiki-uiç»„ä»¶æ”¾åˆ°umijsåº”ç”¨ä¸­è¿è¡Œ</p><pre class="line-numbers language-none"><code class="language-none"># æ­å»ºä¸ªé¡¹ç›®# ç§»åŠ¨demoç»„ä»¶åˆ°æ–°é¡¹ç›®# è¿è¡Œï¼Œå‘ç°æœ‰ç›¸åŒçš„é—®é¢˜</code></pre><h3 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h3><h4 id="1-dom"><a href="#1-dom" class="headerlink" title="1.dom"></a>1.dom</h4><p>è¾“å…¥è¿‡ç¨‹ä¸­ç‚¹å‡»åˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè¾“å…¥çš„å†…å®¹æ˜¯åœ¨<code>contenteditable=&quot;true&quot; </code>ä¸­è¿è¡Œ</p><pre class="line-numbers language-none"><code class="language-none">&lt;div data-gramm&#x3D;&quot;false&quot; role&#x3D;&quot;textbox&quot; spellcheck&#x3D;&quot;false&quot; class&#x3D;&quot;slash-slate-core&quot; id&#x3D;&quot;SLASH_SLATE_CORE&quot; data-app-id&#x3D;&quot;5A9BEA&quot; autocorrect&#x3D;&quot;false&quot; autocapitalize&#x3D;&quot;false&quot; data-slate-editor&#x3D;&quot;true&quot; data-slate-node&#x3D;&quot;value&quot; contenteditable&#x3D;&quot;true&quot; style&#x3D;&quot;position: relative; outline: none; white-space: pre-wrap; overflow-wrap: break-word;&quot;&gt;&lt;p data-slate-node&#x3D;&quot;element&quot;&gt;&lt;span data-slate-node&#x3D;&quot;text&quot;&gt;&lt;span data-slate-leaf&#x3D;&quot;true&quot;&gt;&lt;span data-slate-string&#x3D;&quot;true&quot;&gt;12121212å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆh h h h h h h h h h h h hs f s d f&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;</code></pre><h4 id="2-åˆæˆäº‹ä»¶"><a href="#2-åˆæˆäº‹ä»¶" class="headerlink" title="2.åˆæˆäº‹ä»¶"></a>2.åˆæˆäº‹ä»¶</h4><p>åº”è¯¥ä¼šèµ°åˆæˆäº‹ä»¶ï¼Œåˆæˆäº‹ä»¶ä¹‹åä¼šæ‰§è¡Œæ¸²æŸ“ï¼Œwebç«¯èµ°çš„æ˜¯react-domï¼Œæ¯”å¯¹æ­£å¸¸è¿è¡Œçš„é¡¹ç›®ï¼Œå’Œæ–°é¡¹ç›®çš„ç‰ˆæœ¬</p><pre class="line-numbers language-none"><code class="language-none"># react 17ç‰ˆæœ¬# react-dom 17ç‰ˆæœ¬</code></pre><h4 id="3-react"><a href="#3-react" class="headerlink" title="3.react"></a>3.react</h4><p>å…ˆè¿›è¡Œ<code>react</code>é™ç‰ˆæœ¬ <code>16.14.0</code>ï¼Œæ£€æŸ¥åˆæˆäº‹ä»¶æ˜¯å¦æœ‰é—®é¢˜ï¼Œé™ç‰ˆæœ¬åï¼Œè¿è¡Œï¼Œé—®é¢˜åŒæ ·å­˜åœ¨ï¼Œå¤§æ¦‚å¯ä»¥æ–­å®šæ˜¯<code>react-dom</code>æ¸²æŸ“å‡ºäº†é—®é¢˜ï¼Œ</p><h4 id="4-react-dom"><a href="#4-react-dom" class="headerlink" title="4.react-dom"></a>4.react-dom</h4><p>å¯¹<code>react-dom</code>é™ä½ç‰ˆæœ¬åˆ°<code>16.14.0</code>, åè¿è¡Œæ­£å¸¸ï¼Œé‚£ä¹ˆé—®é¢˜åº”è¯¥åœ¨<code>react-dom</code>ä¸Š</p><h4 id="5-githubç‰ˆæœ¬-16-14-0"><a href="#5-githubç‰ˆæœ¬-16-14-0" class="headerlink" title="5.githubç‰ˆæœ¬ 16.14.0"></a>5.githubç‰ˆæœ¬ 16.14.0</h4><p>ä¸¤ä¸ªç‰ˆæœ¬æœ‰ä»€ä¹ˆä¸åŒï¼šæŸ¥çœ‹<code>react</code>å‘å¸ƒæ—¥å¿—ï¼Œ16.14.0ä¹‹åçš„ä¸€ä¸ªç‰ˆæœ¬æ˜¯<a href="https://github.com/facebook/react/releases#:~:text=17.0.0%20(October%2020%2C%202020)">17.0.0 (October 20, 2020)</a> çœ‹ä¸Šå»ä¸äº‹ä»¶å’Œæ¸²æŸ“ç›¸å…³çš„ä¸œè¥¿ä¸å¤š</p><pre class="line-numbers language-none"><code class="language-none">Use browser focusin and focusout for onFocus and onBlur. (@trueadm in #19186)Make all Capture events use the browser capture phase. (@trueadm in #19221)Throw if forwardRef or memo component returns undefined. (@gaearon in #19550)Remove event pooling. (@trueadm in #18969)Fix onBeforeInput reporting an incorrect event.type. (@eps1lon in #19561)Fix event.relatedTarget reported as undefined in Firefox. (@claytercek in #19607)Fix rendering into a shadow root. (@Jack-Works in #15894)Fix movementX&#x2F;Y polyfill with capture events. (@gaearon in #19672)Artifactsreact: https:&#x2F;&#x2F;unpkg.com&#x2F;react@17.0.1&#x2F;umd&#x2F;react-art: https:&#x2F;&#x2F;unpkg.com&#x2F;react-art@17.0.1&#x2F;umd&#x2F;react-dom: https:&#x2F;&#x2F;unpkg.com&#x2F;react-dom@17.0.1&#x2F;umd&#x2F;react-is: https:&#x2F;&#x2F;unpkg.com&#x2F;react-is@17.0.1&#x2F;umd&#x2F;react-test-renderer: https:&#x2F;&#x2F;unpkg.com&#x2F;react-test-renderer@17.0.1&#x2F;umd&#x2F;scheduler: https:&#x2F;&#x2F;unpkg.com&#x2F;scheduler@0.20.1&#x2F;umd&#x2F;</code></pre><h4 id="6-githubç‰ˆæœ¬-18-1-0"><a href="#6-githubç‰ˆæœ¬-18-1-0" class="headerlink" title="6.githubç‰ˆæœ¬ 18.1.0"></a>6.githubç‰ˆæœ¬ 18.1.0</h4><p>åœ¨å¾€åæ‰¾æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå‘ç°åœ¨<a href="https://github.com/facebook/react/releases#:~:text=Compare-,18.1.0%20(April%2026%2C%202022),-Latest">18.1.0 (April 26, 2022)</a>ï¼Œæ”¹äº†ä¸€å †<code>react-dom</code>çš„bug,çœ‹ä¸Šå»ä¹Ÿæ²¡ç›¸å…³çš„</p><pre class="line-numbers language-none"><code class="language-none">Fix the false positive warning about react-dom&#x2F;client when using UMD bundle. (@alireza-molaee in #24274)Fix suppressHydrationWarning to work in production too. (@gaearon in #24271)Fix componentWillUnmount firing twice inside of Suspense. (@acdlite in #24308)Fix some transition updates being ignored. (@acdlite in #24353)Fix useDeferredValue causing an infinite loop when passed an unmemoized value. (@acdlite in #24247)Fix throttling of revealing Suspense fallbacks. (@sunderls in #24253)Fix an inconsistency in whether the props object is the same between renders. (@Andarist and @acdlite in #24421)Fix a missing warning about a setState loop in useEffect. (@gaearon in #24298)Fix a spurious hydration error. (@gnoff in #24404)Warn when calling setState in useInsertionEffect. (@gaearon in #24295)Ensure the reason for hydration errors is always displayed. (@gaearon in #24276)</code></pre><h3 id="å¯ç”¨ç‰ˆæœ¬"><a href="#å¯ç”¨ç‰ˆæœ¬" class="headerlink" title="å¯ç”¨ç‰ˆæœ¬"></a>å¯ç”¨ç‰ˆæœ¬</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;react&quot;: &quot;^16.14.0&quot;,&quot;react-dom&quot;: &quot;16.14.0&quot;,</code></pre><h3 id="è¿™ä¸ªæ¼”ç¤ºä»£ç æ­£å¸¸"><a href="#è¿™ä¸ªæ¼”ç¤ºä»£ç æ­£å¸¸" class="headerlink" title="è¿™ä¸ªæ¼”ç¤ºä»£ç æ­£å¸¸"></a>è¿™ä¸ªæ¼”ç¤ºä»£ç æ­£å¸¸</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;embed type&#x3D;&quot;text&#x2F;html&quot; src&#x3D;&quot;https:&#x2F;&#x2F;stackblitz.com&#x2F;edit&#x2F;react-ts-m3y5yv?embed&#x3D;1&amp;file&#x3D;App.tsx&amp;view&#x3D;preview&quot; width&#x3D;&quot;100%&quot; height&#x3D;&quot;200&quot;&gt;&lt;!--åŠ è½½å¤ªæ…¢ï¼Œå¤åˆ¶åœ°å€æŸ¥çœ‹å§--&gt; &lt;!--https:&#x2F;&#x2F;stackblitz.com&#x2F;edit&#x2F;react-ts-m3y5yv?embed&#x3D;1&amp;file&#x3D;App.tsx&amp;view&#x3D;preview--&gt; </code></pre><h2 id="æ‡µé€¼ã€‚ã€‚ã€‚"><a href="#æ‡µé€¼ã€‚ã€‚ã€‚" class="headerlink" title="æ‡µé€¼ã€‚ã€‚ã€‚"></a>æ‡µé€¼ã€‚ã€‚ã€‚</h2><p>ä»å¤´å¼€å§‹</p><pre class="line-numbers language-none"><code class="language-none">å¾…åŠäº‹é¡¹ä¸­çš„è¯„è®ºåŠŸèƒ½ï¼ˆç»„ä»¶é—®é¢˜ï¼‰å…‰æ ‡ä¹±è·³çš„é—®é¢˜ï¼›0. é¡¹ç›® + wiki-ui å¼‚å¸¸1. å•è¿è¡Œwiki-ui demo æ­£å¸¸2. è¿è¡Œslate + umijs æ­£å¸¸3. è¿è¡Œwiki-ui  + umijs å¼‚å¸¸4. slate ä¸  wiki-ui  ä¸ä¸€æ ·åœ¨äºslateç‰ˆæœ¬5. wiki-ui åšäº†ä»€ä¹ˆäº‹æƒ…ï¼š å®šåˆ¶åŒ–ä¸€äº›èŠ‚ç‚¹å±•ç¤ºï¼Œå…‰æ ‡çš„æ¸²æŸ“å’Œwiki-uiæ— å…³</code></pre><h2 id="è´«åƒ§å…ˆå»slateå®˜ç½‘åŒ–ç¼˜ï¼Œå›æ¥å†æˆ˜"><a href="#è´«åƒ§å…ˆå»slateå®˜ç½‘åŒ–ç¼˜ï¼Œå›æ¥å†æˆ˜" class="headerlink" title="è´«åƒ§å…ˆå»slateå®˜ç½‘åŒ–ç¼˜ï¼Œå›æ¥å†æˆ˜"></a>è´«åƒ§å…ˆå»slateå®˜ç½‘<code>åŒ–ç¼˜</code>ï¼Œå›æ¥å†æˆ˜</h2><p><a href="http://localhost:4000/post/2022-04-29slate-lean">slate-lean</a></p><h2 id="åŒ–ç¼˜å½’æ¥"><a href="#åŒ–ç¼˜å½’æ¥" class="headerlink" title="åŒ–ç¼˜å½’æ¥"></a>åŒ–ç¼˜å½’æ¥</h2><p>é—®é¢˜æ€ä¹ˆè§£å†³</p>]]></content>
      
      
      <categories>
          
          <category> wiki </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-è·¨åŸŸé—®é¢˜</title>
      <link href="//post/2022-05-09cors.html"/>
      <url>//post/2022-05-09cors.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æµè§ˆå™¨å®‰å…¨ç­–ç•¥é™åˆ¶è·¨åŸŸè®¿é—®</p><p>å†…å®¹å®‰å…¨ç­–ç•¥æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚</p><p>ç»´åŸºç™¾ç§‘ï¼š</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆè‹±è¯­ï¼šContent Security Policyï¼Œç®€ç§° CSPï¼‰æ˜¯ä¸€ç§è®¡ç®—æœºå®‰å…¨æ ‡å‡†ï¼Œæ—¨åœ¨é˜²å¾¡è·¨ç«™è„šæœ¬ã€ç‚¹å‡»åŠ«æŒç­‰ä»£ç æ³¨å…¥æ”»å‡»ï¼Œé˜»æ­¢æ¶æ„å†…å®¹åœ¨å—ä¿¡ç½‘é¡µç¯å¢ƒä¸­æ‰§è¡Œã€‚è¿™ä¸€æ ‡å‡†æ˜¯ W3C ç½‘ç»œåº”ç”¨å®‰å…¨å·¥ä½œç»„çš„å€™é€‰æ¨èæ ‡å‡†ï¼Œè¢«ç°ä»£ç½‘é¡µæµè§ˆå™¨å¹¿æ³›æ”¯æŒ</p></blockquote><ol><li>ä½¿ç”¨æ–¹å¼<br>ä¸ºä½¿ CSP å¯ç”¨, ä½ éœ€è¦é…ç½®ä½ çš„ç½‘ç»œæœåŠ¡å™¨è¿”å› Content-Security-Policyï¼Œæˆ–è€…åœ¨ HTML <meta> å…ƒç´ ç§ä¹Ÿå¯é…ç½®è¯¥ç­–ç•¥, ä¾‹å¦‚ï¼š</li></ol><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;meta  http-equiv&#x3D;&quot;Content-Security-Policy&quot;  content&#x3D;&quot;default-src &#39;self&#39;; img-src https:&#x2F;&#x2F;*; child-src &#39;none&#39;;&quot;&#x2F;&gt;</code></pre><ol start="2"><li>é…ç½®ç¤ºä¾‹<br>ï¼ˆ1ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…æƒ³è¦æ‰€æœ‰å†…å®¹å‡æ¥è‡ªç«™ç‚¹çš„åŒä¸€ä¸ªæº (ä¸åŒ…æ‹¬å…¶å­åŸŸå)</li></ol><pre class="line-numbers language-html" data-language="html"><code class="language-html">Content-Security-Policy: default-src &#39;self&#39;</code></pre><p>ï¼ˆ2ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸å†…å®¹æ¥è‡ªä¿¡ä»»çš„åŸŸååŠå…¶å­åŸŸå (åŸŸåä¸å¿…é¡»ä¸ CSP è®¾ç½®æ‰€åœ¨çš„åŸŸåç›¸åŒ)</p><pre class="line-numbers language-none"><code class="language-none">Content-Security-Policy: default-src &#39;self&#39; *.trusted.com</code></pre><p>ï¼ˆ3ï¼‰ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸ç½‘é¡µåº”ç”¨çš„ç”¨æˆ·åœ¨ä»–ä»¬è‡ªå·±çš„å†…å®¹ä¸­åŒ…å«æ¥è‡ªä»»ä½•æºçš„å›¾ç‰‡, ä½†æ˜¯é™åˆ¶éŸ³é¢‘æˆ–è§†é¢‘éœ€ä»ä¿¡ä»»çš„èµ„æºæä¾›è€…(è·å¾—)ï¼Œæ‰€æœ‰è„šæœ¬å¿…é¡»ä»ç‰¹å®šä¸»æœºæœåŠ¡å™¨è·å–å¯ä¿¡çš„ä»£ç ã€‚</p><pre class="line-numbers language-none"><code class="language-none">Content-Security-Policy: default-src &#39;self&#39;;img-src *;media-src media1.com media2.com; script-src userscripts.example.com</code></pre><p>åœ¨è¿™é‡Œï¼Œå„ç§å†…å®¹é»˜è®¤ä»…å…è®¸ä»æ–‡æ¡£æ‰€åœ¨çš„æºè·å–, ä½†å­˜åœ¨å¦‚ä¸‹ä¾‹å¤–:</p><p>å›¾ç‰‡å¯ä»¥ä»ä»»ä½•åœ°æ–¹åŠ è½½(æ³¨æ„ â€œ*â€œ é€šé…ç¬¦)ã€‚<br>å¤šåª’ä½“æ–‡ä»¶ä»…å…è®¸ä» media1.com å’Œ media2.com åŠ è½½(ä¸å…è®¸ä»è¿™äº›ç«™ç‚¹çš„å­åŸŸå)ã€‚<br>å¯è¿è¡Œè„šæœ¬ä»…å…è®¸æ¥è‡ªäº userscripts.example.comã€‚</p><p>ä½œè€…ï¼šèœé¸¡å‰ç«¯<br>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/a45924e99a6d">https://www.jianshu.com/p/a45924e99a6d</a><br>æ¥æºï¼šç®€ä¹¦<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><h2 id="å¤„ç†æ–¹å¼"><a href="#å¤„ç†æ–¹å¼" class="headerlink" title="å¤„ç†æ–¹å¼"></a>å¤„ç†æ–¹å¼</h2><h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><ul><li>è„šæœ¬</li></ul><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">listen 80; # ç›‘å¬çš„ç«¯â¼   add_header &#39;Access-Control-Allow-Origin&#39; &#39;$http_origin&#39; ;   add_header &#39;Access-Control-Allow-Credentials&#39; &#39;true&#39; ;   add_header &#39;Access-Control-Allow-Methods&#39; &#39;PUT,POST,GET,DELETE,OPTIONS&#39; ;   add_header &#39;Access-Control-Allow-Headers&#39; &#39;Content-Type,Content-Length,Authorization,Accept,X-Requested-With&#39; ;</code></pre><ul><li>å®é™…æ“ä½œ</li></ul><p><img src="http://t-blog-images.aijs.top/img/20220509181853.webp"></p><h3 id="jsonp-æ–¹å¼-lt-åŠ¨æ€-script-gt"><a href="#jsonp-æ–¹å¼-lt-åŠ¨æ€-script-gt" class="headerlink" title="jsonp æ–¹å¼ &lt;åŠ¨æ€ script&gt;"></a>jsonp æ–¹å¼ &lt;åŠ¨æ€ script&gt;</h3><p>æœ€ç»å…¸çš„è·¨åŸŸâ½…æ¡ˆ jsonp jsonp æœ¬è´¨ä¸Šæ˜¯â¼€ä¸ª Hackï¼Œå®ƒåˆ©â½¤ <code>&lt;script&gt;</code> æ ‡ç­¾ä¸å—åŒæºç­–ç•¥é™åˆ¶çš„ç‰¹æ€§è¿›â¾è·¨åŸŸæ“ä½œã€‚</p><p>jsonp ä¼˜ç‚¹ï¼š å®ç°ç®€å• å…¼å®¹æ€§â¾®å¸¸å¥½</p><p>jsonp çš„ç¼ºç‚¹ï¼š</p><p>åªâ½€æŒ get è¯·æ±‚ï¼ˆå› ä¸º<code> &lt;script&gt;</code> æ ‡ç­¾åªèƒ½ getï¼‰<br>æœ‰å®‰å…¨æ€§é—®é¢˜ï¼Œå®¹æ˜“é­å— xss æ”»å‡»<br>éœ€è¦æœåŠ¡ç«¯é…åˆ jsonp è¿›â¾â¼€å®šç¨‹åº¦çš„æ”¹é€ </p><p>jsonp çš„å®ç°ï¼š</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function JSONP(&#123; url, params, callbackKey, callback &#125;) &#123;  &#x2F;&#x2F; åœ¨å‚æ•°â¾¥åˆ¶å®š callback çš„åå­—  params &#x3D; params || &#123;&#125;;  params[callbackKey] &#x3D; &quot;callback&quot;;  &#x2F;&#x2F; é¢„ç•™ callback  window.callback &#x3D; callback;  &#x2F;&#x2F; æ‹¼æ¥å‚æ•°å­—ç¬¦ä¸²  const paramKeys &#x3D; Object.keys(params);  const paramString &#x3D; paramKeys.map((key) &#x3D;&gt; &#96;$&#123;key&#125;&#x3D;$&#123;params[key]&#125;&#96;).join(&quot;&amp;&quot;);  &#x2F;&#x2F; æ’â¼Š DOM å…ƒç´   const script &#x3D; document.createElement(&quot;script&quot;);  script.setAttribute(&quot;src&quot;, &#96;$&#123;url&#125;?$&#123;paramString&#125;&#96;);  document.body.appendChild(script);&#125;JSONP(&#123;  url: &quot;http:&#x2F;&#x2F;s.weibo.com&#x2F;ajax&#x2F;jsonp&#x2F;suggestion&quot;,  params: &#123;    key: &quot;test&quot;,  &#125;,  callbackKey: &quot;callback&quot;,  callback(result) &#123;    console.log(result.data);  &#125;,&#125;);</code></pre><p>jsonp æœåŠ¡ç«¯æ”¹é€ </p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var http &#x3D; require(&quot;http&quot;);var urllib &#x3D; require(&quot;url&quot;);var port &#x3D; 10011;var data &#x3D; &#123; name: &quot;jifeng&quot;, company: &quot;tb&quot; &#125;;http  .createServer(function (req, res) &#123;    var params &#x3D; urllib.parse(req.url, true);    console.log(params);    if (params.query &amp;&amp; params.query.callback &#x2F;**å¯¹åº”å®¢æˆ·ç«¯ *&#x2F;) &#123;      &#x2F;&#x2F;console.log(params.query.callback);      var str &#x3D; params.query.callback + &quot;(&quot; + JSON.stringify(data) + &quot;)&quot;; &#x2F;&#x2F;jsonp      res.end(str);    &#125; else &#123;      res.end(JSON.stringify(data)); &#x2F;&#x2F;æ™®é€šçš„json    &#125;  &#125;)  .listen(port, function () &#123;    console.log(&quot;server is listening on port &quot; + port);  &#125;);</code></pre><h3 id="æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼-nginx"><a href="#æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼-nginx" class="headerlink" title="æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼ nginx"></a>æœåŠ¡ç«¯è®¾ç½®ï¼Œç±»ä¼¼ nginx</h3><p>cors æ˜¯â½¬å‰ä¸»æµçš„è·¨åŸŸè§£å†³â½…æ¡ˆï¼Œè·¨åŸŸèµ„æºå…±äº«(CORS) æ˜¯â¼€ç§æœºåˆ¶ï¼Œå®ƒä½¿â½¤é¢å¤–çš„ HTTP å¤´æ¥å‘Šè¯‰æµè§ˆå™¨ è®©è¿â¾åœ¨â¼€ ä¸ª origin (domain) ä¸Šçš„ Web åº”â½¤è¢«å‡†è®¸è®¿é—®æ¥â¾ƒä¸åŒæºæœåŠ¡å™¨ä¸Šçš„æŒ‡å®šçš„èµ„æºã€‚å½“â¼€ä¸ªèµ„æºä»ä¸è¯¥èµ„æºæœ¬èº«æ‰€åœ¨çš„æœ åŠ¡å™¨ä¸åŒçš„åŸŸã€åè®®æˆ–ç«¯â¼è¯·æ±‚â¼€ä¸ªèµ„æºæ—¶ï¼Œèµ„æºä¼šå‘èµ·â¼€ä¸ªè·¨åŸŸ HTTP è¯·æ±‚ã€‚ å¦‚æœä½ â½¤ expressï¼Œå¯ä»¥è¿™æ ·åœ¨åç«¯è®¾ç½®</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F;CORS middlewarevar allowCrossDomain &#x3D; function (req, res, next) &#123;  res.header(&quot;Access-Control-Allow-Origin&quot;, &quot;http:&#x2F;&#x2F;example.com&quot;);  res.header(&quot;Access-Control-Allow-Methods&quot;, &quot;GET,PUT,POST,DELETE&quot;);  res.header(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type&quot;);  &#x2F;&#x2F; é¢„æ£€çš„å­˜æ´»æ—¶é—´  res.setHeader(&quot;Access-Control-Max-Age&quot;, 60);  next();&#125;;&#x2F;&#x2F;...app.configure(function () &#123;  app.use(express.bodyParser());  app.use(express.cookieParser());  app.use(express.session(&#123; secret: &quot;cool beans&quot; &#125;));  app.use(express.methodOverride());  app.use(allowCrossDomain);  app.use(app.router);  app.use(express.static(__dirname + &quot;&#x2F;public&quot;));&#125;);</code></pre><p>åœ¨â½£äº§ç¯å¢ƒä¸­å»ºè®®â½¤æˆç†Ÿçš„å¼€æºä¸­é—´ä»¶è§£å†³é—®é¢˜ã€‚</p><p>ä¸åŒçš„ nodejs æ¡†æ¶è®¾ç½®æ–¹å¼ä¸åŒï¼Œä¸€èˆ¬è·¨åŸŸé—®é¢˜å‡ ä¹æ¡†æ¶å®˜ç½‘å¿…å¤‡ï¼ŒæŸ¥ä¸‹å°±æ™“å¾—å¦‚ä½•é…ç½®äº†ï¼Œä½†æœ¬è´¨éƒ½æ˜¯æ”¹å˜ç›¸åº”å¤´</p><h3 id="å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰"><a href="#å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰" class="headerlink" title="å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰"></a>å…¶ä»–ï¼ˆä¸å¸¸ç”¨ï¼‰</h3><ol><li>HTML5 XMLHttpRequest æœ‰â¼€ä¸ª APIï¼Œ<code>postMessage()</code>â½…æ³•å…è®¸æ¥â¾ƒä¸åŒæºçš„è„šæœ¬é‡‡â½¤å¼‚æ­¥â½…å¼è¿›â¾æœ‰é™çš„é€šä¿¡ï¼Œ å¯ä»¥å®ç°è·¨â½‚æœ¬æ¡£ã€å¤šçª—â¼ã€è·¨åŸŸæ¶ˆæ¯ä¼ é€’ã€‚</li></ol><details class="custom-details"><summary>Details</summary><p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; a.html  &lt;iframe src&#x3D;&quot;http:&#x2F;&#x2F;localhost:4000&#x2F;b.html&quot; frameborder&#x3D;&quot;0&quot; id&#x3D;&quot;frame&quot; onload&#x3D;&quot;load()&quot;&gt;&lt;&#x2F;iframe&gt; &#x2F;&#x2F;ç­‰å®ƒåŠ è½½å®Œè§¦å‘ä¸€ä¸ªäº‹ä»¶  &#x2F;&#x2F;å†…åµŒåœ¨http:&#x2F;&#x2F;localhost:3000&#x2F;a.html    &lt;script&gt;      function load() &#123;        let frame &#x3D; document.getElementById(&#39;frame&#39;)        frame.contentWindow.postMessage(&#39;æˆ‘çˆ±ä½ &#39;, &#39;http:&#x2F;&#x2F;localhost:4000&#39;) &#x2F;&#x2F;å‘é€æ•°æ®        window.onmessage &#x3D; function(e) &#123; &#x2F;&#x2F;æ¥å—è¿”å›æ•°æ®          console.log(e.data) &#x2F;&#x2F;æˆ‘ä¸çˆ±ä½         &#125;      &#125;    &lt;&#x2F;script&gt;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; b.htmlwindow.onmessage &#x3D; function (e) &#123;  console.log(e.data); &#x2F;&#x2F;æˆ‘çˆ±ä½   e.source.postMessage(&quot;æˆ‘ä¸çˆ±ä½ &quot;, e.origin);&#125;;</code></pre></p></details><ol start="2"><li><code>WebSocket</code> æ˜¯â¼€ç§åŒå‘é€šä¿¡åè®®ï¼Œåœ¨å»ºâ½´è¿æ¥ä¹‹åï¼ŒWebSocket çš„ server ä¸ client éƒ½èƒ½ä¸»åŠ¨å‘å¯¹â½…å‘é€æˆ–æ¥æ”¶æ•° æ®ï¼Œè¿æ¥å»ºâ½´å¥½äº†ä¹‹å client ä¸ server ä¹‹é—´çš„åŒå‘é€šä¿¡å°±ä¸ HTTP â½†å…³äº†ï¼Œå› æ­¤å¯ä»¥è·¨åŸŸã€‚</li><li><code>window.name + iframe</code>ï¼šwindow.name å±æ€§å€¼åœ¨ä¸åŒçš„â»šâ¾¯ï¼ˆç”šâ¾„ä¸åŒåŸŸåï¼‰åŠ è½½åä¾æ—§å­˜åœ¨ï¼Œå¹¶ä¸”å¯ä»¥â½€æŒâ¾®å¸¸ â»“çš„ name å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©â½¤è¿™ä¸ªç‰¹ç‚¹è¿›â¾è·¨åŸŸã€‚</li></ol><details class="custom-details"><summary>Details</summary><p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; a.html(http:&#x2F;&#x2F;localhost:3000&#x2F;b.html) &lt;iframe src&#x3D;&quot;http:&#x2F;&#x2F;localhost:4000&#x2F;c.html&quot; frameborder&#x3D;&quot;0&quot; onload&#x3D;&quot;load()&quot; id&#x3D;&quot;iframe&quot;&gt;&lt;&#x2F;iframe&gt; &lt;script&gt;   let first &#x3D; true   &#x2F;&#x2F; onloadäº‹ä»¶ä¼šè§¦å‘2æ¬¡ï¼Œç¬¬1æ¬¡åŠ è½½è·¨åŸŸé¡µï¼Œå¹¶ç•™å­˜æ•°æ®äºwindow.name   function load() &#123;     if(first)&#123;     &#x2F;&#x2F; ç¬¬1æ¬¡onload(è·¨åŸŸé¡µ)æˆåŠŸåï¼Œåˆ‡æ¢åˆ°åŒåŸŸä»£ç†é¡µé¢       let iframe &#x3D; document.getElementById(&#39;iframe&#39;);       iframe.src &#x3D; &#39;http:&#x2F;&#x2F;localhost:3000&#x2F;b.html&#39;;       first &#x3D; false;     &#125;else&#123;     &#x2F;&#x2F; ç¬¬2æ¬¡onload(åŒåŸŸb.htmlé¡µ)æˆåŠŸåï¼Œè¯»å–åŒåŸŸwindow.nameä¸­æ•°æ®       console.log(iframe.contentWindow.name);     &#125;   &#125; &lt;&#x2F;script&gt;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; c.html(http:&#x2F;&#x2F;localhost:4000&#x2F;c.html)&lt;script&gt;window.name &#x3D; &#39;æˆ‘ä¸çˆ±ä½ &#39;&lt;&#x2F;script&gt;</code></pre><p>é€šè¿‡ iframe çš„ src å±æ€§ç”±å¤–åŸŸè½¬å‘æœ¬åœ°åŸŸï¼Œè·¨åŸŸæ•°æ®å³ç”± iframe çš„ window.name ä»å¤–åŸŸä¼ é€’åˆ°æœ¬åœ°åŸŸã€‚è¿™ä¸ªå°±å·§å¦™åœ°ç»•è¿‡äº†æµè§ˆå™¨çš„è·¨åŸŸè®¿é—®é™åˆ¶ï¼Œä½†åŒæ—¶å®ƒåˆæ˜¯å®‰å…¨æ“ä½œã€‚</p></p></details><ol start="4"><li><code>location.hash + iframe</code>ï¼ša.html æ¬²ä¸ c.html è·¨åŸŸç›¸äº’é€šä¿¡ï¼Œé€šè¿‡ä¸­é—´â»š b.html æ¥å®ç°ã€‚ ä¸‰ä¸ªâ»šâ¾¯ï¼Œä¸åŒåŸŸä¹‹é—´åˆ©â½¤ iframe çš„ location.hash ä¼ å€¼ï¼Œç›¸åŒåŸŸä¹‹é—´ç›´æ¥ js è®¿é—®æ¥é€šä¿¡ã€‚</li></ol><details class="custom-details"><summary>åŠ¨æ€åˆ›å»º iframe</summary><p>å…·ä½“å®ç°æ­¥éª¤ï¼šä¸€å¼€å§‹ a.html ç»™ c.html ä¼ ä¸€ä¸ª hash å€¼ï¼Œç„¶å c.html æ”¶åˆ° hash å€¼åï¼Œå†æŠŠ hash å€¼ä¼ é€’ç»™ b.htmlï¼Œæœ€å b.html å°†ç»“æœæ”¾åˆ° a.html çš„ hash å€¼ä¸­ã€‚<br>åŒæ ·çš„ï¼Œa.html å’Œ b.html æ˜¯åŒåŸŸçš„ï¼Œéƒ½æ˜¯ <a href="http://localhost:3000;è€Œ">http://localhost:3000;è€Œ</a> c.html æ˜¯ <a href="http://localhost:4000/">http://localhost:4000</a></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; a.html &lt;iframe src&#x3D;&quot;http:&#x2F;&#x2F;localhost:4000&#x2F;c.html#iloveyou&quot;&gt;&lt;&#x2F;iframe&gt; &lt;script&gt;   window.onhashchange &#x3D; function () &#123; &#x2F;&#x2F;æ£€æµ‹hashçš„å˜åŒ–     console.log(location.hash);   &#125; &lt;&#x2F;script&gt;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; b.html&lt;script&gt;  window.parent.parent.location.hash &#x3D; location.hash  &#x2F;&#x2F;b.htmlå°†ç»“æœæ”¾åˆ°a.htmlçš„hashå€¼ä¸­ï¼Œb.htmlå¯é€šè¿‡parent.parentè®¿é—®a.htmlé¡µé¢&lt;&#x2F;script&gt;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; c.htmlconsole.log(location.hash);let iframe &#x3D; document.createElement(&quot;iframe&quot;);iframe.src &#x3D; &quot;http:&#x2F;&#x2F;localhost:3000&#x2F;b.html#idontloveyou&quot;;document.body.appendChild(iframe);</code></pre></p></details><ol start="5"><li><code>document.domain + iframe</code>ï¼š è¯¥â½…å¼åªèƒ½â½¤äºâ¼†çº§åŸŸåç›¸åŒçš„æƒ…å†µä¸‹ï¼Œâ½å¦‚ a.test.com å’Œ b.test.com é€‚â½¤äºè¯¥â½… å¼ï¼Œæˆ‘ä»¬åªéœ€è¦ç»™â»šâ¾¯æ·»åŠ  document.domain &#x3D;â€™test.comâ€™ è¡¨ç¤ºâ¼†çº§åŸŸåéƒ½ç›¸åŒå°±å¯ä»¥å®ç°è·¨åŸŸï¼Œä¸¤ä¸ªâ»šâ¾¯éƒ½é€šè¿‡ js å¼ºåˆ¶è®¾ç½® document.domain ä¸ºåŸºç¡€ä¸»åŸŸï¼Œå°±å®ç°äº†åŒåŸŸã€‚</li></ol><details class="custom-details"><summary>Details</summary><p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; a.html&lt;body&gt; helloa  &lt;iframe src&#x3D;&quot;http:&#x2F;&#x2F;b.zf1.cn:3000&#x2F;b.html&quot; frameborder&#x3D;&quot;0&quot; onload&#x3D;&quot;load()&quot; id&#x3D;&quot;frame&quot;&gt;&lt;&#x2F;iframe&gt;  &lt;script&gt;    document.domain &#x3D; &#39;zf1.cn&#39;    function load() &#123;      console.log(frame.contentWindow.a);    &#125;  &lt;&#x2F;script&gt;&lt;&#x2F;body&gt;</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; b.html&lt;body&gt;  hellob  &lt;script&gt;document.domain &#x3D; &#39;zf1.cn&#39; var a &#x3D; 100;&lt;&#x2F;script&gt;&lt;&#x2F;body&gt;</code></pre></p></details><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://juejin.cn/post/6844903767226351623#heading-19" target="_blank" >ä¹ç§è·¨åŸŸæ–¹å¼å®ç°åŸç†ï¼ˆå®Œæ•´ç‰ˆï¼‰</a></p><p><a href="https://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" >Content Security Policy å…¥é—¨æ•™ç¨‹</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é¢˜æ±‡æ€»</title>
      <link href="//post/2022-05-08interview.html"/>
      <url>//post/2022-05-08interview.html</url>
      
        <content type="html"><![CDATA[<h2 id="å€¼å¾—æ”¶è—çš„é“¾æ¥"><a href="#å€¼å¾—æ”¶è—çš„é“¾æ¥" class="headerlink" title="å€¼å¾—æ”¶è—çš„é“¾æ¥"></a>å€¼å¾—æ”¶è—çš„é“¾æ¥</h2><ol><li><p><a target="_blank" href="https://juejin.cn/user/1381458394494461">ç ä¸Šé€šå¤©</a></p></li><li><p><a target="_blank" href="https://juejin.cn/post/6844904019165446158#heading-42">é¢è¯•å®Œ 50 ä¸ªäººåæˆ‘å†™ä¸‹è¿™ç¯‡æ€»ç»“</a></p></li><li><p><a target="_blank" href="https://juejin.cn/post/6844903897610321934">if æˆ‘æ˜¯å‰ç«¯å›¢é˜Ÿ Leaderï¼Œæ€ä¹ˆåˆ¶å®šå‰ç«¯åä½œè§„èŒƒ?</a></p></li><li><p><a target="_blank" href="https://juejin.cn/post/7061588533214969892">åšäº†ä¸€ä»½å‰ç«¯é¢è¯•å¤ä¹ è®¡åˆ’ï¼Œä¿ç†Ÿï½</a></p></li><li><p><a href="https://blog.csdn.net/weixin_43834338/article/details/115207151" target="_blank" >urlè§£æè¿‡ç¨‹</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-jså˜é‡å’Œä½œç”¨åŸŸ</title>
      <link href="//post/2022-05-08varible.html"/>
      <url>//post/2022-05-08varible.html</url>
      
        <content type="html"><![CDATA[<h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><h3 id="var-let-conståŒºåˆ«"><a href="#var-let-conståŒºåˆ«" class="headerlink" title="var let conståŒºåˆ«"></a>var let conståŒºåˆ«</h3><ul><li><strong>å˜é‡æå‡</strong>ï¼švar å­˜åœ¨å˜é‡æå‡ï¼Œletã€constä¹Ÿä¼šå˜é‡æå‡ï¼Œä½†æ˜¯ä¼šæœ‰æš‚æ—¶æ€§æ­»åŒºï¼ˆletã€constå­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼‰</li><li><strong>ä½œç”¨åŸŸçš„é™åˆ¶</strong>ï¼švarä¸å—ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œè€Œletã€constå—å½“å‰ä½œç”¨åŸŸçš„é™åˆ¶</li><li><strong>é‡å¤å£°æ˜</strong>ï¼švarå¯ä»¥é‡å¤å£°æ˜ï¼Œletã€constä¸å¯ä»¥</li><li><strong>constæ˜¯å¸¸é‡</strong>ï¼Œå¿…é¡»æœ‰åˆå§‹å€¼ï¼Œå¦åˆ™æŠ¥é”™ï¼Œä¸èƒ½æ›´æ”¹ï¼Œä½†æ˜¯å¯ä»¥æ›´æ”¹å¯¹è±¡å†…éƒ¨å±æ€§</li></ul><h3 id="å˜é‡åˆ†ç±»"><a href="#å˜é‡åˆ†ç±»" class="headerlink" title="å˜é‡åˆ†ç±»"></a>å˜é‡åˆ†ç±»</h3><ul><li>jsä¸­çš„å˜é‡åˆ†ä¸ºä¸¤ç§ï¼š<ul><li>å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚å…¨å±€å˜é‡å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯åœ¨jsä»»ä½•åœ°æ–¹éƒ½èƒ½å¤Ÿè°ƒç”¨çš„å˜é‡ï¼›</li><li>è€Œå±€éƒ¨å˜é‡å°±åªèƒ½åœ¨å‡½æ•°çš„å†…éƒ¨æ‰èƒ½å¤Ÿè°ƒç”¨çš„å˜é‡ã€‚</li></ul></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a&#x3D;10;function show()&#123;  console.log(&#39;a:&#39;+a); &#x2F;&#x2F;a:10  var b&#x3D;2;  console.log(&#39;inside b:&#39;+b); &#x2F;&#x2F;inside b:2&#125;show();console.log(&#39;outside b:&#39;+b); &#x2F;&#x2F;b is no defined</code></pre><p>ã€€ã€€åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œå˜é‡aå°±æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°çš„å†…éƒ¨èƒ½å¤Ÿè°ƒç”¨ã€‚ä½†æ˜¯è¿™é‡Œçš„å˜é‡bå°±æ˜¯å±€éƒ¨å˜é‡ï¼Œå½“å‡½æ•°ç»“æŸè°ƒç”¨åï¼Œå˜é‡bå°±è¢«å›æ”¶äº†ï¼Œå› æ­¤åœ¨å‡½æ•°å¤–éƒ¨è°ƒç”¨å¤±è´¥ã€‚</p><p><em>å¦å¤–éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼š</em></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å¦‚æœåœ¨å£°æ˜å±€éƒ¨å˜é‡æ—¶ä¸ç”¨varå£°æ˜ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡è‡ªåŠ¨â€œæå‡â€ä¸ºå…¨å±€å˜é‡ã€‚</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a&#x3D;10;function show()&#123;  console.log(&#39;a:&#39;+a); &#x2F;&#x2F;a:10  b&#x3D;2;  console.log(&#39;inside b:&#39;+b); &#x2F;&#x2F;inside b:2&#125;show();console.log(&#39;outside b:&#39;+b); &#x2F;&#x2F;outside b:2</code></pre><p>å¯¹æ¯”ä¸¤æ®µä»£ç ï¼Œ<em>å¦‚æœä½ åœ¨å£°æ˜b&#x3D;2æ—¶æ²¡æœ‰å†™varï¼Œé‚£ä¹ˆbå°±éšå¼åœ°å£°æ˜ä¸ºå…¨å±€å˜é‡</em>ï¼Œåœ¨å‡½æ•°å¤–é¢è¿˜æ˜¯èƒ½å¤Ÿè¢«è°ƒç”¨åˆ°çš„ã€‚<br>è™½ç„¶ä½¿ç”¨å…¨å±€å˜é‡èƒ½å¤Ÿåœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ï¼Œå¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å…¨å±€å˜é‡çš„ä¼˜ç‚¹ä¹Ÿç»™ä»–å¸¦æ¥äº†<em>ç¼ºç‚¹</em>ï¼š</p><ol><li>ä¸€ç›´å ç”¨å†…å­˜ï¼šå…¨å±€å˜é‡ä¿å­˜åœ¨é™æ€å­˜å‚¨åŒºï¼Œå¦‚æœå…¨å±€å˜é‡è¿‡å¤šä¼šå å¤šå¤§é‡å†…å­˜ï¼Œä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½ã€‚</li><li>å½±å“äº†å‡½æ•°çš„ç‹¬ç«‹æ€§ï¼šä¸€èˆ¬å‡½æ•°éƒ½æ˜¯ä¼ å…¥å‚æ•°å’Œä¼ å‡ºè¿”å›å€¼è¿›è¡Œè¿ç®—çš„ï¼Œå¦‚æœå‡½æ•°ä¾èµ–äºå…¨å±€å˜é‡ï¼Œç ´åäº†å‡½æ•°çš„è¿™ç§ç‹¬ç«‹æ€§ï¼Œ</li><li>å¯ç§»æ¤æ€§: åŒæ—¶ä¹Ÿé™ä½äº†å‡½æ•°çš„å¯ç§»æ¤æ€§ã€‚</li></ol><p><strong>å› æ­¤æˆ‘ä»¬åœ¨å®šä¹‰å˜é‡æ—¶ä¸€èˆ¬è¦å°½å¯èƒ½å°‘çš„å®šä¹‰å…¨å±€å˜é‡ã€‚</strong></p><h3 id="å˜é‡å£°æ˜"><a href="#å˜é‡å£°æ˜" class="headerlink" title="å˜é‡å£°æ˜"></a>å˜é‡å£°æ˜</h3><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡å£°æ˜</p></blockquote><p>ã€€ã€€ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥è¯´æ˜.</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a; function a()&#123;&#125;console.log(typeof a); &#x2F;&#x2F;function&#x2F;&#x2F; æˆ–è®¸æœ‰äººæ˜¯è®¤ä¸ºå‡½æ•°å£°æ˜åœ¨åé¢çš„åŸå› ï¼Œé‚£ä¹ˆè°ƒæ¢ä¸€ä¸‹ä½ç½®ã€‚</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">function a()&#123;&#125;var a; console.log(typeof a); &#x2F;&#x2F;function&#x2F;&#x2F; è°ƒæ¢ä½ç½®åå˜é‡açš„ç±»å‹è¿˜æ˜¯functionï¼Œè¿™æ—¶å€™å£°æ˜å˜é‡açš„è¯­å¥æ²¡æœ‰èµ·ä½œç”¨ï¼Œè¢«å‡½æ•°å£°æ˜è¦†ç›–äº†ã€‚&#x2F;&#x2F; å› æ­¤å‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡çš„å£°æ˜ã€‚&#x2F;&#x2F; ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨å£°æ˜çš„åŒæ—¶ç»™aè¿›è¡Œèµ‹å€¼ã€‚</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">function a()&#123;&#125;var a&#x3D;&#39;xyf&#39;; console.log(typeof a); &#x2F;&#x2F;string&#x2F;&#x2F; æˆ‘ä»¬å°†å…¶è°ƒæ¢ä¸€ä¸‹ä½ç½®å†æ¬¡è¿›è¡ŒéªŒè¯ã€‚</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">var a&#x3D;&#39;xyf&#39;; function a()&#123;&#125;console.log(typeof a); &#x2F;&#x2F;string&#x2F;&#x2F; å¯ä»¥çœ‹åˆ°ï¼Œç»™å˜é‡aè¿›è¡Œèµ‹å€¼åï¼Œä¸ç®¡å˜é‡aåœ¨å“ªï¼Œå…¶ç±»å‹å˜ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œä¸Šé¢ä¸¤æ®µä»£ç ç›¸å½“äºå¦‚ä¸‹ä»£ç ï¼š</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">function a()&#123;&#125;var a;a&#x3D;&#39;xyf&#39;;console.log(typeof a); &#x2F;&#x2F;string&#x2F;&#x2F; aæœ€åè¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå› æ­¤açš„ç±»å‹è‡ªç„¶æ˜¯å­—ç¬¦ä¸²</code></pre><h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><h3 id="å…¨å±€ä½œç”¨åŸŸ"><a href="#å…¨å±€ä½œç”¨åŸŸ" class="headerlink" title="å…¨å±€ä½œç”¨åŸŸ"></a>å…¨å±€ä½œç”¨åŸŸ</h3><p>ã€€jsä¸­ä½œç”¨åŸŸåªæœ‰<em>å‡½æ•°ä½œç”¨åŸŸ</em>å’Œ<em>å…¨å±€ä½œç”¨åŸŸ</em>ï¼Œ</p><h3 id="å‡½æ•°ä½œç”¨åŸŸ"><a href="#å‡½æ•°ä½œç”¨åŸŸ" class="headerlink" title="å‡½æ•°ä½œç”¨åŸŸ"></a>å‡½æ•°ä½œç”¨åŸŸ</h3><p>ã€€jsä¸­ä½œç”¨åŸŸåªæœ‰<em>å‡½æ•°ä½œç”¨åŸŸ</em>å’Œ<em>å…¨å±€ä½œç”¨åŸŸ</em>ï¼Œ</p><h3 id="å—çº§ä½œç”¨åŸŸ"><a href="#å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å—çº§ä½œç”¨åŸŸ"></a>å—çº§ä½œç”¨åŸŸ</h3><p>  let const<em>æœ‰å—çº§ä½œç”¨åŸŸ</em>ã€‚å‡½æ•°ä½œç”¨åŸŸæ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯å—çº§ä½œç”¨åŸŸå‘¢ï¼Ÿ<br>  <pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123;var a &#x3D; 1&#125;console.log(a)VM2355:1 1</code></pre><br>  <pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123;let a &#x3D;1&#125;console.log(a)VM2079:1 Uncaught ReferenceError: a is not defined</code></pre></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä»»ä½•ä¸€å¯¹èŠ±æ‹¬å·ï¼ˆï½›å’Œï½ï¼‰ä¸­çš„è¯­å¥é›†éƒ½å±äºä¸€ä¸ªå—ï¼Œåœ¨è¿™ä¹‹ä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡åœ¨ä»£ç å—å¤–éƒ½æ˜¯ä¸å¯è§çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå—çº§ä½œç”¨åŸŸã€‚</p></blockquote><p>ã€€ã€€ç†è§£äº†å—çº§ä½œç”¨åŸŸï¼Œæ¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„å°ä¾‹å­ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console.log(v); &#x2F;&#x2F;undefinedvar v &#x3D; &quot;world&quot;;ã€€ã€€&#x2F;&#x2F; è¿™æ®µä»£ç å¾ˆå¥½ç†è§£ï¼Œç”±äºå˜é‡våœ¨æ²¡æœ‰èµ‹å€¼å‰ä½¿ç”¨äº†ï¼Œæ‰€ä»¥æ˜¯undefinedã€‚å…¶å®è¿™é‡Œå­˜åœ¨ç€å£°æ˜çš„æå‰ã€‚</code></pre><p>å½“å‰ä½œç”¨åŸŸå†…çš„å£°æ˜éƒ½ä¼šæå‡åˆ°ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°çš„å£°æ˜</p><p>ç”±äºjsä½œç”¨åŸŸä¸­çš„å£°æ˜éƒ½ä¼šè¢«æå‡åˆ°ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼Œæ‰€ä»¥ï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var v;console.log(v); &#x2F;&#x2F;undefinedv &#x3D; &quot;world&quot;;&#x2F;&#x2F; è¿™æ ·å°±èƒ½å¾ˆæ¸…æ™°åœ°ç†è§£ä¸ºä»€ä¹ˆå˜é‡væ˜¯undefinedçš„äº†ã€‚&#x2F;&#x2F;ä¸‹é¢æˆ‘ä»¬æŠŠå˜é‡væ”¾åˆ°ä¸€ä¸ªæ–¹æ³•ä¸­å»ï¼š</code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js">if(true)&#123;  var v &#x3D; &quot;hello&quot;;&#125;console.log(v); &#x2F;&#x2F;hello&#x2F;&#x2F; åœ¨è¿™é‡Œç”±äºjsæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥ifæ–¹æ³•æ²¡æœ‰â€œå½¢æˆâ€ä¸€ä¸ªå°é—­çš„ä½œç”¨åŸŸï¼Œ&#x2F;&#x2F; å¹¶ä¸èƒ½å¤Ÿâ€œé˜»æŒ¡â€å¤–é¢çš„ä»£ç è·å–é‡Œé¢çš„å˜é‡ã€‚</code></pre><p>å‡½æ•°ä½œç”¨åŸŸ<br>ã€€ã€€æˆ‘ä»¬å†æŠŠå˜é‡væ”¾åˆ°å‡½æ•°ä¸­å»ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">function show()&#123;  var v&#x3D;&#39;world&#39;;&#125;show();console.log(v); &#x2F;&#x2F;undefined</code></pre><p>ã€€ã€€ç”±äºshowå‡½æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œâ€œé˜»æŒ¡â€å¤–é¢çš„ä»£ç è·å–é‡Œé¢å˜é‡ï¼ˆå¹¶ä¸èƒ½é˜»æŒ¡é‡Œé¢çš„ä»£ç è·å–å¤–é¢çš„å˜é‡ï¼‰ï¼Œæ‰€ä»¥å‡½æ•°å¤–éƒ¨å¹¶ä¸èƒ½è·å–åˆ°å‡½æ•°é‡Œé¢çš„å˜é‡vã€‚å› æ­¤è¯æ˜äº†jsä¸­åªæœ‰å‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸã€‚<br>ã€€ã€€å†æ¥çœ‹ä¸‹é¢çš„ä¸€æ®µä»£ç ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var v&#x3D;&#39;hello&#39;;function show()&#123;  console.log(v); &#x2F;&#x2F;undefined  var v&#x3D;&#39;world&#39;;&#125;show();</code></pre><p>ã€€ã€€å¾ˆå¤šäººçœ‹åˆ°è¿™è¾¹éƒ½ä¼šå¾ˆç–‘æƒ‘ï¼Œä¸æ˜¯è¯´è¿™è¾¹showå‡½æ•°ä¸­èƒ½å¤Ÿè·å–åˆ°å‡½æ•°å¤–é¢çš„å˜é‡çš„ä¹ˆï¼Ÿä½†æ˜¯ç”±äºè¿™è¾¹æ˜¯ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œè€Œå‡½æ•°ä½œç”¨åŸŸå­˜åœ¨ç€å˜é‡å£°æ˜çš„æå‰ï¼Œå› æ­¤ï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºä¸‹é¢çš„ä»£ç ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var v&#x3D;&#39;hello&#39;;function show()&#123;var v;console.log(v); &#x2F;&#x2F;undefinedv&#x3D;&#39;world&#39;;&#125;show();</code></pre><p>ã€€ã€€è¿™é‡ŒæŠŠå˜é‡vçš„å£°æ˜æ”¾åˆ°äº†æ•´ä¸ªå‡½æ•°ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼Œå› æ­¤æ˜¾ç¤ºä¸ºundefinedã€‚ç†è§£äº†ä¸Šé¢çš„ä»£ç ï¼Œç›¸ä¿¡ä¸‹é¢çš„ä»£ç ä¹Ÿä¸éš¾ç†è§£äº†ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">var v &#x3D; &quot;hello&quot;;(function()&#123;  console.log(v);  var v &#x3D; &quot;world&quot;;&#125;)();</code></pre><p>ã€€ã€€åœ¨è¿™é‡Œè‡ªæ‰§è¡Œå‡½æ•°å½¢æˆäº†å‡½æ•°ä½œç”¨åŸŸ</p><p>éœ€è¦æ³¨æ„çš„æ˜¯<br>å˜é‡æå‡åªæå‡å‡½æ•°çš„å£°æ˜ï¼Œå¹¶ä¸æå‡å‡½æ•°çš„å®šä¹‰</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">show(); &#x2F;&#x2F;show is not a functionvar show&#x3D;function()&#123;&#x2F;&#x2F;...&#125;show(); &#x2F;&#x2F;æˆåŠŸè¿è¡Œ</code></pre><p>ã€€ã€€æˆ–è®¸æœ‰äººæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¿™è¾¹å®šä¹‰çš„å‡½æ•°å°±ä¸èƒ½æ‰§è¡Œå‘¢ï¼Ÿåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ˜ç™½å‡½æ•°åœ¨jsä¸­æ˜¯å¦‚ä½•è¿›è¡Œå®šä¹‰çš„ã€‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å‡½æ•°æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ï¼Œä¸€ç§æ˜¯<code>å‡½æ•°å£°æ˜</code>ï¼Œå¦ä¸€ç§æ˜¯<code>å‡½æ•°è¡¨è¾¾å¼</code>ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å‡½æ•°å£°æ˜ä»€ä¹ˆæ˜¯å‡½æ•°è¡¨è¾¾å¼å‘¢ï¼Ÿ</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F;å‡½æ•°å£°æ˜function show()&#123;&#x2F;&#x2F;....&#125;&#x2F;&#x2F;å‡½æ•°è¡¨è¾¾å¼var show&#x3D;function()&#123;&#x2F;&#x2F;...&#125;</code></pre><p>ä¹ä¸€çœ‹ï¼Œä»–ä»¬é•¿å¾—å¾ˆåƒï¼Œå†™æ³•éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><ul><li>jsçš„è§£æå™¨å¯¹<code>å‡½æ•°å£°æ˜</code>å’Œ<code>å‡½æ•°è¡¨è¾¾å¼</code>å¹¶ä¸æ˜¯ä¸€è§†åŒä»çš„å¯¹å¾…çš„ï¼Œæœ‰ç‚¹â€œç§æ—æ­§è§†â€çš„æ„æ€åœ¨é‡Œé¢ã€‚</li><li><code>å‡½æ•°å£°æ˜å°±åƒæ˜¯â€œä¸€ç­‰å…¬æ°‘â€ï¼Œjsä¼šä¼˜å…ˆè¯»å–ï¼Œç¡®ä¿åœ¨æ‰§è¡Œå‰å°±å·²ç»è¢«è§£æäº†</code>ï¼Œæ‰€ä»¥å‡½æ•°å£°æ˜æ”¾åœ¨å½“å‰ä½œç”¨åŸŸçš„ä»»ä½•åœ°æ–¹éƒ½èƒ½å¤Ÿè¢«è°ƒç”¨ï¼Œç”šè‡³æ”¾åˆ°è°ƒç”¨å‡½æ•°å£°æ˜ä¹‹åé¢ã€‚</li><li><code>è€Œå‡½æ•°è¡¨è¾¾å¼å°±æ˜¾å¾—æ¯”è¾ƒâ€œæ™®é€šâ€ï¼Œå’Œä¸€èˆ¬çš„å˜é‡ä¸€æ ·ï¼Œåªæœ‰åˆ°æ‰§è¡Œåˆ°è¯¥è¡Œæ—¶æ‰è¿›è¡Œè§£æï¼Œ</code>å› æ­¤ï¼Œè°ƒç”¨å‡½æ•°è¡¨è¾¾å¼è¦åœ¨å®šä¹‰åè¿›è¡Œä½¿ç”¨ã€‚</li></ul><h2 id="other"><a href="#other" class="headerlink" title="other"></a>other</h2><p><a href="https://juejin.cn/post/6844904019165446158">https://juejin.cn/post/6844904019165446158</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•æ›´å¥½çš„æ²‰æ·€</title>
      <link href="//post/2022-04-28%E5%8D%9A%E5%AE%A2%E5%88%9B%E5%BB%BA.html"/>
      <url>//post/2022-04-28%E5%8D%9A%E5%AE%A2%E5%88%9B%E5%BB%BA.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul><li>å·¥ä½œæ—¥å¸¸ç»éªŒæ€§æ€»ç»“æ”¾å“ªï¼Ÿ</li><li>å­˜ç”µè„‘ï¼Œç”µè„‘åäº†é‡åšç³»ç»Ÿæ²¡äº†ï¼Œ</li><li>æ”¾åˆ°ç”µè„‘å¤‡å¿˜å½•ï¼Œå§æ§½ï¼Œæ€ä¹ˆæ²¡åŠæ—¶æ›´æ–°</li><li>æ”¾è‡ªå·±çš„æœåŠ¡å™¨ï¼Œæ²¡æ—¶é—´æ‰“ç†ï¼ŒæœåŠ¡å™¨åˆ°æœŸï¼Œå—å±äº†ï¼Œæ²¡æ¥çš„åŠè¿ç§»</li></ul><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h2><ul><li>hexo ç”±äºæœ‰ä¸°å¯Œçš„æ’ä»¶å’Œä¸»é¢˜ï¼Œä½¿ç”¨åŠéƒ¨ç½²æ–¹ä¾¿ï¼Œå¤‡å—æ¬¢è¿</li><li>è‡ªå·±è´­ä¹°æœåŠ¡å™¨éƒ¨ç½²ï¼ŒæœåŠ¡å™¨åˆ°æœŸåç»­è´¹å¾ˆè´µ</li><li>æ”¾åˆ°ç¬¬ä¸‰æ–¹åšå®¢ä¸Šï¼Œå¥½ä¸€ç‚¹çš„åƒç®€ä¹¦ï¼Œæ¯å¤©å‘å¸ƒé™åˆ¶ä¸¤ç¯‡ï¼Œå¯æ§æ€§å¤ªå·®</li></ul><h2 id="hexo-ä¸»é¢˜"><a href="#hexo-ä¸»é¢˜" class="headerlink" title="hexo ä¸»é¢˜"></a>hexo ä¸»é¢˜</h2><p>è¿™é‡Œä½¿ç”¨ <code>aurora</code></p><pre class="line-numbers language-none"><code class="language-none">theme: aurora</code></pre><p><a href="https://tridiamond.tech/">tridiamond</a><br><a href="https://github.com/AlphaHinex/AlphaHinex.github.io">AlphaHinex</a></p><h2 id="é˜¿é‡Œäº‘-oss"><a href="#é˜¿é‡Œäº‘-oss" class="headerlink" title="é˜¿é‡Œäº‘ oss"></a>é˜¿é‡Œäº‘ oss</h2><ul><li>å›¾ç‰‡èµ„æºæ”¾åˆ° github ä¸Šï¼Œè®¿é—®è¾ƒæ…¢ï¼Œä¸ºäº†æå‡ä½“éªŒï¼Œå°†èµ„æºæ”¾åˆ° oss ä¸Šï¼Œæƒé™é…ç½®ä¸ºå…¬å¼€ï¼Œå¯è¢«ä»»ä½•ç”¨æˆ·è®¿é—®</li></ul><h2 id="é˜¿é‡Œäº‘åŸŸå"><a href="#é˜¿é‡Œäº‘åŸŸå" class="headerlink" title="é˜¿é‡Œäº‘åŸŸå"></a>é˜¿é‡Œäº‘åŸŸå</h2><ul><li>åŸŸåè®¿é—®æ¯”è¾ƒæ–¹ä¾¿ï¼Œå›¾ç‰‡èµ„æºåªæœ‰åœ¨ä½¿ç”¨åŸŸåçš„æƒ…å†µä¸‹ï¼Œå„èµ„æºå¯ä»¥é¢„è§ˆï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸‹è½½</li></ul><h2 id="PicGo-å›¾åºŠã€Œè´¼å¥½ç”¨ï¼Œ"><a href="#PicGo-å›¾åºŠã€Œè´¼å¥½ç”¨ï¼Œ" class="headerlink" title="PicGo å›¾åºŠã€Œè´¼å¥½ç”¨ï¼Œ"></a>PicGo å›¾åºŠã€Œè´¼å¥½ç”¨ï¼Œ</h2><ul><li>æ€è€ƒï¼šé™¤æ­¤ä¹‹å¤–ï¼Œå› ä¸ºå…¶å¼€æºæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‹ä½œè€…æ˜¯å¦‚ä½•å¤„ç†æ’ä»¶çš„ã€</li><li>ä¸ºåšå®¢ä¸­ md æ–‡æ¡£æä¾›å›¾ç‰‡é“¾æ¥ï¼Œæ”¾åˆ°é˜¿é‡Œäº‘ oss ä¸Š</li><li>ä¸Šä¼ æˆåŠŸ<br><img src="http://t-blog-images.aijs.top/img/20220428101247.png?x-oss-process=image/resize,h_300,w_500"></li><li>å› ä¸ºå¼€å‘è¿‡ electronï¼Œç¬¬ä¸€æƒ³åˆ°çš„æ˜¯æˆ‘è¦ debug,æ‰“å¼€æ§åˆ¶å°</li><li>åŸŸåé…é”™ä¸å¯è®¿é—®<br><img src="http://t-blog-images.aijs.top/img/20220428104003.png?x-oss-process=image/resize,h_300,w_500"><br><img src="http://t-blog-images.aijs.top/img/20220428104024.png?x-oss-process=image/resize,h_300,w_500"></li><li>é‡åˆ°å›¾ç‰‡,ä½œä¸ºç¨‹åºçŒ¿ç¬¬ä¸€ååº”è¦ä¼˜åŒ–ã€Œå‹ç¼©ã€<code>compress</code></li><li>æ’ä»¶ä¸‹è½½<br><img src="http://t-blog-images.aijs.top/img/20220428104511.png?x-oss-process=image/resize,h_300,w_500" alt="ä¸‹è½½æ’ä»¶"></li><li>æ’ä»¶å¯ç”¨<br><img src="http://t-blog-images.aijs.top/img/20220428104919.png?x-oss-process=image/resize,h_300,w_500" alt="éœ€è¦å¯åŠ¨æ’ä»¶ï¼Œä¸å™¨ç”¨æ²¡æœ‰æ•ˆæœ"></li><li>æ’ä»¶æ˜¯å¦ç”Ÿæ•ˆäº†<br><img src="http://t-blog-images.aijs.top/img/20220428105126.png?x-oss-process=image/resize,h_300,w_500" alt="å‹ç¼©åçš„æ ¡éªŒ"></li><li>æ’ä»¶åˆ—è¡¨<br><a href="https://github.com/PicGo/Awesome-PicGo">github é“¾æ¥</a></li></ul><h2 id="ä¹¦å†™æ–‡ç« -hexo-é¡µé¢ä¸çƒ­é‡è½½ï¼Ÿ"><a href="#ä¹¦å†™æ–‡ç« -hexo-é¡µé¢ä¸çƒ­é‡è½½ï¼Ÿ" class="headerlink" title="ä¹¦å†™æ–‡ç«  hexo é¡µé¢ä¸çƒ­é‡è½½ï¼Ÿ"></a>ä¹¦å†™æ–‡ç«  hexo é¡µé¢ä¸çƒ­é‡è½½ï¼Ÿ</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yarn add global browser-syncyarn add hexo-browsersync</code></pre><h2 id="å¯ç”¨è¯„è®º"><a href="#å¯ç”¨è¯„è®º" class="headerlink" title="å¯ç”¨è¯„è®º"></a>å¯ç”¨è¯„è®º</h2><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"># For local development only!gitalk:  enable: false  autoExpand: true  clientID: &quot;&quot;  clientSecret: &quot;&quot;  repo: &quot;dev-blog-comments&quot;  owner: &quot;TriDiamond&quot;  admin: [&quot;TriDiamond&quot;]  id: uid  language: en  distractionFreeMode: true  recentComment: true  proxy: &quot;&quot;# Valine comment plugin (recommended!)# see https:&#x2F;&#x2F;valine.js.org&#x2F;quickstart.htmlvaline:  enable: true  app_id: å»ç”³è¯·  app_key: å»ç”³è¯·  avatar: &quot;http:&#x2F;&#x2F;t-blog-images.aijs.top&#x2F;img&#x2F;avatar.jpeg&quot;  placeholder: Leave your thoughts behind~  visitor: true  lang: en  avatarForce: false  meta: [&quot;nick&quot;, &quot;mail&quot;]  requiredFields: []  admin: &quot;æµ·é¾™&quot;  recentComment: true</code></pre><h2 id="å›¾ç‰‡å¢åŠ æ°´å°"><a href="#å›¾ç‰‡å¢åŠ æ°´å°" class="headerlink" title="å›¾ç‰‡å¢åŠ æ°´å°"></a>å›¾ç‰‡å¢åŠ æ°´å°</h2><p><strong>é…ç½®åŠæ•ˆæœ</strong><br><img src="http://t-blog-images.aijs.top/img/20220524104857.webp"></p><h2 id="picgo-ç”Ÿæˆä»£ç "><a href="#picgo-ç”Ÿæˆä»£ç " class="headerlink" title="picgo ç”Ÿæˆä»£ç "></a>picgo ç”Ÿæˆä»£ç </h2><ul><li>å¯é€‰ä¸åŒçš„ä»£ç æ–¹å¼<img src="http://t-blog-images.aijs.top/img/20220526230443.png"/></li></ul><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><ol><li><p>æ¯æ¬¡å‘å¸ƒåï¼Œgithub page è‡ªå®šä¹‰åŸŸåä¼šä¸¢å¤±</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åœ¨_posts ç›®å½•ä¸‹å»ºç«‹ CNAME æ–‡ä»¶ å¡«å†™ä¸Šè‡ªå·±çš„åŸŸå</p></blockquote></li><li><p>å›¾åºŠ picGoï¼Œä¸Šä¼ äº†å›¾ç‰‡ï¼Œåœ¨ oss ä¸ŠæŸ¥çœ‹ä¹ŸæˆåŠŸäº†ï¼Œä½†æ˜¯ picGo ç›¸å†Œä¸­æ²¡æœ‰å±•ç¤º</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><code>/Users/chenhailong/Library/Application Support/picgo</code>ç›®å½•ä¸‹ï¼Œåˆ é™¤ <code>rm picgo.db</code>,é‡æ–°å¯åŠ¨<br>è§<a href="https://github.com/Molunerfinn/PicGo/issues/781">issue #781</a></p></blockquote></li><li><p>è°ƒæ•´åšå®¢æ–‡ä»¶æ—¶é—´ï¼Œè¿è¡Œåæ–‡ç« æ’åºå¹¶æ²¡æœ‰æ”¹å˜ï¼Œéœ€è¦æ¸…ç†æ ¹ç›®å½•ä¸‹<code>db.json</code></p></li><li><p>éƒ¨åˆ† tag æ‰¾ä¸åˆ°ç›¸å…³[tagName].json</p><p><strong>æœ¬åœ°</strong></p><img src="http://t-blog-images.aijs.top/img/20220624092901.webp" /><img src="http://t-blog-images.aijs.top/img/20220624092941.webp" />**çº¿ä¸Š**<img src="http://t-blog-images.aijs.top/img/20220624093041.webp" /><img src="http://t-blog-images.aijs.top/img/20220624093127.webp" /></li></ol><p><a href="https://blog.zhheo.com/p/5511910d.html" target="_blank" >Hexo æ”¹å˜ tag å› ä¸ºå¤§å°å†™é—®é¢˜è€Œ 404 çš„è§£å†³æ–¹æ³•</a></p><h2 id="aurora-ä¸»é¢˜-bug"><a href="#aurora-ä¸»é¢˜-bug" class="headerlink" title="aurora ä¸»é¢˜ bug"></a><code>aurora</code> ä¸»é¢˜ bug</h2><p>ä½œè€…æ˜¯æ²¡ç©ºä¿®æ”¹çš„</p><ol><li>æ–‡ç« è¯¦æƒ…<code>categories</code>ï¼Œæ— æ³•ç‚¹å‡»</li><li>é¦–é¡µ<code>categories</code>ä¸å±•ç¤º</li><li><code>categories</code> è·¯ç”±æ‰¾ä¸åˆ°</li><li>å½“ä»£ç ç±»ä¼¼çš„ä¸œè¥¿å¾ˆé•¿å¾ˆé•¿æ—¶ï¼Œæ ·å¼é”™ä¹±</li></ol><p><strong>æºç </strong></p><p><a href="http://v.aijs.top/post/2022-06-24aurora" target="_blank" >è§ hexo-theme-aurora æºç ä¿®æ”¹</a></p><h2 id="hexo-toc-æœ‰è¯¯"><a href="#hexo-toc-æœ‰è¯¯" class="headerlink" title="hexo toc æœ‰è¯¯"></a>hexo toc æœ‰è¯¯</h2><p><strong>toc é“¾æ¥ hash</strong></p><img src="http://t-blog-images.aijs.top/img/20220715095258.webp" /><p><strong>æ¥å£è¿”å›</strong></p><img src="http://t-blog-images.aijs.top/img/20220715104417.webp" /><p><strong>ç¼–è¯‘ç»“æœ</strong></p><img src="http://t-blog-images.aijs.top/img/20220715110208.webp" /><p><strong>hexo æºä»£ç </strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">for (let i &#x3D; 0, len &#x3D; data.length; i &lt; len; i++) &#123;    const el &#x3D; data[i];    const &#123; level, id, text &#125; &#x3D; el;    const href &#x3D; id ? &#96;#$&#123;encodeURL(id)&#125;&#96; : null; &#x2F;&#x2F; hrefè¢«ç¼–ç äº†ï¼Œè€Œmarkdownæ ‡é¢˜æ²¡æœ‰ç¼–ç ï¼Œå¯¼è‡´urlçš„hashæ— æ³•ä½¿ç”¨....    result +&#x3D; &#96;&lt;li class&#x3D;&quot;$&#123;className&#125;-item $&#123;className&#125;-level-$&#123;level&#125;&quot;&gt;&#96;;    if (href) &#123;      result +&#x3D; &#96;&lt;a class&#x3D;&quot;$&#123;className&#125;-link&quot; href&#x3D;&quot;$&#123;href&#125;&quot;&gt;&#96;;    &#125; else &#123;      result +&#x3D; &#96;&lt;a class&#x3D;&quot;$&#123;className&#125;-link&quot;&gt;&#96;;    &#125;&#125;&#x2F;&#x2F; ç¼–è¯‘è¾“å‡ºï¼š&lt;ol class&#x3D;&quot;toc&quot;&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#webpack-%E4%B8%8E-grunt%E3%80%81gulp-%E7%9A%84%E4%B8%8D%E5%90%8C%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;webpack ä¸ gruntã€gulp çš„ä¸åŒï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#webpack%E3%80%81rollup%E3%80%81parcel%E3%80%81vite-%E4%BC%98%E5%8A%A3%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;webpackã€rollupã€parcelã€vite ä¼˜åŠ£ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E6%9C%89%E5%93%AA%E4%BA%9B%E5%B8%B8%E2%BB%85%E7%9A%84-Loader%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;æœ‰å“ªäº›å¸¸â»…çš„ Loaderï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E6%9C%89%E5%93%AA%E4%BA%9B%E5%B8%B8%E2%BB%85%E7%9A%84-Plugin%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;æœ‰å“ªäº›å¸¸â»…çš„ Pluginï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E5%88%86%E5%88%AB%E4%BB%8B%E7%BB%8D-bundle%EF%BC%8Cchunk%EF%BC%8Cmodule-%E6%98%AF%E4%BB%80%E4%B9%88&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;åˆ†åˆ«ä»‹ç» bundleï¼Œchunkï¼Œmodule æ˜¯ä»€ä¹ˆ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#Loader-%E5%92%8C-Plugin-%E7%9A%84%E4%B8%8D%E5%90%8C%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;Loader å’Œ Plugin çš„ä¸åŒï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#webpack-%E7%9A%84%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;webpack çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ?&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E6%8F%8F%E8%BF%B0%E2%BC%80%E4%B8%8B%E7%BC%96%E5%86%99-loader-%E6%88%96-plugin-%E7%9A%84%E6%80%9D%E8%B7%AF%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;æè¿°â¼€ä¸‹ç¼–å†™ loader æˆ– plugin çš„æ€è·¯ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#webpack-%E7%9A%84%E7%83%AD%E6%9B%B4%E6%96%B0%E5%8E%9F%E7%90%86%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;webpack çš„çƒ­æ›´æ–°åŸç†ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E2%BD%A4-webpack-%E6%9D%A5%E4%BC%98%E5%8C%96%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;â½¤ webpack æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E5%A6%82%E4%BD%95%E6%8F%90%E2%BE%BC-webpack-%E7%9A%84%E6%89%93%E5%8C%85%E9%80%9F%E5%BA%A6&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;å¦‚ä½•æâ¾¼ webpack çš„æ‰“åŒ…é€Ÿåº¦?&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E5%A6%82%E4%BD%95%E6%8F%90%E2%BE%BC-webpack-%E7%9A%84%E6%9E%84%E5%BB%BA%E9%80%9F%E5%BA%A6%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;å¦‚ä½•æâ¾¼ webpack çš„æ„å»ºé€Ÿåº¦ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E6%80%8E%E4%B9%88%E9%85%8D%E7%BD%AE%E5%8D%95%E2%BB%9A%E5%BA%94%E2%BD%A4%EF%BC%9F%E6%80%8E%E4%B9%88%E9%85%8D%E7%BD%AE%E5%A4%9A%E2%BB%9A%E5%BA%94%E2%BD%A4%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;æ€ä¹ˆé…ç½®å•â»šåº”â½¤ï¼Ÿæ€ä¹ˆé…ç½®å¤šâ»šåº”â½¤ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#source-map-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%80%8E%E4%B9%88%E7%94%A8%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;source map æ˜¯ä»€ä¹ˆï¼Ÿç”Ÿäº§ç¯å¢ƒæ€ä¹ˆç”¨ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E6%A8%A1%E5%9D%97%E6%89%93%E5%8C%85%E5%8E%9F%E7%90%86%E7%9F%A5%E9%81%93%E5%90%97%EF%BC%9F&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;æ¨¡å—æ‰“åŒ…åŸç†çŸ¥é“å—ï¼Ÿ&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;li class&#x3D;&quot;toc-item toc-level-2&quot;&gt;&lt;a class&#x3D;&quot;toc-link&quot; href&#x3D;&quot;#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5&quot;&gt;&lt;span class&#x3D;&quot;toc-text&quot;&gt;å‚è€ƒé“¾æ¥&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;&lt;&#x2F;ol&gt;</code></pre><p>é—®é¢˜æ˜¯æ‰¾åˆ°äº†ï¼Œå…ˆä¸æ”¹ï¼Œæ²¡å¾—ç©ºï½</p><p><strong>å»é™¤ç¼–ç å¯è¡Œæ€§</strong></p><p><strong>ä»¥ webpack å®˜ç½‘ä¸ºä¾‹ï¼šæœ‰ä¸­æ–‡å¦¥å¦¥æ»´ï¼Œhexo å®˜æ–¹ç¼–äº†ä¸ªç ï¼Œæ•´äº†ä¸ª bug</strong></p><img src="http://t-blog-images.aijs.top/img/20220715111450.webp" /><h2 id="aurora-ä½¿ç”¨historyæ¨¡å¼"><a href="#aurora-ä½¿ç”¨historyæ¨¡å¼" class="headerlink" title="aurora ä½¿ç”¨historyæ¨¡å¼"></a>aurora ä½¿ç”¨historyæ¨¡å¼</h2><p>æˆ‘çš„æƒ³æ³•ï¼šä¸åŒé¡µé¢ä½¿ç”¨historyæ¨¡å¼ï¼Œé¡µé¢å†…æ ‡é¢˜æ»šåŠ¨ä½¿ç”¨hashã€‚<br><code>router.beforeEach</code>åœ¨hashæ”¹å˜æ—¶å€™ä¹Ÿèƒ½æ£€æµ‹åˆ°ï¼Œè¿™ä¸ªåœ°æ–¹ä¼šè§¦å‘loadingï¼Œä½†æ²¡æœ‰é‡æ–°å‘é€è¯·æ±‚ï¼Œä¹Ÿéœ€è¦åšè°ƒæ•´</p><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>æ€»ä½“è€Œè¨€ picgo å·²ç»å¾ˆå¥½äº†ï¼Œæœ‰å‡ ç‚¹å¯ä»¥ä¼˜åŒ–</p><ul><li>å·²æœ‰å›¾ç‰‡äºŒæ¬¡é‡æ–°ä¸Šä¼ å‹ç¼©åŠŸèƒ½</li><li>çª—å£å®åœ¨æ˜¯å¤ªå°äº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥æ‰‹åŠ¨æ‹–æ‹½æ”¹å˜å¤§å°</li><li>æ’ä»¶åˆ—è¡¨æ’ä»¶å¡ç‰‡éƒ¨åˆ†é‡å </li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lernaè°ƒè¯•å¼€æºåº“é‡åˆ°çš„é—®é¢˜</title>
      <link href="//post/2022-05-05lerna.html"/>
      <url>//post/2022-05-05lerna.html</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-none"><code class="language-none">yarn install --mutex network:42424 --non-interactiveğŸ‘‘ ~&#x2F;Desktop&#x2F;slate git:(main) $ lerna --version4.0.0ğŸ‘‘ ~&#x2F;Desktop&#x2F;slate git:(main) $ yarn global add lerna@3.19.0    Usage Error: The &#39;yarn global&#39; commands have been removed in 2.x - consider using &#39;yarn dlx&#39; or a third-party plugin instead$ yarn run [--inspect] [--inspect-brk] &lt;scriptName&gt; ...ğŸ‘‘ ~&#x2F;Desktop&#x2F;slate git:(main) $ yarn --version              3.0.1</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MACå­˜å‚¨ç©ºé—´ä¸è¶³é—®é¢˜</title>
      <link href="//post/2022-05-05mac.html"/>
      <url>//post/2022-05-05mac.html</url>
      
        <content type="html"><![CDATA[<p><img src="http://t-blog-images.aijs.top/img/20220505165350.webp"></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸºç¡€-String</title>
      <link href="//post/2022-05-03string.html"/>
      <url>//post/2022-05-03string.html</url>
      
        <content type="html"><![CDATA[<h3 id="è½¬åŒ–ä¸ºé©¼å³°å‘½å"><a href="#è½¬åŒ–ä¸ºé©¼å³°å‘½å" class="headerlink" title="è½¬åŒ–ä¸ºé©¼å³°å‘½å"></a>è½¬åŒ–ä¸ºé©¼å³°å‘½å</h3><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p><code>var s1 = &quot;get-element-by-id&quot;</code></p></blockquote><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">var f &#x3D; function (s) &#123;  return s.replace(&#x2F;-\w&#x2F;g, function (x) &#123;    return x.splice(1).toUpperCase();  &#125;);&#125;;</code></pre><h3 id="æ¨¡ç‰ˆå¼•æ“å®ç°"><a href="#æ¨¡ç‰ˆå¼•æ“å®ç°" class="headerlink" title="æ¨¡ç‰ˆå¼•æ“å®ç°"></a>æ¨¡ç‰ˆå¼•æ“å®ç°</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">let template &#x3D; &quot;æˆ‘æ˜¯&#123;&#123;name&#125;&#125;,å¹´é¾„&#123;&#123;age&#125;&#125;,æ€§åˆ«&#123;&#123;sex&#125;&#125;&quot;;let data &#x3D; &#123;  name: &quot;å§“å&quot;,  age: 18,&#125;;render(template, data); &#x2F;&#x2F;æˆ‘æ˜¯å§“å,å¹´é¾„18,æ€§åˆ«undefinedfunction render(template, data) &#123;  &#x2F;&#x2F; æ¨¡ç‰ˆå­—ç¬¦ä¸²æ­£åˆ™  const reg &#x3D; &#x2F;\&#123;\&#123;(\w+)\&#125;\&#125;&#x2F;;  &#x2F;&#x2F; åˆ¤æ–­æ¨¡ç‰ˆé‡Œæ˜¯å¦æœ‰æ¨¡ç‰ˆå­—ç¬¦ä¸²  if (reg.test(template)) &#123;    &#x2F;&#x2F; æŸ¥æ‰¾å½“å‰æ¨¡ç‰ˆé‡Œç¬¬ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„å­—ç¬¦    const name &#x3D; reg.exec(template)[1];    &#x2F;&#x2F; å°†ç¬¬ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²æ¸²æŸ“    template &#x3D; template.replace(reg, data[name]);    &#x2F;&#x2F; é€’å½’çš„æ¸²æŸ“å¹¶è¿”å›æ¸²æŸ“åçš„ç»“æ„    return render(template, data);  &#125;  return template;&#125;</code></pre><h3 id="è§£æ-URL-Params-ä¸ºå¯¹è±¡"><a href="#è§£æ-URL-Params-ä¸ºå¯¹è±¡" class="headerlink" title="è§£æ URL Params ä¸ºå¯¹è±¡"></a>è§£æ URL Params ä¸ºå¯¹è±¡</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">let url &#x3D;  &quot;http:&#x2F;&#x2F;www.domain.com&#x2F;?user&#x3D;anonymouse&amp;id&#x3D;123&amp;id&#x3D;456&amp;city&#x3D;%E5%8C%97%E4%BA%AC&amp;enabled&quot;;&#x2F;** * ç»“æœ * &#123; *  user: &#39;anonymouse&#39;, *  id: [123,456], &#x2F;&#x2F; é‡å¤å‡ºç°çš„keyï¼Œè¦è½¬åŒ–æˆæ•°ç»„ *  city: &#39;åŒ—äº¬&#39;, &#x2F;&#x2F; ä¸­æ–‡éœ€è¦è§£ç  *  enabled: true &#x2F;&#x2F; æœªæŒ‡å®šå€¼çš„keyï¼Œçº¦å®šä¸ºtrue * * * &#125; * **&#x2F;function parseParam(url) &#123;  const paramsStr &#x3D; &#x2F;.+\?(.+)$&#x2F;.exec(url)[1];  const paramsArr &#x3D; paramsArr.split(&quot;&amp;&quot;);  let paramsObj &#x3D; &#123;&#125;;  paramsArr.forEach((param) &#x3D;&gt; &#123;    if (&#x2F;&#x3D;&#x2F;.test(param)) &#123;      let [key, val] &#x3D; param.split(&quot;&#x3D;&quot;); &#x2F;&#x2F; æ‹†åˆ†é”®&#x2F;å€¼      val &#x3D; decodeURLComponent(val); &#x2F;&#x2F; æ±‰å­—è§£ç       val &#x3D; &#x2F;^\d+$&#x2F;.test(val) ? parseFloat(val) : val; &#x2F;&#x2F; æ•°å­—è½¬åŒ–      if (paramsObj.hasOwnProperty(key)) &#123;        paramsObj[key] &#x3D; [].concat(paramsObj[key], val); &#x2F;&#x2F; é‡å¤keyè½¬æ•°ç»„      &#125; else &#123;        paramsObj[key] &#x3D; val;      &#125;    &#125; else &#123;      paramsObj[key] &#x3D; true; &#x2F;&#x2F; å¤„ç†çº¦å®š    &#125;  &#125;);&#125;</code></pre><h3 id="æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ï¼Œå‡ºç°æœ€å¤šçš„å­—ç¬¦å’Œä¸ªæ•°"><a href="#æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ï¼Œå‡ºç°æœ€å¤šçš„å­—ç¬¦å’Œä¸ªæ•°" class="headerlink" title="æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ï¼Œå‡ºç°æœ€å¤šçš„å­—ç¬¦å’Œä¸ªæ•°"></a>æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ï¼Œå‡ºç°æœ€å¤šçš„å­—ç¬¦å’Œä¸ªæ•°</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">let str &#x3D; &quot;abcabcabcbbcccc&quot;;let num &#x3D; 0;let char &#x3D; &quot;&quot;;&#x2F;&#x2F; å…ˆæ’åºï¼Œåç”¨æ­£åˆ™å¤„ç†ä¸ªæ•°str &#x3D; str.split(&quot;&quot;).sort().join(&quot;&quot;);let re &#x3D; &#x2F;(\w)\1+&#x2F;g;str.replace(re, ($0, $1) &#x3D;&gt; &#123;  if (num &lt; $0.length) &#123;    num &#x3D; $0.length;    char &#x3D; $1;  &#125;&#125;);</code></pre><h3 id="å­—ç¬¦ä¸²æŸ¥æ‰¾"><a href="#å­—ç¬¦ä¸²æŸ¥æ‰¾" class="headerlink" title="å­—ç¬¦ä¸²æŸ¥æ‰¾"></a>å­—ç¬¦ä¸²æŸ¥æ‰¾</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">a &#x3D; &quot;34&quot;;b &#x3D; &quot;1234567&quot;; &#x2F;&#x2F; è¿”å›2a &#x3D; &quot;35&quot;;b &#x3D; &quot;1234567&quot;; &#x2F;&#x2F; è¿”å› -1a &#x3D; &quot;355&quot;;b &#x3D; &quot;1234355&quot;; &#x2F;&#x2F; è¿”å›5function isContain(a, b) &#123;  for (let i in b) &#123;    if (a[0] &#x3D;&#x3D;&#x3D; b[i]) &#123;      let tmp &#x3D; true; &#x2F;&#x2F; æ ‡è®°ï¼šæ»¡è¶³      for (let j in a) &#123;        if (a[j] !&#x3D;&#x3D; b[~~i + ~~j]) &#123;          tmp &#x3D; false; &#x2F;&#x2F; æ ‡è®°ï¼šä¸æ»¡è¶³        &#125;      &#125;      if (tmp) &#123;        return i;      &#125;    &#125;  &#125;  return -1;&#125;</code></pre><h3 id="å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦"><a href="#å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦" class="headerlink" title="å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦"></a>å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; ä¿ç•™ä¸‰ä½å°æ•°paraseToMoney(1234.56); &#x2F;&#x2F; return &#39;1,234.56&#39;paraseToMoney(123456789); &#x2F;&#x2F; return 123,456,789paraseToMoney(1087654.321); &#x2F;&#x2F; return 1,087,654.321function paraseToMoney(params) &#123;  num &#x3D; parseFloat(num.toFixed(3));  let [integer, decimal] &#x3D; String.prototype.split.call(num, &quot;.&quot;);  integer &#x3D; integer.replace(&#x2F;\d(?&#x3D;(\d&#123;3&#125;))+$&#x2F;, &quot;$&amp;,&quot;);  return integer + &quot;.&quot; + (decimal ?? &quot;&quot;);&#125;</code></pre><h3 id="åˆ¤æ–­æ˜¯å¦æ˜¯ç”µè¯å·ç "><a href="#åˆ¤æ–­æ˜¯å¦æ˜¯ç”µè¯å·ç " class="headerlink" title="åˆ¤æ–­æ˜¯å¦æ˜¯ç”µè¯å·ç "></a>åˆ¤æ–­æ˜¯å¦æ˜¯ç”µè¯å·ç </h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">function isPhone(str) &#123;  let regx &#x3D; &#x2F;^1[34578]\d&#123;9&#125;$&#x2F;;  return regx.test(str);&#125;</code></pre><h3 id="åˆ¤æ–­æ˜¯å¦æ˜¯é‚®ç®±"><a href="#åˆ¤æ–­æ˜¯å¦æ˜¯é‚®ç®±" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æ˜¯é‚®ç®±"></a>åˆ¤æ–­æ˜¯å¦æ˜¯é‚®ç®±</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; @ä¹‹å‰å¿…é¡»æœ‰å†…å®¹åªèƒ½æ˜¯ æ•°å­—ã€å­—æ¯(å¤§å°å†™)ã€ä¸‹åˆ’çº¿(_)ã€å‡å·(-)ã€ç‚¹ï¼ˆ.ï¼‰&#x2F;&#x2F; @ä¹‹åå’Œæœ€åä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰ä¹‹é—´å¿…é¡»æœ‰å†…å®¹ä¸”åªèƒ½æ˜¯ æ•°å­—ã€å­—æ¯(å¤§å°å†™)ã€ä¸‹åˆ’çº¿(_)ã€å‡å·(-)ï¼Œ&#x2F;&#x2F; ä¸¤ä¸ªç‚¹ä¸èƒ½æŒ¨ç€&#x2F;&#x2F; æœ€åä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰ä¹‹åï¼Œå¿…é¡»æœ‰å†…å®¹åªèƒ½æ˜¯ æ•°å­—ã€å­—æ¯ï¼ˆå¤§å°å†™ï¼‰ï¼Œé•¿åº¦å¤§äºç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œå°äºç­‰äº6ä¸ªå­—èŠ‚&#x2F;&#x2F; æŒ‰ç…§è§„åˆ™å†™function isEmail(email) &#123;  var regx &#x3D;    &#x2F;^[a-zA-Z0-9_.\-]+@[a-zA-Z0-9\-]+(\.[a-zA-Z0-9\-]+)*\.[a-zA-Z0-9]&#123;2,6&#125;$&#x2F;;  return regx.test(email);&#125;isEmail(&quot;841660202@qq.com&quot;); &#x2F;&#x2F; true&#x2F;&#x2F; ç®€å†™ä¼˜åŒ–function isEmail2(email) &#123;  var regx &#x3D; &#x2F;^[\w_.\-]+@[\w\-]+(\.[\w\-]+)*\.[\w]&#123;2,6&#125;$&#x2F;;  return regx.test(email);&#125;isEmail2(&quot;841660202@qq.com&quot;); &#x2F;&#x2F; true</code></pre><p><a href="https://wenku.baidu.com/view/8b6256a3d7d8d15abe23482fb4daa58da0111cd2.html" target="_blank" >å‚è€ƒ</a></p><p><a href="https://www.jianshu.com/p/bc2e7c0f5bfc#:~:text=%5Cw%20%E6%9F%A5%E6%89%BE%E5%8D%95%E8%AF%8D%E5%AD%97%E7%AC%A6%EF%BC%8C%E7%AD%89%E4%BB%B7%E4%BA%8E%5Ba%2DzA%2DZ0%2D9%5D" target="_blank" >\w æŸ¥æ‰¾å•è¯å­—ç¬¦ï¼Œç­‰ä»·äº[a-zA-Z0-9]</a></p><h3 id="æ ¡éªŒèº«ä»½è¯"><a href="#æ ¡éªŒèº«ä»½è¯" class="headerlink" title="æ ¡éªŒèº«ä»½è¯"></a>æ ¡éªŒèº«ä»½è¯</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; 15ä½æ•°å­— æˆ–è€…æ˜¯17+1ä½(æ•°å­—ï¼Œå¤§å°x)function isCard(number) &#123;  var regx &#x3D; &#x2F;(^\d&#123;15&#125;$)|(^\d&#123;17&#125;(\d|X|x)$)&#x2F;;  return regx.test(number);&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯åŸºç¡€ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„è®¾è®¡å¼•å‘çš„è¡€æ¡ˆ</title>
      <link href="//post/2022-04-29nextjs.html"/>
      <url>//post/2022-04-29nextjs.html</url>
      
        <content type="html"><![CDATA[<h2 id="è®°å½•ä¸ªbug-å¹¶åœ¨æ­¤æ–‡ä¸­è§„é¿"><a href="#è®°å½•ä¸ªbug-å¹¶åœ¨æ­¤æ–‡ä¸­è§„é¿" class="headerlink" title="è®°å½•ä¸ªbug,å¹¶åœ¨æ­¤æ–‡ä¸­è§„é¿"></a>è®°å½•ä¸ªbug,å¹¶åœ¨æ­¤æ–‡ä¸­è§„é¿</h2><p>æ­¤å¤„è®°ä¸‹ hexo-theme-aurora æºç bugï¼Œæ²¡ç©ºæ—¶å€™å¸®ä»–æ”¹</p><pre class="line-numbers language-none"><code class="language-none">.article .article-content p &#123;    font-size: .875rem;    line-height: 1.25rem;    margin-bottom: 0.5rem;    padding-bottom: 1rem;    word-break: break-all;&#125;</code></pre><h2 id="bugå¤ç°"><a href="#bugå¤ç°" class="headerlink" title="bugå¤ç°"></a>bugå¤ç°</h2><p><img src="http://t-blog-images.aijs.top/img/20220429103417.png"><br><img src="http://t-blog-images.aijs.top/img/20220429103946.png"></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">(node:29) UnhandledPromiseRejectionWarning: Error: Forbidden    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Object.getDataReport (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11494:19)    at async Promise.all (index 3)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)(Use &#96;node --trace-warnings ...&#96; to show where the warning was created)(node:29) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag &#96;--unhandled-rejections&#x3D;strict&#96; (see https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;cli.html#cli_unhandled_rejections_mode). (rejection id: 19)(node:29) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.(node:29) UnhandledPromiseRejectionWarning: Error: Forbidden    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Object.getDataReport (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11494:19)    at async Promise.all (index 3)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)(node:29) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag &#96;--unhandled-rejections&#x3D;strict&#96; (see https:&#x2F;&#x2F;nodejs.org&#x2F;api&#x2F;cli.html#cli_unhandled_rejections_mode). (rejection id: 44)Error: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Object.refreshPendingPerformanceNum (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11487:25)    at async Promise.all (index 2)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)Error: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Promise.all (index 0)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)Error: Forbidden    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Object.getDataReport (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11494:19)    at async Promise.all (index 3)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)Error: Forbidden    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Promise.all (index 0)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)Error: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Promise.all (index 0)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)Error: invalid json response body at https:&#x2F;&#x2F;login-daily.æ•æ„Ÿæ•°æ®-inc.cn:7799&#x2F;error&#x2F;illegal&#x2F;location reason: Unexpected token &lt; in JSON at position 0    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:13141:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Object.refreshPendingPerformanceNum (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:11487:25)    at async Promise.all (index 2)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-a053507d8512cb10a3ff.js:12208:22)</code></pre><h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">const [resp] &#x3D; await Promise.all([  getLoginInfo(ctx),  CommonModel.effects.refreshPendingObjectiveNum(req, ctx),  CommonModel.effects.refreshPendingPerformanceNum(req, ctx),  CommonModel.effects.getDataReport(req, ctx),])if (resp.success) &#123;  UserModal.actions.setUser(resp.result, req)&#125;</code></pre><h2 id="å¢åŠ å¼‚å¸¸æ•è·"><a href="#å¢åŠ å¼‚å¸¸æ•è·" class="headerlink" title="å¢åŠ å¼‚å¸¸æ•è·"></a>å¢åŠ å¼‚å¸¸æ•è·</h2><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">const [resp] &#x3D; await Promise.all([  getLoginInfo(ctx),  CommonModel.effects.refreshPendingObjectiveNum(req, ctx),  CommonModel.effects.refreshPendingPerformanceNum(req, ctx),  CommonModel.effects.getDataReport(req, ctx),]).catch(e&#x3D;&gt;&#123;  console.log(&quot;å‘ç”Ÿé”™è¯¯&quot;)  console.log(e)&#125;)</code></pre><h2 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h2><p>æ—¥å¿—ä»… <code>Forbidden</code> æœ‰æ•ˆä¿¡æ¯ï¼Œå¤§æ¦‚æ˜¯æ¥å£</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx">å‘ç”Ÿé”™è¯¯Error: Forbidden    at &#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-7be1c2d9b56a41e863e3.js:13144:29    at processTicksAndRejections (internal&#x2F;process&#x2F;task_queues.js:95:5)    at async Promise.all (index 0)    at async Function.getInitialProps (&#x2F;code&#x2F;client&#x2F;.next&#x2F;server&#x2F;pages&#x2F;_app-7be1c2d9b56a41e863e3.js:12208:22)</code></pre><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><ol><li>å› ä¸ºacl ä¼ä¸šæƒé™æ•´äº†180å¤©ï¼ˆé¡¶é…ï¼‰ï¼Œæ—¶ä¸æ—¶å°±å‡ºç°ç³»ç»Ÿç˜«ç—ªçš„æƒ…å†µï¼Œ<code>æ—¥å¸¸</code>ã€<code>çº¿ä¸Š</code>éƒ½æœ‰æ­¤é—®é¢˜è¿™æ¶æ„è®¾è®¡çš„ï¼Œä¼°è®¡æ²¡è°äº†ã€‚å®Œå…¨å¯ä»¥æ”¹æˆç¦»èŒåï¼Œç³»ç»Ÿè‡ªåŠ¨å°†ç”¨æˆ·ç¦æƒå³å¯</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œssoä¹Ÿæœ‰ä¸ªé€šç—…ï¼Œä¸‰ä¸ªæœˆæ²¡æ”¹è¿‡å¯†ç ï¼Œç”¨æˆ·è´¦æˆ·æ— æ³•ç™»å½•ï¼Œéœ€è¦é‡æ–°å¯†ç æ–¹å¯ç™»å½•</li></ol>]]></content>
      
      
      <categories>
          
          <category> bug </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nestjs ç»“åˆ knife4j</title>
      <link href="//post/2022-02-29node.html"/>
      <url>//post/2022-02-29node.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.npmjs.com/package/nest-knife4j">nest-knife4j</a><br><a href="https://github.com/xiaoymin/swagger-bootstrap-ui">knife4j github</a><br><a href="https://xiaoym.gitee.io/knife4j/documentation/">knife4j æ–‡æ¡£</a><br><code>knife4j</code>å¯ä»¥ç†è§£ä¸º<code>ä¸€å¥—swaggerçš®è‚¤</code>ï¼Œä¸ä½¿ç”¨knife4jé»˜è®¤æ˜¯<code>swagger 1</code>ç‰ˆæœ¬çš„æ ·å¼<br><img src="http://t-blog-images.aijs.top/img/11460713-6cda8a0126f7ee78.png"></p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nestjsæ–‡ä»¶ä¸Šä¼ </title>
      <link href="//post/2022-02-28node.html"/>
      <url>//post/2022-02-28node.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p><a href="https://www.jianshu.com/p/28f8dd9a732e">Nestjs ä¸Šä¼ æ–‡ä»¶</a><br><a href="https://www.cnblogs.com/ajanuw/p/9575278.html">Nestjs ä¸Šä¼ æ–‡ä»¶</a></p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æ‹–æ‹½å…¼å®¹</title>
      <link href="//post/2022-02-27react.html"/>
      <url>//post/2022-02-27react.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ‹–æ‹½åœ¨web-pc-ç«¯ã€iframeã€h5ç§»åŠ¨ç«¯"><a href="#æ‹–æ‹½åœ¨web-pc-ç«¯ã€iframeã€h5ç§»åŠ¨ç«¯" class="headerlink" title="æ‹–æ‹½åœ¨web pc ç«¯ã€iframeã€h5ç§»åŠ¨ç«¯"></a>æ‹–æ‹½åœ¨web pc ç«¯ã€iframeã€h5ç§»åŠ¨ç«¯</h2><h3 id="å­˜åœ¨å·®å¼‚"><a href="#å­˜åœ¨å·®å¼‚" class="headerlink" title="å­˜åœ¨å·®å¼‚"></a>å­˜åœ¨å·®å¼‚</h3><ul><li>web pc ç«¯æ”¯æŒï¼š<code>onMouseDown</code>ã€<code>onMouseUp</code>ã€<code>onMousemove</code>ã€<code>onDragStart</code>ã€<code>onDragEnd</code>ã€<code>nDragOver</code></li><li>iframe web pc ç«¯æ”¯æŒï¼š<code>onMouseDown</code>ã€<code>onMouseUp</code>ã€<code>onMousemove</code></li><li>h5ç§»åŠ¨ç«¯æ”¯æŒï¼š<code>onTouchStart</code>ã€<code>onTouchEnd</code>ã€<code>onTouchmove</code><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3></li></ul><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">export default function Draggable(props: Props) &#123;  const &#123; children, style, className, onDragFinish, onDraggingStart, onPositionGet, boundary &#x3D; &#123; x: MARGIN_TO_PAGE, y: MARGIN_TO_PAGE &#125; &#125; &#x3D; props  const [dragging, setDragging] &#x3D; useState(false)  const [attaching, setAttaching] &#x3D; useState(false)  const [top, setTop] &#x3D; useState(0)  const [left, setLeft] &#x3D; useState(0)  const ghostRef: MutableRefObject&lt;HTMLDivElement&gt; &#x3D; useRef()  const elRef: MutableRefObject&lt;HTMLDivElement&gt; &#x3D; useRef()  const onDragStart &#x3D; useCallback((e: DragEvent&lt;HTMLDivElement&gt; | TouchEvent&lt;HTMLDivElement&gt;) &#x3D;&gt; &#123;    let x    let y    if (isDrag(e)) &#123;      if (e.target !&#x3D;&#x3D; elRef.current) &#123;        return      &#125;      e.dataTransfer.setDragImage(emptyImg, 0, 0)      x &#x3D; e.clientX      y &#x3D; e.clientY    &#125; else &#123;      if (!e.target || !(e.target instanceof HTMLElement)) &#123;        return      &#125;      if (!parentHasClass(e.target, [rootStyles.feedbackRoot])) &#123;        return      &#125;      x &#x3D; e.touches[0].clientX      y &#x3D; e.touches[0].clientY    &#125;    e.stopPropagation()    const rect &#x3D; e.currentTarget.getBoundingClientRect()    const offsetX &#x3D; x - rect.x    const offsetY &#x3D; y - rect.y    setTop(rect.y)    setLeft(rect.x)    setDragging(true)    if (isDrag(e)) &#123;      dragoverHandle &#x3D; (event: DragEvent) &#x3D;&gt; &#123;        if (event.clientX || event.clientY) &#123;          setTop(event.clientY - offsetY)          setLeft(event.clientX - offsetX)        &#125;      &#125;      &#x2F;&#x2F; firefox ä¸­ï¼Œondrag æ‹¿ä¸åˆ°é¼ æ ‡çš„åæ ‡ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ document çš„ dragover      document.addEventListener(&#39;dragover&#39;, dragoverHandle)    &#125; else &#123;      dragoverHandle &#x3D; (event: TouchEvent) &#x3D;&gt; &#123;        const touch &#x3D; event.touches[0]        if (touch.clientX || touch.clientY) &#123;          setTop(touch.clientY - offsetY)          setLeft(touch.clientX - offsetX)        &#125;      &#125;      document.addEventListener(&#39;touchmove&#39;, dragoverHandle)    &#125;    onDraggingStart()  &#125;, [])  const onDragEnd &#x3D; useCallback((event) &#x3D;&gt; &#123;    if (!ghostRef.current) &#123;      setDragging(false)      return    &#125;    const rect &#x3D; ghostRef.current.getBoundingClientRect()    const &#123; rel, abs &#125; &#x3D; calcAttachSide(rect, boundary)    setTop(abs.top)    setLeft(abs.left)    setAttaching(true)    if (isDrag(event)) &#123;      document.removeEventListener(&#39;dragover&#39;, dragoverHandle)    &#125; else &#123;      document.removeEventListener(&#39;touchmove&#39;, dragoverHandle)    &#125;    &#x2F;&#x2F; onPosition &amp;&amp; onPosition(rel) &#x2F;&#x2F; å…¶ä»–ä¸šåŠ¡    dragoverHandle &#x3D; null    setTimeout(() &#x3D;&gt; &#123;      onDragFinish(rel)      setAttaching(false)      setDragging(false)    &#125;, 300)  &#125;, [])  const onMousedown &#x3D; useCallback((e) &#x3D;&gt; &#123;    const x &#x3D; e.clientX    const y &#x3D; e.clientY    const rect &#x3D; e.currentTarget.getBoundingClientRect()    const offsetX &#x3D; x - rect.x    const offsetY &#x3D; y - rect.y    setTop(rect.y)    setLeft(rect.x)    setDragging(true)    if (e.preventDefault) &#123;      e.preventDefault()    &#125; else &#123;      e.returnValue &#x3D; false    &#125;    document.onmousemove &#x3D; function (ev: any) &#123;      const _event &#x3D; ev || window.event      const endx &#x3D; _event.clientX - offsetX      const endy &#x3D; _event.clientY - offsetY      setTop(endy)      setLeft(endx)    &#125;  &#125;, [])  const onMouseup &#x3D; useCallback((e) &#x3D;&gt; &#123;    if (!ghostRef.current) &#123;      setDragging(false)      return    &#125;    const rect &#x3D; ghostRef.current.getBoundingClientRect()    const &#123; rel, abs &#125; &#x3D; calcAttachSide(rect, boundary)    setTop(abs.top)    setLeft(abs.left)    setAttaching(true)    document.onmousemove &#x3D; null    onPositionGet &amp;&amp; onPositionGet(rel)    setTimeout(() &#x3D;&gt; &#123;      onDragFinish(rel)      setAttaching(false)      setDragging(false)    &#125;, 300)  &#125;, []) &#x2F;&#x2F; èƒ½åŠ›æ£€æµ‹  if (&#39;dragover&#39; in document.documentElement || &#39;ontouchstart&#39; in document.documentElement) &#123;    return (      &lt;div        style&#x3D;&#123;style&#125;        className&#x3D;&#123;className&#125;        draggable        onTouchStart&#x3D;&#123;onDragStart&#125;        onTouchEnd&#x3D;&#123;onDragEnd&#125;        onDragStart&#x3D;&#123;onDragStart&#125;        onDragEnd&#x3D;&#123;onDragEnd&#125;        onDragOver&#x3D;&#123;prevent&#125;        ref&#x3D;&#123;elRef&#125;      &gt;        &lt;div          style&#x3D;&#123;dragging ? &#123; top, left &#125; : null&#125;          className&#x3D;&#123;cn(&#123;            [styles.dragging]: dragging,            [styles.attaching]: attaching,          &#125;)&#125;          ref&#x3D;&#123;ghostRef&#125;        &gt;          &#123;children&#125;        &lt;&#x2F;div&gt;      &lt;&#x2F;div&gt;    )  &#125;  return (    &lt;div      style&#x3D;&#123;style&#125;      className&#x3D;&#123;className&#125;      draggable      onMouseDown&#x3D;&#123;onMousedown&#125;      onMouseUp&#x3D;&#123;onMouseup&#125;      ref&#x3D;&#123;elRef&#125;    &gt;      &lt;div        style&#x3D;&#123;dragging ? &#123; top, left &#125; : null&#125;        className&#x3D;&#123;cn(&#123;          [styles.dragging]: dragging,          [styles.attaching]: attaching,        &#125;)&#125;        ref&#x3D;&#123;ghostRef&#125;      &gt;        &#123;children&#125;      &lt;&#x2F;div&gt;    &lt;&#x2F;div&gt;  )&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React DOM</title>
      <link href="//post/2022-05-04react.html"/>
      <url>//post/2022-05-04react.html</url>
      
        <content type="html"><![CDATA[<h2 id="17-0-0-October-20-2020"><a href="#17-0-0-October-20-2020" class="headerlink" title="17.0.0 (October 20, 2020)"></a>17.0.0 (October 20, 2020)</h2><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Delegate events to roots instead of document<br>æ¥çœ‹ä¸‹<a href="https://www.bigbinary.com/blog/react-17-delegates-events-to-root-instead-of-document">åŸå› </a></p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Reactè‡ªé¦–æ¬¡å‘å¸ƒä»¥æ¥ä¸€ç›´åœ¨è‡ªåŠ¨æ‰§è¡Œäº‹ä»¶å§”æ´¾ã€‚å®ƒç›´æ¥åœ¨æ–‡æ¡£èŠ‚ç‚¹ä¸Šä¸ºæ¯ä¸ªäº‹ä»¶ç±»å‹é™„åŠ ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>è™½ç„¶å®ƒæé«˜äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œä½†ç”±äºæ–‡æ¡£èŠ‚ç‚¹ä¸Šçš„äº‹ä»¶å§”æ´¾ï¼Œå·²ç»æŠ¥å‘Šäº†è®¸å¤šé—®é¢˜ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¸ºäº†æ¼”ç¤ºå…¶ä¸­ä¸€ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬ä»¥selectä¸‹æ‹‰åˆ—è¡¨ä¸ºä¾‹ã€‚<br>ä¸‹é¢ç¤ºä¾‹ä¸­çš„CountryDropDownæ˜¯ç”¨äºå›½å®¶é€‰æ‹©çš„Reactç»„ä»¶ï¼Œå®ƒå°†è¢«å‘ˆç°ç»™idä¸ºReact rootçš„divã€‚react DOMå®¹å™¨å°è£…åœ¨idä¸ºmainçš„divä¸­ï¼Œè¯¥divæœ‰ä¸€ä¸ªåŒ…å«stopPropagationï¼ˆï¼‰çš„æ›´æ”¹äº‹ä»¶ã€‚</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;!--Div&#39;s change event contains stopPropagation()--&gt;&lt;div id&#x3D;&quot;main&quot;&gt;  &lt;!--Div where react component will be rendered --&gt;  &lt;div id&#x3D;&quot;react-root&quot;&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;</code></pre><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx">class CountryDropDown extends React.Component &#123;  state &#x3D; &#123;    country: &#39;&#39;,  &#125;  const handleChange &#x3D; e &#x3D;&gt; &#123;    this.setState(&#123; country: e.target.value &#125;);  &#125;  render() &#123;    return (      &lt;table class&#x3D;&quot;table table-striped table-condensed&quot;&gt;        &lt;thead&gt;          &lt;tr&gt;            &lt;th&gt;Country&lt;&#x2F;th&gt;            &lt;th&gt;Selected country&lt;&#x2F;th&gt;          &lt;&#x2F;tr&gt;        &lt;&#x2F;thead&gt;        &lt;tbody&gt;          &lt;tr&gt;            &lt;td&gt;              &lt;select value&#x3D;&#123;this.state.country&#125;                onChange&#x3D;&#123;this.handleChange&#125;              &gt;                &lt;option value&#x3D;&quot;&quot;&gt;--Select--&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;India&quot;&gt;India&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;US&quot;&gt;US&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;Dubai&quot;&gt;Dubai&lt;&#x2F;option&gt;              &lt;&#x2F;select&gt;            &lt;&#x2F;td&gt;            &lt;td&gt;              &#123;this.state.country&#125;            &lt;&#x2F;td&gt;          &lt;&#x2F;tr&gt;        &lt;&#x2F;tbody&gt;      &lt;&#x2F;table&gt;    );  &#125;&#125;ReactDOM.render(&lt;CountryDropDown &#x2F;&gt;, document.getElementById(&#39;react-root&#39;));</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å°†æ›´æ”¹äº‹ä»¶é™„åŠ åˆ°ä¸»div</p></blockquote><pre class="line-numbers language-none"><code class="language-none">document.getElementById(&quot;main&quot;).addEventListener(  &quot;change&quot;,  function (e) &#123;    e.stopPropagation();  &#125;,  false);</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å½“é€‰æ‹©ä¸€ä¸ªå›½å®¶æ—¶ï¼Œæˆ‘ä»¬æ— æ³•çœ‹åˆ°æ‰€é€‰çš„å›½å®¶</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>æ­¤æ„å¤–è¡Œä¸ºçš„åŸå› æ˜¯é™„åŠ åˆ°æ–‡æ¡£èŠ‚ç‚¹çš„onChange dropdownäº‹ä»¶ã€‚åŒ…å«e.stopPropagationï¼ˆï¼‰çš„ä¸»divçš„changeäº‹ä»¶é˜»æ­¢äº†ä¸‹æ‹‰èœå•çš„onChangeäº‹ä»¶ã€‚</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜ï¼ŒReact 17ä¸å†åœ¨æ–‡æ¡£çº§åˆ«é™„åŠ äº‹ä»¶å¤„ç†ç¨‹åºã€‚ç›¸åï¼Œå®ƒå°†å®ƒä»¬é™„åŠ åˆ°æ ¹DOMå®¹å™¨ä¸­ï¼ŒReactæ ‘å°†è¢«æ¸²æŸ“åˆ°è¯¥å®¹å™¨ä¸­ã€‚<br><img src="https://www.bigbinary.com/blog_images/react17/react_17_event_delegation.png"></p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>åœ¨React 17ä¸­è¿›è¡Œæ›´æ”¹åï¼Œäº‹ä»¶è¢«é™„åŠ åˆ°æ ¹DOMå®¹å™¨ï¼ŒReactæ ‘è¢«å‘ˆç°åˆ°è¯¥å®¹å™¨ä¸­ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒonChangeäº‹ä»¶çš„ä¸‹æ‹‰åˆ—è¡¨å°†é™„åŠ åˆ°idä¸ºreact rootçš„divã€‚å½“é€‰æ‹©ä»»ä½•å›½å®¶&#x2F;åœ°åŒºå‘ˆç°é¢„æœŸè¡Œä¸ºæ—¶ï¼Œå°†è§¦å‘æ­¤äº‹ä»¶ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sentryé”™è¯¯æ—¥å¿—è·å–</title>
      <link href="//post/2021-06-20sentry.html"/>
      <url>//post/2021-06-20sentry.html</url>
      
        <content type="html"><![CDATA[<ul><li>å…ˆä¸Šå›¾</li></ul><p><img src="http://t-blog-images.aijs.top/img/11460713-94dac7337bf8ed4f.png"></p><p><img src="http://t-blog-images.aijs.top/img/11460713-2d4eb13808a7a16a.png"></p><p>This is a quick getting started guide. For in-depth instructions on integrating Sentry withÂ React, viewÂ <a href="https://docs.sentry.io/platforms/javascript/guides/react/">our complete documentation</a>.</p><p>To instrument your React application with Sentry, first install theÂ <code>@sentry/react</code>Â andÂ <code>@sentry/tracing</code>Â packages:</p><pre class="line-numbers language-none"><code class="language-none"># Using yarnyarn add @sentry&#x2F;react @sentry&#x2F;tracing# Using npmnpm install --save @sentry&#x2F;react @sentry&#x2F;tracing</code></pre><p>Next, import and initialize the Sentry module as early as possible, before initializing React:</p><pre class="line-numbers language-none"><code class="language-none">import React from &quot;react&quot;;import ReactDOM from &quot;react-dom&quot;;import * as Sentry from &quot;@sentry&#x2F;react&quot;;import &#123; Integrations &#125; from &quot;@sentry&#x2F;tracing&quot;;import App from &quot;.&#x2F;App&quot;;Sentry.init(&#123;  dsn: &quot;https:&#x2F;&#x2F;a5f1c39789b24bb7a434868b677e0c65@&#x2F;1063&quot;,  integrations: [new Integrations.BrowserTracing()],  &#x2F;&#x2F; Set tracesSampleRate to 1.0 to capture 100%  &#x2F;&#x2F; of transactions for performance monitoring.  &#x2F;&#x2F; We recommend adjusting this value in production  tracesSampleRate: 1.0,&#125;);ReactDOM.render(&lt;App &#x2F;&gt;, document.getElementById(&quot;root&quot;));&#x2F;&#x2F; Can also use with React Concurrent Mode&#x2F;&#x2F; ReactDOM.createRoot(document.getElementById(&#39;root&#39;)).render(&lt;App &#x2F;&gt;);</code></pre><p>The above configuration captures both error and performance data. To reduce the volume of performance data captured, changeÂ <code>tracesSampleRate</code>Â to a value between 0 and 1.</p><p>After this step, Sentry will report any uncaught exceptions triggered by your application.</p><p>You can trigger your first event from your development environment by raising an exception somewhere within your application. An example of this would be rendering a button whoseÂ <code>onClick</code>Â handler attempts to invoke a method that does not exist:</p><pre class="line-numbers language-none"><code class="language-none">return &lt;button onClick&#x3D;&#123;methodDoesNotExist&#125;&gt;Break the world&lt;&#x2F;button&gt;;</code></pre><p>Once youâ€™ve verified the library is initialized properly and sent a test event, consider visiting ourÂ <a href="https://docs.sentry.io/platforms/javascript/guides/react/">complete React docs</a>. There youâ€™ll find additional instructions for surfacing valuable context from React error boundaries, React Router, Redux, and more.</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS è‡ªåŠ¨ç”Ÿæˆ .d.ts</title>
      <link href="//post/2021-06-10scss2type.html"/>
      <url>//post/2021-06-10scss2type.html</url>
      
        <content type="html"><![CDATA[<h2 id="CSS-Module-Typed"><a href="#CSS-Module-Typed" class="headerlink" title="CSS Module Typed"></a>CSS Module Typed</h2><p><strong>vscode æ’ä»¶åˆ—è¡¨ä¸­æœ‰å¥½å¤šä¸ªï¼Œä¸è¦å®‰è£…é”™äº†</strong></p><p><img src="http://t-blog-images.aijs.top/img/20220607152316.webp"></p><h2 id="address"><a href="#address" class="headerlink" title="address"></a>address</h2><p><a href="https://marketplace.visualstudio.com/items?itemName=awwit.typed-css-modules-plugin">link</a></p><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>Install deps first:</p><h3 id="require"><a href="#require" class="headerlink" title="require"></a>require</h3><p><code>npm install typed-css-modules</code></p><h3 id="if-you-need-less"><a href="#if-you-need-less" class="headerlink" title="if you need less"></a>if you need less</h3><p><code>npm install less</code></p><h3 id="if-you-need-scss-x2F-sass"><a href="#if-you-need-scss-x2F-sass" class="headerlink" title="if you need scss&#x2F;sass"></a>if you need scss&#x2F;sass</h3><p><code>npm install sass</code></p><h3 id="if-you-need-stylus"><a href="#if-you-need-stylus" class="headerlink" title="if you need stylus"></a>if you need stylus</h3><p><code>npm install stylus</code></p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Modules can be installed globally. yarn is supported.</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>To switch the package manager (npm or yarn), you need to change the settings npm.packageManager of the built-in module vscode.npm.</p></blockquote><h3 id="Configuring"><a href="#Configuring" class="headerlink" title="Configuring"></a>Configuring</h3><p>By default, the option to automatically format .d.ts files using eslint is enabled. You can disable this feature through the setting â€œtyped-css-modules.eslint.enableâ€: false.</p><p>Usage<br>put</p><p><code>// @type</code></p><p>or</p><p><code>/* @type */</code></p><p>ahead of your .css&#x2F;.less&#x2F;.scss&#x2F;.sass&#x2F;.styl file, and save, you will get a d.ts file in same directory.</p><h3 id="preview"><a href="#preview" class="headerlink" title="preview"></a>preview</h3><p><img src="https://s2.ax1x.com/2019/01/31/k1yTT1.gif"></p><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><pre class="line-numbers language-scss" data-language="scss"><code class="language-scss">&#x2F;* @type *&#x2F;.root &#123;  padding: 16px;  min-height: 100%;  .empty-wrapper &#123;    height: 380px;    display: flex;    flex-direction: column;    align-items: center;    justify-content: center;  &#125;  &gt; h3 &#123;    font-size: inherit;    margin-bottom: 4px;  &#125;  .toolbar-wrapper &#123;    position: relative;    .toolbar &#123;      position: absolute;      margin: 12px 0;      z-index: 1;      &amp;.static &#123;        position: static;      &#125;      &gt; *:not(:first-child) &#123;        margin-left: 8px;      &#125;    &#125;  &#125;  .buttons &#123;    button &#123;      margin-right: 8px;    &#125;  &#125;&#125;.use-select &#123;  width: 300px;&#125;</code></pre><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">declare const styles: &#123;  readonly root: string;  readonly &quot;empty-wrapper&quot;: string;  readonly &quot;toolbar-wrapper&quot;: string;  readonly toolbar: string;  readonly static: string;  readonly buttons: string;  readonly &quot;use-select&quot;: string;&#125;;export &#x3D; styles;</code></pre><h3 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h3><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Creates .d.ts files from css-modules .css&#x2F;.less&#x2F;.scss&#x2F;.sass&#x2F;.styl files.</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Error: vscode-typed-css-modules: Cannot find global module â€˜typed-css-modulesâ€™</p></blockquote><pre class="line-numbers language-none"><code class="language-none">npm install -g typed-css-modules</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="//post/hello-world.html"/>
      <url>//post/hello-world.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new &quot;My New Post&quot;</code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vscode GitHub Copilot</title>
      <link href="//post/2022-05-08vscode.html"/>
      <url>//post/2022-05-08vscode.html</url>
      
        <content type="html"><![CDATA[<h2 id="Copilot"><a href="#Copilot" class="headerlink" title="Copilot"></a>Copilot</h2><a href="https://copilot.github.com/" target="_blank"><img src="https://copilot.github.com/head2x.png"  width= 100/></a><p>Your AI pair programmer</p><h3 id="å®˜ç½‘"><a href="#å®˜ç½‘" class="headerlink" title="å®˜ç½‘"></a><a href="https://copilot.github.com/">å®˜ç½‘</a></h3><p><img src="https://copilot.github.com/diagram.png"></p><h3 id="æ”¯æŒå¼€å‘å·¥å…·"><a href="#æ”¯æŒå¼€å‘å·¥å…·" class="headerlink" title="æ”¯æŒå¼€å‘å·¥å…·"></a>æ”¯æŒå¼€å‘å·¥å…·</h3><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>support Visual Studio Code, Neovim, and IntelliJ-based IDEs like JetBrains IntelliJ IDEA, Android Studio or PyCharm.</p></blockquote><h3 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h3><ul><li>éœ€è¦äººå‘˜å®¡æ‰¹é€šè¿‡ï¼Œç­‰[1-2 å·¥ä½œæ—¥]</li></ul><p><a href="https://github.com/features/copilot/signup">æ³¨å†Œ&#x2F;ç»“æœæŸ¥çœ‹</a><br><img src="http://t-blog-images.aijs.top/img/20220526184023.webp"></p><p><strong>æˆ‘ç­‰åˆ°äº†5æœˆ25å·æ‰é€šè¿‡</strong>ï¼Œå¥½åƒæœ‰ä¸¤å‘¨çš„æ ·å­ğŸ˜‚</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Join the GitHub Copilot waitlist<br>Access is limited to a small group of testers during the technical preview of GitHub Copilot. Sign up today for your chance to try it out and help us improve.</p></blockquote><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>Youâ€™re already on the waitlist for GitHub Copilot! Weâ€™ll notify you when weâ€™ve enabled it on your account. Make sure your primary email address is up-to-date so we can notify you.</p></blockquote><h3 id="vscode-å®‰è£…æ’ä»¶-Copilot"><a href="#vscode-å®‰è£…æ’ä»¶-Copilot" class="headerlink" title="vscode å®‰è£…æ’ä»¶ Copilot"></a>vscode å®‰è£…æ’ä»¶ <code>Copilot</code></h3><p><img src="http://t-blog-images.aijs.top/img/20220508111956.webp"></p><h3 id="è¯»æºç çš„åˆ©å™¨"><a href="#è¯»æºç çš„åˆ©å™¨" class="headerlink" title="è¯»æºç çš„åˆ©å™¨"></a>è¯»æºç çš„åˆ©å™¨</h3><p><img src="http://t-blog-images.aijs.top/img/20220527093323.webp"></p><h3 id="å†™æ–‡æ¡£çš„åˆ©å™¨"><a href="#å†™æ–‡æ¡£çš„åˆ©å™¨" class="headerlink" title="å†™æ–‡æ¡£çš„åˆ©å™¨"></a>å†™æ–‡æ¡£çš„åˆ©å™¨</h3><ul><li>æˆ‘è¿™é‡Œéœ€è¦æŸç§æ ¼å¼çš„ç¿»è¯‘æ•ˆæœ<br><img src="http://t-blog-images.aijs.top/img/Kapture%202022-06-08%20at%2017.46.08.gif"></li></ul><h3 id="ä¸å¹¸çš„äº‹"><a href="#ä¸å¹¸çš„äº‹" class="headerlink" title="ä¸å¹¸çš„äº‹"></a>ä¸å¹¸çš„äº‹</h3><p><a href="https://github.com/pricing#i-work-on-open-source-projects-can-i-get-access-to-github-copilot-for-free">æ”¶è´¹äº†</a></p><img src="http://t-blog-images.aijs.top/img/20220622154707.webp" /><img src="https://img1.baidu.com/it/u=2626775378,76936048&fm=253&fmt=auto&app=138&f=JPEG?w=300&h=300"/>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> vscode </tag>
            
            <tag> AIç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npm åŒ…å‘å¸ƒç›¸å…³</title>
      <link href="//post/2022-04-28npm.html"/>
      <url>//post/2022-04-28npm.html</url>
      
        <content type="html"><![CDATA[<h2 id="npm-åŒ…å‘å¸ƒ"><a href="#npm-åŒ…å‘å¸ƒ" class="headerlink" title="npm åŒ…å‘å¸ƒ"></a>npm åŒ…å‘å¸ƒ</h2><pre class="line-numbers language-none"><code class="language-none">npm notice &#x3D;&#x3D;&#x3D; Tarball Details &#x3D;&#x3D;&#x3D; npm notice name:          @tutu-fe&#x2F;wiki-ui                        npm notice version:       0.1.1-beta                              npm notice filename:      @tutu-fe&#x2F;wiki-ui-0.1.1-beta.tgz         npm notice package size:  85.7 kB                                 npm notice unpacked size: 449.9 kB                                npm notice shasum:        973f5eb8d74de04c34b8e9c94536f8924b1f9570npm notice integrity:     sha512-Uyo3zS0eaMOYE[...]60Ywmrmb&#x2F;brxQ&#x3D;&#x3D;npm notice total files:   205                                     npm notice npm ERR! code E403npm ERR! 403 403 Forbidden - PUT https:&#x2F;&#x2F;registry- - [maintainers_error] haotian.chen does not in maintainer listnpm ERR! 403 In most cases, you or one of your dependencies are requestingnpm ERR! 403 a package version that is forbidden by your security policy, ornpm ERR! 403 on a server you do not have access to.npm ERR! A complete log of this run can be found in:npm ERR!     &#x2F;Users&#x2F;haotian&#x2F;.npm&#x2F;_logs&#x2F;2022-04-28T09_58_10_365Z-debug.log</code></pre><h2 id="é…ç½®package-json"><a href="#é…ç½®package-json" class="headerlink" title="é…ç½®package.json"></a>é…ç½®package.json</h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;maintainers&quot;: [  &quot;davishua&quot;,Ã¥  &quot;haotian.chen&quot;],</code></pre><h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><p><img src="http://t-blog-images.aijs.top/img/20220428180656.png"><br><img src="http://t-blog-images.aijs.top/img/20220428180602.png"></p>]]></content>
      
      
      <categories>
          
          <category> npm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é’‰é’‰æˆæƒ-å•tokenåˆ·æ–°</title>
      <link href="//post/2019-10-31dd-auth.html"/>
      <url>//post/2019-10-31dd-auth.html</url>
      
        <content type="html"><![CDATA[<h2 id="é’‰é’‰æˆæƒ"><a href="#é’‰é’‰æˆæƒ" class="headerlink" title="é’‰é’‰æˆæƒ"></a>é’‰é’‰æˆæƒ</h2><p> é’‰é’‰å°ç¨‹åºï¼Œå•tokené˜²æ­¢è¿›è¡Œtokenåˆ·æ–°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; åˆ·æ–°tokenfunction refreshToken(corpId, cb) &#123;  dd.getAuthCode(&#123;    success: async (res) &#x3D;&gt; &#123;      const params &#x3D; &#123;        authCode: res.authCode,        corpId,      &#125;;      dd.stopPullDownRefresh();      const resAuth &#x3D; await authDing(params);      &#x2F;&#x2F; åªæœ‰æˆæƒæˆåŠŸæƒ…å†µä¸‹æ‰å¯ä»¥      if (resAuth.code &#x3D;&#x3D;&#x3D; &quot;000000&quot;) &#123;        saveToken(resAuth.data.token);        setLastTokenTime(new Date().getTime().toString());        if (cb) &#123;          cb();        &#125;      &#125; else &#123;        showToastFail(JSON.stringify(resAuth));      &#125;    &#125;,    fail: (err) &#x3D;&gt; &#123;      showToastFail(JSON.stringify(err));    &#125;,  &#125;);&#125;&#x2F;** * é’‰é’‰æˆæƒ * corpId ä¼ä¸šé’‰é’‰ç»„ç»‡id * callBack æˆæƒæˆåŠŸåçš„å›è°ƒ * *&#x2F;export function ddAuth(corpId, callBack) &#123;  const currentTime &#x3D; new Date().getTime();  const lastTokenTime &#x3D; getLastTokenTime() || 0;  &#x2F;&#x2F; å‘å¸ƒ  if (config.release) &#123;    try &#123;      &#x2F;&#x2F; å¤§äº23å°æ—¶ï¼Œé‡æ–°æˆæƒ      if (currentTime - +lastTokenTime &gt; 23 * 60 * 60 * 1000) &#123;        refreshToken(corpId, callBack);        console.log(&quot;é‡æ–°æˆæƒ&quot;);      &#125; else &#123;        &#x2F;&#x2F; å°äº23å°æ—¶ï¼Œå¤§äº6å°æ—¶ï¼Œåˆ·æ–°        callBack();        &#x2F;&#x2F; åˆ·æ–°token        if (currentTime - +lastTokenTime &gt; 6 * 60 * 60 * 1000) &#123;          refreshToken(corpId);        &#125;      &#125;    &#125; catch (error) &#123;      showToastFail(error);    &#125;    &#x2F;&#x2F; å¼€å‘è°ƒè¯•  &#125; else &#123;    callBack();    &#x2F;&#x2F; showToastFail(&quot;å¼€å‘ç™»å½•è¶…æ—¶ï¼Œé‡æ–°ç™»å½•&quot;)  &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> é’‰é’‰å°ç¨‹åº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é’‰é’‰å°ç¨‹åº </tag>
            
            <tag> token </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git public key</title>
      <link href="//post/2016-06-20git.html"/>
      <url>//post/2016-06-20git.html</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-none"><code class="language-none">[root@izbp1hun1qsl59e2nzqyvcz ~]# git config --global user.name &quot;hailong.chen&quot;[root@izbp1hun1qsl59e2nzqyvcz ~]# git config --global user.email &quot;841660202@qq.com&quot;</code></pre><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>SSH<br>SSH keys<br>SSH key å¯ä»¥è®©ä½ åœ¨ä½ çš„ç”µè„‘å’Œ Code æœåŠ¡å™¨ä¹‹é—´å»ºç«‹å®‰å…¨çš„åŠ å¯†è¿æ¥ã€‚ å…ˆæ‰§è¡Œä»¥ä¸‹è¯­å¥æ¥åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨æœ¬åœ°å…¬é’¥ï¼š<br><code>cat ~/.ssh/id_rsa.pub</code><br>å¦‚æœä½ çœ‹åˆ°ä¸€é•¿ä¸²ä»¥ Â ssh-rsa æˆ– Â ssh-dsa å¼€å¤´çš„å­—ç¬¦ä¸², ä½ å¯ä»¥è·³è¿‡ Â ssh-keygen çš„æ­¥éª¤ã€‚<br>æç¤º: æœ€å¥½çš„æƒ…å†µæ˜¯ä¸€ä¸ªå¯†ç å¯¹åº”ä¸€ä¸ª ssh keyï¼Œä½†æ˜¯é‚£ä¸æ˜¯å¿…é¡»çš„ã€‚ä½ å®Œå…¨å¯ä»¥è·³è¿‡åˆ›å»ºå¯†ç è¿™ä¸ªæ­¥éª¤ã€‚è¯·è®°ä½è®¾ç½®çš„å¯†ç å¹¶ä¸èƒ½è¢«ä¿®æ”¹æˆ–è·å–ã€‚<br>ä½ å¯ä»¥æŒ‰å¦‚ä¸‹å‘½ä»¤æ¥ç”Ÿæˆ ssh key<br><code>ssh-keygen -t rsa -C &quot;841660202@qq.com&quot;</code><br>è¿™ä¸ªæŒ‡ä»¤ä¼šè¦æ±‚ä½ æä¾›ä¸€ä¸ªä½ç½®å’Œæ–‡ä»¶åå»å­˜æ”¾é”®å€¼å¯¹å’Œå¯†ç ï¼Œä½ å¯ä»¥ç‚¹å‡» Enter é”®å»ä½¿ç”¨é»˜è®¤å€¼ã€‚<br>ç”¨ä»¥ä¸‹å‘½ä»¤è·å–ä½ ç”Ÿæˆçš„å…¬é’¥ï¼š<br><code>cat ~/.ssh/id_rsa.pub</code><br>å¤åˆ¶è¿™ä¸ªå…¬é’¥æ”¾åˆ°ä½ çš„ä¸ªäººè®¾ç½®ä¸­çš„ SSH&#x2F;My SSH Keys ä¸‹ï¼Œè¯·å®Œæ•´æ‹·è´ä» ssh-å¼€å§‹ç›´åˆ°ä½ çš„ç”¨æˆ·åå’Œä¸»æœºåä¸ºæ­¢çš„å†…å®¹ã€‚<br>å¦‚æœæ‰“ç®—æ‹·è´ä½ çš„å…¬é’¥åˆ°ä½ çš„ç²˜è´´æ¿ä¸‹ï¼Œè¯·å‚è€ƒä½ çš„æ“ä½œç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹çš„å‘½ä»¤ï¼š<br>Windows:<br><code>clip &lt; ~/.ssh/id_rsa.pub</code><br>Mac:<br><code>pbcopy &lt; ~/.ssh/id_rsa.pub</code><br>GNU&#x2F;Linux (requires xclip):<br><code>xclip -sel clip &lt; ~/.ssh/id_rsa.pub</code><br>Applications<br>Eclipse<br>å¦‚ä½•åœ¨ Eclipse ä¸­æ·»åŠ  ssh key:Â <a href="https://wiki.eclipse.org/EGit/User_Guide#Eclipse_SSH_Configuration">https://wiki.eclipse.org/EGit/User_Guide#Eclipse_SSH_Configuration</a><br>Tip: Non-default OpenSSH key file names or locations<br>å¦‚æœï¼Œä¸ç®¡ä½ æœ‰ä»€ä¹ˆç†ç”±ï¼Œå½“ä½ å†³å®šå»ç”¨ä¸€ä¸ªéé»˜è®¤çš„ä½ç½®æˆ–æ–‡ä»¶åå»å­˜æ”¾ä½ çš„ ssh keyã€‚ä½ å¿…é¡»é…ç½®å¥½ä½ çš„ ssh å®¢æˆ·ç«¯ä»¥æ‰¾åˆ°ä½ çš„ ssh ç§é’¥å»è¿æ¥ Code æœåŠ¡å™¨ï¼Œå¯¹äº OpenSSH å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªé€šå¸¸æ˜¯åœ¨~&#x2F;.ssh&#x2F;config ç±»ä¼¼çš„ä½ç½®é…ç½®çš„ï¼š<br>Host my-git.company.com<br>RSAAuthentication yes<br>IdentityFile ~&#x2F;my-ssh-key-directory&#x2F;company-com-private-key-filename</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Last login: Sun Apr 17 16:06:15 on consoleN&#x2F;A: version &quot;N&#x2F;A -&gt; N&#x2F;A&quot; is not yet installed.You need to run &quot;nvm install N&#x2F;A&quot; to install it before using it.N&#x2F;A: version &quot;N&#x2F;A -&gt; N&#x2F;A&quot; is not yet installed.You need to run &quot;nvm install N&#x2F;A&quot; to install it before using it.The default interactive shell is now zsh.To update your account to use zsh, please run &#96;chsh -s &#x2F;bin&#x2F;zsh&#96;.For more details, please visit https:&#x2F;&#x2F;support.apple.com&#x2F;kb&#x2F;HT208050.chenhailong@chenhailongdeMacBook-Pro:~$ &#x2F;Users&#x2F;chenhailong&#x2F;Desktop-bash: &#x2F;Users&#x2F;chenhailong&#x2F;Desktop: is a directorychenhailong@chenhailongdeMacBook-Pro:~$ cd &#x2F;Users&#x2F;chenhailong&#x2F;Desktopchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git clone git@github.com:841660202&#x2F;841660202.github.io.gitCloning into &#39;841660202.github.io&#39;...The authenticity of host &#39;github.com (20.205.243.166)&#39; can&#39;t be established.ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF&#x2F;zLDA0zPMSvHdkr4UvCOqU.This key is not known by any other namesAre you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])? yesWarning: Permanently added &#39;github.com&#39; (ED25519) to the list of known hosts.git@github.com: Permission denied (publickey).fatal: Could not read from remote repository.Please make sure you have the correct access rightsand the repository exists.chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git clone git@github.com:841660202&#x2F;841660202.github.io.gitCloning into &#39;841660202.github.io&#39;...git@github.com: Permission denied (publickey).fatal: Could not read from remote repository.Please make sure you have the correct access rightsand the repository exists.chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa.pub-bash: &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub: No such file or directorychenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ cat ~&#x2F;.ssh&#x2F;id_rsa.pubcat: &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub: No such file or directorychenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git config --global user.name &quot;hailong.chen&quot;chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git config --global user.email &quot;841660202@qq.com&quot;chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ cat ~&#x2F;.ssh&#x2F;id_rsa.pubcat: &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pub: No such file or directorychenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ ssh-keygen -t rsa -C &quot;841660202@qq.com&quot;Generating public&#x2F;private rsa key pair.Enter file in which to save the key (&#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa):Enter passphrase (empty for no passphrase):Enter same passphrase again:Your identification has been saved in &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsaYour public key has been saved in &#x2F;Users&#x2F;chenhailong&#x2F;.ssh&#x2F;id_rsa.pubThe key fingerprint is:SHA256:bdtIDeRXGKxGTEa&#x2F;Ex3QdPtVoOUiwuiq7YKjKrLakbU 841660202@qq.comThe key&#39;s randomart image is:+---[RSA 3072]----+|         +&#x3D;.o**.o||       o +o.o*.oo||      . o.+.* o..||     .   oo&#x3D; +  o||    . . S.+ +   .||   o o   o + .   || .o E     o .    ||&#x3D;..+             ||@oooo            |+----[SHA256]-----+chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa.pubchenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$ git clone git@github.com:841660202&#x2F;841660202.github.io.gitCloning into &#39;841660202.github.io&#39;...remote: Enumerating objects: 441, done.remote: Counting objects: 100% (441&#x2F;441), done.remote: Compressing objects: 100% (216&#x2F;216), done.remote: Total 441 (delta 208), reused 401 (delta 168), pack-reused 0Receiving objects: 100% (441&#x2F;441), 1.34 MiB | 1.05 MiB&#x2F;s, done.Resolving deltas: 100% (208&#x2F;208), done.chenhailong@chenhailongdeMacBook-Pro:~&#x2F;Desktop$</code></pre><h2 id="è®¾ç½®-github-SSH-keys"><a href="#è®¾ç½®-github-SSH-keys" class="headerlink" title="è®¾ç½® github SSH keys"></a>è®¾ç½® github SSH keys</h2><p><a href="https://github.com/settings/keys">https://github.com/settings/keys</a></p><h2 id="é—®é¢˜åŠè§£å†³"><a href="#é—®é¢˜åŠè§£å†³" class="headerlink" title="é—®é¢˜åŠè§£å†³"></a>é—®é¢˜åŠè§£å†³</h2><p>å›¾ 1</p><img src="http://t-blog-images.aijs.top/img/202208112025638.png" /><p>å›¾ 2</p><img src="http://t-blog-images.aijs.top/img/202208112027160.png" /><ol><li><code>git config --global user.email &lt;&gt;</code></li><li>åˆ é™¤é‡æ–°é…ç½® å¦‚å›¾2</li><li>æ¸…ç† git ç¼“å­˜<code>git clean -f</code></li><li>é‡æ–°æäº¤</li></ol>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAC Iterm2ç¾åŒ–ç»ˆç«¯</title>
      <link href="//post/2017-07-09item2.html"/>
      <url>//post/2017-07-09item2.html</url>
      
        <content type="html"><![CDATA[<h2 id="MAC-ç¯å¢ƒ"><a href="#MAC-ç¯å¢ƒ" class="headerlink" title="MAC ç¯å¢ƒ"></a>MAC ç¯å¢ƒ</h2><p><strong>æ³¨æ„ï¼šä»¥ä¸‹å†…å®¹ä»…é™ MAC,å…¶ä»–ç¯å¢ƒï¼Œè¯·è‡ªè¡Œè°·æ­Œ</strong></p><h2 id="oh-my-zsh-æ’ä»¶æ¨è"><a href="#oh-my-zsh-æ’ä»¶æ¨è" class="headerlink" title="oh-my-zsh æ’ä»¶æ¨è :"></a>oh-my-zsh æ’ä»¶æ¨è :</h2><ul><li>autojump è¿™ä¸ªæ²¡ç”¨èµ·æ¥ï¼Œä½¿ç”¨æ²¡ä»€ä¹ˆæ•ˆæœ ğŸ¥¹</li><li>zsh-autosuggestion å‘½ä»¤è¡Œè¾“å…¥æœ‰æç¤ºï¼Œï¼ˆå‘½ä»¤ä¸‹è½½å¤±è´¥ï¼Œæ‰‹åŠ¨ä¸‹è½½ï¼Œæ‹·è´åˆ° <code>~/.oh-my-zsh/custom/plugins/zsh-autosuggestions</code>ï¼‰</li><li>zsh-syntax-highlighting</li></ul><h2 id="å®‰è£…-zsh"><a href="#å®‰è£…-zsh" class="headerlink" title="å®‰è£… zsh"></a>å®‰è£… zsh</h2><p><strong>1.ä½¿ç”¨ brew å®‰è£…</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">brew install oh-my-zsh</code></pre><p><strong>2. æ‰‹åŠ¨å®‰è£…</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git clone git:&#x2F;&#x2F;github.com&#x2F;robbyrussell&#x2F;oh-my-zsh.git ~&#x2F;.oh-my-zshcp ~&#x2F;.oh-my-zsh&#x2F;templates&#x2F;zshrc.zsh-template ~&#x2F;.zshrc</code></pre><h2 id="å®‰è£…-autojump"><a href="#å®‰è£…-autojump" class="headerlink" title="å®‰è£… autojump"></a>å®‰è£… autojump</h2><p><strong>1.å®‰è£…</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">brew install autojump</code></pre><p><strong>2.é…ç½®</strong><br><code>code ~/.zshrc</code>ï¼ŒæŠŠä»¥ä¸‹ä»£ç åŠ åˆ°å°¾éƒ¨</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># ä½¿ç”¨brewå®‰è£…çš„[[ -s $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh ]] &amp;&amp; . $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.shsource $ZSH&#x2F;oh-my-zsh.sh# ä½¿ç”¨gitå®‰è£…çš„[[ -s ~&#x2F;.autojump&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh ]] &amp;&amp; . ~&#x2F;.autojump&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh</code></pre><p><strong>3.åˆ·æ–°é…ç½®</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">source ~&#x2F;.zshrc</code></pre><h2 id="å®‰è£…-zsh-autosuggestion"><a href="#å®‰è£…-zsh-autosuggestion" class="headerlink" title="å®‰è£… zsh-autosuggestion"></a>å®‰è£… zsh-autosuggestion</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git clone git:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-autosuggestions $ZSH_CUSTOM&#x2F;plugins&#x2F;zsh-autosuggestions</code></pre><h2 id="å®‰è£…-zsh-syntax-highlighting"><a href="#å®‰è£…-zsh-syntax-highlighting" class="headerlink" title="å®‰è£… zsh-syntax-highlighting"></a>å®‰è£… zsh-syntax-highlighting</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git clone https:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~&#x2F;.oh-my-zsh&#x2F;custom&#125;&#x2F;plugins&#x2F;zsh-syntax-highlighting</code></pre><h2 id="åˆ·æ–°é…ç½®"><a href="#åˆ·æ–°é…ç½®" class="headerlink" title="åˆ·æ–°é…ç½®"></a>åˆ·æ–°é…ç½®</h2><p>æœ€åç”¨ <code>source ~/.zshrc</code> å‘½ä»¤æ›´æ–°é…ç½®æ–‡ä»¶</p><h2 id="zshrc-é…ç½®å¦‚ä¸‹ï¼š"><a href="#zshrc-é…ç½®å¦‚ä¸‹ï¼š" class="headerlink" title=".zshrc é…ç½®å¦‚ä¸‹ï¼š"></a>.zshrc é…ç½®å¦‚ä¸‹ï¼š</h2><ul><li>è‡ªå·±ç”µè„‘é…ç½®ï¼Œä¸‹é¢æˆªå›¾æ˜¯åŠå…¬ç”µè„‘æˆªå›¾</li></ul><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># If you come from bash you might have to change your $PATH.# export PATH&#x3D;$HOME&#x2F;bin:&#x2F;usr&#x2F;local&#x2F;bin:$PATH# Path to your oh-my-zsh installation.export ZSH&#x3D;&quot;$HOME&#x2F;.oh-my-zsh&quot;# Set name of the theme to load --- if set to &quot;random&quot;, it will# load a random theme each time oh-my-zsh is loaded, in which case,# to know which specific one was loaded, run: echo $RANDOM_THEME# See https:&#x2F;&#x2F;github.com&#x2F;ohmyzsh&#x2F;ohmyzsh&#x2F;wiki&#x2F;ThemesZSH_THEME&#x3D;&quot;robbyrussell&quot;# Set list of themes to pick from when loading at random# Setting this variable when ZSH_THEME&#x3D;random will cause zsh to load# a theme from this variable instead of looking in $ZSH&#x2F;themes&#x2F;# If set to an empty array, this variable will have no effect.# ZSH_THEME_RANDOM_CANDIDATES&#x3D;( &quot;robbyrussell&quot; &quot;agnoster&quot; )# Uncomment the following line to use case-sensitive completion.# CASE_SENSITIVE&#x3D;&quot;true&quot;# Uncomment the following line to use hyphen-insensitive completion.# Case-sensitive completion must be off. _ and - will be interchangeable.# HYPHEN_INSENSITIVE&#x3D;&quot;true&quot;# Uncomment one of the following lines to change the auto-update behavior# zstyle &#39;:omz:update&#39; mode disabled  # disable automatic updates# zstyle &#39;:omz:update&#39; mode auto      # update automatically without asking# zstyle &#39;:omz:update&#39; mode reminder  # just remind me to update when it&#39;s time# Uncomment the following line to change how often to auto-update (in days).# zstyle &#39;:omz:update&#39; frequency 13# Uncomment the following line if pasting URLs and other text is messed up.# DISABLE_MAGIC_FUNCTIONS&#x3D;&quot;true&quot;# Uncomment the following line to disable colors in ls.# DISABLE_LS_COLORS&#x3D;&quot;true&quot;# Uncomment the following line to disable auto-setting terminal title.# DISABLE_AUTO_TITLE&#x3D;&quot;true&quot;# Uncomment the following line to enable command auto-correction.# ENABLE_CORRECTION&#x3D;&quot;true&quot;# Uncomment the following line to display red dots whilst waiting for completion.# You can also set it to another string to have that shown instead of the default red dots.# e.g. COMPLETION_WAITING_DOTS&#x3D;&quot;%F&#123;yellow&#125;waiting...%f&quot;# Caution: this setting can cause issues with multiline prompts in zsh &lt; 5.7.1 (see #5765)# COMPLETION_WAITING_DOTS&#x3D;&quot;true&quot;# Uncomment the following line if you want to disable marking untracked files# under VCS as dirty. This makes repository status check for large repositories# much, much faster.# DISABLE_UNTRACKED_FILES_DIRTY&#x3D;&quot;true&quot;# Uncomment the following line if you want to change the command execution time# stamp shown in the history command output.# You can set one of the optional three formats:# &quot;mm&#x2F;dd&#x2F;yyyy&quot;|&quot;dd.mm.yyyy&quot;|&quot;yyyy-mm-dd&quot;# or set a custom format using the strftime function format specifications,# see &#39;man strftime&#39; for details.# HIST_STAMPS&#x3D;&quot;mm&#x2F;dd&#x2F;yyyy&quot;# Would you like to use another custom folder than $ZSH&#x2F;custom?# ZSH_CUSTOM&#x3D;&#x2F;path&#x2F;to&#x2F;new-custom-folder# Which plugins would you like to load?# Standard plugins can be found in $ZSH&#x2F;plugins&#x2F;# Custom plugins may be added to $ZSH_CUSTOM&#x2F;plugins&#x2F;# Example format: plugins&#x3D;(rails git textmate ruby lighthouse)# Add wisely, as too many plugins slow down shell startup.# æ’ä»¶ä¿¡æ¯plugins&#x3D;(  git  zsh-syntax-highlighting  zsh-autosuggestions  autojump)source $ZSH&#x2F;oh-my-zsh.sh[[ -s $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.sh ]] &amp;&amp; . $(brew --prefix)&#x2F;etc&#x2F;profile.d&#x2F;autojump.shsource $ZSH&#x2F;oh-my-zsh.sh# User configurationPROMPT&#x3D;&quot;%(?:%&#123;$fg_bold[yellow]%&#125;â™  :%&#123;$fg_bold[red]%&#125;â™  )%&#123;$fg[cyan]%&#125;%d $ &quot;# PROMPT&#x3D;&quot;%(?:%&#123;$fg_bold[yellow]%&#125;â™  :%&#123;$fg_bold[red]%&#125;â™  )%&#123;$fg[cyan]%&#125;%d %&#123;$fg_bold[magenta]%&#125;$ &quot;PROMPT+&#x3D;&#39;%&#123;$reset_color%&#125;&#39;ZSH_THEME_GIT_PROMPT_PREFIX&#x3D;&quot;%&#123;$fg_bold[blue]%&#125;&quot;ZSH_THEME_GIT_PROMPT_SUFFIX&#x3D;&quot;%&#123;$reset_color%&#125; &quot;ZSH_THEME_GIT_PROMPT_DIRTY&#x3D;&quot;%&#123;$fg[blue]%&#125;) %&#123;$fg[yellow]%&#125;âœ—&quot;ZSH_THEME_GIT_PROMPT_CLEAN&#x3D;&quot;%&#123;$fg[blue]%&#125;)&quot;# å‚è€ƒ https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;b84d8b7b134e# codevalue# %Tç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶ï¼šåˆ†ï¼‰# %*ç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶ï¼šåˆ†ï¼šç§’ï¼‰# %Dç³»ç»Ÿæ—¥æœŸï¼ˆå¹´-æœˆ-æ—¥ï¼‰# %nç”¨æˆ·å# %B - %bå¼€å§‹åˆ°ç»“æŸä½¿ç”¨ç²—ä½“æ‰“å°# %U - %uå¼€å§‹åˆ°ç»“æŸä½¿ç”¨ä¸‹åˆ’çº¿æ‰“å°# %cä»…å½“å‰æ–‡ä»¶å¤¹è·¯å¾„# %då½“å‰ç›®å½•è·¯å¾„å®Œæ•´# %~å½“å‰ç›®å½•ç›¸å¯¹äºï½çš„ç›¸å¯¹è·¯å¾„# %Mè®¡ç®—æœºçš„ä¸»æœºå# %mè®¡ç®—æœºçš„ä¸»æœºåï¼ˆåœ¨ç¬¬ä¸€ä¸ªå¥å·ä¹‹å‰æˆªæ–­# %lå½“å‰çš„tty# export MANPATH&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;man:$MANPATH&quot;# You may need to manually set your language environment# export LANG&#x3D;en_US.UTF-8# Preferred editor for local and remote sessions# if [[ -n $SSH_CONNECTION ]]; then#   export EDITOR&#x3D;&#39;vim&#39;# else#   export EDITOR&#x3D;&#39;mvim&#39;# fi# Compilation flags# export ARCHFLAGS&#x3D;&quot;-arch x86_64&quot;# Set personal aliases, overriding those provided by oh-my-zsh libs,# plugins, and themes. Aliases can be placed here, though oh-my-zsh# users are encouraged to define aliases within the ZSH_CUSTOM folder.# For a full list of active aliases, run &#96;alias&#96;.## Example aliases# alias zshconfig&#x3D;&quot;mate ~&#x2F;.zshrc&quot;# alias ohmyzsh&#x3D;&quot;mate ~&#x2F;.oh-my-zsh&quot;</code></pre><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><img src="http://t-blog-images.aijs.top/img/202208192302460.png" /><p><strong>æ ¹ç›®å½•æ‰§è¡Œå®Œ,åªèƒ½è§„é¿æç¤ºï¼Œä¸èƒ½è§£å†³é—®é¢˜</strong></p><pre class="line-numbers language-none"><code class="language-none">compaudit | xargs chmod g-w,o-w</code></pre><img src="http://t-blog-images.aijs.top/img/202208192304357.png" /><p><strong>é‡æ–°å®‰è£… zsh è§£å†³é—®é¢˜</strong><br><a href="https://www.jianshu.com/p/677a9bb1ac29" target="_blank" >fixedï¼š é‡æ–°å®‰è£… zsh</a></p><pre class="line-numbers language-none"><code class="language-none">brew install zsh</code></pre><h2 id="æ¨èåšå®¢å·¦å²¸åšå®¢"><a href="#æ¨èåšå®¢å·¦å²¸åšå®¢" class="headerlink" title="æ¨èåšå®¢å·¦å²¸åšå®¢"></a>æ¨èåšå®¢<a href="https://www.zrahh.com/archives/167.html">å·¦å²¸åšå®¢</a></h2><h2 id="ä½¿ç”¨æ•ˆæœ"><a href="#ä½¿ç”¨æ•ˆæœ" class="headerlink" title="ä½¿ç”¨æ•ˆæœ"></a>ä½¿ç”¨æ•ˆæœ</h2><p><img src="http://t-blog-images.aijs.top/img/11460713-14c8ef376aabe04a.png"><br><img src="http://t-blog-images.aijs.top/img/11460713-ef2da0af46da7712.png"><br><img src="http://t-blog-images.aijs.top/img/11460713-e49ed15245409774.png"></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> å¢æ•ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰¹é‡åˆ é™¤ç›®å½•</title>
      <link href="//post/2019-10-30shell.html"/>
      <url>//post/2019-10-30shell.html</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ é™¤æŸä¸ªç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„-node-modules"><a href="#åˆ é™¤æŸä¸ªç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„-node-modules" class="headerlink" title="åˆ é™¤æŸä¸ªç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„ node_modules"></a>åˆ é™¤æŸä¸ªç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„ node_modules</h2><ul><li>æŸ¥æ‰¾ &#x2F;tmp&#x2F;test&#x2F; å­ç›®å½•ä¸‹æ‰€æœ‰ modu æ‰§è¡Œåˆ é™¤</li></ul><pre class="line-numbers language-none"><code class="language-none">find &#x2F;tmp&#x2F;test&#x2F; -type d -name modu |xargs rm -rf</code></pre><ul><li>æŸ¥æ‰¾ &#x2F;tmp&#x2F;test&#x2F; å­ç›®å½•ä¸‹æ‰€æœ‰ node_modules æ‰§è¡Œåˆ é™¤</li></ul><pre class="line-numbers language-none"><code class="language-none">find &#x2F;tmp&#x2F;test&#x2F; -type d -name node_modules |xargs rm -rf</code></pre><ul><li>æŸ¥æ‰¾ å½“å‰ç›®å½•ä¸‹ å­ç›®å½•ä¸‹æ‰€æœ‰ node_modules æ‰§è¡Œåˆ é™¤</li></ul><pre class="line-numbers language-none"><code class="language-none">find .&#x2F; -type d -name node_modules |xargs rm -rf</code></pre><p><a href="https://www.cnblogs.com/w-j-q/p/14863810.html" target="_blank" >è§ find å‘½ä»¤</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¢æ•ˆ </tag>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Layoffs</title>
      <link href="//post/2022-03-25Layoffs.html"/>
      <url>//post/2022-03-25Layoffs.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€å®¶ä¸Šå¸‚å…¬å¸è¿‘æœŸã€ŒBä¸šã€äººæ•°å˜åŒ–"><a href="#ä¸€å®¶ä¸Šå¸‚å…¬å¸è¿‘æœŸã€ŒBä¸šã€äººæ•°å˜åŒ–" class="headerlink" title="ä¸€å®¶ä¸Šå¸‚å…¬å¸è¿‘æœŸã€ŒBä¸šã€äººæ•°å˜åŒ–"></a>ä¸€å®¶ä¸Šå¸‚å…¬å¸è¿‘æœŸã€ŒBä¸šã€äººæ•°å˜åŒ–</h2><p><img src="http://t-blog-images.aijs.top/img/11460713-98eaa0e7b6e68c6f.png" alt="2022-03-30"><br><img src="http://t-blog-images.aijs.top/img/11460713-f2c5edfe1032663d.png" alt="2022-03-31"><br><img src="http://t-blog-images.aijs.top/img/11460713-0d1febc4e52867bd.png" alt="2022-04-01"><br><img src="http://t-blog-images.aijs.top/img/11460713-3c855f37997fca9d.png" alt="2022-04-02"><br><img src="http://t-blog-images.aijs.top/img/11460713-33ab1685e98181c5.png" alt="2022-04-07"><br><img src="http://t-blog-images.aijs.top/img/11460713-f6178de2c725ba0d.png" alt="2022-04-08"><br><img src="http://t-blog-images.aijs.top/img/11460713-1c49e477ebebdb04.png" alt="2022-04-11"><br><img src="http://t-blog-images.aijs.top/img/11460713-ff83505b93a40211.png" alt="2022-04-12"><br><img src="http://t-blog-images.aijs.top/img/11460713-6e26dc81d1bc1bb5.png" alt="2022-04-13"><br><img src="http://t-blog-images.aijs.top/img/11460713-6f19d0ccbc1470d1.png" alt="2022-04-14"><br><img src="http://t-blog-images.aijs.top/img/11460713-5fa4eb0d60075e10.png" alt="2022-04-15"><br><img src="http://t-blog-images.aijs.top/img/11460713-a75f3fa3bc0cc9ad.png" alt="2022-04-20"><br><img src="http://t-blog-images.aijs.top/img/11460713-2cb92c5f9a24df72.png" alt="2022-04-21"><br><img src="http://t-blog-images.aijs.top/img/11460713-ea85739148839bd2.png" alt="image.png"><br><img src="http://t-blog-images.aijs.top/img/11460713-cc82a2680e69dccd.png" alt="2022-04-26"><br><img src="http://t-blog-images.aijs.top/img/11460713-fdd722c44a598a88.png" alt="2022-04-27"><br><img src="http://t-blog-images.aijs.top/img/11460713-35395fd4c9b459ea.png" alt="2022-04-28"><br><img src="http://t-blog-images.aijs.top/img/20220505093216.webp" alt="2022-05-05"><br><img src="http://t-blog-images.aijs.top/img/20220509134022.webp" alt="2022-05-09"><br><img src="http://t-blog-images.aijs.top/img/20220510180811.webp" alt="2022-05-10"></p>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Layoffs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NestjsæœåŠ¡ç«¯æŠ€æœ¯æ ˆ</title>
      <link href="//post/2021-06-30node.html"/>
      <url>//post/2021-06-30node.html</url>
      
        <content type="html"><![CDATA[<h2 id="NestJSä¸­æ–‡æ–‡æ¡£"><a href="#NestJSä¸­æ–‡æ–‡æ¡£" class="headerlink" title="NestJSä¸­æ–‡æ–‡æ¡£"></a>NestJSä¸­æ–‡æ–‡æ¡£</h2><p><a href="https://nestjs.bootcss.com/">NestJSä¸­æ–‡æ–‡æ¡£</a><br><a href="https://docs.nestjs.cn/">NestJSä¸­æ–‡æ–‡æ¡£</a><br><a href="https://github.com/nestjs/nest">github</a> 42.2K</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>A progressive Node.js framework for building efficient, scalable, and enterprise-grade server-side applications on top of TypeScript &amp; JavaScript (ES6, ES7, ES8) ğŸš€</p></blockquote><h2 id="TypeORM"><a href="#TypeORM" class="headerlink" title="TypeORM"></a>TypeORM</h2><p><a href="https://typeorm.biunav.com/zh/#%E5%AE%89%E8%A3%85">TypeORMä¸­æ–‡æ–‡æ¡£</a><br><a href="https://github.com/typeorm/typeorm">githubåœ°å€</a> 26.3K</p><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ORM for TypeScript and JavaScript (ES7, ES6, ES5). Supports MySQL, PostgreSQL, MariaDB, SQLite, MS SQL Server, Oracle, SAP Hana, WebSQL databases. Works in NodeJS, Browser, Ionic, Cordova and Electron platforms.</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web officeé¢„è§ˆ</title>
      <link href="//post/2021-09-07web.html"/>
      <url>//post/2021-09-07web.html</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ­¥<br>å°†æ–‡ä»¶ä¸Šä¼ åˆ°ä½ çš„æœåŠ¡å™¨é‡Œï¼Œå¹¶æ”¯æŒurlä¸‹è½½è¿™ä¸ªæ–‡ä»¶ã€‚<br>ç¬¬äºŒæ­¥<br>è®¿é—®ï¼š<a href="http://view.officeapps.live.com/op/view.aspx?src=%E8%A6%81%E9%A2%84%E8%A7%88%E6%96%87%E4%BB%B6%E7%9A%84url%E5%9C%B0%E5%9D%80%EF%BC%88%E8%AE%B0%E5%BE%97url%E7%BC%96%E7%A0%81%E5%93%A6%EF%BC%89">http://view.officeapps.live.com/op/view.aspx?src=è¦é¢„è§ˆæ–‡ä»¶çš„urlåœ°å€ï¼ˆè®°å¾—urlç¼–ç å“¦ï¼‰</a><br>ç¬¬ä¸‰æ­¥<br>å¯ä»¥ä½¿ç”¨iframeåµŒå…¥ä½ çš„ç³»ç»Ÿ<br>æ›´å¤š<br>è¯¦æƒ…æŸ¥çœ‹ï¼š<a href="https://www.microsoft.com/en-us/microsoft-365/blog/2013/04/10/office-web-viewer-view-office-documents-in-a-browser/?eu=true">https://www.microsoft.com/en-us/microsoft-365/blog/2013/04/10/office-web-viewer-view-office-documents-in-a-browser/?eu=true</a><br><img src="http://t-blog-images.aijs.top/img/11460713-93b26693cac5c2d8.png"></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>node-dev</title>
      <link href="//post/2021-11-02node.html"/>
      <url>//post/2021-11-02node.html</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev"><a href="#åœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev" class="headerlink" title="åœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev"></a>åœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev</h2><ul><li>ä½œç”¨ï¼šåœ¨å¹•åç”¨ts-nodeè°ƒæ•´node-dev</li><li>ä¼˜ç‚¹ï¼š<ul><li>ä»»æ„ä¾èµ–çš„æ–‡ä»¶æ”¹å˜æ—¶å€™ï¼Œé‡å¯node processï¼Œä½†æ˜¯å…±äº«tsç¼–è¯‘çº¿ç¨‹ã€‚</li><li>å› ä¸ºä¸éœ€è¦æ¯æ¬¡ts-nodeç¼–è¯‘çš„å®ä¾‹åŒ–ï¼Œè€Œæå‡æ€§èƒ½</li></ul></li><li>é…ç½®é¡¹ï¼š</li><li>æ³¨æ„äº‹é¡¹ï¼š</li><li>æˆªå›¾ï¼š<br><img src="http://t-blog-images.aijs.top/img/11460713-10cfe41335cfeb5d.png"></li></ul>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€ä¹¦è¿ç§»åˆ°OSS</title>
      <link href="//post/2022-04-27mv-blog-jianshu.html"/>
      <url>//post/2022-04-27mv-blog-jianshu.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><pre class="line-numbers language-none"><code class="language-none">cat .&#x2F;* |grep uploadimages.jianshu.io &gt; image.txtmkdir img3dcd img3dwget -i ..&#x2F;image.txtsed -i&#39;&#39; -e &#39;s&#x2F;!\[image.png\](&#x2F;&#x2F;g&#39; image.txtsed -i&#39;&#39; -e &#39;s&#x2F;)&#x2F;&#x2F;g&#39; image.txt</code></pre><h2 id="è¿ç§»ç®€ä¹¦å›¾ç‰‡ä¸‹è½½åé‡å‘½å"><a href="#è¿ç§»ç®€ä¹¦å›¾ç‰‡ä¸‹è½½åé‡å‘½å" class="headerlink" title="è¿ç§»ç®€ä¹¦å›¾ç‰‡ä¸‹è½½åé‡å‘½å"></a>è¿ç§»ç®€ä¹¦å›¾ç‰‡ä¸‹è½½åé‡å‘½å</h2><pre class="line-numbers language-none"><code class="language-none">#! &#x2F;bin&#x2F;shfor eachfile in &#96;ls -B&#96;do    # echo $&#123;eachfile%%\%3F*&#125; # æˆªæ‰æœ€å.txt    # $ % https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;b3bdc3b3968e  filename&#x3D;$&#123;eachfile%%\%3F*&#125;  filehead&#x3D;&#96;echo $eachfile | awk -F \%3F &#39;&#123;print $1 &#125;&#39;&#96;  filelast&#x3D;&#96;echo $eachfile | awk -F \%3F &#39;&#123;print $2 &#125;&#39;&#96;  # mv $filename.txt $&#123;filelast&#125;_$filehead.txt  # https:&#x2F;&#x2F;baijiahao.baidu.com&#x2F;s?id&#x3D;1726788915185806701&amp;wfr&#x3D;spider&amp;for&#x3D;pc  echo &#39;--&#39;  # echo $filename  echo $filehead #åˆ†å‰²å­—ç¬¦å·¦è¾¹éƒ¨åˆ†  echo $filelast #åˆ†å‰²å­—ç¬¦å³è¾¹éƒ¨åˆ†  # å³è¾¹æ–‡ä»¶å­˜åœ¨çš„æƒ…å†µä¸‹æ‰å¤„ç†  if [ &quot;$filelast&quot; !&#x3D; &quot;&quot; ]  then    echo &#39;æ‰§è¡Œrename &#39;    mv $eachfile $filehead  fidone</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
